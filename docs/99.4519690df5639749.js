(self.webpackChunkcelsus_zorro=self.webpackChunkcelsus_zorro||[]).push([[99],{2099:(Iu,v,Q)=>{"use strict";Q.r(v),Q.d(v,{ProjectExplorerModule:()=>Na});var $=Q(9808),g=Q(4521),t=Q(5e3),k=Q(2772),x=Q(3075),e=Q(1945),r=Q(4546),i=Q(1894),c=Q(1047),n=Q(6114),m=Q(6042),p=Q(2643),s=Q(2683),f=Q(655),l=Q(1721),o=Q(969),d=Q(226);function u(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Oqu(_e.nzText)}}function a(Je,Dt){if(1&Je&&(t.TgZ(0,"span",1),t.YNc(1,u,2,1,"ng-container",2),t.qZA()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.nzText)}}let y=(()=>{class Je{constructor(){this.nzType="horizontal",this.nzOrientation="center",this.nzDashed=!1,this.nzPlain=!1}}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:16,hostBindings:function(_e,Be){2&_e&&t.ekj("ant-divider-horizontal","horizontal"===Be.nzType)("ant-divider-vertical","vertical"===Be.nzType)("ant-divider-with-text",Be.nzText)("ant-divider-plain",Be.nzPlain)("ant-divider-with-text-left",Be.nzText&&"left"===Be.nzOrientation)("ant-divider-with-text-right",Be.nzText&&"right"===Be.nzOrientation)("ant-divider-with-text-center",Be.nzText&&"center"===Be.nzOrientation)("ant-divider-dashed",Be.nzDashed)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzDashed:"nzDashed",nzPlain:"nzPlain"},exportAs:["nzDivider"],decls:1,vars:1,consts:[["class","ant-divider-inner-text",4,"ngIf"],[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function(_e,Be){1&_e&&t.YNc(0,a,2,1,"span",0),2&_e&&t.Q6J("ngIf",Be.nzText)},directives:[$.O5,o.f],encapsulation:2,changeDetection:0}),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzDashed",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzPlain",void 0),Je})(),h=(()=>{class Je{}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({imports:[[d.vT,$.ez,o.T]]}),Je})();var _=Q(1711),b=Q(8186),w=Q(404);function T(Je,Dt){if(1&Je&&(t.TgZ(0,"span",7)(1,"b"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4," (PTM)"),t.qZA()()),2&Je){const _e=t.oxw();t.xp6(2),t.Oqu(_e.data.title)}}function L(Je,Dt){if(1&Je&&(t.TgZ(0,"b"),t._uU(1),t.qZA()),2&Je){const _e=t.oxw();t.xp6(1),t.Oqu(_e.data.title)}}function M(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-list-item-action"),t._uU(1," Sample #: "),t.TgZ(2,"span",8),t._uU(3),t.qZA()()),2&Je){const _e=t.oxw();t.xp6(2),t.s9C("nzTooltipTitle",_e.sampleTooltip),t.xp6(1),t.Oqu(_e.rawFile.raw_sample_columns.length)}}let P=(()=>{class Je{constructor(_e){this.web=_e,this._data={},this.daFile={},this.rawFile={},this.authors=[],this.sampleTooltip="",this.resultCount=0,this.labGroups=[]}set data(_e){if(this._data=_e,this._data.associated_authors&&(this.authors=this._data.associated_authors.map(Be=>Be.name),this.labGroups=this._data.lab_group.map(Be=>Be.name),console.log(this.authors)),this._data.files)for(const Be of this._data.files)"DA"===Be.file_type?this.daFile=Be:"R"===Be.file_type&&(this.rawFile=Be,this.sampleTooltip=this.rawFile.raw_sample_columns.map(Ft=>Ft.name).join(","));this.getProjectData()}get data(){return this._data}ngOnInit(){}getProjectData(){this.web.getRawDataFromGeneNames("",0,20,!1,[this.rawFile.id]).subscribe(_e=>{this.resultCount=_e.count/this.rawFile.raw_sample_columns.length,console.log(this.resultCount)})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(k.Q))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-project-description"]],inputs:{data:"data"},decls:26,vars:9,consts:[[3,"nzSrc"],["target","_blank",2,"padding-right","20px",3,"href"],["style","color: #7F669D",4,"ngIf"],[4,"ngIf"],["nzSpan","6"],[3,"innerHTML"],["nz-list-item-actions",""],[2,"color","#7F669D"],["nz-tooltip","",3,"nzTooltipTitle"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"nz-list-item-meta"),t._UZ(1,"nz-list-item-meta-avatar",0),t.TgZ(2,"nz-list-item-meta-title")(3,"a",1),t.YNc(4,T,5,1,"span",2),t.YNc(5,L,2,1,"b",3),t.qZA()(),t.TgZ(6,"nz-list-item-meta-description")(7,"nz-row")(8,"nz-col",4)(9,"p")(10,"b"),t._uU(11,"Authors:"),t.qZA(),t._uU(12),t.qZA()(),t.TgZ(13,"nz-col",4)(14,"p")(15,"b"),t._uU(16,"Lab Groups:"),t.qZA(),t._uU(17),t.qZA()()(),t.TgZ(18,"p")(19,"b"),t._uU(20,"Description:"),t.qZA()(),t._UZ(21,"div",5),t.qZA()(),t.TgZ(22,"ul",6),t.YNc(23,M,4,2,"nz-list-item-action",3),t.TgZ(24,"nz-list-item-action"),t._uU(25),t.qZA()()),2&_e&&(t.xp6(1),t.Q6J("nzSrc","/assets/avatars/c3.png"),t.xp6(2),t.MGl("href","#/project-explorer/details/",Be.data.id,"",t.LSH),t.xp6(1),t.Q6J("ngIf","PTM"===Be.data.project_type),t.xp6(1),t.Q6J("ngIf","PTM"!==Be.data.project_type),t.xp6(7),t.hij(" ",Be.authors.join(",")," "),t.xp6(5),t.hij(" ",Be.labGroups.join(",")," "),t.xp6(4),t.Q6J("innerHTML",Be.data.description,t.oJD),t.xp6(2),t.Q6J("ngIf",Be.rawFile.raw_sample_columns.length>0),t.xp6(2),t.hij(" Result Entry Row #: ",Be.resultCount," "))},directives:[b.yi,b.Vk,b.IO,$.O5,b.Pb,i.SK,i.t3,b.nk,b.KC,w.SY],styles:[""]}),Je})();function z(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-list-item"),t._UZ(1,"app-project-description",2),t.qZA()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.Q6J("data",_e)}}let S=(()=>{class Je{constructor(_e){this.cdr=_e,this._data=[],this.loading=!1}set data(_e){this.change([..._e.results])}get data(){return this._data}ngOnChanges(_e){console.log(_e)}ngOnInit(){}change(_e){this.loading=!0,console.log(_e),_e.length>0?setTimeout(()=>{console.log(_e),this._data=_e,this.loading=!1,this.cdr.detectChanges()},1e3):setTimeout(()=>{console.log(_e),this._data=[],this.loading=!1,this.cdr.detectChanges()},1e3)}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.sBO))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-project-table"]],inputs:{data:"data"},features:[t.TTD],decls:2,vars:2,consts:[["nzItemLayout","vertical",3,"nzLoading"],[4,"ngFor","ngForOf"],[2,"width","100%",3,"data"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"nz-list",0),t.YNc(1,z,2,1,"nz-list-item",1),t.qZA()),2&_e&&(t.Q6J("nzLoading",Be.loading),t.xp6(1),t.Q6J("ngForOf",Be.data))},directives:[b.n_,$.sg,b.AA,P],styles:[""]}),Je})();function C(Je,Dt){if(1&Je&&t._uU(0),2&Je){const _e=Dt.range;t.lnq(" ",_e[0],"-",_e[1]," of ",Dt.$implicit," items\n")}}let R=(()=>{class Je{constructor(_e,Be,Ft){this.route=_e,this.web=Be,this.fb=Ft,this.projectData={count:0,results:[]},this.subtitle="",this.form=this.fb.group({term:[""],title:[!0],description:[!0],keyword:[!0],associated_authors:[!1],quantification_method:[!1],organism:[!1],accession_id:[!1],gene_names:[!1],lab_group:[!1]}),this.web.getProjects().subscribe(Tn=>{this.projectData=Tn,this.subtitle=`${this.projectData.count} projects are available`})}ngOnInit(){}changePage(_e){this.web.getProjects(this.form.value.term,20,_e,this.form.value).subscribe(Be=>{this.projectData=Be,this.subtitle=`${this.projectData.count} projects are available`})}submitSearch(_e){this.web.getProjects(this.form.value.term,20,0,this.form.value).subscribe(Be=>{this.projectData=Be,this.subtitle=`${this.projectData.count} projects are available`})}searchProject(){}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(g.gz),t.Y36(k.Q),t.Y36(x.qu))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-project"]],decls:37,vars:15,consts:[[3,"nzSubtitle"],["nz-form","",3,"formGroup","submit"],["nzFor","term",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","","formControlName","term","id","term"],["nz-checkbox","","formControlName","title"],["nz-checkbox","","formControlName","description"],["nz-checkbox","","formControlName","keyword"],["nz-checkbox","","formControlName","quantification_method"],["nz-checkbox","","formControlName","organism"],["nz-checkbox","","formControlName","associated_authors"],["nz-checkbox","","formControlName","accession_id"],["nz-checkbox","","formControlName","gene_names"],["nz-checkbox","","formControlName","lab_group"],["nzJustify","end"],["nz-button","","type","submit","nzType","default"],[3,"nzShowTotal","nzPageSize","nzPageIndex","nzTotal","nzPageIndexChange"],[3,"data"],["rangeTemplate",""]],template:function(_e,Be){if(1&_e&&(t.TgZ(0,"nz-page-header",0)(1,"nz-page-header-title"),t._uU(2,"Project Explorer"),t.qZA()(),t.TgZ(3,"form",1),t.NdJ("submit",function(Tn){return Be.submitSearch(Tn)}),t.TgZ(4,"nz-form-item")(5,"nz-form-label",2),t._uU(6," Search query "),t.qZA(),t.TgZ(7,"nz-form-control",3),t._UZ(8,"input",4),t.qZA()(),t.TgZ(9,"nz-form-item")(10,"label",5),t._uU(11,"Title"),t.qZA(),t.TgZ(12,"label",6),t._uU(13,"Description"),t.qZA(),t.TgZ(14,"label",7),t._uU(15,"Keywords"),t.qZA(),t.TgZ(16,"label",8),t._uU(17,"Quantification Methods"),t.qZA(),t.TgZ(18,"label",9),t._uU(19,"Organisms"),t.qZA(),t.TgZ(20,"label",10),t._uU(21,"Author"),t.qZA(),t.TgZ(22,"label",11),t._uU(23,"UniProt Accession IDs"),t.qZA(),t.TgZ(24,"label",12),t._uU(25,"Gene names"),t.qZA(),t.TgZ(26,"label",13),t._uU(27,"Lab Group"),t.qZA()(),t.TgZ(28,"nz-form-item",14)(29,"button",15),t._uU(30,"Search"),t.qZA()()(),t._UZ(31,"nz-divider"),t.TgZ(32,"nz-pagination",16),t.NdJ("nzPageIndexChange",function(Tn){return Be.changePage(Tn)}),t.qZA(),t._UZ(33,"app-project-table",17),t.TgZ(34,"nz-pagination",16),t.NdJ("nzPageIndexChange",function(Tn){return Be.changePage(Tn)}),t.qZA(),t.YNc(35,C,1,3,"ng-template",null,18,t.W1O)),2&_e){const Ft=t.MAs(36);t.Q6J("nzSubtitle",Be.subtitle),t.xp6(3),t.Q6J("formGroup",Be.form),t.xp6(2),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",16)("nzXs",24),t.xp6(25),t.Q6J("nzShowTotal",Ft)("nzPageSize",20)("nzPageIndex",1)("nzTotal",Be.projectData.count),t.xp6(1),t.Q6J("data",Be.projectData),t.xp6(1),t.Q6J("nzShowTotal",Ft)("nzPageSize",20)("nzPageIndex",1)("nzTotal",Be.projectData.count)}},directives:[e.$O,e.u9,x._Y,x.JL,r.Lr,x.sg,i.SK,r.Nx,i.t3,r.iK,r.Fd,c.Zp,x.Fj,x.JJ,x.u,n.Ie,m.ix,p.dQ,s.w,y,_.dE,S],styles:[""]}),Je})();var D=Q(6170),j=Q(8),q=Q(7579),Z=Q(4128);class W{constructor(){this.id=0,this.data={profile_plot:!0,volcano_plot:!0}}}var G=Q(9635),X=Q(4573),ne=Q(9010),V=Q(5017),N=Q(6722),U=Q(1705),ee=Q(1872),B=Q(365),K=Q(8271),J=function(Je){function Dt(){var _e=null!==Je&&Je.apply(this,arguments)||this;return Object.defineProperty(_e,"_index",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),_e}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){Je.prototype._afterNewApplyThemes.call(this)}}),Object.defineProperty(Dt.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(Je.prototype._beforeChanged.call(this),this.isDirty("sprite")){var _e=this.get("sprite");_e&&(_e.setAll({position:"absolute",role:"figure"}),this._disposers.push(_e))}(this.isDirty("locationX")||this.isDirty("locationY"))&&this.series&&this.series._positionBullet(this)}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Bullet"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:K.JH.classNames.concat([Dt.className])}),Dt}(K.JH),te=Q(9238),ae=function(Je){function Dt(){return null!==Je&&Je.apply(this,arguments)||this}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){Je.prototype._beforeChanged.call(this),this.isDirty("radius")&&(this._clear=!0)}}),Object.defineProperty(Dt.prototype,"_changed",{enumerable:!1,configurable:!0,writable:!0,value:function(){Je.prototype._changed.call(this),this._clear&&this._display.drawCircle(0,0,this.get("radius",10))}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Circle"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:te.T.classNames.concat([Dt.className])}),Dt}(te.T),ce=Q(2893),oe=Q(1994),ve=Q(1135),fe=Q(8613),xe=Q(7970),Se=Q(8872),pe=Q(8256),ge=Q(7166),Te=Q(5106),se=Q(9660),de=Q(533),Ae=function(Je){function Dt(){var _e=null!==Je&&Je.apply(this,arguments)||this;return Object.defineProperty(_e,"lineX",{enumerable:!0,configurable:!0,writable:!0,value:_e.children.push(Se.r.new(_e._root,{themeTags:["x"]}))}),Object.defineProperty(_e,"lineY",{enumerable:!0,configurable:!0,writable:!0,value:_e.children.push(Se.r.new(_e._root,{themeTags:["y"]}))}),Object.defineProperty(_e,"selection",{enumerable:!0,configurable:!0,writable:!0,value:_e.children.push(te.T.new(_e._root,{themeTags:["selection","cursor"],layer:30}))}),Object.defineProperty(_e,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_lastPoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(_e,"_tooltipX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(_e,"_tooltipY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(_e,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_toX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_toY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),_e}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this;this._settings.themeTags=ge.Fy(this._settings.themeTags,["xy","cursor"]),Je.prototype._afterNew.call(this),this.setAll({width:ee.AQ,height:ee.AQ,isMeasured:!0,position:"absolute"}),this.states.create("hidden",{visible:!0,opacity:0}),this._drawLines(),this.setPrivateRaw("visible",!1),this._disposers.push(this.setTimeout(function(){_e.setPrivate("visible",!0)},500)),this.lineX.events.on("positionchanged",function(){_e._handleXLine()}),this.lineY.events.on("positionchanged",function(){_e._handleYLine()})}}),Object.defineProperty(Dt.prototype,"_setUpTouch",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this.chart;_e&&(_e.plotContainer._display.cancelTouch="none"!=this.get("behavior"))}}),Object.defineProperty(Dt.prototype,"_handleXLine",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this.lineX.x(),Be=!0;(_e<0||_e>this.width())&&(Be=!1),this.lineX.setPrivate("visible",Be)}}),Object.defineProperty(Dt.prototype,"_handleYLine",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this.lineY.y(),Be=!0;(_e<0||_e>this.height())&&(Be=!1),this.lineY.setPrivate("visible",Be)}}),Object.defineProperty(Dt.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this;if(Je.prototype._prepareChildren.call(this),this.isDirty("xAxis")){this._tooltipX=!1;var Be=this.get("xAxis");if(Be){var Ft=Be.get("tooltip");Ft&&(this._tooltipX=!0,Ft.on("pointTo",function(){_e._updateXLine(Ft)}))}}if(this.isDirty("yAxis")){this._tooltipY=!1;var Tn=this.get("yAxis");if(Tn){var $n=Tn.get("tooltip");$n&&(this._tooltipY=!0,$n.on("pointTo",function(){_e._updateYLine($n)}))}}}}),Object.defineProperty(Dt.prototype,"_handleSyncWith",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this.chart;if(_e){var Be=this.get("syncWith"),Ft=[];Be&&se.S6(Be,function(Tn){var $n=Tn.chart;$n&&Ft.push($n)}),_e._otherCharts=Ft}}}),Object.defineProperty(Dt.prototype,"_updateChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(Je.prototype._updateChildren.call(this),this._handleSyncWith(),this.isDirty("positionX")||this.isDirty("positionY")){var _e=this.get("positionX"),Be=this.get("positionY");null==_e&&null==Be?this.hide(0):(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0))),this.handleMove())}}}),Object.defineProperty(Dt.prototype,"_updateXLine",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=Te.NM(this._display.toLocal(_e.get("pointTo",{x:0,y:0})).x,2);this._toX!=Be&&(this.lineX.animate({key:"x",to:Be,duration:_e.get("animationDuration",0),easing:_e.get("animationEasing")}),this._toX=Be)}}),Object.defineProperty(Dt.prototype,"_updateYLine",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=Te.NM(this._display.toLocal(_e.get("pointTo",{x:0,y:0})).y,2);this._toY!=Be&&(this.lineY.animate({key:"y",to:Be,duration:_e.get("animationDuration",0),easing:_e.get("animationEasing")}),this._toY=Be)}}),Object.defineProperty(Dt.prototype,"_drawLines",{enumerable:!1,configurable:!0,writable:!0,value:function(){var _e=this;this.lineX.set("draw",function(Be){Be.moveTo(0,0),Be.lineTo(0,_e.height())}),this.lineY.set("draw",function(Be){Be.moveTo(0,0),Be.lineTo(_e.width(),0)})}}),Object.defineProperty(Dt.prototype,"_setChart",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this;this.chart=_e,this._handleSyncWith();var Ft=_e.plotContainer;this.events.on("boundschanged",function(){Be._disposers.push(Be.setTimeout(function(){Be.get("alwaysShow")&&(Be._movePoint=Be.toGlobal(Be._getPoint(Be.get("positionX",0),Be.get("positionY",0))),Be.handleMove())},50))}),ge.be("touchevents")&&(this._disposers.push(Ft.events.on("click",function($n){ge.z6($n.originalEvent)&&Be._handleMove($n.originalEvent)})),this._setUpTouch()),this._disposers.push(Ft.events.on("pointerdown",function($n){Be._handleCursorDown($n.originalEvent)})),this._disposers.push(Ft.events.on("globalpointerup",function($n){Be._handleCursorUp($n.originalEvent),!$n.native&&!Be.isHidden()&&Be._handleMove($n.originalEvent)})),this._disposers.push(Ft.events.on("globalpointermove",function($n){!Be.get("syncWith")&&0==de.XP(Ft._downPoints).length&&!$n.native&&Be.isHidden()||Be._handleMove($n.originalEvent)}));var Tn=this.parent;Tn&&Tn.children.moveValue(this.selection)}}),Object.defineProperty(Dt.prototype,"_inPlot",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this.chart;return!!Be&&Be.inPlot(_e)}}),Object.defineProperty(Dt.prototype,"_handleCursorDown",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this._root.documentPointToRoot({x:_e.clientX,y:_e.clientY}),Ft=this._display.toLocal(Be),Tn=this.chart;if(this.selection.set("draw",function(){}),Tn&&this._inPlot(Ft)){if(this._downPoint=Ft,"none"!=this.get("behavior")){this.selection.show();var $n="selectstarted";this.events.isEnabled($n)&&this.events.dispatch($n,{type:$n,target:this})}var or=this._getPosition(Ft).x,vr=this._getPosition(Ft).y;this.setPrivate("downPositionX",or),this.setPrivate("downPositionY",vr)}}}),Object.defineProperty(Dt.prototype,"_handleCursorUp",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){if(this._downPoint){var Be=this.get("behavior","none");if("none"!=Be){"z"===Be.charAt(0)&&this.selection.hide();var Ft=this._root.documentPointToRoot({x:_e.clientX,y:_e.clientY}),Tn=this._display.toLocal(Ft),$n=this._downPoint,or=this.get("moveThreshold",1);if(Tn&&$n){var vr=!1;if(("zoomX"===Be||"zoomXY"===Be||"selectX"===Be||"selectXY"===Be)&&Math.abs(Tn.x-$n.x)>or&&(vr=!0),("zoomY"===Be||"zoomXY"===Be||"selectY"===Be||"selectXY"===Be)&&Math.abs(Tn.y-$n.y)>or&&(vr=!0),vr){var ur="selectended";this.events.isEnabled(ur)&&this.events.dispatch(ur,{type:ur,target:this})}}}}this._downPoint=void 0}}),Object.defineProperty(Dt.prototype,"_handleMove",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){if(this.getPrivate("visible")){var Be=this.chart;if(Be&&de.XP(Be.plotContainer._downPoints).length>1)return void this.set("forceHidden",!0);this.set("forceHidden",!1);var Ft=this._root.documentPointToRoot({x:_e.clientX,y:_e.clientY}),Tn=this._lastPoint;if(Math.round(Tn.x)===Math.round(Ft.x)&&Math.round(Tn.y)===Math.round(Ft.y))return;this._lastPoint=Ft,this.handleMove({x:Ft.x,y:Ft.y})}}}),Object.defineProperty(Dt.prototype,"_getPosition",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){return{x:_e.x/this.width(),y:_e.y/this.height()}}}),Object.defineProperty(Dt.prototype,"handleMove",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){_e||(_e=this._movePoint);var Ft=this.get("alwaysShow");if(_e){this._movePoint=_e;var Tn=this._display.toLocal(_e),$n=this.chart;if($n&&this._inPlot(Tn)){$n._movePoint=_e,this.isHidden()&&(this.show(),"z"==this.get("behavior","").charAt(0)&&this.selection.set("draw",function(){}));var vr,ur,Or=this._getPosition(Tn);this.setPrivate("point",Tn);var Nr=this.get("snapToSeries"),ii=this.get("positionX"),le=Or.x;pe.hj(ii)&&(le=ii);var E=this.get("positionY"),I=Or.y;pe.hj(E)&&(I=E),this.setPrivate("positionX",le),this.setPrivate("positionY",I);var F=this._getPoint(le,I);vr=F.x,ur=F.y,$n.xAxes.each(function(re){re._handleCursorPosition(le,Nr),Ft&&re.handleCursorShow()}),$n.yAxes.each(function(re){re._handleCursorPosition(I,Nr),Ft&&re.handleCursorShow()}),Be||($n._handleCursorPosition(),this.events.isEnabled(H="cursormoved")&&this.events.dispatch(H,{type:H,target:this})),this._updateLines(vr,ur),$n.arrangeTooltips()}else if(!this._downPoint&&!Ft){var H;this.hide(0),this.events.isEnabled(H="cursorhidden")&&this.events.dispatch(H,{type:H,target:this})}this._downPoint&&"none"!=this.get("behavior")&&this._updateSelection(Tn)}else this.hide(0)}}),Object.defineProperty(Dt.prototype,"_getPoint",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){return{x:this.width()*_e,y:this.height()*Be}}}),Object.defineProperty(Dt.prototype,"_updateLines",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){this._tooltipX||this.lineX.set("x",_e),this._tooltipY||this.lineY.set("y",Be),this._drawLines()}}),Object.defineProperty(Dt.prototype,"_updateSelection",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this,Ft=this.selection,Tn=this.get("behavior"),$n=this.width(),or=this.height();_e.x<0&&(_e.x=0),_e.x>$n&&(_e.x=$n),_e.y<0&&(_e.y=0),_e.y>or&&(_e.y=or),Ft.set("draw",function(vr){var ur=Be._downPoint;ur&&("zoomXY"===Tn||"selectXY"===Tn?(vr.moveTo(ur.x,ur.y),vr.lineTo(ur.x,_e.y),vr.lineTo(_e.x,_e.y),vr.lineTo(_e.x,ur.y),vr.lineTo(ur.x,ur.y)):"zoomX"===Tn||"selectX"===Tn?(vr.moveTo(ur.x,0),vr.lineTo(ur.x,or),vr.lineTo(_e.x,or),vr.lineTo(_e.x,0),vr.lineTo(ur.x,0)):("zoomY"===Tn||"selectY"===Tn)&&(vr.moveTo(0,ur.y),vr.lineTo($n,ur.y),vr.lineTo($n,_e.y),vr.lineTo(0,_e.y),vr.lineTo(0,ur.y)))})}}),Object.defineProperty(Dt.prototype,"_onHide",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.isHidden()){var _e=this.chart;_e&&(_e.xAxes.each(function(Be){Be.handleCursorHide()}),_e.yAxes.each(function(Be){Be.handleCursorHide()}),_e.series.each(function(Be){Be.handleCursorHide()}))}Je.prototype._onHide.call(this)}}),Object.defineProperty(Dt.prototype,"_onShow",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(!this.isHidden()){var _e=this.chart;_e&&(_e.xAxes.each(function(Be){Be.handleCursorShow()}),_e.yAxes.each(function(Be){Be.handleCursorShow()}))}Je.prototype._onShow.call(this)}}),Object.defineProperty(Dt.prototype,"_dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){Je.prototype._dispose.call(this),this.selection.dispose()}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYCursor"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xe.W.classNames.concat([Dt.className])}),Dt}(xe.W),Le=Q(2827),Me=Q(6519),De=Q(8810),Oe=Q(1061),Ie=Q(6570),Qe=Q(1519),Ne=function(Je){function Dt(){return null!==Je&&Je.apply(this,arguments)||this}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){Je.prototype._beforeChanged.call(this),(this.isDirty("lowX0")||this.isDirty("lowY0")||this.isDirty("lowX1")||this.isDirty("lowY1")||this.isDirty("highX0")||this.isDirty("highX1")||this.isDirty("highY0")||this.isDirty("highY1"))&&(this._clear=!0)}}),Object.defineProperty(Dt.prototype,"_draw",{enumerable:!1,configurable:!0,writable:!0,value:function(){Je.prototype._draw.call(this);var _e=this._display;_e.moveTo(this.get("lowX0",0),this.get("lowY0",0)),_e.lineTo(this.get("lowX1",0),this.get("lowY1",0)),_e.moveTo(this.get("highX0",0),this.get("highY0",0)),_e.lineTo(this.get("highX1",0),this.get("highY1",0))}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Candlestick"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.c.classNames.concat([Dt.className])}),Dt}(Qe.c),Pe=Q(5344),Re=Q(7379),Ge=function(Je){function Dt(){var _e=null!==Je&&Je.apply(this,arguments)||this;return Object.defineProperty(_e,"columns",{enumerable:!0,configurable:!0,writable:!0,value:new Re.o(Pe.YS.new({themeTags:["autocolor"]}),function(){return Ne._new(_e._root,{themeTags:ge.Fy(_e.columns.template.get("themeTags",[]),["candlestick","series","column"])},[_e.columns.template])})}),_e}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"makeColumn",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){var Ft=this.mainContainer.children.push(Be.make());return Ft._setDataItem(_e),Be.push(Ft),Ft}}),Object.defineProperty(Dt.prototype,"_updateGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){Je.prototype._updateGraphics.call(this,_e,Be);var ur,Or,Nr,ii,le,E,I,F,ke,Ft=this.getRaw("xAxis"),Tn=this.getRaw("yAxis"),$n=this.getRaw("baseAxis"),or=this.get("vcy",1),vr=this.get("vcx",1),H=this.get("locationX",_e.get("locationX",.5)),re=this.get("locationY",_e.get("locationY",.5)),ue=this.get("openLocationX",_e.get("openLocationX",H)),ye=this.get("openLocationY",_e.get("openLocationY",re));if(Tn===$n){var Ee=Ft.getDataItemPositionX(_e,this._xOpenField,1,vr),Ue=Ft.getDataItemPositionX(_e,this._xField,1,vr);Or=Ft.getDataItemPositionX(_e,this._xLowField,1,vr),E=Ft.getDataItemPositionX(_e,this._xHighField,1,vr),le=Math.max(Ee,Ue),ur=Math.min(Ee,Ue),ii=Nr=Tn.getDataItemPositionY(_e,this._yField,($e=this._aLocationY0+ye-.5)+(this._aLocationY1+re-.5-$e)/2,or),I=Nr,F=Nr,ke="horizontal"}else{var $e,_t=Tn.getDataItemPositionY(_e,this._yOpenField,1,or),Ct=Tn.getDataItemPositionY(_e,this._yField,1,or);ii=Tn.getDataItemPositionY(_e,this._yLowField,1,or),F=Tn.getDataItemPositionY(_e,this._yHighField,1,or),I=Math.max(_t,Ct),Nr=Math.min(_t,Ct),Or=ur=Ft.getDataItemPositionX(_e,this._xField,($e=this._aLocationX0+ue-.5)+(this._aLocationX1+H-.5-$e)/2,vr),le=ur,E=ur,ke="vertical"}this._updateCandleGraphics(_e,ur,Or,Nr,ii,le,E,I,F,ke)}}),Object.defineProperty(Dt.prototype,"_updateCandleGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be,Ft,Tn,$n,or,vr,ur,Or,Nr){var ii=_e.get("graphics");if(ii){var le=this.getPoint(Be,Tn),E=this.getPoint(Ft,$n),I=this.getPoint(or,ur),F=this.getPoint(vr,Or),H=ii.x(),re=ii.y();ii.set("lowX0",le.x-H),ii.set("lowY0",le.y-re),ii.set("lowX1",E.x-H),ii.set("lowY1",E.y-re),ii.set("highX0",I.x-H),ii.set("highY0",I.y-re),ii.set("highX1",F.x-H),ii.set("highY1",F.y-re),ii.set("orientation",Nr);var ue=_e.get("rangeGraphics");ue&&se.S6(ue,function(ye){ye.set("lowX0",le.x-H),ye.set("lowY0",le.y-re),ye.set("lowX1",E.x-H),ye.set("lowY1",E.y-re),ye.set("highX0",I.x-H),ye.set("highY0",I.y-re),ye.set("highX1",F.x-H),ye.set("highY1",F.y-re),ye.set("orientation",Nr)})}}}),Object.defineProperty(Dt.prototype,"_processAxisRange",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this;Je.prototype._processAxisRange.call(this,_e),_e.columns=new Re.o(Pe.YS.new({}),function(){return Ne._new(Be._root,{themeTags:ge.Fy(_e.columns.template.get("themeTags",[]),["candlestick","series","column"])},[Be.columns.template,_e.columns.template])})}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CandlestickSeries"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ie.d.classNames.concat([Dt.className])}),Dt}(Ie.d),tt=Q(5441),ct=Q(1115);function kt(Je){return"object"==typeof Je&&"length"in Je?Je:Array.from(Je)}var gt=Q(7944);function at(Je){this._context=Je}function et(Je){return new at(Je)}function yt(Je){return Je[0]}function Vt(Je){return Je[1]}function Gt(Je,Dt){var _e=(0,gt.Z)(!0),Be=null,Ft=et,Tn=null;function $n(or){var vr,Or,ii,ur=(or=kt(or)).length,Nr=!1;for(null==Be&&(Tn=Ft(ii=(0,ct.Z)())),vr=0;vr<=ur;++vr)!(vr<ur&&_e(Or=or[vr],vr,or))===Nr&&((Nr=!Nr)?Tn.lineStart():Tn.lineEnd()),Nr&&Tn.point(+Je(Or,vr,or),+Dt(Or,vr,or));if(ii)return Tn=null,ii+""||null}return Je="function"==typeof Je?Je:void 0===Je?yt:(0,gt.Z)(Je),Dt="function"==typeof Dt?Dt:void 0===Dt?Vt:(0,gt.Z)(Dt),$n.x=function(or){return arguments.length?(Je="function"==typeof or?or:(0,gt.Z)(+or),$n):Je},$n.y=function(or){return arguments.length?(Dt="function"==typeof or?or:(0,gt.Z)(+or),$n):Dt},$n.defined=function(or){return arguments.length?(_e="function"==typeof or?or:(0,gt.Z)(!!or),$n):_e},$n.curve=function(or){return arguments.length?(Ft=or,null!=Be&&(Tn=Ft(Be)),$n):Ft},$n.context=function(or){return arguments.length?(null==or?Be=Tn=null:Tn=Ft(Be=or),$n):Be},$n}function en(Je,Dt,_e){var Be=null,Ft=(0,gt.Z)(!0),Tn=null,$n=et,or=null;function vr(Or){var Nr,ii,le,I,H,E=(Or=kt(Or)).length,F=!1,re=new Array(E),ue=new Array(E);for(null==Tn&&(or=$n(H=(0,ct.Z)())),Nr=0;Nr<=E;++Nr){if(!(Nr<E&&Ft(I=Or[Nr],Nr,Or))===F)if(F=!F)ii=Nr,or.areaStart(),or.lineStart();else{for(or.lineEnd(),or.lineStart(),le=Nr-1;le>=ii;--le)or.point(re[le],ue[le]);or.lineEnd(),or.areaEnd()}F&&(re[Nr]=+Je(I,Nr,Or),ue[Nr]=+Dt(I,Nr,Or),or.point(Be?+Be(I,Nr,Or):re[Nr],_e?+_e(I,Nr,Or):ue[Nr]))}if(H)return or=null,H+""||null}function ur(){return Gt().defined(Ft).curve($n).context(Tn)}return Je="function"==typeof Je?Je:void 0===Je?yt:(0,gt.Z)(+Je),Dt="function"==typeof Dt?Dt:(0,gt.Z)(void 0===Dt?0:+Dt),_e="function"==typeof _e?_e:void 0===_e?Vt:(0,gt.Z)(+_e),vr.x=function(Or){return arguments.length?(Je="function"==typeof Or?Or:(0,gt.Z)(+Or),Be=null,vr):Je},vr.x0=function(Or){return arguments.length?(Je="function"==typeof Or?Or:(0,gt.Z)(+Or),vr):Je},vr.x1=function(Or){return arguments.length?(Be=null==Or?null:"function"==typeof Or?Or:(0,gt.Z)(+Or),vr):Be},vr.y=function(Or){return arguments.length?(Dt="function"==typeof Or?Or:(0,gt.Z)(+Or),_e=null,vr):Dt},vr.y0=function(Or){return arguments.length?(Dt="function"==typeof Or?Or:(0,gt.Z)(+Or),vr):Dt},vr.y1=function(Or){return arguments.length?(_e=null==Or?null:"function"==typeof Or?Or:(0,gt.Z)(+Or),vr):_e},vr.lineX0=vr.lineY0=function(){return ur().x(Je).y(Dt)},vr.lineY1=function(){return ur().x(Je).y(_e)},vr.lineX1=function(){return ur().x(Be).y(Dt)},vr.defined=function(Or){return arguments.length?(Ft="function"==typeof Or?Or:(0,gt.Z)(!!Or),vr):Ft},vr.curve=function(Or){return arguments.length?($n=Or,null!=Tn&&(or=$n(Tn)),vr):$n},vr.context=function(Or){return arguments.length?(null==Or?Tn=or=null:or=$n(Tn=Or),vr):Tn},vr}at.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Je,Dt){switch(Je=+Je,Dt=+Dt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Je,Dt):this._context.moveTo(Je,Dt);break;case 1:this._point=2;default:this._context.lineTo(Je,Dt)}}};var Jt=Q(8230),cn=Q(621),Rt=Q(4381),je=function(Je){function Dt(){var _e=null!==Je&&Je.apply(this,arguments)||this;return Object.defineProperty(_e,"_endIndex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:Gt()}),Object.defineProperty(_e,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:en()}),Object.defineProperty(_e,"_legendStroke",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_legendFill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"strokes",{enumerable:!0,configurable:!0,writable:!0,value:new Re.o(Pe.YS.new({}),function(){return te.T._new(_e._root,{themeTags:ge.Fy(_e.strokes.template.get("themeTags",[]),["line","series","stroke"])},[_e.strokes.template])})}),Object.defineProperty(_e,"fills",{enumerable:!0,configurable:!0,writable:!0,value:new Re.o(Pe.YS.new({}),function(){return te.T._new(_e._root,{themeTags:ge.Fy(_e.strokes.template.get("themeTags",[]),["line","series","fill"])},[_e.fills.template])})}),Object.defineProperty(_e,"_fillTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_strokeTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(_e,"_previousPoint",{enumerable:!0,configurable:!0,writable:!0,value:[0,0,0,0]}),Object.defineProperty(_e,"_dindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(_e,"_sindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),_e}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._fillGenerator.y0(function(_e){return _e[3]}),this._fillGenerator.x0(function(_e){return _e[2]}),this._fillGenerator.y1(function(_e){return _e[1]}),this._fillGenerator.x1(function(_e){return _e[0]}),Je.prototype._afterNew.call(this)}}),Object.defineProperty(Dt.prototype,"makeStroke",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this.mainContainer.children.push(_e.make());return _e.push(Be),Be}}),Object.defineProperty(Dt.prototype,"makeFill",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this.mainContainer.children.push(_e.make());return _e.push(Be),Be}}),Object.defineProperty(Dt.prototype,"_updateChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._strokeTemplate=void 0,this._fillTemplate=void 0;var _e=this.get("xAxis"),Be=this.get("yAxis");if(this.isDirty("stroke")){var Ft=this.get("stroke");this.strokes.template.set("stroke",Ft);var Tn=this._legendStroke;Tn&&Tn.states.lookup("default").set("stroke",Ft)}if(this.isDirty("fill")){var $n=this.get("fill");this.fills.template.set("fill",$n);var or=this._legendFill;or&&or.states.lookup("default").set("fill",$n)}if(this.isDirty("curveFactory")){var vr=this.get("curveFactory");vr&&(this._strokeGenerator.curve(vr),this._fillGenerator.curve(vr))}if(_e.inited&&Be.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty||this.isDirty("connect")||this.isDirty("curveFactory")){this.fills.each(function(Ue){Ue.setPrivate("visible",!1)}),this.strokes.each(function(Ue){Ue.setPrivate("visible",!1)}),this.axisRanges.each(function(Ue){var $e=Ue.fills;$e&&$e.each(function(_t){_t.setPrivate("visible",!1)});var it=Ue.strokes;it&&it.each(function(_t){_t.setPrivate("visible",!1)})});var ur=this.startIndex(),Or=this.strokes.template.get("templateField"),Nr=this.fills.template.get("templateField"),ii=!0,le=!0;Or&&(ii=!1),Nr&&(le=!1);for(var E=function(Ue){var $e=I.dataItems[Ue],it=!0,_t=$e.dataContext;if(Or&&_t[Or]&&(ii=!0),Nr&&_t[Nr]&&(le=!0),se.S6(I._valueFields,function(Ct){pe.hj($e.get(Ct))||(it=!1)}),it&&ii&&le)return ur=Ue,"break"},I=this,F=ur-1;F>=0&&"break"!==E(F);F--);var re=this.dataItems.length,ue=this.endIndex();if(ue<re){ue++;var ye=function(Ue){var $e=ke.dataItems[Ue],it=!0;if(se.S6(ke._valueFields,function(_t){pe.hj($e.get(_t))||(it=!1)}),it)return ue=Ue+1,"break"},ke=this;for(F=ue;F<re&&"break"!==ye(F);F++);}if(ur>0&&ur--,this._endIndex=ue,this._clearGraphics(),this._sindex=0,this._dindex=ur,1==this.dataItems.length)this._startSegment(0);else for(;this._dindex<ue-1;)this._startSegment(this._dindex),this._sindex++}}else this._skipped=!0;Je.prototype._updateChildren.call(this)}}),Object.defineProperty(Dt.prototype,"_clearGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.strokes.clear(),this.fills.clear()}}),Object.defineProperty(Dt.prototype,"_startSegment",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this,Ft=this._endIndex,Tn=Ft,$n=this.get("autoGapCount"),or=this.get("connect"),vr=this.makeFill(this.fills),ur=this._fillTemplate;ur&&ur!=this.fills.template&&(vr.template=ur),vr.setPrivate("visible",!0);var Nr=this.makeStroke(this.strokes),ii=this._strokeTemplate;ii&&ii!=this.strokes.template&&(Nr.template=ii),Nr.setPrivate("visible",!0);var le=this.get("xAxis"),E=this.get("yAxis"),I=this.get("baseAxis"),F=this.get("vcx",1),H=this.get("vcy",1),re=this._xField,ue=this._yField,ye=this._xOpenField,ke=this._yOpenField,Ee=this.get("openValueXField"),Ue=this.get("openValueYField");Ee||(ye=this._xField),Ue||(ke=this._yField);var Ct,$e=this.get("stacked"),it=le.basePosition(),_t=E.basePosition();Ct=I===E?this._yField:this._xField;var At=[],Et=[];At.push(Et);var En,Tt=this.strokes.template.get("templateField"),jt=this.fills.template.get("templateField"),Nt=this.get("locationX",.5),Yt=this.get("locationY",.5),ln=this.get("openLocationX",Nt),bn=this.get("openLocationY",Yt),In=this.get("minDistance",0),ir=this.fills.template.get("visible");this.axisRanges.length>0&&(ir=!0);var rr=!1;($e||Ee||Ue)&&(rr=!0);var _r={points:Et,segments:At,stacked:$e,getOpen:rr,basePosX:it,basePosY:_t,fillVisible:ir,xField:re,yField:ue,xOpenField:ye,yOpenField:ke,vcx:F,vcy:H,baseAxis:I,xAxis:le,yAxis:E,locationX:Nt,locationY:Yt,openLocationX:ln,openLocationY:bn,minDistance:In};for(En=_e;En<Tn;En++){this._dindex=En;var pr=this._dataItems[En],Qr=pr.get(re),li=pr.get(ue);if(null==Qr||null==li?or||(At.push(Et=[]),_r.points=Et):this._getPoints(pr,_r),Tt){var xi=pr.dataContext[Tt];if(xi){if(xi instanceof Pe.YS||(xi=Pe.YS.new(xi)),this._strokeTemplate=xi,En>_e){Tn=En;break}Nr.template=xi}}if(jt){var Wn=pr.dataContext[jt];if(Wn){if(Wn instanceof Pe.YS||(Wn=Pe.YS.new(Wn)),this._fillTemplate=Wn,En>_e){Tn=En;break}vr.template=Wn}}if(!or){var Rr=this.dataItems[En+1];Rr&&I.shouldGap(pr,Rr,$n,Ct)&&(At.push(Et=[]),_r.points=Et)}}vr.setRaw("userData",[_e,En]),Nr.setRaw("userData",[_e,En]),En===Ft&&this._endLine(Et,At[0][0]),Nr&&this._drawStroke(Nr,At),vr&&this._drawFill(vr,At),this.axisRanges.each(function(oi){var ti=oi.container,ki=Be.makeFill(oi.fills);ti&&ti.children.push(ki),ki.setPrivate("visible",!0),Be._drawFill(ki,At);var ui=Be.makeStroke(oi.strokes);ti&&ti.children.push(ui),ui.setPrivate("visible",!0),Be._drawStroke(ui,At),ki.setRaw("userData",[_e,En]),ui.setRaw("userData",[_e,En])})}}),Object.defineProperty(Dt.prototype,"_getPoints",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){var Ft=Be.points,Tn=_e.get("locationX",Be.locationX),$n=_e.get("locationY",Be.locationY),or=Be.xAxis.getDataItemPositionX(_e,Be.xField,Tn,Be.vcx),vr=Be.yAxis.getDataItemPositionY(_e,Be.yField,$n,Be.vcy);if(this._shouldInclude(or)){var ur=this.getPoint(or,vr),Or=[ur.x,ur.y];if(ur.x+=this._x,ur.y+=this._y,_e.set("point",ur),Be.fillVisible){var Nr=or,ii=vr;if(Be.baseAxis===Be.xAxis?ii=Be.basePosY:Be.baseAxis===Be.yAxis&&(Nr=Be.basePosX),Be.getOpen){var le=_e.get(Be.xOpenField),E=_e.get(Be.yOpenField);if(null!=le&&null!=E){var I=_e.get("openLocationX",Be.openLocationX),F=_e.get("openLocationY",Be.openLocationY);if(Be.stacked){var H=_e.get("stackToItemX"),re=_e.get("stackToItemY");H?(Nr=Be.xAxis.getDataItemPositionX(H,Be.xField,I,H.component.get("vcx")),pe.i2(Nr)&&(Nr=Be.basePosX)):Nr=Be.yAxis===Be.baseAxis?Be.basePosX:Be.xAxis.getDataItemPositionX(_e,Be.xOpenField,I,Be.vcx),re?(ii=Be.yAxis.getDataItemPositionY(re,Be.yField,F,re.component.get("vcy")),pe.i2(ii)&&(ii=Be.basePosY)):ii=Be.xAxis===Be.baseAxis?Be.basePosY:Be.yAxis.getDataItemPositionY(_e,Be.yOpenField,F,Be.vcy)}else Nr=Be.xAxis.getDataItemPositionX(_e,Be.xOpenField,I,Be.vcx),ii=Be.yAxis.getDataItemPositionY(_e,Be.yOpenField,F,Be.vcy)}}var ue=this.getPoint(Nr,ii);Or[2]=ue.x,Or[3]=ue.y}if(Be.minDistance>0){var Ee=Or[2],Ue=Or[3],$e=this._previousPoint,Ct=$e[2],At=$e[3];(Math.hypot(Or[0]-$e[0],Or[1]-$e[1])>Be.minDistance||Ee&&Ue&&Math.hypot(Ee-Ct,Ue-At)>Be.minDistance)&&(Ft.push(Or),this._previousPoint=Or)}else Ft.push(Or)}}}),Object.defineProperty(Dt.prototype,"_endLine",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){}}),Object.defineProperty(Dt.prototype,"_drawStroke",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){var Ft=this;_e.get("visible")&&_e.set("draw",function(Tn){se.S6(Be,function($n){Ft._strokeGenerator.context(Tn),Ft._strokeGenerator($n)})})}}),Object.defineProperty(Dt.prototype,"_drawFill",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){var Ft=this;_e.get("visible")&&_e.set("draw",function(Tn){se.S6(Be,function($n){Ft._fillGenerator.context(Tn),Ft._fillGenerator($n)})})}}),Object.defineProperty(Dt.prototype,"_processAxisRange",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this;Je.prototype._processAxisRange.call(this,_e),_e.fills=new Re.o(Pe.YS.new({}),function(){return te.T._new(Be._root,{themeTags:ge.Fy(_e.fills.template.get("themeTags",[]),["line","series","fill"])},[Be.fills.template,_e.fills.template])}),_e.strokes=new Re.o(Pe.YS.new({}),function(){return te.T._new(Be._root,{themeTags:ge.Fy(_e.strokes.template.get("themeTags",[]),["line","series","stroke"])},[Be.strokes.template,_e.strokes.template])})}}),Object.defineProperty(Dt.prototype,"createLegendMarker",{enumerable:!1,configurable:!0,writable:!0,value:function(_e){var Be=this.get("legendDataItem");if(Be){var Ft=Be.get("marker"),Tn=Be.get("markerRectangle");Tn&&Tn.setPrivate("visible",!1),Ft.set("background",Rt.A.new(Ft._root,{fillOpacity:0,fill:(0,Jt.$_)(0)}));var $n=Ft.children.push(te.T._new(Ft._root,{themeTags:["line","series","legend","marker","stroke"],interactive:!1},[this.strokes.template]));this._legendStroke=$n;var or=Ft.children.push(te.T._new(Ft._root,{themeTags:["line","series","legend","marker","fill"]},[this.fills.template]));this._legendFill=or;var vr=this._root.interfaceColors.get("disabled");if($n.states.create("disabled",{fill:vr,stroke:vr}),or.states.create("disabled",{fill:vr,stroke:vr}),this.bullets.length>0){var ur=this.bullets.getIndex(0);if(ur){var Or=ur(Ft._root,this,new cn.z(this,{},{}));if(Or){var Nr=Or.get("sprite");Nr instanceof te.T&&Nr.states.create("disabled",{fill:vr,stroke:vr}),Nr&&(Nr.set("tooltipText",void 0),Nr.set("tooltipHTML",void 0),Ft.children.push(Nr),Nr.setAll({x:Ft.width()/2,y:Ft.height()/2}))}}}}}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LineSeries"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:tt.o.classNames.concat([Dt.className])}),Dt}(tt.o);function Ye(Je,Dt){this._context=Je,this._t=Dt}function Fe(Je){return new Ye(Je,1)}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Je,Dt){switch(Je=+Je,Dt=+Dt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Je,Dt):this._context.moveTo(Je,Dt);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Dt),this._context.lineTo(Je,Dt);else{var _e=this._x*(1-this._t)+Je*this._t;this._context.lineTo(_e,this._y),this._context.lineTo(_e,Dt)}}this._x=Je,this._y=Dt}};var He=function(Je){function Dt(){return null!==Je&&Je.apply(this,arguments)||this}return(0,f.ZT)(Dt,Je),Object.defineProperty(Dt.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._setDefault("curveFactory",Fe),Je.prototype._afterNew.call(this)}}),Object.defineProperty(Dt.prototype,"_getPoints",{enumerable:!1,configurable:!0,writable:!0,value:function(_e,Be){var Ft=Be.points,Tn=this.get("stepWidth",ee.AQ).value/2,$n=_e.get("locationX",Be.locationX),or=_e.get("locationY",Be.locationY),vr=$n,ur=or;Be.baseAxis===Be.xAxis?($n-=Tn,vr+=Tn):Be.baseAxis===Be.yAxis&&(or-=Tn,ur+=Tn);var Or=Be.xAxis.getDataItemPositionX(_e,Be.xField,$n,Be.vcx),Nr=Be.yAxis.getDataItemPositionY(_e,Be.yField,or,Be.vcy),ii=Be.xAxis.getDataItemPositionX(_e,Be.xField,vr,Be.vcx),le=Be.yAxis.getDataItemPositionY(_e,Be.yField,ur,Be.vcy);if(this._shouldInclude(Or)){var E=this.getPoint(Or,Nr),I=[E.x,E.y],F=this.getPoint(ii,le),H=[F.x,F.y];if(Be.fillVisible){var re=Or,ue=Nr,ye=ii,ke=le;if(Be.baseAxis===Be.xAxis?(ue=Be.basePosY,ke=Be.basePosY):Be.baseAxis===Be.yAxis&&(re=Be.basePosX,ye=Be.basePosX),Be.getOpen){var Ee=_e.get(Be.xOpenField),Ue=_e.get(Be.yOpenField);if(null!=Ee&&null!=Ue)if(vr=$n=_e.get("openLocationX",Be.openLocationX),ur=or=_e.get("openLocationY",Be.openLocationY),Be.baseAxis===Be.xAxis?($n-=Tn,vr+=Tn):Be.baseAxis===Be.yAxis&&(or-=Tn,ur+=Tn),Be.stacked){var $e=_e.get("stackToItemX"),it=_e.get("stackToItemY");$e?(re=Be.xAxis.getDataItemPositionX($e,Be.xField,$n,$e.component.get("vcx")),ye=Be.xAxis.getDataItemPositionX($e,Be.xField,vr,$e.component.get("vcx"))):Be.yAxis===Be.baseAxis?(re=Be.basePosX,ye=Be.basePosX):Be.baseAxis===Be.yAxis&&(re=Be.xAxis.getDataItemPositionX(_e,Be.xOpenField,$n,Be.vcx),ye=Be.xAxis.getDataItemPositionX(_e,Be.xOpenField,vr,Be.vcx)),it?(ue=Be.yAxis.getDataItemPositionY(it,Be.yField,or,it.component.get("vcy")),ke=Be.yAxis.getDataItemPositionY(it,Be.yField,ur,it.component.get("vcy"))):Be.xAxis===Be.baseAxis?(ue=Be.basePosY,ke=Be.basePosY):Be.baseAxis===Be.yAxis&&(ue=Be.yAxis.getDataItemPositionY(_e,Be.yOpenField,or,Be.vcy),ke=Be.yAxis.getDataItemPositionY(_e,Be.yOpenField,ur,Be.vcy))}else re=Be.xAxis.getDataItemPositionX(_e,Be.xOpenField,$n,Be.vcx),ue=Be.yAxis.getDataItemPositionY(_e,Be.yOpenField,or,Be.vcy),ye=Be.xAxis.getDataItemPositionX(_e,Be.xOpenField,vr,Be.vcx),ke=Be.yAxis.getDataItemPositionY(_e,Be.yOpenField,ur,Be.vcy)}var _t=this.getPoint(re,ue),Ct=this.getPoint(ye,ke);I[2]=_t.x,I[3]=_t.y,H[2]=Ct.x,H[3]=Ct.y}Ft.push(I),Ft.push(H),_e.set("point",{x:I[0]+(H[0]-I[0])/2,y:I[1]+(H[1]-I[1])/2})}this.get("noRisers")&&(Be.points=[],Be.segments.push(Ft))}}),Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"StepLineSeries"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:je.classNames.concat([Dt.className])}),Dt}(je),Ke=Q(2468);const Ze=function(Je){return{height:Je}};let ut=(()=>{class Je{constructor(_e,Be,Ft,Tn,$n){this.platformId=_e,this.zone=Be,this.web=Ft,this.fb=Tn,this.dataService=$n,this.divName="boxPlot",this.height=600,this._data={},this.allData=[],this.conditions=[],this.samples=[],this.sampleToBeShow=[],this.lineChartColor=[],this._lineChartData={},this.dataSubject=new ve.X([])}set data(_e){this.updatePlot(_e)}set lineChartData(_e){if(_e.length>0){for(const Be of _e)Be.sample=Be.raw_sample_column.name,Be.gene_names?(Be.gene_names.gene_names in this._lineChartData||(this._lineChartData[Be.gene_names.gene_names]=[]),this._lineChartData[Be.gene_names.gene_names].push(Be)):(Be.primary_id in this._lineChartData||(this._lineChartData[Be.primary_id]=[]),this._lineChartData[Be.primary_id].push(Be));this.lineChartColor=Object.keys(this._lineChartData)}else this.lineChartColor=[],this._lineChartData={};this.updatePlot()}get lineChartData(){return this._lineChartData}updatePlot(_e=[]){_e.length>0&&(this.allData=_e,this.allData.forEach(Ft=>{const Tn=Ft.name.split(".");Tn[0]in this._data||(this._data[Tn[0]]=[]),Ft.sample=Ft.name,Ft.condition=Tn[0],this._data[Tn[0]].push(Ft)}));let Be=[];for(const Ft in this._data){Be=Be.concat(this._data[Ft]);const Tn=Math.ceil(this._data[Ft].length/2);this.sampleToBeShow.push(this._data[Ft][Tn].sample)}this.conditions=Object.keys(this._data),this.dataSubject.next(Be)}ngOnInit(){}browserOnly(_e){(0,$.NF)(this.platformId)&&this.zone.runOutsideAngular(()=>{_e()})}ngAfterViewInit(){this.dataSubject.asObservable().subscribe(_e=>{Object.keys(_e).length>0&&this.drawData(_e,this.lineChartData)})}ngOnDestroy(){this.browserOnly(()=>{this.root&&this.root.dispose()})}drawData(_e,Be){this.browserOnly(()=>{let Ft;void 0!==this.root&&(Ft=this.root,Ft.container.children.clear(),Ft.dispose()),Ft=N.f.new(this.divName),Ft.setThemes([ce.Z.new(Ft),oe.Z.new(Ft)]);let Tn=Ft.container.children.push(fe.z.new(Ft,{panX:!1,panY:!1,wheelX:"none",wheelY:"none",layout:Ft.verticalLayout}));Tn.children.unshift(U._.new(Ft,{text:"Profile plot",fontSize:25,fontWeight:"500",textAlign:"center",x:ee.aQ(50),centerX:ee.aQ(50),paddingTop:0,paddingBottom:0})),Tn.set("cursor",Ae.new(Ft,{})).lineY.set("visible",!1);let or=Tn.yAxes.push(Le.m.new(Ft,{maxDeviation:0,renderer:Me.j.new(Ft,{})}));or.children.unshift(U._.new(Ft,{rotation:-90,text:"log2(Intensity)",y:ee.CI,centerX:ee.CI}));let vr=De.n.new(Ft,{minGridDistance:10}),ur=Tn.xAxes.push(Oe.$.new(Ft,{maxDeviation:0,categoryField:"sample",renderer:vr}));ur.children.push(U._.new(Ft,{text:"Samples",x:ee.CI,centerX:ee.CI}));let Or=Tn.series.push(Ge.new(Ft,{name:"Intensity",xAxis:ur,yAxis:or,valueYField:"q1",openValueYField:"q3",lowValueYField:"low",highValueYField:"high",categoryXField:"sample",tooltip:B.u.new(Ft,{pointerOrientation:"vertical",labelText:"q3: {openValueY}\nlow: {lowValueY}\nhigh: {highValueY}\nq1: {valueY},\nmedian: {med}"})}));Or.columns.template.adapters.add("fill",(ii,le)=>Tn.get("colors").getIndex(this.conditions.indexOf(le.dataItem.dataContext.condition)));let Nr=Tn.series.push(He.new(Ft,{stroke:Ft.interfaceColors.get("background"),xAxis:ur,yAxis:or,categoryXField:"sample",valueYField:"med",noRisers:!0}));if(Or.data.setAll(_e),this.lineChartColor.length>0)for(const ii of this.lineChartColor){let le=Tn.series.push(je.new(Ft,{name:ii,xAxis:ur,yAxis:or,valueYField:"value",categoryXField:"sample",tooltip:B.u.new(Ft,{pointerOrientation:"horizontal",labelText:"{name} in {categoryX}: {valueY}"})}));le.strokes.template.setAll({strokeWidth:3,templateField:"strokeSettings"}),le.data.setAll(Be[ii]),le.bullets.push(()=>J.new(Ft,{sprite:ae.new(Ft,{strokeWidth:3,stroke:le.get("stroke"),radius:5,fill:Ft.interfaceColors.get("background")})})),le.appear(1e3)}ur.data.setAll(_e),vr.labels.template.adapters.add("text",(ii,le,E)=>{if(le.dataItem&&le.dataItem.dataContext&&this.sampleToBeShow.includes(le.dataItem.dataContext.sample))return le.dataItem.dataContext.condition}),Nr.data.setAll(_e),Or.appear(1e3),Tn.appear(1e3,100),this.root=Ft})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.Lbi),t.Y36(t.R0b),t.Y36(k.Q),t.Y36(x.qu),t.Y36(Ke.D))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-boxplot"]],inputs:{data:"data",lineChartData:"lineChartData"},decls:1,vars:5,consts:[[3,"id"]],template:function(_e,Be){1&_e&&t._UZ(0,"div",0),2&_e&&(t.Akn(t.VKq(3,Ze,Be.height+"px")),t.s9C("id",Be.divName))},styles:[""]}),Je})();var lt=Q(9306);function Lt(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"nz-auto-option",7),t.NdJ("click",function(){const Tn=t.CHM(_e).$implicit,$n=t.oxw().$implicit;return t.oxw().selected.emit({control:$n.control,obj:Tn})}),t._uU(1),t.qZA()}if(2&Je){const _e=Dt.$implicit,Be=t.oxw().$implicit;t.Q6J("nzLabel",_e[Be.control])("nzValue",_e),t.xp6(1),t.Oqu(_e[Be.control])}}function Ot(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"nz-form-item")(2,"nz-form-label",2),t._uU(3),t.qZA(),t.TgZ(4,"nz-form-control",3),t._UZ(5,"input",4),t.TgZ(6,"nz-autocomplete",null,5),t.YNc(8,Lt,2,3,"nz-auto-option",6),t.qZA()()(),t.BQk()),2&Je){const _e=Dt.$implicit,Be=t.MAs(7);t.xp6(2),t.s9C("nzFor",_e.control),t.Q6J("nzSm",8)("nzXs",24),t.xp6(1),t.Oqu(_e.label),t.xp6(1),t.Q6J("nzSm",10)("nzXs",24),t.xp6(1),t.s9C("id",_e.control),t.Q6J("formControlName",_e.current)("nzAutocomplete",Be),t.xp6(3),t.Q6J("ngForOf",_e.results)}}let ot=(()=>{class Je{constructor(_e,Be){this.fb=_e,this.web=Be,this._parameters={},this.selected=new t.vpe,this.form=this.fb.group({searchTypes:["gene_names"],current_accession_id:[""],current_gene_names:[""],current_primary_id:[""],gene_names:[""],accession_id:[""],primary_id:[""]}),this.control=[{current:"current_accession_id",control:"accession_id",label:"Accession IDs",results:[],apiPath:"genenamemap",parameterName:"accession_id"},{current:"current_gene_names",control:"gene_names",label:"Gene Names",results:[],apiPath:"genenamemap",parameterName:"gene_names"}]}set parameters(_e){this._parameters=_e;for(let Be=0;Be<this.control.length;Be++)this.control[Be].autocomplete=new j.X(this.control[Be].control,this.web,this.form.controls[this.control[Be].current].valueChanges,this.control[Be].apiPath,this.control[Be].parameterName,_e),this.control[Be].autocomplete.valueObservable.subscribe(Ft=>{this.control[Be].results=Ft.results})}get parameters(){return this._parameters}ngOnInit(){}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(x.qu),t.Y36(k.Q))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-quick-search"]],inputs:{parameters:"parameters"},outputs:{selected:"selected"},decls:2,vars:2,consts:[["nz-form","",3,"formGroup"],[4,"ngFor","ngForOf"],[3,"nzFor","nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","",2,"width","80%","margin-right","8px",3,"id","formControlName","nzAutocomplete"],["autobox",""],[3,"nzLabel","nzValue","click",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue","click"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"form",0),t.YNc(1,Ot,9,10,"ng-container",1),t.qZA()),2&_e&&(t.Q6J("formGroup",Be.form),t.xp6(1),t.Q6J("ngForOf",Be.control))},directives:[x._Y,x.JL,r.Lr,x.sg,$.sg,i.SK,r.Nx,i.t3,r.iK,r.Fd,c.Zp,x.Fj,lt.Pf,x.JJ,x.u,lt.gi,lt.NB],styles:[""]}),Je})();var pt=Q(8054);const qt=["plot"],St=["*"];class Mt{static setModuleName(Dt){Mt.moduleName=Dt}static getModuleName(){return Mt.moduleName}static setPlotly(Dt){if("object"==typeof Dt&&"function"!=typeof Dt.react)throw new Error("Invalid plotly.js version. Please, use any version above 1.40.0");Mt.plotly=Dt}static insert(Dt){return-1===Mt.instances.indexOf(Dt)&&Mt.instances.push(Dt),Dt}static remove(Dt){const _e=Mt.instances.indexOf(Dt);_e>=0&&(Mt.instances.splice(_e,1),Mt.plotly.purge(Dt))}getInstanceByDivId(Dt){for(const _e of Mt.instances)if(_e&&_e.id===Dt)return _e}getPlotly(){return(0,f.mG)(this,void 0,void 0,function*(){return yield this.waitFor(()=>"waiting"!==this._getPlotly()),this._getPlotly()})}_getPlotly(){if(void 0===Mt.plotly)throw new Error("ViaCDN"===Mt.moduleName?"Error loading Peer dependency plotly.js from CDN url":"Peer dependency plotly.js isn't installed");return Mt.plotly}waitFor(Dt){return new Promise(_e=>{const Be=()=>{Dt()?_e():setTimeout(Be,10)};Be()})}newPlot(Dt,_e,Be,Ft,Tn){return(0,f.mG)(this,void 0,void 0,function*(){if(yield this.waitFor(()=>"waiting"!==this._getPlotly()),Tn){const $n={data:_e,layout:Be,config:Ft,frames:Tn};return this._getPlotly().newPlot(Dt,$n).then(()=>Mt.insert(Dt))}return this._getPlotly().newPlot(Dt,_e,Be,Ft).then(()=>Mt.insert(Dt))})}plot(Dt,_e,Be,Ft,Tn){if(Tn){const $n={data:_e,layout:Be,config:Ft,frames:Tn};return"function"==typeof this._getPlotly().plot?this._getPlotly().plot(Dt,$n):this._getPlotly().newPlot(Dt,$n)}return"function"==typeof this._getPlotly().plot?this._getPlotly().plot(Dt,_e,Be,Ft):this._getPlotly().newPlot(Dt,_e,Be,Ft)}update(Dt,_e,Be,Ft,Tn){if(Tn){const $n={data:_e,layout:Be,config:Ft,frames:Tn};return this._getPlotly().react(Dt,$n)}return this._getPlotly().react(Dt,_e,Be,Ft)}resize(Dt){return this._getPlotly().Plots.resize(Dt)}}Mt.\u0275fac=function(Dt){return new(Dt||Mt)},Mt.instances=[],Mt.plotly=void 0,Mt.moduleName=void 0,Mt.\u0275prov=t.Yz7({factory:function(){return new Mt},token:Mt,providedIn:"root"});let Ce=(()=>{class Je{constructor(_e,Be,Ft){this.plotly=_e,this.iterableDiffers=Be,this.keyValueDiffers=Ft,this.defaultClassName="js-plotly-plot",this.revision=0,this.debug=!1,this.useResizeHandler=!1,this.updateOnLayoutChange=!0,this.updateOnDataChange=!0,this.updateOnlyWithRevision=!1,this.initialized=new t.vpe,this.update=new t.vpe,this.purge=new t.vpe,this.error=new t.vpe,this.afterExport=new t.vpe,this.afterPlot=new t.vpe,this.animated=new t.vpe,this.animatingFrame=new t.vpe,this.animationInterrupted=new t.vpe,this.autoSize=new t.vpe,this.beforeExport=new t.vpe,this.buttonClicked=new t.vpe,this.click=new t.vpe,this.plotlyClick=new t.vpe,this.clickAnnotation=new t.vpe,this.deselect=new t.vpe,this.doubleClick=new t.vpe,this.framework=new t.vpe,this.hover=new t.vpe,this.legendClick=new t.vpe,this.legendDoubleClick=new t.vpe,this.react=new t.vpe,this.relayout=new t.vpe,this.restyle=new t.vpe,this.redraw=new t.vpe,this.selected=new t.vpe,this.selecting=new t.vpe,this.sliderChange=new t.vpe,this.sliderEnd=new t.vpe,this.sliderStart=new t.vpe,this.transitioning=new t.vpe,this.transitionInterrupted=new t.vpe,this.unhover=new t.vpe,this.relayouting=new t.vpe,this.treemapclick=new t.vpe,this.sunburstclick=new t.vpe,this.eventNames=["afterExport","afterPlot","animated","animatingFrame","animationInterrupted","autoSize","beforeExport","buttonClicked","clickAnnotation","deselect","doubleClick","framework","hover","legendClick","legendDoubleClick","react","relayout","restyle","redraw","selected","selecting","sliderChange","sliderEnd","sliderStart","transitioning","transitionInterrupted","unhover","relayouting","treemapclick","sunburstclick"]}ngOnInit(){this.createPlot().then(()=>{const _e=this.createFigure();this.initialized.emit(_e)}),this.click.observers.length>0&&console.error("DEPRECATED: Reconsider using `(plotlyClick)` instead of `(click)` to avoid event conflict. Please check https://github.com/plotly/angular-plotly.js#FAQ")}ngOnDestroy(){"function"==typeof this.resizeHandler&&(this.getWindow().removeEventListener("resize",this.resizeHandler),this.resizeHandler=void 0);const _e=this.createFigure();this.purge.emit(_e),Mt.remove(this.plotlyInstance)}ngOnChanges(_e){let Be=!1;const Ft=_e.revision;Ft&&!Ft.isFirstChange()&&(Be=!0);const Tn=_e.debug;Tn&&!Tn.isFirstChange()&&(Be=!0),Be&&this.updatePlot(),this.updateWindowResizeHandler()}ngDoCheck(){if(this.updateOnlyWithRevision)return!1;let _e=!1;this.updateOnLayoutChange&&(this.layoutDiffer?this.layoutDiffer.diff(this.layout)&&(_e=!0):this.layoutDiffer=this.layout?this.keyValueDiffers.find(this.layout).create():void 0),this.updateOnDataChange&&(this.dataDiffer?this.dataDiffer.diff(this.data)&&(_e=!0):this.dataDiffer=Array.isArray(this.data)?this.iterableDiffers.find(this.data).create(this.dataDifferTrackBy):void 0),_e&&this.plotlyInstance&&this.updatePlot()}getWindow(){return window}getClassName(){let _e=[this.defaultClassName];return Array.isArray(this.className)?_e=_e.concat(this.className):this.className&&_e.push(this.className),_e.join(" ")}createPlot(){return this.plotly.newPlot(this.plotEl.nativeElement,this.data,this.layout,this.config,this.frames).then(_e=>{this.plotlyInstance=_e,this.getWindow().gd=this.debug?_e:void 0,this.eventNames.forEach(Be=>{const Ft=`plotly_${Be.toLowerCase()}`;_e.on(Ft,Tn=>this[Be].emit(Tn))}),_e.on("plotly_click",Be=>{this.click.emit(Be),this.plotlyClick.emit(Be)}),this.updateWindowResizeHandler()},_e=>{console.error("Error while plotting:",_e),this.error.emit(_e)})}createFigure(){const _e=this.plotlyInstance;return{data:_e.data,layout:_e.layout,frames:_e._transitionData?_e._transitionData._frames:null}}updatePlot(){if(!this.plotlyInstance){const Be=new Error("Plotly component wasn't initialized");throw this.error.emit(Be),Be}const _e=Object.assign({},this.layout);return this.plotly.update(this.plotlyInstance,this.data,_e,this.config,this.frames).then(()=>{const Be=this.createFigure();this.update.emit(Be)},Be=>{console.error("Error while updating plot:",Be),this.error.emit(Be)})}updateWindowResizeHandler(){this.useResizeHandler?void 0===this.resizeHandler&&(this.resizeHandler=()=>this.plotly.resize(this.plotlyInstance),this.getWindow().addEventListener("resize",this.resizeHandler)):"function"==typeof this.resizeHandler&&(this.getWindow().removeEventListener("resize",this.resizeHandler),this.resizeHandler=void 0)}dataDifferTrackBy(_e,Be){const Ft=Object.assign({},Be,{uid:""});return JSON.stringify(Ft)}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(Mt),t.Y36(t.ZZ4),t.Y36(t.aQg))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["plotly-plot"]],viewQuery:function(_e,Be){if(1&_e&&t.Gf(qt,7),2&_e){let Ft;t.iGM(Ft=t.CRH())&&(Be.plotEl=Ft.first)}},inputs:{revision:"revision",debug:"debug",useResizeHandler:"useResizeHandler",updateOnLayoutChange:"updateOnLayoutChange",updateOnDataChange:"updateOnDataChange",updateOnlyWithRevision:"updateOnlyWithRevision",data:"data",layout:"layout",config:"config",frames:"frames",style:"style",divId:"divId",className:"className"},outputs:{initialized:"initialized",update:"update",purge:"purge",error:"error",afterExport:"afterExport",afterPlot:"afterPlot",animated:"animated",animatingFrame:"animatingFrame",animationInterrupted:"animationInterrupted",autoSize:"autoSize",beforeExport:"beforeExport",buttonClicked:"buttonClicked",click:"click",plotlyClick:"plotlyClick",clickAnnotation:"clickAnnotation",deselect:"deselect",doubleClick:"doubleClick",framework:"framework",hover:"hover",legendClick:"legendClick",legendDoubleClick:"legendDoubleClick",react:"react",relayout:"relayout",restyle:"restyle",redraw:"redraw",selected:"selected",selecting:"selecting",sliderChange:"sliderChange",sliderEnd:"sliderEnd",sliderStart:"sliderStart",transitioning:"transitioning",transitionInterrupted:"transitionInterrupted",unhover:"unhover",relayouting:"relayouting",treemapclick:"treemapclick",sunburstclick:"sunburstclick"},features:[t._Bn([Mt]),t.TTD],ngContentSelectors:St,decls:3,vars:3,consts:[[3,"ngClass","ngStyle"],["plot",""]],template:function(_e,Be){1&_e&&(t.F$t(),t.TgZ(0,"div",0,1),t.Hsn(2),t.qZA()),2&_e&&(t.Q6J("ngClass",Be.getClassName())("ngStyle",Be.style),t.uIk("id",Be.divId))},directives:[$.mk,$.PC],encapsulation:2}),Je})(),Xe=(()=>{class Je{constructor(){}}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({providers:[Mt],imports:[[$.ez]]}),Je})(),st=(()=>{class Je{constructor(){if(!this.isValid())throw new Error("Invalid PlotlyJS object. Please check https://github.com/plotly/angular-plotly.js#quick-start to see how to add PlotlyJS to your project.");Mt.setPlotly(Je.plotlyjs)}isValid(){return void 0!==Je.plotlyjs&&("function"==typeof Je.plotlyjs.plot||"function"==typeof Je.plotlyjs.newPlot)}}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({providers:[Mt],imports:[[$.ez,Xe],Xe]}),Je.plotlyjs={},Je})();function Ht(Je,Dt){if(1&Je){const _e=t.EpF();t.ynx(0),t.TgZ(1,"plotly-plot",1),t.NdJ("plotlyClick",function(Ft){return t.CHM(_e),t.oxw().selectData(Ft)})("selected",function(Ft){return t.CHM(_e),t.oxw().selectData(Ft)}),t.qZA(),t.BQk()}if(2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("divId",_e.divName)("data",_e.graphData)("layout",_e.graphLayout)("updateOnDataChange",!0)("updateOnLayoutChange",!0)}}let Kt=(()=>{class Je{constructor(_e){this.fb=_e,this.graphData=[],this.graphLayout={height:700,width:900,xaxis:{title:"Log2FC",automargin:!0},yaxis:{title:"-log10(p-value)",automargin:!0},annotations:[],showlegend:!0,legend:{orientation:"h"},title:{text:"Differrential Analysis Volcano Plot",font:{size:24}}},this.nameToID={},this.divName="volcanoPlot",this._data={},this.allData=[],this.allowSelection=!0,this.xSettings={min:null,max:null},this.ySettings={min:null,max:null},this.selectedMap={},this.defaultColorList=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],this.colorMap={},this.form=this.fb.group({pCutoff:[1.5,x.kI.required],fcCutoff:[.5,x.kI.required],minX:[null],maxX:[null],minY:[null],maxY:[null]}),this.selected=new t.vpe,this.dataSubject=new ve.X([]),this.breakColor=!1}set data(_e){this.updatePlot(_e)}set parameters(_e){this.form=_e,this.updatePlot()}set externalSelection(_e){let Be=!1;if("gene_names"===_e.selection_type||"accession_id"===_e.selection_type)for(const Ft in this.nameToID)this.nameToID[Ft].gene_names&&(this.nameToID[Ft].gene_names.gene_names.startsWith("PPM1H")&&console.log(this.nameToID[Ft]),this.nameToID[Ft].gene_names.id===_e.value.id&&(this.nameToID[Ft].id in this.selectedMap||(this.selectedMap[this.nameToID[Ft].id]=[]),this.selectedMap[this.nameToID[Ft].id].push(_e.title),Be=!0));Be&&(this.updatePlot(),this.selected.emit(Object.keys(this.selectedMap)))}updatePlot(_e=[]){_e.length>0&&(this.allData=_e),this._data={},this.allData.forEach(Be=>{const Ft=this.getLabel(Be.fold_change,Be.significant);if(Be.text=Be.gene_names?`<b>Gene names:</b> ${Be.gene_names.gene_names}<br><b>Primary ID:</b> ${Be.primary_id}`:`<b>Primary ID:</b> ${Be.primary_id}`,Be.ptm_data&&(Be.text=Be.text+`<br><b>Position in Protein: </b> ${Be.ptm_position}<br><b>Position in Peptide:</b> ${Be.ptm_position_in_peptide}<br><b>Peptide Sequence: ${Be.peptide_sequence}</b>`),this.nameToID[Be.text]=Be,this.xSettings.min?this.xSettings.min>Be.fold_change&&(this.xSettings.min=Be.fold_change):this.xSettings.min=Be.fold_change,this.xSettings.max?this.xSettings.max<Be.fold_change&&(this.xSettings.max=Be.fold_change):this.xSettings.max=Be.fold_change,this.ySettings.min?this.ySettings.min>Be.significant&&(this.ySettings.min=Be.significant):this.ySettings.min=Be.significant,this.ySettings.max?this.ySettings.max<Be.significant&&(this.ySettings.max=Be.significant):this.ySettings.max=Be.significant,Ft in this._data||(this._data[Ft]=[]),Be.selected&&("Current selections"in this._data||(this._data["Current selections"]=[]),this._data["Current selections"].push(Be)),this._data[Ft].push(Be),Be.id in this.selectedMap)for(const Tn of this.selectedMap[Be.id])Tn in this._data||(this._data[Tn]=[]),this._data[Tn].push(Be)}),this.dataSubject.next(this._data)}getLabel(_e,Be){let Ft="";return Ft=Math.abs(_e)>=this.form.value.fcCutoff?Ft+"FC >= "+this.form.value.fcCutoff:Ft+"FC < "+this.form.value.fcCutoff,Ft+="; ",Ft=Be>=this.form.value.pCutoff?Ft+"Significant >= "+this.form.value.pCutoff:Ft+"Significant < "+this.form.value.pCutoff,Ft}ngOnInit(){}ngAfterContentInit(){this.dataSubject.asObservable().subscribe(_e=>{this.drawVolcanoPlot()})}drawVolcanoPlot(){null!==this.form.value.minY&&(this.ySettings.min=this.form.value.minY),null!==this.form.value.maxY&&(this.ySettings.max=this.form.value.maxY),null!==this.form.value.minX&&(this.xSettings.min=this.form.value.minX),null!==this.form.value.maxX&&(this.xSettings.max=this.form.value.maxX);let _e=0,Be=[],Ft={};this.colorMap&&(Be=Object.values(this.colorMap));for(const or in this._data){if(!this.colorMap[or]){for(;;){if(this.breakColor){this.colorMap[or]=this.defaultColorList[_e];break}if(-1!==Be.indexOf(this.defaultColorList[_e]))_e++;else{if(_e!==this.defaultColorList.length){this.colorMap[or]=this.defaultColorList[_e];break}this.breakColor=!0,_e=0}}_e++,_e===this.defaultColorList.length&&(_e=0)}Ft[or]={x:[],y:[],text:[],type:"scattergl",mode:"markers",name:or,marker:{color:this.colorMap[or]}},this._data[or].forEach(vr=>{Ft[or].x.push(vr.fold_change),Ft[or].y.push(vr.significant),Ft[or].text.push(vr.text)})}const Tn=[];for(const or in Ft)Tn.push(Ft[or]);const $n=[];$n.push({type:"line",x0:-this.form.value.fcCutoff,x1:-this.form.value.fcCutoff,y0:0,y1:this.ySettings.max+.5,line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),$n.push({type:"line",x0:this.form.value.fcCutoff,x1:this.form.value.fcCutoff,y0:0,y1:this.ySettings.max+.5,line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),$n.push({type:"line",x0:this.xSettings.min-.5,x1:this.xSettings.max+.5,y0:this.form.value.pCutoff,y1:this.form.value.pCutoff,line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),this.graphLayout.xaxis.range=[this.xSettings.min-.5,this.xSettings.max+.5],this.graphLayout.yaxis.range=[0,this.ySettings.max+.5],this.graphLayout.shapes=$n,this.graphData=Tn}selectData(_e){if(this.allowSelection&&"points"in _e){const Be=[];for(const Ft of _e.points)if(this.nameToID[Ft.text]){let Tn=`${this.nameToID[Ft.text].primary_id}`;this.nameToID[Ft.text].gene_names&&(Tn+=` - ${this.nameToID[Ft.text].gene_names.gene_names}`),Be.push(this.nameToID[Ft.text].id),this.nameToID[Ft.text].id in this.selectedMap?this.selectedMap[this.nameToID[Ft.text].id].includes(Tn)||this.selectedMap[this.nameToID[Ft.text].id].push(Tn):this.selectedMap[this.nameToID[Ft.text].id]=[Tn]}Be.length>0&&this.selected.emit(Object.keys(this.selectedMap)),this.updatePlot()}}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(x.qu))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-volcano-plotly"]],inputs:{data:"data",allowSelection:"allowSelection",parameters:"parameters",externalSelection:"externalSelection"},outputs:{selected:"selected"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"divId","data","layout","updateOnDataChange","updateOnLayoutChange","plotlyClick","selected"]],template:function(_e,Be){1&_e&&t.YNc(0,Ht,2,5,"ng-container",0),2&_e&&t.Q6J("ngIf",Be.graphData.length>0)},directives:[$.O5,Ce],styles:[""]}),Je})(),Zt=(()=>{class Je{constructor(_e){this.fb=_e,this.output=new t.vpe,this.form=this.fb.group({pCutoff:[1.5,x.kI.required],fcCutoff:[.5,x.kI.required],minX:[null],maxX:[null],minY:[null],maxY:[null]})}ngOnInit(){}provideSettings(){const _e=this.fb.group({pCutoff:[1.5,x.kI.required],fcCutoff:[.5,x.kI.required],minX:[null],maxX:[null],minY:[null],maxY:[null]});for(const Be in this.form.controls)_e.controls[Be].setValue(this.form.value[Be]);this.output.emit(_e)}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(x.qu))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-volcano-plot-settings"]],outputs:{output:"output"},decls:36,vars:1,consts:[["nz-typography",""],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","pCutoff","nzSpan","12"],["nzSpan","5"],["nz-input","","id","pCutoff","type","number","formControlName","pCutoff"],["nzFor","fcCutoff","nzSpan","12"],["nz-input","","id","fcCutoff","type","number","formControlName","fcCutoff"],["nzFor","minX","nzSpan","12"],["nz-input","","id","minX","type","number","formControlName","minX"],["nzFor","maxX","nzSpan","12"],["nz-input","","id","maxX","type","number","formControlName","maxX"],["nzFor","minY","nzSpan","12"],["nz-input","","id","minY","type","number","formControlName","minY"],["nzFor","maxY","nzSpan","12"],["nz-input","","id","maxY","type","number","formControlName","maxY"],["nzJustify","center"],["nz-button","","nzType","primary","type","submit"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"h5",0),t._uU(1,"Volcano Plot Settings"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return Be.provideSettings()}),t.TgZ(3,"nz-form-item")(4,"nz-form-label",2),t._uU(5,"-log10(p-value) cut-off"),t.qZA(),t.TgZ(6,"nz-form-control",3),t._UZ(7,"input",4),t.qZA()(),t.TgZ(8,"nz-form-item")(9,"nz-form-label",5),t._uU(10,"log2(FC) cut-off"),t.qZA(),t.TgZ(11,"nz-form-control",3),t._UZ(12,"input",6),t.qZA()(),t.TgZ(13,"nz-form-item")(14,"nz-form-label",7),t._uU(15,"Min X axis value"),t.qZA(),t.TgZ(16,"nz-form-control",3),t._UZ(17,"input",8),t.qZA()(),t.TgZ(18,"nz-form-item")(19,"nz-form-label",9),t._uU(20,"Max X axis value"),t.qZA(),t.TgZ(21,"nz-form-control",3),t._UZ(22,"input",10),t.qZA()(),t.TgZ(23,"nz-form-item")(24,"nz-form-label",11),t._uU(25,"Min Y axis value"),t.qZA(),t.TgZ(26,"nz-form-control",3),t._UZ(27,"input",12),t.qZA()(),t.TgZ(28,"nz-form-item")(29,"nz-form-label",13),t._uU(30,"Max Y axis value"),t.qZA(),t.TgZ(31,"nz-form-control",3),t._UZ(32,"input",14),t.qZA()(),t.TgZ(33,"nz-form-item",15)(34,"button",16),t._uU(35,"Redraw plot"),t.qZA()()()),2&_e&&(t.xp6(2),t.Q6J("formGroup",Be.form))},directives:[ne.ZU,x._Y,x.JL,r.Lr,x.sg,i.SK,r.Nx,i.t3,r.iK,r.Fd,c.Zp,x.wV,x.Fj,x.JJ,x.u,m.ix,p.dQ,s.w],styles:[""]}),Je})();function vn(Je,Dt){1&Je&&t._UZ(0,"nz-list-item-meta-avatar",14),2&Je&&t.Q6J("nzSrc","/assets/avatars/phosphorylation.png")}function zn(Je,Dt){1&Je&&t._UZ(0,"nz-list-item-meta-avatar",14),2&Je&&t.Q6J("nzSrc","/assets/avatars/total_proteomics.png")}function gn(Je,Dt){if(1&Je&&(t.TgZ(0,"a",15)(1,"span",16)(2,"b"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5," (PTM)"),t.qZA()()()),2&Je){const _e=t.oxw().$implicit;t.cQ8("href","#/project-explorer/protein-viewer/",_e.gene_names.gene_names,"/",_e.comparison.id,"/",_e.id,"/1",t.LSH),t.xp6(3),t.Oqu(_e.primary_id)}}function nn(Je,Dt){if(1&Je&&(t.TgZ(0,"a",15)(1,"b"),t._uU(2),t.qZA()()),2&Je){const _e=t.oxw().$implicit;t.cQ8("href","#/project-explorer/protein-viewer/",_e.gene_names.gene_names,"/",_e.comparison.id,"/",_e.id,"/0",t.LSH),t.xp6(2),t.Oqu(_e.primary_id)}}function an(Je,Dt){if(1&Je&&(t.TgZ(0,"span",17),t._UZ(1,"span",18),t._uU(2),t.qZA()),2&Je){const _e=t.oxw().$implicit;t.xp6(2),t.hij(" log2(FC): ",_e.fold_change," ")}}function on(Je,Dt){if(1&Je&&(t.TgZ(0,"span",19),t._UZ(1,"span",20),t._uU(2),t.qZA()),2&Je){const _e=t.oxw().$implicit;t.xp6(2),t.hij(" log2(FC): ",_e.fold_change," ")}}function mn(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-col",9)(1,"p")(2,"span")(3,"b",10),t._uU(4,"Associated Project: "),t.qZA(),t.TgZ(5,"a",21)(6,"b"),t._uU(7),t.qZA()()()()()),2&Je){const _e=t.oxw().$implicit;t.xp6(5),t.MGl("href","#/project-explorer/details/",_e.comparison.file.project.id,"",t.LSH),t.xp6(2),t.Oqu(_e.comparison.file.project.title)}}function _n(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"nz-row",8)(2,"nz-col",9)(3,"p")(4,"span",16)(5,"b"),t._uU(6,"Probability Score:"),t.qZA()(),t._uU(7),t.qZA()(),t.TgZ(8,"nz-col",9)(9,"p")(10,"span",16)(11,"b"),t._uU(12,"Peptide Sequence:"),t.qZA()(),t._uU(13),t.qZA()(),t.TgZ(14,"nz-col",9)(15,"p")(16,"span",16)(17,"b"),t._uU(18,"PTM Position in Peptide:"),t.qZA()(),t._uU(19),t.qZA()(),t.TgZ(20,"nz-col",9)(21,"p")(22,"span",16)(23,"b"),t._uU(24,"PTM Position in Protein:"),t.qZA()(),t._uU(25),t.qZA()(),t.TgZ(26,"nz-col",9)(27,"p")(28,"span",16)(29,"b"),t._uU(30,"Sequence Window:"),t.qZA()(),t._uU(31),t.qZA()()(),t.BQk()),2&Je){const _e=t.oxw().$implicit;t.xp6(7),t.hij(" ",_e.probability_score,""),t.xp6(6),t.hij(" ",_e.peptide_sequence,""),t.xp6(6),t.hij(" ",_e.ptm_position_in_peptide,""),t.xp6(6),t.hij(" ",_e.ptm_position,""),t.xp6(6),t.hij(" ",_e.sequence_window,"")}}function Pn(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-list-item")(1,"nz-list-item-meta"),t.YNc(2,vn,1,1,"nz-list-item-meta-avatar",2),t.YNc(3,zn,1,1,"nz-list-item-meta-avatar",2),t.TgZ(4,"nz-list-item-meta-title"),t.YNc(5,gn,6,4,"a",3),t.YNc(6,nn,3,4,"a",3),t.YNc(7,an,3,1,"span",4),t.YNc(8,on,3,1,"ng-template",null,5,t.W1O),t.TgZ(10,"span",6),t._UZ(11,"span",7),t._uU(12),t.qZA()(),t.TgZ(13,"nz-list-item-meta-description")(14,"nz-row",8)(15,"nz-col",9)(16,"p")(17,"span",10)(18,"b"),t._uU(19,"Gene name:"),t.qZA()(),t._uU(20),t.qZA()(),t.TgZ(21,"nz-col",9)(22,"p")(23,"span")(24,"b",10),t._uU(25,"Comparison: "),t.qZA(),t.TgZ(26,"span",11)(27,"b"),t._uU(28),t.qZA()()()()(),t.YNc(29,mn,8,2,"nz-col",12),t.qZA(),t.YNc(30,_n,32,5,"ng-container",13),t.qZA()()()),2&Je){const _e=Dt.$implicit,Be=t.MAs(9);t.xp6(2),t.Q6J("ngIf",_e.ptm_data),t.xp6(1),t.Q6J("ngIf",!_e.ptm_data),t.xp6(2),t.Q6J("ngIf",_e.ptm_data),t.xp6(1),t.Q6J("ngIf",!_e.ptm_data),t.xp6(1),t.Q6J("ngIf",_e.fold_change>0)("ngIfElse",Be),t.xp6(4),t.Q6J("nzTheme","outline"),t.xp6(1),t.hij(" -log10(P-value): ",_e.significant," "),t.xp6(8),t.hij(" ",_e.gene_names.gene_names," "),t.xp6(8),t.Oqu(_e.comparison.name),t.xp6(1),t.Q6J("ngIf",_e.comparison.file.project),t.xp6(1),t.Q6J("ngIf",_e.ptm_data)}}let Rn=(()=>{class Je{constructor(_e){this.cdr=_e,this._data=[],this.loading=!1}set data(_e){this.change([..._e.results])}get data(){return this._data}ngOnChanges(_e){console.log(_e)}ngOnInit(){}change(_e){this.loading=!0,console.log(_e),_e.length>0?setTimeout(()=>{console.log(_e),this._data=_e,this.loading=!1,this.cdr.detectChanges()},1e3):setTimeout(()=>{console.log(_e),this._data=[],this.loading=!1,this.cdr.detectChanges()},1e3)}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.sBO))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-data-table"]],inputs:{data:"data"},features:[t.TTD],decls:2,vars:2,consts:[["nzItemLayout","vertical",3,"nzLoading"],[4,"ngFor","ngForOf"],[3,"nzSrc",4,"ngIf"],["target","_blank","style","padding-right: 20px",3,"href",4,"ngIf"],["style","color: rgb(76,143,0)",4,"ngIf","ngIfElse"],["foldChangeNegative",""],[2,"color","rgb(5,0,143)"],["nz-icon","","nzType","exclamation",3,"nzTheme"],["nzJustify","start"],["nzSpan","6"],[2,"color","#554994"],[2,"color","#FF9494"],["nzSpan","6",4,"ngIf"],[4,"ngIf"],[3,"nzSrc"],["target","_blank",2,"padding-right","20px",3,"href"],[2,"color","#7F669D"],[2,"color","rgb(76,143,0)"],["nz-icon","","nzType","up","nzTheme","outline",2,"margin-right","8px"],[2,"color","rgb(143,0,0)"],["nz-icon","","nzType","down","nzTheme","outline",2,"margin-right","8px"],["target","_blank",3,"href"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"nz-list",0),t.YNc(1,Pn,31,12,"nz-list-item",1),t.qZA()),2&_e&&(t.Q6J("nzLoading",Be.loading),t.xp6(1),t.Q6J("ngForOf",Be.data))},directives:[b.n_,$.sg,b.AA,b.yi,$.O5,b.Vk,b.IO,s.w,V.Ls,b.Pb,i.SK,i.t3],styles:[""]}),Je})();var qn=Q(9776),Xn=Q(7429),br=Q(4968),fr=Q(9770),Vr=Q(2722),cr=Q(9300),Sr=Q(5698),Cr=Q(8675),pi=Q(6947),Yn=Q(6360),ar=Q(1777),Ar=Q(6987),sr=Q(5664),dr=Q(9439),$r=Q(4170);Q(2313);class ri{transform(Dt,_e=0,Be="B",Ft){if(!((0,l.ui)(Dt)&&(0,l.ui)(_e)&&_e%1==0&&_e>=0))return Dt;let Tn=Dt,$n=Be;for(;"B"!==$n;)Tn*=1024,$n=ri.formats[$n].prev;if(Ft){const vr=(0,l.YM)(ri.calculateResult(ri.formats[Ft],Tn),_e);return ri.formatResult(vr,Ft)}for(const or in ri.formats)if(ri.formats.hasOwnProperty(or)){const vr=ri.formats[or];if(Tn<vr.max){const ur=(0,l.YM)(ri.calculateResult(vr,Tn),_e);return ri.formatResult(ur,or)}}}static formatResult(Dt,_e){return`${Dt} ${_e}`}static calculateResult(Dt,_e){const Be=Dt.prev?ri.formats[Dt.prev]:void 0;return Be?_e/Be.max:_e}}ri.formats={B:{max:1024},kB:{max:Math.pow(1024,2),prev:"B"},KB:{max:Math.pow(1024,2),prev:"B"},MB:{max:Math.pow(1024,3),prev:"kB"},GB:{max:Math.pow(1024,4),prev:"MB"},TB:{max:Number.MAX_SAFE_INTEGER,prev:"GB"}},ri.\u0275fac=function(Dt){return new(Dt||ri)},ri.\u0275pipe=t.Yjl({name:"nzBytes",type:ri,pure:!0});let sn=(()=>{class Je{transform(_e,Be="px"){let vr="px";return["cm","mm","Q","in","pc","pt","px","em","ex","ch","rem","1h","vw","vh","vmin","vmax","%"].some(ur=>ur===Be)&&(vr=Be),"number"==typeof _e?`${_e}${vr}`:`${_e}`}}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275pipe=t.Yjl({name:"nzToCssUnit",type:Je,pure:!0}),Je})(),Un=(()=>{class Je{}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({imports:[[$.ez]]}),Je})();var jn=Q(1159),On=Q(4832);const kn=["nz-modal-close",""];function Mn(Je,Dt){if(1&Je&&(t.ynx(0),t._UZ(1,"i",2),t.BQk()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.Q6J("nzType",_e)}}const Ln=["modalElement"];function Dn(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){return t.CHM(_e),t.oxw().onCloseClick()}),t.qZA()}}function Kn(Je,Dt){if(1&Je&&(t.ynx(0),t._UZ(1,"span",17),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("innerHTML",_e.config.nzTitle,t.oJD)}}function Qn(Je,Dt){}function lr(Je,Dt){if(1&Je&&t._UZ(0,"div",17),2&Je){const _e=t.oxw();t.Q6J("innerHTML",_e.config.nzContent,t.oJD)}}function hr(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){return t.CHM(_e),t.oxw().onCancel()}),t._uU(1),t.qZA()}if(2&Je){const _e=t.oxw();t.Q6J("nzLoading",!!_e.config.nzCancelLoading)("disabled",_e.config.nzCancelDisabled),t.uIk("cdkFocusInitial","cancel"===_e.config.nzAutofocus||null),t.xp6(1),t.hij(" ",_e.config.nzCancelText||_e.locale.cancelText," ")}}function Mr(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){return t.CHM(_e),t.oxw().onOk()}),t._uU(1),t.qZA()}if(2&Je){const _e=t.oxw();t.Q6J("nzType",_e.config.nzOkType)("nzLoading",!!_e.config.nzOkLoading)("disabled",_e.config.nzOkDisabled)("nzDanger",_e.config.nzOkDanger),t.uIk("cdkFocusInitial","ok"===_e.config.nzAutofocus||null),t.xp6(1),t.hij(" ",_e.config.nzOkText||_e.locale.okText," ")}}const Er=["nz-modal-title",""];function Pr(Je,Dt){if(1&Je&&(t.ynx(0),t._UZ(1,"div",2),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("innerHTML",_e.config.nzTitle,t.oJD)}}const Ur=["nz-modal-footer",""];function Yr(Je,Dt){if(1&Je&&t._UZ(0,"div",5),2&Je){const _e=t.oxw(3);t.Q6J("innerHTML",_e.config.nzFooter,t.oJD)}}function si(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const Tn=t.CHM(_e).$implicit;return t.oxw(4).onButtonClick(Tn)}),t._uU(1),t.qZA()}if(2&Je){const _e=Dt.$implicit,Be=t.oxw(4);t.Q6J("hidden",!Be.getButtonCallableProp(_e,"show"))("nzLoading",Be.getButtonCallableProp(_e,"loading"))("disabled",Be.getButtonCallableProp(_e,"disabled"))("nzType",_e.type)("nzDanger",_e.danger)("nzShape",_e.shape)("nzSize",_e.size)("nzGhost",_e.ghost),t.xp6(1),t.hij(" ",_e.label," ")}}function Fi(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,si,2,9,"button",6),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",_e.buttons)}}function Ri(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,Yr,1,1,"div",3),t.YNc(2,Fi,2,1,"ng-container",4),t.BQk()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!_e.buttonsFooter),t.xp6(1),t.Q6J("ngIf",_e.buttonsFooter)}}const Fr=function(Je,Dt){return{$implicit:Je,modalRef:Dt}};function fi(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,Ri,3,2,"ng-container",2),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.config.nzFooter)("nzStringTemplateOutletContext",t.WLB(2,Fr,_e.config.nzComponentParams,_e.modalRef))}}function ci(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).onCancel()}),t._uU(1),t.qZA()}if(2&Je){const _e=t.oxw(2);t.Q6J("nzLoading",!!_e.config.nzCancelLoading)("disabled",_e.config.nzCancelDisabled),t.uIk("cdkFocusInitial","cancel"===_e.config.nzAutofocus||null),t.xp6(1),t.hij(" ",_e.config.nzCancelText||_e.locale.cancelText," ")}}function Yi(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).onOk()}),t._uU(1),t.qZA()}if(2&Je){const _e=t.oxw(2);t.Q6J("nzType",_e.config.nzOkType)("nzDanger",_e.config.nzOkDanger)("nzLoading",!!_e.config.nzOkLoading)("disabled",_e.config.nzOkDisabled),t.uIk("cdkFocusInitial","ok"===_e.config.nzAutofocus||null),t.xp6(1),t.hij(" ",_e.config.nzOkText||_e.locale.okText," ")}}function Ta(Je,Dt){if(1&Je&&(t.YNc(0,ci,2,4,"button",8),t.YNc(1,Yi,2,6,"button",9)),2&Je){const _e=t.oxw();t.Q6J("ngIf",null!==_e.config.nzCancelText),t.xp6(1),t.Q6J("ngIf",null!==_e.config.nzOkText)}}function Ba(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(_e),t.oxw().onCloseClick()}),t.qZA()}}function go(Je,Dt){1&Je&&t._UZ(0,"div",10)}function ra(Je,Dt){}function ia(Je,Dt){if(1&Je&&t._UZ(0,"div",11),2&Je){const _e=t.oxw();t.Q6J("innerHTML",_e.config.nzContent,t.oJD)}}function so(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"div",12),t.NdJ("cancelTriggered",function(){return t.CHM(_e),t.oxw().onCloseClick()})("okTriggered",function(){return t.CHM(_e),t.oxw().onOkClick()}),t.qZA()}if(2&Je){const _e=t.oxw();t.Q6J("modalRef",_e.modalRef)}}const Zi=()=>{};class Ra{constructor(){this.nzCentered=!1,this.nzClosable=!0,this.nzOkLoading=!1,this.nzOkDisabled=!1,this.nzCancelDisabled=!1,this.nzCancelLoading=!1,this.nzNoAnimation=!1,this.nzAutofocus="auto",this.nzKeyboard=!0,this.nzZIndex=1e3,this.nzWidth=520,this.nzCloseIcon="close",this.nzOkType="primary",this.nzOkDanger=!1,this.nzModalType="default",this.nzOnCancel=Zi,this.nzOnOk=Zi,this.nzIconType="question-circle"}}const Xa="ant-modal-mask",no="modal",_o={modalContainer:(0,ar.X$)("modalContainer",[(0,ar.SB)("void, exit",(0,ar.oB)({})),(0,ar.SB)("enter",(0,ar.oB)({})),(0,ar.eR)("* => enter",(0,ar.jt)(".24s",(0,ar.oB)({}))),(0,ar.eR)("* => void, * => exit",(0,ar.jt)(".2s",(0,ar.oB)({})))])};function xa(Je,Dt,_e){return void 0===Je?void 0===Dt?_e:Dt:Je}function ds(Je){const{nzCentered:Dt,nzMask:_e,nzMaskClosable:Be,nzClosable:Ft,nzOkLoading:Tn,nzOkDisabled:$n,nzCancelDisabled:or,nzCancelLoading:vr,nzKeyboard:ur,nzNoAnimation:Or,nzContent:Nr,nzComponentParams:ii,nzFooter:le,nzZIndex:E,nzWidth:I,nzWrapClassName:F,nzClassName:H,nzStyle:re,nzTitle:ue,nzCloseIcon:ye,nzMaskStyle:ke,nzBodyStyle:Ee,nzOkText:Ue,nzCancelText:$e,nzOkType:it,nzOkDanger:_t,nzIconType:Ct,nzModalType:At,nzOnOk:Et,nzOnCancel:Tt,nzAfterOpen:jt,nzAfterClose:Nt,nzCloseOnNavigation:Yt,nzAutofocus:ln}=Je;return{nzCentered:Dt,nzMask:_e,nzMaskClosable:Be,nzClosable:Ft,nzOkLoading:Tn,nzOkDisabled:$n,nzCancelDisabled:or,nzCancelLoading:vr,nzKeyboard:ur,nzNoAnimation:Or,nzContent:Nr,nzComponentParams:ii,nzFooter:le,nzZIndex:E,nzWidth:I,nzWrapClassName:F,nzClassName:H,nzStyle:re,nzTitle:ue,nzCloseIcon:ye,nzMaskStyle:ke,nzBodyStyle:Ee,nzOkText:Ue,nzCancelText:$e,nzOkType:it,nzOkDanger:_t,nzIconType:Ct,nzModalType:At,nzOnOk:Et,nzOnCancel:Tt,nzAfterOpen:jt,nzAfterClose:Nt,nzCloseOnNavigation:Yt,nzAutofocus:ln}}function bs(){throw Error("Attempting to attach modal content after content is already attached")}let ta=(()=>{class Je extends Xn.en{constructor(_e,Be,Ft,Tn,$n,or,vr,ur,Or,Nr){super(),this.ngZone=_e,this.host=Be,this.focusTrapFactory=Ft,this.cdr=Tn,this.render=$n,this.overlayRef=or,this.nzConfigService=vr,this.config=ur,this.animationType=Nr,this.animationStateChanged=new t.vpe,this.containerClick=new t.vpe,this.cancelTriggered=new t.vpe,this.okTriggered=new t.vpe,this.state="enter",this.isStringContent=!1,this.dir="ltr",this.elementFocusedBeforeModalWasOpened=null,this.mouseDown=!1,this.oldMaskStyle=null,this.destroy$=new q.x,this.document=Or,this.dir=or.getDirection(),this.isStringContent="string"==typeof ur.nzContent,this.nzConfigService.getConfigChangeEventForComponent(no).pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.updateMaskClassname()})}get showMask(){const _e=this.nzConfigService.getConfigForComponent(no)||{};return!!xa(this.config.nzMask,_e.nzMask,!0)}get maskClosable(){const _e=this.nzConfigService.getConfigForComponent(no)||{};return!!xa(this.config.nzMaskClosable,_e.nzMaskClosable,!0)}onContainerClick(_e){_e.target===_e.currentTarget&&!this.mouseDown&&this.showMask&&this.maskClosable&&this.containerClick.emit()}onCloseClick(){this.cancelTriggered.emit()}onOkClick(){this.okTriggered.emit()}attachComponentPortal(_e){return this.portalOutlet.hasAttached()&&bs(),this.savePreviouslyFocusedElement(),this.setZIndexForBackdrop(),this.portalOutlet.attachComponentPortal(_e)}attachTemplatePortal(_e){return this.portalOutlet.hasAttached()&&bs(),this.savePreviouslyFocusedElement(),this.setZIndexForBackdrop(),this.portalOutlet.attachTemplatePortal(_e)}attachStringContent(){this.savePreviouslyFocusedElement(),this.setZIndexForBackdrop()}getNativeElement(){return this.host.nativeElement}animationDisabled(){return this.config.nzNoAnimation||"NoopAnimations"===this.animationType}setModalTransformOrigin(){const _e=this.modalElementRef.nativeElement;if(this.elementFocusedBeforeModalWasOpened){const Be=this.elementFocusedBeforeModalWasOpened.getBoundingClientRect(),Ft=(0,l.pW)(this.elementFocusedBeforeModalWasOpened);this.render.setStyle(_e,"transform-origin",`${Ft.left+Be.width/2-_e.offsetLeft}px ${Ft.top+Be.height/2-_e.offsetTop}px 0px`)}}savePreviouslyFocusedElement(){this.focusTrap||(this.focusTrap=this.focusTrapFactory.create(this.host.nativeElement)),this.document&&(this.elementFocusedBeforeModalWasOpened=this.document.activeElement,this.host.nativeElement.focus&&this.ngZone.runOutsideAngular(()=>(0,Ar.e)(()=>this.host.nativeElement.focus())))}trapFocus(){const _e=this.host.nativeElement;if(this.config.nzAutofocus)this.focusTrap.focusInitialElementWhenReady();else{const Be=this.document.activeElement;Be!==_e&&!_e.contains(Be)&&_e.focus()}}restoreFocus(){const _e=this.elementFocusedBeforeModalWasOpened;if(_e&&"function"==typeof _e.focus){const Be=this.document.activeElement,Ft=this.host.nativeElement;(!Be||Be===this.document.body||Be===Ft||Ft.contains(Be))&&_e.focus()}this.focusTrap&&this.focusTrap.destroy()}setEnterAnimationClass(){if(this.animationDisabled())return;this.setModalTransformOrigin();const _e=this.modalElementRef.nativeElement,Be=this.overlayRef.backdropElement;_e.classList.add("ant-zoom-enter"),_e.classList.add("ant-zoom-enter-active"),Be&&(Be.classList.add("ant-fade-enter"),Be.classList.add("ant-fade-enter-active"))}setExitAnimationClass(){const _e=this.modalElementRef.nativeElement;_e.classList.add("ant-zoom-leave"),_e.classList.add("ant-zoom-leave-active"),this.setMaskExitAnimationClass()}setMaskExitAnimationClass(_e=!1){const Be=this.overlayRef.backdropElement;if(Be){if(this.animationDisabled()||_e)return void Be.classList.remove(Xa);Be.classList.add("ant-fade-leave"),Be.classList.add("ant-fade-leave-active")}}cleanAnimationClass(){if(this.animationDisabled())return;const _e=this.overlayRef.backdropElement,Be=this.modalElementRef.nativeElement;_e&&(_e.classList.remove("ant-fade-enter"),_e.classList.remove("ant-fade-enter-active")),Be.classList.remove("ant-zoom-enter"),Be.classList.remove("ant-zoom-enter-active"),Be.classList.remove("ant-zoom-leave"),Be.classList.remove("ant-zoom-leave-active")}setZIndexForBackdrop(){const _e=this.overlayRef.backdropElement;_e&&(0,l.DX)(this.config.nzZIndex)&&this.render.setStyle(_e,"z-index",this.config.nzZIndex)}bindBackdropStyle(){const _e=this.overlayRef.backdropElement;if(_e&&(this.oldMaskStyle&&(Object.keys(this.oldMaskStyle).forEach(Ft=>{this.render.removeStyle(_e,Ft)}),this.oldMaskStyle=null),this.setZIndexForBackdrop(),"object"==typeof this.config.nzMaskStyle&&Object.keys(this.config.nzMaskStyle).length)){const Be=Object.assign({},this.config.nzMaskStyle);Object.keys(Be).forEach(Ft=>{this.render.setStyle(_e,Ft,Be[Ft])}),this.oldMaskStyle=Be}}updateMaskClassname(){const _e=this.overlayRef.backdropElement;_e&&(this.showMask?_e.classList.add(Xa):_e.classList.remove(Xa))}onAnimationDone(_e){"enter"===_e.toState?this.trapFocus():"exit"===_e.toState&&this.restoreFocus(),this.cleanAnimationClass(),this.animationStateChanged.emit(_e)}onAnimationStart(_e){"enter"===_e.toState?(this.setEnterAnimationClass(),this.bindBackdropStyle()):"exit"===_e.toState&&this.setExitAnimationClass(),this.animationStateChanged.emit(_e)}startExitAnimation(){this.state="exit",this.cdr.markForCheck()}ngOnDestroy(){this.setMaskExitAnimationClass(!0),this.destroy$.next(),this.destroy$.complete()}setupMouseListeners(_e){this.ngZone.runOutsideAngular(()=>{(0,br.R)(this.host.nativeElement,"mouseup").pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.mouseDown&&setTimeout(()=>{this.mouseDown=!1})}),(0,br.R)(_e.nativeElement,"mousedown").pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.mouseDown=!0})})}}return Je.\u0275fac=function(_e){t.$Z()},Je.\u0275dir=t.lG2({type:Je,features:[t.qOj]}),Je})(),ls=(()=>{class Je{constructor(_e){this.config=_e}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(Ra))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["button","nz-modal-close",""]],hostAttrs:["aria-label","Close",1,"ant-modal-close"],exportAs:["NzModalCloseBuiltin"],attrs:kn,decls:2,vars:1,consts:[[1,"ant-modal-close-x"],[4,"nzStringTemplateOutlet"],["nz-icon","",1,"ant-modal-close-icon",3,"nzType"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"span",0),t.YNc(1,Mn,2,1,"ng-container",1),t.qZA()),2&_e&&(t.xp6(1),t.Q6J("nzStringTemplateOutlet",Be.config.nzCloseIcon))},directives:[o.f,s.w,V.Ls],encapsulation:2,changeDetection:0}),Je})(),ts=(()=>{class Je extends ta{constructor(_e,Be,Ft,Tn,$n,or,vr,ur,Or,Nr,ii){super(_e,Ft,Tn,$n,or,vr,ur,Or,Nr,ii),this.i18n=Be,this.config=Or,this.cancelTriggered=new t.vpe,this.okTriggered=new t.vpe,this.i18n.localeChange.pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Modal")})}ngOnInit(){this.setupMouseListeners(this.modalElementRef)}onCancel(){this.cancelTriggered.emit()}onOk(){this.okTriggered.emit()}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.R0b),t.Y36($r.wi),t.Y36(t.SBq),t.Y36(sr.qV),t.Y36(t.sBO),t.Y36(t.Qsj),t.Y36(qn.Iu),t.Y36(dr.jY),t.Y36(Ra),t.Y36($.K0,8),t.Y36(Yn.Qb,8))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["nz-modal-confirm-container"]],viewQuery:function(_e,Be){if(1&_e&&(t.Gf(Xn.Pl,7),t.Gf(Ln,7)),2&_e){let Ft;t.iGM(Ft=t.CRH())&&(Be.portalOutlet=Ft.first),t.iGM(Ft=t.CRH())&&(Be.modalElementRef=Ft.first)}},hostAttrs:["tabindex","-1","role","dialog"],hostVars:10,hostBindings:function(_e,Be){1&_e&&(t.WFA("@modalContainer.start",function(Tn){return Be.onAnimationStart(Tn)})("@modalContainer.done",function(Tn){return Be.onAnimationDone(Tn)}),t.NdJ("click",function(Tn){return Be.onContainerClick(Tn)})),2&_e&&(t.d8E("@.disabled",Be.config.nzNoAnimation)("@modalContainer",Be.state),t.Tol(Be.config.nzWrapClassName?"ant-modal-wrap "+Be.config.nzWrapClassName:"ant-modal-wrap"),t.Udp("z-index",Be.config.nzZIndex),t.ekj("ant-modal-wrap-rtl","rtl"===Be.dir)("ant-modal-centered",Be.config.nzCentered))},outputs:{cancelTriggered:"cancelTriggered",okTriggered:"okTriggered"},exportAs:["nzModalConfirmContainer"],features:[t.qOj],decls:17,vars:13,consts:[["role","document",1,"ant-modal",3,"ngClass","ngStyle"],["modalElement",""],[1,"ant-modal-content"],["nz-modal-close","",3,"click",4,"ngIf"],[1,"ant-modal-body",3,"ngStyle"],[1,"ant-modal-confirm-body-wrapper"],[1,"ant-modal-confirm-body"],["nz-icon","",3,"nzType"],[1,"ant-modal-confirm-title"],[4,"nzStringTemplateOutlet"],[1,"ant-modal-confirm-content"],["cdkPortalOutlet",""],[3,"innerHTML",4,"ngIf"],[1,"ant-modal-confirm-btns"],["nz-button","",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","",3,"nzType","nzLoading","disabled","nzDanger","click",4,"ngIf"],["nz-modal-close","",3,"click"],[3,"innerHTML"],["nz-button","",3,"nzLoading","disabled","click"],["nz-button","",3,"nzType","nzLoading","disabled","nzDanger","click"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"div",0,1),t.ALo(2,"nzToCssUnit"),t.TgZ(3,"div",2),t.YNc(4,Dn,1,0,"button",3),t.TgZ(5,"div",4)(6,"div",5)(7,"div",6),t._UZ(8,"i",7),t.TgZ(9,"span",8),t.YNc(10,Kn,2,1,"ng-container",9),t.qZA(),t.TgZ(11,"div",10),t.YNc(12,Qn,0,0,"ng-template",11),t.YNc(13,lr,1,1,"div",12),t.qZA()(),t.TgZ(14,"div",13),t.YNc(15,hr,2,4,"button",14),t.YNc(16,Mr,2,6,"button",15),t.qZA()()()()()),2&_e&&(t.Udp("width",t.lcZ(2,11,null==Be.config?null:Be.config.nzWidth)),t.Q6J("ngClass",Be.config.nzClassName)("ngStyle",Be.config.nzStyle),t.xp6(4),t.Q6J("ngIf",Be.config.nzClosable),t.xp6(1),t.Q6J("ngStyle",Be.config.nzBodyStyle),t.xp6(3),t.Q6J("nzType",Be.config.nzIconType),t.xp6(2),t.Q6J("nzStringTemplateOutlet",Be.config.nzTitle),t.xp6(3),t.Q6J("ngIf",Be.isStringContent),t.xp6(2),t.Q6J("ngIf",null!==Be.config.nzCancelText),t.xp6(1),t.Q6J("ngIf",null!==Be.config.nzOkText))},directives:[ls,m.ix,$.mk,$.PC,$.O5,s.w,V.Ls,o.f,Xn.Pl,p.dQ],pipes:[sn],encapsulation:2,data:{animation:[_o.modalContainer]}}),Je})(),As=(()=>{class Je{constructor(_e){this.config=_e}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(Ra))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["div","nz-modal-title",""]],hostAttrs:[1,"ant-modal-header"],exportAs:["NzModalTitleBuiltin"],attrs:Er,decls:2,vars:1,consts:[[1,"ant-modal-title"],[4,"nzStringTemplateOutlet"],[3,"innerHTML"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"div",0),t.YNc(1,Pr,2,1,"ng-container",1),t.qZA()),2&_e&&(t.xp6(1),t.Q6J("nzStringTemplateOutlet",Be.config.nzTitle))},directives:[o.f],encapsulation:2,changeDetection:0}),Je})(),Ms=(()=>{class Je{constructor(_e,Be){this.i18n=_e,this.config=Be,this.buttonsFooter=!1,this.buttons=[],this.cancelTriggered=new t.vpe,this.okTriggered=new t.vpe,this.destroy$=new q.x,Array.isArray(Be.nzFooter)&&(this.buttonsFooter=!0,this.buttons=Be.nzFooter.map(_s)),this.i18n.localeChange.pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Modal")})}onCancel(){this.cancelTriggered.emit()}onOk(){this.okTriggered.emit()}getButtonCallableProp(_e,Be){const Ft=_e[Be],Tn=this.modalRef.getContentComponent();return"function"==typeof Ft?Ft.apply(_e,Tn&&[Tn]):Ft}onButtonClick(_e){if(!this.getButtonCallableProp(_e,"loading")){const Ft=this.getButtonCallableProp(_e,"onClick");_e.autoLoading&&(0,l.tI)(Ft)&&(_e.loading=!0,Ft.then(()=>_e.loading=!1).catch(Tn=>{throw _e.loading=!1,Tn}))}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36($r.wi),t.Y36(Ra))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["div","nz-modal-footer",""]],hostAttrs:[1,"ant-modal-footer"],inputs:{modalRef:"modalRef"},outputs:{cancelTriggered:"cancelTriggered",okTriggered:"okTriggered"},exportAs:["NzModalFooterBuiltin"],attrs:Ur,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["defaultFooterButtons",""],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],[3,"innerHTML",4,"ngIf"],[4,"ngIf"],[3,"innerHTML"],["nz-button","",3,"hidden","nzLoading","disabled","nzType","nzDanger","nzShape","nzSize","nzGhost","click",4,"ngFor","ngForOf"],["nz-button","",3,"hidden","nzLoading","disabled","nzType","nzDanger","nzShape","nzSize","nzGhost","click"],["nz-button","",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","",3,"nzType","nzDanger","nzLoading","disabled","click",4,"ngIf"],["nz-button","",3,"nzLoading","disabled","click"],["nz-button","",3,"nzType","nzDanger","nzLoading","disabled","click"]],template:function(_e,Be){if(1&_e&&(t.YNc(0,fi,2,5,"ng-container",0),t.YNc(1,Ta,2,2,"ng-template",null,1,t.W1O)),2&_e){const Ft=t.MAs(2);t.Q6J("ngIf",Be.config.nzFooter)("ngIfElse",Ft)}},directives:[m.ix,$.O5,o.f,$.sg,p.dQ,s.w],encapsulation:2}),Je})();function _s(Je){return Object.assign({type:null,size:"default",autoLoading:!0,show:!0,loading:!1,disabled:!1},Je)}let Ss=(()=>{class Je extends ta{constructor(_e,Be,Ft,Tn,$n,or,vr,ur,Or,Nr){super(_e,Be,Ft,Tn,$n,or,vr,ur,Or,Nr),this.config=ur}ngOnInit(){this.setupMouseListeners(this.modalElementRef)}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.R0b),t.Y36(t.SBq),t.Y36(sr.qV),t.Y36(t.sBO),t.Y36(t.Qsj),t.Y36(qn.Iu),t.Y36(dr.jY),t.Y36(Ra),t.Y36($.K0,8),t.Y36(Yn.Qb,8))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["nz-modal-container"]],viewQuery:function(_e,Be){if(1&_e&&(t.Gf(Xn.Pl,7),t.Gf(Ln,7)),2&_e){let Ft;t.iGM(Ft=t.CRH())&&(Be.portalOutlet=Ft.first),t.iGM(Ft=t.CRH())&&(Be.modalElementRef=Ft.first)}},hostAttrs:["tabindex","-1","role","dialog"],hostVars:10,hostBindings:function(_e,Be){1&_e&&(t.WFA("@modalContainer.start",function(Tn){return Be.onAnimationStart(Tn)})("@modalContainer.done",function(Tn){return Be.onAnimationDone(Tn)}),t.NdJ("click",function(Tn){return Be.onContainerClick(Tn)})),2&_e&&(t.d8E("@.disabled",Be.config.nzNoAnimation)("@modalContainer",Be.state),t.Tol(Be.config.nzWrapClassName?"ant-modal-wrap "+Be.config.nzWrapClassName:"ant-modal-wrap"),t.Udp("z-index",Be.config.nzZIndex),t.ekj("ant-modal-wrap-rtl","rtl"===Be.dir)("ant-modal-centered",Be.config.nzCentered))},exportAs:["nzModalContainer"],features:[t.qOj],decls:10,vars:11,consts:[["role","document",1,"ant-modal",3,"ngClass","ngStyle"],["modalElement",""],[1,"ant-modal-content"],["nz-modal-close","",3,"click",4,"ngIf"],["nz-modal-title","",4,"ngIf"],[1,"ant-modal-body",3,"ngStyle"],["cdkPortalOutlet",""],[3,"innerHTML",4,"ngIf"],["nz-modal-footer","",3,"modalRef","cancelTriggered","okTriggered",4,"ngIf"],["nz-modal-close","",3,"click"],["nz-modal-title",""],[3,"innerHTML"],["nz-modal-footer","",3,"modalRef","cancelTriggered","okTriggered"]],template:function(_e,Be){1&_e&&(t.TgZ(0,"div",0,1),t.ALo(2,"nzToCssUnit"),t.TgZ(3,"div",2),t.YNc(4,Ba,1,0,"button",3),t.YNc(5,go,1,0,"div",4),t.TgZ(6,"div",5),t.YNc(7,ra,0,0,"ng-template",6),t.YNc(8,ia,1,1,"div",7),t.qZA(),t.YNc(9,so,1,1,"div",8),t.qZA()()),2&_e&&(t.Udp("width",t.lcZ(2,9,null==Be.config?null:Be.config.nzWidth)),t.Q6J("ngClass",Be.config.nzClassName)("ngStyle",Be.config.nzStyle),t.xp6(4),t.Q6J("ngIf",Be.config.nzClosable),t.xp6(1),t.Q6J("ngIf",Be.config.nzTitle),t.xp6(1),t.Q6J("ngStyle",Be.config.nzBodyStyle),t.xp6(2),t.Q6J("ngIf",Be.isStringContent),t.xp6(1),t.Q6J("ngIf",null!==Be.config.nzFooter))},directives:[ls,As,Ms,$.mk,$.PC,$.O5,Xn.Pl],pipes:[sn],encapsulation:2,data:{animation:[_o.modalContainer]}}),Je})();class vo{constructor(Dt,_e,Be){this.overlayRef=Dt,this.config=_e,this.containerInstance=Be,this.componentInstance=null,this.state=0,this.afterClose=new q.x,this.afterOpen=new q.x,this.destroy$=new q.x,Be.animationStateChanged.pipe((0,cr.h)(Ft=>"done"===Ft.phaseName&&"enter"===Ft.toState),(0,Sr.q)(1)).subscribe(()=>{this.afterOpen.next(),this.afterOpen.complete(),_e.nzAfterOpen instanceof t.vpe&&_e.nzAfterOpen.emit()}),Be.animationStateChanged.pipe((0,cr.h)(Ft=>"done"===Ft.phaseName&&"exit"===Ft.toState),(0,Sr.q)(1)).subscribe(()=>{clearTimeout(this.closeTimeout),this._finishDialogClose()}),Be.containerClick.pipe((0,Sr.q)(1),(0,Vr.R)(this.destroy$)).subscribe(()=>{!this.config.nzCancelLoading&&!this.config.nzOkLoading&&this.trigger("cancel")}),Dt.keydownEvents().pipe((0,cr.h)(Ft=>this.config.nzKeyboard&&!this.config.nzCancelLoading&&!this.config.nzOkLoading&&Ft.keyCode===jn.hY&&!(0,jn.Vb)(Ft))).subscribe(Ft=>{Ft.preventDefault(),this.trigger("cancel")}),Be.cancelTriggered.pipe((0,Vr.R)(this.destroy$)).subscribe(()=>this.trigger("cancel")),Be.okTriggered.pipe((0,Vr.R)(this.destroy$)).subscribe(()=>this.trigger("ok")),Dt.detachments().subscribe(()=>{this.afterClose.next(this.result),this.afterClose.complete(),_e.nzAfterClose instanceof t.vpe&&_e.nzAfterClose.emit(this.result),this.componentInstance=null,this.overlayRef.dispose()})}getContentComponent(){return this.componentInstance}getElement(){return this.containerInstance.getNativeElement()}destroy(Dt){this.close(Dt)}triggerOk(){return this.trigger("ok")}triggerCancel(){return this.trigger("cancel")}close(Dt){0===this.state&&(this.result=Dt,this.containerInstance.animationStateChanged.pipe((0,cr.h)(_e=>"start"===_e.phaseName),(0,Sr.q)(1)).subscribe(_e=>{this.overlayRef.detachBackdrop(),this.closeTimeout=setTimeout(()=>{this._finishDialogClose()},_e.totalTime+100)}),this.containerInstance.startExitAnimation(),this.state=1)}updateConfig(Dt){Object.assign(this.config,Dt),this.containerInstance.bindBackdropStyle(),this.containerInstance.cdr.markForCheck()}getState(){return this.state}getConfig(){return this.config}getBackdropElement(){return this.overlayRef.backdropElement}trigger(Dt){return(0,f.mG)(this,void 0,void 0,function*(){if(1===this.state)return;const _e={ok:this.config.nzOnOk,cancel:this.config.nzOnCancel}[Dt],Be={ok:"nzOkLoading",cancel:"nzCancelLoading"}[Dt];if(!this.config[Be])if(_e instanceof t.vpe)_e.emit(this.getContentComponent());else if("function"==typeof _e){const Tn=_e(this.getContentComponent());if((0,l.tI)(Tn)){this.config[Be]=!0;let $n=!1;try{$n=yield Tn}finally{this.config[Be]=!1,this.closeWhitResult($n)}}else this.closeWhitResult(Tn)}})}closeWhitResult(Dt){!1!==Dt&&this.close(Dt)}_finishDialogClose(){this.state=2,this.overlayRef.dispose(),this.destroy$.next()}}let Lo=(()=>{class Je{constructor(_e,Be,Ft,Tn,$n){this.overlay=_e,this.injector=Be,this.nzConfigService=Ft,this.parentModal=Tn,this.directionality=$n,this.openModalsAtThisLevel=[],this.afterAllClosedAtThisLevel=new q.x,this.afterAllClose=(0,fr.P)(()=>this.openModals.length?this._afterAllClosed:this._afterAllClosed.pipe((0,Cr.O)(void 0)))}get openModals(){return this.parentModal?this.parentModal.openModals:this.openModalsAtThisLevel}get _afterAllClosed(){const _e=this.parentModal;return _e?_e._afterAllClosed:this.afterAllClosedAtThisLevel}create(_e){return this.open(_e.nzContent,_e)}closeAll(){this.closeModals(this.openModals)}confirm(_e={},Be="confirm"){return"nzFooter"in _e&&(0,pi.ZK)('The Confirm-Modal doesn\'t support "nzFooter", this property will be ignored.'),"nzWidth"in _e||(_e.nzWidth=416),"nzMaskClosable"in _e||(_e.nzMaskClosable=!1),_e.nzModalType="confirm",_e.nzClassName=`ant-modal-confirm ant-modal-confirm-${Be} ${_e.nzClassName||""}`,this.create(_e)}info(_e={}){return this.confirmFactory(_e,"info")}success(_e={}){return this.confirmFactory(_e,"success")}error(_e={}){return this.confirmFactory(_e,"error")}warning(_e={}){return this.confirmFactory(_e,"warning")}open(_e,Be){const Ft=function Wa(Je,Dt){return Object.assign(Object.assign({},Dt),Je)}(Be||{},new Ra),Tn=this.createOverlay(Ft),$n=this.attachModalContainer(Tn,Ft),or=this.attachModalContent(_e,$n,Tn,Ft);return $n.modalRef=or,this.openModals.push(or),or.afterClose.subscribe(()=>this.removeOpenModal(or)),or}removeOpenModal(_e){const Be=this.openModals.indexOf(_e);Be>-1&&(this.openModals.splice(Be,1),this.openModals.length||this._afterAllClosed.next())}closeModals(_e){let Be=_e.length;for(;Be--;)_e[Be].close(),this.openModals.length||this._afterAllClosed.next()}createOverlay(_e){const Be=this.nzConfigService.getConfigForComponent(no)||{},Ft=new qn.X_({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.overlay.position().global(),disposeOnNavigation:xa(_e.nzCloseOnNavigation,Be.nzCloseOnNavigation,!0),direction:xa(_e.nzDirection,Be.nzDirection,this.directionality.value)});return xa(_e.nzMask,Be.nzMask,!0)&&(Ft.backdropClass=Xa),this.overlay.create(Ft)}attachModalContainer(_e,Be){const Tn=t.zs3.create({parent:Be&&Be.nzViewContainerRef&&Be.nzViewContainerRef.injector||this.injector,providers:[{provide:qn.Iu,useValue:_e},{provide:Ra,useValue:Be}]}),or=new Xn.C5("confirm"===Be.nzModalType?ts:Ss,Be.nzViewContainerRef,Tn);return _e.attach(or).instance}attachModalContent(_e,Be,Ft,Tn){const $n=new vo(Ft,Tn,Be);if(_e instanceof t.Rgc)Be.attachTemplatePortal(new Xn.UE(_e,null,{$implicit:Tn.nzComponentParams,modalRef:$n}));else if((0,l.DX)(_e)&&"string"!=typeof _e){const or=this.createInjector($n,Tn),vr=Be.attachComponentPortal(new Xn.C5(_e,Tn.nzViewContainerRef,or));(function ro(Je,Dt){Object.assign(Je,Dt)})(vr.instance,Tn.nzComponentParams),$n.componentInstance=vr.instance}else Be.attachStringContent();return $n}createInjector(_e,Be){return t.zs3.create({parent:Be&&Be.nzViewContainerRef&&Be.nzViewContainerRef.injector||this.injector,providers:[{provide:vo,useValue:_e}]})}confirmFactory(_e={},Be){return"nzIconType"in _e||(_e.nzIconType={info:"info-circle",success:"check-circle",error:"close-circle",warning:"exclamation-circle"}[Be]),"nzCancelText"in _e||(_e.nzCancelText=null),this.confirm(_e,Be)}ngOnDestroy(){this.closeModals(this.openModalsAtThisLevel),this.afterAllClosedAtThisLevel.complete()}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.LFG(qn.aV),t.LFG(t.zs3),t.LFG(dr.jY),t.LFG(Je,12),t.LFG(d.Is,8))},Je.\u0275prov=t.Yz7({token:Je,factory:Je.\u0275fac}),Je})(),Bo=(()=>{class Je{constructor(_e){this.templateRef=_e}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.Rgc))},Je.\u0275dir=t.lG2({type:Je,selectors:[["","nzModalContent",""]],exportAs:["nzModalContent"]}),Je})(),qo=(()=>{class Je{constructor(_e,Be){this.nzModalRef=_e,this.templateRef=Be,this.nzModalRef&&this.nzModalRef.updateConfig({nzFooter:this.templateRef})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(vo,8),t.Y36(t.Rgc))},Je.\u0275dir=t.lG2({type:Je,selectors:[["","nzModalFooter",""]],exportAs:["nzModalFooter"]}),Je})(),Ho=(()=>{class Je{constructor(_e,Be){this.nzModalRef=_e,this.templateRef=Be,this.nzModalRef&&this.nzModalRef.updateConfig({nzTitle:this.templateRef})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(vo,8),t.Y36(t.Rgc))},Je.\u0275dir=t.lG2({type:Je,selectors:[["","nzModalTitle",""]],exportAs:["nzModalTitle"]}),Je})(),ns=(()=>{class Je{constructor(_e,Be,Ft){this.cdr=_e,this.modal=Be,this.viewContainerRef=Ft,this.nzVisible=!1,this.nzClosable=!0,this.nzOkLoading=!1,this.nzOkDisabled=!1,this.nzCancelDisabled=!1,this.nzCancelLoading=!1,this.nzKeyboard=!0,this.nzNoAnimation=!1,this.nzCentered=!1,this.nzZIndex=1e3,this.nzWidth=520,this.nzCloseIcon="close",this.nzOkType="primary",this.nzOkDanger=!1,this.nzIconType="question-circle",this.nzModalType="default",this.nzAutofocus="auto",this.nzOnOk=new t.vpe,this.nzOnCancel=new t.vpe,this.nzAfterOpen=new t.vpe,this.nzAfterClose=new t.vpe,this.nzVisibleChange=new t.vpe,this.modalRef=null,this.destroy$=new q.x}set modalTitle(_e){_e&&this.setTitleWithTemplate(_e)}set modalFooter(_e){_e&&this.setFooterWithTemplate(_e)}get afterOpen(){return this.nzAfterOpen.asObservable()}get afterClose(){return this.nzAfterClose.asObservable()}open(){if(this.nzVisible||(this.nzVisible=!0,this.nzVisibleChange.emit(!0)),!this.modalRef){const _e=this.getConfig();this.modalRef=this.modal.create(_e),this.modalRef.afterClose.asObservable().pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.close()})}}close(_e){this.nzVisible&&(this.nzVisible=!1,this.nzVisibleChange.emit(!1)),this.modalRef&&(this.modalRef.close(_e),this.modalRef=null)}destroy(_e){this.close(_e)}triggerOk(){var _e;null===(_e=this.modalRef)||void 0===_e||_e.triggerOk()}triggerCancel(){var _e;null===(_e=this.modalRef)||void 0===_e||_e.triggerCancel()}getContentComponent(){var _e;return null===(_e=this.modalRef)||void 0===_e?void 0:_e.getContentComponent()}getElement(){var _e;return null===(_e=this.modalRef)||void 0===_e?void 0:_e.getElement()}getModalRef(){return this.modalRef}setTitleWithTemplate(_e){this.nzTitle=_e,this.modalRef&&Promise.resolve().then(()=>{this.modalRef.updateConfig({nzTitle:this.nzTitle})})}setFooterWithTemplate(_e){this.nzFooter=_e,this.modalRef&&Promise.resolve().then(()=>{this.modalRef.updateConfig({nzFooter:this.nzFooter})}),this.cdr.markForCheck()}getConfig(){const _e=ds(this);return _e.nzViewContainerRef=this.viewContainerRef,_e.nzContent=this.nzContent||this.contentFromContentChild,_e}ngOnChanges(_e){const{nzVisible:Be}=_e,Ft=(0,f._T)(_e,["nzVisible"]);Object.keys(Ft).length&&this.modalRef&&this.modalRef.updateConfig(ds(this)),Be&&(this.nzVisible?this.open():this.close())}ngOnDestroy(){var _e;null===(_e=this.modalRef)||void 0===_e||_e._finishDialogClose(),this.destroy$.next(),this.destroy$.complete()}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.sBO),t.Y36(Lo),t.Y36(t.s_b))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["nz-modal"]],contentQueries:function(_e,Be,Ft){if(1&_e&&(t.Suo(Ft,Ho,7,t.Rgc),t.Suo(Ft,Bo,7,t.Rgc),t.Suo(Ft,qo,7,t.Rgc)),2&_e){let Tn;t.iGM(Tn=t.CRH())&&(Be.modalTitle=Tn.first),t.iGM(Tn=t.CRH())&&(Be.contentFromContentChild=Tn.first),t.iGM(Tn=t.CRH())&&(Be.modalFooter=Tn.first)}},inputs:{nzMask:"nzMask",nzMaskClosable:"nzMaskClosable",nzCloseOnNavigation:"nzCloseOnNavigation",nzVisible:"nzVisible",nzClosable:"nzClosable",nzOkLoading:"nzOkLoading",nzOkDisabled:"nzOkDisabled",nzCancelDisabled:"nzCancelDisabled",nzCancelLoading:"nzCancelLoading",nzKeyboard:"nzKeyboard",nzNoAnimation:"nzNoAnimation",nzCentered:"nzCentered",nzContent:"nzContent",nzComponentParams:"nzComponentParams",nzFooter:"nzFooter",nzZIndex:"nzZIndex",nzWidth:"nzWidth",nzWrapClassName:"nzWrapClassName",nzClassName:"nzClassName",nzStyle:"nzStyle",nzTitle:"nzTitle",nzCloseIcon:"nzCloseIcon",nzMaskStyle:"nzMaskStyle",nzBodyStyle:"nzBodyStyle",nzOkText:"nzOkText",nzCancelText:"nzCancelText",nzOkType:"nzOkType",nzOkDanger:"nzOkDanger",nzIconType:"nzIconType",nzModalType:"nzModalType",nzAutofocus:"nzAutofocus",nzOnOk:"nzOnOk",nzOnCancel:"nzOnCancel"},outputs:{nzOnOk:"nzOnOk",nzOnCancel:"nzOnCancel",nzAfterOpen:"nzAfterOpen",nzAfterClose:"nzAfterClose",nzVisibleChange:"nzVisibleChange"},exportAs:["nzModal"],features:[t.TTD],decls:0,vars:0,template:function(_e,Be){},encapsulation:2,changeDetection:0}),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzMask",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzMaskClosable",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzCloseOnNavigation",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzVisible",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzClosable",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzOkLoading",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzOkDisabled",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzCancelDisabled",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzCancelLoading",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzKeyboard",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzNoAnimation",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzCentered",void 0),(0,f.gn)([(0,l.yF)()],Je.prototype,"nzOkDanger",void 0),Je})(),wo=(()=>{class Je{}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({providers:[Lo],imports:[[$.ez,d.vT,qn.U8,o.T,Xn.eL,$r.YI,m.sL,V.PV,Un,On.g,Un]]}),Je})();var yo=Q(4927),Yo=Q(5408),ms=Q(7111),zo=Q(7651),Gi=Q(7848);function qe(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",15)(1,"span",16),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openModal("title")}),t.qZA()()}}function We(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",15)(1,"span",17),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openProjectSetings()}),t.qZA()()}}function rt(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-col",8)(1,"form",18)(2,"nz-form-item")(3,"label",19),t._uU(4,"Visibility to public"),t.qZA()()()()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("formGroup",_e.form)}}function ft(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",15)(1,"span",16),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openModal("description")}),t.qZA()()}}function bt(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openModal("sample_processing_protocol")}),t._UZ(1,"span",21),t.qZA()}}function vt(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openModal("data_processing_protocol")}),t._UZ(1,"span",21),t.qZA()}}function Pt(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(_e);const Ft=t.oxw().$implicit;return t.oxw(2).openModal(Ft.control)}),t._UZ(1,"span",21),t.qZA()}}function tn(Je,Dt){if(1&Je&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.hij(" ",_e.name," ")}}function rn(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"nz-col",22)(2,"b"),t._uU(3),t.qZA(),t.YNc(4,Pt,2,0,"button",10),t.TgZ(5,"ul"),t.YNc(6,tn,2,1,"li",11),t.qZA()(),t.BQk()),2&Je){const _e=Dt.$implicit,Be=t.oxw(2);t.xp6(3),t.Oqu(_e.label),t.xp6(1),t.Q6J("ngIf",Be.accounts.loggedIn),t.xp6(2),t.Q6J("ngForOf",Be.form.value[_e.control])}}function Qt(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(_e);const Ft=t.oxw(3);return Ft.openModal("files"+Ft.daFile.file_type)}),t._UZ(1,"span",21),t.qZA()}}function un(Je,Dt){if(1&Je&&(t.TgZ(0,"li")(1,"a",23),t._uU(2),t.qZA(),t.YNc(3,Qt,2,0,"button",10),t.qZA()),2&Je){const _e=t.oxw(2);t.xp6(1),t.s9C("href",_e.daFile.file,t.LSH),t.xp6(1),t.hij("",_e.daFile.file," (Differential analysis file)"),t.xp6(1),t.Q6J("ngIf",_e.accounts.loggedIn)}}function xn(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"li")(1,"button",20),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openModal("filesDA")}),t._uU(2," Add Differential Analysis File "),t._UZ(3,"span",21),t.qZA()()}}function Sn(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(_e);const Ft=t.oxw(3);return Ft.openModal("files"+Ft.rawFile.file_type)}),t._UZ(1,"span",21),t.qZA()}}function Cn(Je,Dt){if(1&Je&&(t.TgZ(0,"li")(1,"a",23),t._uU(2),t.qZA(),t.YNc(3,Sn,2,0,"button",10),t.qZA()),2&Je){const _e=t.oxw(2);t.xp6(1),t.s9C("href",_e.rawFile.file,t.LSH),t.xp6(1),t.hij("",_e.rawFile.file," (Raw file)"),t.xp6(1),t.Q6J("ngIf",_e.accounts.loggedIn)}}function Vn(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){return t.CHM(_e),t.oxw(3).openModal("filesR")}),t._uU(1," Add Raw File "),t._UZ(2,"span",21),t.qZA()}}function mr(Je,Dt){if(1&Je&&(t.TgZ(0,"li"),t.YNc(1,Vn,3,0,"button",10),t.qZA()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",_e.accounts.loggedIn)}}function wr(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(_e);const Ft=t.oxw().$implicit;return t.oxw(3).deleteFile(Ft.id)}),t._UZ(1,"span",24),t.qZA()}}function qr(Je,Dt){if(1&Je&&(t.TgZ(0,"li")(1,"a",23),t._uU(2),t.qZA(),t.YNc(3,wr,2,0,"button",10),t.qZA()),2&Je){const _e=Dt.$implicit,Be=t.oxw(3);t.xp6(1),t.s9C("href",_e.file,t.LSH),t.xp6(1),t.hij("",_e.file," (Other file)"),t.xp6(1),t.Q6J("ngIf",Be.accounts.loggedIn)}}function Gr(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,qr,4,3,"li",11),t.BQk()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",_e.otherFiles)}}function ni(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"li")(1,"button",20),t.NdJ("click",function(){return t.CHM(_e),t.oxw(2).openModal("filesO")}),t._uU(2," Add Other Files "),t._UZ(3,"span",21),t.qZA()()}}function Xr(Je,Dt){if(1&Je&&t._UZ(0,"app-boxplot",30),2&Je){const _e=t.oxw(4);t.Q6J("data",_e.boxPlotData)("lineChartData",_e.boxPlotLineChart)}}const Si=function(Je){return{project:Je}};function Ni(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"nz-row")(1,"nz-col",25),t.YNc(2,Xr,1,2,"app-boxplot",26),t.qZA(),t.TgZ(3,"nz-col",27)(4,"b"),t._uU(5,"Profile Plot Additional Data Selection"),t.qZA(),t.TgZ(6,"app-quick-search",28),t.NdJ("selected",function(Ft){return t.CHM(_e),t.oxw(3).handleBoxPlotSelection(Ft)}),t.qZA(),t.TgZ(7,"button",29),t.NdJ("click",function(){return t.CHM(_e),t.oxw(3).clearBoxplotLineChart()}),t._uU(8,"Clear Selected"),t.qZA()()()}if(2&Je){const _e=t.oxw(3);t.xp6(2),t.Q6J("ngIf",_e.boxPlotData.length>0),t.xp6(4),t.Q6J("parameters",t.VKq(2,Si,_e.project.id))}}function $i(Je,Dt){if(1&Je&&(t.ynx(0),t._UZ(1,"nz-divider"),t.YNc(2,Ni,9,4,"nz-row",0),t.BQk()),2&Je){const _e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",_e.boxPlotData.length>0)}}function Qi(Je,Dt){if(1&Je&&t._UZ(0,"nz-option",40),2&Je){const _e=Dt.$implicit;t.Q6J("nzLabel",_e.name)("nzValue",_e)}}function ea(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"app-volcano-plotly",41),t.NdJ("selected",function(Ft){return t.CHM(_e),t.oxw(3).handleVolcanoSelection(Ft)}),t.qZA()}if(2&Je){const _e=t.oxw(3);t.Q6J("data",_e.allDAData)("externalSelection",_e.volcanoSelection)("allowSelection",!0)("parameters",_e.volcanoSettings)}}function za(Je,Dt){if(1&Je&&t._uU(0),2&Je){const _e=Dt.range;t.lnq(" ",_e[0],"-",_e[1]," of ",Dt.$implicit," items ")}}function Ma(Je,Dt){if(1&Je){const _e=t.EpF();t.ynx(0),t._UZ(1,"nz-divider"),t.TgZ(2,"form",31)(3,"nz-form-item")(4,"nz-form-label",32),t._uU(5," Select comparisons "),t.qZA(),t.TgZ(6,"nz-form-control",22)(7,"nz-select",33),t.YNc(8,Qi,1,2,"nz-option",34),t.qZA()()()(),t.TgZ(9,"nz-row")(10,"nz-col",25),t.YNc(11,ea,1,4,"app-volcano-plotly",35),t.qZA(),t.TgZ(12,"nz-col",27)(13,"app-volcano-plot-settings",36),t.NdJ("output",function(Ft){return t.CHM(_e),t.oxw(2).handleVolcanoSettings(Ft)}),t.qZA(),t.TgZ(14,"app-quick-search",28),t.NdJ("selected",function(Ft){return t.CHM(_e),t.oxw(2).handleVolcanoSearch(Ft)}),t.qZA()()(),t._UZ(15,"nz-divider"),t.TgZ(16,"nz-pagination",37),t.NdJ("nzPageIndexChange",function(Ft){return t.CHM(_e),t.oxw(2).changePage(Ft)}),t.qZA(),t._UZ(17,"app-data-table",38),t.YNc(18,za,1,3,"ng-template",null,39,t.W1O),t.BQk()}if(2&Je){const _e=t.MAs(19),Be=t.oxw(2);t.xp6(2),t.Q6J("formGroup",Be.form),t.xp6(6),t.Q6J("ngForOf",Be.comparisons),t.xp6(3),t.Q6J("ngIf",Be.allDAData.length>0),t.xp6(3),t.Q6J("parameters",t.VKq(9,Si,Be.project.id)),t.xp6(2),t.Q6J("nzShowTotal",_e)("nzPageSize",20)("nzPageIndex",1)("nzTotal",Be.data.count),t.xp6(1),t.Q6J("data",Be.data)}}function ga(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-content")(1,"nz-row",4)(2,"h1",5),t._uU(3),t.qZA(),t.YNc(4,qe,2,0,"button",6),t.YNc(5,We,2,0,"button",6),t.qZA(),t.TgZ(6,"nz-row"),t.YNc(7,rt,5,1,"nz-col",7),t.TgZ(8,"nz-col",8)(9,"p")(10,"b"),t._uU(11,"Description"),t.qZA(),t.YNc(12,ft,2,0,"button",6),t.qZA(),t._UZ(13,"div",9),t.qZA()(),t.TgZ(14,"nz-row")(15,"nz-col",8)(16,"p")(17,"b"),t._uU(18,"Sample Processing Protocol"),t.qZA(),t.YNc(19,bt,2,0,"button",10),t.qZA(),t._UZ(20,"div",9),t.qZA()(),t.TgZ(21,"nz-row")(22,"nz-col",8)(23,"p")(24,"b"),t._uU(25,"Data Processing Protocol"),t.qZA(),t.YNc(26,vt,2,0,"button",10),t.qZA(),t._UZ(27,"div",9),t.qZA()(),t.TgZ(28,"nz-row"),t.YNc(29,rn,7,3,"ng-container",11),t.qZA(),t.TgZ(30,"nz-row")(31,"nz-col",8)(32,"b"),t._uU(33,"Files"),t.qZA(),t.TgZ(34,"ul"),t.YNc(35,un,4,3,"li",12),t.YNc(36,xn,4,0,"ng-template",null,13,t.W1O),t.YNc(38,Cn,4,3,"li",12),t.YNc(39,mr,2,1,"ng-template",null,14,t.W1O),t.YNc(41,Gr,2,1,"ng-container",0),t.YNc(42,ni,4,0,"li",0),t.qZA()()(),t.YNc(43,$i,3,1,"ng-container",0),t.YNc(44,Ma,20,11,"ng-container",0),t.qZA()),2&Je){const _e=t.MAs(37),Be=t.MAs(40),Ft=t.oxw();t.xp6(3),t.Oqu(Ft.project.title),t.xp6(1),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(1),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(2),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(5),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(1),t.Q6J("innerHTML",Ft.project.description,t.oJD),t.xp6(6),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(1),t.Q6J("innerHTML",Ft.project.sample_processing_protocol,t.oJD),t.xp6(6),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(1),t.Q6J("innerHTML",Ft.project.data_processing_protocol,t.oJD),t.xp6(2),t.Q6J("ngForOf",Ft.listProperties),t.xp6(6),t.Q6J("ngIf",void 0!==Ft.daFile)("ngIfElse",_e),t.xp6(3),t.Q6J("ngIf",void 0!==Ft.rawFile)("ngIfElse",Be),t.xp6(3),t.Q6J("ngIf",Ft.otherFiles.length>0),t.xp6(1),t.Q6J("ngIf",Ft.accounts.loggedIn),t.xp6(1),t.Q6J("ngIf",Ft.projectSettings.data.profile_plot),t.xp6(1),t.Q6J("ngIf",Ft.projectSettings.data.volcano_plot)}}function va(Je,Dt){if(1&Je){const _e=t.EpF();t.ynx(0),t.TgZ(1,"app-upload-differential-analysis",46),t.NdJ("complete",function(Ft){return t.CHM(_e),t.oxw(3).updateFinish(Ft)}),t.qZA(),t.BQk()}if(2&Je){const _e=t.oxw(3);t.xp6(1),t.Q6J("projectData",_e.project)("externalTrigger",_e.fileDAUpdateTrigger)}}function Sa(Je,Dt){if(1&Je){const _e=t.EpF();t.ynx(0),t.TgZ(1,"app-upload-raw",46),t.NdJ("complete",function(Ft){return t.CHM(_e),t.oxw(3).updateFinish(Ft)}),t.qZA(),t.BQk()}if(2&Je){const _e=t.oxw(3);t.xp6(1),t.Q6J("projectData",_e.project)("externalTrigger",_e.fileRAWUpdateTrigger)}}function Ja(Je,Dt){if(1&Je&&(t.ynx(0),t._UZ(1,"app-upload-other",47),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(1),t.Q6J("projectData",_e.project)("externalTrigger",_e.fileOtherUpdateTrigger)}}function lo(Je,Dt){1&Je&&(t.ynx(0),t.TgZ(1,"nz-form-item")(2,"nz-form-label",22),t._uU(3," Title "),t.qZA(),t.TgZ(4,"nz-form-control"),t._UZ(5,"input",48),t.qZA()(),t.BQk())}function co(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"nz-form-item")(2,"nz-form-label",49),t._uU(3," Sample Processing Protocol "),t.qZA()(),t.TgZ(4,"nz-form-item")(5,"nz-form-control"),t._UZ(6,"ckeditor",50),t.qZA()(),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(6),t.Q6J("editor",_e.Editor)}}function uo(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"nz-form-item")(2,"nz-form-label",51),t._uU(3," Data Processing Protocol "),t.qZA()(),t.TgZ(4,"nz-form-item")(5,"nz-form-control"),t._UZ(6,"ckeditor",52),t.qZA()(),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(6),t.Q6J("editor",_e.Editor)}}function fo(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"nz-form-item")(2,"nz-form-label",53),t._uU(3," Description "),t.qZA()(),t.TgZ(4,"nz-form-item")(5,"nz-form-control"),t._UZ(6,"ckeditor",54),t.qZA()(),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(6),t.Q6J("editor",_e.Editor)}}function Xi(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"nz-auto-option",62),t.NdJ("click",function(){const Tn=t.CHM(_e).$implicit,$n=t.oxw(4);return $n.addToList(Tn,$n.currentControl.control)}),t._uU(1),t.qZA()}if(2&Je){const _e=Dt.$implicit;t.Q6J("nzLabel",_e.name)("nzValue",_e),t.xp6(1),t.Oqu(_e.name)}}function mt(Je,Dt){if(1&Je){const _e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"span",66),t.NdJ("click",function(){const Tn=t.CHM(_e).$implicit,$n=t.oxw(5);return $n.removeFromList(Tn.id,$n.currentControl.control,Tn.name)}),t.qZA()(),t.TgZ(3,"td"),t._uU(4),t.qZA()()}if(2&Je){const _e=Dt.$implicit;t.xp6(4),t.Oqu(_e.name)}}function Bt(Je,Dt){if(1&Je&&(t.TgZ(0,"div",63)(1,"nz-table",64)(2,"thead")(3,"tr"),t._UZ(4,"th",65),t.TgZ(5,"th"),t._uU(6," Name "),t.qZA()()(),t.TgZ(7,"tbody"),t.YNc(8,mt,5,1,"tr",11),t.qZA()()()),2&Je){const _e=t.oxw(4);t.xp6(1),t.Q6J("nzShowPagination",!1)("nzData",_e.form.value[_e.currentControl.control]),t.xp6(7),t.Q6J("ngForOf",_e.form.value[_e.currentControl.control])}}function pn(Je,Dt){if(1&Je){const _e=t.EpF();t.ynx(0),t.TgZ(1,"nz-form-item")(2,"nz-form-label",55),t._uU(3),t.qZA(),t.TgZ(4,"nz-form-control",56),t._UZ(5,"input",57),t.TgZ(6,"span",58),t.NdJ("click",function(){t.CHM(_e);const Ft=t.oxw(3);return Ft.addToList({name:Ft.form.value[Ft.currentControl.current].slice()},Ft.currentControl.control)}),t.qZA(),t.TgZ(7,"nz-autocomplete",null,59),t.YNc(9,Xi,2,3,"nz-auto-option",60),t.qZA(),t.YNc(10,Bt,9,3,"div",61),t.qZA()(),t.BQk()}if(2&Je){const _e=t.MAs(8),Be=t.oxw(3);t.xp6(2),t.s9C("nzFor",Be.currentControl.control),t.Q6J("nzSm",6)("nzXs",24),t.xp6(1),t.Oqu(Be.currentControl.label),t.xp6(1),t.Q6J("nzSm",10)("nzXs",24),t.xp6(1),t.s9C("id",Be.currentControl.control),t.Q6J("formControlName",Be.currentControl.current)("nzAutocomplete",_e),t.xp6(4),t.Q6J("ngForOf",Be.currentControl.results),t.xp6(1),t.Q6J("ngIf",Be.form.value[Be.currentControl.control].length>0)}}function Xt(Je,Dt){if(1&Je&&(t.TgZ(0,"form",31),t.ynx(1,43),t.YNc(2,va,2,2,"ng-container",44),t.YNc(3,Sa,2,2,"ng-container",44),t.YNc(4,Ja,2,2,"ng-container",44),t.YNc(5,lo,6,0,"ng-container",44),t.YNc(6,co,7,1,"ng-container",44),t.YNc(7,uo,7,1,"ng-container",44),t.YNc(8,fo,7,1,"ng-container",44),t.YNc(9,pn,11,11,"ng-container",45),t.BQk(),t.qZA()),2&Je){const _e=t.oxw(2);t.Q6J("formGroup",_e.form),t.xp6(1),t.Q6J("ngSwitch",_e.currentEdit),t.xp6(1),t.Q6J("ngSwitchCase","filesDA"),t.xp6(1),t.Q6J("ngSwitchCase","filesR"),t.xp6(1),t.Q6J("ngSwitchCase","filesO"),t.xp6(1),t.Q6J("ngSwitchCase","title"),t.xp6(1),t.Q6J("ngSwitchCase","sample_processing_protocol"),t.xp6(1),t.Q6J("ngSwitchCase","data_processing_protocol"),t.xp6(1),t.Q6J("ngSwitchCase","description")}}function dn(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,Xt,10,9,"form",42),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("ngIf",_e.project.id)}}function Fn(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"form",31)(2,"nz-form-item")(3,"label",67),t._uU(4,"Profile Plot Visibility"),t.qZA()(),t.TgZ(5,"nz-form-item")(6,"label",68),t._uU(7,"Volcano Plot Visibility"),t.qZA()()(),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("formGroup",_e.projectSettingsForm)}}let Zn=(()=>{class Je{constructor(_e,Be,Ft,Tn,$n){this.accounts=_e,this.route=Be,this.web=Ft,this.fb=Tn,this.cdr=$n,this.volcanoSettings=this.fb.group({pCutoff:[1.5,x.kI.required],fcCutoff:[.5,x.kI.required],minX:[null],maxX:[null],minY:[null],maxY:[null]}),this.projectSettingsForm=this.fb.group({profile_plot:[!0],volcano_plot:[!0]}),this.volcanoRedraw=!1,this.projectSettings=new W,this.projectSettingsVisible=!1,this.volcanoSelection={},this.data={results:[]},this.selectedData=[],this.countDA=0,this.comparisons=[],this.allDAData=[],this.Editor=D,this.project={},this.currentEdit="",this.fileDAUpdateTrigger=new q.x,this.fileRAWUpdateTrigger=new q.x,this.fileOtherUpdateTrigger=new q.x,this.otherFiles=[],this.selectedBoxplot={},this.form=this.fb.group({title:[null,x.kI.required],current_lab_group:[[]],lab_group:[[]],current_organism:[""],organism:[[]],current_organism_part:[""],organism_part:[[]],current_cell_type:[""],cell_type:[[]],current_tissue_type:[""],tissue_type:[[]],current_keyword:[""],keyword:[[]],current_experiment_type:[""],experiment_type:[[]],current_quantification_method:[""],quantification_method:[[]],current_instrument:[""],instrument:[[]],current_disease:[""],disease:[[]],current_associated_authors:[""],associated_authors:[[],x.kI.required],first_authors:[[]],sample_processing_protocol:[[]],data_processing_protocol:[[]],description:[[]],comparisons:[[],x.kI.required],enable:[!1,x.kI.required]}),this.listProperties=[{current:"current_organism",control:"organism",label:"Organisms",results:[],apiPath:"organisms"},{current:"current_organism_part",control:"organism_part",label:"Organism Parts",results:[],apiPath:"organism_parts"},{current:"current_cell_type",control:"cell_type",label:"Cell Types",results:[],apiPath:"cell_types"},{current:"current_tissue_type",control:"tissue_type",label:"Tissue Types",results:[],apiPath:"tissue_types"},{current:"current_disease",control:"disease",label:"Diseases",results:[],apiPath:"diseases"},{current:"current_instrument",control:"instrument",label:"Instruments",results:[],apiPath:"instruments"},{current:"current_quantification_method",control:"quantification_method",label:"Quantification Methods",results:[],apiPath:"quantification_methods"},{current:"current_experiment_type",control:"experiment_type",label:"Experiment Types",results:[],apiPath:"experiment_types"},{current:"current_keyword",control:"keyword",label:"Keywords",results:[],apiPath:"keywords"},{current:"current_associated_authors",control:"associated_authors",label:"Authors",results:[],apiPath:"authors"},{current:"current_lab_group",control:"lab_group",label:"Lab Groups",results:[],apiPath:"lab_groups"}],this.currentControl={},this.modalVisible=!1,this.boxPlotData=[],this.boxPlotLineChart=[],this.boxPlotForm=this.fb.group({searchTypes:["gene_names"],current_accession_id:[""],current_gene_names:[""],current_primary_id:[""],gene_names:[""],accession_id:[""],primary_id:[""]}),this.boxPlotControl=[{current:"current_accession_id",control:"accession_id",label:"Accession IDs",results:[],apiPath:"genenamemap",parameterName:"accession_id"},{current:"current_gene_names",control:"gene_names",label:"Gene Names",results:[],apiPath:"genenamemap",parameterName:"gene_names"}],this.form.controls.comparisons.valueChanges.subscribe(or=>{or.length>0&&this.web.getDifferentialAnalysisData(or.map(vr=>vr.id)).subscribe(vr=>{this.countDA=vr.count,this.web.getDifferentialAnalysisData(or.map(ur=>ur.id),vr.count).subscribe(ur=>{this.allDAData=ur.results})})}),this.route.params.subscribe(or=>{or.id&&(this.otherFiles=[],this.web.getProject(or.id).subscribe(vr=>{this.project=vr;for(const ur in this.project.default_settings.data)ur in this.projectSettings&&(this.projectSettings[ur]=this.project.default_settings.data[ur]);for(const ur in this.project)ur in this.form.controls&&this.form.controls[ur].setValue(this.project[ur]);this.form.controls.enable.valueChanges.subscribe(ur=>{this.web.updateProject(this.project.id,"enable",ur).subscribe(Or=>{console.log(Or)})});for(const ur of vr.files)if("DA"===ur.file_type)this.daFile=ur,this.comparisons=ur.comparisons,this.comparisons.length>0&&this.form.controls.comparisons.setValue([this.comparisons[0]]);else if("R"===ur.file_type){this.rawFile=ur;const Or=[];for(const Nr of this.rawFile.raw_sample_columns)Or.push(this.web.getBoxplotParameters(Nr.id));(0,Z.D)(Or).subscribe(Nr=>{this.boxPlotData=Nr})}else this.otherFiles.push(ur);for(let ur=0;ur<this.listProperties.length;ur++)this.listProperties[ur].autocomplete=new j.X(this.listProperties[ur].control,this.web,this.form.controls[this.listProperties[ur].current].valueChanges,this.listProperties[ur].apiPath),this.listProperties[ur].autocomplete.valueObservable.subscribe(Or=>{this.listProperties[ur].results=Or.results});for(let ur=0;ur<this.boxPlotControl.length;ur++)this.boxPlotControl[ur].autocomplete=new j.X(this.boxPlotControl[ur].control,this.web,this.boxPlotForm.controls[this.boxPlotControl[ur].current].valueChanges,this.boxPlotControl[ur].apiPath,this.boxPlotControl[ur].parameterName,"primary_id"===this.boxPlotControl[ur].parameterName?{file_id:[this.rawFile.id]}:{project_id:this.project.id}),this.boxPlotControl[ur].autocomplete.valueObservable.subscribe(Or=>{this.boxPlotControl[ur].results=Or.results,console.log(this.boxPlotControl[ur].results)})}))})}ngOnInit(){}openModal(_e){this.modalVisible=!0,this.currentEdit=_e;const Be=this.listProperties.filter(Ft=>Ft.control===this.currentEdit);Be.length>0&&(this.currentControl=Be[0]),console.log(this.project.id)}closeModal(){this.modalVisible=!1,this.projectSettingsVisible=!1}addToList(_e,Be){if(null!==_e)if(null===this.form.value[Be])this.form.controls[Be].setValue([_e]);else{const Ft=this.form.value[Be];Ft.push(_e),this.form.controls[Be].setValue(Ft)}}removeFromList(_e,Be,Ft=""){let Tn=-1;if(Tn=this.form.value[Be].findIndex(_e?$n=>$n.id===_e:$n=>$n.name===Ft),Tn>-1){const $n=this.form.value[Be];$n.splice(Tn,1),this.form.controls[Be].setValue($n)}}processOK(){this.currentEdit.startsWith("files")?"filesR"===this.currentEdit?void 0!==this.rawFile?this.web.deleteFile(this.rawFile.id).subscribe(_e=>{204===_e.status&&this.fileRAWUpdateTrigger.next(!0)}):this.fileRAWUpdateTrigger.next(!0):"filesDA"===this.currentEdit?void 0!==this.daFile?this.web.deleteFile(this.daFile.id).subscribe(_e=>{204===_e.status&&this.fileDAUpdateTrigger.next(!0)}):this.fileDAUpdateTrigger.next(!0):"filesO"===this.currentEdit&&this.updateFinish(!0):this.web.updateProject(this.project.id,this.currentEdit,this.form.value[this.currentEdit]).subscribe(_e=>{this.project=_e;for(const Be in this.project)Be in this.form.controls&&this.project[Be]!==this.form.value[Be]&&this.form.controls[Be].setValue(this.project[Be]);this.modalVisible=!1})}updateFinish(_e){_e&&(this.otherFiles=[],this.modalVisible=!1,this.web.getProject(this.project.id).subscribe(Be=>{this.project=Be;for(const Ft in this.project.default_settings.data)Ft in this.projectSettings&&(this.projectSettings[Ft]=this.project.default_settings.data[Ft]);for(const Ft in this.project)Ft in this.form.controls&&this.form.controls[Ft].setValue(this.project[Ft]);for(const Ft of Be.files)"DA"===Ft.file_type?(this.daFile=Ft,this.comparisons=Ft.comparisons,this.comparisons.length>0&&this.form.controls.comparisons.setValue([this.comparisons[0]])):"R"===Ft.file_type?this.rawFile=Ft:this.otherFiles.push(Ft)}))}deleteFile(_e){this.web.deleteFile(_e).subscribe(Be=>{204===Be.status&&this.updateFinish(!0)})}handleVolcanoSelection(_e){console.log(_e),this.selectedData=_e.slice(),console.log(this.selectedData),this.changePage(0)}changePage(_e){this.web.getDifferentialAnalysisData([],20,this.selectedData,_e).subscribe(Be=>{this.data=Be,this.cdr.detectChanges()})}clearBoxplotLineChart(){this.boxPlotLineChart=[]}getBoxplotValue(_e,Be){if(!(Be.id in this.selectedBoxplot))switch(this.selectedBoxplot[Be.id]=Be,_e){case"primary_id":break;case"gene_names":this.web.getRawDataFromGeneNames(Be[_e],0,999999,!0,[this.rawFile.id],!1).subscribe(Ft=>{Ft.results.forEach(Tn=>{Tn.value=Math.log2(Tn.value),this.boxPlotLineChart.push(Tn)}),this.boxPlotLineChart=[...this.boxPlotLineChart]});break;case"accession_id":this.web.getRawDataFromAccessionId(Be[_e],0,999999,!0,[this.rawFile.id],!1).subscribe(Ft=>{Ft.results.forEach(Tn=>{Tn.value=Math.log2(Tn.value),this.boxPlotLineChart.push(Tn)}),this.boxPlotLineChart=[...this.boxPlotLineChart]})}}handleBoxPlotSelection(_e){this.getBoxplotValue(_e.control,_e.obj)}handleVolcanoSearch(_e){switch(_e.control){case"gene_names":this.volcanoSelection={title:_e.obj.gene_names,value:_e.obj,selection_type:"gene_names"};break;case"accession_id":this.volcanoSelection={title:_e.obj.gene_names,value:_e.obj,selection_type:"accession_id"}}console.log(_e)}handleVolcanoSettings(_e){this.volcanoSettings=_e}openProjectSetings(){this.projectSettingsVisible=!0}updateProjectSettings(){for(const _e in this.projectSettingsForm.value)this.projectSettings.data[_e]=this.projectSettingsForm.value[_e];this.closeModal()}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(G.i),t.Y36(g.gz),t.Y36(k.Q),t.Y36(x.qu),t.Y36(t.sBO))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-project-details"]],decls:5,vars:5,consts:[[4,"ngIf"],["nzTitle","Project Data Editor",3,"nzWidth","nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nzTitle","Project Settings",3,"nzWidth","nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nzJustify","center"],["nz-typography",""],["nz-button","","nzType","text","nzSize","small",4,"ngIf"],["nzSpan","24",4,"ngIf"],["nzSpan","24"],[3,"innerHTML"],["nz-button","","nzType","text","nzSize","small",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["addDAFile",""],["addRAWFile",""],["nz-button","","nzType","text","nzSize","small"],["nz-icon","","nzType","edit",3,"click"],["nz-icon","","nzType","setting","nzTheme","outline",3,"click"],[3,"formGroup"],["nz-checkbox","","formControlName","enable"],["nz-button","","nzType","text","nzSize","small",3,"click"],["nz-icon","","nzType","edit"],["nzSpan","5"],["target","_blank",3,"href"],["nz-icon","","nzType","delete"],["nzSpan","16"],[3,"data","lineChartData",4,"ngIf"],["nzSpan","8"],[3,"parameters","selected"],["nz-button","","nzType","primary",3,"click"],[3,"data","lineChartData"],["nz-form","",3,"formGroup"],["nzFor","comparisons","nzSpan","5","nzRequired",""],["nzMode","multiple","formControlName","comparisons"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"data","externalSelection","allowSelection","parameters","selected",4,"ngIf"],[3,"output"],[3,"nzShowTotal","nzPageSize","nzPageIndex","nzTotal","nzPageIndexChange"],[3,"data"],["rangeTemplate",""],[3,"nzLabel","nzValue"],[3,"data","externalSelection","allowSelection","parameters","selected"],["nz-form","",3,"formGroup",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"projectData","externalTrigger","complete"],[3,"projectData","externalTrigger"],["nz-input","","type","text","formControlName","title"],["nzFor","sampleProcessingProtocol"],["formControlName","sample_processing_protocol","id","sampleProcessingProtocol",3,"editor"],["nzFor","dataProcessingProtocol"],["formControlName","data_processing_protocol","id","dataProcessingProtocol",3,"editor"],["nzFor","description"],["formControlName","description","id","description",3,"editor"],[3,"nzFor","nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","",2,"width","80%","margin-right","8px",3,"id","formControlName","nzAutocomplete"],["nz-icon","","nzType","plus-circle-o",1,"icon-button",3,"click"],["auto",""],[3,"nzLabel","nzValue","click",4,"ngFor","ngForOf"],["style","padding-top: 4px",4,"ngIf"],[3,"nzLabel","nzValue","click"],[2,"padding-top","4px"],["nzSize","small",3,"nzShowPagination","nzData"],["nzWidth","20px"],["nz-icon","","nzType","minus-circle-o",3,"click"],["nz-checkbox","","formControlName","profile_plot"],["nz-checkbox","","formControlName","volcano_plot"]],template:function(_e,Be){1&_e&&(t.YNc(0,ga,45,19,"nz-content",0),t.TgZ(1,"nz-modal",1),t.NdJ("nzVisibleChange",function(Tn){return Be.modalVisible=Tn})("nzOnCancel",function(){return Be.closeModal()})("nzOnOk",function(){return Be.processOK()}),t.YNc(2,dn,2,1,"ng-container",2),t.qZA(),t.TgZ(3,"nz-modal",3),t.NdJ("nzVisibleChange",function(Tn){return Be.projectSettingsVisible=Tn})("nzOnCancel",function(){return Be.closeModal()})("nzOnOk",function(){return Be.updateProjectSettings()}),t.YNc(4,Fn,8,1,"ng-container",2),t.qZA()),2&_e&&(t.Q6J("ngIf",Be.project.id),t.xp6(1),t.Q6J("nzWidth",1e3)("nzVisible",Be.modalVisible),t.xp6(2),t.Q6J("nzWidth",1e3)("nzVisible",Be.projectSettingsVisible))},directives:[$.O5,X.OK,i.SK,ne.ZU,m.ix,s.w,V.Ls,i.t3,x._Y,x.JL,x.sg,r.Nx,n.Ie,x.JJ,x.u,$.sg,y,ut,ot,p.dQ,r.Lr,r.iK,r.Fd,pt.Vq,pt.Ip,Kt,Zt,_.dE,Rn,ns,Bo,$.RF,$.n9,yo.S,Yo.m,ms.R,c.Zp,x.Fj,zo.u,$.ED,lt.Pf,lt.gi,lt.NB,Gi.N8,Gi.Om,Gi.$Z,Gi.Uo,Gi._C,Gi.p0],styles:[""]}),Je})();function er(Je,Dt){if(1&Je&&t._uU(0),2&Je){const _e=Dt.range;t.lnq(" ",_e[0],"-",_e[1]," of ",Dt.$implicit," items\n")}}let yr=(()=>{class Je{constructor(_e,Be,Ft){this.route=_e,this.web=Be,this.fb=Ft,this.data={results:[]},this.query="",this.form=this.fb.group({ptmData:[null],significantCutoff:[0],fcCutoff:[0]}),this.route.params.subscribe(Tn=>{Tn.query&&(this.query=Tn.query,this.web.getDifferentialAnalysisFromGeneNames(Tn.query,0,20,!1,"",this.form.value.ptmData,!0).subscribe($n=>{this.data=$n}))})}ngOnInit(){}changePage(_e){this.web.getDifferentialAnalysisFromGeneNames(this.query,_e-1,20,!1,"",this.form.value.ptmData,!0,this.form.value.significantCutoff,this.form.value.fcCutoff).subscribe(Be=>{this.data=Be})}refreshSearch(){this.web.getDifferentialAnalysisFromGeneNames(this.query,0,20,!1,"",this.form.value.ptmData,!0,this.form.value.significantCutoff,this.form.value.fcCutoff).subscribe(_e=>{this.data=_e})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(g.gz),t.Y36(k.Q),t.Y36(x.qu))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-search-data"]],decls:33,vars:13,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzFor","ptmData","nzSpan","6"],["nzSpan","4"],["nzId","ptmData","formControlName","ptmData"],[3,"nzLabel","nzValue"],["nzFor","significantCutoff","nzSpan","6"],["nzSpan","2"],["nz-input","","type","number","id","significantCutoff","formControlName","significantCutoff"],["nzFor","fcCutoff","nzSpan","6"],["nz-input","","type","number","id","fcCutoff","formControlName","fcCutoff"],["type","submit","nzType","primary","nz-button",""],[3,"nzShowTotal","nzPageSize","nzPageIndex","nzTotal","nzPageIndexChange"],[3,"data"],["rangeTemplate",""]],template:function(_e,Be){if(1&_e&&(t._UZ(0,"nz-page-header"),t.TgZ(1,"nz-page-header-title"),t._uU(2,"Search"),t.qZA(),t.TgZ(3,"nz-page-header-subtitle"),t._uU(4),t.qZA(),t.TgZ(5,"nz-page-header-content")(6,"form",0),t.NdJ("ngSubmit",function(){return Be.refreshSearch()}),t.TgZ(7,"nz-form-item")(8,"nz-form-label",1),t._uU(9," Select for PTM and/or Total Proteomics "),t.qZA(),t.TgZ(10,"nz-form-control",2)(11,"nz-select",3),t._UZ(12,"nz-option",4)(13,"nz-option",4)(14,"nz-option",4),t.qZA()()(),t.TgZ(15,"nz-form-item")(16,"nz-form-label",5),t._uU(17," -log10(p-value) Cutoff "),t.qZA(),t.TgZ(18,"nz-form-control",6),t._UZ(19,"input",7),t.qZA()(),t.TgZ(20,"nz-form-item")(21,"nz-form-label",8),t._uU(22," Absolute log2(fold change) cutoff "),t.qZA(),t.TgZ(23,"nz-form-control",6),t._UZ(24,"input",9),t.qZA()(),t.TgZ(25,"nz-form-item")(26,"button",10),t._uU(27,"Refresh"),t.qZA()()()(),t._UZ(28,"hr"),t.TgZ(29,"nz-pagination",11),t.NdJ("nzPageIndexChange",function(Tn){return Be.changePage(Tn)}),t.qZA(),t._UZ(30,"app-data-table",12),t.YNc(31,er,1,3,"ng-template",null,13,t.W1O)),2&_e){const Ft=t.MAs(32);t.xp6(4),t.Oqu(Be.query),t.xp6(2),t.Q6J("formGroup",Be.form),t.xp6(6),t.Q6J("nzLabel","PTM and Total Proteomics")("nzValue",null),t.xp6(1),t.Q6J("nzLabel","PTM Proteomics")("nzValue",1),t.xp6(1),t.Q6J("nzLabel","Total Proteomics")("nzValue",0),t.xp6(15),t.Q6J("nzShowTotal",Ft)("nzPageSize",20)("nzPageIndex",1)("nzTotal",Be.data.count),t.xp6(1),t.Q6J("data",Be.data)}},directives:[e.$O,e.u9,e.yG,e.u5,x._Y,x.JL,r.Lr,x.sg,i.SK,r.Nx,i.t3,r.iK,r.Fd,pt.Vq,x.JJ,x.u,pt.Ip,c.Zp,x.wV,x.Fj,m.ix,p.dQ,s.w,_.dE,Rn],styles:[""]}),Je})();var gr=Q(925),Tr=Q(6451),Ir=Q(3900),xr=Q(3601),Dr=Q(8505),Zr=Q(4090);function ei(Je,Dt){1&Je&&t.Hsn(0)}const yi=["*"];function nr(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(1),t.Oqu(_e.nzTitle)}}function mi(Je,Dt){if(1&Je&&(t.TgZ(0,"div",6),t.YNc(1,nr,2,1,"ng-container",7),t.qZA()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.nzTitle)}}function Hr(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(1),t.Oqu(_e.nzExtra)}}function Jr(Je,Dt){if(1&Je&&(t.TgZ(0,"div",8),t.YNc(1,Hr,2,1,"ng-container",7),t.qZA()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.nzExtra)}}function di(Je,Dt){if(1&Je&&(t.TgZ(0,"div",3),t.YNc(1,mi,2,1,"div",4),t.YNc(2,Jr,2,1,"div",5),t.qZA()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("ngIf",_e.nzTitle),t.xp6(1),t.Q6J("ngIf",_e.nzExtra)}}function Pi(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",_e.title," ")}}function Vi(Je,Dt){}function Br(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"td",12)(2,"div",13)(3,"span",14),t.YNc(4,Pi,2,1,"ng-container",7),t.qZA(),t.TgZ(5,"span",15),t.YNc(6,Vi,0,0,"ng-template",16),t.qZA()()(),t.BQk()),2&Je){const _e=t.oxw().$implicit,Be=t.oxw(3);t.xp6(1),t.Q6J("colSpan",_e.span),t.xp6(2),t.ekj("ant-descriptions-item-no-colon",!Be.nzColon),t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.title),t.xp6(2),t.Q6J("ngTemplateOutlet",_e.content)}}function Wi(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",_e.title," ")}}function Ui(Je,Dt){if(1&Je&&(t.TgZ(0,"td",14),t.YNc(1,Wi,2,1,"ng-container",7),t.qZA()),2&Je){const _e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.title)}}function Mi(Je,Dt){}function Ji(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,Ui,2,1,"td",17),t.TgZ(2,"td",18),t.YNc(3,Mi,0,0,"ng-template",16),t.qZA(),t.BQk()),2&Je){const _e=t.oxw().$implicit;t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.title),t.xp6(1),t.Q6J("colSpan",2*_e.span-1),t.xp6(1),t.Q6J("ngTemplateOutlet",_e.content)}}function Bi(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,Br,7,5,"ng-container",2),t.YNc(2,Ji,4,3,"ng-container",2),t.BQk()),2&Je){const _e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!_e.nzBordered),t.xp6(1),t.Q6J("ngIf",_e.nzBordered)}}function ua(Je,Dt){if(1&Je&&(t.TgZ(0,"tr",10),t.YNc(1,Bi,3,2,"ng-container",11),t.qZA()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.Q6J("ngForOf",_e)}}function gi(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,ua,2,1,"tr",9),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("ngForOf",_e.itemMatrix)}}function aa(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw().$implicit;t.xp6(1),t.hij(" ",_e.title," ")}}function Qa(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"td",12)(2,"div",13)(3,"span",14),t.YNc(4,aa,2,1,"ng-container",7),t.qZA()()(),t.BQk()),2&Je){const _e=Dt.$implicit,Be=t.oxw(4);t.xp6(1),t.Q6J("colSpan",_e.span),t.xp6(2),t.ekj("ant-descriptions-item-no-colon",!Be.nzColon),t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.title)}}function Jo(Je,Dt){}function jo(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"td",12)(2,"div",13)(3,"span",15),t.YNc(4,Jo,0,0,"ng-template",16),t.qZA()()(),t.BQk()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.Q6J("colSpan",_e.span),t.xp6(3),t.Q6J("ngTemplateOutlet",_e.content)}}function To(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"tr",10),t.YNc(2,Qa,5,4,"ng-container",11),t.qZA(),t.TgZ(3,"tr",10),t.YNc(4,jo,5,2,"ng-container",11),t.qZA(),t.BQk()),2&Je){const _e=Dt.$implicit;t.xp6(2),t.Q6J("ngForOf",_e),t.xp6(2),t.Q6J("ngForOf",_e)}}function Ei(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,To,5,2,"ng-container",11),t.BQk()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",_e.itemMatrix)}}function ka(Je,Dt){if(1&Je&&(t.ynx(0),t._uU(1),t.BQk()),2&Je){const _e=t.oxw().$implicit;t.xp6(1),t.hij(" ",_e.title," ")}}function ko(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"td",19),t.YNc(2,ka,2,1,"ng-container",7),t.qZA(),t.BQk()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.Q6J("colSpan",_e.span),t.xp6(1),t.Q6J("nzStringTemplateOutlet",_e.title)}}function oa(Je,Dt){}function Pa(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"td",18),t.YNc(2,oa,0,0,"ng-template",16),t.qZA(),t.BQk()),2&Je){const _e=Dt.$implicit;t.xp6(1),t.Q6J("colSpan",_e.span),t.xp6(1),t.Q6J("ngTemplateOutlet",_e.content)}}function eo(Je,Dt){if(1&Je&&(t.ynx(0),t.TgZ(1,"tr",10),t.YNc(2,ko,3,2,"ng-container",11),t.qZA(),t.TgZ(3,"tr",10),t.YNc(4,Pa,3,2,"ng-container",11),t.qZA(),t.BQk()),2&Je){const _e=Dt.$implicit;t.xp6(2),t.Q6J("ngForOf",_e),t.xp6(2),t.Q6J("ngForOf",_e)}}function pa(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,eo,5,2,"ng-container",11),t.BQk()),2&Je){const _e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",_e.itemMatrix)}}function xo(Je,Dt){if(1&Je&&(t.ynx(0),t.YNc(1,Ei,2,1,"ng-container",2),t.YNc(2,pa,2,1,"ng-container",2),t.BQk()),2&Je){const _e=t.oxw();t.xp6(1),t.Q6J("ngIf",!_e.nzBordered),t.xp6(1),t.Q6J("ngIf",_e.nzBordered)}}let fa=(()=>{class Je{constructor(){this.nzSpan=1,this.nzTitle="",this.inputChange$=new q.x}ngOnChanges(){this.inputChange$.next()}ngOnDestroy(){this.inputChange$.complete()}}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["nz-descriptions-item"]],viewQuery:function(_e,Be){if(1&_e&&t.Gf(t.Rgc,7),2&_e){let Ft;t.iGM(Ft=t.CRH())&&(Be.content=Ft.first)}},inputs:{nzSpan:"nzSpan",nzTitle:"nzTitle"},exportAs:["nzDescriptionsItem"],features:[t.TTD],ngContentSelectors:yi,decls:1,vars:0,template:function(_e,Be){1&_e&&(t.F$t(),t.YNc(0,ei,1,0,"ng-template"))},encapsulation:2,changeDetection:0}),(0,f.gn)([(0,l.Rn)()],Je.prototype,"nzSpan",void 0),Je})();const cs={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};let rs=(()=>{class Je{constructor(_e,Be,Ft,Tn){this.nzConfigService=_e,this.cdr=Be,this.breakpointService=Ft,this.directionality=Tn,this._nzModuleName="descriptions",this.nzBordered=!1,this.nzLayout="horizontal",this.nzColumn=cs,this.nzSize="default",this.nzTitle="",this.nzColon=!0,this.itemMatrix=[],this.realColumn=3,this.dir="ltr",this.breakpoint=Zr.G_.md,this.destroy$=new q.x}ngOnInit(){var _e;this.dir=this.directionality.value,null===(_e=this.directionality.change)||void 0===_e||_e.pipe((0,Vr.R)(this.destroy$)).subscribe(Be=>{this.dir=Be})}ngOnChanges(_e){_e.nzColumn&&this.prepareMatrix()}ngAfterContentInit(){const _e=this.items.changes.pipe((0,Cr.O)(this.items),(0,Vr.R)(this.destroy$));(0,Tr.T)(_e,_e.pipe((0,Ir.w)(()=>(0,Tr.T)(...this.items.map(Be=>Be.inputChange$)).pipe((0,xr.e)(16)))),this.breakpointService.subscribe(Zr.WV).pipe((0,Dr.b)(Be=>this.breakpoint=Be))).pipe((0,Vr.R)(this.destroy$)).subscribe(()=>{this.prepareMatrix(),this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}prepareMatrix(){if(!this.items)return;let _e=[],Be=0;const Ft=this.realColumn=this.getColumn(),Tn=this.items.toArray(),$n=Tn.length,or=[],vr=()=>{or.push(_e),_e=[],Be=0};for(let ur=0;ur<$n;ur++){const Or=Tn[ur],{nzTitle:Nr,content:ii,nzSpan:le}=Or;Be+=le,Be>=Ft?(Be>Ft&&(0,pi.ZK)(`"nzColumn" is ${Ft} but we have row length ${Be}`),_e.push({title:Nr,content:ii,span:Ft-(Be-le)}),vr()):ur===$n-1?(_e.push({title:Nr,content:ii,span:Ft-(Be-le)}),vr()):_e.push({title:Nr,content:ii,span:le})}this.itemMatrix=or}getColumn(){return"number"!=typeof this.nzColumn?this.nzColumn[this.breakpoint]:this.nzColumn}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(dr.jY),t.Y36(t.sBO),t.Y36(Zr.r3),t.Y36(d.Is,8))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["nz-descriptions"]],contentQueries:function(_e,Be,Ft){if(1&_e&&t.Suo(Ft,fa,4),2&_e){let Tn;t.iGM(Tn=t.CRH())&&(Be.items=Tn)}},hostAttrs:[1,"ant-descriptions"],hostVars:8,hostBindings:function(_e,Be){2&_e&&t.ekj("ant-descriptions-bordered",Be.nzBordered)("ant-descriptions-middle","middle"===Be.nzSize)("ant-descriptions-small","small"===Be.nzSize)("ant-descriptions-rtl","rtl"===Be.dir)},inputs:{nzBordered:"nzBordered",nzLayout:"nzLayout",nzColumn:"nzColumn",nzSize:"nzSize",nzTitle:"nzTitle",nzExtra:"nzExtra",nzColon:"nzColon"},exportAs:["nzDescriptions"],features:[t.TTD],decls:6,vars:3,consts:[["class","ant-descriptions-header",4,"ngIf"],[1,"ant-descriptions-view"],[4,"ngIf"],[1,"ant-descriptions-header"],["class","ant-descriptions-title",4,"ngIf"],["class","ant-descriptions-extra",4,"ngIf"],[1,"ant-descriptions-title"],[4,"nzStringTemplateOutlet"],[1,"ant-descriptions-extra"],["class","ant-descriptions-row",4,"ngFor","ngForOf"],[1,"ant-descriptions-row"],[4,"ngFor","ngForOf"],[1,"ant-descriptions-item",3,"colSpan"],[1,"ant-descriptions-item-container"],[1,"ant-descriptions-item-label"],[1,"ant-descriptions-item-content"],[3,"ngTemplateOutlet"],["class","ant-descriptions-item-label",4,"nzStringTemplateOutlet"],[1,"ant-descriptions-item-content",3,"colSpan"],[1,"ant-descriptions-item-label",3,"colSpan"]],template:function(_e,Be){1&_e&&(t.YNc(0,di,3,2,"div",0),t.TgZ(1,"div",1)(2,"table")(3,"tbody"),t.YNc(4,gi,2,1,"ng-container",2),t.YNc(5,xo,3,2,"ng-container",2),t.qZA()()()),2&_e&&(t.Q6J("ngIf",Be.nzTitle||Be.nzExtra),t.xp6(4),t.Q6J("ngIf","horizontal"===Be.nzLayout),t.xp6(1),t.Q6J("ngIf","vertical"===Be.nzLayout))},directives:[$.O5,o.f,$.sg,$.tP],encapsulation:2,changeDetection:0}),(0,f.gn)([(0,l.yF)(),(0,dr.oS)()],Je.prototype,"nzBordered",void 0),(0,f.gn)([(0,dr.oS)()],Je.prototype,"nzColumn",void 0),(0,f.gn)([(0,dr.oS)()],Je.prototype,"nzSize",void 0),(0,f.gn)([(0,dr.oS)(),(0,l.yF)()],Je.prototype,"nzColon",void 0),Je})(),Es=(()=>{class Je{}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({imports:[[d.vT,$.ez,o.T,gr.ud]]}),Je})();const ja=function(Je){return{height:Je}};let Ls=(()=>{class Je{constructor(_e,Be){this.platformId=_e,this.zone=Be,this._divName="simpleBarChart",this.height=600,this.width=600,this.allData=[],this.dataSubject=new ve.X([]),this.title="Bar Chart"}set divName(_e){this._divName=_e}get divName(){return this._divName}set data(_e){this.updatePlot(_e)}browserOnly(_e){(0,$.NF)(this.platformId)&&this.zone.runOutsideAngular(()=>{_e()})}ngOnInit(){}ngAfterViewInit(){this.dataSubject.asObservable().subscribe(_e=>{Object.keys(_e).length>0&&this.drawData(_e)})}ngOnDestroy(){this.browserOnly(()=>{this.root&&this.root.dispose()})}updatePlot(_e=[]){this.allData=_e,this.dataSubject.next(this.allData)}drawData(_e){this.browserOnly(()=>{let Be;void 0!==this.root?(Be=this.root,Be.container.children.clear()):Be=N.f.new(this.divName),Be.setThemes([ce.Z.new(Be),oe.Z.new(Be)]);let Ft=Be.container.children.push(fe.z.new(Be,{panX:!1,panY:!1,wheelX:"panX",wheelY:"zoomX",layout:Be.verticalLayout}));Ft.children.unshift(U._.new(Be,{text:this.title,fontSize:25,fontWeight:"500",textAlign:"center",x:ee.aQ(50),centerX:ee.aQ(50),paddingTop:0,paddingBottom:0})),Ft.set("cursor",Ae.new(Be,{behavior:"zoomX"})).lineY.set("visible",!1);let $n=De.n.new(Be,{minGridDistance:10}),or=Ft.xAxes.push(Oe.$.new(Be,{maxDeviation:0,categoryField:"id",renderer:$n}));$n.labels.template.setAll({rotation:-90,centerY:ee.CI,centerX:ee.AQ,paddingRight:15});let vr=Ft.yAxes.push(Le.m.new(Be,{maxDeviation:0,renderer:Me.j.new(Be,{})})),ur=Ft.series.push(Ie.d.new(Be,{name:"Data",xAxis:or,yAxis:vr,valueYField:"value",sequencedInterpolation:!0,categoryXField:"id",tooltip:B.u.new(Be,{labelText:"{valueY}"})}));ur.set("tooltip",B.u.new(Be,{})).label.adapters.add("text",(Nr,ii)=>{let le="";return ii.dataItem&&ii.dataItem.dataContext.data?(le=ii.dataItem.dataContext.data.gene_names?le+ii.dataItem.dataContext.data.gene_names.gene_names+"\n":le+ii.dataItem.dataContext.data.primary_id+"\n",le=le+"FC: "+ii.dataItem.dataContext.data.fold_change+"\nSignificant: "+ii.dataItem.dataContext.data.significant+"\nComparison: "+ii.dataItem.dataContext.data.comparison.name,le):Nr}),$n.labels.template.adapters.add("text",(Nr,ii,le)=>ii.dataItem&&ii.dataItem.dataContext&&ii.dataItem.dataContext.data.selected?"Selected":""),ur.data.setAll(_e),or.data.setAll(_e),ur.columns.template.setAll({cornerRadiusTL:5,cornerRadiusTR:5,templateField:"columnSettings"}),Ft.appear(1e3,100),this.root=Be})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.Lbi),t.Y36(t.R0b))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-bar-chart-simple"]],inputs:{divName:"divName",data:"data",title:"title"},decls:1,vars:5,consts:[[3,"id"]],template:function(_e,Be){1&_e&&t._UZ(0,"div",0),2&_e&&(t.Akn(t.VKq(3,ja,Be.height+"px")),t.s9C("id",Be.divName))},styles:[""]}),Je})();const Ua=function(Je){return{height:Je}};let is=(()=>{class Je{constructor(_e,Be,Ft,Tn,$n){this.platformId=_e,this.zone=Be,this.web=Ft,this.fb=Tn,this.dataService=$n,this.divName="barChart",this.height=600,this._data={},this.allData=[],this.title="Bar Chart",this.conditions=[],this.samples=[],this.sampleToBeShow=[],this.selected=new t.vpe,this.dataSubject=new ve.X([])}set data(_e){this.updatePlot(_e)}updatePlot(_e=[]){console.log(_e),this._data={},this.allData=_e,this.allData.forEach(Ft=>{const Tn=Ft.raw_sample_column.name.split(".");Tn[0]in this._data||(this._data[Tn[0]]=[]),Ft.sample=Ft.raw_sample_column.name,Ft.condition=Tn[0],this._data[Tn[0]].push(Ft)});let Be=[];for(const Ft in this._data){Be=Be.concat(this._data[Ft]);const Tn=Math.ceil(this._data[Ft].length/2);this.sampleToBeShow.push(this._data[Ft][Tn].sample)}this.conditions=Object.keys(this._data),this.dataSubject.next(Be)}ngOnInit(){}browserOnly(_e){(0,$.NF)(this.platformId)&&this.zone.runOutsideAngular(()=>{_e()})}ngAfterViewInit(){this.dataSubject.asObservable().subscribe(_e=>{Object.keys(_e).length>0&&this.drawData(_e)})}ngOnDestroy(){this.browserOnly(()=>{this.root&&this.root.dispose()})}drawData(_e){this.browserOnly(()=>{let Be;void 0!==this.root?(Be=this.root,Be.container.children.clear()):Be=N.f.new(this.divName),Be.setThemes([oe.Z.new(Be)]);let Ft=Be.container.children.push(fe.z.new(Be,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0,layout:Be.verticalLayout}));Ft.children.unshift(U._.new(Be,{text:this.title,fontSize:25,fontWeight:"500",textAlign:"center",x:ee.aQ(50),centerX:ee.aQ(50),paddingTop:0,paddingBottom:0})),Ft.set("cursor",Ae.new(Be,{})).lineY.set("visible",!1);let $n=De.n.new(Be,{minGridDistance:30});$n.labels.template.setAll({centerY:ee.CI,centerX:ee.AQ,paddingRight:15});let or=Ft.yAxes.push(Le.m.new(Be,{maxDeviation:.3,renderer:Me.j.new(Be,{}),min:0}));or.children.unshift(U._.new(Be,{rotation:-90,text:"Intensity",y:ee.CI,centerX:ee.CI}));let vr=Ft.xAxes.push(Oe.$.new(Be,{maxDeviation:.3,categoryField:"sample",renderer:$n,tooltip:B.u.new(Be,{})}));vr.children.push(U._.new(Be,{text:"Samples",x:ee.CI,centerX:ee.CI}));let ur=Ft.series.push(Ie.d.new(Be,{name:"Data",xAxis:vr,yAxis:or,valueYField:"value",sequencedInterpolation:!0,categoryXField:"sample",tooltip:B.u.new(Be,{labelText:"{valueY}"})}));ur.data.setAll(_e),vr.data.setAll(_e),ur.columns.template.setAll({cornerRadiusTL:5,cornerRadiusTR:5}),ur.columns.template.adapters.add("fill",(Or,Nr)=>Ft.get("colors").getIndex(this.conditions.indexOf(Nr.dataItem.dataContext.condition))),ur.columns.template.adapters.add("stroke",(Or,Nr)=>Ft.get("colors").getIndex(this.conditions.indexOf(Nr.dataItem.dataContext.condition))),$n.labels.template.adapters.add("text",(Or,Nr,ii)=>{if(Nr.dataItem&&Nr.dataItem.dataContext&&this.sampleToBeShow.includes(Nr.dataItem.dataContext.sample))return Nr.dataItem.dataContext.condition}),Ft.appear(1e3,100),this.root=Be})}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(t.Lbi),t.Y36(t.R0b),t.Y36(k.Q),t.Y36(x.qu),t.Y36(Ke.D))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-bar-chart"]],inputs:{data:"data",title:"title"},outputs:{selected:"selected"},decls:1,vars:5,consts:[[3,"id"]],template:function(_e,Be){1&_e&&t._UZ(0,"div",0),2&_e&&(t.Akn(t.VKq(3,Ua,Be.height+"px")),t.s9C("id",Be.divName))},styles:[""]}),Je})();function Ti(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-descriptions-item",11),t._uU(1),t.qZA()),2&Je){const _e=t.oxw(2);t.Q6J("nzSpan",1),t.xp6(1),t.Oqu(_e.uniprot.Entry)}}function Li(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-descriptions-item",12),t._uU(1),t.qZA()),2&Je){const _e=t.oxw(2);t.Q6J("nzSpan",1),t.xp6(1),t.AsE("",_e.uniprot.Organism," (",_e.uniprot["Organism (ID)"],")")}}function zs(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-descriptions-item",13),t._uU(1),t.qZA()),2&Je){const _e=t.oxw(2);t.Q6J("nzSpan",2),t.xp6(1),t.hij(" ",_e.uniprot["Protein names"],"")}}function Ps(Je,Dt){if(1&Je&&(t.TgZ(0,"nz-page-header",3)(1,"nz-page-header-title"),t._uU(2),t.qZA(),t.TgZ(3,"nz-page-header-content")(4,"nz-descriptions",4),t.YNc(5,Ti,2,2,"nz-descriptions-item",5),t.YNc(6,Li,2,3,"nz-descriptions-item",6),t.YNc(7,zs,2,2,"nz-descriptions-item",7),t.TgZ(8,"nz-descriptions-item",8),t._uU(9),t.qZA(),t.TgZ(10,"nz-descriptions-item",9)(11,"a",10),t._uU(12),t.qZA()()()()()),2&Je){const _e=t.oxw();t.Q6J("nzSubtitle",_e.uniprot["Entry Name"]),t.xp6(2),t.Oqu(_e.title),t.xp6(2),t.Q6J("nzColumn",3),t.xp6(1),t.Q6J("ngIf",_e.uniprot.Entry),t.xp6(1),t.Q6J("ngIf",_e.uniprot.Organism),t.xp6(1),t.Q6J("ngIf",_e.uniprot["Protein names"]),t.xp6(1),t.Q6J("nzSpan",1),t.xp6(1),t.hij(" ",_e.comparison.name,""),t.xp6(1),t.Q6J("nzSpan",1),t.xp6(1),t.MGl("href","#/project-explorer/details/",_e.project.id,"",t.LSH),t.xp6(1),t.Oqu(_e.project.title)}}function as(Je,Dt){if(1&Je&&t._UZ(0,"app-volcano-plotly",20),2&Je){const _e=t.oxw(2);t.Q6J("data",_e.data.results)("allowSelection",!1)("parameters",_e.volcanoSettings)}}function Oo(Je,Dt){if(1&Je){const _e=t.EpF();t.ynx(0),t.TgZ(1,"nz-row")(2,"nz-col",14),t.YNc(3,as,1,3,"app-volcano-plotly",15),t.qZA(),t.TgZ(4,"nz-col",16)(5,"app-volcano-plot-settings",17),t.NdJ("output",function(Ft){return t.CHM(_e),t.oxw().handleVolcanoSettings(Ft)}),t.qZA()()(),t.TgZ(6,"nz-row")(7,"nz-col",18),t._UZ(8,"app-bar-chart-simple",19),t.qZA(),t.TgZ(9,"nz-col",18),t._UZ(10,"app-bar-chart-simple",19),t.qZA()(),t.BQk()}if(2&Je){const _e=t.oxw();t.xp6(3),t.Q6J("ngIf",_e.data.results.length>0),t.xp6(5),t.Q6J("data",_e.daFCSorted)("title","Sorted Fold Change Distribution")("divName","fcSorted"),t.xp6(2),t.Q6J("data",_e.daSignificantSorted)("title","Sorted Significant Distribution")("divName","significantSorted")}}function Zo(Je,Dt){if(1&Je&&t._UZ(0,"app-bar-chart",21),2&Je){const _e=t.oxw();t.Q6J("data",_e.rawData.results)("title",_e.title)}}const Cs=[{path:"",component:R},{path:"details/:id",component:Zn},{path:"search/:query",component:yr},{path:"protein-viewer/:gene_names/:comparison_id/:primary_key/:ptm_data",component:(()=>{class Je{constructor(_e,Be,Ft){this.route=_e,this.web=Be,this.fb=Ft,this.volcanoSettings=this.fb.group({pCutoff:[1.5,x.kI.required],fcCutoff:[.5,x.kI.required],minX:[null],maxX:[null],minY:[null],maxY:[null]}),this.query={},this.data={},this.comparison={},this.project={},this.rawData={},this.title="",this.daFCSorted=[],this.daSignificantSorted=[],this.route.params.subscribe(Tn=>{this.query=Tn,this.title=decodeURI(this.query.gene_names),this.web.getDifferentialAnalysisFromGeneNames(this.title,0,99999999,!0,"",Tn.ptm_data,!0).subscribe($n=>{const or=parseInt(this.query.primary_key);let vr="";$n.results=$n.results.map(Nr=>{if(Nr.id===or){Nr.selected=!0,vr=Nr.primary_id;let ii=Nr.gene_names.accession_id;""!==Nr.gene_names.entry&&(ii=Nr.gene_names.entry,Nr.gene_names.primary_uniprot_record&&this.web.getUniprotRecord(Nr.gene_names.primary_uniprot_record).subscribe(le=>{this.uniprot=le.record,console.log(this.uniprot)}))}return Nr});const ur=$n.results.slice();ur.sort((Nr,ii)=>Math.abs(ii.fold_change)-Math.abs(Nr.fold_change)),this.daFCSorted=ur.map(Nr=>{let ii="#FFDBA4",le=`Primary Key ${Nr.id}`;return Nr.id===or&&(ii="#FFCCB3",le+=" (Selected)"),{id:le,value:Nr.fold_change,data:Nr,columnSettings:{fill:ii}}});const Or=$n.results.slice();Or.sort((Nr,ii)=>ii.significant-Nr.significant),this.daSignificantSorted=Or.map(Nr=>{let ii="#FFDBA4",le=`Primary Key ${Nr.id}`;return Nr.id===or&&(ii="#FFCCB3",le+=" (Selected)"),{id:le,value:Nr.significant,data:Nr,columnSettings:{fill:ii}}}),""!==vr&&(this.title=`${this.title} (${vr})`),this.data=$n,this.web.getComparison(this.query.comparison_id).subscribe(Nr=>{this.comparison=Nr,this.web.getProjectFromFile(Nr.file).subscribe(ii=>{this.project=ii;for(const le of this.project.files)"R"===le.file_type&&(this.rawFile=le,"PTM"===this.project.project_type?this.web.getRawDataFromGeneNames(vr,0,99999999,!0,[le.id],!0,!0).subscribe(E=>{this.rawData=E}):this.web.getRawDataFromGeneNames(decodeURI(this.query.gene_names),0,99999999,!0,[le.id]).subscribe(E=>{this.rawData=E}))})})})})}ngOnInit(){}handleVolcanoSettings(_e){this.volcanoSettings=_e}}return Je.\u0275fac=function(_e){return new(_e||Je)(t.Y36(g.gz),t.Y36(k.Q),t.Y36(x.qu))},Je.\u0275cmp=t.Xpm({type:Je,selectors:[["app-protein-viewer"]],decls:3,vars:3,consts:[[3,"nzSubtitle",4,"ngIf"],[4,"ngIf"],[3,"data","title",4,"ngIf"],[3,"nzSubtitle"],["nzSize","small",3,"nzColumn"],["nzTitle","Primary Accession",3,"nzSpan",4,"ngIf"],["nzTitle","Organism",3,"nzSpan",4,"ngIf"],["nzTitle","Protein Full Name",3,"nzSpan",4,"ngIf"],["nzTitle","Selected Comparison",3,"nzSpan"],["nzTitle","Project",3,"nzSpan"],["target","_blank",3,"href"],["nzTitle","Primary Accession",3,"nzSpan"],["nzTitle","Organism",3,"nzSpan"],["nzTitle","Protein Full Name",3,"nzSpan"],["nzSpan","16"],[3,"data","allowSelection","parameters",4,"ngIf"],["nzSpan","8"],[3,"output"],["nzSpan","12"],[3,"data","title","divName"],[3,"data","allowSelection","parameters"],[3,"data","title"]],template:function(_e,Be){1&_e&&(t.YNc(0,Ps,13,11,"nz-page-header",0),t.YNc(1,Oo,11,7,"ng-container",1),t.YNc(2,Zo,1,2,"app-bar-chart",2)),2&_e&&(t.Q6J("ngIf",void 0!==Be.uniprot),t.xp6(1),t.Q6J("ngIf",Be.data.results),t.xp6(1),t.Q6J("ngIf",Be.rawData.results))},directives:[$.O5,e.$O,e.u9,e.u5,rs,fa,i.SK,i.t3,Kt,Zt,Ls,is],styles:[""]}),Je})()}];let sa=(()=>{class Je{}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({imports:[[g.Bz.forChild(Cs)],g.Bz]}),Je})();var da=Q(7484),gs=Q(7046),us=Q(4967);st.plotlyjs=us;let Na=(()=>{class Je{}return Je.\u0275fac=function(_e){return new(_e||Je)},Je.\u0275mod=t.oAB({type:Je}),Je.\u0275inj=t.cJS({imports:[[$.ez,sa,X.wm,x.UX,r.U5,pt.LV,m.sL,c.o7,ne.ZJ,da.vh,Gi.HQ,e.KJ,b.Ph,_.uK,V.PV,Es,wo,zo.d,lt.ic,gs.ExperimentFormModule,h,n.Wr,w.cg,st]]}),Je})()},4967:Iu=>{Iu.exports=function v(Q,$,g){function t(e,r){if(!$[e]){if(!Q[e]){if(k)return k(e,!0);var c=new Error("Cannot find module '"+e+"'");throw c.code="MODULE_NOT_FOUND",c}var n=$[e]={exports:{}};Q[e][0].call(n.exports,function(m){return t(Q[e][1][m]||m)},n,n.exports,v,Q,$,g)}return $[e].exports}for(var k=void 0,x=0;x<g.length;x++)t(g[x]);return t}({1:[function(v,Q,$){"use strict";var g=v("../src/lib"),t={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var k in t){var x=k.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");g.addStyleRule(x,t[k])}},{"../src/lib":515}],2:[function(v,Q,$){"use strict";Q.exports=v("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/box")},{"../src/traces/box":688}],6:[function(v,Q,$){"use strict";Q.exports=v("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(v,Q,$){"use strict";Q.exports=v("../src/core")},{"../src/core":493}],15:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(v,Q,$){"use strict";Q.exports=v("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(v,Q,$){"use strict";Q.exports=v("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/image")},{"../src/traces/image":861}],27:[function(v,Q,$){"use strict";var g=v("./core");g.register([v("./bar"),v("./box"),v("./heatmap"),v("./histogram"),v("./histogram2d"),v("./histogram2dcontour"),v("./contour"),v("./scatterternary"),v("./violin"),v("./funnel"),v("./waterfall"),v("./image"),v("./pie"),v("./sunburst"),v("./treemap"),v("./icicle"),v("./funnelarea"),v("./scatter3d"),v("./surface"),v("./isosurface"),v("./volume"),v("./mesh3d"),v("./cone"),v("./streamtube"),v("./scattergeo"),v("./choropleth"),v("./scattergl"),v("./splom"),v("./pointcloud"),v("./heatmapgl"),v("./parcoords"),v("./parcats"),v("./scattermapbox"),v("./choroplethmapbox"),v("./densitymapbox"),v("./sankey"),v("./indicator"),v("./table"),v("./carpet"),v("./scattercarpet"),v("./contourcarpet"),v("./ohlc"),v("./candlestick"),v("./scatterpolar"),v("./scatterpolargl"),v("./barpolar"),v("./scattersmith"),v("./aggregate"),v("./filter"),v("./groupby"),v("./sort"),v("./calendars")]),Q.exports=g},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(v,Q,$){"use strict";Q.exports=v("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/table")},{"../src/traces/table":1082}],52:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(v,Q,$){"use strict";Q.exports=v("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(v,Q,$){var g,t;g=this,t=function(g,t,k,x,e){"use strict";function r(te){return te.target.depth}function i(te,ae){return te.sourceLinks.length?te.depth:ae-1}function c(te){return function(){return te}}e=e&&e.hasOwnProperty("default")?e.default:e;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(te){return typeof te}:function(te){return te&&"function"==typeof Symbol&&te.constructor===Symbol&&te!==Symbol.prototype?"symbol":typeof te};function m(te,ae){return s(te.source,ae.source)||te.index-ae.index}function p(te,ae){return s(te.target,ae.target)||te.index-ae.index}function s(te,ae){return te.partOfCycle===ae.partOfCycle?te.y0-ae.y0:"top"===te.circularLinkType||"bottom"===ae.circularLinkType?-1:1}function f(te){return te.value}function l(te){return(te.y0+te.y1)/2}function o(te){return l(te.source)}function d(te){return l(te.target)}function u(te){return te.index}function a(te){return te.nodes}function y(te){return te.links}function h(te,ae){var ce=te.get(ae);if(!ce)throw new Error("missing: "+ae);return ce}function _(te,ae){return ae(te)}function b(te,ae,ce){var oe=0;if(null===ce){for(var ve=[],fe=0;fe<te.links.length;fe++){var xe=te.links[fe],Se=xe.source.index,pe=xe.target.index;ve[Se]||(ve[Se]=[]),ve[pe]||(ve[pe]=[]),-1===ve[Se].indexOf(pe)&&ve[Se].push(pe)}var ge=e(ve);ge.sort(function(de,Ae){return de.length-Ae.length});var Te={};for(fe=0;fe<ge.length;fe++){var se=ge[fe].slice(-2);Te[se[0]]||(Te[se[0]]={}),Te[se[0]][se[1]]=!0}te.links.forEach(function(de){var Ae=de.target.index,Le=de.source.index;Ae===Le||Te[Le]&&Te[Le][Ae]?(de.circular=!0,de.circularLinkID=oe,oe+=1):de.circular=!1})}else te.links.forEach(function(de){de.source[ce]<de.target[ce]?de.circular=!1:(de.circular=!0,de.circularLinkID=oe,oe+=1)})}function w(te,ae){var ce=0,oe=0;te.links.forEach(function(ve){ve.circular&&(ve.circularLinkType=ve.source.circularLinkType||ve.target.circularLinkType?ve.source.circularLinkType?ve.source.circularLinkType:ve.target.circularLinkType:ce<oe?"top":"bottom","top"==ve.circularLinkType?ce+=1:oe+=1,te.nodes.forEach(function(fe){_(fe,ae)!=_(ve.source,ae)&&_(fe,ae)!=_(ve.target,ae)||(fe.circularLinkType=ve.circularLinkType)}))}),te.links.forEach(function(ve){ve.circular&&(ve.source.circularLinkType==ve.target.circularLinkType&&(ve.circularLinkType=ve.source.circularLinkType),K(ve,ae)&&(ve.circularLinkType=ve.source.circularLinkType))})}function T(te){var ae=Math.abs(te.y1-te.y0),ce=Math.abs(te.target.x0-te.source.x1);return Math.atan(ce/ae)}function L(te,ae){var ce=0;te.sourceLinks.forEach(function(ve){ce=ve.circular&&!K(ve,ae)?ce+1:ce});var oe=0;return te.targetLinks.forEach(function(ve){oe=ve.circular&&!K(ve,ae)?oe+1:oe}),ce+oe}function M(te){var ce=0;te.source.sourceLinks.forEach(function(fe){ce=fe.circular?ce+1:ce});var ve=0;return te.target.targetLinks.forEach(function(fe){ve=fe.circular?ve+1:ve}),!(ce>1||ve>1)}function P(te,ae,ce){return te.sort(S),te.forEach(function(oe,ve){var fe,xe,Se=0;if(K(oe,ce)&&M(oe))oe.circularPathData.verticalBuffer=Se+oe.width/2;else{for(var pe=0;pe<ve;pe++)if(!((fe=te[ve]).source.column<(xe=te[pe]).target.column||fe.target.column>xe.source.column)){var ge=te[pe].circularPathData.verticalBuffer+te[pe].width/2+ae;Se=ge>Se?ge:Se}oe.circularPathData.verticalBuffer=Se+oe.width/2}}),te}function z(te,ae,ce,oe){var ve=t.min(te.links,function(fe){return fe.source.y0});te.links.forEach(function(fe){fe.circular&&(fe.circularPathData={})}),P(te.links.filter(function(fe){return"top"==fe.circularLinkType}),ae,oe),P(te.links.filter(function(fe){return"bottom"==fe.circularLinkType}),ae,oe),te.links.forEach(function(fe){if(fe.circular){if(fe.circularPathData.arcRadius=fe.width+10,fe.circularPathData.leftNodeBuffer=5,fe.circularPathData.rightNodeBuffer=5,fe.circularPathData.sourceWidth=fe.source.x1-fe.source.x0,fe.circularPathData.sourceX=fe.source.x0+fe.circularPathData.sourceWidth,fe.circularPathData.targetX=fe.target.x0,fe.circularPathData.sourceY=fe.y0,fe.circularPathData.targetY=fe.y1,K(fe,oe)&&M(fe))fe.circularPathData.leftSmallArcRadius=10+fe.width/2,fe.circularPathData.leftLargeArcRadius=10+fe.width/2,fe.circularPathData.rightSmallArcRadius=10+fe.width/2,fe.circularPathData.rightLargeArcRadius=10+fe.width/2,"bottom"==fe.circularLinkType?(fe.circularPathData.verticalFullExtent=fe.source.y1+25+fe.circularPathData.verticalBuffer,fe.circularPathData.verticalLeftInnerExtent=fe.circularPathData.verticalFullExtent-fe.circularPathData.leftLargeArcRadius,fe.circularPathData.verticalRightInnerExtent=fe.circularPathData.verticalFullExtent-fe.circularPathData.rightLargeArcRadius):(fe.circularPathData.verticalFullExtent=fe.source.y0-25-fe.circularPathData.verticalBuffer,fe.circularPathData.verticalLeftInnerExtent=fe.circularPathData.verticalFullExtent+fe.circularPathData.leftLargeArcRadius,fe.circularPathData.verticalRightInnerExtent=fe.circularPathData.verticalFullExtent+fe.circularPathData.rightLargeArcRadius);else{var xe=fe.source.column,Se=fe.circularLinkType,pe=te.links.filter(function(se){return se.source.column==xe&&se.circularLinkType==Se});pe.sort("bottom"==fe.circularLinkType?R:C);var ge=0;pe.forEach(function(se,de){se.circularLinkID==fe.circularLinkID&&(fe.circularPathData.leftSmallArcRadius=10+fe.width/2+ge,fe.circularPathData.leftLargeArcRadius=10+fe.width/2+de*ae+ge),ge+=se.width}),xe=fe.target.column,(pe=te.links.filter(function(se){return se.target.column==xe&&se.circularLinkType==Se})).sort("bottom"==fe.circularLinkType?j:D),ge=0,pe.forEach(function(se,de){se.circularLinkID==fe.circularLinkID&&(fe.circularPathData.rightSmallArcRadius=10+fe.width/2+ge,fe.circularPathData.rightLargeArcRadius=10+fe.width/2+de*ae+ge),ge+=se.width}),"bottom"==fe.circularLinkType?(fe.circularPathData.verticalFullExtent=Math.max(ce,fe.source.y1,fe.target.y1)+25+fe.circularPathData.verticalBuffer,fe.circularPathData.verticalLeftInnerExtent=fe.circularPathData.verticalFullExtent-fe.circularPathData.leftLargeArcRadius,fe.circularPathData.verticalRightInnerExtent=fe.circularPathData.verticalFullExtent-fe.circularPathData.rightLargeArcRadius):(fe.circularPathData.verticalFullExtent=ve-25-fe.circularPathData.verticalBuffer,fe.circularPathData.verticalLeftInnerExtent=fe.circularPathData.verticalFullExtent+fe.circularPathData.leftLargeArcRadius,fe.circularPathData.verticalRightInnerExtent=fe.circularPathData.verticalFullExtent+fe.circularPathData.rightLargeArcRadius)}fe.circularPathData.leftInnerExtent=fe.circularPathData.sourceX+fe.circularPathData.leftNodeBuffer,fe.circularPathData.rightInnerExtent=fe.circularPathData.targetX-fe.circularPathData.rightNodeBuffer,fe.circularPathData.leftFullExtent=fe.circularPathData.sourceX+fe.circularPathData.leftLargeArcRadius+fe.circularPathData.leftNodeBuffer,fe.circularPathData.rightFullExtent=fe.circularPathData.targetX-fe.circularPathData.rightLargeArcRadius-fe.circularPathData.rightNodeBuffer}if(fe.circular)fe.path="top"==(se=fe).circularLinkType?"M"+se.circularPathData.sourceX+" "+se.circularPathData.sourceY+" L"+se.circularPathData.leftInnerExtent+" "+se.circularPathData.sourceY+" A"+se.circularPathData.leftLargeArcRadius+" "+se.circularPathData.leftSmallArcRadius+" 0 0 0 "+se.circularPathData.leftFullExtent+" "+(se.circularPathData.sourceY-se.circularPathData.leftSmallArcRadius)+" L"+se.circularPathData.leftFullExtent+" "+se.circularPathData.verticalLeftInnerExtent+" A"+se.circularPathData.leftLargeArcRadius+" "+se.circularPathData.leftLargeArcRadius+" 0 0 0 "+se.circularPathData.leftInnerExtent+" "+se.circularPathData.verticalFullExtent+" L"+se.circularPathData.rightInnerExtent+" "+se.circularPathData.verticalFullExtent+" A"+se.circularPathData.rightLargeArcRadius+" "+se.circularPathData.rightLargeArcRadius+" 0 0 0 "+se.circularPathData.rightFullExtent+" "+se.circularPathData.verticalRightInnerExtent+" L"+se.circularPathData.rightFullExtent+" "+(se.circularPathData.targetY-se.circularPathData.rightSmallArcRadius)+" A"+se.circularPathData.rightLargeArcRadius+" "+se.circularPathData.rightSmallArcRadius+" 0 0 0 "+se.circularPathData.rightInnerExtent+" "+se.circularPathData.targetY+" L"+se.circularPathData.targetX+" "+se.circularPathData.targetY:"M"+se.circularPathData.sourceX+" "+se.circularPathData.sourceY+" L"+se.circularPathData.leftInnerExtent+" "+se.circularPathData.sourceY+" A"+se.circularPathData.leftLargeArcRadius+" "+se.circularPathData.leftSmallArcRadius+" 0 0 1 "+se.circularPathData.leftFullExtent+" "+(se.circularPathData.sourceY+se.circularPathData.leftSmallArcRadius)+" L"+se.circularPathData.leftFullExtent+" "+se.circularPathData.verticalLeftInnerExtent+" A"+se.circularPathData.leftLargeArcRadius+" "+se.circularPathData.leftLargeArcRadius+" 0 0 1 "+se.circularPathData.leftInnerExtent+" "+se.circularPathData.verticalFullExtent+" L"+se.circularPathData.rightInnerExtent+" "+se.circularPathData.verticalFullExtent+" A"+se.circularPathData.rightLargeArcRadius+" "+se.circularPathData.rightLargeArcRadius+" 0 0 1 "+se.circularPathData.rightFullExtent+" "+se.circularPathData.verticalRightInnerExtent+" L"+se.circularPathData.rightFullExtent+" "+(se.circularPathData.targetY+se.circularPathData.rightSmallArcRadius)+" A"+se.circularPathData.rightLargeArcRadius+" "+se.circularPathData.rightSmallArcRadius+" 0 0 1 "+se.circularPathData.rightInnerExtent+" "+se.circularPathData.targetY+" L"+se.circularPathData.targetX+" "+se.circularPathData.targetY;else{var Te=x.linkHorizontal().source(function(se){return[se.source.x0+(se.source.x1-se.source.x0),se.y0]}).target(function(se){return[se.target.x0,se.y1]});fe.path=Te(fe)}var se})}function S(te,ae){return q(te)==q(ae)?"bottom"==te.circularLinkType?R(te,ae):C(te,ae):q(ae)-q(te)}function C(te,ae){return te.y0-ae.y0}function R(te,ae){return ae.y0-te.y0}function D(te,ae){return te.y1-ae.y1}function j(te,ae){return ae.y1-te.y1}function q(te){return te.target.column-te.source.column}function Z(te){return te.target.x0-te.source.x1}function W(te,ae){var ce=T(te),oe=Z(ae)/Math.tan(ce);return"up"==B(te)?te.y1+oe:te.y1-oe}function G(te,ae){var ce=T(te),oe=Z(ae)/Math.tan(ce);return"up"==B(te)?te.y1-oe:te.y1+oe}function X(te,ae,ce,oe){te.links.forEach(function(ve){if(!ve.circular&&ve.target.column-ve.source.column>1){var fe=ve.source.column+1,xe=ve.target.column-1,Se=1,pe=xe-fe+1;for(Se=1;fe<=xe;fe++,Se++)te.nodes.forEach(function(ge){if(ge.column==fe){var Te,se=Se/(pe+1),de=Math.pow(1-se,3),Ae=3*se*Math.pow(1-se,2),Le=3*Math.pow(se,2)*(1-se),Me=Math.pow(se,3),De=de*ve.y0+Ae*ve.y0+Le*ve.y1+Me*ve.y1,Oe=De-ve.width/2,Ie=De+ve.width/2;Oe>ge.y0&&Oe<ge.y1?(Te=ge.y1-Oe+10,ge=V(ge,Te="bottom"==ge.circularLinkType?Te:-Te,ae,ce),te.nodes.forEach(function(Qe){_(Qe,oe)!=_(ge,oe)&&Qe.column==ge.column&&ne(ge,Qe)&&V(Qe,Te,ae,ce)})):(Ie>ge.y0&&Ie<ge.y1||Oe<ge.y0&&Ie>ge.y1)&&(ge=V(ge,Te=Ie-ge.y0+10,ae,ce),te.nodes.forEach(function(Qe){_(Qe,oe)!=_(ge,oe)&&Qe.column==ge.column&&Qe.y0<ge.y1&&Qe.y1>ge.y1&&V(Qe,Te,ae,ce)}))}})}})}function ne(te,ae){return te.y0>ae.y0&&te.y0<ae.y1||te.y1>ae.y0&&te.y1<ae.y1||te.y0<ae.y0&&te.y1>ae.y1}function V(te,ae,ce,oe){return te.y0+ae>=ce&&te.y1+ae<=oe&&(te.y0=te.y0+ae,te.y1=te.y1+ae,te.targetLinks.forEach(function(ve){ve.y1=ve.y1+ae}),te.sourceLinks.forEach(function(ve){ve.y0=ve.y0+ae})),te}function N(te,ae,ce,oe){te.nodes.forEach(function(ve){oe&&ve.y+(ve.y1-ve.y0)>ae&&(ve.y=ve.y-(ve.y+(ve.y1-ve.y0)-ae));var fe=te.links.filter(function(pe){return _(pe.source,ce)==_(ve,ce)}),xe=fe.length;xe>1&&fe.sort(function(pe,ge){if(!pe.circular&&!ge.circular){if(pe.target.column==ge.target.column||!ee(pe,ge))return pe.y1-ge.y1;if(pe.target.column>ge.target.column){var Te=G(ge,pe);return pe.y1-Te}if(ge.target.column>pe.target.column)return G(pe,ge)-ge.y1}return pe.circular&&!ge.circular?"top"==pe.circularLinkType?-1:1:ge.circular&&!pe.circular?"top"==ge.circularLinkType?1:-1:pe.circular&&ge.circular?pe.circularLinkType===ge.circularLinkType&&"top"==pe.circularLinkType?pe.target.column===ge.target.column?pe.target.y1-ge.target.y1:ge.target.column-pe.target.column:pe.circularLinkType===ge.circularLinkType&&"bottom"==pe.circularLinkType?pe.target.column===ge.target.column?ge.target.y1-pe.target.y1:pe.target.column-ge.target.column:"top"==pe.circularLinkType?-1:1:void 0});var Se=ve.y0;fe.forEach(function(pe){pe.y0=Se+pe.width/2,Se+=pe.width}),fe.forEach(function(pe,ge){if("bottom"==pe.circularLinkType){for(var Te=ge+1,se=0;Te<xe;Te++)se+=fe[Te].width;pe.y0=ve.y1-se-pe.width/2}})})}function U(te,ae,ce){te.nodes.forEach(function(oe){var ve=te.links.filter(function(Se){return _(Se.target,ce)==_(oe,ce)}),fe=ve.length;fe>1&&ve.sort(function(Se,pe){if(!Se.circular&&!pe.circular){if(Se.source.column==pe.source.column||!ee(Se,pe))return Se.y0-pe.y0;if(pe.source.column<Se.source.column){var ge=W(pe,Se);return Se.y0-ge}if(Se.source.column<pe.source.column)return W(Se,pe)-pe.y0}return Se.circular&&!pe.circular?"top"==Se.circularLinkType?-1:1:pe.circular&&!Se.circular?"top"==pe.circularLinkType?1:-1:Se.circular&&pe.circular?Se.circularLinkType===pe.circularLinkType&&"top"==Se.circularLinkType?Se.source.column===pe.source.column?Se.source.y1-pe.source.y1:Se.source.column-pe.source.column:Se.circularLinkType===pe.circularLinkType&&"bottom"==Se.circularLinkType?Se.source.column===pe.source.column?Se.source.y1-pe.source.y1:pe.source.column-Se.source.column:"top"==Se.circularLinkType?-1:1:void 0});var xe=oe.y0;ve.forEach(function(Se){Se.y1=xe+Se.width/2,xe+=Se.width}),ve.forEach(function(Se,pe){if("bottom"==Se.circularLinkType){for(var ge=pe+1,Te=0;ge<fe;ge++)Te+=ve[ge].width;Se.y1=oe.y1-Te-Se.width/2}})})}function ee(te,ae){return B(te)==B(ae)}function B(te){return te.y0-te.y1>0?"up":"down"}function K(te,ae){return _(te.source,ae)==_(te.target,ae)}function J(te,ae,ce){var oe=te.nodes,ve=te.links,fe=!1,xe=!1;if(ve.forEach(function(ge){"top"==ge.circularLinkType?fe=!0:"bottom"==ge.circularLinkType&&(xe=!0)}),0==fe||0==xe){var Se=t.min(oe,function(ge){return ge.y0}),pe=(ce-ae)/(t.max(oe,function(ge){return ge.y1})-Se);oe.forEach(function(ge){var Te=(ge.y1-ge.y0)*pe;ge.y0=(ge.y0-Se)*pe,ge.y1=ge.y0+Te}),ve.forEach(function(ge){ge.y0=(ge.y0-Se)*pe,ge.y1=(ge.y1-Se)*pe,ge.width=ge.width*pe})}}g.sankeyCircular=function(){var te,ae,ce=0,oe=0,ve=1,fe=1,xe=24,Se=u,pe=i,ge=a,Te=y,se=32,de=2,Ae=null;function Le(){var Ne={nodes:ge.apply(null,arguments),links:Te.apply(null,arguments)};Me(Ne),b(Ne,0,Ae),De(Ne),Oe(Ne),w(Ne,Se),Ie(Ne,se,Se),Qe(Ne);for(var Pe=4,Re=0;Re<Pe;Re++)N(Ne,fe,Se),U(Ne,0,Se),X(Ne,oe,fe,Se),N(Ne,fe,Se),U(Ne,0,Se);return J(Ne,oe,fe),z(Ne,de,fe,Se),Ne}function Me(Ne){Ne.nodes.forEach(function(Re,Ge){Re.index=Ge,Re.sourceLinks=[],Re.targetLinks=[]});var Pe=k.map(Ne.nodes,Se);return Ne.links.forEach(function(Re,Ge){Re.index=Ge;var tt=Re.source,ct=Re.target;"object"!==(void 0===tt?"undefined":n(tt))&&(tt=Re.source=h(Pe,tt)),"object"!==(void 0===ct?"undefined":n(ct))&&(ct=Re.target=h(Pe,ct)),tt.sourceLinks.push(Re),ct.targetLinks.push(Re)}),Ne}function De(Ne){Ne.nodes.forEach(function(Pe){Pe.partOfCycle=!1,Pe.value=Math.max(t.sum(Pe.sourceLinks,f),t.sum(Pe.targetLinks,f)),Pe.sourceLinks.forEach(function(Re){Re.circular&&(Pe.partOfCycle=!0,Pe.circularLinkType=Re.circularLinkType)}),Pe.targetLinks.forEach(function(Re){Re.circular&&(Pe.partOfCycle=!0,Pe.circularLinkType=Re.circularLinkType)})})}function Oe(Ne){var Pe,Re,Ge;for(Pe=Ne.nodes,Re=[],Ge=0;Pe.length;++Ge,Pe=Re,Re=[])Pe.forEach(function(tt){tt.depth=Ge,tt.sourceLinks.forEach(function(ct){Re.indexOf(ct.target)<0&&!ct.circular&&Re.push(ct.target)})});for(Pe=Ne.nodes,Re=[],Ge=0;Pe.length;++Ge,Pe=Re,Re=[])Pe.forEach(function(tt){tt.height=Ge,tt.targetLinks.forEach(function(ct){Re.indexOf(ct.source)<0&&!ct.circular&&Re.push(ct.source)})});Ne.nodes.forEach(function(tt){tt.column=Math.floor(pe.call(null,tt,Ge))})}function Ie(Ne,Pe,Re){var Ge=k.nest().key(function(gt){return gt.column}).sortKeys(t.ascending).entries(Ne.nodes).map(function(gt){return gt.values});(function(gt){if(ae){var at=1/0;Ge.forEach(function(Gt){var en=fe*ae/(Gt.length+1);at=en<at?en:at}),te=at}var et=t.min(Ge,function(Gt){return(fe-oe-(Gt.length-1)*te)/t.sum(Gt,f)});et*=.3,Ne.links.forEach(function(Gt){Gt.width=Gt.value*et});var Gt,en,Jt,cn,Rt,je,yt=(en=0,Jt=0,cn=0,Rt=0,je=t.max((Gt=Ne).nodes,function(Ye){return Ye.column}),Gt.links.forEach(function(Ye){Ye.circular&&("top"==Ye.circularLinkType?en+=Ye.width:Jt+=Ye.width,0==Ye.target.column&&(Rt+=Ye.width),Ye.source.column==je&&(cn+=Ye.width))}),{top:en=en>0?en+25+10:en,bottom:Jt=Jt>0?Jt+25+10:Jt,left:Rt=Rt>0?Rt+25+10:Rt,right:cn=cn>0?cn+25+10:cn}),Vt=function(Gt,en){var Jt=t.max(Gt.nodes,function(he){return he.column}),cn=ve-ce,Rt=fe-oe,je=cn/(cn+en.right+en.left),Ye=Rt/(Rt+en.top+en.bottom);return ce=ce*je+en.left,ve=0==en.right?ve:ve*je,oe=oe*Ye+en.top,fe*=Ye,Gt.nodes.forEach(function(he){he.x0=ce+he.column*((ve-ce-xe)/Jt),he.x1=he.x0+xe}),Ye}(Ne,yt);et*=Vt,Ne.links.forEach(function(Gt){Gt.width=Gt.value*et}),Ge.forEach(function(Gt){var en=Gt.length;Gt.forEach(function(Jt,cn){Jt.depth==Ge.length-1&&1==en||0==Jt.depth&&1==en?(Jt.y0=fe/2-Jt.value*et,Jt.y1=Jt.y0+Jt.value*et):Jt.partOfCycle?0==L(Jt,gt)?(Jt.y0=fe/2+cn,Jt.y1=Jt.y0+Jt.value*et):"top"==Jt.circularLinkType?(Jt.y0=oe+cn,Jt.y1=Jt.y0+Jt.value*et):(Jt.y0=fe-Jt.value*et-cn,Jt.y1=Jt.y0+Jt.value*et):0==yt.top||0==yt.bottom?(Jt.y0=(fe-oe)/en*cn,Jt.y1=Jt.y0+Jt.value*et):(Jt.y0=(fe-oe)/2-en/2+cn,Jt.y1=Jt.y0+Jt.value*et)})})})(Re),kt();for(var tt=1,ct=Pe;ct>0;--ct)wt(tt*=.99,Re),kt();function wt(gt,at){var et=Ge.length;Ge.forEach(function(yt){var Vt=yt.length,Gt=yt[0].depth;yt.forEach(function(en){var Jt;if((en.sourceLinks.length||en.targetLinks.length)&&!(en.partOfCycle&&L(en,at)>0))if(0==Gt&&1==Vt)en.y0=fe/2-(Jt=en.y1-en.y0)/2,en.y1=fe/2+Jt/2;else if(Gt==et-1&&1==Vt)en.y0=fe/2-(Jt=en.y1-en.y0)/2,en.y1=fe/2+Jt/2;else{var cn=t.mean(en.sourceLinks,d),Rt=t.mean(en.targetLinks,o),je=((cn&&Rt?(cn+Rt)/2:cn||Rt)-l(en))*gt;en.y0+=je,en.y1+=je}})})}function kt(){Ge.forEach(function(gt){var at,et,yt,Vt=oe,Gt=gt.length;for(gt.sort(s),yt=0;yt<Gt;++yt)(et=Vt-(at=gt[yt]).y0)>0&&(at.y0+=et,at.y1+=et),Vt=at.y1+te;if((et=Vt-te-fe)>0)for(Vt=at.y0-=et,at.y1-=et,yt=Gt-2;yt>=0;--yt)(et=(at=gt[yt]).y1+te-Vt)>0&&(at.y0-=et,at.y1-=et),Vt=at.y0})}}function Qe(Ne){Ne.nodes.forEach(function(Pe){Pe.sourceLinks.sort(p),Pe.targetLinks.sort(m)}),Ne.nodes.forEach(function(Pe){var Re=Pe.y0,Ge=Re,tt=Pe.y1,ct=tt;Pe.sourceLinks.forEach(function(wt){wt.circular?(wt.y0=tt-wt.width/2,tt-=wt.width):(wt.y0=Re+wt.width/2,Re+=wt.width)}),Pe.targetLinks.forEach(function(wt){wt.circular?(wt.y1=ct-wt.width/2,ct-=wt.width):(wt.y1=Ge+wt.width/2,Ge+=wt.width)})})}return Le.nodeId=function(Ne){return arguments.length?(Se="function"==typeof Ne?Ne:c(Ne),Le):Se},Le.nodeAlign=function(Ne){return arguments.length?(pe="function"==typeof Ne?Ne:c(Ne),Le):pe},Le.nodeWidth=function(Ne){return arguments.length?(xe=+Ne,Le):xe},Le.nodePadding=function(Ne){return arguments.length?(te=+Ne,Le):te},Le.nodes=function(Ne){return arguments.length?(ge="function"==typeof Ne?Ne:c(Ne),Le):ge},Le.links=function(Ne){return arguments.length?(Te="function"==typeof Ne?Ne:c(Ne),Le):Te},Le.size=function(Ne){return arguments.length?(ce=oe=0,ve=+Ne[0],fe=+Ne[1],Le):[ve-ce,fe-oe]},Le.extent=function(Ne){return arguments.length?(ce=+Ne[0][0],ve=+Ne[1][0],oe=+Ne[0][1],fe=+Ne[1][1],Le):[[ce,oe],[ve,fe]]},Le.iterations=function(Ne){return arguments.length?(se=+Ne,Le):se},Le.circularLinkGap=function(Ne){return arguments.length?(de=+Ne,Le):de},Le.nodePaddingRatio=function(Ne){return arguments.length?(ae=+Ne,Le):ae},Le.sortNodes=function(Ne){return arguments.length?(Ae=Ne,Le):Ae},Le.update=function(Ne){return w(Ne,Se),Qe(Ne),Ne.links.forEach(function(Pe){Pe.circular&&(Pe.circularLinkType=Pe.y0+Pe.y1<fe?"top":"bottom",Pe.source.circularLinkType=Pe.circularLinkType,Pe.target.circularLinkType=Pe.circularLinkType)}),N(Ne,fe,Se,!1),U(Ne,0,Se),z(Ne,de,fe,Se),Ne},Le},g.sankeyCenter=function(te){return te.targetLinks.length?te.depth:te.sourceLinks.length?t.min(te.sourceLinks,r)-1:0},g.sankeyLeft=function(te){return te.depth},g.sankeyRight=function(te,ae){return ae-1-te.height},g.sankeyJustify=i,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-array"),v("d3-collection"),v("d3-shape"),v("elementary-circuits-directed-graph")):t(g.d3=g.d3||{},g.d3,g.d3,g.d3,null)},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(v,Q,$){var g,t;g=this,t=function(g,t,k,x){"use strict";function e(_){return _.target.depth}function r(_,b){return _.sourceLinks.length?_.depth:b-1}function i(_){return function(){return _}}function c(_,b){return m(_.source,b.source)||_.index-b.index}function n(_,b){return m(_.target,b.target)||_.index-b.index}function m(_,b){return _.y0-b.y0}function p(_){return _.value}function s(_){return(_.y0+_.y1)/2}function f(_){return s(_.source)*_.value}function l(_){return s(_.target)*_.value}function o(_){return _.index}function d(_){return _.nodes}function u(_){return _.links}function a(_,b){var w=_.get(b);if(!w)throw new Error("missing: "+b);return w}function y(_){return[_.source.x1,_.y0]}function h(_){return[_.target.x0,_.y1]}g.sankey=function(){var _=0,b=0,w=1,T=1,L=24,M=8,P=o,z=r,S=d,C=u,R=32;function D(){var X={nodes:S.apply(null,arguments),links:C.apply(null,arguments)};return j(X),q(X),Z(X),W(X),G(X),X}function j(X){X.nodes.forEach(function(V,N){V.index=N,V.sourceLinks=[],V.targetLinks=[]});var ne=k.map(X.nodes,P);X.links.forEach(function(V,N){V.index=N;var U=V.source,ee=V.target;"object"!=typeof U&&(U=V.source=a(ne,U)),"object"!=typeof ee&&(ee=V.target=a(ne,ee)),U.sourceLinks.push(V),ee.targetLinks.push(V)})}function q(X){X.nodes.forEach(function(ne){ne.value=Math.max(t.sum(ne.sourceLinks,p),t.sum(ne.targetLinks,p))})}function Z(X){var ne,V,N;for(ne=X.nodes,V=[],N=0;ne.length;++N,ne=V,V=[])ne.forEach(function(ee){ee.depth=N,ee.sourceLinks.forEach(function(B){V.indexOf(B.target)<0&&V.push(B.target)})});for(ne=X.nodes,V=[],N=0;ne.length;++N,ne=V,V=[])ne.forEach(function(ee){ee.height=N,ee.targetLinks.forEach(function(B){V.indexOf(B.source)<0&&V.push(B.source)})});var U=(w-_-L)/(N-1);X.nodes.forEach(function(ee){ee.x1=(ee.x0=_+Math.max(0,Math.min(N-1,Math.floor(z.call(null,ee,N))))*U)+L})}function W(X){var ne=k.nest().key(function(K){return K.x0}).sortKeys(t.ascending).entries(X.nodes).map(function(K){return K.values});(function(){var K=t.max(ne,function(ae){return ae.length}),J=2/3*(T-b)/(K-1);M>J&&(M=J);var te=t.min(ne,function(ae){return(T-b-(ae.length-1)*M)/t.sum(ae,p)});ne.forEach(function(ae){ae.forEach(function(ce,oe){ce.y1=(ce.y0=oe)+ce.value*te})}),X.links.forEach(function(ae){ae.width=ae.value*te})})(),B();for(var V=1,N=R;N>0;--N)ee(V*=.99),B(),U(V),B();function U(K){ne.forEach(function(J){J.forEach(function(te){if(te.targetLinks.length){var ae=(t.sum(te.targetLinks,f)/t.sum(te.targetLinks,p)-s(te))*K;te.y0+=ae,te.y1+=ae}})})}function ee(K){ne.slice().reverse().forEach(function(J){J.forEach(function(te){if(te.sourceLinks.length){var ae=(t.sum(te.sourceLinks,l)/t.sum(te.sourceLinks,p)-s(te))*K;te.y0+=ae,te.y1+=ae}})})}function B(){ne.forEach(function(K){var J,te,ae,ce=b,oe=K.length;for(K.sort(m),ae=0;ae<oe;++ae)(te=ce-(J=K[ae]).y0)>0&&(J.y0+=te,J.y1+=te),ce=J.y1+M;if((te=ce-M-T)>0)for(ce=J.y0-=te,J.y1-=te,ae=oe-2;ae>=0;--ae)(te=(J=K[ae]).y1+M-ce)>0&&(J.y0-=te,J.y1-=te),ce=J.y0})}}function G(X){X.nodes.forEach(function(ne){ne.sourceLinks.sort(n),ne.targetLinks.sort(c)}),X.nodes.forEach(function(ne){var V=ne.y0,N=V;ne.sourceLinks.forEach(function(U){U.y0=V+U.width/2,V+=U.width}),ne.targetLinks.forEach(function(U){U.y1=N+U.width/2,N+=U.width})})}return D.update=function(X){return G(X),X},D.nodeId=function(X){return arguments.length?(P="function"==typeof X?X:i(X),D):P},D.nodeAlign=function(X){return arguments.length?(z="function"==typeof X?X:i(X),D):z},D.nodeWidth=function(X){return arguments.length?(L=+X,D):L},D.nodePadding=function(X){return arguments.length?(M=+X,D):M},D.nodes=function(X){return arguments.length?(S="function"==typeof X?X:i(X),D):S},D.links=function(X){return arguments.length?(C="function"==typeof X?X:i(X),D):C},D.size=function(X){return arguments.length?(_=b=0,w=+X[0],T=+X[1],D):[w-_,T-b]},D.extent=function(X){return arguments.length?(_=+X[0][0],w=+X[1][0],b=+X[0][1],T=+X[1][1],D):[[_,b],[w,T]]},D.iterations=function(X){return arguments.length?(R=+X,D):R},D},g.sankeyCenter=function(_){return _.targetLinks.length?_.depth:_.sourceLinks.length?t.min(_.sourceLinks,e)-1:0},g.sankeyLeft=function(_){return _.depth},g.sankeyRight=function(_,b){return b-1-_.height},g.sankeyJustify=r,g.sankeyLinkHorizontal=function(){return x.linkHorizontal().source(y).target(h)},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-array"),v("d3-collection"),v("d3-shape")):t(g.d3=g.d3||{},g.d3,g.d3,g.d3)},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(v,Q,$){(function(){var g={version:"3.8.0"},t=[].slice,k=function(le){return t.call(le)},x=self.document;function e(le){return le&&(le.ownerDocument||le.document||le).documentElement}function r(le){return le&&(le.ownerDocument&&le.ownerDocument.defaultView||le.document&&le||le.defaultView)}if(x)try{k(x.documentElement.childNodes)}catch(le){k=function(E){for(var I=E.length,F=new Array(I);I--;)F[I]=E[I];return F}}if(Date.now||(Date.now=function(){return+new Date}),x)try{x.createElement("DIV").style.setProperty("opacity",0,"")}catch(le){var i=this.Element.prototype,c=i.setAttribute,n=i.setAttributeNS,m=this.CSSStyleDeclaration.prototype,p=m.setProperty;i.setAttribute=function(E,I){c.call(this,E,I+"")},i.setAttributeNS=function(E,I,F){n.call(this,E,I,F+"")},m.setProperty=function(E,I,F){p.call(this,E,I+"",F)}}function s(le,E){return le<E?-1:le>E?1:le>=E?0:NaN}function f(le){return null===le?NaN:+le}function l(le){return!isNaN(le)}function o(le){return{left:function(E,I,F,H){for(arguments.length<3&&(F=0),arguments.length<4&&(H=E.length);F<H;){var re=F+H>>>1;le(E[re],I)<0?F=re+1:H=re}return F},right:function(E,I,F,H){for(arguments.length<3&&(F=0),arguments.length<4&&(H=E.length);F<H;){var re=F+H>>>1;le(E[re],I)>0?H=re:F=re+1}return F}}}g.ascending=s,g.descending=function(le,E){return E<le?-1:E>le?1:E>=le?0:NaN},g.min=function(le,E){var I,F,H=-1,re=le.length;if(1===arguments.length){for(;++H<re;)if(null!=(F=le[H])&&F>=F){I=F;break}for(;++H<re;)null!=(F=le[H])&&I>F&&(I=F)}else{for(;++H<re;)if(null!=(F=E.call(le,le[H],H))&&F>=F){I=F;break}for(;++H<re;)null!=(F=E.call(le,le[H],H))&&I>F&&(I=F)}return I},g.max=function(le,E){var I,F,H=-1,re=le.length;if(1===arguments.length){for(;++H<re;)if(null!=(F=le[H])&&F>=F){I=F;break}for(;++H<re;)null!=(F=le[H])&&F>I&&(I=F)}else{for(;++H<re;)if(null!=(F=E.call(le,le[H],H))&&F>=F){I=F;break}for(;++H<re;)null!=(F=E.call(le,le[H],H))&&F>I&&(I=F)}return I},g.extent=function(le,E){var I,F,H,re=-1,ue=le.length;if(1===arguments.length){for(;++re<ue;)if(null!=(F=le[re])&&F>=F){I=H=F;break}for(;++re<ue;)null!=(F=le[re])&&(I>F&&(I=F),H<F&&(H=F))}else{for(;++re<ue;)if(null!=(F=E.call(le,le[re],re))&&F>=F){I=H=F;break}for(;++re<ue;)null!=(F=E.call(le,le[re],re))&&(I>F&&(I=F),H<F&&(H=F))}return[I,H]},g.sum=function(le,E){var I,F=0,H=le.length,re=-1;if(1===arguments.length)for(;++re<H;)l(I=+le[re])&&(F+=I);else for(;++re<H;)l(I=+E.call(le,le[re],re))&&(F+=I);return F},g.mean=function(le,E){var I,F=0,H=le.length,re=-1,ue=H;if(1===arguments.length)for(;++re<H;)l(I=f(le[re]))?F+=I:--ue;else for(;++re<H;)l(I=f(E.call(le,le[re],re)))?F+=I:--ue;if(ue)return F/ue},g.quantile=function(le,E){var I=(le.length-1)*E+1,F=Math.floor(I),H=+le[F-1],re=I-F;return re?H+re*(le[F]-H):H},g.median=function(le,E){var I,F=[],H=le.length,re=-1;if(1===arguments.length)for(;++re<H;)l(I=f(le[re]))&&F.push(I);else for(;++re<H;)l(I=f(E.call(le,le[re],re)))&&F.push(I);if(F.length)return g.quantile(F.sort(s),.5)},g.variance=function(le,E){var I,F,H=le.length,re=0,ue=0,ye=-1,ke=0;if(1===arguments.length)for(;++ye<H;)l(I=f(le[ye]))&&(ue+=(F=I-re)*(I-(re+=F/++ke)));else for(;++ye<H;)l(I=f(E.call(le,le[ye],ye)))&&(ue+=(F=I-re)*(I-(re+=F/++ke)));if(ke>1)return ue/(ke-1)},g.deviation=function(){var le=g.variance.apply(this,arguments);return le&&Math.sqrt(le)};var d=o(s);function u(le){return le.length}g.bisectLeft=d.left,g.bisect=g.bisectRight=d.right,g.bisector=function(le){return o(1===le.length?function(E,I){return s(le(E),I)}:le)},g.shuffle=function(le,E,I){(re=arguments.length)<3&&(I=le.length,re<2&&(E=0));for(var F,H,re=I-E;re;)H=Math.random()*re--|0,F=le[re+E],le[re+E]=le[H+E],le[H+E]=F;return le},g.permute=function(le,E){for(var I=E.length,F=new Array(I);I--;)F[I]=le[E[I]];return F},g.pairs=function(le){for(var E=0,I=le.length-1,F=le[0],H=new Array(I<0?0:I);E<I;)H[E]=[F,F=le[++E]];return H},g.transpose=function(le){if(!(H=le.length))return[];for(var E=-1,I=g.min(le,u),F=new Array(I);++E<I;)for(var H,re=-1,ue=F[E]=new Array(H);++re<H;)ue[re]=le[re][E];return F},g.zip=function(){return g.transpose(arguments)},g.keys=function(le){var E=[];for(var I in le)E.push(I);return E},g.values=function(le){var E=[];for(var I in le)E.push(le[I]);return E},g.entries=function(le){var E=[];for(var I in le)E.push({key:I,value:le[I]});return E},g.merge=function(le){for(var E,I,F,H=le.length,re=-1,ue=0;++re<H;)ue+=le[re].length;for(I=new Array(ue);--H>=0;)for(E=(F=le[H]).length;--E>=0;)I[--ue]=F[E];return I};var a=Math.abs;function y(le){for(var E=1;le*E%1;)E*=10;return E}function h(le,E){for(var I in E)Object.defineProperty(le.prototype,I,{value:E[I],enumerable:!1})}function _(){this._=Object.create(null)}function b(le){return"__proto__"==(le+="")||"\0"===le[0]?"\0"+le:le}function w(le){return"\0"===(le+="")[0]?le.slice(1):le}function T(le){return b(le)in this._}function L(le){return(le=b(le))in this._&&delete this._[le]}function M(){var le=[];for(var E in this._)le.push(w(E));return le}function P(){var le=0;for(var E in this._)++le;return le}function z(){for(var le in this._)return!1;return!0}function S(){this._=Object.create(null)}function C(le){return le}function R(le,E,I){return function(){var F=I.apply(E,arguments);return F===E?le:F}}function D(le,E){if(E in le)return E;E=E.charAt(0).toUpperCase()+E.slice(1);for(var I=0,F=j.length;I<F;++I){var H=j[I]+E;if(H in le)return H}}g.range=function(le,E,I){if(arguments.length<3&&(I=1,arguments.length<2&&(E=le,le=0)),(E-le)/I==1/0)throw new Error("infinite range");var F,H=[],re=y(a(I)),ue=-1;if(le*=re,E*=re,(I*=re)<0)for(;(F=le+I*++ue)>E;)H.push(F/re);else for(;(F=le+I*++ue)<E;)H.push(F/re);return H},g.map=function(le,E){var I=new _;if(le instanceof _)le.forEach(function(ye,ke){I.set(ye,ke)});else if(Array.isArray(le)){var F,H=-1,re=le.length;if(1===arguments.length)for(;++H<re;)I.set(H,le[H]);else for(;++H<re;)I.set(E.call(le,F=le[H],H),F)}else for(var ue in le)I.set(ue,le[ue]);return I},h(_,{has:T,get:function(le){return this._[b(le)]},set:function(le,E){return this._[b(le)]=E},remove:L,keys:M,values:function(){var le=[];for(var E in this._)le.push(this._[E]);return le},entries:function(){var le=[];for(var E in this._)le.push({key:w(E),value:this._[E]});return le},size:P,empty:z,forEach:function(le){for(var E in this._)le.call(this,w(E),this._[E])}}),g.nest=function(){var le,E,I={},F=[],H=[];function re(ue,ye,ke){if(ke>=F.length)return E?E.call(I,ye):le?ye.sort(le):ye;for(var Ee,Ue,$e,it,_t=-1,Ct=ye.length,At=F[ke++],Et=new _;++_t<Ct;)(it=Et.get(Ee=At(Ue=ye[_t])))?it.push(Ue):Et.set(Ee,[Ue]);return ue?(Ue=ue(),$e=function(Tt,jt){Ue.set(Tt,re(ue,jt,ke))}):(Ue={},$e=function(Tt,jt){Ue[Tt]=re(ue,jt,ke)}),Et.forEach($e),Ue}return I.map=function(ue,ye){return re(ye,ue,0)},I.entries=function(ue){return function ye(ke,Ee){if(Ee>=F.length)return ke;var Ue=[],$e=H[Ee++];return ke.forEach(function(it,_t){Ue.push({key:it,values:ye(_t,Ee)})}),$e?Ue.sort(function(it,_t){return $e(it.key,_t.key)}):Ue}(re(g.map,ue,0),0)},I.key=function(ue){return F.push(ue),I},I.sortKeys=function(ue){return H[F.length-1]=ue,I},I.sortValues=function(ue){return le=ue,I},I.rollup=function(ue){return E=ue,I},I},g.set=function(le){var E=new S;if(le)for(var I=0,F=le.length;I<F;++I)E.add(le[I]);return E},h(S,{has:T,add:function(le){return this._[b(le+="")]=!0,le},remove:L,values:M,size:P,empty:z,forEach:function(le){for(var E in this._)le.call(this,w(E))}}),g.behavior={},g.rebind=function(le,E){for(var I,F=1,H=arguments.length;++F<H;)le[I=arguments[F]]=R(le,E,E[I]);return le};var j=["webkit","ms","moz","Moz","o","O"];function q(){}function Z(){}function W(le){var E=[],I=new _;function F(){for(var H,re=E,ue=-1,ye=re.length;++ue<ye;)(H=re[ue].on)&&H.apply(this,arguments);return le}return F.on=function(H,re){var ue,ye=I.get(H);return arguments.length<2?ye&&ye.on:(ye&&(ye.on=null,E=E.slice(0,ue=E.indexOf(ye)).concat(E.slice(ue+1)),I.remove(H)),re&&E.push(I.set(H,{on:re})),le)},F}function G(){g.event.preventDefault()}function X(){for(var le,E=g.event;le=E.sourceEvent;)E=le;return E}function ne(le){for(var E=new Z,I=0,F=arguments.length;++I<F;)E[arguments[I]]=W(E);return E.of=function(H,re){return function(ue){try{var ye=ue.sourceEvent=g.event;ue.target=le,g.event=ue,E[ue.type].apply(H,re)}finally{g.event=ye}}},E}g.dispatch=function(){for(var le=new Z,E=-1,I=arguments.length;++E<I;)le[arguments[E]]=W(le);return le},Z.prototype.on=function(le,E){var I=le.indexOf("."),F="";if(I>=0&&(F=le.slice(I+1),le=le.slice(0,I)),le)return arguments.length<2?this[le].on(F):this[le].on(F,E);if(2===arguments.length){if(null==E)for(le in this)this.hasOwnProperty(le)&&this[le].on(F,null);return this}},g.event=null,g.requote=function(le){return le.replace(V,"\\$&")};var V=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,N={}.__proto__?function(le,E){le.__proto__=E}:function(le,E){for(var I in E)le[I]=E[I]};function U(le){return N(le,J),le}var ee=function(le,E){return E.querySelector(le)},B=function(le,E){return E.querySelectorAll(le)},K=function(le,E){var I=le.matches||le[D(le,"matchesSelector")];return(K=function(F,H){return I.call(F,H)})(le,E)};"function"==typeof Sizzle&&(ee=function(le,E){return Sizzle(le,E)[0]||null},B=Sizzle,K=Sizzle.matchesSelector),g.selection=function(){return g.select(x.documentElement)};var J=g.selection.prototype=[];function te(le){return"function"==typeof le?le:function(){return ee(le,this)}}function ae(le){return"function"==typeof le?le:function(){return B(le,this)}}J.select=function(le){var E,I,F,H,re=[];le=te(le);for(var ue=-1,ye=this.length;++ue<ye;){re.push(E=[]),E.parentNode=(F=this[ue]).parentNode;for(var ke=-1,Ee=F.length;++ke<Ee;)(H=F[ke])?(E.push(I=le.call(H,H.__data__,ke,ue)),I&&"__data__"in H&&(I.__data__=H.__data__)):E.push(null)}return U(re)},J.selectAll=function(le){var E,I,F=[];le=ae(le);for(var H=-1,re=this.length;++H<re;)for(var ue=this[H],ye=-1,ke=ue.length;++ye<ke;)(I=ue[ye])&&(F.push(E=k(le.call(I,I.__data__,ye,H))),E.parentNode=I);return U(F)};var ce="http://www.w3.org/1999/xhtml",oe={svg:"http://www.w3.org/2000/svg",xhtml:ce,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ve(le,E){return le=g.ns.qualify(le),null==E?le.local?function(){this.removeAttributeNS(le.space,le.local)}:function(){this.removeAttribute(le)}:"function"==typeof E?le.local?function(){var I=E.apply(this,arguments);null==I?this.removeAttributeNS(le.space,le.local):this.setAttributeNS(le.space,le.local,I)}:function(){var I=E.apply(this,arguments);null==I?this.removeAttribute(le):this.setAttribute(le,I)}:le.local?function(){this.setAttributeNS(le.space,le.local,E)}:function(){this.setAttribute(le,E)}}function fe(le){return le.trim().replace(/\s+/g," ")}function xe(le){return new RegExp("(?:^|\\s+)"+g.requote(le)+"(?:\\s+|$)","g")}function Se(le){return(le+"").trim().split(/^|\s+/)}function pe(le,E){var I=(le=Se(le).map(ge)).length;return"function"==typeof E?function(){for(var F=-1,H=E.apply(this,arguments);++F<I;)le[F](this,H)}:function(){for(var F=-1;++F<I;)le[F](this,E)}}function ge(le){var E=xe(le);return function(I,F){if(H=I.classList)return F?H.add(le):H.remove(le);var H=I.getAttribute("class")||"";F?(E.lastIndex=0,E.test(H)||I.setAttribute("class",fe(H+" "+le))):I.setAttribute("class",fe(H.replace(E," ")))}}function Te(le,E,I){return null==E?function(){this.style.removeProperty(le)}:"function"==typeof E?function(){var F=E.apply(this,arguments);null==F?this.style.removeProperty(le):this.style.setProperty(le,F,I)}:function(){this.style.setProperty(le,E,I)}}function se(le,E){return null==E?function(){delete this[le]}:"function"==typeof E?function(){var I=E.apply(this,arguments);null==I?delete this[le]:this[le]=I}:function(){this[le]=E}}function de(le){return"function"==typeof le?le:(le=g.ns.qualify(le)).local?function(){return this.ownerDocument.createElementNS(le.space,le.local)}:function(){var E=this.ownerDocument,I=this.namespaceURI;return I===ce&&E.documentElement.namespaceURI===ce?E.createElement(le):E.createElementNS(I,le)}}function Ae(){var le=this.parentNode;le&&le.removeChild(this)}function Le(le){return{__data__:le}}function Me(le){return function(){return K(this,le)}}function De(le){return arguments.length||(le=s),function(E,I){return E&&I?le(E.__data__,I.__data__):!E-!I}}function Oe(le,E){for(var I=0,F=le.length;I<F;I++)for(var H,re=le[I],ue=0,ye=re.length;ue<ye;ue++)(H=re[ue])&&E(H,ue,I);return le}function Ie(le){return N(le,Qe),le}g.ns={prefix:oe,qualify:function(le){var E=le.indexOf(":"),I=le;return E>=0&&"xmlns"!==(I=le.slice(0,E))&&(le=le.slice(E+1)),oe.hasOwnProperty(I)?{space:oe[I],local:le}:le}},J.attr=function(le,E){if(arguments.length<2){if("string"==typeof le){var I=this.node();return(le=g.ns.qualify(le)).local?I.getAttributeNS(le.space,le.local):I.getAttribute(le)}for(E in le)this.each(ve(E,le[E]));return this}return this.each(ve(le,E))},J.classed=function(le,E){if(arguments.length<2){if("string"==typeof le){var I=this.node(),F=(le=Se(le)).length,H=-1;if(E=I.classList){for(;++H<F;)if(!E.contains(le[H]))return!1}else for(E=I.getAttribute("class");++H<F;)if(!xe(le[H]).test(E))return!1;return!0}for(E in le)this.each(pe(E,le[E]));return this}return this.each(pe(le,E))},J.style=function(le,E,I){var F=arguments.length;if(F<3){if("string"!=typeof le){for(I in F<2&&(E=""),le)this.each(Te(I,le[I],E));return this}if(F<2){var H=this.node();return r(H).getComputedStyle(H,null).getPropertyValue(le)}I=""}return this.each(Te(le,E,I))},J.property=function(le,E){if(arguments.length<2){if("string"==typeof le)return this.node()[le];for(E in le)this.each(se(E,le[E]));return this}return this.each(se(le,E))},J.text=function(le){return arguments.length?this.each("function"==typeof le?function(){var E=le.apply(this,arguments);this.textContent=null==E?"":E}:null==le?function(){this.textContent=""}:function(){this.textContent=le}):this.node().textContent},J.html=function(le){return arguments.length?this.each("function"==typeof le?function(){var E=le.apply(this,arguments);this.innerHTML=null==E?"":E}:null==le?function(){this.innerHTML=""}:function(){this.innerHTML=le}):this.node().innerHTML},J.append=function(le){return le=de(le),this.select(function(){return this.appendChild(le.apply(this,arguments))})},J.insert=function(le,E){return le=de(le),E=te(E),this.select(function(){return this.insertBefore(le.apply(this,arguments),E.apply(this,arguments)||null)})},J.remove=function(){return this.each(Ae)},J.data=function(le,E){var I,F,H=-1,re=this.length;if(!arguments.length){for(le=new Array(re=(I=this[0]).length);++H<re;)(F=I[H])&&(le[H]=F.__data__);return le}function ue(Ue,$e){var it,_t,Ct,At=Ue.length,Et=$e.length,Tt=Math.min(At,Et),jt=new Array(Et),Nt=new Array(Et),Yt=new Array(At);if(E){var ln,bn=new _,In=new Array(At);for(it=-1;++it<At;)(_t=Ue[it])&&(bn.has(ln=E.call(_t,_t.__data__,it))?Yt[it]=_t:bn.set(ln,_t),In[it]=ln);for(it=-1;++it<Et;)(_t=bn.get(ln=E.call($e,Ct=$e[it],it)))?!0!==_t&&(jt[it]=_t,_t.__data__=Ct):Nt[it]=Le(Ct),bn.set(ln,!0);for(it=-1;++it<At;)it in In&&!0!==bn.get(In[it])&&(Yt[it]=Ue[it])}else{for(it=-1;++it<Tt;)Ct=$e[it],(_t=Ue[it])?(_t.__data__=Ct,jt[it]=_t):Nt[it]=Le(Ct);for(;it<Et;++it)Nt[it]=Le($e[it]);for(;it<At;++it)Yt[it]=Ue[it]}Nt.update=jt,Nt.parentNode=jt.parentNode=Yt.parentNode=Ue.parentNode,ye.push(Nt),ke.push(jt),Ee.push(Yt)}var ye=Ie([]),ke=U([]),Ee=U([]);if("function"==typeof le)for(;++H<re;)ue(I=this[H],le.call(I,I.parentNode.__data__,H));else for(;++H<re;)ue(I=this[H],le);return ke.enter=function(){return ye},ke.exit=function(){return Ee},ke},J.datum=function(le){return arguments.length?this.property("__data__",le):this.property("__data__")},J.filter=function(le){var E,I,F,H=[];"function"!=typeof le&&(le=Me(le));for(var re=0,ue=this.length;re<ue;re++){H.push(E=[]),E.parentNode=(I=this[re]).parentNode;for(var ye=0,ke=I.length;ye<ke;ye++)(F=I[ye])&&le.call(F,F.__data__,ye,re)&&E.push(F)}return U(H)},J.order=function(){for(var le=-1,E=this.length;++le<E;)for(var I,F=this[le],H=F.length-1,re=F[H];--H>=0;)(I=F[H])&&(re&&re!==I.nextSibling&&re.parentNode.insertBefore(I,re),re=I);return this},J.sort=function(le){le=De.apply(this,arguments);for(var E=-1,I=this.length;++E<I;)this[E].sort(le);return this.order()},J.each=function(le){return Oe(this,function(E,I,F){le.call(E,E.__data__,I,F)})},J.call=function(le){var E=k(arguments);return le.apply(E[0]=this,E),this},J.empty=function(){return!this.node()},J.node=function(){for(var le=0,E=this.length;le<E;le++)for(var I=this[le],F=0,H=I.length;F<H;F++){var re=I[F];if(re)return re}return null},J.size=function(){var le=0;return Oe(this,function(){++le}),le};var Qe=[];function Ne(le){var E,I;return function(F,H,re){var ue,ye=le[re].update,ke=ye.length;for(re!=I&&(I=re,E=0),H>=E&&(E=H+1);!(ue=ye[E])&&++E<ke;);return ue}}function Pe(le,E,I){var F="__on"+le,H=le.indexOf("."),re=Ge;H>0&&(le=le.slice(0,H));var ue=Re.get(le);function ye(){var ke=this[F];ke&&(this.removeEventListener(le,ke,ke.$),delete this[F])}return ue&&(le=ue,re=tt),H?E?function(){var ke=re(E,k(arguments));ye.call(this),this.addEventListener(le,this[F]=ke,ke.$=I),ke._=E}:ye:E?q:function(){var ke,Ee=new RegExp("^__on([^.]+)"+g.requote(le)+"$");for(var Ue in this)if(ke=Ue.match(Ee)){var $e=this[Ue];this.removeEventListener(ke[1],$e,$e.$),delete this[Ue]}}}g.selection.enter=Ie,g.selection.enter.prototype=Qe,Qe.append=J.append,Qe.empty=J.empty,Qe.node=J.node,Qe.call=J.call,Qe.size=J.size,Qe.select=function(le){for(var E,I,F,H,re,ue=[],ye=-1,ke=this.length;++ye<ke;){F=(H=this[ye]).update,ue.push(E=[]),E.parentNode=H.parentNode;for(var Ee=-1,Ue=H.length;++Ee<Ue;)(re=H[Ee])?(E.push(F[Ee]=I=le.call(H.parentNode,re.__data__,Ee,ye)),I.__data__=re.__data__):E.push(null)}return U(ue)},Qe.insert=function(le,E){return arguments.length<2&&(E=Ne(this)),J.insert.call(this,le,E)},g.select=function(le){var E;return"string"==typeof le?(E=[ee(le,x)]).parentNode=x.documentElement:(E=[le]).parentNode=e(le),U([E])},g.selectAll=function(le){var E;return"string"==typeof le?(E=k(B(le,x))).parentNode=x.documentElement:(E=k(le)).parentNode=null,U([E])},J.on=function(le,E,I){var F=arguments.length;if(F<3){if("string"!=typeof le){for(I in F<2&&(E=!1),le)this.each(Pe(I,le[I],E));return this}if(F<2)return(F=this.node()["__on"+le])&&F._;I=!1}return this.each(Pe(le,E,I))};var Re=g.map({mouseenter:"mouseover",mouseleave:"mouseout"});function Ge(le,E){return function(I){var F=g.event;g.event=I,E[0]=this.__data__;try{le.apply(this,E)}finally{g.event=F}}}function tt(le,E){var I=Ge(le,E);return function(F){var H=F.relatedTarget;H&&(H===this||8&H.compareDocumentPosition(this))||I.call(this,F)}}x&&Re.forEach(function(le){"on"+le in x&&Re.remove(le)});var ct,wt=0;function kt(le){var E=".dragsuppress-"+ ++wt,I="click"+E,F=g.select(r(le)).on("touchmove"+E,G).on("dragstart"+E,G).on("selectstart"+E,G);if(null==ct&&(ct=!("onselectstart"in le)&&D(le.style,"userSelect")),ct){var H=e(le).style,re=H[ct];H[ct]="none"}return function(ue){if(F.on(E,null),ct&&(H[ct]=re),ue){var ye=function(){F.on(I,null)};F.on(I,function(){G(),ye()},!0),setTimeout(ye,0)}}}g.mouse=function(le){return at(le,X())};var gt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function at(le,E){E.changedTouches&&(E=E.changedTouches[0]);var I=le.ownerSVGElement||le;if(I.createSVGPoint){var F=I.createSVGPoint();if(gt<0){var H=r(le);if(H.scrollX||H.scrollY){var re=(I=g.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();gt=!(re.f||re.e),I.remove()}}return gt?(F.x=E.pageX,F.y=E.pageY):(F.x=E.clientX,F.y=E.clientY),[(F=F.matrixTransform(le.getScreenCTM().inverse())).x,F.y]}var ue=le.getBoundingClientRect();return[E.clientX-ue.left-le.clientLeft,E.clientY-ue.top-le.clientTop]}function et(){return g.event.changedTouches[0].identifier}g.touch=function(le,E,I){if(arguments.length<3&&(I=E,E=X().changedTouches),E)for(var F,H=0,re=E.length;H<re;++H)if((F=E[H]).identifier===I)return at(le,F)},g.behavior.drag=function(){var le=ne(H,"drag","dragstart","dragend"),E=null,I=re(q,g.mouse,r,"mousemove","mouseup"),F=re(et,g.touch,C,"touchmove","touchend");function H(){this.on("mousedown.drag",I).on("touchstart.drag",F)}function re(ue,ye,ke,Ee,Ue){return function(){var $e,it=this,_t=g.event.target.correspondingElement||g.event.target,Ct=it.parentNode,At=le.of(it,arguments),Et=0,Tt=ue(),jt=".drag"+(null==Tt?"":"-"+Tt),Nt=g.select(ke(_t)).on(Ee+jt,bn).on(Ue+jt,In),Yt=kt(_t),ln=ye(Ct,Tt);function bn(){var En,ir,rr=ye(Ct,Tt);rr&&(Et|=(En=rr[0]-ln[0])|(ir=rr[1]-ln[1]),ln=rr,At({type:"drag",x:rr[0]+$e[0],y:rr[1]+$e[1],dx:En,dy:ir}))}function In(){ye(Ct,Tt)&&(Nt.on(Ee+jt,null).on(Ue+jt,null),Yt(Et),At({type:"dragend"}))}$e=E?[($e=E.apply(it,arguments)).x-ln[0],$e.y-ln[1]]:[0,0],At({type:"dragstart"})}}return H.origin=function(ue){return arguments.length?(E=ue,H):E},g.rebind(H,le,"on")},g.touches=function(le,E){return arguments.length<2&&(E=X().touches),E?k(E).map(function(I){var F=at(le,I);return F.identifier=I.identifier,F}):[]};var yt=1e-6,Vt=Math.PI,Gt=2*Vt,en=Gt-yt,Jt=Vt/2,cn=Vt/180,Rt=180/Vt;function je(le){return le>1?Jt:le<-1?-Jt:Math.asin(le)}function Ye(le){return((le=Math.exp(le))+1/le)/2}var he=Math.SQRT2;g.interpolateZoom=function(le,E){var I,F,H=le[0],re=le[1],ue=le[2],Ee=E[2],Ue=E[0]-H,$e=E[1]-re,it=Ue*Ue+$e*$e;if(it<1e-12)F=Math.log(Ee/ue)/he,I=function(jt){return[H+jt*Ue,re+jt*$e,ue*Math.exp(he*jt*F)]};else{var _t=Math.sqrt(it),Ct=(Ee*Ee-ue*ue+4*it)/(2*ue*2*_t),At=(Ee*Ee-ue*ue-4*it)/(2*Ee*2*_t),Et=Math.log(Math.sqrt(Ct*Ct+1)-Ct),Tt=Math.log(Math.sqrt(At*At+1)-At);F=(Tt-Et)/he,I=function(jt){var Nt,In,Yt=jt*F,ln=Ye(Et),bn=ue/(2*_t)*(ln*(Nt=he*Yt+Et,((Nt=Math.exp(2*Nt))-1)/(Nt+1))-(In=Et,((In=Math.exp(In))-1/In)/2));return[H+bn*Ue,re+bn*$e,ue*ln/Ye(he*Yt+Et)]}}return I.duration=1e3*F,I},g.behavior.zoom=function(){var le,E,I,F,H,re,ue,ye,ke,Ee={x:0,y:0,k:1},Ue=[960,500],$e=He,it=250,_t=0,Ct="mousedown.zoom",At="mousemove.zoom",Et="mouseup.zoom",Tt="touchstart.zoom",jt=ne(Nt,"zoomstart","zoom","zoomend");function Nt(Wn){Wn.on(Ct,pr).on(Fe+".zoom",li).on("dblclick.zoom",xi).on(Tt,Qr)}function Yt(Wn){return[(Wn[0]-Ee.x)/Ee.k,(Wn[1]-Ee.y)/Ee.k]}function ln(Wn){Ee.k=Math.max($e[0],Math.min($e[1],Wn))}function bn(Wn,Rr){var oi;Ee.x+=Wn[0]-(Rr=[(oi=Rr)[0]*Ee.k+Ee.x,oi[1]*Ee.k+Ee.y])[0],Ee.y+=Wn[1]-Rr[1]}function In(Wn,Rr,oi,ti){Wn.__chart__={x:Ee.x,y:Ee.y,k:Ee.k},ln(Math.pow(2,ti)),bn(E=Rr,oi),Wn=g.select(Wn),it>0&&(Wn=Wn.transition().duration(it)),Wn.call(Nt.event)}function En(){ue&&ue.domain(re.range().map(function(Wn){return(Wn-Ee.x)/Ee.k}).map(re.invert)),ke&&ke.domain(ye.range().map(function(Wn){return(Wn-Ee.y)/Ee.k}).map(ye.invert))}function ir(Wn){_t++||Wn({type:"zoomstart"})}function rr(Wn){En(),Wn({type:"zoom",scale:Ee.k,translate:[Ee.x,Ee.y]})}function _r(Wn){--_t||(Wn({type:"zoomend"}),E=null)}function pr(){var Wn=this,Rr=jt.of(Wn,arguments),oi=0,ti=g.select(r(Wn)).on(At,ji).on(Et,ui),vi=Yt(g.mouse(Wn)),ki=kt(Wn);function ji(){oi=1,bn(g.mouse(Wn),vi),rr(Rr)}function ui(){ti.on(At,null).on(Et,null),ki(oi),_r(Rr)}Cs.call(Wn),ir(Rr)}function Qr(){var Wn,Rr=this,oi=jt.of(Rr,arguments),ti={},vi=0,ki=".zoom-"+g.event.changedTouches[0].identifier,ji="touchmove"+ki,ui="touchend"+ki,Oi=[],zi=g.select(Rr),qi=kt(Rr);function Ii(){var Ka=g.touches(Rr);return Wn=Ee.k,Ka.forEach(function($a){$a.identifier in ti&&(ti[$a.identifier]=Yt($a))}),Ka}function Hi(){var Ka=g.event.target;g.select(Ka).on(ji,na).on(ui,Ca),Oi.push(Ka);for(var $a=g.event.changedTouches,Aa=0,Va=$a.length;Aa<Va;++Aa)ti[$a[Aa].identifier]=null;var Oa=Ii(),Io=Date.now();if(1===Oa.length){if(Io-H<500){var po=Oa[0];In(Rr,po,ti[po.identifier],Math.floor(Math.log(Ee.k)/Math.LN2)+1),G()}H=Io}else if(Oa.length>1){var Qo=Oa[1],Os=(po=Oa[0])[0]-Qo[0],Us=po[1]-Qo[1];vi=Os*Os+Us*Us}}function na(){var Ka,$a,Aa,Va,Oa=g.touches(Rr);Cs.call(Rr);for(var Io=0,po=Oa.length;Io<po;++Io,Va=null)if(Va=ti[(Aa=Oa[Io]).identifier]){if($a)break;Ka=Aa,$a=Va}if(Va){var Qo=(Qo=Aa[0]-Ka[0])*Qo+(Qo=Aa[1]-Ka[1])*Qo,Os=vi&&Math.sqrt(Qo/vi);Ka=[(Ka[0]+Aa[0])/2,(Ka[1]+Aa[1])/2],$a=[($a[0]+Va[0])/2,($a[1]+Va[1])/2],ln(Os*Wn)}H=null,bn(Ka,$a),rr(oi)}function Ca(){if(g.event.touches.length){for(var Ka=g.event.changedTouches,$a=0,Aa=Ka.length;$a<Aa;++$a)delete ti[Ka[$a].identifier];for(var Va in ti)return void Ii()}g.selectAll(Oi).on(ki,null),zi.on(Ct,pr).on(Tt,Qr),qi(),_r(oi)}Hi(),ir(oi),zi.on(Ct,null).on(Tt,Hi)}function li(){var Wn=jt.of(this,arguments);F?clearTimeout(F):(Cs.call(this),le=Yt(E=I||g.mouse(this)),ir(Wn)),F=setTimeout(function(){F=null,_r(Wn)},50),G(),ln(Math.pow(2,.002*be())*Ee.k),bn(E,le),rr(Wn)}function xi(){var Wn=g.mouse(this),Rr=Math.log(Ee.k)/Math.LN2;In(this,Wn,Yt(Wn),g.event.shiftKey?Math.ceil(Rr)-1:Math.floor(Rr)+1)}return Fe||(Fe="onwheel"in x?(be=function(){return-g.event.deltaY*(g.event.deltaMode?120:1)},"wheel"):"onmousewheel"in x?(be=function(){return g.event.wheelDelta},"mousewheel"):(be=function(){return-g.event.detail},"MozMousePixelScroll")),Nt.event=function(Wn){Wn.each(function(){var Rr=jt.of(this,arguments),oi=Ee;gs?g.select(this).transition().each("start.zoom",function(){Ee=this.__chart__||{x:0,y:0,k:1},ir(Rr)}).tween("zoom:zoom",function(){var ti=Ue[0],ki=E?E[0]:ti/2,ji=E?E[1]:Ue[1]/2,ui=g.interpolateZoom([(ki-Ee.x)/Ee.k,(ji-Ee.y)/Ee.k,ti/Ee.k],[(ki-oi.x)/oi.k,(ji-oi.y)/oi.k,ti/oi.k]);return function(Oi){var zi=ui(Oi),qi=ti/zi[2];this.__chart__=Ee={x:ki-zi[0]*qi,y:ji-zi[1]*qi,k:qi},rr(Rr)}}).each("interrupt.zoom",function(){_r(Rr)}).each("end.zoom",function(){_r(Rr)}):(this.__chart__=Ee,ir(Rr),rr(Rr),_r(Rr))})},Nt.translate=function(Wn){return arguments.length?(Ee={x:+Wn[0],y:+Wn[1],k:Ee.k},En(),Nt):[Ee.x,Ee.y]},Nt.scale=function(Wn){return arguments.length?(Ee={x:Ee.x,y:Ee.y,k:null},ln(+Wn),En(),Nt):Ee.k},Nt.scaleExtent=function(Wn){return arguments.length?($e=null==Wn?He:[+Wn[0],+Wn[1]],Nt):$e},Nt.center=function(Wn){return arguments.length?(I=Wn&&[+Wn[0],+Wn[1]],Nt):I},Nt.size=function(Wn){return arguments.length?(Ue=Wn&&[+Wn[0],+Wn[1]],Nt):Ue},Nt.duration=function(Wn){return arguments.length?(it=+Wn,Nt):it},Nt.x=function(Wn){return arguments.length?(ue=Wn,re=Wn.copy(),Ee={x:0,y:0,k:1},Nt):ue},Nt.y=function(Wn){return arguments.length?(ke=Wn,ye=Wn.copy(),Ee={x:0,y:0,k:1},Nt):ke},g.rebind(Nt,jt,"on")};var be,Fe,He=[0,1/0];function Ke(){}function Ze(le,E,I){return this instanceof Ze?(this.h=+le,this.s=+E,void(this.l=+I)):arguments.length<2?le instanceof Ze?new Ze(le.h,le.s,le.l):zn(""+le,gn,Ze):new Ze(le,E,I)}g.color=Ke,Ke.prototype.toString=function(){return this.rgb()+""},g.hsl=Ze;var ut=Ze.prototype=new Ke;function lt(le,E,I){var F,H;function re(ue){return Math.round(255*((ye=ue)>360?ye-=360:ye<0&&(ye+=360),ye<60?F+(H-F)*ye/60:ye<180?H:ye<240?F+(H-F)*(240-ye)/60:F));var ye}return le=isNaN(le)?0:(le%=360)<0?le+360:le,E=isNaN(E)||E<0?0:E>1?1:E,F=2*(I=I<0?0:I>1?1:I)-(H=I<=.5?I*(1+E):I+E-I*E),new zt(re(le+120),re(le),re(le-120))}function Lt(le,E,I){return this instanceof Lt?(this.h=+le,this.c=+E,void(this.l=+I)):arguments.length<2?le instanceof Lt?new Lt(le.h,le.c,le.l):Ce(le instanceof pt?le.l:(le=nn((le=g.rgb(le)).r,le.g,le.b)).l,le.a,le.b):new Lt(le,E,I)}ut.brighter=function(le){return le=Math.pow(.7,arguments.length?le:1),new Ze(this.h,this.s,this.l/le)},ut.darker=function(le){return le=Math.pow(.7,arguments.length?le:1),new Ze(this.h,this.s,le*this.l)},ut.rgb=function(){return lt(this.h,this.s,this.l)},g.hcl=Lt;var Ot=Lt.prototype=new Ke;function ot(le,E,I){return isNaN(le)&&(le=0),isNaN(E)&&(E=0),new pt(I,Math.cos(le*=cn)*E,Math.sin(le)*E)}function pt(le,E,I){return this instanceof pt?(this.l=+le,this.a=+E,void(this.b=+I)):arguments.length<2?le instanceof pt?new pt(le.l,le.a,le.b):le instanceof Lt?ot(le.h,le.c,le.l):nn((le=zt(le)).r,le.g,le.b):new pt(le,E,I)}Ot.brighter=function(le){return new Lt(this.h,this.c,Math.min(100,this.l+qt*(arguments.length?le:1)))},Ot.darker=function(le){return new Lt(this.h,this.c,Math.max(0,this.l-qt*(arguments.length?le:1)))},Ot.rgb=function(){return ot(this.h,this.c,this.l).rgb()},g.lab=pt;var qt=18,St=pt.prototype=new Ke;function Mt(le,E,I){var F=(le+16)/116,H=F+E/500,re=F-I/200;return new zt(dt(3.2404542*(H=.95047*Xe(H))-1.5371385*(F=1*Xe(F))-.4985314*(re=1.08883*Xe(re))),dt(-.969266*H+1.8760108*F+.041556*re),dt(.0556434*H-.2040259*F+1.0572252*re))}function Ce(le,E,I){return le>0?new Lt(Math.atan2(I,E)*Rt,Math.sqrt(E*E+I*I),le):new Lt(NaN,NaN,le)}function Xe(le){return le>.206893034?le*le*le:(le-4/29)/7.787037}function st(le){return le>.008856?Math.pow(le,1/3):7.787037*le+4/29}function dt(le){return Math.round(255*(le<=.00304?12.92*le:1.055*Math.pow(le,1/2.4)-.055))}function zt(le,E,I){return this instanceof zt?(this.r=~~le,this.g=~~E,void(this.b=~~I)):arguments.length<2?le instanceof zt?new zt(le.r,le.g,le.b):zn(""+le,zt,lt):new zt(le,E,I)}function Ht(le){return new zt(le>>16,le>>8&255,255&le)}function Kt(le){return Ht(le)+""}St.brighter=function(le){return new pt(Math.min(100,this.l+qt*(arguments.length?le:1)),this.a,this.b)},St.darker=function(le){return new pt(Math.max(0,this.l-qt*(arguments.length?le:1)),this.a,this.b)},St.rgb=function(){return Mt(this.l,this.a,this.b)},g.rgb=zt;var Zt=zt.prototype=new Ke;function vn(le){return le<16?"0"+Math.max(0,le).toString(16):Math.min(255,le).toString(16)}function zn(le,E,I){var F,H,re,ue=0,ye=0,ke=0;if(F=/([a-z]+)\((.*)\)/.exec(le=le.toLowerCase()))switch(H=F[2].split(","),F[1]){case"hsl":return I(parseFloat(H[0]),parseFloat(H[1])/100,parseFloat(H[2])/100);case"rgb":return E(on(H[0]),on(H[1]),on(H[2]))}return(re=mn.get(le))?E(re.r,re.g,re.b):(null==le||"#"!==le.charAt(0)||isNaN(re=parseInt(le.slice(1),16))||(4===le.length?(ue=(3840&re)>>4,ue|=ue>>4,ye=240&re,ye|=ye>>4,ke=15&re,ke|=ke<<4):7===le.length&&(ue=(16711680&re)>>16,ye=(65280&re)>>8,ke=255&re)),E(ue,ye,ke))}function gn(le,E,I){var F,H,re=Math.min(le/=255,E/=255,I/=255),ue=Math.max(le,E,I),ye=ue-re,ke=(ue+re)/2;return ye?(H=ke<.5?ye/(ue+re):ye/(2-ue-re),F=le==ue?(E-I)/ye+(E<I?6:0):E==ue?(I-le)/ye+2:(le-E)/ye+4,F*=60):(F=NaN,H=ke>0&&ke<1?0:F),new Ze(F,H,ke)}function nn(le,E,I){var F=st((.4124564*(le=an(le))+.3575761*(E=an(E))+.1804375*(I=an(I)))/.95047),H=st((.2126729*le+.7151522*E+.072175*I)/1);return pt(116*H-16,500*(F-H),200*(H-st((.0193339*le+.119192*E+.9503041*I)/1.08883)))}function an(le){return(le/=255)<=.04045?le/12.92:Math.pow((le+.055)/1.055,2.4)}function on(le){var E=parseFloat(le);return"%"===le.charAt(le.length-1)?Math.round(2.55*E):E}Zt.brighter=function(le){le=Math.pow(.7,arguments.length?le:1);var E=this.r,I=this.g,F=this.b,H=30;return E||I||F?(E&&E<H&&(E=H),I&&I<H&&(I=H),F&&F<H&&(F=H),new zt(Math.min(255,E/le),Math.min(255,I/le),Math.min(255,F/le))):new zt(H,H,H)},Zt.darker=function(le){return new zt((le=Math.pow(.7,arguments.length?le:1))*this.r,le*this.g,le*this.b)},Zt.hsl=function(){return gn(this.r,this.g,this.b)},Zt.toString=function(){return"#"+vn(this.r)+vn(this.g)+vn(this.b)};var mn=g.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function _n(le){return"function"==typeof le?le:function(){return le}}function Pn(le){return function(E,I,F){return 2===arguments.length&&"function"==typeof I&&(F=I,I=null),Rn(E,I,le,F)}}function Rn(le,E,I,F){var Ue,H={},re=g.dispatch("beforesend","progress","load","error"),ue={},ye=new XMLHttpRequest,ke=null;function Ee(){var Ue,it,_t,$e=ye.status;if(!$e&&((_t=(it=ye).responseType)&&"text"!==_t?it.response:it.responseText)||$e>=200&&$e<300||304===$e){try{Ue=I.call(H,ye)}catch(it){return void re.error.call(H,it)}re.load.call(H,Ue)}else re.error.call(H,ye)}return self.XDomainRequest&&!("withCredentials"in ye)&&/^(http(s)?:)?\/\//.test(le)&&(ye=new XDomainRequest),"onload"in ye?ye.onload=ye.onerror=Ee:ye.onreadystatechange=function(){ye.readyState>3&&Ee()},ye.onprogress=function(Ue){var $e=g.event;g.event=Ue;try{re.progress.call(H,ye)}finally{g.event=$e}},H.header=function(Ue,$e){return Ue=(Ue+"").toLowerCase(),arguments.length<2?ue[Ue]:(null==$e?delete ue[Ue]:ue[Ue]=$e+"",H)},H.mimeType=function(Ue){return arguments.length?(E=null==Ue?null:Ue+"",H):E},H.responseType=function(Ue){return arguments.length?(ke=Ue,H):ke},H.response=function(Ue){return I=Ue,H},["get","post"].forEach(function(Ue){H[Ue]=function(){return H.send.apply(H,[Ue].concat(k(arguments)))}}),H.send=function(Ue,$e,it){if(2===arguments.length&&"function"==typeof $e&&(it=$e,$e=null),ye.open(Ue,le,!0),null==E||"accept"in ue||(ue.accept=E+",*/*"),ye.setRequestHeader)for(var _t in ue)ye.setRequestHeader(_t,ue[_t]);return null!=E&&ye.overrideMimeType&&ye.overrideMimeType(E),null!=ke&&(ye.responseType=ke),null!=it&&H.on("error",it).on("load",function(Ct){it(null,Ct)}),re.beforesend.call(H,ye),ye.send(null==$e?null:$e),H},H.abort=function(){return ye.abort(),H},g.rebind(H,re,"on"),null==F?H:H.get(1===(Ue=F).length?function($e,it){Ue(null==$e?it:null)}:Ue)}mn.forEach(function(le,E){mn.set(le,Ht(E))}),g.functor=_n,g.xhr=Pn(C),g.dsv=function(le,E){var I=new RegExp('["'+le+"\n]"),F=le.charCodeAt(0);function H(Ee,Ue,$e){arguments.length<3&&($e=Ue,Ue=null);var it=Rn(Ee,E,null==Ue?re:ue(Ue),$e);return it.row=function(_t){return arguments.length?it.response(null==(Ue=_t)?re:ue(_t)):Ue},it}function re(Ee){return H.parse(Ee.responseText)}function ue(Ee){return function(Ue){return H.parse(Ue.responseText,Ee)}}function ye(Ee){return Ee.map(ke).join(le)}function ke(Ee){return I.test(Ee)?'"'+Ee.replace(/\"/g,'""')+'"':Ee}return H.parse=function(Ee,Ue){var $e;return H.parseRows(Ee,function(it,_t){if($e)return $e(it,_t-1);var Ct=function(At){for(var Et={},Tt=it.length,jt=0;jt<Tt;++jt)Et[it[jt]]=At[jt];return Et};$e=Ue?function(At,Et){return Ue(Ct(At),Et)}:Ct})},H.parseRows=function(Ee,Ue){var $e,it,_t={},Ct={},At=[],Et=Ee.length,Tt=0,jt=0;function Nt(){if(Tt>=Et)return Ct;if(it)return it=!1,_t;var ln=Tt;if(34===Ee.charCodeAt(ln)){for(var bn=ln;bn++<Et;)if(34===Ee.charCodeAt(bn)){if(34!==Ee.charCodeAt(bn+1))break;++bn}return Tt=bn+2,13===(In=Ee.charCodeAt(bn+1))?(it=!0,10===Ee.charCodeAt(bn+2)&&++Tt):10===In&&(it=!0),Ee.slice(ln+1,bn).replace(/""/g,'"')}for(;Tt<Et;){var In,En=1;if(10===(In=Ee.charCodeAt(Tt++)))it=!0;else if(13===In)it=!0,10===Ee.charCodeAt(Tt)&&(++Tt,++En);else if(In!==F)continue;return Ee.slice(ln,Tt-En)}return Ee.slice(ln)}for(;($e=Nt())!==Ct;){for(var Yt=[];$e!==_t&&$e!==Ct;)Yt.push($e),$e=Nt();Ue&&null==(Yt=Ue(Yt,jt++))||At.push(Yt)}return At},H.format=function(Ee){if(Array.isArray(Ee[0]))return H.formatRows(Ee);var Ue=new S,$e=[];return Ee.forEach(function(it){for(var _t in it)Ue.has(_t)||$e.push(Ue.add(_t))}),[$e.map(ke).join(le)].concat(Ee.map(function(it){return $e.map(function(_t){return ke(it[_t])}).join(le)})).join("\n")},H.formatRows=function(Ee){return Ee.map(ye).join("\n")},H},g.csv=g.dsv(",","text/csv"),g.tsv=g.dsv("\t","text/tab-separated-values");var qn,Xn,br,fr,Vr=this[D(this,"requestAnimationFrame")]||function(le){setTimeout(le,17)};function cr(le,E,I){var F=arguments.length;F<2&&(E=0),F<3&&(I=Date.now());var re={c:le,t:I+E,n:null};return Xn?Xn.n=re:qn=re,Xn=re,br||(fr=clearTimeout(fr),br=1,Vr(Sr)),re}function Sr(){var le=Cr(),E=pi()-le;E>24?(isFinite(E)&&(clearTimeout(fr),fr=setTimeout(Sr,E)),br=0):(br=1,Vr(Sr))}function Cr(){for(var le=Date.now(),E=qn;E;)le>=E.t&&E.c(le-E.t)&&(E.c=null),E=E.n;return le}function pi(){for(var le,E=qn,I=1/0;E;)E.c?(E.t<I&&(I=E.t),E=(le=E).n):E=le?le.n=E.n:qn=E.n;return Xn=le,I}function Yn(le){return le[0]}function ar(le){return le[1]}function Ar(le){for(var E,I,F,H=le.length,re=[0,1],ue=2,ye=2;ye<H;ye++){for(;ue>1&&((I=le[re[ue-1]])[0]-(E=le[re[ue-2]])[0])*((F=le[ye])[1]-E[1])-(I[1]-E[1])*(F[0]-E[0])<=0;)--ue;re[ue++]=ye}return re.slice(0,ue)}function sr(le,E){return le[0]-E[0]||le[1]-E[1]}g.timer=function(){cr.apply(this,arguments)},g.timer.flush=function(){Cr(),pi()},g.round=function(le,E){return E?Math.round(le*(E=Math.pow(10,E)))/E:Math.round(le)},g.geom={},g.geom.hull=function(le){var E=Yn,I=ar;if(arguments.length)return F(le);function F(H){if(H.length<3)return[];var re,ue=_n(E),ye=_n(I),ke=H.length,Ee=[],Ue=[];for(re=0;re<ke;re++)Ee.push([+ue.call(this,H[re],re),+ye.call(this,H[re],re),re]);for(Ee.sort(sr),re=0;re<ke;re++)Ue.push([Ee[re][0],-Ee[re][1]]);var $e=Ar(Ee),it=Ar(Ue),_t=it[0]===$e[0],Ct=it[it.length-1]===$e[$e.length-1],At=[];for(re=$e.length-1;re>=0;--re)At.push(H[Ee[$e[re]][2]]);for(re=+_t;re<it.length-Ct;++re)At.push(H[Ee[it[re]][2]]);return At}return F.x=function(H){return arguments.length?(E=H,F):E},F.y=function(H){return arguments.length?(I=H,F):I},F},g.geom.polygon=function(le){return N(le,dr),le};var dr=g.geom.polygon.prototype=[];function $r(le,E,I){return(I[0]-E[0])*(le[1]-E[1])<(I[1]-E[1])*(le[0]-E[0])}function Lr(le,E,I,F){var H=le[0],re=I[0],ue=E[0]-H,ye=F[0]-re,ke=le[1],Ee=I[1],Ue=E[1]-ke,$e=F[1]-Ee,it=(ye*(ke-Ee)-$e*(H-re))/($e*ue-ye*Ue);return[H+it*ue,ke+it*Ue]}function jr(le){var E=le[0],I=le[le.length-1];return!(E[0]-I[0]||E[1]-I[1])}dr.area=function(){for(var le,E=-1,I=this.length,F=this[I-1],H=0;++E<I;)H+=(le=F)[1]*(F=this[E])[0]-le[0]*F[1];return.5*H},dr.centroid=function(le){var E,I,F=-1,H=this.length,re=0,ue=0,ye=this[H-1];for(arguments.length||(le=-1/(6*this.area()));++F<H;)re+=((E=ye)[0]+(ye=this[F])[0])*(I=E[0]*ye[1]-ye[0]*E[1]),ue+=(E[1]+ye[1])*I;return[re*le,ue*le]},dr.clip=function(le){for(var E,I,F,H,re,ue,ye=jr(le),ke=-1,Ee=this.length-jr(this),Ue=this[Ee-1];++ke<Ee;){for(E=le.slice(),le.length=0,H=this[ke],re=E[(F=E.length-ye)-1],I=-1;++I<F;)$r(ue=E[I],Ue,H)?($r(re,Ue,H)||le.push(Lr(re,ue,Ue,H)),le.push(ue)):$r(re,Ue,H)&&le.push(Lr(re,ue,Ue,H)),re=ue;ye&&le.push(le[0]),Ue=H}return le};var ri,sn,wn,It,hn,yn=[],Hn=[];function Un(){Fr(this),this.edge=this.site=this.circle=null}function jn(le){var E=yn.pop()||new Un;return E.site=le,E}function On(le){Mr(le),wn.remove(le),yn.push(le),Fr(le)}function kn(le){var E=le.circle,I=E.x,F=E.cy,H={x:I,y:F},re=le.P,ue=le.N,ye=[le];On(le);for(var ke=re;ke.circle&&a(I-ke.circle.x)<yt&&a(F-ke.circle.cy)<yt;)re=ke.P,ye.unshift(ke),On(ke),ke=re;ye.unshift(ke),Mr(ke);for(var Ee=ue;Ee.circle&&a(I-Ee.circle.x)<yt&&a(F-Ee.circle.cy)<yt;)ue=Ee.N,ye.push(Ee),On(Ee),Ee=ue;ye.push(Ee),Mr(Ee);var Ue,$e=ye.length;for(Ue=1;Ue<$e;++Ue)si((Ee=ye[Ue]).edge,(ke=ye[Ue-1]).site,Ee.site,H);(Ee=ye[$e-1]).edge=Ur((ke=ye[0]).site,Ee.site,null,H),hr(ke),hr(Ee)}function Mn(le){for(var E,I,F,H,re=le.x,ue=le.y,ye=wn._;ye;)if((F=Ln(ye,ue)-re)>yt)ye=ye.L;else{if(!((H=re-Dn(ye,ue))>yt)){F>-yt?(E=ye.P,I=ye):H>-yt?(E=ye,I=ye.N):E=I=ye;break}if(!ye.R){E=ye;break}ye=ye.R}var ke=jn(le);if(wn.insert(E,ke),E||I){if(E===I)return Mr(E),I=jn(E.site),wn.insert(ke,I),ke.edge=I.edge=Ur(E.site,ke.site),hr(E),void hr(I);if(I){Mr(E),Mr(I);var Ee=E.site,Ue=Ee.x,$e=Ee.y,it=le.x-Ue,_t=le.y-$e,Ct=I.site,At=Ct.x-Ue,Et=Ct.y-$e,Tt=2*(it*Et-_t*At),jt=it*it+_t*_t,Nt=At*At+Et*Et,Yt={x:(Et*jt-_t*Nt)/Tt+Ue,y:(it*Nt-At*jt)/Tt+$e};si(I.edge,Ee,Ct,Yt),ke.edge=Ur(Ee,le,null,Yt),I.edge=Ur(le,Ct,null,Yt),hr(E),hr(I)}else ke.edge=Ur(E.site,ke.site)}}function Ln(le,E){var I=le.site,F=I.x,H=I.y,re=H-E;if(!re)return F;var ue=le.P;if(!ue)return-1/0;var ye=(I=ue.site).x,ke=I.y,Ee=ke-E;if(!Ee)return ye;var Ue=ye-F,$e=1/re-1/Ee,it=Ue/Ee;return $e?(-it+Math.sqrt(it*it-2*$e*(Ue*Ue/(-2*Ee)-ke+Ee/2+H-re/2)))/$e+F:(F+ye)/2}function Dn(le,E){var I=le.N;if(I)return Ln(I,E);var F=le.site;return F.y===E?F.x:1/0}function Kn(le){this.site=le,this.edges=[]}function Qn(le,E){return E.angle-le.angle}function lr(){Fr(this),this.x=this.y=this.arc=this.site=this.cy=null}function hr(le){var E=le.P,I=le.N;if(E&&I){var F=E.site,H=le.site,re=I.site;if(F!==re){var ue=H.x,ye=H.y,ke=F.x-ue,Ee=F.y-ye,Ue=re.x-ue,$e=2*(ke*(Et=re.y-ye)-Ee*Ue);if(!($e>=-1e-12)){var it=ke*ke+Ee*Ee,_t=Ue*Ue+Et*Et,Ct=(Et*it-Ee*_t)/$e,At=(ke*_t-Ue*it)/$e,Et=At+ye,Tt=Hn.pop()||new lr;Tt.arc=le,Tt.site=H,Tt.x=Ct+ue,Tt.y=Et+Math.sqrt(Ct*Ct+At*At),Tt.cy=Et,le.circle=Tt;for(var jt=null,Nt=hn._;Nt;)if(Tt.y<Nt.y||Tt.y===Nt.y&&Tt.x<=Nt.x){if(!Nt.L){jt=Nt.P;break}Nt=Nt.L}else{if(!Nt.R){jt=Nt;break}Nt=Nt.R}hn.insert(jt,Tt),jt||(It=Tt)}}}}function Mr(le){var E=le.circle;E&&(E.P||(It=E.N),hn.remove(E),Hn.push(E),Fr(E),le.circle=null)}function Er(le,E){var I=le.b;if(I)return!0;var F,H,re=le.a,ue=E[0][0],ye=E[1][0],ke=E[0][1],Ee=E[1][1],Ue=le.l,$e=le.r,it=Ue.x,_t=Ue.y,Ct=$e.x,At=$e.y,Et=(it+Ct)/2;if(At===_t){if(Et<ue||Et>=ye)return;if(it>Ct){if(re){if(re.y>=Ee)return}else re={x:Et,y:ke};I={x:Et,y:Ee}}else{if(re){if(re.y<ke)return}else re={x:Et,y:Ee};I={x:Et,y:ke}}}else if(H=(_t+At)/2-(F=(it-Ct)/(At-_t))*Et,F<-1||F>1)if(it>Ct){if(re){if(re.y>=Ee)return}else re={x:(ke-H)/F,y:ke};I={x:(Ee-H)/F,y:Ee}}else{if(re){if(re.y<ke)return}else re={x:(Ee-H)/F,y:Ee};I={x:(ke-H)/F,y:ke}}else if(_t<At){if(re){if(re.x>=ye)return}else re={x:ue,y:F*ue+H};I={x:ye,y:F*ye+H}}else{if(re){if(re.x<ue)return}else re={x:ye,y:F*ye+H};I={x:ue,y:F*ue+H}}return le.a=re,le.b=I,!0}function Pr(le,E){this.l=le,this.r=E,this.a=this.b=null}function Ur(le,E,I,F){var H=new Pr(le,E);return ri.push(H),I&&si(H,le,E,I),F&&si(H,E,le,F),sn[le.i].edges.push(new Fi(H,le,E)),sn[E.i].edges.push(new Fi(H,E,le)),H}function Yr(le,E,I){var F=new Pr(le,null);return F.a=E,F.b=I,ri.push(F),F}function si(le,E,I,F){le.a||le.b?le.l===I?le.b=F:le.a=F:(le.a=F,le.l=E,le.r=I)}function Fi(le,E,I){var F=le.a,H=le.b;this.edge=le,this.site=E,this.angle=I?Math.atan2(I.y-E.y,I.x-E.x):le.l===E?Math.atan2(H.x-F.x,F.y-H.y):Math.atan2(F.x-H.x,H.y-F.y)}function Ri(){this._=null}function Fr(le){le.U=le.C=le.L=le.R=le.P=le.N=null}function fi(le,E){var I=E,F=E.R,H=I.U;H?H.L===I?H.L=F:H.R=F:le._=F,F.U=H,I.U=F,I.R=F.L,I.R&&(I.R.U=I),F.L=I}function ci(le,E){var I=E,F=E.L,H=I.U;H?H.L===I?H.L=F:H.R=F:le._=F,F.U=H,I.U=F,I.L=F.R,I.L&&(I.L.U=I),F.R=I}function Yi(le){for(;le.L;)le=le.L;return le}function Ta(le,E){var I,F,H,re=le.sort(Ba).pop();for(ri=[],sn=new Array(le.length),wn=new Ri,hn=new Ri;;)if(H=It,re&&(!H||re.y<H.y||re.y===H.y&&re.x<H.x))re.x===I&&re.y===F||(sn[re.i]=new Kn(re),Mn(re),I=re.x,F=re.y),re=le.pop();else{if(!H)break;kn(H.arc)}E&&(function(ye){for(var ke,Ee,Ue,$e,it,_t=ri,Ct=(Ee=ye[0][0],Ue=ye[0][1],$e=ye[1][0],it=ye[1][1],function(Et){var Tt,jt=Et.a,Nt=Et.b,Yt=jt.x,ln=jt.y,bn=0,In=1,En=Nt.x-Yt,ir=Nt.y-ln;if(Tt=Ee-Yt,En||!(Tt>0)){if(Tt/=En,En<0){if(Tt<bn)return;Tt<In&&(In=Tt)}else if(En>0){if(Tt>In)return;Tt>bn&&(bn=Tt)}if(Tt=$e-Yt,En||!(Tt<0)){if(Tt/=En,En<0){if(Tt>In)return;Tt>bn&&(bn=Tt)}else if(En>0){if(Tt<bn)return;Tt<In&&(In=Tt)}if(Tt=Ue-ln,ir||!(Tt>0)){if(Tt/=ir,ir<0){if(Tt<bn)return;Tt<In&&(In=Tt)}else if(ir>0){if(Tt>In)return;Tt>bn&&(bn=Tt)}if(Tt=it-ln,ir||!(Tt<0)){if(Tt/=ir,ir<0){if(Tt>In)return;Tt>bn&&(bn=Tt)}else if(ir>0){if(Tt<bn)return;Tt<In&&(In=Tt)}return bn>0&&(Et.a={x:Yt+bn*En,y:ln+bn*ir}),In<1&&(Et.b={x:Yt+In*En,y:ln+In*ir}),Et}}}}}),At=_t.length;At--;)(!Er(ke=_t[At],ye)||!Ct(ke)||a(ke.a.x-ke.b.x)<yt&&a(ke.a.y-ke.b.y)<yt)&&(ke.a=ke.b=null,_t.splice(At,1))}(E),function(ye){for(var ke,Ee,Ue,$e,it,_t,Ct,At,Et,Tt,jt=ye[0][0],Nt=ye[1][0],Yt=ye[0][1],ln=ye[1][1],bn=sn,In=bn.length;In--;)if((it=bn[In])&&it.prepare())for(At=(Ct=it.edges).length,_t=0;_t<At;)Ue=(Tt=Ct[_t].end()).x,$e=Tt.y,ke=(Et=Ct[++_t%At].start()).x,Ee=Et.y,(a(Ue-ke)>yt||a($e-Ee)>yt)&&(Ct.splice(_t,0,new Fi(Yr(it.site,Tt,a(Ue-jt)<yt&&ln-$e>yt?{x:jt,y:a(ke-jt)<yt?Ee:ln}:a($e-ln)<yt&&Nt-Ue>yt?{x:a(Ee-ln)<yt?ke:Nt,y:ln}:a(Ue-Nt)<yt&&$e-Yt>yt?{x:Nt,y:a(ke-Nt)<yt?Ee:Yt}:a($e-Yt)<yt&&Ue-jt>yt?{x:a(Ee-Yt)<yt?ke:jt,y:Yt}:null),it.site,null)),++At)}(E));var ue={cells:sn,edges:ri};return wn=hn=ri=sn=null,ue}function Ba(le,E){return E.y-le.y||E.x-le.x}Kn.prototype.prepare=function(){for(var le,E=this.edges,I=E.length;I--;)(le=E[I].edge).b&&le.a||E.splice(I,1);return E.sort(Qn),E.length},Fi.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ri.prototype={insert:function(le,E){var I,F,H;if(le){if(E.P=le,E.N=le.N,le.N&&(le.N.P=E),le.N=E,le.R){for(le=le.R;le.L;)le=le.L;le.L=E}else le.R=E;I=le}else this._?(le=Yi(this._),E.P=null,E.N=le,le.P=le.L=E,I=le):(E.P=E.N=null,this._=E,I=null);for(E.L=E.R=null,E.U=I,E.C=!0,le=E;I&&I.C;)I===(F=I.U).L?(H=F.R)&&H.C?(I.C=H.C=!1,F.C=!0,le=F):(le===I.R&&(fi(this,I),I=(le=I).U),I.C=!1,F.C=!0,ci(this,F)):(H=F.L)&&H.C?(I.C=H.C=!1,F.C=!0,le=F):(le===I.L&&(ci(this,I),I=(le=I).U),I.C=!1,F.C=!0,fi(this,F)),I=le.U;this._.C=!1},remove:function(le){le.N&&(le.N.P=le.P),le.P&&(le.P.N=le.N),le.N=le.P=null;var E,I,F,H=le.U,re=le.L,ue=le.R;if(I=re?ue?Yi(ue):re:ue,H?H.L===le?H.L=I:H.R=I:this._=I,re&&ue?(F=I.C,I.C=le.C,I.L=re,re.U=I,I!==ue?(H=I.U,I.U=le.U,H.L=le=I.R,I.R=ue,ue.U=I):(I.U=H,H=I,le=I.R)):(F=le.C,le=I),le&&(le.U=H),!F)if(le&&le.C)le.C=!1;else{do{if(le===this._)break;if(le===H.L){if((E=H.R).C&&(E.C=!1,H.C=!0,fi(this,H),E=H.R),E.L&&E.L.C||E.R&&E.R.C){E.R&&E.R.C||(E.L.C=!1,E.C=!0,ci(this,E),E=H.R),E.C=H.C,H.C=E.R.C=!1,fi(this,H),le=this._;break}}else if((E=H.L).C&&(E.C=!1,H.C=!0,ci(this,H),E=H.L),E.L&&E.L.C||E.R&&E.R.C){E.L&&E.L.C||(E.R.C=!1,E.C=!0,fi(this,E),E=H.L),E.C=H.C,H.C=E.L.C=!1,ci(this,H),le=this._;break}E.C=!0,le=H,H=H.U}while(!le.C);le&&(le.C=!1)}}},g.geom.voronoi=function(le){var E=Yn,I=ar,F=E,H=I,re=go;if(le)return ue(le);function ue(ke){var Ee=new Array(ke.length),Ue=re[0][0],$e=re[0][1],it=re[1][0],_t=re[1][1];return Ta(ye(ke),re).cells.forEach(function(Ct,At){var Et=Ct.edges,Tt=Ct.site;(Ee[At]=Et.length?Et.map(function(jt){var Nt=jt.start();return[Nt.x,Nt.y]}):Tt.x>=Ue&&Tt.x<=it&&Tt.y>=$e&&Tt.y<=_t?[[Ue,_t],[it,_t],[it,$e],[Ue,$e]]:[]).point=ke[At]}),Ee}function ye(ke){return ke.map(function(Ee,Ue){return{x:Math.round(F(Ee,Ue)/yt)*yt,y:Math.round(H(Ee,Ue)/yt)*yt,i:Ue}})}return ue.links=function(ke){return Ta(ye(ke)).edges.filter(function(Ee){return Ee.l&&Ee.r}).map(function(Ee){return{source:ke[Ee.l.i],target:ke[Ee.r.i]}})},ue.triangles=function(ke){var Ee=[];return Ta(ye(ke)).cells.forEach(function(Ue,$e){for(var it,_t,Ct,At,Et=Ue.site,Tt=Ue.edges.sort(Qn),jt=-1,Nt=Tt.length,Yt=Tt[Nt-1].edge,ln=Yt.l===Et?Yt.r:Yt.l;++jt<Nt;)it=ln,ln=(Yt=Tt[jt].edge).l===Et?Yt.r:Yt.l,$e<it.i&&$e<ln.i&&((_t=Et).x-(At=ln).x)*((Ct=it).y-_t.y)-(_t.x-Ct.x)*(At.y-_t.y)<0&&Ee.push([ke[$e],ke[it.i],ke[ln.i]])}),Ee},ue.x=function(ke){return arguments.length?(F=_n(E=ke),ue):E},ue.y=function(ke){return arguments.length?(H=_n(I=ke),ue):I},ue.clipExtent=function(ke){return arguments.length?(re=null==ke?go:ke,ue):re===go?null:re},ue.size=function(ke){return arguments.length?ue.clipExtent(ke&&[[0,0],ke]):re===go?null:re&&re[1]},ue};var go=[[-1e6,-1e6],[1e6,1e6]];function ra(le){return le.x}function ia(le){return le.y}function so(le,E,I,F,H,re){if(!le(E,I,F,H,re)){var ue=.5*(I+H),ye=.5*(F+re),ke=E.nodes;ke[0]&&so(le,ke[0],I,F,ue,ye),ke[1]&&so(le,ke[1],ue,F,H,ye),ke[2]&&so(le,ke[2],I,ye,ue,re),ke[3]&&so(le,ke[3],ue,ye,H,re)}}function Zi(le,E,I,F,H,re,ue){var ye,ke=1/0;return function Ee(Ue,$e,it,_t,Ct){if(!($e>re||it>ue||_t<F||Ct<H)){if(At=Ue.point){var At,Et=E-Ue.x,Tt=I-Ue.y,jt=Et*Et+Tt*Tt;if(jt<ke){var Nt=Math.sqrt(ke=jt);F=E-Nt,H=I-Nt,re=E+Nt,ue=I+Nt,ye=At}}for(var Yt=Ue.nodes,ln=.5*($e+_t),bn=.5*(it+Ct),In=(I>=bn)<<1|E>=ln,En=In+4;In<En;++In)if(Ue=Yt[3&In])switch(3&In){case 0:Ee(Ue,$e,it,ln,bn);break;case 1:Ee(Ue,ln,it,_t,bn);break;case 2:Ee(Ue,$e,bn,ln,Ct);break;case 3:Ee(Ue,ln,bn,_t,Ct)}}}(le,F,H,re,ue),ye}function Ra(le,E){le=g.rgb(le),E=g.rgb(E);var I=le.r,F=le.g,H=le.b,re=E.r-I,ue=E.g-F,ye=E.b-H;return function(ke){return"#"+vn(Math.round(I+re*ke))+vn(Math.round(F+ue*ke))+vn(Math.round(H+ye*ke))}}function Fa(le,E){var I,F={},H={};for(I in le)I in E?F[I]=Wa(le[I],E[I]):H[I]=le[I];for(I in E)I in le||(H[I]=E[I]);return function(re){for(I in F)H[I]=F[I](re);return H}}function _a(le,E){return le=+le,E=+E,function(I){return le*(1-I)+E*I}}function Xa(le,E){var I,F,H,re=no.lastIndex=_o.lastIndex=0,ue=-1,ye=[],ke=[];for(le+="",E+="";(I=no.exec(le))&&(F=_o.exec(E));)(H=F.index)>re&&(H=E.slice(re,H),ye[ue]?ye[ue]+=H:ye[++ue]=H),(I=I[0])===(F=F[0])?ye[ue]?ye[ue]+=F:ye[++ue]=F:(ye[++ue]=null,ke.push({i:ue,x:_a(I,F)})),re=_o.lastIndex;return re<E.length&&(H=E.slice(re),ye[ue]?ye[ue]+=H:ye[++ue]=H),ye.length<2?ke[0]?(E=ke[0].x,function(Ee){return E(Ee)+""}):function(){return E}:(E=ke.length,function(Ee){for(var Ue,$e=0;$e<E;++$e)ye[(Ue=ke[$e]).i]=Ue.x(Ee);return ye.join("")})}g.geom.delaunay=function(le){return g.geom.voronoi().triangles(le)},g.geom.quadtree=function(le,E,I,F,H){var re,ue=Yn,ye=ar;if(re=arguments.length)return ue=ra,ye=ia,3===re&&(H=I,F=E,I=E=0),ke(le);function ke(Ee){var Ue,$e,it,_t,Ct,At,Et,Tt,jt,Nt=_n(ue),Yt=_n(ye);if(null!=E)At=E,Et=I,Tt=F,jt=H;else if(Tt=jt=-(At=Et=1/0),$e=[],it=[],Ct=Ee.length,re)for(_t=0;_t<Ct;++_t)(Ue=Ee[_t]).x<At&&(At=Ue.x),Ue.y<Et&&(Et=Ue.y),Ue.x>Tt&&(Tt=Ue.x),Ue.y>jt&&(jt=Ue.y),$e.push(Ue.x),it.push(Ue.y);else for(_t=0;_t<Ct;++_t){var ln=+Nt(Ue=Ee[_t],_t),bn=+Yt(Ue,_t);ln<At&&(At=ln),bn<Et&&(Et=bn),ln>Tt&&(Tt=ln),bn>jt&&(jt=bn),$e.push(ln),it.push(bn)}var In=Tt-At,En=jt-Et;function ir(pr,Qr,li,xi,Wn,Rr,oi,ti){if(!isNaN(li)&&!isNaN(xi))if(pr.leaf){var vi=pr.x,ki=pr.y;if(null!=vi)if(a(vi-li)+a(ki-xi)<.01)rr(pr,Qr,li,xi,Wn,Rr,oi,ti);else{var ji=pr.point;pr.x=pr.y=pr.point=null,rr(pr,ji,vi,ki,Wn,Rr,oi,ti),rr(pr,Qr,li,xi,Wn,Rr,oi,ti)}else pr.x=li,pr.y=xi,pr.point=Qr}else rr(pr,Qr,li,xi,Wn,Rr,oi,ti)}function rr(pr,Qr,li,xi,Wn,Rr,oi,ti){var vi=.5*(Wn+oi),ki=.5*(Rr+ti),ji=li>=vi,ui=xi>=ki,Oi=ui<<1|ji;pr.leaf=!1,ji?Wn=vi:oi=vi,ui?Rr=ki:ti=ki,ir(pr=pr.nodes[Oi]||(pr.nodes[Oi]={leaf:!0,nodes:[],point:null,x:null,y:null}),Qr,li,xi,Wn,Rr,oi,ti)}In>En?jt=Et+In:Tt=At+En;var _r={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(pr){ir(_r,pr,+Nt(pr,++_t),+Yt(pr,_t),At,Et,Tt,jt)},visit:function(pr){so(pr,_r,At,Et,Tt,jt)},find:function(pr){return Zi(_r,pr[0],pr[1],At,Et,Tt,jt)}};if(_t=-1,null==E){for(;++_t<Ct;)ir(_r,Ee[_t],$e[_t],it[_t],At,Et,Tt,jt);--_t}else Ee.forEach(_r.add);return $e=it=Ee=Ue=null,_r}return ke.x=function(Ee){return arguments.length?(ue=Ee,ke):ue},ke.y=function(Ee){return arguments.length?(ye=Ee,ke):ye},ke.extent=function(Ee){return arguments.length?(null==Ee?E=I=F=H=null:(E=+Ee[0][0],I=+Ee[0][1],F=+Ee[1][0],H=+Ee[1][1]),ke):null==E?null:[[E,I],[F,H]]},ke.size=function(Ee){return arguments.length?(null==Ee?E=I=F=H=null:(E=I=0,F=+Ee[0],H=+Ee[1]),ke):null==E?null:[F-E,H-I]},ke},g.interpolateRgb=Ra,g.interpolateObject=Fa,g.interpolateNumber=_a,g.interpolateString=Xa;var no=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_o=new RegExp(no.source,"g");function Wa(le,E){for(var I,F=g.interpolators.length;--F>=0&&!(I=g.interpolators[F](le,E)););return I}function xa(le,E){var I,F=[],H=[],re=le.length,ue=E.length,ye=Math.min(le.length,E.length);for(I=0;I<ye;++I)F.push(Wa(le[I],E[I]));for(;I<re;++I)H[I]=le[I];for(;I<ue;++I)H[I]=E[I];return function(ke){for(I=0;I<ye;++I)H[I]=F[I](ke);return H}}g.interpolate=Wa,g.interpolators=[function(le,E){var I=typeof E;return("string"===I?mn.has(E.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(E)?Ra:Xa:E instanceof Ke?Ra:Array.isArray(E)?xa:"object"===I&&isNaN(E)?Fa:_a)(le,E)}],g.interpolateArray=xa;var ro=function(){return C},ds=g.map({linear:ro,poly:function(le){return function(E){return Math.pow(E,le)}},quad:function(){return As},cubic:function(){return Ms},sin:function(){return Ss},exp:function(){return vo},circle:function(){return Lo},elastic:function(le,E){var I;return arguments.length<2&&(E=.45),arguments.length?I=E/Gt*Math.asin(1/le):(le=1,I=E/4),function(F){return 1+le*Math.pow(2,-10*F)*Math.sin((F-I)*Gt/E)}},back:function(le){return le||(le=1.70158),function(E){return E*E*((le+1)*E-le)}},bounce:function(){return Bo}}),bs=g.map({in:C,out:ls,"in-out":ts,"out-in":function(le){return ts(ls(le))}});function ta(le){return function(E){return E<=0?0:E>=1?1:le(E)}}function ls(le){return function(E){return 1-le(1-E)}}function ts(le){return function(E){return.5*(E<.5?le(2*E):2-le(2-2*E))}}function As(le){return le*le}function Ms(le){return le*le*le}function _s(le){if(le<=0)return 0;if(le>=1)return 1;var E=le*le,I=E*le;return 4*(le<.5?I:3*(le-E)+I-.75)}function Ss(le){return 1-Math.cos(le*Jt)}function vo(le){return Math.pow(2,10*(le-1))}function Lo(le){return 1-Math.sqrt(1-le*le)}function Bo(le){return le<1/2.75?7.5625*le*le:le<2/2.75?7.5625*(le-=1.5/2.75)*le+.75:le<2.5/2.75?7.5625*(le-=2.25/2.75)*le+.9375:7.5625*(le-=2.625/2.75)*le+.984375}function qo(le,E){return E-=le,function(I){return Math.round(le+E*I)}}function Ho(le){var E,I,F,H=[le.a,le.b],re=[le.c,le.d],ue=wo(H),ye=ns(H,re),ke=wo(((E=re)[0]+=(F=-ye)*(I=H)[0],E[1]+=F*I[1],E))||0;H[0]*re[1]<re[0]*H[1]&&(H[0]*=-1,H[1]*=-1,ue*=-1,ye*=-1),this.rotate=(ue?Math.atan2(H[1],H[0]):Math.atan2(-re[0],re[1]))*Rt,this.translate=[le.e,le.f],this.scale=[ue,ke],this.skew=ke?Math.atan2(ye,ke)*Rt:0}function ns(le,E){return le[0]*E[0]+le[1]*E[1]}function wo(le){var E=Math.sqrt(ns(le,le));return E&&(le[0]/=E,le[1]/=E),E}g.ease=function(le){var E=le.indexOf("-"),I=E>=0?le.slice(0,E):le,F=E>=0?le.slice(E+1):"in";return I=ds.get(I)||ro,ta((F=bs.get(F)||C)(I.apply(null,t.call(arguments,1))))},g.interpolateHcl=function(le,E){le=g.hcl(le),E=g.hcl(E);var I=le.h,F=le.c,H=le.l,re=E.h-I,ue=E.c-F,ye=E.l-H;return isNaN(ue)&&(ue=0,F=isNaN(F)?E.c:F),isNaN(re)?(re=0,I=isNaN(I)?E.h:I):re>180?re-=360:re<-180&&(re+=360),function(ke){return ot(I+re*ke,F+ue*ke,H+ye*ke)+""}},g.interpolateHsl=function(le,E){le=g.hsl(le),E=g.hsl(E);var I=le.h,F=le.s,H=le.l,re=E.h-I,ue=E.s-F,ye=E.l-H;return isNaN(ue)&&(ue=0,F=isNaN(F)?E.s:F),isNaN(re)?(re=0,I=isNaN(I)?E.h:I):re>180?re-=360:re<-180&&(re+=360),function(ke){return lt(I+re*ke,F+ue*ke,H+ye*ke)+""}},g.interpolateLab=function(le,E){le=g.lab(le),E=g.lab(E);var I=le.l,F=le.a,H=le.b,re=E.l-I,ue=E.a-F,ye=E.b-H;return function(ke){return Mt(I+re*ke,F+ue*ke,H+ye*ke)+""}},g.interpolateRound=qo,g.transform=function(le){var E=x.createElementNS(g.ns.prefix.svg,"g");return(g.transform=function(I){if(null!=I){E.setAttribute("transform",I);var F=E.transform.baseVal.consolidate()}return new Ho(F?F.matrix:ws)})(le)},Ho.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ws={a:1,b:0,c:0,d:1,e:0,f:0};function yo(le){return le.length?le.pop()+",":""}function Yo(le,E){var H,re,ue,I=[],F=[];return le=g.transform(le),E=g.transform(E),function(H,re,ue,ye){if(H[0]!==re[0]||H[1]!==re[1]){var ke=ue.push("translate(",null,",",null,")");ye.push({i:ke-4,x:_a(H[0],re[0])},{i:ke-2,x:_a(H[1],re[1])})}else(re[0]||re[1])&&ue.push("translate("+re+")")}(le.translate,E.translate,I,F),ue=I,(H=le.rotate)!==(re=E.rotate)?(H-re>180?re+=360:re-H>180&&(H+=360),F.push({i:ue.push(yo(ue)+"rotate(",null,")")-2,x:_a(H,re)})):re&&ue.push(yo(ue)+"rotate("+re+")"),function(H,re,ue,ye){H!==re?ye.push({i:ue.push(yo(ue)+"skewX(",null,")")-2,x:_a(H,re)}):re&&ue.push(yo(ue)+"skewX("+re+")")}(le.skew,E.skew,I,F),function(H,re,ue,ye){if(H[0]!==re[0]||H[1]!==re[1]){var ke=ue.push(yo(ue)+"scale(",null,",",null,")");ye.push({i:ke-4,x:_a(H[0],re[0])},{i:ke-2,x:_a(H[1],re[1])})}else 1===re[0]&&1===re[1]||ue.push(yo(ue)+"scale("+re+")")}(le.scale,E.scale,I,F),le=E=null,function(H){for(var re,ue=-1,ye=F.length;++ue<ye;)I[(re=F[ue]).i]=re.x(H);return I.join("")}}function ms(le,E){return E=(E-=le=+le)||1/E,function(I){return(I-le)/E}}function zo(le,E){return E=(E-=le=+le)||1/E,function(I){return Math.max(0,Math.min(1,(I-le)/E))}}function Gi(le){for(var E=le.source,I=le.target,F=function(ue,ye){if(ue===ye)return ue;for(var ke=qe(ue),Ee=qe(ye),Ue=ke.pop(),$e=Ee.pop(),it=null;Ue===$e;)it=Ue,Ue=ke.pop(),$e=Ee.pop();return it}(E,I),H=[E];E!==F;)H.push(E=E.parent);for(var re=H.length;I!==F;)H.splice(re,0,I),I=I.parent;return H}function qe(le){for(var E=[],I=le.parent;null!=I;)E.push(le),le=I,I=I.parent;return E.push(le),E}function We(le){le.fixed|=2}function rt(le){le.fixed&=-7}function ft(le){le.fixed|=4,le.px=le.x,le.py=le.y}function bt(le){le.fixed&=-5}g.interpolateTransform=Yo,g.layout={},g.layout.bundle=function(){return function(le){for(var E=[],I=-1,F=le.length;++I<F;)E.push(Gi(le[I]));return E}},g.layout.chord=function(){var le,E,I,F,H,re,ue,ye={},ke=0;function Ee(){var $e,it,_t,Ct,At,Et={},Tt=[],jt=g.range(F),Nt=[];for(le=[],E=[],$e=0,Ct=-1;++Ct<F;){for(it=0,At=-1;++At<F;)it+=I[Ct][At];Tt.push(it),Nt.push(g.range(F)),$e+=it}for(H&&jt.sort(function(_r,pr){return H(Tt[_r],Tt[pr])}),re&&Nt.forEach(function(_r,pr){_r.sort(function(Qr,li){return re(I[pr][Qr],I[pr][li])})}),$e=(Gt-ke*F)/$e,it=0,Ct=-1;++Ct<F;){for(_t=it,At=-1;++At<F;){var Yt=jt[Ct],ln=Nt[Yt][At],bn=I[Yt][ln],In=it,En=it+=bn*$e;Et[Yt+"-"+ln]={index:Yt,subindex:ln,startAngle:In,endAngle:En,value:bn}}E[Yt]={index:Yt,startAngle:_t,endAngle:it,value:Tt[Yt]},it+=ke}for(Ct=-1;++Ct<F;)for(At=Ct-1;++At<F;){var ir=Et[Ct+"-"+At],rr=Et[At+"-"+Ct];(ir.value||rr.value)&&le.push(ir.value<rr.value?{source:rr,target:ir}:{source:ir,target:rr})}ue&&Ue()}function Ue(){le.sort(function($e,it){return ue(($e.source.value+$e.target.value)/2,(it.source.value+it.target.value)/2)})}return ye.matrix=function($e){return arguments.length?(F=(I=$e)&&I.length,le=E=null,ye):I},ye.padding=function($e){return arguments.length?(ke=$e,le=E=null,ye):ke},ye.sortGroups=function($e){return arguments.length?(H=$e,le=E=null,ye):H},ye.sortSubgroups=function($e){return arguments.length?(re=$e,le=null,ye):re},ye.sortChords=function($e){return arguments.length?(ue=$e,le&&Ue(),ye):ue},ye.chords=function(){return le||Ee(),le},ye.groups=function(){return E||Ee(),E},ye},g.layout.force=function(){var le,E,I,F,H,re,ue={},ye=g.dispatch("start","tick","end"),ke=[1,1],Ee=.9,Ue=vt,$e=Pt,it=-30,_t=tn,Ct=.1,At=.64,Et=[],Tt=[];function jt(Yt){return function(ln,bn,In,En){if(ln.point!==Yt){var ir=ln.cx-Yt.x,rr=ln.cy-Yt.y,_r=En-bn,pr=ir*ir+rr*rr;if(_r*_r/At<pr){if(pr<_t){var Qr=ln.charge/pr;Yt.px-=ir*Qr,Yt.py-=rr*Qr}return!0}ln.point&&pr&&pr<_t&&(Yt.px-=ir*(Qr=ln.pointCharge/pr),Yt.py-=rr*Qr)}return!ln.charge}}function Nt(Yt){Yt.px=g.event.x,Yt.py=g.event.y,ue.resume()}return ue.tick=function(){if((I*=.99)<.005)return le=null,ye.end({type:"end",alpha:I=0}),!0;var Yt,ln,bn,In,En,ir,rr,_r,pr,Qr=Et.length,li=Tt.length;for(ln=0;ln<li;++ln)In=(bn=Tt[ln]).source,(ir=(_r=(En=bn.target).x-In.x)*_r+(pr=En.y-In.y)*pr)&&(_r*=ir=I*H[ln]*((ir=Math.sqrt(ir))-F[ln])/ir,pr*=ir,En.x-=_r*(rr=In.weight+En.weight?In.weight/(In.weight+En.weight):.5),En.y-=pr*rr,In.x+=_r*(rr=1-rr),In.y+=pr*rr);if((rr=I*Ct)&&(_r=ke[0]/2,pr=ke[1]/2,ln=-1,rr))for(;++ln<Qr;)(bn=Et[ln]).x+=(_r-bn.x)*rr,bn.y+=(pr-bn.y)*rr;if(it)for(function xi(Wn,Rr,oi){var ti=0,vi=0;if(Wn.charge=0,!Wn.leaf)for(var ki,ji=Wn.nodes,ui=ji.length,Oi=-1;++Oi<ui;)null!=(ki=ji[Oi])&&(xi(ki,Rr,oi),Wn.charge+=ki.charge,ti+=ki.charge*ki.cx,vi+=ki.charge*ki.cy);if(Wn.point){Wn.leaf||(Wn.point.x+=Math.random()-.5,Wn.point.y+=Math.random()-.5);var zi=Rr*oi[Wn.point.index];Wn.charge+=Wn.pointCharge=zi,ti+=zi*Wn.point.x,vi+=zi*Wn.point.y}Wn.cx=ti/Wn.charge,Wn.cy=vi/Wn.charge}(Yt=g.geom.quadtree(Et),I,re),ln=-1;++ln<Qr;)(bn=Et[ln]).fixed||Yt.visit(jt(bn));for(ln=-1;++ln<Qr;)(bn=Et[ln]).fixed?(bn.x=bn.px,bn.y=bn.py):(bn.x-=(bn.px-(bn.px=bn.x))*Ee,bn.y-=(bn.py-(bn.py=bn.y))*Ee);ye.tick({type:"tick",alpha:I})},ue.nodes=function(Yt){return arguments.length?(Et=Yt,ue):Et},ue.links=function(Yt){return arguments.length?(Tt=Yt,ue):Tt},ue.size=function(Yt){return arguments.length?(ke=Yt,ue):ke},ue.linkDistance=function(Yt){return arguments.length?(Ue="function"==typeof Yt?Yt:+Yt,ue):Ue},ue.distance=ue.linkDistance,ue.linkStrength=function(Yt){return arguments.length?($e="function"==typeof Yt?Yt:+Yt,ue):$e},ue.friction=function(Yt){return arguments.length?(Ee=+Yt,ue):Ee},ue.charge=function(Yt){return arguments.length?(it="function"==typeof Yt?Yt:+Yt,ue):it},ue.chargeDistance=function(Yt){return arguments.length?(_t=Yt*Yt,ue):Math.sqrt(_t)},ue.gravity=function(Yt){return arguments.length?(Ct=+Yt,ue):Ct},ue.theta=function(Yt){return arguments.length?(At=Yt*Yt,ue):Math.sqrt(At)},ue.alpha=function(Yt){return arguments.length?(Yt=+Yt,I?Yt>0?I=Yt:(le.c=null,le.t=NaN,le=null,ye.end({type:"end",alpha:I=0})):Yt>0&&(ye.start({type:"start",alpha:I=Yt}),le=cr(ue.tick)),ue):I},ue.start=function(){var Yt,ln,bn,In=Et.length,En=Tt.length,ir=ke[0],rr=ke[1];for(Yt=0;Yt<In;++Yt)(bn=Et[Yt]).index=Yt,bn.weight=0;for(Yt=0;Yt<En;++Yt)"number"==typeof(bn=Tt[Yt]).source&&(bn.source=Et[bn.source]),"number"==typeof bn.target&&(bn.target=Et[bn.target]),++bn.source.weight,++bn.target.weight;for(Yt=0;Yt<In;++Yt)bn=Et[Yt],isNaN(bn.x)&&(bn.x=_r("x",ir)),isNaN(bn.y)&&(bn.y=_r("y",rr)),isNaN(bn.px)&&(bn.px=bn.x),isNaN(bn.py)&&(bn.py=bn.y);if(F=[],"function"==typeof Ue)for(Yt=0;Yt<En;++Yt)F[Yt]=+Ue.call(this,Tt[Yt],Yt);else for(Yt=0;Yt<En;++Yt)F[Yt]=Ue;if(H=[],"function"==typeof $e)for(Yt=0;Yt<En;++Yt)H[Yt]=+$e.call(this,Tt[Yt],Yt);else for(Yt=0;Yt<En;++Yt)H[Yt]=$e;if(re=[],"function"==typeof it)for(Yt=0;Yt<In;++Yt)re[Yt]=+it.call(this,Et[Yt],Yt);else for(Yt=0;Yt<In;++Yt)re[Yt]=it;function _r(pr,Qr){if(!ln){for(ln=new Array(In),Rr=0;Rr<In;++Rr)ln[Rr]=[];for(Rr=0;Rr<En;++Rr){var li=Tt[Rr];ln[li.source.index].push(li.target),ln[li.target.index].push(li.source)}}for(var xi,Wn=ln[Yt],Rr=-1,oi=Wn.length;++Rr<oi;)if(!isNaN(xi=Wn[Rr][pr]))return xi;return Math.random()*Qr}return ue.resume()},ue.resume=function(){return ue.alpha(.1)},ue.stop=function(){return ue.alpha(0)},ue.drag=function(){if(E||(E=g.behavior.drag().origin(C).on("dragstart.force",We).on("drag.force",Nt).on("dragend.force",rt)),!arguments.length)return E;this.on("mouseover.force",ft).on("mouseout.force",bt).call(E)},g.rebind(ue,ye,"on")};var vt=20,Pt=1,tn=1/0;function rn(le,E){return g.rebind(le,E,"sort","children","value"),le.nodes=le,le.links=Vn,le}function Qt(le,E){for(var I=[le];null!=(le=I.pop());)if(E(le),(H=le.children)&&(F=H.length))for(var F,H;--F>=0;)I.push(H[F])}function un(le,E){for(var I=[le],F=[];null!=(le=I.pop());)if(F.push(le),(re=le.children)&&(H=re.length))for(var H,re,ue=-1;++ue<H;)I.push(re[ue]);for(;null!=(le=F.pop());)E(le)}function xn(le){return le.children}function Sn(le){return le.value}function Cn(le,E){return E.value-le.value}function Vn(le){return g.merge(le.map(function(E){return(E.children||[]).map(function(I){return{source:E,target:I}})}))}g.layout.hierarchy=function(){var le=Cn,E=xn,I=Sn;function F(H){var re,ue=[H],ye=[];for(H.depth=0;null!=(re=ue.pop());)if(ye.push(re),(Ee=E.call(F,re,re.depth))&&(ke=Ee.length)){for(var ke,Ee,Ue;--ke>=0;)ue.push(Ue=Ee[ke]),Ue.parent=re,Ue.depth=re.depth+1;I&&(re.value=0),re.children=Ee}else I&&(re.value=+I.call(F,re,re.depth)||0),delete re.children;return un(H,function($e){var it,_t;le&&(it=$e.children)&&it.sort(le),I&&(_t=$e.parent)&&(_t.value+=$e.value)}),ye}return F.sort=function(H){return arguments.length?(le=H,F):le},F.children=function(H){return arguments.length?(E=H,F):E},F.value=function(H){return arguments.length?(I=H,F):I},F.revalue=function(H){return I&&(Qt(H,function(re){re.children&&(re.value=0)}),un(H,function(re){var ue;re.children||(re.value=+I.call(F,re,re.depth)||0),(ue=re.parent)&&(ue.value+=re.value)})),H},F},g.layout.partition=function(){var le=g.layout.hierarchy(),E=[1,1];function I(F,H){var re=le.call(this,F,H);return function ue(ye,ke,Ee,Ue){var $e=ye.children;if(ye.x=ke,ye.y=ye.depth*Ue,ye.dx=Ee,ye.dy=Ue,$e&&(it=$e.length)){var it,_t,Ct,At=-1;for(Ee=ye.value?Ee/ye.value:0;++At<it;)ue(_t=$e[At],ke,Ct=_t.value*Ee,Ue),ke+=Ct}}(re[0],0,E[0],E[1]/function ue(ye){var ke=ye.children,Ee=0;if(ke&&(Ue=ke.length))for(var Ue,$e=-1;++$e<Ue;)Ee=Math.max(Ee,ue(ke[$e]));return 1+Ee}(re[0])),re}return I.size=function(F){return arguments.length?(E=F,I):E},rn(I,le)},g.layout.pie=function(){var le=Number,E=mr,I=0,F=Gt,H=0;function re(ue){var ye,ke=ue.length,Ee=ue.map(function(jt,Nt){return+le.call(re,jt,Nt)}),Ue=+("function"==typeof I?I.apply(this,arguments):I),$e=("function"==typeof F?F.apply(this,arguments):F)-Ue,it=Math.min(Math.abs($e)/ke,+("function"==typeof H?H.apply(this,arguments):H)),_t=it*($e<0?-1:1),Ct=g.sum(Ee),At=Ct?($e-ke*_t)/Ct:0,Et=g.range(ke),Tt=[];return null!=E&&Et.sort(E===mr?function(jt,Nt){return Ee[Nt]-Ee[jt]}:function(jt,Nt){return E(ue[jt],ue[Nt])}),Et.forEach(function(jt){Tt[jt]={data:ue[jt],value:ye=Ee[jt],startAngle:Ue,endAngle:Ue+=ye*At+_t,padAngle:it}}),Tt}return re.value=function(ue){return arguments.length?(le=ue,re):le},re.sort=function(ue){return arguments.length?(E=ue,re):E},re.startAngle=function(ue){return arguments.length?(I=ue,re):I},re.endAngle=function(ue){return arguments.length?(F=ue,re):F},re.padAngle=function(ue){return arguments.length?(H=ue,re):H},re};var mr={};function wr(le){return le.x}function qr(le){return le.y}function Gr(le,E,I){le.y0=E,le.y=I}g.layout.stack=function(){var le=C,E=Si,I=Ni,F=Gr,H=wr,re=qr;function ue(ye,ke){if(!(it=ye.length))return ye;var Ee=ye.map(function(jt,Nt){return le.call(ue,jt,Nt)}),Ue=Ee.map(function(jt){return jt.map(function(Nt,Yt){return[H.call(ue,Nt,Yt),re.call(ue,Nt,Yt)]})}),$e=E.call(ue,Ue,ke);Ee=g.permute(Ee,$e),Ue=g.permute(Ue,$e);var it,_t,Ct,At,Et=I.call(ue,Ue,ke),Tt=Ee[0].length;for(Ct=0;Ct<Tt;++Ct)for(F.call(ue,Ee[0][Ct],At=Et[Ct],Ue[0][Ct][1]),_t=1;_t<it;++_t)F.call(ue,Ee[_t][Ct],At+=Ue[_t-1][Ct][1],Ue[_t][Ct][1]);return ye}return ue.values=function(ye){return arguments.length?(le=ye,ue):le},ue.order=function(ye){return arguments.length?(E="function"==typeof ye?ye:ni.get(ye)||Si,ue):E},ue.offset=function(ye){return arguments.length?(I="function"==typeof ye?ye:Xr.get(ye)||Ni,ue):I},ue.x=function(ye){return arguments.length?(H=ye,ue):H},ue.y=function(ye){return arguments.length?(re=ye,ue):re},ue.out=function(ye){return arguments.length?(F=ye,ue):F},ue};var ni=g.map({"inside-out":function(le){var E,I,F=le.length,H=le.map($i),re=le.map(Qi),ue=g.range(F).sort(function($e,it){return H[$e]-H[it]}),ye=0,ke=0,Ee=[],Ue=[];for(E=0;E<F;++E)I=ue[E],ye<ke?(ye+=re[I],Ee.push(I)):(ke+=re[I],Ue.push(I));return Ue.reverse().concat(Ee)},reverse:function(le){return g.range(le.length).reverse()},default:Si}),Xr=g.map({silhouette:function(le){var E,I,F,H=le.length,re=le[0].length,ue=[],ye=0,ke=[];for(I=0;I<re;++I){for(E=0,F=0;E<H;E++)F+=le[E][I][1];F>ye&&(ye=F),ue.push(F)}for(I=0;I<re;++I)ke[I]=(ye-ue[I])/2;return ke},wiggle:function(le){var E,I,F,H,re,ue,ye,ke,Ee,Ue=le.length,$e=le[0],it=$e.length,_t=[];for(_t[0]=ke=Ee=0,I=1;I<it;++I){for(E=0,H=0;E<Ue;++E)H+=le[E][I][1];for(E=0,re=0,ye=$e[I][0]-$e[I-1][0];E<Ue;++E){for(F=0,ue=(le[E][I][1]-le[E][I-1][1])/(2*ye);F<E;++F)ue+=(le[F][I][1]-le[F][I-1][1])/ye;re+=ue*le[E][I][1]}_t[I]=ke-=H?re/H*ye:0,ke<Ee&&(Ee=ke)}for(I=0;I<it;++I)_t[I]-=Ee;return _t},expand:function(le){var E,I,F,H=le.length,re=le[0].length,ue=1/H,ye=[];for(I=0;I<re;++I){for(E=0,F=0;E<H;E++)F+=le[E][I][1];if(F)for(E=0;E<H;E++)le[E][I][1]/=F;else for(E=0;E<H;E++)le[E][I][1]=ue}for(I=0;I<re;++I)ye[I]=0;return ye},zero:Ni});function Si(le){return g.range(le.length)}function Ni(le){for(var E=-1,I=le[0].length,F=[];++E<I;)F[E]=0;return F}function $i(le){for(var E,I=1,F=0,H=le[0][1],re=le.length;I<re;++I)(E=le[I][1])>H&&(F=I,H=E);return F}function Qi(le){return le.reduce(ea,0)}function ea(le,E){return le+E[1]}function za(le,E){return Ma(le,Math.ceil(Math.log(E.length)/Math.LN2+1))}function Ma(le,E){for(var I=-1,F=+le[0],H=(le[1]-F)/E,re=[];++I<=E;)re[I]=H*I+F;return re}function ga(le){return[g.min(le),g.max(le)]}function va(le,E){return le.value-E.value}function Sa(le,E){var I=le._pack_next;le._pack_next=E,E._pack_prev=le,E._pack_next=I,I._pack_prev=E}function Ja(le,E){le._pack_next=E,E._pack_prev=le}function lo(le,E){var I=E.x-le.x,F=E.y-le.y,H=le.r+E.r;return.999*H*H>I*I+F*F}function co(le){if((E=le.children)&&(ke=E.length)){var E,I,F,H,re,ue,ye,ke,Ee=1/0,Ue=-1/0,$e=1/0,it=-1/0;if(E.forEach(uo),(I=E[0]).x=-I.r,I.y=0,Nt(I),ke>1&&((F=E[1]).x=F.r,F.y=0,Nt(F),ke>2))for(Xi(I,F,H=E[2]),Nt(H),Sa(I,H),I._pack_prev=H,Sa(H,F),F=I._pack_next,re=3;re<ke;re++){Xi(I,F,H=E[re]);var _t=0,Ct=1,At=1;for(ue=F._pack_next;ue!==F;ue=ue._pack_next,Ct++)if(lo(ue,H)){_t=1;break}if(1==_t)for(ye=I._pack_prev;ye!==ue._pack_prev&&!lo(ye,H);ye=ye._pack_prev,At++);_t?(Ct<At||Ct==At&&F.r<I.r?Ja(I,F=ue):Ja(I=ye,F),re--):(Sa(I,H),F=H,Nt(H))}var Et=(Ee+Ue)/2,Tt=($e+it)/2,jt=0;for(re=0;re<ke;re++)(H=E[re]).x-=Et,H.y-=Tt,jt=Math.max(jt,H.r+Math.sqrt(H.x*H.x+H.y*H.y));le.r=jt,E.forEach(fo)}function Nt(Yt){Ee=Math.min(Yt.x-Yt.r,Ee),Ue=Math.max(Yt.x+Yt.r,Ue),$e=Math.min(Yt.y-Yt.r,$e),it=Math.max(Yt.y+Yt.r,it)}}function uo(le){le._pack_next=le._pack_prev=le}function fo(le){delete le._pack_next,delete le._pack_prev}function Xi(le,E,I){var F=le.r+I.r,H=E.x-le.x,re=E.y-le.y;if(F&&(H||re)){var ue=E.r+I.r,ye=H*H+re*re,ke=.5+((F*=F)-(ue*=ue))/(2*ye),Ee=Math.sqrt(Math.max(0,2*ue*(F+ye)-(F-=ye)*F-ue*ue))/(2*ye);I.x=le.x+ke*H+Ee*re,I.y=le.y+ke*re-Ee*H}else I.x=le.x+F,I.y=le.y}function mt(le,E){return le.parent==E.parent?1:2}function Bt(le){var E=le.children;return E.length?E[0]:le.t}function pn(le){var E,I=le.children;return(E=I.length)?I[E-1]:le.t}function Xt(le,E,I){var F=I/(E.i-le.i);E.c-=F,E.s+=I,le.c+=F,E.z+=I,E.m+=I}function dn(le,E,I){return le.a.parent===E.parent?le.a:I}function Fn(le){return{x:le.x,y:le.y,dx:le.dx,dy:le.dy}}function Zn(le,E){var I=le.x+E[3],F=le.y+E[0],H=le.dx-E[1]-E[3],re=le.dy-E[0]-E[2];return H<0&&(I+=H/2,H=0),re<0&&(F+=re/2,re=0),{x:I,y:F,dx:H,dy:re}}function er(le){var E=le[0],I=le[le.length-1];return E<I?[E,I]:[I,E]}function yr(le){return le.rangeExtent?le.rangeExtent():er(le.range())}function gr(le,E,I,F){var H=I(le[0],le[1]),re=F(E[0],E[1]);return function(ue){return re(H(ue))}}function Tr(le,E){var I,F=0,H=le.length-1,re=le[F],ue=le[H];return ue<re&&(I=F,F=H,H=I,I=re,re=ue,ue=I),le[F]=E.floor(re),le[H]=E.ceil(ue),le}function Ir(le){return le?{floor:function(E){return Math.floor(E/le)*le},ceil:function(E){return Math.ceil(E/le)*le}}:xr}g.layout.histogram=function(){var le=!0,E=Number,I=ga,F=za;function H(re,ue){for(var ye,ke,Ee=[],Ue=re.map(E,this),$e=I.call(this,Ue,ue),it=F.call(this,$e,Ue,ue),_t=(ue=-1,Ue.length),Ct=it.length-1,At=le?1:1/_t;++ue<Ct;)(ye=Ee[ue]=[]).dx=it[ue+1]-(ye.x=it[ue]),ye.y=0;if(Ct>0)for(ue=-1;++ue<_t;)(ke=Ue[ue])>=$e[0]&&ke<=$e[1]&&((ye=Ee[g.bisect(it,ke,1,Ct)-1]).y+=At,ye.push(re[ue]));return Ee}return H.value=function(re){return arguments.length?(E=re,H):E},H.range=function(re){return arguments.length?(I=_n(re),H):I},H.bins=function(re){return arguments.length?(F="number"==typeof re?function(ue){return Ma(ue,re)}:_n(re),H):F},H.frequency=function(re){return arguments.length?(le=!!re,H):le},H},g.layout.pack=function(){var le,E=g.layout.hierarchy().sort(va),I=0,F=[1,1];function H(re,ue){var ye=E.call(this,re,ue),ke=ye[0],Ee=F[0],Ue=F[1],$e=null==le?Math.sqrt:"function"==typeof le?le:function(){return le};if(ke.x=ke.y=0,un(ke,function(_t){_t.r=+$e(_t.value)}),un(ke,co),I){var it=I*(le?1:Math.max(2*ke.r/Ee,2*ke.r/Ue))/2;un(ke,function(_t){_t.r+=it}),un(ke,co),un(ke,function(_t){_t.r-=it})}return function _t(Ct,At,Et,Tt){var jt=Ct.children;if(Ct.x=At+=Tt*Ct.x,Ct.y=Et+=Tt*Ct.y,Ct.r*=Tt,jt)for(var Nt=-1,Yt=jt.length;++Nt<Yt;)_t(jt[Nt],At,Et,Tt)}(ke,Ee/2,Ue/2,le?1:1/Math.max(2*ke.r/Ee,2*ke.r/Ue)),ye}return H.size=function(re){return arguments.length?(F=re,H):F},H.radius=function(re){return arguments.length?(le=null==re||"function"==typeof re?re:+re,H):le},H.padding=function(re){return arguments.length?(I=+re,H):I},rn(H,E)},g.layout.tree=function(){var le=g.layout.hierarchy().sort(null).value(null),E=mt,I=[1,1],F=null;function H(ke,Ee){var Ue=le.call(this,ke,Ee),$e=Ue[0],it=function(Nt){for(var Yt,ln={A:null,children:[Nt]},bn=[ln];null!=(Yt=bn.pop());)for(var In,En=Yt.children,ir=0,rr=En.length;ir<rr;++ir)bn.push((En[ir]=In={_:En[ir],parent:Yt,children:(In=En[ir].children)&&In.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:ir}).a=In);return ln.children[0]}($e);if(un(it,re),it.parent.m=-it.z,Qt(it,ue),F)Qt($e,ye);else{var _t=$e,Ct=$e,At=$e;Qt($e,function(Nt){Nt.x<_t.x&&(_t=Nt),Nt.x>Ct.x&&(Ct=Nt),Nt.depth>At.depth&&(At=Nt)});var Et=E(_t,Ct)/2-_t.x,Tt=I[0]/(Ct.x+E(Ct,_t)/2+Et),jt=I[1]/(At.depth||1);Qt($e,function(Nt){Nt.x=(Nt.x+Et)*Tt,Nt.y=Nt.depth*jt})}return Ue}function re(ke){var Ee=ke.children,Ue=ke.parent.children,$e=ke.i?Ue[ke.i-1]:null;if(Ee.length){!function(_t){for(var Ct,At=0,Et=0,Tt=_t.children,jt=Tt.length;--jt>=0;)(Ct=Tt[jt]).z+=At,Ct.m+=At,At+=Ct.s+(Et+=Ct.c)}(ke);var it=(Ee[0].z+Ee[Ee.length-1].z)/2;$e?(ke.z=$e.z+E(ke._,$e._),ke.m=ke.z-it):ke.z=it}else $e&&(ke.z=$e.z+E(ke._,$e._));ke.parent.A=function(_t,Ct,At){if(Ct){for(var Et,Tt=_t,jt=_t,Nt=Ct,Yt=Tt.parent.children[0],ln=Tt.m,bn=jt.m,In=Nt.m,En=Yt.m;Nt=pn(Nt),Tt=Bt(Tt),Nt&&Tt;)Yt=Bt(Yt),(jt=pn(jt)).a=_t,(Et=Nt.z+In-Tt.z-ln+E(Nt._,Tt._))>0&&(Xt(dn(Nt,_t,At),_t,Et),ln+=Et,bn+=Et),In+=Nt.m,ln+=Tt.m,En+=Yt.m,bn+=jt.m;Nt&&!pn(jt)&&(jt.t=Nt,jt.m+=In-bn),Tt&&!Bt(Yt)&&(Yt.t=Tt,Yt.m+=ln-En,At=_t)}return At}(ke,$e,ke.parent.A||Ue[0])}function ue(ke){ke._.x=ke.z+ke.parent.m,ke.m+=ke.parent.m}function ye(ke){ke.x*=I[0],ke.y=ke.depth*I[1]}return H.separation=function(ke){return arguments.length?(E=ke,H):E},H.size=function(ke){return arguments.length?(F=null==(I=ke)?ye:null,H):F?null:I},H.nodeSize=function(ke){return arguments.length?(F=null==(I=ke)?null:ye,H):F?I:null},rn(H,le)},g.layout.cluster=function(){var le=g.layout.hierarchy().sort(null).value(null),E=mt,I=[1,1],F=!1;function H(re,ue){var ye,ke=le.call(this,re,ue),Ee=ke[0],Ue=0;un(Ee,function(At){var Tt,Et=At.children;Et&&Et.length?(At.x=(Tt=Et).reduce(function(jt,Nt){return jt+Nt.x},0)/Tt.length,At.y=function(Tt){return 1+g.max(Tt,function(jt){return jt.y})}(Et)):(At.x=ye?Ue+=E(At,ye):0,At.y=0,ye=At)});var $e=function At(Et){var Tt=Et.children;return Tt&&Tt.length?At(Tt[0]):Et}(Ee),it=function At(Et){var Tt,jt=Et.children;return jt&&(Tt=jt.length)?At(jt[Tt-1]):Et}(Ee),_t=$e.x-E($e,it)/2,Ct=it.x+E(it,$e)/2;return un(Ee,F?function(At){At.x=(At.x-Ee.x)*I[0],At.y=(Ee.y-At.y)*I[1]}:function(At){At.x=(At.x-_t)/(Ct-_t)*I[0],At.y=(1-(Ee.y?At.y/Ee.y:1))*I[1]}),ke}return H.separation=function(re){return arguments.length?(E=re,H):E},H.size=function(re){return arguments.length?(F=null==(I=re),H):F?null:I},H.nodeSize=function(re){return arguments.length?(F=null!=(I=re),H):F?I:null},rn(H,le)},g.layout.treemap=function(){var le,E=g.layout.hierarchy(),I=Math.round,F=[1,1],H=null,re=Fn,ue=!1,ye="squarify",ke=.5*(1+Math.sqrt(5));function Ee(At,Et){for(var Tt,jt,Nt=-1,Yt=At.length;++Nt<Yt;)jt=(Tt=At[Nt]).value*(Et<0?0:Et),Tt.area=isNaN(jt)||jt<=0?0:jt}function Ue(At){var Et=At.children;if(Et&&Et.length){var Tt,jt,Nt,Yt=re(At),ln=[],bn=Et.slice(),In=1/0,En="slice"===ye?Yt.dx:"dice"===ye?Yt.dy:"slice-dice"===ye?1&At.depth?Yt.dy:Yt.dx:Math.min(Yt.dx,Yt.dy);for(Ee(bn,Yt.dx*Yt.dy/At.value),ln.area=0;(Nt=bn.length)>0;)ln.push(Tt=bn[Nt-1]),ln.area+=Tt.area,"squarify"!==ye||(jt=it(ln,En))<=In?(bn.pop(),In=jt):(ln.area-=ln.pop().area,_t(ln,En,Yt,!1),En=Math.min(Yt.dx,Yt.dy),ln.length=ln.area=0,In=1/0);ln.length&&(_t(ln,En,Yt,!0),ln.length=ln.area=0),Et.forEach(Ue)}}function $e(At){var Et=At.children;if(Et&&Et.length){var Tt,jt=re(At),Nt=Et.slice(),Yt=[];for(Ee(Nt,jt.dx*jt.dy/At.value),Yt.area=0;Tt=Nt.pop();)Yt.push(Tt),Yt.area+=Tt.area,null!=Tt.z&&(_t(Yt,Tt.z?jt.dx:jt.dy,jt,!Nt.length),Yt.length=Yt.area=0);Et.forEach($e)}}function it(At,Et){for(var Tt,jt=At.area,Nt=0,Yt=1/0,ln=-1,bn=At.length;++ln<bn;)(Tt=At[ln].area)&&(Tt<Yt&&(Yt=Tt),Tt>Nt&&(Nt=Tt));return Et*=Et,(jt*=jt)?Math.max(Et*Nt*ke/jt,jt/(Et*Yt*ke)):1/0}function _t(At,Et,Tt,jt){var Nt,Yt=-1,ln=At.length,bn=Tt.x,In=Tt.y,En=Et?I(At.area/Et):0;if(Et==Tt.dx){for((jt||En>Tt.dy)&&(En=Tt.dy);++Yt<ln;)(Nt=At[Yt]).x=bn,Nt.y=In,Nt.dy=En,bn+=Nt.dx=Math.min(Tt.x+Tt.dx-bn,En?I(Nt.area/En):0);Nt.z=!0,Nt.dx+=Tt.x+Tt.dx-bn,Tt.y+=En,Tt.dy-=En}else{for((jt||En>Tt.dx)&&(En=Tt.dx);++Yt<ln;)(Nt=At[Yt]).x=bn,Nt.y=In,Nt.dx=En,In+=Nt.dy=Math.min(Tt.y+Tt.dy-In,En?I(Nt.area/En):0);Nt.z=!1,Nt.dy+=Tt.y+Tt.dy-In,Tt.x+=En,Tt.dx-=En}}function Ct(At){var Et=le||E(At),Tt=Et[0];return Tt.x=Tt.y=0,Tt.value?(Tt.dx=F[0],Tt.dy=F[1]):Tt.dx=Tt.dy=0,le&&E.revalue(Tt),Ee([Tt],Tt.dx*Tt.dy/Tt.value),(le?$e:Ue)(Tt),ue&&(le=Et),Et}return Ct.size=function(At){return arguments.length?(F=At,Ct):F},Ct.padding=function(At){if(!arguments.length)return H;function Et(Nt){var Yt=At.call(Ct,Nt,Nt.depth);return null==Yt?Fn(Nt):Zn(Nt,"number"==typeof Yt?[Yt,Yt,Yt,Yt]:Yt)}function Tt(Nt){return Zn(Nt,At)}var jt;return re=null==(H=At)?Fn:"function"==(jt=typeof At)?Et:("number"===jt&&(At=[At,At,At,At]),Tt),Ct},Ct.round=function(At){return arguments.length?(I=At?Math.round:Number,Ct):I!=Number},Ct.sticky=function(At){return arguments.length?(ue=At,le=null,Ct):ue},Ct.ratio=function(At){return arguments.length?(ke=At,Ct):ke},Ct.mode=function(At){return arguments.length?(ye=At+"",Ct):ye},rn(Ct,E)},g.random={normal:function(le,E){var I=arguments.length;return I<2&&(E=1),I<1&&(le=0),function(){var F,H,re;do{re=(F=2*Math.random()-1)*F+(H=2*Math.random()-1)*H}while(!re||re>1);return le+E*F*Math.sqrt(-2*Math.log(re)/re)}},logNormal:function(){var le=g.random.normal.apply(g,arguments);return function(){return Math.exp(le())}},bates:function(le){var E=g.random.irwinHall(le);return function(){return E()/le}},irwinHall:function(le){return function(){for(var E=0,I=0;I<le;I++)E+=Math.random();return E}}},g.scale={};var xr={floor:C,ceil:C};function Dr(le,E,I,F){var H=[],re=[],ue=0,ye=Math.min(le.length,E.length)-1;for(le[ye]<le[0]&&(le=le.slice().reverse(),E=E.slice().reverse());++ue<=ye;)H.push(I(le[ue-1],le[ue])),re.push(F(E[ue-1],E[ue]));return function(ke){var Ee=g.bisect(le,ke,1,ye)-1;return re[Ee](H[Ee](ke))}}function Zr(le,E){return g.rebind(le,E,"range","rangeRound","interpolate","clamp")}function ei(le,E){return Tr(le,Ir(yi(le,E)[2])),Tr(le,Ir(yi(le,E)[2])),le}function yi(le,E){null==E&&(E=10);var I=er(le),F=I[1]-I[0],H=Math.pow(10,Math.floor(Math.log(F/E)/Math.LN10)),re=E/F*H;return re<=.15?H*=10:re<=.35?H*=5:re<=.75&&(H*=2),I[0]=Math.ceil(I[0]/H)*H,I[1]=Math.floor(I[1]/H)*H+.5*H,I[2]=H,I}function nr(le,E){return g.range.apply(g,yi(le,E))}g.scale.linear=function(){return function le(E,I,F,H){var re,ue;function ye(){var Ee=Math.min(E.length,I.length)>2?Dr:gr,Ue=H?zo:ms;return re=Ee(E,I,Ue,F),ue=Ee(I,E,Ue,Wa),ke}function ke(Ee){return re(Ee)}return ke.invert=function(Ee){return ue(Ee)},ke.domain=function(Ee){return arguments.length?(E=Ee.map(Number),ye()):E},ke.range=function(Ee){return arguments.length?(I=Ee,ye()):I},ke.rangeRound=function(Ee){return ke.range(Ee).interpolate(qo)},ke.clamp=function(Ee){return arguments.length?(H=Ee,ye()):H},ke.interpolate=function(Ee){return arguments.length?(F=Ee,ye()):F},ke.ticks=function(Ee){return nr(E,Ee)},ke.tickFormat=function(Ee,Ue){return d3_scale_linearTickFormat(E,Ee,Ue)},ke.nice=function(Ee){return ei(E,Ee),ye()},ke.copy=function(){return le(E,I,F,H)},ye()}([0,1],[0,1],Wa,!1)},g.scale.log=function(){return function le(E,I,F,H){function re(ke){return(F?Math.log(ke<0?0:ke):-Math.log(ke>0?0:-ke))/Math.log(I)}function ue(ke){return F?Math.pow(I,ke):-Math.pow(I,-ke)}function ye(ke){return E(re(ke))}return ye.invert=function(ke){return ue(E.invert(ke))},ye.domain=function(ke){return arguments.length?(F=ke[0]>=0,E.domain((H=ke.map(Number)).map(re)),ye):H},ye.base=function(ke){return arguments.length?(I=+ke,E.domain(H.map(re)),ye):I},ye.nice=function(){var ke=Tr(H.map(re),F?Math:mi);return E.domain(ke),H=ke.map(ue),ye},ye.ticks=function(){var ke=er(H),Ee=[],Ue=ke[0],$e=ke[1],it=Math.floor(re(Ue)),_t=Math.ceil(re($e)),Ct=I%1?2:I;if(isFinite(_t-it)){if(F){for(;it<_t;it++)for(var At=1;At<Ct;At++)Ee.push(ue(it)*At);Ee.push(ue(it))}else for(Ee.push(ue(it));it++<_t;)for(At=Ct-1;At>0;At--)Ee.push(ue(it)*At);for(it=0;Ee[it]<Ue;it++);for(_t=Ee.length;Ee[_t-1]>$e;_t--);Ee=Ee.slice(it,_t)}return Ee},ye.copy=function(){return le(E.copy(),I,F,H)},Zr(ye,E)}(g.scale.linear().domain([0,1]),10,!0,[1,10])};var mi={floor:function(le){return-Math.ceil(-le)},ceil:function(le){return-Math.floor(-le)}};function Hr(le){return function(E){return E<0?-Math.pow(-E,le):Math.pow(E,le)}}g.scale.pow=function(){return function le(E,I,F){var H=Hr(I),re=Hr(1/I);function ue(ye){return E(H(ye))}return ue.invert=function(ye){return re(E.invert(ye))},ue.domain=function(ye){return arguments.length?(E.domain((F=ye.map(Number)).map(H)),ue):F},ue.ticks=function(ye){return nr(F,ye)},ue.tickFormat=function(ye,ke){return d3_scale_linearTickFormat(F,ye,ke)},ue.nice=function(ye){return ue.domain(ei(F,ye))},ue.exponent=function(ye){return arguments.length?(H=Hr(I=ye),re=Hr(1/I),E.domain(F.map(H)),ue):I},ue.copy=function(){return le(E.copy(),I,F)},Zr(ue,E)}(g.scale.linear(),1,[0,1])},g.scale.sqrt=function(){return g.scale.pow().exponent(.5)},g.scale.ordinal=function(){return function le(E,I){var F,H,re;function ue(ke){return H[((F.get(ke)||("range"===I.t?F.set(ke,E.push(ke)):NaN))-1)%H.length]}function ye(ke,Ee){return g.range(E.length).map(function(Ue){return ke+Ee*Ue})}return ue.domain=function(ke){if(!arguments.length)return E;E=[],F=new _;for(var Ee,Ue=-1,$e=ke.length;++Ue<$e;)F.has(Ee=ke[Ue])||F.set(Ee,E.push(Ee));return ue[I.t].apply(ue,I.a)},ue.range=function(ke){return arguments.length?(H=ke,re=0,I={t:"range",a:arguments},ue):H},ue.rangePoints=function(ke,Ee){arguments.length<2&&(Ee=0);var Ue=ke[0],$e=ke[1],it=E.length<2?(Ue=(Ue+$e)/2,0):($e-Ue)/(E.length-1+Ee);return H=ye(Ue+it*Ee/2,it),re=0,I={t:"rangePoints",a:arguments},ue},ue.rangeRoundPoints=function(ke,Ee){arguments.length<2&&(Ee=0);var Ue=ke[0],$e=ke[1],it=E.length<2?(Ue=$e=Math.round((Ue+$e)/2),0):($e-Ue)/(E.length-1+Ee)|0;return H=ye(Ue+Math.round(it*Ee/2+($e-Ue-(E.length-1+Ee)*it)/2),it),re=0,I={t:"rangeRoundPoints",a:arguments},ue},ue.rangeBands=function(ke,Ee,Ue){arguments.length<2&&(Ee=0),arguments.length<3&&(Ue=Ee);var $e=ke[1]<ke[0],it=ke[$e-0],Ct=(ke[1-$e]-it)/(E.length-Ee+2*Ue);return H=ye(it+Ct*Ue,Ct),$e&&H.reverse(),re=Ct*(1-Ee),I={t:"rangeBands",a:arguments},ue},ue.rangeRoundBands=function(ke,Ee,Ue){arguments.length<2&&(Ee=0),arguments.length<3&&(Ue=Ee);var $e=ke[1]<ke[0],it=ke[$e-0],_t=ke[1-$e],Ct=Math.floor((_t-it)/(E.length-Ee+2*Ue));return H=ye(it+Math.round((_t-it-(E.length-Ee)*Ct)/2),Ct),$e&&H.reverse(),re=Math.round(Ct*(1-Ee)),I={t:"rangeRoundBands",a:arguments},ue},ue.rangeBand=function(){return re},ue.rangeExtent=function(){return er(I.a[0])},ue.copy=function(){return le(E,I)},ue.domain(E)}([],{t:"range",a:[[]]})},g.scale.category10=function(){return g.scale.ordinal().range(Jr)},g.scale.category20=function(){return g.scale.ordinal().range(di)},g.scale.category20b=function(){return g.scale.ordinal().range(Pi)},g.scale.category20c=function(){return g.scale.ordinal().range(Vi)};var Jr=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Kt),di=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Kt),Pi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Kt),Vi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Kt);function Br(){return 0}g.scale.quantile=function(){return function le(E,I){var F;function H(){var ue=0,ye=I.length;for(F=[];++ue<ye;)F[ue-1]=g.quantile(E,ue/ye);return re}function re(ue){if(!isNaN(ue=+ue))return I[g.bisect(F,ue)]}return re.domain=function(ue){return arguments.length?(E=ue.map(f).filter(l).sort(s),H()):E},re.range=function(ue){return arguments.length?(I=ue,H()):I},re.quantiles=function(){return F},re.invertExtent=function(ue){return(ue=I.indexOf(ue))<0?[NaN,NaN]:[ue>0?F[ue-1]:E[0],ue<F.length?F[ue]:E[E.length-1]]},re.copy=function(){return le(E,I)},H()}([],[])},g.scale.quantize=function(){return function le(E,I,F){var H,re;function ue(ke){return F[Math.max(0,Math.min(re,Math.floor(H*(ke-E))))]}function ye(){return H=F.length/(I-E),re=F.length-1,ue}return ue.domain=function(ke){return arguments.length?(E=+ke[0],I=+ke[ke.length-1],ye()):[E,I]},ue.range=function(ke){return arguments.length?(F=ke,ye()):F},ue.invertExtent=function(ke){return[ke=(ke=F.indexOf(ke))<0?NaN:ke/H+E,ke+1/H]},ue.copy=function(){return le(E,I,F)},ye()}(0,1,[0,1])},g.scale.threshold=function(){return function le(E,I){function F(H){if(H<=H)return I[g.bisect(E,H)]}return F.domain=function(H){return arguments.length?(E=H,F):E},F.range=function(H){return arguments.length?(I=H,F):I},F.invertExtent=function(H){return H=I.indexOf(H),[E[H-1],E[H]]},F.copy=function(){return le(E,I)},F}([.5],[0,1])},g.scale.identity=function(){return function le(E){function I(F){return+F}return I.invert=I,I.domain=I.range=function(F){return arguments.length?(E=F.map(I),I):E},I.ticks=function(F){return nr(E,F)},I.tickFormat=function(F,H){return d3_scale_linearTickFormat(E,F,H)},I.copy=function(){return le(E)},I}([0,1])},g.svg={},g.svg.arc=function(){var le=Ui,E=Mi,I=Br,F=Wi,H=Ji,re=Bi,ue=ua;function ye(){var Ee=Math.max(0,+le.apply(this,arguments)),Ue=Math.max(0,+E.apply(this,arguments)),$e=H.apply(this,arguments)-Jt,it=re.apply(this,arguments)-Jt,_t=Math.abs(it-$e),Ct=$e>it?0:1;if(Ue<Ee&&(At=Ue,Ue=Ee,Ee=At),_t>=en)return ke(Ue,Ct)+(Ee?ke(Ee,1-Ct):"")+"Z";var At,Et,Tt,jt,Nt,Yt,ln,bn,In,En,ir,rr,_r=0,pr=0,Qr=[];if((jt=(+ue.apply(this,arguments)||0)/2)&&(Tt=F===Wi?Math.sqrt(Ee*Ee+Ue*Ue):+F.apply(this,arguments),Ct||(pr*=-1),Ue&&(pr=je(Tt/Ue*Math.sin(jt))),Ee&&(_r=je(Tt/Ee*Math.sin(jt)))),Ue){Nt=Ue*Math.cos($e+pr),Yt=Ue*Math.sin($e+pr),ln=Ue*Math.cos(it-pr),bn=Ue*Math.sin(it-pr);var li=Math.abs(it-$e-2*pr)<=Vt?0:1;if(pr&&gi(Nt,Yt,ln,bn)===Ct^li){var xi=($e+it)/2;Nt=Ue*Math.cos(xi),Yt=Ue*Math.sin(xi),ln=bn=null}}else Nt=Yt=0;if(Ee){In=Ee*Math.cos(it-_r),En=Ee*Math.sin(it-_r),ir=Ee*Math.cos($e+_r),rr=Ee*Math.sin($e+_r);var Wn=Math.abs($e-it+2*_r)<=Vt?0:1;if(_r&&gi(In,En,ir,rr)===1-Ct^Wn){var Rr=($e+it)/2;In=Ee*Math.cos(Rr),En=Ee*Math.sin(Rr),ir=rr=null}}else In=En=0;if(_t>yt&&(At=Math.min(Math.abs(Ue-Ee)/2,+I.apply(this,arguments)))>.001){Et=Ee<Ue^Ct?0:1;var oi=At,ti=At;if(_t<Vt){var vi=null==ir?[In,En]:null==ln?[Nt,Yt]:Lr([Nt,Yt],[ir,rr],[ln,bn],[In,En]),ki=Nt-vi[0],ji=Yt-vi[1],ui=ln-vi[0],Oi=bn-vi[1],zi=1/Math.sin(Math.acos((ki*ui+ji*Oi)/(Math.sqrt(ki*ki+ji*ji)*Math.sqrt(ui*ui+Oi*Oi)))/2),qi=Math.sqrt(vi[0]*vi[0]+vi[1]*vi[1]);ti=Math.min(At,(Ee-qi)/(zi-1)),oi=Math.min(At,(Ue-qi)/(zi+1))}if(null!=ln){var Ii=aa(null==ir?[In,En]:[ir,rr],[Nt,Yt],Ue,oi,Ct),Hi=aa([ln,bn],[In,En],Ue,oi,Ct);At===oi?Qr.push("M",Ii[0],"A",oi,",",oi," 0 0,",Et," ",Ii[1],"A",Ue,",",Ue," 0 ",1-Ct^gi(Ii[1][0],Ii[1][1],Hi[1][0],Hi[1][1]),",",Ct," ",Hi[1],"A",oi,",",oi," 0 0,",Et," ",Hi[0]):Qr.push("M",Ii[0],"A",oi,",",oi," 0 1,",Et," ",Hi[0])}else Qr.push("M",Nt,",",Yt);if(null!=ir){var na=aa([Nt,Yt],[ir,rr],Ee,-ti,Ct),Ca=aa([In,En],null==ln?[Nt,Yt]:[ln,bn],Ee,-ti,Ct);At===ti?Qr.push("L",Ca[0],"A",ti,",",ti," 0 0,",Et," ",Ca[1],"A",Ee,",",Ee," 0 ",Ct^gi(Ca[1][0],Ca[1][1],na[1][0],na[1][1]),",",1-Ct," ",na[1],"A",ti,",",ti," 0 0,",Et," ",na[0]):Qr.push("L",Ca[0],"A",ti,",",ti," 0 0,",Et," ",na[0])}else Qr.push("L",In,",",En)}else Qr.push("M",Nt,",",Yt),null!=ln&&Qr.push("A",Ue,",",Ue," 0 ",li,",",Ct," ",ln,",",bn),Qr.push("L",In,",",En),null!=ir&&Qr.push("A",Ee,",",Ee," 0 ",Wn,",",1-Ct," ",ir,",",rr);return Qr.push("Z"),Qr.join("")}function ke(Ee,Ue){return"M0,"+Ee+"A"+Ee+","+Ee+" 0 1,"+Ue+" 0,"+-Ee+"A"+Ee+","+Ee+" 0 1,"+Ue+" 0,"+Ee}return ye.innerRadius=function(Ee){return arguments.length?(le=_n(Ee),ye):le},ye.outerRadius=function(Ee){return arguments.length?(E=_n(Ee),ye):E},ye.cornerRadius=function(Ee){return arguments.length?(I=_n(Ee),ye):I},ye.padRadius=function(Ee){return arguments.length?(F=Ee==Wi?Wi:_n(Ee),ye):F},ye.startAngle=function(Ee){return arguments.length?(H=_n(Ee),ye):H},ye.endAngle=function(Ee){return arguments.length?(re=_n(Ee),ye):re},ye.padAngle=function(Ee){return arguments.length?(ue=_n(Ee),ye):ue},ye.centroid=function(){var Ee=(+le.apply(this,arguments)+ +E.apply(this,arguments))/2,Ue=(+H.apply(this,arguments)+ +re.apply(this,arguments))/2-Jt;return[Math.cos(Ue)*Ee,Math.sin(Ue)*Ee]},ye};var Wi="auto";function Ui(le){return le.innerRadius}function Mi(le){return le.outerRadius}function Ji(le){return le.startAngle}function Bi(le){return le.endAngle}function ua(le){return le&&le.padAngle}function gi(le,E,I,F){return(le-I)*E-(E-F)*le>0?0:1}function aa(le,E,I,F,H){var re=le[0]-E[0],ue=le[1]-E[1],ye=(H?F:-F)/Math.sqrt(re*re+ue*ue),ke=ye*ue,Ee=-ye*re,Ue=le[0]+ke,$e=le[1]+Ee,it=E[0]+ke,_t=E[1]+Ee,Ct=(Ue+it)/2,At=($e+_t)/2,Et=it-Ue,Tt=_t-$e,jt=Et*Et+Tt*Tt,Nt=I-F,Yt=Ue*_t-it*$e,ln=(Tt<0?-1:1)*Math.sqrt(Math.max(0,Nt*Nt*jt-Yt*Yt)),bn=(Yt*Tt-Et*ln)/jt,In=(-Yt*Et-Tt*ln)/jt,En=(Yt*Tt+Et*ln)/jt,ir=(-Yt*Et+Tt*ln)/jt,rr=bn-Ct,_r=In-At,pr=En-Ct,Qr=ir-At;return rr*rr+_r*_r>pr*pr+Qr*Qr&&(bn=En,In=ir),[[bn-ke,In-Ee],[bn*I/Nt,In*I/Nt]]}function Qa(){return!0}function Jo(le){var E=Yn,I=ar,F=Qa,H=To,re=H.key,ue=.7;function ye(ke){var Ee,Ue=[],$e=[],it=-1,_t=ke.length,Ct=_n(E),At=_n(I);function Et(){Ue.push("M",H(le($e),ue))}for(;++it<_t;)F.call(this,Ee=ke[it],it)?$e.push([+Ct.call(this,Ee,it),+At.call(this,Ee,it)]):$e.length&&(Et(),$e=[]);return $e.length&&Et(),Ue.length?Ue.join(""):null}return ye.x=function(ke){return arguments.length?(E=ke,ye):E},ye.y=function(ke){return arguments.length?(I=ke,ye):I},ye.defined=function(ke){return arguments.length?(F=ke,ye):F},ye.interpolate=function(ke){return arguments.length?(re="function"==typeof ke?H=ke:(H=jo.get(ke)||To).key,ye):re},ye.tension=function(ke){return arguments.length?(ue=ke,ye):ue},ye}g.svg.line=function(){return Jo(C)};var jo=g.map({linear:To,"linear-closed":Ei,step:function(le){for(var E=0,I=le.length,F=le[0],H=[F[0],",",F[1]];++E<I;)H.push("H",(F[0]+(F=le[E])[0])/2,"V",F[1]);return I>1&&H.push("H",F[0]),H.join("")},"step-before":ka,"step-after":ko,basis:eo,"basis-open":function(le){if(le.length<4)return To(le);for(var E,I=[],F=-1,H=le.length,re=[0],ue=[0];++F<3;)re.push((E=le[F])[0]),ue.push(E[1]);for(I.push(pa(ho,re)+","+pa(ho,ue)),--F;++F<H;)E=le[F],re.shift(),re.push(E[0]),ue.shift(),ue.push(E[1]),cs(I,re,ue);return I.join("")},"basis-closed":function(le){for(var E,I,F=-1,H=le.length,re=H+4,ue=[],ye=[];++F<4;)ue.push((I=le[F%H])[0]),ye.push(I[1]);for(E=[pa(ho,ue),",",pa(ho,ye)],--F;++F<re;)I=le[F%H],ue.shift(),ue.push(I[0]),ye.shift(),ye.push(I[1]),cs(E,ue,ye);return E.join("")},bundle:function(le,E){var I=le.length-1;if(I)for(var F,H,re=le[0][0],ue=le[0][1],ye=le[I][0]-re,ke=le[I][1]-ue,Ee=-1;++Ee<=I;)(F=le[Ee])[0]=E*F[0]+(1-E)*(re+(H=Ee/I)*ye),F[1]=E*F[1]+(1-E)*(ue+H*ke);return eo(le)},cardinal:function(le,E){return le.length<3?To(le):le[0]+oa(le,Pa(le,E))},"cardinal-open":function(le,E){return le.length<4?To(le):le[1]+oa(le.slice(1,-1),Pa(le,E))},"cardinal-closed":function(le,E){return le.length<3?Ei(le):le[0]+oa((le.push(le[0]),le),Pa([le[le.length-2]].concat(le,[le[1]]),E))},monotone:function(le){return le.length<3?To(le):le[0]+oa(le,function(E){for(var I,F,H,re,ue=[],ye=function(Ue){for(var $e=0,it=Ue.length-1,_t=[],Ct=Ue[0],At=Ue[1],Et=_t[0]=rs(Ct,At);++$e<it;)_t[$e]=(Et+(Et=rs(Ct=At,At=Ue[$e+1])))/2;return _t[$e]=Et,_t}(E),ke=-1,Ee=E.length-1;++ke<Ee;)I=rs(E[ke],E[ke+1]),a(I)<yt?ye[ke]=ye[ke+1]=0:(re=(F=ye[ke]/I)*F+(H=ye[ke+1]/I)*H)>9&&(re=3*I/Math.sqrt(re),ye[ke]=re*F,ye[ke+1]=re*H);for(ke=-1;++ke<=Ee;)re=(E[Math.min(Ee,ke+1)][0]-E[Math.max(0,ke-1)][0])/(6*(1+ye[ke]*ye[ke])),ue.push([re||0,ye[ke]*re||0]);return ue}(le))}});function To(le){return le.length>1?le.join("L"):le+"Z"}function Ei(le){return le.join("L")+"Z"}function ka(le){for(var E=0,I=le.length,F=le[0],H=[F[0],",",F[1]];++E<I;)H.push("V",(F=le[E])[1],"H",F[0]);return H.join("")}function ko(le){for(var E=0,I=le.length,F=le[0],H=[F[0],",",F[1]];++E<I;)H.push("H",(F=le[E])[0],"V",F[1]);return H.join("")}function oa(le,E){if(E.length<1||le.length!=E.length&&le.length!=E.length+2)return To(le);var I=le.length!=E.length,F="",H=le[0],re=le[1],ue=E[0],ye=ue,ke=1;if(I&&(F+="Q"+(re[0]-2*ue[0]/3)+","+(re[1]-2*ue[1]/3)+","+re[0]+","+re[1],H=le[1],ke=2),E.length>1){re=le[ke],ke++,F+="C"+(H[0]+ue[0])+","+(H[1]+ue[1])+","+(re[0]-(ye=E[1])[0])+","+(re[1]-ye[1])+","+re[0]+","+re[1];for(var Ee=2;Ee<E.length;Ee++,ke++)F+="S"+((re=le[ke])[0]-(ye=E[Ee])[0])+","+(re[1]-ye[1])+","+re[0]+","+re[1]}if(I){var Ue=le[ke];F+="Q"+(re[0]+2*ye[0]/3)+","+(re[1]+2*ye[1]/3)+","+Ue[0]+","+Ue[1]}return F}function Pa(le,E){for(var I,F=[],H=(1-E)/2,re=le[0],ue=le[1],ye=1,ke=le.length;++ye<ke;)I=re,re=ue,F.push([H*((ue=le[ye])[0]-I[0]),H*(ue[1]-I[1])]);return F}function eo(le){if(le.length<3)return To(le);var E=1,I=le.length,F=le[0],H=F[0],re=F[1],ue=[H,H,H,(F=le[1])[0]],ye=[re,re,re,F[1]],ke=[H,",",re,"L",pa(ho,ue),",",pa(ho,ye)];for(le.push(le[I-1]);++E<=I;)F=le[E],ue.shift(),ue.push(F[0]),ye.shift(),ye.push(F[1]),cs(ke,ue,ye);return le.pop(),ke.push("L",F),ke.join("")}function pa(le,E){return le[0]*E[0]+le[1]*E[1]+le[2]*E[2]+le[3]*E[3]}jo.forEach(function(le,E){E.key=le,E.closed=/-closed$/.test(le)});var xo=[0,2/3,1/3,0],fa=[0,1/3,2/3,0],ho=[0,1/6,2/3,1/6];function cs(le,E,I){le.push("C",pa(xo,E),",",pa(xo,I),",",pa(fa,E),",",pa(fa,I),",",pa(ho,E),",",pa(ho,I))}function rs(le,E){return(E[1]-le[1])/(E[0]-le[0])}function Es(le){for(var E,I,F,H=-1,re=le.length;++H<re;)I=(E=le[H])[0],F=E[1]-Jt,E[0]=I*Math.cos(F),E[1]=I*Math.sin(F);return le}function ja(le){var E=Yn,I=Yn,F=0,H=ar,re=Qa,ue=To,ye=ue.key,ke=ue,Ee="L",Ue=.7;function $e(it){var _t,Ct,At,Et=[],Tt=[],jt=[],Nt=-1,Yt=it.length,ln=_n(E),bn=_n(F),In=E===I?function(){return Ct}:_n(I),En=F===H?function(){return At}:_n(H);function ir(){Et.push("M",ue(le(jt),Ue),Ee,ke(le(Tt.reverse()),Ue),"Z")}for(;++Nt<Yt;)re.call(this,_t=it[Nt],Nt)?(Tt.push([Ct=+ln.call(this,_t,Nt),At=+bn.call(this,_t,Nt)]),jt.push([+In.call(this,_t,Nt),+En.call(this,_t,Nt)])):Tt.length&&(ir(),Tt=[],jt=[]);return Tt.length&&ir(),Et.length?Et.join(""):null}return $e.x=function(it){return arguments.length?(E=I=it,$e):I},$e.x0=function(it){return arguments.length?(E=it,$e):E},$e.x1=function(it){return arguments.length?(I=it,$e):I},$e.y=function(it){return arguments.length?(F=H=it,$e):H},$e.y0=function(it){return arguments.length?(F=it,$e):F},$e.y1=function(it){return arguments.length?(H=it,$e):H},$e.defined=function(it){return arguments.length?(re=it,$e):re},$e.interpolate=function(it){return arguments.length?(ye="function"==typeof it?ue=it:(ue=jo.get(it)||To).key,ke=ue.reverse||ue,Ee=ue.closed?"M":"L",$e):ye},$e.tension=function(it){return arguments.length?(Ue=it,$e):Ue},$e}function Ls(le){return le.source}function Ua(le){return le.target}function is(le){return le.radius}function Ti(le){return[le.x,le.y]}function Li(le){return function(){var E=le.apply(this,arguments),I=E[0],F=E[1]-Jt;return[I*Math.cos(F),I*Math.sin(F)]}}function zs(){return 64}function Ps(){return"circle"}function as(le){var E=Math.sqrt(le/Vt);return"M0,"+E+"A"+E+","+E+" 0 1,1 0,"+-E+"A"+E+","+E+" 0 1,1 0,"+E+"Z"}g.svg.line.radial=function(){var le=Jo(Es);return le.radius=le.x,delete le.x,le.angle=le.y,delete le.y,le},ka.reverse=ko,ko.reverse=ka,g.svg.area=function(){return ja(C)},g.svg.area.radial=function(){var le=ja(Es);return le.radius=le.x,delete le.x,le.innerRadius=le.x0,delete le.x0,le.outerRadius=le.x1,delete le.x1,le.angle=le.y,delete le.y,le.startAngle=le.y0,delete le.y0,le.endAngle=le.y1,delete le.y1,le},g.svg.chord=function(){var le=Ls,E=Ua,I=is,F=Ji,H=Bi;function re(Ee,Ue){var $e,it,_t=ue(this,le,Ee,Ue),Ct=ue(this,E,Ee,Ue);return"M"+_t.p0+ye(_t.r,_t.p1,_t.a1-_t.a0)+(($e=_t).a0==(it=Ct).a0&&$e.a1==it.a1?ke(0,0,0,_t.p0):ke(0,0,0,Ct.p0)+ye(Ct.r,Ct.p1,Ct.a1-Ct.a0)+ke(0,0,0,_t.p0))+"Z"}function ue(Ee,Ue,$e,it){var _t=Ue.call(Ee,$e,it),Ct=I.call(Ee,_t,it),At=F.call(Ee,_t,it)-Jt,Et=H.call(Ee,_t,it)-Jt;return{r:Ct,a0:At,a1:Et,p0:[Ct*Math.cos(At),Ct*Math.sin(At)],p1:[Ct*Math.cos(Et),Ct*Math.sin(Et)]}}function ye(Ee,Ue,$e){return"A"+Ee+","+Ee+" 0 "+ +($e>Vt)+",1 "+Ue}function ke(Ee,Ue,$e,it){return"Q 0,0 "+it}return re.radius=function(Ee){return arguments.length?(I=_n(Ee),re):I},re.source=function(Ee){return arguments.length?(le=_n(Ee),re):le},re.target=function(Ee){return arguments.length?(E=_n(Ee),re):E},re.startAngle=function(Ee){return arguments.length?(F=_n(Ee),re):F},re.endAngle=function(Ee){return arguments.length?(H=_n(Ee),re):H},re},g.svg.diagonal=function(){var le=Ls,E=Ua,I=Ti;function F(H,re){var ue=le.call(this,H,re),ye=E.call(this,H,re),ke=(ue.y+ye.y)/2,Ee=[ue,{x:ue.x,y:ke},{x:ye.x,y:ke},ye];return"M"+(Ee=Ee.map(I))[0]+"C"+Ee[1]+" "+Ee[2]+" "+Ee[3]}return F.source=function(H){return arguments.length?(le=_n(H),F):le},F.target=function(H){return arguments.length?(E=_n(H),F):E},F.projection=function(H){return arguments.length?(I=H,F):I},F},g.svg.diagonal.radial=function(){var le=g.svg.diagonal(),E=Ti,I=le.projection;return le.projection=function(F){return arguments.length?I(Li(E=F)):E},le},g.svg.symbol=function(){var le=Ps,E=zs;function I(F,H){return(Oo.get(le.call(this,F,H))||as)(E.call(this,F,H))}return I.type=function(F){return arguments.length?(le=_n(F),I):le},I.size=function(F){return arguments.length?(E=_n(F),I):E},I};var Oo=g.map({circle:as,cross:function(le){var E=Math.sqrt(le/5)/2;return"M"+-3*E+","+-E+"H"+-E+"V"+-3*E+"H"+E+"V"+-E+"H"+3*E+"V"+E+"H"+E+"V"+3*E+"H"+-E+"V"+E+"H"+-3*E+"Z"},diamond:function(le){var E=Math.sqrt(le/(2*Zs)),I=E*Zs;return"M0,"+-E+"L"+I+",0 0,"+E+" "+-I+",0Z"},square:function(le){var E=Math.sqrt(le)/2;return"M"+-E+","+-E+"L"+E+","+-E+" "+E+","+E+" "+-E+","+E+"Z"},"triangle-down":function(le){var E=Math.sqrt(le/Zo),I=E*Zo/2;return"M0,"+I+"L"+E+","+-I+" "+-E+","+-I+"Z"},"triangle-up":function(le){var E=Math.sqrt(le/Zo),I=E*Zo/2;return"M0,"+-I+"L"+E+","+I+" "+-E+","+I+"Z"}});g.svg.symbolTypes=Oo.keys();var Zo=Math.sqrt(3),Zs=Math.tan(30*cn);J.transition=function(le){for(var E,I,F=gs||++Je,H=Be(le),re=[],ue=us||{time:Date.now(),ease:_s,delay:0,duration:250},ye=-1,ke=this.length;++ye<ke;){re.push(E=[]);for(var Ee=this[ye],Ue=-1,$e=Ee.length;++Ue<$e;)(I=Ee[Ue])&&Ft(I,Ue,H,F,ue),E.push(I)}return da(re,H,F)},J.interrupt=function(le){return this.each(null==le?Cs:sa(Be(le)))};var Cs=sa(Be());function sa(le){return function(){var E,I,F;(E=this[le])&&(F=E[I=E.active])&&(F.timer.c=null,F.timer.t=NaN,--E.count?delete E[I]:delete this[le],E.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function da(le,E,I){return N(le,Na),le.namespace=E,le.id=I,le}var gs,us,Na=[],Je=0;function Dt(le,E,I,F){var H=le.id,re=le.namespace;return Oe(le,"function"==typeof I?function(ue,ye,ke){ue[re][H].tween.set(E,F(I.call(ue,ue.__data__,ye,ke)))}:(I=F(I),function(ue){ue[re][H].tween.set(E,I)}))}function _e(le){return null==le&&(le=""),function(){this.textContent=le}}function Be(le){return null==le?"__transition__":"__transition_"+le+"__"}function Ft(le,E,I,F,H){var re,ue,ye,ke,Ee,Ue=le[I]||(le[I]={active:0,count:0}),$e=Ue[F];function it(Ct){var At=Ue.active,Et=Ue[At];for(var Tt in Et&&(Et.timer.c=null,Et.timer.t=NaN,--Ue.count,delete Ue[At],Et.event&&Et.event.interrupt.call(le,le.__data__,Et.index)),Ue)if(+Tt<F){var jt=Ue[Tt];jt.timer.c=null,jt.timer.t=NaN,--Ue.count,delete Ue[Tt]}ue.c=_t,cr(function(){return ue.c&&_t(Ct||1)&&(ue.c=null,ue.t=NaN),1},0,re),Ue.active=F,$e.event&&$e.event.start.call(le,le.__data__,E),Ee=[],$e.tween.forEach(function(Nt,Yt){(Yt=Yt.call(le,le.__data__,E))&&Ee.push(Yt)}),ke=$e.ease,ye=$e.duration}function _t(Ct){for(var At=Ct/ye,Et=ke(At),Tt=Ee.length;Tt>0;)Ee[--Tt].call(le,Et);if(At>=1)return $e.event&&$e.event.end.call(le,le.__data__,E),--Ue.count?delete Ue[F]:delete le[I],1}$e||(ue=cr(function(Ct){var At=$e.delay;if(ue.t=At+re,At<=Ct)return it(Ct-At);ue.c=it},0,re=H.time),$e=Ue[F]={tween:new _,time:re,timer:ue,delay:H.delay,duration:H.duration,ease:H.ease,index:E},H=null,++Ue.count)}Na.call=J.call,Na.empty=J.empty,Na.node=J.node,Na.size=J.size,g.transition=function(le,E){return le&&le.transition?gs?le.transition(E):le:g.selection().transition(le)},g.transition.prototype=Na,Na.select=function(le){var E,I,F,H=this.id,re=this.namespace,ue=[];le=te(le);for(var ye=-1,ke=this.length;++ye<ke;){ue.push(E=[]);for(var Ee=this[ye],Ue=-1,$e=Ee.length;++Ue<$e;)(F=Ee[Ue])&&(I=le.call(F,F.__data__,Ue,ye))?("__data__"in F&&(I.__data__=F.__data__),Ft(I,Ue,re,H,F[re][H]),E.push(I)):E.push(null)}return da(ue,re,H)},Na.selectAll=function(le){var E,I,F,H,re,ue=this.id,ye=this.namespace,ke=[];le=ae(le);for(var Ee=-1,Ue=this.length;++Ee<Ue;)for(var $e=this[Ee],it=-1,_t=$e.length;++it<_t;)if(F=$e[it]){re=F[ye][ue],I=le.call(F,F.__data__,it,Ee),ke.push(E=[]);for(var Ct=-1,At=I.length;++Ct<At;)(H=I[Ct])&&Ft(H,Ct,ye,ue,re),E.push(H)}return da(ke,ye,ue)},Na.filter=function(le){var E,I,F=[];"function"!=typeof le&&(le=Me(le));for(var H=0,re=this.length;H<re;H++){F.push(E=[]);for(var ue,ye=0,ke=(ue=this[H]).length;ye<ke;ye++)(I=ue[ye])&&le.call(I,I.__data__,ye,H)&&E.push(I)}return da(F,this.namespace,this.id)},Na.tween=function(le,E){var I=this.id,F=this.namespace;return arguments.length<2?this.node()[F][I].tween.get(le):Oe(this,null==E?function(H){H[F][I].tween.remove(le)}:function(H){H[F][I].tween.set(le,E)})},Na.attr=function(le,E){if(arguments.length<2){for(E in le)this.attr(E,le[E]);return this}var I="transform"==le?Yo:Wa,F=g.ns.qualify(le);function H(){this.removeAttribute(F)}function re(){this.removeAttributeNS(F.space,F.local)}function ue(ke){return null==ke?H:(ke+="",function(){var Ee,Ue=this.getAttribute(F);return Ue!==ke&&(Ee=I(Ue,ke),function($e){this.setAttribute(F,Ee($e))})})}function ye(ke){return null==ke?re:(ke+="",function(){var Ee,Ue=this.getAttributeNS(F.space,F.local);return Ue!==ke&&(Ee=I(Ue,ke),function($e){this.setAttributeNS(F.space,F.local,Ee($e))})})}return Dt(this,"attr."+le,E,F.local?ye:ue)},Na.attrTween=function(le,E){var I=g.ns.qualify(le);return this.tween("attr."+le,I.local?function(F,H){var re=E.call(this,F,H,this.getAttributeNS(I.space,I.local));return re&&function(ue){this.setAttributeNS(I.space,I.local,re(ue))}}:function(F,H){var re=E.call(this,F,H,this.getAttribute(I));return re&&function(ue){this.setAttribute(I,re(ue))}})},Na.style=function(le,E,I){var F=arguments.length;if(F<3){if("string"!=typeof le){for(I in F<2&&(E=""),le)this.style(I,le[I],E);return this}I=""}function H(){this.style.removeProperty(le)}function re(ue){return null==ue?H:(ue+="",function(){var ye,ke=r(this).getComputedStyle(this,null).getPropertyValue(le);return ke!==ue&&(ye=Wa(ke,ue),function(Ee){this.style.setProperty(le,ye(Ee),I)})})}return Dt(this,"style."+le,E,re)},Na.styleTween=function(le,E,I){function F(H,re){var ue=E.call(this,H,re,r(this).getComputedStyle(this,null).getPropertyValue(le));return ue&&function(ye){this.style.setProperty(le,ue(ye),I)}}return arguments.length<3&&(I=""),this.tween("style."+le,F)},Na.text=function(le){return Dt(this,"text",le,_e)},Na.remove=function(){var le=this.namespace;return this.each("end.transition",function(){var E;this[le].count<2&&(E=this.parentNode)&&E.removeChild(this)})},Na.ease=function(le){var E=this.id,I=this.namespace;return arguments.length<1?this.node()[I][E].ease:("function"!=typeof le&&(le=g.ease.apply(g,arguments)),Oe(this,function(F){F[I][E].ease=le}))},Na.delay=function(le){var E=this.id,I=this.namespace;return arguments.length<1?this.node()[I][E].delay:Oe(this,"function"==typeof le?function(F,H,re){F[I][E].delay=+le.call(F,F.__data__,H,re)}:(le=+le,function(F){F[I][E].delay=le}))},Na.duration=function(le){var E=this.id,I=this.namespace;return arguments.length<1?this.node()[I][E].duration:Oe(this,"function"==typeof le?function(F,H,re){F[I][E].duration=Math.max(1,le.call(F,F.__data__,H,re))}:(le=Math.max(1,le),function(F){F[I][E].duration=le}))},Na.each=function(le,E){var I=this.id,F=this.namespace;if(arguments.length<2){var H=us,re=gs;try{gs=I,Oe(this,function(ue,ye,ke){us=ue[F][I],le.call(ue,ue.__data__,ye,ke)})}finally{us=H,gs=re}}else Oe(this,function(ue){var ye=ue[F][I];(ye.event||(ye.event=g.dispatch("start","end","interrupt"))).on(le,E)});return this},Na.transition=function(){for(var le,E,I,F=this.id,H=++Je,re=this.namespace,ue=[],ye=0,ke=this.length;ye<ke;ye++){ue.push(le=[]);for(var Ee,Ue=0,$e=(Ee=this[ye]).length;Ue<$e;Ue++)(E=Ee[Ue])&&Ft(E,Ue,re,H,{time:(I=E[re][F]).time,ease:I.ease,delay:I.delay+I.duration,duration:I.duration}),le.push(E)}return da(ue,re,H)},g.svg.axis=function(){var le,E=g.scale.linear(),I=Tn,F=6,H=6,re=3,ue=[10],ye=null;function ke(Ee){Ee.each(function(){var Ue,$e=g.select(this),it=this.__chart__||E,_t=this.__chart__=E.copy(),Ct=null==ye?_t.ticks?_t.ticks.apply(_t,ue):_t.domain():ye,At=null==le?_t.tickFormat?_t.tickFormat.apply(_t,ue):C:le,Et=$e.selectAll(".tick").data(Ct,_t),Tt=Et.enter().insert("g",".domain").attr("class","tick").style("opacity",yt),jt=g.transition(Et.exit()).style("opacity",yt).remove(),Nt=g.transition(Et.order()).style("opacity",1),Yt=Math.max(F,0)+re,ln=yr(_t),bn=$e.selectAll(".domain").data([0]),In=(bn.enter().append("path").attr("class","domain"),g.transition(bn));Tt.append("line"),Tt.append("text");var En,ir,rr,_r,pr=Tt.select("line"),Qr=Nt.select("line"),li=Et.select("text").text(At),xi=Tt.select("text"),Wn=Nt.select("text"),Rr="top"===I||"left"===I?-1:1;if("bottom"===I||"top"===I?(Ue=or,En="x",rr="y",ir="x2",_r="y2",li.attr("dy",Rr<0?"0em":".71em").style("text-anchor","middle"),In.attr("d","M"+ln[0]+","+Rr*H+"V0H"+ln[1]+"V"+Rr*H)):(Ue=vr,En="y",rr="x",ir="y2",_r="x2",li.attr("dy",".32em").style("text-anchor",Rr<0?"end":"start"),In.attr("d","M"+Rr*H+","+ln[0]+"H0V"+ln[1]+"H"+Rr*H)),pr.attr(_r,Rr*F),xi.attr(rr,Rr*Yt),Qr.attr(ir,0).attr(_r,Rr*F),Wn.attr(En,0).attr(rr,Rr*Yt),_t.rangeBand){var oi=_t,ti=oi.rangeBand()/2;it=_t=function(vi){return oi(vi)+ti}}else it.rangeBand?it=_t:jt.call(Ue,_t,it);Tt.call(Ue,it,_t),Nt.call(Ue,_t,_t)})}return ke.scale=function(Ee){return arguments.length?(E=Ee,ke):E},ke.orient=function(Ee){return arguments.length?(I=Ee in $n?Ee+"":Tn,ke):I},ke.ticks=function(){return arguments.length?(ue=k(arguments),ke):ue},ke.tickValues=function(Ee){return arguments.length?(ye=Ee,ke):ye},ke.tickFormat=function(Ee){return arguments.length?(le=Ee,ke):le},ke.tickSize=function(Ee){var Ue=arguments.length;return Ue?(F=+Ee,H=+arguments[Ue-1],ke):F},ke.innerTickSize=function(Ee){return arguments.length?(F=+Ee,ke):F},ke.outerTickSize=function(Ee){return arguments.length?(H=+Ee,ke):H},ke.tickPadding=function(Ee){return arguments.length?(re=+Ee,ke):re},ke.tickSubdivide=function(){return arguments.length&&ke},ke};var Tn="bottom",$n={top:1,right:1,bottom:1,left:1};function or(le,E,I){le.attr("transform",function(F){var H=E(F);return"translate("+(isFinite(H)?H:I(F))+",0)"})}function vr(le,E,I){le.attr("transform",function(F){var H=E(F);return"translate(0,"+(isFinite(H)?H:I(F))+")"})}g.svg.brush=function(){var le,E,I=ne(Ue,"brushstart","brush","brushend"),F=null,H=null,re=[0,0],ue=[0,0],ye=!0,ke=!0,Ee=Or[0];function Ue(At){At.each(function(){var Et=g.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Ct).on("touchstart.brush",Ct),Tt=Et.selectAll(".background").data([0]);Tt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Et.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var jt=Et.selectAll(".resize").data(Ee,C);jt.exit().remove(),jt.enter().append("g").attr("class",function(bn){return"resize "+bn}).style("cursor",function(bn){return ur[bn]}).append("rect").attr("x",function(bn){return/[ew]$/.test(bn)?-3:null}).attr("y",function(bn){return/^[ns]/.test(bn)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),jt.style("display",Ue.empty()?"none":null);var Nt,Yt=g.transition(Et),ln=g.transition(Tt);F&&(Nt=yr(F),ln.attr("x",Nt[0]).attr("width",Nt[1]-Nt[0]),it(Yt)),H&&(Nt=yr(H),ln.attr("y",Nt[0]).attr("height",Nt[1]-Nt[0]),_t(Yt)),$e(Yt)})}function $e(At){At.selectAll(".resize").attr("transform",function(Et){return"translate("+re[+/e$/.test(Et)]+","+ue[+/^s/.test(Et)]+")"})}function it(At){At.select(".extent").attr("x",re[0]),At.selectAll(".extent,.n>rect,.s>rect").attr("width",re[1]-re[0])}function _t(At){At.select(".extent").attr("y",ue[0]),At.selectAll(".extent,.e>rect,.w>rect").attr("height",ue[1]-ue[0])}function Ct(){var At,Et,Tt=this,jt=g.select(g.event.target),Nt=I.of(Tt,arguments),Yt=g.select(Tt),ln=jt.datum(),bn=!/^(n|s)$/.test(ln)&&F,In=!/^(e|w)$/.test(ln)&&H,En=jt.classed("extent"),ir=kt(Tt),rr=g.mouse(Tt),_r=g.select(r(Tt)).on("keydown.brush",li).on("keyup.brush",xi);if(g.event.changedTouches?_r.on("touchmove.brush",Wn).on("touchend.brush",oi):_r.on("mousemove.brush",Wn).on("mouseup.brush",oi),Yt.interrupt().selectAll("*").interrupt(),En)rr[0]=re[0]-rr[0],rr[1]=ue[0]-rr[1];else if(ln){var pr=+/w$/.test(ln),Qr=+/^n/.test(ln);Et=[re[1-pr]-rr[0],ue[1-Qr]-rr[1]],rr[0]=re[pr],rr[1]=ue[Qr]}else g.event.altKey&&(At=rr.slice());function li(){32==g.event.keyCode&&(En||(At=null,rr[0]-=re[1],rr[1]-=ue[1],En=2),G())}function xi(){32==g.event.keyCode&&2==En&&(rr[0]+=re[1],rr[1]+=ue[1],En=0,G())}function Wn(){var ti=g.mouse(Tt),vi=!1;Et&&(ti[0]+=Et[0],ti[1]+=Et[1]),En||(g.event.altKey?(At||(At=[(re[0]+re[1])/2,(ue[0]+ue[1])/2]),rr[0]=re[+(ti[0]<At[0])],rr[1]=ue[+(ti[1]<At[1])]):At=null),bn&&Rr(ti,F,0)&&(it(Yt),vi=!0),In&&Rr(ti,H,1)&&(_t(Yt),vi=!0),vi&&($e(Yt),Nt({type:"brush",mode:En?"move":"resize"}))}function Rr(ti,vi,ki){var ji,ui,Oi=yr(vi),zi=Oi[0],qi=Oi[1],Ii=rr[ki],Hi=ki?ue:re,na=Hi[1]-Hi[0];if(En&&(zi-=Ii,qi-=na+Ii),ji=(ki?ke:ye)?Math.max(zi,Math.min(qi,ti[ki])):ti[ki],En?ui=(ji+=Ii)+na:(At&&(Ii=Math.max(zi,Math.min(qi,2*At[ki]-ji))),Ii<ji?(ui=ji,ji=Ii):ui=Ii),Hi[0]!=ji||Hi[1]!=ui)return ki?E=null:le=null,Hi[0]=ji,Hi[1]=ui,!0}function oi(){Wn(),Yt.style("pointer-events","all").selectAll(".resize").style("display",Ue.empty()?"none":null),g.select("body").style("cursor",null),_r.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),ir(),Nt({type:"brushend"})}Yt.style("pointer-events","none").selectAll(".resize").style("display",null),g.select("body").style("cursor",jt.style("cursor")),Nt({type:"brushstart"}),Wn()}return Ue.event=function(At){At.each(function(){var Et=I.of(this,arguments),Tt={x:re,y:ue,i:le,j:E},jt=this.__chart__||Tt;this.__chart__=Tt,gs?g.select(this).transition().each("start.brush",function(){le=jt.i,E=jt.j,re=jt.x,ue=jt.y,Et({type:"brushstart"})}).tween("brush:brush",function(){var Nt=xa(re,Tt.x),Yt=xa(ue,Tt.y);return le=E=null,function(ln){re=Tt.x=Nt(ln),ue=Tt.y=Yt(ln),Et({type:"brush",mode:"resize"})}}).each("end.brush",function(){le=Tt.i,E=Tt.j,Et({type:"brush",mode:"resize"}),Et({type:"brushend"})}):(Et({type:"brushstart"}),Et({type:"brush",mode:"resize"}),Et({type:"brushend"}))})},Ue.x=function(At){return arguments.length?(Ee=Or[!(F=At)<<1|!H],Ue):F},Ue.y=function(At){return arguments.length?(Ee=Or[!F<<1|!(H=At)],Ue):H},Ue.clamp=function(At){return arguments.length?(F&&H?(ye=!!At[0],ke=!!At[1]):F?ye=!!At:H&&(ke=!!At),Ue):F&&H?[ye,ke]:F?ye:H?ke:null},Ue.extent=function(At){var Et,Tt,jt,Nt,Yt;return arguments.length?(F&&(Et=At[0],Tt=At[1],H&&(Et=Et[0],Tt=Tt[0]),le=[Et,Tt],F.invert&&(Et=F(Et),Tt=F(Tt)),Tt<Et&&(Yt=Et,Et=Tt,Tt=Yt),Et==re[0]&&Tt==re[1]||(re=[Et,Tt])),H&&(jt=At[0],Nt=At[1],F&&(jt=jt[1],Nt=Nt[1]),E=[jt,Nt],H.invert&&(jt=H(jt),Nt=H(Nt)),Nt<jt&&(Yt=jt,jt=Nt,Nt=Yt),jt==ue[0]&&Nt==ue[1]||(ue=[jt,Nt])),Ue):(F&&(le?(Et=le[0],Tt=le[1]):(Et=re[0],Tt=re[1],F.invert&&(Et=F.invert(Et),Tt=F.invert(Tt)),Tt<Et&&(Yt=Et,Et=Tt,Tt=Yt))),H&&(E?(jt=E[0],Nt=E[1]):(jt=ue[0],Nt=ue[1],H.invert&&(jt=H.invert(jt),Nt=H.invert(Nt)),Nt<jt&&(Yt=jt,jt=Nt,Nt=Yt))),F&&H?[[Et,jt],[Tt,Nt]]:F?[Et,Tt]:H&&[jt,Nt])},Ue.clear=function(){return Ue.empty()||(re=[0,0],ue=[0,0],le=E=null),Ue},Ue.empty=function(){return!!F&&re[0]==re[1]||!!H&&ue[0]==ue[1]},g.rebind(Ue,I,"on")};var ur={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Or=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function Nr(le){return JSON.parse(le.responseText)}function ii(le){var E=x.createRange();return E.selectNode(x.body),E.createContextualFragment(le.responseText)}g.text=Pn(function(le){return le.responseText}),g.json=function(le,E){return Rn(le,"application/json",Nr,E)},g.html=function(le,E){return Rn(le,"text/html",ii,E)},g.xml=Pn(function(le){return le.responseXML}),"object"==typeof Q&&Q.exports?Q.exports=g:this.d3=g}).apply(self)},{}],59:[function(v,Q,$){"use strict";Q.exports=v("./quad")},{"./quad":60}],60:[function(v,Q,$){"use strict";var g=v("binary-search-bounds"),t=v("clamp"),k=v("parse-rect"),x=v("array-bounds"),e=v("pick-by-alias"),r=v("defined"),i=v("flatten-vertex-data"),c=v("is-obj"),n=v("dtype"),m=v("math-log2");function p(s,f){for(var l=f[0],o=f[1],d=1/(f[2]-l),u=1/(f[3]-o),a=new Array(s.length),y=0,h=s.length/2;y<h;y++)a[2*y]=t((s[2*y]-l)*d,0,1),a[2*y+1]=t((s[2*y+1]-o)*u,0,1);return a}Q.exports=function(s,f){f||(f={}),s=i(s,"float64"),f=e(f,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var l=r(f.maxDepth,255),o=r(f.bounds,x(s,2));o[0]===o[2]&&o[2]++,o[1]===o[3]&&o[3]++;var d,u=p(s,o),a=s.length>>>1;f.dtype||(f.dtype="array"),"string"==typeof f.dtype?d=new(n(f.dtype))(a):f.dtype&&(d=f.dtype,Array.isArray(d)&&(d.length=a));for(var y=0;y<a;++y)d[y]=y;var h=[],_=[],b=[],w=[];!function D(j,q,Z,W,G,X){if(!W.length)return null;var ne=h[G]||(h[G]=[]),V=b[G]||(b[G]=[]),N=_[G]||(_[G]=[]),U=ne.length;if(++G>l||X>1073741824){for(var ee=0;ee<W.length;ee++)ne.push(W[ee]),V.push(X),N.push(null,null,null,null);return U}if(ne.push(W[0]),V.push(X),W.length<=1)return N.push(null,null,null,null),U;for(var B=.5*Z,K=j+B,J=q+B,te=[],ae=[],ce=[],oe=[],ve=1,fe=W.length;ve<fe;ve++){var xe=W[ve],pe=u[2*xe+1];u[2*xe]<K?pe<J?te.push(xe):ae.push(xe):pe<J?ce.push(xe):oe.push(xe)}return N.push(D(j,q,B,te,G,X<<=2),D(j,J,B,ae,G,X+1),D(K,q,B,ce,G,X+2),D(K,J,B,oe,G,X+3)),U}(0,0,1,d,0,1);for(var T=0,L=0;L<h.length;L++){var M=h[L];if(d.set)d.set(M,T);else for(var P=0,z=M.length;P<z;P++)d[P+T]=M[P];var S=T+h[L].length;w[L]=[T,S],T=S}return d.range=function(){for(var D,j=[],q=arguments.length;q--;)j[q]=arguments[q];if(c(j[j.length-1])){var Z=j.pop();j.length||null==Z.x&&null==Z.l&&null==Z.left||(j=[Z],D={}),D=e(Z,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else D={};j.length||(j=o);var ae,W=k.apply(void 0,j),G=[Math.min(W.x,W.x+W.width),Math.min(W.y,W.y+W.height),Math.max(W.x,W.x+W.width),Math.max(W.y,W.y+W.height)],X=G[0],ne=G[1],V=G[2],N=G[3],U=p([X,ne,V,N],o),ee=U[0],B=U[1],K=U[2],J=U[3],te=r(D.level,h.length);if(null!=D.d&&("number"==typeof D.d?ae=[D.d,D.d]:D.d.length&&(ae=D.d),te=Math.min(Math.max(Math.ceil(-m(Math.abs(ae[0])/(o[2]-o[0]))),Math.ceil(-m(Math.abs(ae[1])/(o[3]-o[1])))),te)),te=Math.min(te,h.length),D.lod)return C(ee,B,K,J,te);var ce=[];function oe(fe,xe,Se,pe,ge,Te){if(null!==ge&&null!==Te&&!(ee>fe+Se||B>xe+Se||K<fe||J<xe||pe>=te||ge===Te)){var se=h[pe];void 0===Te&&(Te=se.length);for(var de=ge;de<Te;de++){var Ae=se[de],Le=s[2*Ae],Me=s[2*Ae+1];Le>=X&&Le<=V&&Me>=ne&&Me<=N&&ce.push(Ae)}var De=_[pe],Oe=De[4*ge+0],Ie=De[4*ge+1],Qe=De[4*ge+2],Ne=De[4*ge+3],Pe=ve(De,ge+1),Re=.5*Se,Ge=pe+1;oe(fe,xe,Re,Ge,Oe,Ie||Qe||Ne||Pe),oe(fe,xe+Re,Re,Ge,Ie,Qe||Ne||Pe),oe(fe+Re,xe,Re,Ge,Qe,Ne||Pe),oe(fe+Re,xe+Re,Re,Ge,Ne,Pe)}}function ve(fe,xe){for(var Se=null,pe=0;null===Se;)if(Se=fe[4*xe+pe],++pe>fe.length)return null;return Se}return oe(0,0,1,0,0,1),ce},d;function C(D,j,q,Z,W){for(var G=[],X=0;X<W;X++){var ne=b[X],V=w[X][0],N=R(D,j,X),U=R(q,Z,X),ee=g.ge(ne,N),B=g.gt(ne,U,ee,ne.length-1);G[X]=[ee+V,B+V]}return G}function R(D,j,q){for(var Z=1,W=.5,G=.5,X=.5,ne=0;ne<q;ne++)Z<<=2,Z+=D<W?j<G?0:1:j<G?2:3,X*=.5,W+=D<W?-X:X,G+=j<G?-X:X;return Z}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(v,Q,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var g=v("@turf/meta");function t(e){var r=0;if(e&&e.length>0){r+=Math.abs(k(e[0]));for(var i=1;i<e.length;i++)r-=Math.abs(k(e[i]))}return r}function k(e){var r,i,c,n,m,p,s=0,f=e.length;if(f>2){for(p=0;p<f;p++)p===f-2?(c=f-2,n=f-1,m=0):p===f-1?(c=f-1,n=0,m=1):(c=p,n=p+1,m=p+2),r=e[c],i=e[n],s+=(x(e[m][0])-x(r[0]))*Math.sin(x(i[1]));s=6378137*s*6378137/2}return s}function x(e){return e*Math.PI/180}$.default=function(e){return g.geomReduce(e,function(r,i){return r+function(c){var n,m=0;switch(c.type){case"Polygon":return t(c.coordinates);case"MultiPolygon":for(n=0;n<c.coordinates.length;n++)m+=t(c.coordinates[n]);return m;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(i)},0)}},{"@turf/meta":63}],62:[function(v,Q,$){"use strict";function g(f,l,o){void 0===o&&(o={});var d={type:"Feature"};return(0===o.id||o.id)&&(d.id=o.id),o.bbox&&(d.bbox=o.bbox),d.properties=l||{},d.geometry=f,d}function t(f,l,o){if(void 0===o&&(o={}),!f)throw new Error("coordinates is required");if(!Array.isArray(f))throw new Error("coordinates must be an Array");if(f.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!s(f[0])||!s(f[1]))throw new Error("coordinates must contain numbers");return g({type:"Point",coordinates:f},l,o)}function k(f,l,o){void 0===o&&(o={});for(var d=0,u=f;d<u.length;d++){var a=u[d];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var y=0;y<a[a.length-1].length;y++)if(a[a.length-1][y]!==a[0][y])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:f},l,o)}function x(f,l,o){if(void 0===o&&(o={}),f.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:f},l,o)}function e(f,l){void 0===l&&(l={});var o={type:"FeatureCollection"};return l.id&&(o.id=l.id),l.bbox&&(o.bbox=l.bbox),o.features=f,o}function r(f,l,o){return void 0===o&&(o={}),g({type:"MultiLineString",coordinates:f},l,o)}function i(f,l,o){return void 0===o&&(o={}),g({type:"MultiPoint",coordinates:f},l,o)}function c(f,l,o){return void 0===o&&(o={}),g({type:"MultiPolygon",coordinates:f},l,o)}function n(f,l){void 0===l&&(l="kilometers");var o=$.factors[l];if(!o)throw new Error(l+" units is invalid");return f*o}function m(f,l){void 0===l&&(l="kilometers");var o=$.factors[l];if(!o)throw new Error(l+" units is invalid");return f/o}function p(f){return f%(2*Math.PI)*180/Math.PI}function s(f){return!isNaN(f)&&null!==f&&!Array.isArray(f)}Object.defineProperty($,"__esModule",{value:!0}),$.earthRadius=6371008.8,$.factors={centimeters:100*$.earthRadius,centimetres:100*$.earthRadius,degrees:$.earthRadius/111325,feet:3.28084*$.earthRadius,inches:39.37*$.earthRadius,kilometers:$.earthRadius/1e3,kilometres:$.earthRadius/1e3,meters:$.earthRadius,metres:$.earthRadius,miles:$.earthRadius/1609.344,millimeters:1e3*$.earthRadius,millimetres:1e3*$.earthRadius,nauticalmiles:$.earthRadius/1852,radians:1,yards:1.0936*$.earthRadius},$.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/$.earthRadius,yards:1.0936133},$.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},$.feature=g,$.geometry=function(f,l,o){switch(void 0===o&&(o={}),f){case"Point":return t(l).geometry;case"LineString":return x(l).geometry;case"Polygon":return k(l).geometry;case"MultiPoint":return i(l).geometry;case"MultiLineString":return r(l).geometry;case"MultiPolygon":return c(l).geometry;default:throw new Error(f+" is invalid")}},$.point=t,$.points=function(f,l,o){return void 0===o&&(o={}),e(f.map(function(d){return t(d,l)}),o)},$.polygon=k,$.polygons=function(f,l,o){return void 0===o&&(o={}),e(f.map(function(d){return k(d,l)}),o)},$.lineString=x,$.lineStrings=function(f,l,o){return void 0===o&&(o={}),e(f.map(function(d){return x(d,l)}),o)},$.featureCollection=e,$.multiLineString=r,$.multiPoint=i,$.multiPolygon=c,$.geometryCollection=function(f,l,o){return void 0===o&&(o={}),g({type:"GeometryCollection",geometries:f},l,o)},$.round=function(f,l){if(void 0===l&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var o=Math.pow(10,l||0);return Math.round(f*o)/o},$.radiansToLength=n,$.lengthToRadians=m,$.lengthToDegrees=function(f,l){return p(m(f,l))},$.bearingToAzimuth=function(f){var l=f%360;return l<0&&(l+=360),l},$.radiansToDegrees=p,$.degreesToRadians=function(f){return f%360*Math.PI/180},$.convertLength=function(f,l,o){if(void 0===l&&(l="kilometers"),void 0===o&&(o="kilometers"),!(f>=0))throw new Error("length must be a positive number");return n(m(f,l),o)},$.convertArea=function(f,l,o){if(void 0===l&&(l="meters"),void 0===o&&(o="kilometers"),!(f>=0))throw new Error("area must be a positive number");var d=$.areaFactors[l];if(!d)throw new Error("invalid original units");var u=$.areaFactors[o];if(!u)throw new Error("invalid final units");return f/d*u},$.isNumber=s,$.isObject=function(f){return!!f&&f.constructor===Object},$.validateBBox=function(f){if(!f)throw new Error("bbox is required");if(!Array.isArray(f))throw new Error("bbox must be an Array");if(4!==f.length&&6!==f.length)throw new Error("bbox must be an Array of 4 or 6 numbers");f.forEach(function(l){if(!s(l))throw new Error("bbox must only contain numbers")})},$.validateId=function(f){if(!f)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof f))throw new Error("id must be a number or a string")}},{}],63:[function(v,Q,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var g=v("@turf/helpers");function t(n,m,p){if(null!==n)for(var s,f,l,o,d,u,a,y,h=0,_=0,b=n.type,w="FeatureCollection"===b,T="Feature"===b,L=w?n.features.length:1,M=0;M<L;M++){d=(y=!!(a=w?n.features[M].geometry:T?n.geometry:n)&&"GeometryCollection"===a.type)?a.geometries.length:1;for(var P=0;P<d;P++){var z=0,S=0;if(null!==(o=y?a.geometries[P]:a)){u=o.coordinates;var C=o.type;switch(h=!p||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===m(u,_,M,z,S))return!1;_++,z++;break;case"LineString":case"MultiPoint":for(s=0;s<u.length;s++){if(!1===m(u[s],_,M,z,S))return!1;_++,"MultiPoint"===C&&z++}"LineString"===C&&z++;break;case"Polygon":case"MultiLineString":for(s=0;s<u.length;s++){for(f=0;f<u[s].length-h;f++){if(!1===m(u[s][f],_,M,z,S))return!1;_++}"MultiLineString"===C&&z++,"Polygon"===C&&S++}"Polygon"===C&&z++;break;case"MultiPolygon":for(s=0;s<u.length;s++){for(S=0,f=0;f<u[s].length;f++){for(l=0;l<u[s][f].length-h;l++){if(!1===m(u[s][f][l],_,M,z,S))return!1;_++}S++}z++}break;case"GeometryCollection":for(s=0;s<o.geometries.length;s++)if(!1===t(o.geometries[s],m,p))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function k(n,m){var p;switch(n.type){case"FeatureCollection":for(p=0;p<n.features.length&&!1!==m(n.features[p].properties,p);p++);break;case"Feature":m(n.properties,0)}}function x(n,m){if("Feature"===n.type)m(n,0);else if("FeatureCollection"===n.type)for(var p=0;p<n.features.length&&!1!==m(n.features[p],p);p++);}function e(n,m){var p,s,f,l,o,d,u,a,y,h,_=0,b="FeatureCollection"===n.type,w="Feature"===n.type,T=b?n.features.length:1;for(p=0;p<T;p++){for(a=b?n.features[p].properties:w?n.properties:{},y=b?n.features[p].bbox:w?n.bbox:void 0,h=b?n.features[p].id:w?n.id:void 0,o=(u=!!(d=b?n.features[p].geometry:w?n.geometry:n)&&"GeometryCollection"===d.type)?d.geometries.length:1,f=0;f<o;f++)if(null!==(l=u?d.geometries[f]:d))switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===m(l,_,a,y,h))return!1;break;case"GeometryCollection":for(s=0;s<l.geometries.length;s++)if(!1===m(l.geometries[s],_,a,y,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===m(null,_,a,y,h))return!1;_++}}function r(n,m){e(n,function(p,s,f,l,o){var d,u=null===p?null:p.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==m(g.feature(p,f,{bbox:l,id:o}),s,0)&&void 0}switch(u){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon"}for(var a=0;a<p.coordinates.length;a++)if(!1===m(g.feature({type:d,coordinates:p.coordinates[a]},f),s,a))return!1})}function i(n,m){r(n,function(p,s,f){var l=0;if(p.geometry){var o=p.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var d,u=0,a=0,y=0;return!1!==t(p,function(h,_,b,w,T){if(void 0===d||s>u||w>a||T>y)return d=h,u=s,a=w,y=T,void(l=0);var L=g.lineString([d,h],p.properties);if(!1===m(L,s,f,T,l))return!1;l++,d=h})&&void 0}}})}function c(n,m){if(!n)throw new Error("geojson is required");r(n,function(p,s,f){if(null!==p.geometry){var o=p.geometry.coordinates;switch(p.geometry.type){case"LineString":if(!1===m(p,s,f,0,0))return!1;break;case"Polygon":for(var d=0;d<o.length;d++)if(!1===m(g.lineString(o[d],p.properties),s,f,d))return!1}}})}$.coordEach=t,$.coordReduce=function(n,m,p,s){var f=p;return t(n,function(l,o,d,u,a){f=0===o&&void 0===p?l:m(f,l,o,d,u,a)},s),f},$.propEach=k,$.propReduce=function(n,m,p){var s=p;return k(n,function(f,l){s=0===l&&void 0===p?f:m(s,f,l)}),s},$.featureEach=x,$.featureReduce=function(n,m,p){var s=p;return x(n,function(f,l){s=0===l&&void 0===p?f:m(s,f,l)}),s},$.coordAll=function(n){var m=[];return t(n,function(p){m.push(p)}),m},$.geomEach=e,$.geomReduce=function(n,m,p){var s=p;return e(n,function(f,l,o,d,u){s=0===l&&void 0===p?f:m(s,f,l,o,d,u)}),s},$.flattenEach=r,$.flattenReduce=function(n,m,p){var s=p;return r(n,function(f,l,o){s=0===l&&0===o&&void 0===p?f:m(s,f,l,o)}),s},$.segmentEach=i,$.segmentReduce=function(n,m,p){var s=p,f=!1;return i(n,function(l,o,d,u,a){s=!1===f&&void 0===p?l:m(s,l,o,d,u,a),f=!0}),s},$.lineEach=c,$.lineReduce=function(n,m,p){var s=p;return c(n,function(f,l,o,d){s=0===l&&void 0===p?f:m(s,f,l,o,d)}),s},$.findSegment=function(n,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var p,s=m.featureIndex||0,f=m.multiFeatureIndex||0,l=m.geometryIndex||0,o=m.segmentIndex||0,d=m.properties;switch(n.type){case"FeatureCollection":s<0&&(s=n.features.length+s),d=d||n.features[s].properties,p=n.features[s].geometry;break;case"Feature":d=d||n.properties,p=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":p=n;break;default:throw new Error("geojson is invalid")}if(null===p)return null;var u=p.coordinates;switch(p.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=u.length+o-1),g.lineString([u[o],u[o+1]],d,m);case"Polygon":return l<0&&(l=u.length+l),o<0&&(o=u[l].length+o-1),g.lineString([u[l][o],u[l][o+1]],d,m);case"MultiLineString":return f<0&&(f=u.length+f),o<0&&(o=u[f].length+o-1),g.lineString([u[f][o],u[f][o+1]],d,m);case"MultiPolygon":return f<0&&(f=u.length+f),l<0&&(l=u[f].length+l),o<0&&(o=u[f][l].length-o-1),g.lineString([u[f][l][o],u[f][l][o+1]],d,m)}throw new Error("geojson is invalid")},$.findPoint=function(n,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var p,s=m.featureIndex||0,f=m.multiFeatureIndex||0,l=m.geometryIndex||0,o=m.coordIndex||0,d=m.properties;switch(n.type){case"FeatureCollection":s<0&&(s=n.features.length+s),d=d||n.features[s].properties,p=n.features[s].geometry;break;case"Feature":d=d||n.properties,p=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":p=n;break;default:throw new Error("geojson is invalid")}if(null===p)return null;var u=p.coordinates;switch(p.type){case"Point":return g.point(u,d,m);case"MultiPoint":return f<0&&(f=u.length+f),g.point(u[f],d,m);case"LineString":return o<0&&(o=u.length+o),g.point(u[o],d,m);case"Polygon":return l<0&&(l=u.length+l),o<0&&(o=u[l].length+o),g.point(u[l][o],d,m);case"MultiLineString":return f<0&&(f=u.length+f),o<0&&(o=u[f].length+o),g.point(u[f][o],d,m);case"MultiPolygon":return f<0&&(f=u.length+f),l<0&&(l=u[f].length+l),o<0&&(o=u[f][l].length-o),g.point(u[f][l][o],d,m)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(v,Q,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var g=v("@turf/meta");function t(k){var x=[1/0,1/0,-1/0,-1/0];return g.coordEach(k,function(e){x[0]>e[0]&&(x[0]=e[0]),x[1]>e[1]&&(x[1]=e[1]),x[2]<e[0]&&(x[2]=e[0]),x[3]<e[1]&&(x[3]=e[1])}),x}t.default=t,$.default=t},{"@turf/meta":66}],65:[function(v,Q,$){arguments[4][62][0].apply($,arguments)},{dup:62}],66:[function(v,Q,$){arguments[4][63][0].apply($,arguments)},{"@turf/helpers":65,dup:63}],67:[function(v,Q,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var g=v("@turf/meta"),t=v("@turf/helpers");$.default=function(k,x){void 0===x&&(x={});var e=0,r=0,i=0;return g.coordEach(k,function(c){e+=c[0],r+=c[1],i++}),t.point([e/i,r/i],x.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(v,Q,$){"use strict";function g(f,l,o){void 0===o&&(o={});var d={type:"Feature"};return(0===o.id||o.id)&&(d.id=o.id),o.bbox&&(d.bbox=o.bbox),d.properties=l||{},d.geometry=f,d}function t(f,l,o){return void 0===o&&(o={}),g({type:"Point",coordinates:f},l,o)}function k(f,l,o){void 0===o&&(o={});for(var d=0,u=f;d<u.length;d++){var a=u[d];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var y=0;y<a[a.length-1].length;y++)if(a[a.length-1][y]!==a[0][y])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:f},l,o)}function x(f,l,o){if(void 0===o&&(o={}),f.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:f},l,o)}function e(f,l){void 0===l&&(l={});var o={type:"FeatureCollection"};return l.id&&(o.id=l.id),l.bbox&&(o.bbox=l.bbox),o.features=f,o}function r(f,l,o){return void 0===o&&(o={}),g({type:"MultiLineString",coordinates:f},l,o)}function i(f,l,o){return void 0===o&&(o={}),g({type:"MultiPoint",coordinates:f},l,o)}function c(f,l,o){return void 0===o&&(o={}),g({type:"MultiPolygon",coordinates:f},l,o)}function n(f,l){void 0===l&&(l="kilometers");var o=$.factors[l];if(!o)throw new Error(l+" units is invalid");return f*o}function m(f,l){void 0===l&&(l="kilometers");var o=$.factors[l];if(!o)throw new Error(l+" units is invalid");return f/o}function p(f){return f%(2*Math.PI)*180/Math.PI}function s(f){return!isNaN(f)&&null!==f&&!Array.isArray(f)&&!/^\s*$/.test(f)}Object.defineProperty($,"__esModule",{value:!0}),$.earthRadius=6371008.8,$.factors={centimeters:100*$.earthRadius,centimetres:100*$.earthRadius,degrees:$.earthRadius/111325,feet:3.28084*$.earthRadius,inches:39.37*$.earthRadius,kilometers:$.earthRadius/1e3,kilometres:$.earthRadius/1e3,meters:$.earthRadius,metres:$.earthRadius,miles:$.earthRadius/1609.344,millimeters:1e3*$.earthRadius,millimetres:1e3*$.earthRadius,nauticalmiles:$.earthRadius/1852,radians:1,yards:$.earthRadius/1.0936},$.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/$.earthRadius,yards:1/1.0936},$.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},$.feature=g,$.geometry=function(f,l,o){switch(void 0===o&&(o={}),f){case"Point":return t(l).geometry;case"LineString":return x(l).geometry;case"Polygon":return k(l).geometry;case"MultiPoint":return i(l).geometry;case"MultiLineString":return r(l).geometry;case"MultiPolygon":return c(l).geometry;default:throw new Error(f+" is invalid")}},$.point=t,$.points=function(f,l,o){return void 0===o&&(o={}),e(f.map(function(d){return t(d,l)}),o)},$.polygon=k,$.polygons=function(f,l,o){return void 0===o&&(o={}),e(f.map(function(d){return k(d,l)}),o)},$.lineString=x,$.lineStrings=function(f,l,o){return void 0===o&&(o={}),e(f.map(function(d){return x(d,l)}),o)},$.featureCollection=e,$.multiLineString=r,$.multiPoint=i,$.multiPolygon=c,$.geometryCollection=function(f,l,o){return void 0===o&&(o={}),g({type:"GeometryCollection",geometries:f},l,o)},$.round=function(f,l){if(void 0===l&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var o=Math.pow(10,l||0);return Math.round(f*o)/o},$.radiansToLength=n,$.lengthToRadians=m,$.lengthToDegrees=function(f,l){return p(m(f,l))},$.bearingToAzimuth=function(f){var l=f%360;return l<0&&(l+=360),l},$.radiansToDegrees=p,$.degreesToRadians=function(f){return f%360*Math.PI/180},$.convertLength=function(f,l,o){if(void 0===l&&(l="kilometers"),void 0===o&&(o="kilometers"),!(f>=0))throw new Error("length must be a positive number");return n(m(f,l),o)},$.convertArea=function(f,l,o){if(void 0===l&&(l="meters"),void 0===o&&(o="kilometers"),!(f>=0))throw new Error("area must be a positive number");var d=$.areaFactors[l];if(!d)throw new Error("invalid original units");var u=$.areaFactors[o];if(!u)throw new Error("invalid final units");return f/d*u},$.isNumber=s,$.isObject=function(f){return!!f&&f.constructor===Object},$.validateBBox=function(f){if(!f)throw new Error("bbox is required");if(!Array.isArray(f))throw new Error("bbox must be an Array");if(4!==f.length&&6!==f.length)throw new Error("bbox must be an Array of 4 or 6 numbers");f.forEach(function(l){if(!s(l))throw new Error("bbox must only contain numbers")})},$.validateId=function(f){if(!f)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof f))throw new Error("id must be a number or a string")},$.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},$.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},$.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},$.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},$.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},$.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},$.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(v,Q,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var g=v("@turf/helpers");function t(n,m,p){if(null!==n)for(var s,f,l,o,d,u,a,y,h=0,_=0,b=n.type,w="FeatureCollection"===b,T="Feature"===b,L=w?n.features.length:1,M=0;M<L;M++){d=(y=!!(a=w?n.features[M].geometry:T?n.geometry:n)&&"GeometryCollection"===a.type)?a.geometries.length:1;for(var P=0;P<d;P++){var z=0,S=0;if(null!==(o=y?a.geometries[P]:a)){u=o.coordinates;var C=o.type;switch(h=!p||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===m(u,_,M,z,S))return!1;_++,z++;break;case"LineString":case"MultiPoint":for(s=0;s<u.length;s++){if(!1===m(u[s],_,M,z,S))return!1;_++,"MultiPoint"===C&&z++}"LineString"===C&&z++;break;case"Polygon":case"MultiLineString":for(s=0;s<u.length;s++){for(f=0;f<u[s].length-h;f++){if(!1===m(u[s][f],_,M,z,S))return!1;_++}"MultiLineString"===C&&z++,"Polygon"===C&&S++}"Polygon"===C&&z++;break;case"MultiPolygon":for(s=0;s<u.length;s++){for(S=0,f=0;f<u[s].length;f++){for(l=0;l<u[s][f].length-h;l++){if(!1===m(u[s][f][l],_,M,z,S))return!1;_++}S++}z++}break;case"GeometryCollection":for(s=0;s<o.geometries.length;s++)if(!1===t(o.geometries[s],m,p))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function k(n,m){var p;switch(n.type){case"FeatureCollection":for(p=0;p<n.features.length&&!1!==m(n.features[p].properties,p);p++);break;case"Feature":m(n.properties,0)}}function x(n,m){if("Feature"===n.type)m(n,0);else if("FeatureCollection"===n.type)for(var p=0;p<n.features.length&&!1!==m(n.features[p],p);p++);}function e(n,m){var p,s,f,l,o,d,u,a,y,h,_=0,b="FeatureCollection"===n.type,w="Feature"===n.type,T=b?n.features.length:1;for(p=0;p<T;p++){for(a=b?n.features[p].properties:w?n.properties:{},y=b?n.features[p].bbox:w?n.bbox:void 0,h=b?n.features[p].id:w?n.id:void 0,o=(u=!!(d=b?n.features[p].geometry:w?n.geometry:n)&&"GeometryCollection"===d.type)?d.geometries.length:1,f=0;f<o;f++)if(null!==(l=u?d.geometries[f]:d))switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===m(l,_,a,y,h))return!1;break;case"GeometryCollection":for(s=0;s<l.geometries.length;s++)if(!1===m(l.geometries[s],_,a,y,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===m(null,_,a,y,h))return!1;_++}}function r(n,m){e(n,function(p,s,f,l,o){var d,u=null===p?null:p.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==m(g.feature(p,f,{bbox:l,id:o}),s,0)&&void 0}switch(u){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon"}for(var a=0;a<p.coordinates.length;a++)if(!1===m(g.feature({type:d,coordinates:p.coordinates[a]},f),s,a))return!1})}function i(n,m){r(n,function(p,s,f){var l=0;if(p.geometry){var o=p.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var d,u=0,a=0,y=0;return!1!==t(p,function(h,_,b,w,T){if(void 0===d||s>u||w>a||T>y)return d=h,u=s,a=w,y=T,void(l=0);var L=g.lineString([d,h],p.properties);if(!1===m(L,s,f,T,l))return!1;l++,d=h})&&void 0}}})}function c(n,m){if(!n)throw new Error("geojson is required");r(n,function(p,s,f){if(null!==p.geometry){var o=p.geometry.coordinates;switch(p.geometry.type){case"LineString":if(!1===m(p,s,f,0,0))return!1;break;case"Polygon":for(var d=0;d<o.length;d++)if(!1===m(g.lineString(o[d],p.properties),s,f,d))return!1}}})}$.coordEach=t,$.coordReduce=function(n,m,p,s){var f=p;return t(n,function(l,o,d,u,a){f=0===o&&void 0===p?l:m(f,l,o,d,u,a)},s),f},$.propEach=k,$.propReduce=function(n,m,p){var s=p;return k(n,function(f,l){s=0===l&&void 0===p?f:m(s,f,l)}),s},$.featureEach=x,$.featureReduce=function(n,m,p){var s=p;return x(n,function(f,l){s=0===l&&void 0===p?f:m(s,f,l)}),s},$.coordAll=function(n){var m=[];return t(n,function(p){m.push(p)}),m},$.geomEach=e,$.geomReduce=function(n,m,p){var s=p;return e(n,function(f,l,o,d,u){s=0===l&&void 0===p?f:m(s,f,l,o,d,u)}),s},$.flattenEach=r,$.flattenReduce=function(n,m,p){var s=p;return r(n,function(f,l,o){s=0===l&&0===o&&void 0===p?f:m(s,f,l,o)}),s},$.segmentEach=i,$.segmentReduce=function(n,m,p){var s=p,f=!1;return i(n,function(l,o,d,u,a){s=!1===f&&void 0===p?l:m(s,l,o,d,u,a),f=!0}),s},$.lineEach=c,$.lineReduce=function(n,m,p){var s=p;return c(n,function(f,l,o,d){s=0===l&&void 0===p?f:m(s,f,l,o,d)}),s},$.findSegment=function(n,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var p,s=m.featureIndex||0,f=m.multiFeatureIndex||0,l=m.geometryIndex||0,o=m.segmentIndex||0,d=m.properties;switch(n.type){case"FeatureCollection":s<0&&(s=n.features.length+s),d=d||n.features[s].properties,p=n.features[s].geometry;break;case"Feature":d=d||n.properties,p=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":p=n;break;default:throw new Error("geojson is invalid")}if(null===p)return null;var u=p.coordinates;switch(p.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=u.length+o-1),g.lineString([u[o],u[o+1]],d,m);case"Polygon":return l<0&&(l=u.length+l),o<0&&(o=u[l].length+o-1),g.lineString([u[l][o],u[l][o+1]],d,m);case"MultiLineString":return f<0&&(f=u.length+f),o<0&&(o=u[f].length+o-1),g.lineString([u[f][o],u[f][o+1]],d,m);case"MultiPolygon":return f<0&&(f=u.length+f),l<0&&(l=u[f].length+l),o<0&&(o=u[f][l].length-o-1),g.lineString([u[f][l][o],u[f][l][o+1]],d,m)}throw new Error("geojson is invalid")},$.findPoint=function(n,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var p,s=m.featureIndex||0,f=m.multiFeatureIndex||0,l=m.geometryIndex||0,o=m.coordIndex||0,d=m.properties;switch(n.type){case"FeatureCollection":s<0&&(s=n.features.length+s),d=d||n.features[s].properties,p=n.features[s].geometry;break;case"Feature":d=d||n.properties,p=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":p=n;break;default:throw new Error("geojson is invalid")}if(null===p)return null;var u=p.coordinates;switch(p.type){case"Point":return g.point(u,d,m);case"MultiPoint":return f<0&&(f=u.length+f),g.point(u[f],d,m);case"LineString":return o<0&&(o=u.length+o),g.point(u[o],d,m);case"Polygon":return l<0&&(l=u.length+l),o<0&&(o=u[l].length+o),g.point(u[l][o],d,m);case"MultiLineString":return f<0&&(f=u.length+f),o<0&&(o=u[f].length+o),g.point(u[f][o],d,m);case"MultiPolygon":return f<0&&(f=u.length+f),l<0&&(l=u[f].length+l),o<0&&(o=u[f][l].length-o),g.point(u[f][l][o],d,m)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(v,Q,$){Q.exports=function(g){var t=0,k=0,x=0,e=0;return g.map(function(r){var i=(r=r.slice())[0],c=i.toUpperCase();if(i!=c)switch(r[0]=c,i){case"a":r[6]+=x,r[7]+=e;break;case"v":r[1]+=e;break;case"h":r[1]+=x;break;default:for(var n=1;n<r.length;)r[n++]+=x,r[n++]+=e}switch(c){case"Z":x=t,e=k;break;case"H":x=r[1];break;case"V":e=r[1];break;case"M":x=t=r[1],e=k=r[2];break;default:x=r[r.length-2],e=r[r.length-1]}return r})}},{}],71:[function(v,Q,$){"use strict";Q.exports=function(g,t){if(!g||null==g.length)throw Error("Argument should be an array");t=null==t?1:Math.floor(t);for(var k=Array(2*t),x=0;x<t;x++){for(var e=-1/0,r=1/0,i=x,c=g.length;i<c;i+=t)g[i]>e&&(e=g[i]),g[i]<r&&(r=g[i]);k[x]=r,k[t+x]=e}return k}},{}],72:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){if("function"==typeof Array.prototype.findIndex)return g.findIndex(t,k);if("function"!=typeof t)throw new TypeError("predicate must be a function");var x=Object(g),e=x.length;if(0===e)return-1;for(var r=0;r<e;r++)if(t.call(k,x[r],r,x))return r;return-1}},{}],73:[function(v,Q,$){"use strict";var g=v("array-bounds");Q.exports=function(t,k,x){if(!t||null==t.length)throw Error("Argument should be an array");null==k&&(k=1),null==x&&(x=g(t,k));for(var e=0;e<k;e++){var r=x[k+e],i=x[e],c=e,n=t.length;if(r===1/0&&i===-1/0)for(c=e;c<n;c+=k)t[c]=t[c]===r?1:t[c]===i?0:.5;else if(r===1/0)for(c=e;c<n;c+=k)t[c]=t[c]===r?1:0;else if(i===-1/0)for(c=e;c<n;c+=k)t[c]=t[c]===i?0:1;else{var m=r-i;for(c=e;c<n;c+=k)isNaN(t[c])||(t[c]=0===m?.5:(t[c]-i)/m)}}return t}},{"array-bounds":71}],74:[function(v,Q,$){Q.exports=function(g,t){var k="number"==typeof g,x="number"==typeof t;k&&!x?(t=g,g=0):k||x||(g=0,t=0);var e=(t|=0)-(g|=0);if(e<0)throw new Error("array length must be positive");for(var r=new Array(e),i=0,c=g;i<e;i++,c++)r[i]=c;return r}},{}],75:[function(v,Q,$){(function(g){(function(){"use strict";var t=v("object-assign");function k(w,T){if(w===T)return 0;for(var L=w.length,M=T.length,P=0,z=Math.min(L,M);P<z;++P)if(w[P]!==T[P]){L=w[P],M=T[P];break}return L<M?-1:M<L?1:0}function x(w){return g.Buffer&&"function"==typeof g.Buffer.isBuffer?g.Buffer.isBuffer(w):!(null==w||!w._isBuffer)}var e=v("util/"),r=Object.prototype.hasOwnProperty,i=Array.prototype.slice,c="foo"===function(){}.name;function n(w){return Object.prototype.toString.call(w)}function m(w){return!x(w)&&"function"==typeof g.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(w):!!w&&(w instanceof DataView||!!(w.buffer&&w.buffer instanceof ArrayBuffer)))}var p=Q.exports=u,s=/\s*function\s+([^\(\s]*)\s*/;function f(w){if(e.isFunction(w)){if(c)return w.name;var T=w.toString().match(s);return T&&T[1]}}function l(w,T){return"string"==typeof w?w.length<T?w:w.slice(0,T):w}function o(w){if(c||!e.isFunction(w))return e.inspect(w);var T=f(w);return"[Function"+(T?": "+T:"")+"]"}function d(w,T,L,M,P){throw new p.AssertionError({message:L,actual:w,expected:T,operator:M,stackStartFunction:P})}function u(w,T){w||d(w,!0,T,"==",p.ok)}function a(w,T,L,M){if(w===T)return!0;if(x(w)&&x(T))return 0===k(w,T);if(e.isDate(w)&&e.isDate(T))return w.getTime()===T.getTime();if(e.isRegExp(w)&&e.isRegExp(T))return w.source===T.source&&w.global===T.global&&w.multiline===T.multiline&&w.lastIndex===T.lastIndex&&w.ignoreCase===T.ignoreCase;if(null!==w&&"object"==typeof w||null!==T&&"object"==typeof T){if(m(w)&&m(T)&&n(w)===n(T)&&!(w instanceof Float32Array||w instanceof Float64Array))return 0===k(new Uint8Array(w.buffer),new Uint8Array(T.buffer));if(x(w)!==x(T))return!1;var P=(M=M||{actual:[],expected:[]}).actual.indexOf(w);return-1!==P&&P===M.expected.indexOf(T)||(M.actual.push(w),M.expected.push(T),function(z,S,C,R){if(null==z||null==S)return!1;if(e.isPrimitive(z)||e.isPrimitive(S))return z===S;if(C&&Object.getPrototypeOf(z)!==Object.getPrototypeOf(S))return!1;var D=y(z),j=y(S);if(D&&!j||!D&&j)return!1;if(D)return a(z=i.call(z),S=i.call(S),C);var q,Z,W=b(z),G=b(S);if(W.length!==G.length)return!1;for(W.sort(),G.sort(),Z=W.length-1;Z>=0;Z--)if(W[Z]!==G[Z])return!1;for(Z=W.length-1;Z>=0;Z--)if(!a(z[q=W[Z]],S[q],C,R))return!1;return!0}(w,T,L,M))}return L?w===T:w==T}function y(w){return"[object Arguments]"==Object.prototype.toString.call(w)}function h(w,T){if(!w||!T)return!1;if("[object RegExp]"==Object.prototype.toString.call(T))return T.test(w);try{if(w instanceof T)return!0}catch(L){}return!Error.isPrototypeOf(T)&&!0===T.call({},w)}function _(w,T,L,M){var P;if("function"!=typeof T)throw new TypeError('"block" argument must be a function');"string"==typeof L&&(M=L,L=null),P=function(C){var R;try{C()}catch(D){R=D}return R}(T),M=(L&&L.name?" ("+L.name+").":".")+(M?" "+M:"."),w&&!P&&d(P,L,"Missing expected exception"+M);var z="string"==typeof M,S=!w&&P&&!L;if((!w&&e.isError(P)&&z&&h(P,L)||S)&&d(P,L,"Got unwanted exception"+M),w&&P&&L&&!h(P,L)||!w&&P)throw P}p.AssertionError=function(w){this.name="AssertionError",this.actual=w.actual,this.expected=w.expected,this.operator=w.operator,w.message?(this.message=w.message,this.generatedMessage=!1):(this.message=l(o(this.actual),128)+" "+this.operator+" "+l(o(this.expected),128),this.generatedMessage=!0);var T=w.stackStartFunction||d;if(Error.captureStackTrace)Error.captureStackTrace(this,T);else{var L=new Error;if(L.stack){var M=L.stack,P=f(T),z=M.indexOf("\n"+P);if(z>=0){var S=M.indexOf("\n",z+1);M=M.substring(S+1)}this.stack=M}}},e.inherits(p.AssertionError,Error),p.fail=d,p.ok=u,p.equal=function(w,T,L){w!=T&&d(w,T,L,"==",p.equal)},p.notEqual=function(w,T,L){w==T&&d(w,T,L,"!=",p.notEqual)},p.deepEqual=function(w,T,L){a(w,T,!1)||d(w,T,L,"deepEqual",p.deepEqual)},p.deepStrictEqual=function(w,T,L){a(w,T,!0)||d(w,T,L,"deepStrictEqual",p.deepStrictEqual)},p.notDeepEqual=function(w,T,L){a(w,T,!1)&&d(w,T,L,"notDeepEqual",p.notDeepEqual)},p.notDeepStrictEqual=function w(T,L,M){a(T,L,!0)&&d(T,L,M,"notDeepStrictEqual",w)},p.strictEqual=function(w,T,L){w!==T&&d(w,T,L,"===",p.strictEqual)},p.notStrictEqual=function(w,T,L){w===T&&d(w,T,L,"!==",p.notStrictEqual)},p.throws=function(w,T,L){_(!0,w,T,L)},p.doesNotThrow=function(w,T,L){_(!1,w,T,L)},p.ifError=function(w){if(w)throw w},p.strict=t(function w(T,L){T||d(T,!0,L,"==",w)},p,{equal:p.strictEqual,deepEqual:p.deepStrictEqual,notEqual:p.notStrictEqual,notDeepEqual:p.notDeepStrictEqual}),p.strict.strict=p.strict;var b=Object.keys||function(w){var T=[];for(var L in w)r.call(w,L)&&T.push(L);return T}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":247,"util/":78}],76:[function(v,Q,$){Q.exports="function"==typeof Object.create?function(g,t){g.super_=t,g.prototype=Object.create(t.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:function(g,t){g.super_=t;var k=function(){};k.prototype=t.prototype,g.prototype=new k,g.prototype.constructor=g}},{}],77:[function(v,Q,$){Q.exports=function(g){return g&&"object"==typeof g&&"function"==typeof g.copy&&"function"==typeof g.fill&&"function"==typeof g.readUInt8}},{}],78:[function(v,Q,$){(function(g,t){(function(){var k=/%[sdj%]/g;$.format=function(z){if(!d(z)){for(var S=[],C=0;C<arguments.length;C++)S.push(r(arguments[C]));return S.join(" ")}C=1;for(var R=arguments,D=R.length,j=String(z).replace(k,function(Z){if("%%"===Z)return"%";if(C>=D)return Z;switch(Z){case"%s":return String(R[C++]);case"%d":return Number(R[C++]);case"%j":try{return JSON.stringify(R[C++])}catch(W){return"[Circular]"}default:return Z}}),q=R[C];C<D;q=R[++C])l(q)||!y(q)?j+=" "+q:j+=" "+r(q);return j},$.deprecate=function(z,S){if(u(t.process))return function(){return $.deprecate(z,S).apply(this,arguments)};if(!0===g.noDeprecation)return z;var C=!1;return function(){if(!C){if(g.throwDeprecation)throw new Error(S);g.traceDeprecation?console.trace(S):console.error(S),C=!0}return z.apply(this,arguments)}};var x,e={};function r(z,S){var C={seen:[],stylize:c};return arguments.length>=3&&(C.depth=arguments[2]),arguments.length>=4&&(C.colors=arguments[3]),f(S)?C.showHidden=S:S&&$._extend(C,S),u(C.showHidden)&&(C.showHidden=!1),u(C.depth)&&(C.depth=2),u(C.colors)&&(C.colors=!1),u(C.customInspect)&&(C.customInspect=!0),C.colors&&(C.stylize=i),n(C,z,C.depth)}function i(z,S){var C=r.styles[S];return C?"\x1b["+r.colors[C][0]+"m"+z+"\x1b["+r.colors[C][1]+"m":z}function c(z,S){return z}function n(z,S,C){if(z.customInspect&&S&&b(S.inspect)&&S.inspect!==$.inspect&&(!S.constructor||S.constructor.prototype!==S)){var R=S.inspect(C,z);return d(R)||(R=n(z,R,C)),R}var D=function(V,N){if(u(N))return V.stylize("undefined","undefined");if(d(N)){var U="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return V.stylize(U,"string")}return o(N)?V.stylize(""+N,"number"):f(N)?V.stylize(""+N,"boolean"):l(N)?V.stylize("null","null"):void 0}(z,S);if(D)return D;var N,j=Object.keys(S),q=(N={},j.forEach(function(U,ee){N[U]=!0}),N);if(z.showHidden&&(j=Object.getOwnPropertyNames(S)),_(S)&&(j.indexOf("message")>=0||j.indexOf("description")>=0))return m(S);if(0===j.length){if(b(S))return z.stylize("[Function"+(S.name?": "+S.name:"")+"]","special");if(a(S))return z.stylize(RegExp.prototype.toString.call(S),"regexp");if(h(S))return z.stylize(Date.prototype.toString.call(S),"date");if(_(S))return m(S)}var W,G="",X=!1,ne=["{","}"];return s(S)&&(X=!0,ne=["[","]"]),b(S)&&(G=" [Function"+(S.name?": "+S.name:"")+"]"),a(S)&&(G=" "+RegExp.prototype.toString.call(S)),h(S)&&(G=" "+Date.prototype.toUTCString.call(S)),_(S)&&(G=" "+m(S)),0!==j.length||X&&0!=S.length?C<0?a(S)?z.stylize(RegExp.prototype.toString.call(S),"regexp"):z.stylize("[Object]","special"):(z.seen.push(S),W=X?function(V,N,U,ee,B){for(var K=[],J=0,te=N.length;J<te;++J)P(N,String(J))?K.push(p(V,N,U,ee,String(J),!0)):K.push("");return B.forEach(function(ae){ae.match(/^\d+$/)||K.push(p(V,N,U,ee,ae,!0))}),K}(z,S,C,q,j):j.map(function(V){return p(z,S,C,q,V,X)}),z.seen.pop(),function(V,N,U){return V.reduce(function(ee,B){return B.indexOf("\n"),ee+B.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?U[0]+(""===N?"":N+"\n ")+" "+V.join(",\n  ")+" "+U[1]:U[0]+N+" "+V.join(", ")+" "+U[1]}(W,G,ne)):ne[0]+G+ne[1]}function m(z){return"["+Error.prototype.toString.call(z)+"]"}function p(z,S,C,R,D,j){var q,Z,W;if((W=Object.getOwnPropertyDescriptor(S,D)||{value:S[D]}).get?Z=z.stylize(W.set?"[Getter/Setter]":"[Getter]","special"):W.set&&(Z=z.stylize("[Setter]","special")),P(R,D)||(q="["+D+"]"),Z||(z.seen.indexOf(W.value)<0?(Z=l(C)?n(z,W.value,null):n(z,W.value,C-1)).indexOf("\n")>-1&&(Z=j?Z.split("\n").map(function(G){return"  "+G}).join("\n").substr(2):"\n"+Z.split("\n").map(function(G){return"   "+G}).join("\n")):Z=z.stylize("[Circular]","special")),u(q)){if(j&&D.match(/^\d+$/))return Z;(q=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(q=q.substr(1,q.length-2),q=z.stylize(q,"name")):(q=q.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),q=z.stylize(q,"string"))}return q+": "+Z}function s(z){return Array.isArray(z)}function f(z){return"boolean"==typeof z}function l(z){return null===z}function o(z){return"number"==typeof z}function d(z){return"string"==typeof z}function u(z){return void 0===z}function a(z){return y(z)&&"[object RegExp]"===w(z)}function y(z){return"object"==typeof z&&null!==z}function h(z){return y(z)&&"[object Date]"===w(z)}function _(z){return y(z)&&("[object Error]"===w(z)||z instanceof Error)}function b(z){return"function"==typeof z}function w(z){return Object.prototype.toString.call(z)}function T(z){return z<10?"0"+z.toString(10):z.toString(10)}$.debuglog=function(z){if(u(x)&&(x=g.env.NODE_DEBUG||""),z=z.toUpperCase(),!e[z])if(new RegExp("\\b"+z+"\\b","i").test(x)){var S=g.pid;e[z]=function(){var C=$.format.apply($,arguments);console.error("%s %d: %s",z,S,C)}}else e[z]=function(){};return e[z]},$.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},$.isArray=s,$.isBoolean=f,$.isNull=l,$.isNullOrUndefined=function(z){return null==z},$.isNumber=o,$.isString=d,$.isSymbol=function(z){return"symbol"==typeof z},$.isUndefined=u,$.isRegExp=a,$.isObject=y,$.isDate=h,$.isError=_,$.isFunction=b,$.isPrimitive=function(z){return null===z||"boolean"==typeof z||"number"==typeof z||"string"==typeof z||"symbol"==typeof z||void 0===z},$.isBuffer=v("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var z=new Date,S=[T(z.getHours()),T(z.getMinutes()),T(z.getSeconds())].join(":");return[z.getDate(),L[z.getMonth()],S].join(" ")}function P(z,S){return Object.prototype.hasOwnProperty.call(z,S)}$.log=function(){console.log("%s - %s",M(),$.format.apply($,arguments))},$.inherits=v("inherits"),$._extend=function(z,S){if(!S||!y(S))return z;for(var C=Object.keys(S),R=C.length;R--;)z[C[R]]=S[C[R]];return z}}).call(this)}).call(this,v("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(v,Q,$){"use strict";$.byteLength=function(n){var m=i(n),s=m[1];return 3*(m[0]+s)/4-s},$.toByteArray=function(n){var m,p,h,s=i(n),f=s[0],l=s[1],o=new k(3*(f+(h=l))/4-h),d=0,u=l>0?f-4:f;for(p=0;p<u;p+=4)m=t[n.charCodeAt(p)]<<18|t[n.charCodeAt(p+1)]<<12|t[n.charCodeAt(p+2)]<<6|t[n.charCodeAt(p+3)],o[d++]=m>>16&255,o[d++]=m>>8&255,o[d++]=255&m;return 2===l&&(m=t[n.charCodeAt(p)]<<2|t[n.charCodeAt(p+1)]>>4,o[d++]=255&m),1===l&&(m=t[n.charCodeAt(p)]<<10|t[n.charCodeAt(p+1)]<<4|t[n.charCodeAt(p+2)]>>2,o[d++]=m>>8&255,o[d++]=255&m),o},$.fromByteArray=function(n){for(var m,p=n.length,s=p%3,f=[],l=0,o=p-s;l<o;l+=16383)f.push(c(n,l,l+16383>o?o:l+16383));return 1===s?f.push(g[(m=n[p-1])>>2]+g[m<<4&63]+"=="):2===s&&f.push(g[(m=(n[p-2]<<8)+n[p-1])>>10]+g[m>>4&63]+g[m<<2&63]+"="),f.join("")};for(var g=[],t=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array,x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=x.length;e<r;++e)g[e]=x[e],t[x.charCodeAt(e)]=e;function i(n){var m=n.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=n.indexOf("=");return-1===p&&(p=m),[p,p===m?0:4-p%4]}function c(n,m,p){for(var f,l=[],o=m;o<p;o+=3)l.push(g[(f=(n[o]<<16&16711680)+(n[o+1]<<8&65280)+(255&n[o+2]))>>18&63]+g[f>>12&63]+g[f>>6&63]+g[63&f]);return l.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63},{}],80:[function(v,Q,$){"use strict";function g(i,c,n,m,p){for(var s=p+1;m<=p;){var f=m+p>>>1,l=i[f];(void 0!==n?n(l,c):l-c)>=0?(s=f,p=f-1):m=f+1}return s}function t(i,c,n,m,p){for(var s=p+1;m<=p;){var f=m+p>>>1,l=i[f];(void 0!==n?n(l,c):l-c)>0?(s=f,p=f-1):m=f+1}return s}function k(i,c,n,m,p){for(var s=m-1;m<=p;){var f=m+p>>>1,l=i[f];(void 0!==n?n(l,c):l-c)<0?(s=f,m=f+1):p=f-1}return s}function x(i,c,n,m,p){for(var s=m-1;m<=p;){var f=m+p>>>1,l=i[f];(void 0!==n?n(l,c):l-c)<=0?(s=f,m=f+1):p=f-1}return s}function e(i,c,n,m,p){for(;m<=p;){var s=m+p>>>1,f=i[s],l=void 0!==n?n(f,c):f-c;if(0===l)return s;l<=0?m=s+1:p=s-1}return-1}function r(i,c,n,m,p,s){return"function"==typeof n?s(i,c,n,void 0===m?0:0|m,void 0===p?i.length-1:0|p):s(i,c,void 0,void 0===n?0:0|n,void 0===m?i.length-1:0|m)}Q.exports={ge:function(i,c,n,m,p){return r(i,c,n,m,p,g)},gt:function(i,c,n,m,p){return r(i,c,n,m,p,t)},lt:function(i,c,n,m,p){return r(i,c,n,m,p,k)},le:function(i,c,n,m,p){return r(i,c,n,m,p,x)},eq:function(i,c,n,m,p){return r(i,c,n,m,p,e)}}},{}],81:[function(v,Q,$){"use strict";function g(k){var x=32;return(k&=-k)&&x--,65535&k&&(x-=16),16711935&k&&(x-=8),252645135&k&&(x-=4),858993459&k&&(x-=2),1431655765&k&&(x-=1),x}$.INT_BITS=32,$.INT_MAX=2147483647,$.INT_MIN=-1<<31,$.sign=function(k){return(k>0)-(k<0)},$.abs=function(k){var x=k>>31;return(k^x)-x},$.min=function(k,x){return x^(k^x)&-(k<x)},$.max=function(k,x){return k^(k^x)&-(k<x)},$.isPow2=function(k){return!(k&k-1||!k)},$.log2=function(k){var x,e;return x=(k>65535)<<4,x|=e=((k>>>=x)>255)<<3,x|=e=((k>>>=e)>15)<<2,(x|=e=((k>>>=e)>3)<<1)|(k>>>=e)>>1},$.log10=function(k){return k>=1e9?9:k>=1e8?8:k>=1e7?7:k>=1e6?6:k>=1e5?5:k>=1e4?4:k>=1e3?3:k>=100?2:k>=10?1:0},$.popCount=function(k){return 16843009*((k=(858993459&(k-=k>>>1&1431655765))+(k>>>2&858993459))+(k>>>4)&252645135)>>>24},$.countTrailingZeros=g,$.nextPow2=function(k){return k+=0===k,--k,k|=k>>>1,k|=k>>>2,k|=k>>>4,1+((k|=k>>>8)|k>>>16)},$.prevPow2=function(k){return k|=k>>>1,k|=k>>>2,k|=k>>>4,k|=k>>>8,(k|=k>>>16)-(k>>>1)},$.parity=function(k){return k^=k>>>16,k^=k>>>8,k^=k>>>4,27030>>>(k&=15)&1};var t=new Array(256);(function(k){for(var x=0;x<256;++x){var e=x,r=x,i=7;for(e>>>=1;e;e>>>=1)r<<=1,r|=1&e,--i;k[x]=r<<i&255}})(t),$.reverse=function(k){return t[255&k]<<24|t[k>>>8&255]<<16|t[k>>>16&255]<<8|t[k>>>24&255]},$.interleave2=function(k,x){return(k=1431655765&((k=858993459&((k=252645135&((k=16711935&((k&=65535)|k<<8))|k<<4))|k<<2))|k<<1))|(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x&=65535)|x<<8))|x<<4))|x<<2))|x<<1))<<1},$.deinterleave2=function(k,x){return(k=65535&((k=16711935&((k=252645135&((k=858993459&((k=k>>>x&1431655765)|k>>>1))|k>>>2))|k>>>4))|k>>>16))<<16>>16},$.interleave3=function(k,x,e){return k=1227133513&((k=3272356035&((k=251719695&((k=4278190335&((k&=1023)|k<<16))|k<<8))|k<<4))|k<<2),(k|=(x=1227133513&((x=3272356035&((x=251719695&((x=4278190335&((x&=1023)|x<<16))|x<<8))|x<<4))|x<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},$.deinterleave3=function(k,x){return(k=1023&((k=4278190335&((k=251719695&((k=3272356035&((k=k>>>x&1227133513)|k>>>2))|k>>>4))|k>>>8))|k>>>16))<<22>>22},$.nextCombination=function(k){var x=k|k-1;return x+1|(~x&-~x)-1>>>g(k)+1}},{}],82:[function(v,Q,$){"use strict";var g=v("clamp");Q.exports=function(e,r){r||(r={});var i,c,n,m,p,s,l,d,u,a=null==r.cutoff?.25:r.cutoff,y=null==r.radius?8:r.radius,h=r.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!r.width||!r.height)throw Error("For raw data width and height should be provided by options");i=r.width,c=r.height,m=e,s=r.stride?r.stride:Math.floor(e.length/i/c)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(m=(l=e).getContext("2d").getImageData(0,0,i=l.width,c=l.height).data,s=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(m=e.getImageData(0,0,i=(l=e.canvas).width,c=l.height).data,s=4):window.ImageData&&e instanceof window.ImageData&&(i=e.width,c=e.height,m=e.data,s=4);if(n=Math.max(i,c),window.Uint8ClampedArray&&m instanceof window.Uint8ClampedArray||window.Uint8Array&&m instanceof window.Uint8Array)for(p=m,m=Array(i*c),d=0,u=p.length;d<u;d++)m[d]=p[d*s+h]/255;else if(1!==s)throw Error("Raw data can have only 1 value per pixel");var _=Array(i*c),b=Array(i*c),w=Array(n),T=Array(n),L=Array(n+1),M=Array(n);for(d=0,u=i*c;d<u;d++){var P=m[d];_[d]=1===P?0:0===P?t:Math.pow(Math.max(0,.5-P),2),b[d]=1===P?t:0===P?0:Math.pow(Math.max(0,P-.5),2)}k(_,i,c,w,T,M,L),k(b,i,c,w,T,M,L);var z=window.Float32Array?new Float32Array(i*c):new Array(i*c);for(d=0,u=i*c;d<u;d++)z[d]=g(1-((_[d]-b[d])/y+a),0,1);return z};var t=1e20;function k(e,r,i,c,n,m,p){for(var s=0;s<r;s++){for(var f=0;f<i;f++)c[f]=e[f*r+s];for(x(c,n,m,p,i),f=0;f<i;f++)e[f*r+s]=n[f]}for(f=0;f<i;f++){for(s=0;s<r;s++)c[s]=e[f*r+s];for(x(c,n,m,p,r),s=0;s<r;s++)e[f*r+s]=Math.sqrt(n[s])}}function x(e,r,i,c,n){i[0]=0,c[0]=-t,c[1]=+t;for(var m=1,p=0;m<n;m++){for(var s=(e[m]+m*m-(e[i[p]]+i[p]*i[p]))/(2*m-2*i[p]);s<=c[p];)p--,s=(e[m]+m*m-(e[i[p]]+i[p]*i[p]))/(2*m-2*i[p]);i[++p]=m,c[p]=s,c[p+1]=+t}for(m=0,p=0;m<n;m++){for(;c[p+1]<m;)p++;r[m]=(m-i[p])*(m-i[p])+e[i[p]]}}},{clamp:86}],83:[function(v,Q,$){},{}],84:[function(v,Q,$){"use strict";var g,t="object"==typeof Reflect?Reflect:null,k=t&&"function"==typeof t.apply?t.apply:function(o,d,u){return Function.prototype.apply.call(o,d,u)};g=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:function(o){return Object.getOwnPropertyNames(o)};var x=Number.isNaN||function(o){return o!=o};function e(){e.init.call(this)}Q.exports=e,Q.exports.once=function(o,d){return new Promise(function(u,a){function y(){void 0!==h&&o.removeListener("error",h),u([].slice.call(arguments))}var h;"error"!==d&&(h=function(_){o.removeListener(d,y),a(_)},o.once("error",h)),o.once(d,y)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var r=10;function i(o){if("function"!=typeof o)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof o)}function c(o){return void 0===o._maxListeners?e.defaultMaxListeners:o._maxListeners}function n(o,d,u,a){var y,h,_;if(i(u),void 0===(h=o._events)?(h=o._events=Object.create(null),o._eventsCount=0):(void 0!==h.newListener&&(o.emit("newListener",d,u.listener?u.listener:u),h=o._events),_=h[d]),void 0===_)_=h[d]=u,++o._eventsCount;else if("function"==typeof _?_=h[d]=a?[u,_]:[_,u]:a?_.unshift(u):_.push(u),(y=c(o))>0&&_.length>y&&!_.warned){_.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(d)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=o,w.type=d,w.count=_.length,console&&console.warn&&console.warn(w)}return o}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(o,d,u){var a={fired:!1,wrapFn:void 0,target:o,type:d,listener:u},y=m.bind(a);return y.listener=u,a.wrapFn=y,y}function s(o,d,u){var a=o._events;if(void 0===a)return[];var y=a[d];return void 0===y?[]:"function"==typeof y?u?[y.listener||y]:[y]:u?function(h){for(var _=new Array(h.length),b=0;b<_.length;++b)_[b]=h[b].listener||h[b];return _}(y):l(y,y.length)}function f(o){var d=this._events;if(void 0!==d){var u=d[o];if("function"==typeof u)return 1;if(void 0!==u)return u.length}return 0}function l(o,d){for(var u=new Array(d),a=0;a<d;++a)u[a]=o[a];return u}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(o){if("number"!=typeof o||o<0||x(o))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+o+".");r=o}}),e.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(o){if("number"!=typeof o||o<0||x(o))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+o+".");return this._maxListeners=o,this},e.prototype.getMaxListeners=function(){return c(this)},e.prototype.emit=function(o){for(var d=[],u=1;u<arguments.length;u++)d.push(arguments[u]);var a="error"===o,y=this._events;if(void 0!==y)a=a&&void 0===y.error;else if(!a)return!1;if(a){var h;if(d.length>0&&(h=d[0]),h instanceof Error)throw h;var _=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw _.context=h,_}var b=y[o];if(void 0===b)return!1;if("function"==typeof b)k(b,this,d);else{var w=b.length,T=l(b,w);for(u=0;u<w;++u)k(T[u],this,d)}return!0},e.prototype.on=e.prototype.addListener=function(o,d){return n(this,o,d,!1)},e.prototype.prependListener=function(o,d){return n(this,o,d,!0)},e.prototype.once=function(o,d){return i(d),this.on(o,p(this,o,d)),this},e.prototype.prependOnceListener=function(o,d){return i(d),this.prependListener(o,p(this,o,d)),this},e.prototype.off=e.prototype.removeListener=function(o,d){var u,a,y,h,_;if(i(d),void 0===(a=this._events))return this;if(void 0===(u=a[o]))return this;if(u===d||u.listener===d)0==--this._eventsCount?this._events=Object.create(null):(delete a[o],a.removeListener&&this.emit("removeListener",o,u.listener||d));else if("function"!=typeof u){for(y=-1,h=u.length-1;h>=0;h--)if(u[h]===d||u[h].listener===d){_=u[h].listener,y=h;break}if(y<0)return this;0===y?u.shift():function(b,w){for(;w+1<b.length;w++)b[w]=b[w+1];b.pop()}(u,y),1===u.length&&(a[o]=u[0]),void 0!==a.removeListener&&this.emit("removeListener",o,_||d)}return this},e.prototype.removeAllListeners=function(o){var d,u,a;if(void 0===(u=this._events))return this;if(void 0===u.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==u[o]&&(0==--this._eventsCount?this._events=Object.create(null):delete u[o]),this;if(0===arguments.length){var y,h=Object.keys(u);for(a=0;a<h.length;++a)"removeListener"!==(y=h[a])&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(d=u[o]))this.removeListener(o,d);else if(void 0!==d)for(a=d.length-1;a>=0;a--)this.removeListener(o,d[a]);return this},e.prototype.listeners=function(o){return s(this,o,!0)},e.prototype.rawListeners=function(o){return s(this,o,!1)},e.listenerCount=function(o,d){return"function"==typeof o.listenerCount?o.listenerCount(d):f.call(o,d)},e.prototype.listenerCount=f,e.prototype.eventNames=function(){return this._eventsCount>0?g(this._events):[]}},{}],85:[function(v,Q,$){(function(g){(function(){"use strict";var t=v("base64-js"),k=v("ieee754");function x(V){if(V>2147483647)throw new RangeError('The value "'+V+'" is invalid for option "size"');var N=new Uint8Array(V);return N.__proto__=e.prototype,N}function e(V,N,U){if("number"==typeof V){if("string"==typeof N)throw new TypeError('The "string" argument must be of type string. Received type number');return c(V)}return r(V,N,U)}function r(V,N,U){if("string"==typeof V)return function(K,J){if("string"==typeof J&&""!==J||(J="utf8"),!e.isEncoding(J))throw new TypeError("Unknown encoding: "+J);var te=0|p(K,J),ae=x(te),ce=ae.write(K,J);return ce!==te&&(ae=ae.slice(0,ce)),ae}(V,N);if(ArrayBuffer.isView(V))return n(V);if(null==V)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V);if(X(V,ArrayBuffer)||V&&X(V.buffer,ArrayBuffer))return function(K,J,te){if(J<0||K.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<J+(te||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return(ae=void 0===J&&void 0===te?new Uint8Array(K):void 0===te?new Uint8Array(K,J):new Uint8Array(K,J,te)).__proto__=e.prototype,ae}(V,N,U);if("number"==typeof V)throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=V.valueOf&&V.valueOf();if(null!=ee&&ee!==V)return e.from(ee,N,U);var B=function(K){if(e.isBuffer(K)){var J=0|m(K.length),te=x(J);return 0===te.length||K.copy(te,0,0,J),te}return void 0!==K.length?"number"!=typeof K.length||ne(K.length)?x(0):n(K):"Buffer"===K.type&&Array.isArray(K.data)?n(K.data):void 0}(V);if(B)return B;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof V[Symbol.toPrimitive])return e.from(V[Symbol.toPrimitive]("string"),N,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V)}function i(V){if("number"!=typeof V)throw new TypeError('"size" argument must be of type number');if(V<0)throw new RangeError('The value "'+V+'" is invalid for option "size"')}function c(V){return i(V),x(V<0?0:0|m(V))}function n(V){for(var N=V.length<0?0:0|m(V.length),U=x(N),ee=0;ee<N;ee+=1)U[ee]=255&V[ee];return U}function m(V){if(V>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|V}function p(V,N){if(e.isBuffer(V))return V.length;if(ArrayBuffer.isView(V)||X(V,ArrayBuffer))return V.byteLength;if("string"!=typeof V)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof V);var U=V.length,ee=arguments.length>2&&!0===arguments[2];if(!ee&&0===U)return 0;for(var B=!1;;)switch(N){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return Z(V).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*U;case"hex":return U>>>1;case"base64":return W(V).length;default:if(B)return ee?-1:Z(V).length;N=(""+N).toLowerCase(),B=!0}}function s(V,N,U){var ee=!1;if((void 0===N||N<0)&&(N=0),N>this.length||((void 0===U||U>this.length)&&(U=this.length),U<=0)||(U>>>=0)<=(N>>>=0))return"";for(V||(V="utf8");;)switch(V){case"hex":return M(this,N,U);case"utf8":case"utf-8":return w(this,N,U);case"ascii":return T(this,N,U);case"latin1":case"binary":return L(this,N,U);case"base64":return b(this,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,N,U);default:if(ee)throw new TypeError("Unknown encoding: "+V);V=(V+"").toLowerCase(),ee=!0}}function f(V,N,U){var ee=V[N];V[N]=V[U],V[U]=ee}function l(V,N,U,ee,B){if(0===V.length)return-1;if("string"==typeof U?(ee=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),ne(U=+U)&&(U=B?0:V.length-1),U<0&&(U=V.length+U),U>=V.length){if(B)return-1;U=V.length-1}else if(U<0){if(!B)return-1;U=0}if("string"==typeof N&&(N=e.from(N,ee)),e.isBuffer(N))return 0===N.length?-1:o(V,N,U,ee,B);if("number"==typeof N)return N&=255,"function"==typeof Uint8Array.prototype.indexOf?B?Uint8Array.prototype.indexOf.call(V,N,U):Uint8Array.prototype.lastIndexOf.call(V,N,U):o(V,[N],U,ee,B);throw new TypeError("val must be string, number or Buffer")}function o(V,N,U,ee,B){var K,J=1,te=V.length,ae=N.length;if(void 0!==ee&&("ucs2"===(ee=String(ee).toLowerCase())||"ucs-2"===ee||"utf16le"===ee||"utf-16le"===ee)){if(V.length<2||N.length<2)return-1;J=2,te/=2,ae/=2,U/=2}function ce(xe,Se){return 1===J?xe[Se]:xe.readUInt16BE(Se*J)}if(B){var oe=-1;for(K=U;K<te;K++)if(ce(V,K)===ce(N,-1===oe?0:K-oe)){if(-1===oe&&(oe=K),K-oe+1===ae)return oe*J}else-1!==oe&&(K-=K-oe),oe=-1}else for(U+ae>te&&(U=te-ae),K=U;K>=0;K--){for(var ve=!0,fe=0;fe<ae;fe++)if(ce(V,K+fe)!==ce(N,fe)){ve=!1;break}if(ve)return K}return-1}function d(V,N,U,ee){U=Number(U)||0;var B=V.length-U;ee?(ee=Number(ee))>B&&(ee=B):ee=B;var K=N.length;ee>K/2&&(ee=K/2);for(var J=0;J<ee;++J){var te=parseInt(N.substr(2*J,2),16);if(ne(te))return J;V[U+J]=te}return J}function u(V,N,U,ee){return G(Z(N,V.length-U),V,U,ee)}function a(V,N,U,ee){return G(function(B){for(var K=[],J=0;J<B.length;++J)K.push(255&B.charCodeAt(J));return K}(N),V,U,ee)}function y(V,N,U,ee){return a(V,N,U,ee)}function h(V,N,U,ee){return G(W(N),V,U,ee)}function _(V,N,U,ee){return G(function(B,K){for(var J,te,ce=[],oe=0;oe<B.length&&!((K-=2)<0);++oe)te=(J=B.charCodeAt(oe))>>8,ce.push(J%256),ce.push(te);return ce}(N,V.length-U),V,U,ee)}function b(V,N,U){return t.fromByteArray(0===N&&U===V.length?V:V.slice(N,U))}function w(V,N,U){U=Math.min(V.length,U);for(var ee=[],B=N;B<U;){var K,J,te,ae,ce=V[B],oe=null,ve=ce>239?4:ce>223?3:ce>191?2:1;if(B+ve<=U)switch(ve){case 1:ce<128&&(oe=ce);break;case 2:128==(192&(K=V[B+1]))&&(ae=(31&ce)<<6|63&K)>127&&(oe=ae);break;case 3:J=V[B+2],128==(192&(K=V[B+1]))&&128==(192&J)&&(ae=(15&ce)<<12|(63&K)<<6|63&J)>2047&&(ae<55296||ae>57343)&&(oe=ae);break;case 4:J=V[B+2],te=V[B+3],128==(192&(K=V[B+1]))&&128==(192&J)&&128==(192&te)&&(ae=(15&ce)<<18|(63&K)<<12|(63&J)<<6|63&te)>65535&&ae<1114112&&(oe=ae)}null===oe?(oe=65533,ve=1):oe>65535&&(ee.push((oe-=65536)>>>10&1023|55296),oe=56320|1023&oe),ee.push(oe),B+=ve}return function(fe){var xe=fe.length;if(xe<=4096)return String.fromCharCode.apply(String,fe);for(var Se="",pe=0;pe<xe;)Se+=String.fromCharCode.apply(String,fe.slice(pe,pe+=4096));return Se}(ee)}function T(V,N,U){var ee="";U=Math.min(V.length,U);for(var B=N;B<U;++B)ee+=String.fromCharCode(127&V[B]);return ee}function L(V,N,U){var ee="";U=Math.min(V.length,U);for(var B=N;B<U;++B)ee+=String.fromCharCode(V[B]);return ee}function M(V,N,U){var ee=V.length;(!N||N<0)&&(N=0),(!U||U<0||U>ee)&&(U=ee);for(var B="",K=N;K<U;++K)B+=q(V[K]);return B}function P(V,N,U){for(var ee=V.slice(N,U),B="",K=0;K<ee.length;K+=2)B+=String.fromCharCode(ee[K]+256*ee[K+1]);return B}function z(V,N,U){if(V%1!=0||V<0)throw new RangeError("offset is not uint");if(V+N>U)throw new RangeError("Trying to access beyond buffer length")}function S(V,N,U,ee,B,K){if(!e.isBuffer(V))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>B||N<K)throw new RangeError('"value" argument is out of bounds');if(U+ee>V.length)throw new RangeError("Index out of range")}function C(V,N,U,ee,B,K){if(U+ee>V.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function R(V,N,U,ee,B){return N=+N,U>>>=0,B||C(V,0,U,4),k.write(V,N,U,ee,23,4),U+4}function D(V,N,U,ee,B){return N=+N,U>>>=0,B||C(V,0,U,8),k.write(V,N,U,ee,52,8),U+8}$.Buffer=e,$.SlowBuffer=function(V){return+V!=V&&(V=0),e.alloc(+V)},$.INSPECT_MAX_BYTES=50,$.kMaxLength=2147483647,(e.TYPED_ARRAY_SUPPORT=function(){try{var V=new Uint8Array(1);return V.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===V.foo()}catch(N){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(V,N,U){return r(V,N,U)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(V,N,U){return B=N,K=U,i(ee=V),ee<=0?x(ee):void 0!==B?"string"==typeof K?x(ee).fill(B,K):x(ee).fill(B):x(ee);var ee,B,K},e.allocUnsafe=function(V){return c(V)},e.allocUnsafeSlow=function(V){return c(V)},e.isBuffer=function(V){return null!=V&&!0===V._isBuffer&&V!==e.prototype},e.compare=function(V,N){if(X(V,Uint8Array)&&(V=e.from(V,V.offset,V.byteLength)),X(N,Uint8Array)&&(N=e.from(N,N.offset,N.byteLength)),!e.isBuffer(V)||!e.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===N)return 0;for(var U=V.length,ee=N.length,B=0,K=Math.min(U,ee);B<K;++B)if(V[B]!==N[B]){U=V[B],ee=N[B];break}return U<ee?-1:ee<U?1:0},e.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(V,N){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(0===V.length)return e.alloc(0);var U;if(void 0===N)for(N=0,U=0;U<V.length;++U)N+=V[U].length;var ee=e.allocUnsafe(N),B=0;for(U=0;U<V.length;++U){var K=V[U];if(X(K,Uint8Array)&&(K=e.from(K)),!e.isBuffer(K))throw new TypeError('"list" argument must be an Array of Buffers');K.copy(ee,B),B+=K.length}return ee},e.byteLength=p,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var V=this.length;if(V%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<V;N+=2)f(this,N,N+1);return this},e.prototype.swap32=function(){var V=this.length;if(V%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<V;N+=4)f(this,N,N+3),f(this,N+1,N+2);return this},e.prototype.swap64=function(){var V=this.length;if(V%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<V;N+=8)f(this,N,N+7),f(this,N+1,N+6),f(this,N+2,N+5),f(this,N+3,N+4);return this},e.prototype.toLocaleString=e.prototype.toString=function(){var V=this.length;return 0===V?"":0===arguments.length?w(this,0,V):s.apply(this,arguments)},e.prototype.equals=function(V){if(!e.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V||0===e.compare(this,V)},e.prototype.inspect=function(){var V="",N=$.INSPECT_MAX_BYTES;return V=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(V+=" ... "),"<Buffer "+V+">"},e.prototype.compare=function(V,N,U,ee,B){if(X(V,Uint8Array)&&(V=e.from(V,V.offset,V.byteLength)),!e.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(void 0===N&&(N=0),void 0===U&&(U=V?V.length:0),void 0===ee&&(ee=0),void 0===B&&(B=this.length),N<0||U>V.length||ee<0||B>this.length)throw new RangeError("out of range index");if(ee>=B&&N>=U)return 0;if(ee>=B)return-1;if(N>=U)return 1;if(this===V)return 0;for(var K=(B>>>=0)-(ee>>>=0),J=(U>>>=0)-(N>>>=0),te=Math.min(K,J),ae=this.slice(ee,B),ce=V.slice(N,U),oe=0;oe<te;++oe)if(ae[oe]!==ce[oe]){K=ae[oe],J=ce[oe];break}return K<J?-1:J<K?1:0},e.prototype.includes=function(V,N,U){return-1!==this.indexOf(V,N,U)},e.prototype.indexOf=function(V,N,U){return l(this,V,N,U,!0)},e.prototype.lastIndexOf=function(V,N,U){return l(this,V,N,U,!1)},e.prototype.write=function(V,N,U,ee){if(void 0===N)ee="utf8",U=this.length,N=0;else if(void 0===U&&"string"==typeof N)ee=N,U=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(U)?(U>>>=0,void 0===ee&&(ee="utf8")):(ee=U,U=void 0)}var B=this.length-N;if((void 0===U||U>B)&&(U=B),V.length>0&&(U<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var K=!1;;)switch(ee){case"hex":return d(this,V,N,U);case"utf8":case"utf-8":return u(this,V,N,U);case"ascii":return a(this,V,N,U);case"latin1":case"binary":return y(this,V,N,U);case"base64":return h(this,V,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,V,N,U);default:if(K)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),K=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},e.prototype.slice=function(V,N){var U=this.length;(V=~~V)<0?(V+=U)<0&&(V=0):V>U&&(V=U),(N=void 0===N?U:~~N)<0?(N+=U)<0&&(N=0):N>U&&(N=U),N<V&&(N=V);var ee=this.subarray(V,N);return ee.__proto__=e.prototype,ee},e.prototype.readUIntLE=function(V,N,U){V>>>=0,N>>>=0,U||z(V,N,this.length);for(var ee=this[V],B=1,K=0;++K<N&&(B*=256);)ee+=this[V+K]*B;return ee},e.prototype.readUIntBE=function(V,N,U){V>>>=0,N>>>=0,U||z(V,N,this.length);for(var ee=this[V+--N],B=1;N>0&&(B*=256);)ee+=this[V+--N]*B;return ee},e.prototype.readUInt8=function(V,N){return V>>>=0,N||z(V,1,this.length),this[V]},e.prototype.readUInt16LE=function(V,N){return V>>>=0,N||z(V,2,this.length),this[V]|this[V+1]<<8},e.prototype.readUInt16BE=function(V,N){return V>>>=0,N||z(V,2,this.length),this[V]<<8|this[V+1]},e.prototype.readUInt32LE=function(V,N){return V>>>=0,N||z(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+16777216*this[V+3]},e.prototype.readUInt32BE=function(V,N){return V>>>=0,N||z(V,4,this.length),16777216*this[V]+(this[V+1]<<16|this[V+2]<<8|this[V+3])},e.prototype.readIntLE=function(V,N,U){V>>>=0,N>>>=0,U||z(V,N,this.length);for(var ee=this[V],B=1,K=0;++K<N&&(B*=256);)ee+=this[V+K]*B;return ee>=(B*=128)&&(ee-=Math.pow(2,8*N)),ee},e.prototype.readIntBE=function(V,N,U){V>>>=0,N>>>=0,U||z(V,N,this.length);for(var ee=N,B=1,K=this[V+--ee];ee>0&&(B*=256);)K+=this[V+--ee]*B;return K>=(B*=128)&&(K-=Math.pow(2,8*N)),K},e.prototype.readInt8=function(V,N){return V>>>=0,N||z(V,1,this.length),128&this[V]?-1*(255-this[V]+1):this[V]},e.prototype.readInt16LE=function(V,N){V>>>=0,N||z(V,2,this.length);var U=this[V]|this[V+1]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt16BE=function(V,N){V>>>=0,N||z(V,2,this.length);var U=this[V+1]|this[V]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt32LE=function(V,N){return V>>>=0,N||z(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},e.prototype.readInt32BE=function(V,N){return V>>>=0,N||z(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},e.prototype.readFloatLE=function(V,N){return V>>>=0,N||z(V,4,this.length),k.read(this,V,!0,23,4)},e.prototype.readFloatBE=function(V,N){return V>>>=0,N||z(V,4,this.length),k.read(this,V,!1,23,4)},e.prototype.readDoubleLE=function(V,N){return V>>>=0,N||z(V,8,this.length),k.read(this,V,!0,52,8)},e.prototype.readDoubleBE=function(V,N){return V>>>=0,N||z(V,8,this.length),k.read(this,V,!1,52,8)},e.prototype.writeUIntLE=function(V,N,U,ee){V=+V,N>>>=0,U>>>=0,ee||S(this,V,N,U,Math.pow(2,8*U)-1,0);var B=1,K=0;for(this[N]=255&V;++K<U&&(B*=256);)this[N+K]=V/B&255;return N+U},e.prototype.writeUIntBE=function(V,N,U,ee){V=+V,N>>>=0,U>>>=0,ee||S(this,V,N,U,Math.pow(2,8*U)-1,0);var B=U-1,K=1;for(this[N+B]=255&V;--B>=0&&(K*=256);)this[N+B]=V/K&255;return N+U},e.prototype.writeUInt8=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,1,255,0),this[N]=255&V,N+1},e.prototype.writeUInt16LE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,2,65535,0),this[N]=255&V,this[N+1]=V>>>8,N+2},e.prototype.writeUInt16BE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,2,65535,0),this[N]=V>>>8,this[N+1]=255&V,N+2},e.prototype.writeUInt32LE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,4,4294967295,0),this[N+3]=V>>>24,this[N+2]=V>>>16,this[N+1]=V>>>8,this[N]=255&V,N+4},e.prototype.writeUInt32BE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,4,4294967295,0),this[N]=V>>>24,this[N+1]=V>>>16,this[N+2]=V>>>8,this[N+3]=255&V,N+4},e.prototype.writeIntLE=function(V,N,U,ee){if(V=+V,N>>>=0,!ee){var B=Math.pow(2,8*U-1);S(this,V,N,U,B-1,-B)}var K=0,J=1,te=0;for(this[N]=255&V;++K<U&&(J*=256);)V<0&&0===te&&0!==this[N+K-1]&&(te=1),this[N+K]=(V/J>>0)-te&255;return N+U},e.prototype.writeIntBE=function(V,N,U,ee){if(V=+V,N>>>=0,!ee){var B=Math.pow(2,8*U-1);S(this,V,N,U,B-1,-B)}var K=U-1,J=1,te=0;for(this[N+K]=255&V;--K>=0&&(J*=256);)V<0&&0===te&&0!==this[N+K+1]&&(te=1),this[N+K]=(V/J>>0)-te&255;return N+U},e.prototype.writeInt8=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,1,127,-128),V<0&&(V=255+V+1),this[N]=255&V,N+1},e.prototype.writeInt16LE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,2,32767,-32768),this[N]=255&V,this[N+1]=V>>>8,N+2},e.prototype.writeInt16BE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,2,32767,-32768),this[N]=V>>>8,this[N+1]=255&V,N+2},e.prototype.writeInt32LE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,4,2147483647,-2147483648),this[N]=255&V,this[N+1]=V>>>8,this[N+2]=V>>>16,this[N+3]=V>>>24,N+4},e.prototype.writeInt32BE=function(V,N,U){return V=+V,N>>>=0,U||S(this,V,N,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[N]=V>>>24,this[N+1]=V>>>16,this[N+2]=V>>>8,this[N+3]=255&V,N+4},e.prototype.writeFloatLE=function(V,N,U){return R(this,V,N,!0,U)},e.prototype.writeFloatBE=function(V,N,U){return R(this,V,N,!1,U)},e.prototype.writeDoubleLE=function(V,N,U){return D(this,V,N,!0,U)},e.prototype.writeDoubleBE=function(V,N,U){return D(this,V,N,!1,U)},e.prototype.copy=function(V,N,U,ee){if(!e.isBuffer(V))throw new TypeError("argument should be a Buffer");if(U||(U=0),ee||0===ee||(ee=this.length),N>=V.length&&(N=V.length),N||(N=0),ee>0&&ee<U&&(ee=U),ee===U||0===V.length||0===this.length)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),V.length-N<ee-U&&(ee=V.length-N+U);var B=ee-U;if(this===V&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(N,U,ee);else if(this===V&&U<N&&N<ee)for(var K=B-1;K>=0;--K)V[K+N]=this[K+U];else Uint8Array.prototype.set.call(V,this.subarray(U,ee),N);return B},e.prototype.fill=function(V,N,U,ee){if("string"==typeof V){if("string"==typeof N?(ee=N,N=0,U=this.length):"string"==typeof U&&(ee=U,U=this.length),void 0!==ee&&"string"!=typeof ee)throw new TypeError("encoding must be a string");if("string"==typeof ee&&!e.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(1===V.length){var B=V.charCodeAt(0);("utf8"===ee&&B<128||"latin1"===ee)&&(V=B)}}else"number"==typeof V&&(V&=255);if(N<0||this.length<N||this.length<U)throw new RangeError("Out of range index");if(U<=N)return this;var K;if(N>>>=0,U=void 0===U?this.length:U>>>0,V||(V=0),"number"==typeof V)for(K=N;K<U;++K)this[K]=V;else{var J=e.isBuffer(V)?V:e.from(V,ee),te=J.length;if(0===te)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(K=0;K<U-N;++K)this[K+N]=J[K%te]}return this};var j=/[^+/0-9A-Za-z-_]/g;function q(V){return V<16?"0"+V.toString(16):V.toString(16)}function Z(V,N){var U;N=N||1/0;for(var ee=V.length,B=null,K=[],J=0;J<ee;++J){if((U=V.charCodeAt(J))>55295&&U<57344){if(!B){if(U>56319){(N-=3)>-1&&K.push(239,191,189);continue}if(J+1===ee){(N-=3)>-1&&K.push(239,191,189);continue}B=U;continue}if(U<56320){(N-=3)>-1&&K.push(239,191,189),B=U;continue}U=65536+(B-55296<<10|U-56320)}else B&&(N-=3)>-1&&K.push(239,191,189);if(B=null,U<128){if((N-=1)<0)break;K.push(U)}else if(U<2048){if((N-=2)<0)break;K.push(U>>6|192,63&U|128)}else if(U<65536){if((N-=3)<0)break;K.push(U>>12|224,U>>6&63|128,63&U|128)}else{if(!(U<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;K.push(U>>18|240,U>>12&63|128,U>>6&63|128,63&U|128)}}return K}function W(V){return t.toByteArray(function(N){if((N=(N=N.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N}(V))}function G(V,N,U,ee){for(var B=0;B<ee&&!(B+U>=N.length||B>=V.length);++B)N[B+U]=V[B];return B}function X(V,N){return V instanceof N||null!=V&&null!=V.constructor&&null!=V.constructor.name&&V.constructor.name===N.name}function ne(V){return V!=V}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(v,Q,$){Q.exports=function(g,t,k){return t<k?g<t?t:g>k?k:g:g<k?k:g>t?t:g}},{}],87:[function(v,Q,$){"use strict";var g=v("clamp");function t(k,x){null==x&&(x=!0);var e=k[0],r=k[1],i=k[2],c=k[3];return null==c&&(c=x?1:255),x&&(e*=255,r*=255,i*=255,c*=255),16777216*(e=255&g(e,0,255))+((r=255&g(r,0,255))<<16)+((i=255&g(i,0,255))<<8)+(255&g(c,0,255))}Q.exports=t,Q.exports.to=t,Q.exports.from=function(k,x){var e=(k=+k)>>>24,r=(16711680&k)>>>16,i=(65280&k)>>>8,c=255&k;return!1===x?[e,r,i,c]:[e/255,r/255,i/255,c/255]}},{clamp:86}],88:[function(v,Q,$){"use strict";Q.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(v,Q,$){"use strict";var g=v("color-rgba"),t=v("clamp"),k=v("dtype");Q.exports=function(x,e){"float"!==e&&e||(e="array"),"uint"===e&&(e="uint8"),"uint_clamped"===e&&(e="uint8_clamped");var c,r=new(k(e))(4),i="uint8"!==e&&"uint8_clamped"!==e;return x.length&&"string"!=typeof x||((x=g(x))[0]/=255,x[1]/=255,x[2]/=255),(c=x)instanceof Uint8Array||c instanceof Uint8ClampedArray||Array.isArray(c)&&(c[0]>1||0===c[0])&&(c[1]>1||0===c[1])&&(c[2]>1||0===c[2])&&(!c[3]||c[3]>1)?(r[0]=x[0],r[1]=x[1],r[2]=x[2],r[3]=null!=x[3]?x[3]:255,i&&(r[0]/=255,r[1]/=255,r[2]/=255,r[3]/=255),r):(i?(r[0]=x[0],r[1]=x[1],r[2]=x[2],r[3]=null!=x[3]?x[3]:1):(r[0]=t(Math.floor(255*x[0]),0,255),r[1]=t(Math.floor(255*x[1]),0,255),r[2]=t(Math.floor(255*x[2]),0,255),r[3]=null==x[3]?255:t(Math.floor(255*x[3]),0,255)),r)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(v,Q,$){(function(g){(function(){"use strict";var t=v("color-name"),k=v("is-plain-obj"),x=v("defined");Q.exports=function(r){var i,c,n=[],m=1;if("string"==typeof r)if(t[r])n=t[r].slice(),c="rgb";else if("transparent"===r)m=0,c="rgb",n=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(r)){var p=(l=r.slice(1)).length;m=1,p<=4?(n=[parseInt(l[0]+l[0],16),parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16)],4===p&&(m=parseInt(l[3]+l[3],16)/255)):(n=[parseInt(l[0]+l[1],16),parseInt(l[2]+l[3],16),parseInt(l[4]+l[5],16)],8===p&&(m=parseInt(l[6]+l[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),c="rgb"}else if(i=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(r)){var s=i[1],f="rgb"===s,l=s.replace(/a$/,"");c=l,p="cmyk"===l?4:"gray"===l?1:3,n=i[2].trim().split(/\s*,\s*/).map(function(d,u){if(/%$/.test(d))return u===p?parseFloat(d)/100:"rgb"===l?255*parseFloat(d)/100:parseFloat(d);if("h"===l[u]){if(/deg$/.test(d))return parseFloat(d);if(void 0!==e[d])return e[d]}return parseFloat(d)}),s===l&&n.push(1),m=f||void 0===n[p]?1:n[p],n=n.slice(0,p)}else r.length>10&&/[0-9](?:\s|\/)/.test(r)&&(n=r.match(/([0-9]+)/g).map(function(d){return parseFloat(d)}),c=r.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(r))if(k(r)){var o=x(r.r,r.red,r.R,null);null!==o?(c="rgb",n=[o,x(r.g,r.green,r.G),x(r.b,r.blue,r.B)]):(c="hsl",n=[x(r.h,r.hue,r.H),x(r.s,r.saturation,r.S),x(r.l,r.lightness,r.L,r.b,r.brightness)]),m=x(r.a,r.alpha,r.opacity,1),null!=r.opacity&&(m/=100)}else(Array.isArray(r)||g.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(r))&&(n=[r[0],r[1],r[2]],c="rgb",m=4===r.length?r[3]:1);else c="rgb",n=[r>>>16,(65280&r)>>>8,255&r];return{space:c,values:n,alpha:m}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(v,Q,$){"use strict";var g=v("color-parse"),t=v("color-space/hsl"),k=v("clamp");Q.exports=function(x){var e,r=g(x);return r.space?((e=Array(3))[0]=k(r.values[0],0,255),e[1]=k(r.values[1],0,255),e[2]=k(r.values[2],0,255),"h"===r.space[0]&&(e=t.rgb(e)),e.push(k(r.alpha,0,1)),e):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(v,Q,$){"use strict";var g=v("./rgb");Q.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var k,x,e,r,i,c=t[0]/360,n=t[1]/100,m=t[2]/100;if(0===n)return[i=255*m,i,i];k=2*m-(x=m<.5?m*(1+n):m+n-m*n),r=[0,0,0];for(var p=0;p<3;p++)(e=c+1/3*-(p-1))<0?e++:e>1&&e--,r[p]=255*(i=6*e<1?k+6*(x-k)*e:2*e<1?x:3*e<2?k+(x-k)*(2/3-e)*6:k);return r}},g.hsl=function(t){var k,x,e=t[0]/255,r=t[1]/255,i=t[2]/255,c=Math.min(e,r,i),n=Math.max(e,r,i),m=n-c;return n===c?k=0:e===n?k=(r-i)/m:r===n?k=2+(i-e)/m:i===n&&(k=4+(e-r)/m),(k=Math.min(60*k,360))<0&&(k+=360),x=(c+n)/2,[k,100*(n===c?0:x<=.5?m/(n+c):m/(2-n-c)),100*x]}},{"./rgb":93}],93:[function(v,Q,$){"use strict";Q.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(v,Q,$){Q.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xe7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xe9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xe9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xe3)o.?tom(e|\xe9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(v,Q,$){Q.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(v,Q,$){Q.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(v,Q,$){Q.exports=["normal","italic","oblique"]},{}],98:[function(v,Q,$){Q.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(v,Q,$){"use strict";Q.exports={parse:v("./parse"),stringify:v("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(v,Q,$){"use strict";var g=v("css-font-size-keywords");Q.exports={isSize:function(t){return/^[\d\.]/.test(t)||-1!==t.indexOf("/")||-1!==g.indexOf(t)}}},{"css-font-size-keywords":95}],101:[function(v,Q,$){"use strict";var g=v("unquote"),t=v("css-global-keywords"),k=v("css-system-font-keywords"),x=v("css-font-weight-keywords"),e=v("css-font-style-keywords"),r=v("css-font-stretch-keywords"),i=v("string-split-by"),c=v("./lib/util").isSize;Q.exports=m;var n=m.cache={};function m(s){if("string"!=typeof s)throw new Error("Font argument must be a string.");if(n[s])return n[s];if(""===s)throw new Error("Cannot parse an empty string.");if(-1!==k.indexOf(s))return n[s]={system:s};for(var f,l={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},o=i(s,/\s+/);f=o.shift();){if(-1!==t.indexOf(f))return["style","variant","weight","stretch"].forEach(function(u){l[u]=f}),n[s]=l;if(-1===e.indexOf(f))if("normal"!==f&&"small-caps"!==f)if(-1===r.indexOf(f)){if(-1===x.indexOf(f)){if(c(f)){var d=i(f,"/");if(l.size=d[0],null!=d[1]?l.lineHeight=p(d[1]):"/"===o[0]&&(o.shift(),l.lineHeight=p(o.shift())),!o.length)throw new Error("Missing required font-family.");return l.family=i(o.join(" "),/\s*,\s*/).map(g),n[s]=l}throw new Error("Unknown or unsupported font token: "+f)}l.weight=f}else l.stretch=f;else l.variant=f;else l.style=f}throw new Error("Missing required font-size.")}function p(s){var f=parseFloat(s);return f.toString()===s?f:s}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(v,Q,$){"use strict";var g=v("pick-by-alias"),t=v("./lib/util").isSize,k=f(v("css-global-keywords")),x=f(v("css-system-font-keywords")),e=f(v("css-font-weight-keywords")),r=f(v("css-font-style-keywords")),i=f(v("css-font-stretch-keywords")),c={normal:1,"small-caps":1},n={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},p="serif";function s(l,o){if(l&&!o[l]&&!k[l])throw Error("Unknown keyword `"+l+"`");return l}function f(l){for(var o={},d=0;d<l.length;d++)o[l[d]]=1;return o}Q.exports=function(l){if((l=g(l,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return l.system&&s(l.system,x),l.system;if(s(l.style,r),s(l.variant,c),s(l.weight,e),s(l.stretch,i),null==l.size&&(l.size="1rem"),"number"==typeof l.size&&(l.size+="px"),!t)throw Error("Bad size value `"+l.size+"`");l.family||(l.family=p),Array.isArray(l.family)&&(l.family.length||(l.family=[p]),l.family=l.family.map(function(d){return n[d]?d:'"'+d+'"'}).join(", "));var o=[];return o.push(l.style),l.variant!==l.style&&o.push(l.variant),l.weight!==l.variant&&l.weight!==l.style&&o.push(l.weight),l.stretch!==l.weight&&l.stretch!==l.variant&&l.stretch!==l.style&&o.push(l.stretch),o.push(l.size+(null==l.lineHeight||"normal"===l.lineHeight||l.lineHeight+""=="1"?"":"/"+l.lineHeight)),o.push(l.family),o.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(v,Q,$){Q.exports=["inherit","initial","unset"]},{}],104:[function(v,Q,$){Q.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(v,Q,$){"use strict";var g,t=v("type/value/is"),k=v("type/value/ensure"),x=v("type/plain-function/ensure"),e=v("es5-ext/object/copy"),r=v("es5-ext/object/normalize-options"),i=v("es5-ext/object/map"),c=Function.prototype.bind,n=Object.defineProperty,m=Object.prototype.hasOwnProperty;g=function(p,s,f){var l,o=k(s)&&x(s.value);return delete(l=e(s)).writable,delete l.value,l.get=function(){return!f.overwriteDefinition&&m.call(this,p)?o:(s.value=c.call(o,f.resolveContext?f.resolveContext(this):this),n(this,p,s),this[p])},l},Q.exports=function(p){var s=r(arguments[1]);return t(s.resolveContext)&&x(s.resolveContext),i(p,function(f,l){return g(l,f,s)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(v,Q,$){"use strict";var g=v("type/value/is"),t=v("type/plain-function/is"),k=v("es5-ext/object/assign"),x=v("es5-ext/object/normalize-options"),e=v("es5-ext/string/#/contains");(Q.exports=function(r,i){var c,n,m,p,s;return arguments.length<2||"string"!=typeof r?(p=i,i=r,r=null):p=arguments[2],g(r)?(c=e.call(r,"c"),n=e.call(r,"e"),m=e.call(r,"w")):(c=m=!0,n=!1),s={value:i,configurable:c,enumerable:n,writable:m},p?k(x(p),s):s}).gs=function(r,i,c){var n,m,p,s;return"string"!=typeof r?(p=c,c=i,i=r,r=null):p=arguments[3],g(i)?t(i)?g(c)?t(c)||(p=c,c=void 0):c=void 0:(p=i,i=c=void 0):i=void 0,g(r)?(n=e.call(r,"c"),m=e.call(r,"e")):(n=!0,m=!1),s={get:i,set:c,configurable:n,enumerable:m},p?k(x(p),s):s}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(v,Q,$){var t;t=function(g){"use strict";function t(z,S){return z<S?-1:z>S?1:z>=S?0:NaN}function k(z){var S;return 1===z.length&&(S=z,z=function(C,R){return t(S(C),R)}),{left:function(C,R,D,j){for(null==D&&(D=0),null==j&&(j=C.length);D<j;){var q=D+j>>>1;z(C[q],R)<0?D=q+1:j=q}return D},right:function(C,R,D,j){for(null==D&&(D=0),null==j&&(j=C.length);D<j;){var q=D+j>>>1;z(C[q],R)>0?j=q:D=q+1}return D}}}var x=k(t),e=x.right,r=x.left;function i(z,S){return[z,S]}function c(z){return null===z?NaN:+z}function n(z,S){var C,R,D=z.length,j=0,q=-1,Z=0,W=0;if(null==S)for(;++q<D;)isNaN(C=c(z[q]))||(W+=(R=C-Z)*(C-(Z+=R/++j)));else for(;++q<D;)isNaN(C=c(S(z[q],q,z)))||(W+=(R=C-Z)*(C-(Z+=R/++j)));if(j>1)return W/(j-1)}function m(z,S){var C=n(z,S);return C&&Math.sqrt(C)}function p(z,S){var C,R,D,j=z.length,q=-1;if(null==S){for(;++q<j;)if(null!=(C=z[q])&&C>=C)for(R=D=C;++q<j;)null!=(C=z[q])&&(R>C&&(R=C),D<C&&(D=C))}else for(;++q<j;)if(null!=(C=S(z[q],q,z))&&C>=C)for(R=D=C;++q<j;)null!=(C=S(z[q],q,z))&&(R>C&&(R=C),D<C&&(D=C));return[R,D]}var s=Array.prototype,f=s.slice,l=s.map;function o(z){return function(){return z}}function d(z){return z}function u(z,S,C){z=+z,S=+S,C=(D=arguments.length)<2?(S=z,z=0,1):D<3?1:+C;for(var R=-1,D=0|Math.max(0,Math.ceil((S-z)/C)),j=new Array(D);++R<D;)j[R]=z+R*C;return j}var a=Math.sqrt(50),y=Math.sqrt(10),h=Math.sqrt(2);function _(z,S,C){var R=(S-z)/Math.max(0,C),D=Math.floor(Math.log(R)/Math.LN10),j=R/Math.pow(10,D);return D>=0?(j>=a?10:j>=y?5:j>=h?2:1)*Math.pow(10,D):-Math.pow(10,-D)/(j>=a?10:j>=y?5:j>=h?2:1)}function b(z,S,C){var R=Math.abs(S-z)/Math.max(0,C),D=Math.pow(10,Math.floor(Math.log(R)/Math.LN10)),j=R/D;return j>=a?D*=10:j>=y?D*=5:j>=h&&(D*=2),S<z?-D:D}function w(z){return Math.ceil(Math.log(z.length)/Math.LN2)+1}function T(z,S,C){if(null==C&&(C=c),R=z.length){if((S=+S)<=0||R<2)return+C(z[0],0,z);if(S>=1)return+C(z[R-1],R-1,z);var R,D=(R-1)*S,j=Math.floor(D),q=+C(z[j],j,z);return q+(+C(z[j+1],j+1,z)-q)*(D-j)}}function L(z,S){var C,R,D=z.length,j=-1;if(null==S){for(;++j<D;)if(null!=(C=z[j])&&C>=C)for(R=C;++j<D;)null!=(C=z[j])&&R>C&&(R=C)}else for(;++j<D;)if(null!=(C=S(z[j],j,z))&&C>=C)for(R=C;++j<D;)null!=(C=S(z[j],j,z))&&R>C&&(R=C);return R}function M(z){if(!(D=z.length))return[];for(var S=-1,C=L(z,P),R=new Array(C);++S<C;)for(var D,j=-1,q=R[S]=new Array(D);++j<D;)q[j]=z[j][S];return R}function P(z){return z.length}g.bisect=e,g.bisectRight=e,g.bisectLeft=r,g.ascending=t,g.bisector=k,g.cross=function(z,S,C){var R,D,j,q,Z=z.length,W=S.length,G=new Array(Z*W);for(null==C&&(C=i),R=j=0;R<Z;++R)for(q=z[R],D=0;D<W;++D,++j)G[j]=C(q,S[D]);return G},g.descending=function(z,S){return S<z?-1:S>z?1:S>=z?0:NaN},g.deviation=m,g.extent=p,g.histogram=function(){var z=d,S=p,C=w;function R(D){var j,q,Z=D.length,W=new Array(Z);for(j=0;j<Z;++j)W[j]=z(D[j],j,D);var G=S(W),X=G[0],ne=G[1],V=C(W,X,ne);Array.isArray(V)||(V=b(X,ne,V),V=u(Math.ceil(X/V)*V,ne,V));for(var N=V.length;V[0]<=X;)V.shift(),--N;for(;V[N-1]>ne;)V.pop(),--N;var U,ee=new Array(N+1);for(j=0;j<=N;++j)(U=ee[j]=[]).x0=j>0?V[j-1]:X,U.x1=j<N?V[j]:ne;for(j=0;j<Z;++j)X<=(q=W[j])&&q<=ne&&ee[e(V,q,0,N)].push(D[j]);return ee}return R.value=function(D){return arguments.length?(z="function"==typeof D?D:o(D),R):z},R.domain=function(D){return arguments.length?(S="function"==typeof D?D:o([D[0],D[1]]),R):S},R.thresholds=function(D){return arguments.length?(C="function"==typeof D?D:Array.isArray(D)?o(f.call(D)):o(D),R):C},R},g.thresholdFreedmanDiaconis=function(z,S,C){return z=l.call(z,c).sort(t),Math.ceil((C-S)/(2*(T(z,.75)-T(z,.25))*Math.pow(z.length,-1/3)))},g.thresholdScott=function(z,S,C){return Math.ceil((C-S)/(3.5*m(z)*Math.pow(z.length,-1/3)))},g.thresholdSturges=w,g.max=function(z,S){var C,R,D=z.length,j=-1;if(null==S){for(;++j<D;)if(null!=(C=z[j])&&C>=C)for(R=C;++j<D;)null!=(C=z[j])&&C>R&&(R=C)}else for(;++j<D;)if(null!=(C=S(z[j],j,z))&&C>=C)for(R=C;++j<D;)null!=(C=S(z[j],j,z))&&C>R&&(R=C);return R},g.mean=function(z,S){var C,R=z.length,D=R,j=-1,q=0;if(null==S)for(;++j<R;)isNaN(C=c(z[j]))?--D:q+=C;else for(;++j<R;)isNaN(C=c(S(z[j],j,z)))?--D:q+=C;if(D)return q/D},g.median=function(z,S){var C,R=z.length,D=-1,j=[];if(null==S)for(;++D<R;)isNaN(C=c(z[D]))||j.push(C);else for(;++D<R;)isNaN(C=c(S(z[D],D,z)))||j.push(C);return T(j.sort(t),.5)},g.merge=function(z){for(var S,C,R,D=z.length,j=-1,q=0;++j<D;)q+=z[j].length;for(C=new Array(q);--D>=0;)for(S=(R=z[D]).length;--S>=0;)C[--q]=R[S];return C},g.min=L,g.pairs=function(z,S){null==S&&(S=i);for(var C=0,R=z.length-1,D=z[0],j=new Array(R<0?0:R);C<R;)j[C]=S(D,D=z[++C]);return j},g.permute=function(z,S){for(var C=S.length,R=new Array(C);C--;)R[C]=z[S[C]];return R},g.quantile=T,g.range=u,g.scan=function(z,S){if(C=z.length){var C,R,D=0,j=0,q=z[j];for(null==S&&(S=t);++D<C;)(S(R=z[D],q)<0||0!==S(q,q))&&(q=R,j=D);return 0===S(q,q)?j:void 0}},g.shuffle=function(z,S,C){for(var R,D,j=(null==C?z.length:C)-(S=null==S?0:+S);j;)D=Math.random()*j--|0,R=z[j+S],z[j+S]=z[D+S],z[D+S]=R;return z},g.sum=function(z,S){var C,R=z.length,D=-1,j=0;if(null==S)for(;++D<R;)(C=+z[D])&&(j+=C);else for(;++D<R;)(C=+S(z[D],D,z))&&(j+=C);return j},g.ticks=function(z,S,C){var R,D,j,q,Z=-1;if(C=+C,(z=+z)==(S=+S)&&C>0)return[z];if((R=S<z)&&(D=z,z=S,S=D),0===(q=_(z,S,C))||!isFinite(q))return[];if(q>0)for(z=Math.ceil(z/q),S=Math.floor(S/q),j=new Array(D=Math.ceil(S-z+1));++Z<D;)j[Z]=(z+Z)*q;else for(z=Math.floor(z*q),S=Math.ceil(S*q),j=new Array(D=Math.ceil(z-S+1));++Z<D;)j[Z]=(z-Z)/q;return R&&j.reverse(),j},g.tickIncrement=_,g.tickStep=b,g.transpose=M,g.variance=n,g.zip=function(){return M(arguments)},Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:this.d3=this.d3||{})},{}],108:[function(v,Q,$){var t;t=function(g){"use strict";function t(){}function k(p,s){var f=new t;if(p instanceof t)p.each(function(a,y){f.set(y,a)});else if(Array.isArray(p)){var l,o=-1,d=p.length;if(null==s)for(;++o<d;)f.set(o,p[o]);else for(;++o<d;)f.set(s(l=p[o],o,p),l)}else if(p)for(var u in p)f.set(u,p[u]);return f}function x(){return{}}function e(p,s,f){p[s]=f}function r(){return k()}function i(p,s,f){p.set(s,f)}function c(){}t.prototype=k.prototype={constructor:t,has:function(p){return"$"+p in this},get:function(p){return this["$"+p]},set:function(p,s){return this["$"+p]=s,this},remove:function(p){var s="$"+p;return s in this&&delete this[s]},clear:function(){for(var p in this)"$"===p[0]&&delete this[p]},keys:function(){var p=[];for(var s in this)"$"===s[0]&&p.push(s.slice(1));return p},values:function(){var p=[];for(var s in this)"$"===s[0]&&p.push(this[s]);return p},entries:function(){var p=[];for(var s in this)"$"===s[0]&&p.push({key:s.slice(1),value:this[s]});return p},size:function(){var p=0;for(var s in this)"$"===s[0]&&++p;return p},empty:function(){for(var p in this)if("$"===p[0])return!1;return!0},each:function(p){for(var s in this)"$"===s[0]&&p(this[s],s.slice(1),this)}};var n=k.prototype;function m(p,s){var f=new c;if(p instanceof c)p.each(function(d){f.add(d)});else if(p){var l=-1,o=p.length;if(null==s)for(;++l<o;)f.add(p[l]);else for(;++l<o;)f.add(s(p[l],l,p))}return f}c.prototype=m.prototype={constructor:c,has:n.has,add:function(p){return this["$"+(p+="")]=p,this},remove:n.remove,clear:n.clear,values:n.keys,size:n.size,empty:n.empty,each:n.each},g.nest=function(){var p,s,f,l=[],o=[];function d(u,a,y,h){if(a>=l.length)return null!=p&&u.sort(p),null!=s?s(u):u;for(var _,b,w,T=-1,L=u.length,M=l[a++],P=k(),z=y();++T<L;)(w=P.get(_=M(b=u[T])+""))?w.push(b):P.set(_,[b]);return P.each(function(S,C){h(z,C,d(S,a,y,h))}),z}return f={object:function(u){return d(u,0,x,e)},map:function(u){return d(u,0,r,i)},entries:function(u){return function a(y,h){if(++h>l.length)return y;var _,b=o[h-1];return null!=s&&h>=l.length?_=y.entries():(_=[],y.each(function(w,T){_.push({key:T,values:a(w,h)})})),null!=b?_.sort(function(w,T){return b(w.key,T.key)}):_}(d(u,0,r,i),0)},key:function(u){return l.push(u),f},sortKeys:function(u){return o[l.length-1]=u,f},sortValues:function(u){return p=u,f},rollup:function(u){return s=u,f}}},g.set=m,g.map=k,g.keys=function(p){var s=[];for(var f in p)s.push(f);return s},g.values=function(p){var s=[];for(var f in p)s.push(p[f]);return s},g.entries=function(p){var s=[];for(var f in p)s.push({key:f,value:p[f]});return s},Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:this.d3=this.d3||{})},{}],109:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";function t(se,de,Ae){se.prototype=de.prototype=Ae,Ae.constructor=se}function k(se,de){var Ae=Object.create(se.prototype);for(var Le in de)Ae[Le]=de[Le];return Ae}function x(){}var e="\\s*([+-]?\\d+)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",i="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,n=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),m=new RegExp("^rgb\\("+[i,i,i]+"\\)$"),p=new RegExp("^rgba\\("+[e,e,e,r]+"\\)$"),s=new RegExp("^rgba\\("+[i,i,i,r]+"\\)$"),f=new RegExp("^hsl\\("+[r,i,i]+"\\)$"),l=new RegExp("^hsla\\("+[r,i,i,r]+"\\)$"),o={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function d(){return this.rgb().formatHex()}function u(){return this.rgb().formatRgb()}function a(se){var de,Ae;return se=(se+"").trim().toLowerCase(),(de=c.exec(se))?(Ae=de[1].length,de=parseInt(de[1],16),6===Ae?y(de):3===Ae?new w(de>>8&15|de>>4&240,de>>4&15|240&de,(15&de)<<4|15&de,1):8===Ae?h(de>>24&255,de>>16&255,de>>8&255,(255&de)/255):4===Ae?h(de>>12&15|de>>8&240,de>>8&15|de>>4&240,de>>4&15|240&de,((15&de)<<4|15&de)/255):null):(de=n.exec(se))?new w(de[1],de[2],de[3],1):(de=m.exec(se))?new w(255*de[1]/100,255*de[2]/100,255*de[3]/100,1):(de=p.exec(se))?h(de[1],de[2],de[3],de[4]):(de=s.exec(se))?h(255*de[1]/100,255*de[2]/100,255*de[3]/100,de[4]):(de=f.exec(se))?P(de[1],de[2]/100,de[3]/100,1):(de=l.exec(se))?P(de[1],de[2]/100,de[3]/100,de[4]):o.hasOwnProperty(se)?y(o[se]):"transparent"===se?new w(NaN,NaN,NaN,0):null}function y(se){return new w(se>>16&255,se>>8&255,255&se,1)}function h(se,de,Ae,Le){return Le<=0&&(se=de=Ae=NaN),new w(se,de,Ae,Le)}function _(se){return se instanceof x||(se=a(se)),se?new w((se=se.rgb()).r,se.g,se.b,se.opacity):new w}function b(se,de,Ae,Le){return 1===arguments.length?_(se):new w(se,de,Ae,null==Le?1:Le)}function w(se,de,Ae,Le){this.r=+se,this.g=+de,this.b=+Ae,this.opacity=+Le}function T(){return"#"+M(this.r)+M(this.g)+M(this.b)}function L(){var se=this.opacity;return(1===(se=isNaN(se)?1:Math.max(0,Math.min(1,se)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===se?")":", "+se+")")}function M(se){return((se=Math.max(0,Math.min(255,Math.round(se)||0)))<16?"0":"")+se.toString(16)}function P(se,de,Ae,Le){return Le<=0?se=de=Ae=NaN:Ae<=0||Ae>=1?se=de=NaN:de<=0&&(se=NaN),new C(se,de,Ae,Le)}function z(se){if(se instanceof C)return new C(se.h,se.s,se.l,se.opacity);if(se instanceof x||(se=a(se)),!se)return new C;if(se instanceof C)return se;var de=(se=se.rgb()).r/255,Ae=se.g/255,Le=se.b/255,Me=Math.min(de,Ae,Le),De=Math.max(de,Ae,Le),Oe=NaN,Ie=De-Me,Qe=(De+Me)/2;return Ie?(Oe=de===De?(Ae-Le)/Ie+6*(Ae<Le):Ae===De?(Le-de)/Ie+2:(de-Ae)/Ie+4,Ie/=Qe<.5?De+Me:2-De-Me,Oe*=60):Ie=Qe>0&&Qe<1?0:Oe,new C(Oe,Ie,Qe,se.opacity)}function S(se,de,Ae,Le){return 1===arguments.length?z(se):new C(se,de,Ae,null==Le?1:Le)}function C(se,de,Ae,Le){this.h=+se,this.s=+de,this.l=+Ae,this.opacity=+Le}function R(se,de,Ae){return 255*(se<60?de+(Ae-de)*se/60:se<180?Ae:se<240?de+(Ae-de)*(240-se)/60:de)}t(x,a,{copy:function(se){return Object.assign(new this.constructor,this,se)},displayable:function(){return this.rgb().displayable()},hex:d,formatHex:d,formatHsl:function(){return z(this).formatHsl()},formatRgb:u,toString:u}),t(w,b,k(x,{brighter:function(se){return se=null==se?1/.7:Math.pow(1/.7,se),new w(this.r*se,this.g*se,this.b*se,this.opacity)},darker:function(se){return se=null==se?.7:Math.pow(.7,se),new w(this.r*se,this.g*se,this.b*se,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatRgb:L,toString:L})),t(C,S,k(x,{brighter:function(se){return se=null==se?1/.7:Math.pow(1/.7,se),new C(this.h,this.s,this.l*se,this.opacity)},darker:function(se){return se=null==se?.7:Math.pow(.7,se),new C(this.h,this.s,this.l*se,this.opacity)},rgb:function(){var se=this.h%360+360*(this.h<0),de=isNaN(se)||isNaN(this.s)?0:this.s,Ae=this.l,Le=Ae+(Ae<.5?Ae:1-Ae)*de,Me=2*Ae-Le;return new w(R(se>=240?se-240:se+120,Me,Le),R(se,Me,Le),R(se<120?se+240:se-120,Me,Le),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var se=this.opacity;return(1===(se=isNaN(se)?1:Math.max(0,Math.min(1,se)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===se?")":", "+se+")")}}));var D=Math.PI/180,j=180/Math.PI,q=6/29,Z=3*q*q;function W(se){if(se instanceof X)return new X(se.l,se.a,se.b,se.opacity);if(se instanceof K)return J(se);se instanceof w||(se=_(se));var de,Ae,Le=U(se.r),Me=U(se.g),De=U(se.b),Oe=ne((.2225045*Le+.7168786*Me+.0606169*De)/1);return Le===Me&&Me===De?de=Ae=Oe:(de=ne((.4360747*Le+.3850649*Me+.1430804*De)/.96422),Ae=ne((.0139322*Le+.0971045*Me+.7141733*De)/.82521)),new X(116*Oe-16,500*(de-Oe),200*(Oe-Ae),se.opacity)}function G(se,de,Ae,Le){return 1===arguments.length?W(se):new X(se,de,Ae,null==Le?1:Le)}function X(se,de,Ae,Le){this.l=+se,this.a=+de,this.b=+Ae,this.opacity=+Le}function ne(se){return se>.008856451679035631?Math.pow(se,1/3):se/Z+4/29}function V(se){return se>q?se*se*se:Z*(se-4/29)}function N(se){return 255*(se<=.0031308?12.92*se:1.055*Math.pow(se,1/2.4)-.055)}function U(se){return(se/=255)<=.04045?se/12.92:Math.pow((se+.055)/1.055,2.4)}function ee(se){if(se instanceof K)return new K(se.h,se.c,se.l,se.opacity);if(se instanceof X||(se=W(se)),0===se.a&&0===se.b)return new K(NaN,0<se.l&&se.l<100?0:NaN,se.l,se.opacity);var de=Math.atan2(se.b,se.a)*j;return new K(de<0?de+360:de,Math.sqrt(se.a*se.a+se.b*se.b),se.l,se.opacity)}function B(se,de,Ae,Le){return 1===arguments.length?ee(se):new K(se,de,Ae,null==Le?1:Le)}function K(se,de,Ae,Le){this.h=+se,this.c=+de,this.l=+Ae,this.opacity=+Le}function J(se){if(isNaN(se.h))return new X(se.l,0,0,se.opacity);var de=se.h*D;return new X(se.l,Math.cos(de)*se.c,Math.sin(de)*se.c,se.opacity)}t(X,G,k(x,{brighter:function(se){return new X(this.l+18*(null==se?1:se),this.a,this.b,this.opacity)},darker:function(se){return new X(this.l-18*(null==se?1:se),this.a,this.b,this.opacity)},rgb:function(){var se=(this.l+16)/116,de=isNaN(this.a)?se:se+this.a/500,Ae=isNaN(this.b)?se:se-this.b/200;return new w(N(3.1338561*(de=.96422*V(de))-1.6168667*(se=1*V(se))-.4906146*(Ae=.82521*V(Ae))),N(-.9787684*de+1.9161415*se+.033454*Ae),N(.0719453*de-.2289914*se+1.4052427*Ae),this.opacity)}})),t(K,B,k(x,{brighter:function(se){return new K(this.h,this.c,this.l+18*(null==se?1:se),this.opacity)},darker:function(se){return new K(this.h,this.c,this.l-18*(null==se?1:se),this.opacity)},rgb:function(){return J(this).rgb()}}));var ae=1.78277,ce=-.29227,oe=-.90649,ve=1.97294,fe=ve*oe,xe=ve*ae,Se=ae*ce- -.14861*oe;function pe(se){if(se instanceof Te)return new Te(se.h,se.s,se.l,se.opacity);se instanceof w||(se=_(se));var Ae=se.g/255,Le=se.b/255,Me=(Se*Le+fe*(se.r/255)-xe*Ae)/(Se+fe-xe),De=Le-Me,Oe=(ve*(Ae-Me)-ce*De)/oe,Ie=Math.sqrt(Oe*Oe+De*De)/(ve*Me*(1-Me)),Qe=Ie?Math.atan2(Oe,De)*j-120:NaN;return new Te(Qe<0?Qe+360:Qe,Ie,Me,se.opacity)}function ge(se,de,Ae,Le){return 1===arguments.length?pe(se):new Te(se,de,Ae,null==Le?1:Le)}function Te(se,de,Ae,Le){this.h=+se,this.s=+de,this.l=+Ae,this.opacity=+Le}t(Te,ge,k(x,{brighter:function(se){return se=null==se?1/.7:Math.pow(1/.7,se),new Te(this.h,this.s,this.l*se,this.opacity)},darker:function(se){return se=null==se?.7:Math.pow(.7,se),new Te(this.h,this.s,this.l*se,this.opacity)},rgb:function(){var se=isNaN(this.h)?0:(this.h+120)*D,de=+this.l,Ae=isNaN(this.s)?0:this.s*de*(1-de),Le=Math.cos(se),Me=Math.sin(se);return new w(255*(de+Ae*(-.14861*Le+ae*Me)),255*(de+Ae*(ce*Le+oe*Me)),255*(de+Ae*(ve*Le)),this.opacity)}})),g.color=a,g.cubehelix=ge,g.gray=function(se,de){return new X(se,0,0,null==de?1:de)},g.hcl=B,g.hsl=S,g.lab=G,g.lch=function(se,de,Ae,Le){return 1===arguments.length?ee(se):new K(Ae,de,se,null==Le?1:Le)},g.rgb=b,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],110:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";var t={value:function(){}};function k(){for(var c,n=0,m=arguments.length,p={};n<m;++n){if(!(c=arguments[n]+"")||c in p||/[\s.]/.test(c))throw new Error("illegal type: "+c);p[c]=[]}return new x(p)}function x(c){this._=c}function e(c,n){return c.trim().split(/^|\s+/).map(function(m){var p="",s=m.indexOf(".");if(s>=0&&(p=m.slice(s+1),m=m.slice(0,s)),m&&!n.hasOwnProperty(m))throw new Error("unknown type: "+m);return{type:m,name:p}})}function r(c,n){for(var m,p=0,s=c.length;p<s;++p)if((m=c[p]).name===n)return m.value}function i(c,n,m){for(var p=0,s=c.length;p<s;++p)if(c[p].name===n){c[p]=t,c=c.slice(0,p).concat(c.slice(p+1));break}return null!=m&&c.push({name:n,value:m}),c}x.prototype=k.prototype={constructor:x,on:function(c,n){var m,p=this._,s=e(c+"",p),f=-1,l=s.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++f<l;)if(m=(c=s[f]).type)p[m]=i(p[m],c.name,n);else if(null==n)for(m in p)p[m]=i(p[m],c.name,null);return this}for(;++f<l;)if((m=(c=s[f]).type)&&(m=r(p[m],c.name)))return m},copy:function(){var c={},n=this._;for(var m in n)c[m]=n[m].slice();return new x(c)},call:function(c,n){if((m=arguments.length-2)>0)for(var m,p,s=new Array(m),f=0;f<m;++f)s[f]=arguments[f+2];if(!this._.hasOwnProperty(c))throw new Error("unknown type: "+c);for(f=0,m=(p=this._[c]).length;f<m;++f)p[f].value.apply(n,s)},apply:function(c,n,m){if(!this._.hasOwnProperty(c))throw new Error("unknown type: "+c);for(var p=this._[c],s=0,f=p.length;s<f;++s)p[s].value.apply(n,m)}},g.dispatch=k,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],111:[function(v,Q,$){var g,t;g=this,t=function(g,t,k,x,e){"use strict";function r(o){return function(){return o}}function i(){return 1e-6*(Math.random()-.5)}function c(o){return o.x+o.vx}function n(o){return o.y+o.vy}function m(o){return o.index}function p(o,d){var u=o.get(d);if(!u)throw new Error("missing: "+d);return u}function s(o){return o.x}function f(o){return o.y}var l=Math.PI*(3-Math.sqrt(5));g.forceCenter=function(o,d){var u;function a(){var y,h,_=u.length,b=0,w=0;for(y=0;y<_;++y)b+=(h=u[y]).x,w+=h.y;for(b=b/_-o,w=w/_-d,y=0;y<_;++y)(h=u[y]).x-=b,h.y-=w}return null==o&&(o=0),null==d&&(d=0),a.initialize=function(y){u=y},a.x=function(y){return arguments.length?(o=+y,a):o},a.y=function(y){return arguments.length?(d=+y,a):d},a},g.forceCollide=function(o){var d,u,a=1,y=1;function h(){for(var w,T,L,M,P,z,S,C=d.length,R=0;R<y;++R)for(T=t.quadtree(d,c,n).visitAfter(_),w=0;w<C;++w)S=(z=u[(L=d[w]).index])*z,M=L.x+L.vx,P=L.y+L.vy,T.visit(D);function D(j,q,Z,W,G){var X=j.data,ne=j.r,V=z+ne;if(!X)return q>M+V||W<M-V||Z>P+V||G<P-V;if(X.index>L.index){var N=M-X.x-X.vx,U=P-X.y-X.vy,ee=N*N+U*U;ee<V*V&&(0===N&&(ee+=(N=i())*N),0===U&&(ee+=(U=i())*U),ee=(V-(ee=Math.sqrt(ee)))/ee*a,L.vx+=(N*=ee)*(V=(ne*=ne)/(S+ne)),L.vy+=(U*=ee)*V,X.vx-=N*(V=1-V),X.vy-=U*V)}}}function _(w){if(w.data)return w.r=u[w.data.index];for(var T=w.r=0;T<4;++T)w[T]&&w[T].r>w.r&&(w.r=w[T].r)}function b(){if(d){var w,T,L=d.length;for(u=new Array(L),w=0;w<L;++w)u[(T=d[w]).index]=+o(T,w,d)}}return"function"!=typeof o&&(o=r(null==o?1:+o)),h.initialize=function(w){d=w,b()},h.iterations=function(w){return arguments.length?(y=+w,h):y},h.strength=function(w){return arguments.length?(a=+w,h):a},h.radius=function(w){return arguments.length?(o="function"==typeof w?w:r(+w),b(),h):o},h},g.forceLink=function(o){var d,u,a,y,h,_=m,b=function(S){return 1/Math.min(y[S.source.index],y[S.target.index])},w=r(30),T=1;function L(S){for(var C=0,R=o.length;C<T;++C)for(var D,j,q,Z,W,G,X,ne=0;ne<R;++ne)j=(D=o[ne]).source,Z=(q=D.target).x+q.vx-j.x-j.vx||i(),W=q.y+q.vy-j.y-j.vy||i(),Z*=G=((G=Math.sqrt(Z*Z+W*W))-u[ne])/G*S*d[ne],W*=G,q.vx-=Z*(X=h[ne]),q.vy-=W*X,j.vx+=Z*(X=1-X),j.vy+=W*X}function M(){if(a){var S,C,R=a.length,D=o.length,j=k.map(a,_);for(S=0,y=new Array(R);S<D;++S)(C=o[S]).index=S,"object"!=typeof C.source&&(C.source=p(j,C.source)),"object"!=typeof C.target&&(C.target=p(j,C.target)),y[C.source.index]=(y[C.source.index]||0)+1,y[C.target.index]=(y[C.target.index]||0)+1;for(S=0,h=new Array(D);S<D;++S)h[S]=y[(C=o[S]).source.index]/(y[C.source.index]+y[C.target.index]);d=new Array(D),P(),u=new Array(D),z()}}function P(){if(a)for(var S=0,C=o.length;S<C;++S)d[S]=+b(o[S],S,o)}function z(){if(a)for(var S=0,C=o.length;S<C;++S)u[S]=+w(o[S],S,o)}return null==o&&(o=[]),L.initialize=function(S){a=S,M()},L.links=function(S){return arguments.length?(o=S,M(),L):o},L.id=function(S){return arguments.length?(_=S,L):_},L.iterations=function(S){return arguments.length?(T=+S,L):T},L.strength=function(S){return arguments.length?(b="function"==typeof S?S:r(+S),P(),L):b},L.distance=function(S){return arguments.length?(w="function"==typeof S?S:r(+S),z(),L):w},L},g.forceManyBody=function(){var o,d,u,a,y=r(-30),h=1,_=1/0,b=.81;function w(P){var z,S=o.length,C=t.quadtree(o,s,f).visitAfter(L);for(u=P,z=0;z<S;++z)d=o[z],C.visit(M)}function T(){if(o){var P,z,S=o.length;for(a=new Array(S),P=0;P<S;++P)a[(z=o[P]).index]=+y(z,P,o)}}function L(P){var z,S,C,R,D,j=0,q=0;if(P.length){for(C=R=D=0;D<4;++D)(z=P[D])&&(S=Math.abs(z.value))&&(j+=z.value,q+=S,C+=S*z.x,R+=S*z.y);P.x=C/q,P.y=R/q}else{(z=P).x=z.data.x,z.y=z.data.y;do{j+=a[z.data.index]}while(z=z.next)}P.value=j}function M(P,z,S,C){if(!P.value)return!0;var R=P.x-d.x,D=P.y-d.y,j=C-z,q=R*R+D*D;if(j*j/b<q)return q<_&&(0===R&&(q+=(R=i())*R),0===D&&(q+=(D=i())*D),q<h&&(q=Math.sqrt(h*q)),d.vx+=R*P.value*u/q,d.vy+=D*P.value*u/q),!0;if(!(P.length||q>=_)){(P.data!==d||P.next)&&(0===R&&(q+=(R=i())*R),0===D&&(q+=(D=i())*D),q<h&&(q=Math.sqrt(h*q)));do{P.data!==d&&(d.vx+=R*(j=a[P.data.index]*u/q),d.vy+=D*j)}while(P=P.next)}}return w.initialize=function(P){o=P,T()},w.strength=function(P){return arguments.length?(y="function"==typeof P?P:r(+P),T(),w):y},w.distanceMin=function(P){return arguments.length?(h=P*P,w):Math.sqrt(h)},w.distanceMax=function(P){return arguments.length?(_=P*P,w):Math.sqrt(_)},w.theta=function(P){return arguments.length?(b=P*P,w):Math.sqrt(b)},w},g.forceRadial=function(o,d,u){var a,y,h,_=r(.1);function b(T){for(var L=0,M=a.length;L<M;++L){var P=a[L],z=P.x-d||1e-6,S=P.y-u||1e-6,C=Math.sqrt(z*z+S*S),R=(h[L]-C)*y[L]*T/C;P.vx+=z*R,P.vy+=S*R}}function w(){if(a){var T,L=a.length;for(y=new Array(L),h=new Array(L),T=0;T<L;++T)h[T]=+o(a[T],T,a),y[T]=isNaN(h[T])?0:+_(a[T],T,a)}}return"function"!=typeof o&&(o=r(+o)),null==d&&(d=0),null==u&&(u=0),b.initialize=function(T){a=T,w()},b.strength=function(T){return arguments.length?(_="function"==typeof T?T:r(+T),w(),b):_},b.radius=function(T){return arguments.length?(o="function"==typeof T?T:r(+T),w(),b):o},b.x=function(T){return arguments.length?(d=+T,b):d},b.y=function(T){return arguments.length?(u=+T,b):u},b},g.forceSimulation=function(o){var d,u=1,a=.001,y=1-Math.pow(a,1/300),h=0,_=.6,b=k.map(),w=e.timer(L),T=x.dispatch("tick","end");function L(){M(),T.call("tick",d),u<a&&(w.stop(),T.call("end",d))}function M(S){var C,R,D=o.length;void 0===S&&(S=1);for(var j=0;j<S;++j)for(u+=(h-u)*y,b.each(function(q){q(u)}),C=0;C<D;++C)null==(R=o[C]).fx?R.x+=R.vx*=_:(R.x=R.fx,R.vx=0),null==R.fy?R.y+=R.vy*=_:(R.y=R.fy,R.vy=0);return d}function P(){for(var S,C=0,R=o.length;C<R;++C){if((S=o[C]).index=C,null!=S.fx&&(S.x=S.fx),null!=S.fy&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var D=10*Math.sqrt(C),j=C*l;S.x=D*Math.cos(j),S.y=D*Math.sin(j)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function z(S){return S.initialize&&S.initialize(o),S}return null==o&&(o=[]),P(),d={tick:M,restart:function(){return w.restart(L),d},stop:function(){return w.stop(),d},nodes:function(S){return arguments.length?(o=S,P(),b.each(z),d):o},alpha:function(S){return arguments.length?(u=+S,d):u},alphaMin:function(S){return arguments.length?(a=+S,d):a},alphaDecay:function(S){return arguments.length?(y=+S,d):+y},alphaTarget:function(S){return arguments.length?(h=+S,d):h},velocityDecay:function(S){return arguments.length?(_=1-S,d):1-_},force:function(S,C){return arguments.length>1?(null==C?b.remove(S):b.set(S,z(C)),d):b.get(S)},find:function(S,C,R){var D,j,q,Z,W,G=0,X=o.length;for(null==R?R=1/0:R*=R,G=0;G<X;++G)(q=(D=S-(Z=o[G]).x)*D+(j=C-Z.y)*j)<R&&(W=Z,R=q);return W},on:function(S,C){return arguments.length>1?(T.on(S,C),d):T.on(S)}}},g.forceX=function(o){var d,u,a,y=r(.1);function h(b){for(var w,T=0,L=d.length;T<L;++T)(w=d[T]).vx+=(a[T]-w.x)*u[T]*b}function _(){if(d){var b,w=d.length;for(u=new Array(w),a=new Array(w),b=0;b<w;++b)u[b]=isNaN(a[b]=+o(d[b],b,d))?0:+y(d[b],b,d)}}return"function"!=typeof o&&(o=r(null==o?0:+o)),h.initialize=function(b){d=b,_()},h.strength=function(b){return arguments.length?(y="function"==typeof b?b:r(+b),_(),h):y},h.x=function(b){return arguments.length?(o="function"==typeof b?b:r(+b),_(),h):o},h},g.forceY=function(o){var d,u,a,y=r(.1);function h(b){for(var w,T=0,L=d.length;T<L;++T)(w=d[T]).vy+=(a[T]-w.y)*u[T]*b}function _(){if(d){var b,w=d.length;for(u=new Array(w),a=new Array(w),b=0;b<w;++b)u[b]=isNaN(a[b]=+o(d[b],b,d))?0:+y(d[b],b,d)}}return"function"!=typeof o&&(o=r(null==o?0:+o)),h.initialize=function(b){d=b,_()},h.strength=function(b){return arguments.length?(y="function"==typeof b?b:r(+b),_(),h):y},h.y=function(b){return arguments.length?(o="function"==typeof b?b:r(+b),_(),h):o},h},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-quadtree"),v("d3-collection"),v("d3-dispatch"),v("d3-timer")):t(g.d3=g.d3||{},g.d3,g.d3,g.d3,g.d3)},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";function t(d,u){if((a=(d=u?d.toExponential(u-1):d.toExponential()).indexOf("e"))<0)return null;var a,y=d.slice(0,a);return[y.length>1?y[0]+y.slice(2):y,+d.slice(a+1)]}function k(d){return(d=t(Math.abs(d)))?d[1]:NaN}var x,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(d){if(!(u=e.exec(d)))throw new Error("invalid format: "+d);var u;return new i({fill:u[1],align:u[2],sign:u[3],symbol:u[4],zero:u[5],width:u[6],comma:u[7],precision:u[8]&&u[8].slice(1),trim:u[9],type:u[10]})}function i(d){this.fill=void 0===d.fill?" ":d.fill+"",this.align=void 0===d.align?">":d.align+"",this.sign=void 0===d.sign?"-":d.sign+"",this.symbol=void 0===d.symbol?"":d.symbol+"",this.zero=!!d.zero,this.width=void 0===d.width?void 0:+d.width,this.comma=!!d.comma,this.precision=void 0===d.precision?void 0:+d.precision,this.trim=!!d.trim,this.type=void 0===d.type?"":d.type+""}function c(d,u){var a=t(d,u);if(!a)return d+"";var y=a[0],h=a[1];return h<0?"0."+new Array(-h).join("0")+y:y.length>h+1?y.slice(0,h+1)+"."+y.slice(h+1):y+new Array(h-y.length+2).join("0")}r.prototype=i.prototype,i.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var n={"%":function(d,u){return(100*d).toFixed(u)},b:function(d){return Math.round(d).toString(2)},c:function(d){return d+""},d:function(d){return Math.abs(d=Math.round(d))>=1e21?d.toLocaleString("en").replace(/,/g,""):d.toString(10)},e:function(d,u){return d.toExponential(u)},f:function(d,u){return d.toFixed(u)},g:function(d,u){return d.toPrecision(u)},o:function(d){return Math.round(d).toString(8)},p:function(d,u){return c(100*d,u)},r:c,s:function(d,u){var a=t(d,u);if(!a)return d+"";var y=a[0],h=a[1],_=h-(x=3*Math.max(-8,Math.min(8,Math.floor(h/3))))+1,b=y.length;return _===b?y:_>b?y+new Array(_-b+1).join("0"):_>0?y.slice(0,_)+"."+y.slice(_):"0."+new Array(1-_).join("0")+t(d,Math.max(0,u+_-1))[0]},X:function(d){return Math.round(d).toString(16).toUpperCase()},x:function(d){return Math.round(d).toString(16)}};function m(d){return d}var p,s=Array.prototype.map,f=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function l(d){var u,a,z,y=void 0===d.grouping||void 0===d.thousands?m:(u=s.call(d.grouping,Number),a=d.thousands+"",function(z,S){for(var C=z.length,R=[],D=0,j=u[0],q=0;C>0&&j>0&&(q+j+1>S&&(j=Math.max(1,S-q)),R.push(z.substring(C-=j,C+j)),!((q+=j+1)>S));)j=u[D=(D+1)%u.length];return R.reverse().join(a)}),h=void 0===d.currency?"":d.currency[0]+"",_=void 0===d.currency?"":d.currency[1]+"",b=void 0===d.decimal?".":d.decimal+"",w=void 0===d.numerals?m:(z=s.call(d.numerals,String),function(S){return S.replace(/[0-9]/g,function(C){return z[+C]})}),T=void 0===d.percent?"%":d.percent+"",L=void 0===d.minus?"-":d.minus+"",M=void 0===d.nan?"NaN":d.nan+"";function P(z){var S=(z=r(z)).fill,C=z.align,R=z.sign,D=z.symbol,j=z.zero,q=z.width,Z=z.comma,W=z.precision,G=z.trim,X=z.type;"n"===X?(Z=!0,X="g"):n[X]||(void 0===W&&(W=12),G=!0,X="g"),(j||"0"===S&&"="===C)&&(j=!0,S="0",C="=");var ne="$"===D?h:"#"===D&&/[boxX]/.test(X)?"0"+X.toLowerCase():"",V="$"===D?_:/[%p]/.test(X)?T:"",N=n[X],U=/[defgprs%]/.test(X);function ee(B){var K,J,te,ae=ne,ce=V;if("c"===X)ce=N(B)+ce,B="";else{var oe=(B=+B)<0||1/B<0;if(B=isNaN(B)?M:N(Math.abs(B),W),G&&(B=function(xe){e:for(var Se,pe=xe.length,ge=1,Te=-1;ge<pe;++ge)switch(xe[ge]){case".":Te=Se=ge;break;case"0":0===Te&&(Te=ge),Se=ge;break;default:if(!+xe[ge])break e;Te>0&&(Te=0)}return Te>0?xe.slice(0,Te)+xe.slice(Se+1):xe}(B)),oe&&0==+B&&"+"!==R&&(oe=!1),ae=(oe?"("===R?R:L:"-"===R||"("===R?"":R)+ae,ce=("s"===X?f[8+x/3]:"")+ce+(oe&&"("===R?")":""),U)for(K=-1,J=B.length;++K<J;)if(48>(te=B.charCodeAt(K))||te>57){ce=(46===te?b+B.slice(K+1):B.slice(K))+ce,B=B.slice(0,K);break}}Z&&!j&&(B=y(B,1/0));var ve=ae.length+B.length+ce.length,fe=ve<q?new Array(q-ve+1).join(S):"";switch(Z&&j&&(B=y(fe+B,fe.length?q-ce.length:1/0),fe=""),C){case"<":B=ae+B+ce+fe;break;case"=":B=ae+fe+B+ce;break;case"^":B=fe.slice(0,ve=fe.length>>1)+ae+B+ce+fe.slice(ve);break;default:B=fe+ae+B+ce}return w(B)}return W=void 0===W?6:/[gprs]/.test(X)?Math.max(1,Math.min(21,W)):Math.max(0,Math.min(20,W)),ee.toString=function(){return z+""},ee}return{format:P,formatPrefix:function(z,S){var C=P(((z=r(z)).type="f",z)),R=3*Math.max(-8,Math.min(8,Math.floor(k(S)/3))),D=Math.pow(10,-R),j=f[8+R/3];return function(q){return C(D*q)+j}}}}function o(d){return p=l(d),g.format=p.format,g.formatPrefix=p.formatPrefix,p}o({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),g.FormatSpecifier=i,g.formatDefaultLocale=o,g.formatLocale=l,g.formatSpecifier=r,g.precisionFixed=function(d){return Math.max(0,-k(Math.abs(d)))},g.precisionPrefix=function(d,u){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(k(u)/3)))-k(Math.abs(d)))},g.precisionRound=function(d,u){return d=Math.abs(d),u=Math.abs(u)-d,Math.max(0,k(u)-k(d))+1},Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g="undefined"!=typeof globalThis?globalThis:g||self).d3=g.d3||{})},{}],113:[function(v,Q,$){var g,t;g=this,t=function(g,t,k){"use strict";var x=Math.abs,e=Math.atan,r=Math.atan2,i=Math.cos,c=Math.exp,n=Math.floor,m=Math.log,p=Math.max,s=Math.min,f=Math.pow,l=Math.round,o=Math.sign||function(qe){return qe>0?1:qe<0?-1:0},d=Math.sin,u=Math.tan,a=1e-6,y=Math.PI,h=y/2,_=y/4,b=Math.SQRT1_2,w=C(2),T=C(y),L=2*y,M=180/y,P=y/180;function z(qe){return qe>1?h:qe<-1?-h:Math.asin(qe)}function S(qe){return qe>1?0:qe<-1?y:Math.acos(qe)}function C(qe){return qe>0?Math.sqrt(qe):0}function R(qe){return(c(qe)-c(-qe))/2}function D(qe){return(c(qe)+c(-qe))/2}function j(qe){var We=u(qe/2),rt=2*m(i(qe/2))/(We*We);function ft(bt,vt){var Pt=i(bt),tn=i(vt),rn=d(vt),Qt=tn*Pt,un=-((1-Qt?m((1+Qt)/2)/(1-Qt):-.5)+rt/(1+Qt));return[un*tn*d(bt),un*rn]}return ft.invert=function(bt,vt){var Pt,tn=C(bt*bt+vt*vt),rn=-qe/2,Qt=50;if(!tn)return[0,0];do{var un=rn/2,xn=i(un),Sn=d(un),Cn=Sn/xn,Vn=-m(x(xn));rn-=Pt=(2/Cn*Vn-rt*Cn-tn)/(-Vn/(Sn*Sn)+1-rt/(2*xn*xn))*(xn<0?.7:1)}while(x(Pt)>a&&--Qt>0);var mr=d(rn);return[r(bt*mr,tn*i(rn)),z(vt*mr/tn)]},ft}function q(qe,We){var bt,rt=i(We),ft=(bt=S(rt*i(qe/=2)))?bt/Math.sin(bt):1;return[2*rt*d(qe)*ft,d(We)*ft]}function Z(qe){var We=d(qe),rt=i(qe),ft=qe>=0?1:-1,bt=u(ft*qe),vt=(1+We-rt)/2;function Pt(tn,rn){var Qt=i(rn),un=i(tn/=2);return[(1+Qt)*d(tn),(ft*rn>-r(un,bt)-.001?0:10*-ft)+vt+d(rn)*rt-(1+Qt)*We*un]}return Pt.invert=function(tn,rn){var Qt=0,un=0,xn=50;do{var Sn=i(Qt),Cn=d(Qt),Vn=i(un),mr=d(un),wr=1+Vn,qr=wr*Cn-tn,Gr=vt+mr*rt-wr*We*Sn-rn,ni=wr*Sn/2,Xr=-Cn*mr,Si=We*wr*Cn/2,Ni=rt*Vn+We*Sn*mr,$i=Xr*Si-Ni*ni,Qi=(Gr*Xr-qr*Ni)/$i/2,ea=(qr*Si-Gr*ni)/$i;x(ea)>2&&(ea/=2),Qt-=Qi,un-=ea}while((x(Qi)>a||x(ea)>a)&&--xn>0);return ft*un>-r(i(Qt),bt)-.001?[2*Qt,un]:null},Pt}function W(qe,We){var rt=u(We/2),ft=C(1-rt*rt),bt=1+ft*i(qe/=2),vt=d(qe)*ft/bt,Pt=rt/bt,tn=vt*vt,rn=Pt*Pt;return[4/3*vt*(3+tn-3*rn),4/3*Pt*(3+3*tn-rn)]}q.invert=function(qe,We){if(!(qe*qe+4*We*We>y*y+a)){var rt=qe,ft=We,bt=25;do{var vt,Pt=d(rt),tn=d(rt/2),rn=i(rt/2),Qt=d(ft),un=i(ft),xn=d(2*ft),Sn=Qt*Qt,Cn=un*un,Vn=tn*tn,mr=1-Cn*rn*rn,wr=mr?S(un*rn)*C(vt=1/mr):vt=0,qr=2*wr*un*tn-qe,Gr=wr*Qt-We,ni=vt*(Cn*Vn+wr*un*rn*Sn),Xr=vt*(.5*Pt*xn-2*wr*Qt*tn),Si=.25*vt*(xn*tn-wr*Qt*Cn*Pt),Ni=vt*(Sn*rn+wr*Vn*un),$i=Xr*Si-Ni*ni;if(!$i)break;var Qi=(Gr*Xr-qr*Ni)/$i,ea=(qr*Si-Gr*ni)/$i;rt-=Qi,ft-=ea}while((x(Qi)>a||x(ea)>a)&&--bt>0);return[rt,ft]}},W.invert=function(qe,We){if(We*=3/8,!(qe*=3/8)&&x(We)>1)return null;var Qt,rt=1+qe*qe+We*We,ft=C((rt-C(rt*rt-4*We*We))/2),bt=z(ft)/3,vt=ft?(Qt=x(We/ft),m(Qt+C(Qt*Qt-1))/3):function(Qt){return m(Qt+C(Qt*Qt+1))}(x(qe))/3,Pt=i(bt),tn=D(vt),rn=tn*tn-Pt*Pt;return[2*o(qe)*r(R(vt)*Pt,.25-rn),2*o(We)*r(tn*d(bt),.25+rn)]};var G=C(8),X=m(1+w);function ne(qe,We){var rt=x(We);return rt<_?[qe,m(u(_+We/2))]:[qe*i(rt)*(2*w-1/d(rt)),o(We)*(2*w*(rt-_)-m(u(rt/2)))]}function V(qe){var We=2*y/qe;function rt(ft,bt){var vt=t.geoAzimuthalEquidistantRaw(ft,bt);if(x(ft)>h){var Pt=r(vt[1],vt[0]),tn=C(vt[0]*vt[0]+vt[1]*vt[1]),rn=We*l((Pt-h)/We)+h,Qt=r(d(Pt-=rn),2-i(Pt));Pt=rn+z(y/tn*d(Qt))-Qt,vt[0]=tn*i(Pt),vt[1]=tn*d(Pt)}return vt}return rt.invert=function(ft,bt){var vt=C(ft*ft+bt*bt);if(vt>h){var Pt=r(bt,ft),tn=We*l((Pt-h)/We)+h,rn=Pt>tn?-1:1,Qt=vt*i(tn-Pt),un=1/u(rn*S((Qt-y)/C(y*(y-2*Qt)+vt*vt)));Pt=tn+2*e((un+rn*C(un*un-3))/3),ft=vt*i(Pt),bt=vt*d(Pt)}return t.geoAzimuthalEquidistantRaw.invert(ft,bt)},rt}function N(qe,We){if(arguments.length<2&&(We=qe),1===We)return t.geoAzimuthalEqualAreaRaw;if(We===1/0)return U;function rt(ft,bt){var vt=t.geoAzimuthalEqualAreaRaw(ft/We,bt);return vt[0]*=qe,vt}return rt.invert=function(ft,bt){var vt=t.geoAzimuthalEqualAreaRaw.invert(ft/qe,bt);return vt[0]*=We,vt},rt}function U(qe,We){return[qe*i(We)/i(We/=2),2*d(We)]}function ee(qe,We,rt){var ft,bt,vt,Pt=100;rt=void 0===rt?0:+rt,We=+We;do{(bt=qe(rt))===(vt=qe(rt+a))&&(vt=bt+a),rt-=ft=-1*a*(bt-We)/(bt-vt)}while(Pt-- >0&&x(ft)>a);return Pt<0?NaN:rt}function B(qe,We,rt){return void 0===We&&(We=40),void 0===rt&&(rt=1e-12),function(ft,bt,vt,Pt){var tn,rn,Qt;vt=void 0===vt?0:+vt,Pt=void 0===Pt?0:+Pt;for(var un=0;un<We;un++){var xn=qe(vt,Pt),Sn=xn[0]-ft,Cn=xn[1]-bt;if(x(Sn)<rt&&x(Cn)<rt)break;var Vn=Sn*Sn+Cn*Cn;if(Vn>tn)vt-=rn/=2,Pt-=Qt/=2;else{tn=Vn;var mr=(vt>0?-1:1)*rt,wr=(Pt>0?-1:1)*rt,qr=qe(vt+mr,Pt),Gr=qe(vt,Pt+wr),ni=(qr[0]-xn[0])/mr,Xr=(qr[1]-xn[1])/mr,Si=(Gr[0]-xn[0])/wr,Ni=(Gr[1]-xn[1])/wr,$i=Ni*ni-Xr*Si,Qi=(x($i)<.5?.5:1)/$i;if(vt+=rn=(Cn*Si-Sn*Ni)*Qi,Pt+=Qt=(Sn*Xr-Cn*ni)*Qi,x(rn)<rt&&x(Qt)<rt)break}}return[vt,Pt]}}function K(){var qe=N(1.68,2);function We(rt,ft){if(rt+ft<-1.4){var bt=(rt-ft+1.6)*(rt+ft+1.4)/8;rt+=bt,ft-=.8*bt*d(ft+y/2)}var vt=qe(rt,ft),Pt=(1-i(rt*ft))/12;return vt[1]<0&&(vt[0]*=1+Pt),vt[1]>0&&(vt[1]*=1+Pt/1.5*vt[0]*vt[0]),vt}return We.invert=B(We),We}function J(qe,We){var rt,ft=qe*d(We),bt=30;do{We-=rt=(We+d(We)-ft)/(1+i(We))}while(x(rt)>a&&--bt>0);return We/2}function te(qe,We,rt){function ft(bt,vt){return[qe*bt*i(vt=J(rt,vt)),We*d(vt)]}return ft.invert=function(bt,vt){return vt=z(vt/We),[bt/(qe*i(vt)),z((2*vt+d(2*vt))/rt)]},ft}ne.invert=function(qe,We){if((ft=x(We))<X)return[qe,2*e(c(We))-h];var rt,ft,bt=_,vt=25;do{var Pt=i(bt/2),tn=u(bt/2);bt-=rt=(G*(bt-_)-m(tn)-ft)/(G-Pt*Pt/(2*tn))}while(x(rt)>1e-12&&--vt>0);return[qe/(i(bt)*(G-1/d(bt))),o(We)*bt]},U.invert=function(qe,We){var rt=2*z(We/2);return[qe*i(rt/2)/i(rt),rt]};var ae=te(w/h,w,y),ce=2.00276;function ve(qe,We){var rt=J(y,We);return[ce*qe/(1/i(We)+1.11072/i(rt)),(We+w*d(rt))/ce]}function fe(qe){var We=0,rt=t.geoProjectionMutator(qe),ft=rt(We);return ft.parallel=function(bt){return arguments.length?rt(We=bt*P):We*M},ft}function xe(qe,We){return[qe*i(We),We]}function Se(qe){if(!qe)return xe;var We=1/u(qe);function rt(ft,bt){var vt=We+qe-bt,Pt=vt&&ft*i(bt)/vt;return[vt*d(Pt),We-vt*i(Pt)]}return rt.invert=function(ft,bt){var vt=C(ft*ft+(bt=We-bt)*bt),Pt=We+qe-vt;return[vt/i(Pt)*r(ft,bt),Pt]},rt}function pe(qe){function We(rt,ft){var bt=h-ft,vt=bt&&rt*qe*d(bt)/bt;return[bt*d(vt)/qe,h-bt*i(vt)]}return We.invert=function(rt,ft){var bt=rt*qe,vt=h-ft,Pt=C(bt*bt+vt*vt),tn=r(bt,vt);return[(Pt?Pt/d(Pt):1)*tn/qe,h-Pt]},We}ve.invert=function(qe,We){var rt,ft,bt=ce*We,vt=We<0?-_:_,Pt=25;do{ft=bt-w*d(vt),vt-=rt=(d(2*vt)+2*vt-y*d(ft))/(2*i(2*vt)+2+y*i(ft)*w*i(vt))}while(x(rt)>a&&--Pt>0);return ft=bt-w*d(vt),[qe*(1/i(ft)+1.11072/i(vt))/ce,ft]},xe.invert=function(qe,We){return[qe/i(We),We]};var ge=te(1,4/y,y);function Te(qe,We,rt,ft,bt,vt){var Pt,tn=i(vt);if(x(qe)>1||x(vt)>1)Pt=S(rt*bt+We*ft*tn);else{var rn=d(qe/2),Qt=d(vt/2);Pt=2*z(C(rn*rn+We*ft*Qt*Qt))}return x(Pt)>a?[Pt,r(ft*d(vt),We*bt-rt*ft*tn)]:[0,0]}function se(qe,We,rt){return S((qe*qe+We*We-rt*rt)/(2*qe*We))}function de(qe){return qe-2*y*n((qe+y)/(2*y))}function Ae(qe,We,rt){for(var ft,bt=[[qe[0],qe[1],d(qe[1]),i(qe[1])],[We[0],We[1],d(We[1]),i(We[1])],[rt[0],rt[1],d(rt[1]),i(rt[1])]],vt=bt[2],Pt=0;Pt<3;++Pt,vt=ft)vt.v=Te((ft=bt[Pt])[1]-vt[1],vt[3],vt[2],ft[3],ft[2],ft[0]-vt[0]),vt.point=[0,0];var tn=se(bt[0].v[0],bt[2].v[0],bt[1].v[0]),rn=se(bt[0].v[0],bt[1].v[0],bt[2].v[0]),Qt=y-tn;bt[2].point[1]=0,bt[0].point[0]=-(bt[1].point[0]=bt[0].v[0]/2);var un=[bt[2].point[0]=bt[0].point[0]+bt[2].v[0]*i(tn),2*(bt[0].point[1]=bt[1].point[1]=bt[2].v[0]*d(tn))];return function(xn,Sn){var Cn,Vn=d(Sn),mr=i(Sn),wr=new Array(3);for(Cn=0;Cn<3;++Cn){var qr=bt[Cn];if(wr[Cn]=Te(Sn-qr[1],qr[3],qr[2],mr,Vn,xn-qr[0]),!wr[Cn][0])return qr.point;wr[Cn][1]=de(wr[Cn][1]-qr.v[1])}var Gr=un.slice();for(Cn=0;Cn<3;++Cn){var Xr=se(bt[Cn].v[0],wr[Cn][0],wr[2==Cn?0:Cn+1][0]);wr[Cn][1]<0&&(Xr=-Xr),Cn?1==Cn?(Gr[0]-=wr[Cn][0]*i(Xr=rn-Xr),Gr[1]-=wr[Cn][0]*d(Xr)):(Gr[0]+=wr[Cn][0]*i(Xr=Qt-Xr),Gr[1]+=wr[Cn][0]*d(Xr)):(Gr[0]+=wr[Cn][0]*i(Xr),Gr[1]-=wr[Cn][0]*d(Xr))}return Gr[0]/=3,Gr[1]/=3,Gr}}function Le(qe){return qe[0]*=P,qe[1]*=P,qe}function Me(qe,We,rt){var ft=t.geoCentroid({type:"MultiPoint",coordinates:[qe,We,rt]}),bt=[-ft[0],-ft[1]],vt=t.geoRotation(bt),Pt=Ae(Le(vt(qe)),Le(vt(We)),Le(vt(rt)));Pt.invert=B(Pt);var tn=t.geoProjection(Pt).rotate(bt),rn=tn.center;return delete tn.rotate,tn.center=function(Qt){return arguments.length?rn(vt(Qt)):vt.invert(rn())},tn.clipAngle(90)}function De(qe,We){var rt=C(1-d(We));return[2/T*qe*rt,T*(1-rt)]}function Oe(qe){var We=u(qe);function rt(ft,bt){return[ft,(ft?ft/d(ft):1)*(d(bt)*i(ft)-We*i(bt))]}return rt.invert=We?function(ft,bt){ft&&(bt*=d(ft)/ft);var vt=i(ft);return[ft,2*r(C(vt*vt+We*We-bt*bt)-vt,We-bt)]}:function(ft,bt){return[ft,z(ft?bt*u(ft)/ft:bt)]},rt}De.invert=function(qe,We){var rt=(rt=We/T-1)*rt;return[rt>0?qe*C(y/rt)/2:0,z(1-rt)]};var Ie=C(3);function Qe(qe,We){return[Ie*qe*(2*i(2*We/3)-1)/T,Ie*T*d(We/3)]}function Ne(qe){var We=i(qe);function rt(ft,bt){return[ft*We,d(bt)/We]}return rt.invert=function(ft,bt){return[ft/We,z(bt*We)]},rt}function Pe(qe){var We=i(qe);function rt(ft,bt){return[ft*We,(1+We)*u(bt/2)]}return rt.invert=function(ft,bt){return[ft/We,2*e(bt/(1+We))]},rt}function Re(qe,We){var rt=C(8/(3*y));return[rt*qe*(1-x(We)/y),rt*We]}function Ge(qe,We){var rt=C(4-3*d(x(We)));return[2/C(6*y)*qe*rt,o(We)*C(2*y/3)*(2-rt)]}function tt(qe,We){var rt=C(y*(4+y));return[2/rt*qe*(1+C(1-4*We*We/(y*y))),4/rt*We]}function ct(qe,We){var rt=(2+h)*d(We);We/=2;for(var ft=0,bt=1/0;ft<10&&x(bt)>a;ft++){var vt=i(We);We-=bt=(We+d(We)*(vt+2)-rt)/(2*vt*(1+vt))}return[2/C(y*(4+y))*qe*(1+i(We)),2*C(y/(4+y))*d(We)]}function wt(qe,We){return[qe*(1+i(We))/C(2+y),2*We/C(2+y)]}function kt(qe,We){for(var rt=(1+h)*d(We),ft=0,bt=1/0;ft<10&&x(bt)>a;ft++)We-=bt=(We+d(We)-rt)/(1+i(We));return rt=C(2+y),[qe*(1+i(We))/rt,2*We/rt]}Qe.invert=function(qe,We){var rt=3*z(We/(Ie*T));return[T*qe/(Ie*(2*i(2*rt/3)-1)),rt]},Re.invert=function(qe,We){var rt=C(8/(3*y)),ft=We/rt;return[qe/(rt*(1-x(ft)/y)),ft]},Ge.invert=function(qe,We){var rt=2-x(We)/C(2*y/3);return[qe*C(6*y)/(2*rt),o(We)*z((4-rt*rt)/3)]},tt.invert=function(qe,We){var rt=C(y*(4+y))/2;return[qe*rt/(1+C(1-We*We*(4+y)/(4*y))),We*rt/2]},ct.invert=function(qe,We){var rt=We*C((4+y)/y)/2,ft=z(rt),bt=i(ft);return[qe/(2/C(y*(4+y))*(1+bt)),z((ft+rt*(bt+2))/(2+h))]},wt.invert=function(qe,We){var rt=C(2+y),ft=We*rt/2;return[rt*qe/(1+i(ft)),ft]},kt.invert=function(qe,We){var rt=1+h,ft=C(rt/2);return[2*qe*ft/(1+i(We*=ft)),z((We+d(We))/rt)]};var gt=3+2*w;function at(qe,We){var rt=d(qe/=2),ft=i(qe),bt=C(i(We)),vt=i(We/=2),Pt=d(We)/(vt+w*ft*bt),tn=C(2/(1+Pt*Pt)),rn=C((w*vt+(ft+rt)*bt)/(w*vt+(ft-rt)*bt));return[gt*(tn*(rn-1/rn)-2*m(rn)),gt*(tn*Pt*(rn+1/rn)-2*e(Pt))]}at.invert=function(qe,We){if(!(rt=W.invert(qe/1.2,1.065*We)))return null;var rt,ft=rt[0],bt=rt[1],vt=20;qe/=gt,We/=gt;do{var Pt=ft/2,tn=bt/2,rn=d(Pt),Qt=i(Pt),un=d(tn),xn=i(tn),Sn=i(bt),Cn=C(Sn),Vn=un/(xn+w*Qt*Cn),mr=Vn*Vn,wr=C(2/(1+mr)),qr=(w*xn+(Qt+rn)*Cn)/(w*xn+(Qt-rn)*Cn),Gr=C(qr),ni=Gr-1/Gr,Xr=Gr+1/Gr,Si=wr*ni-2*m(Gr)-qe,Ni=wr*Vn*Xr-2*e(Vn)-We,$i=un&&b*Cn*rn*mr/un,Qi=(w*Qt*xn+Cn)/(2*(xn+w*Qt*Cn)*(xn+w*Qt*Cn)*Cn),ea=-.5*Vn*wr*wr*wr,za=ea*$i,Ma=ea*Qi,ga=(ga=2*xn+w*Cn*(Qt-rn))*ga*Gr,va=(w*Qt*xn*Cn+Sn)/ga,Sa=-w*rn*un/(Cn*ga),Ja=ni*za-2*va/Gr+wr*(va+va/qr),lo=ni*Ma-2*Sa/Gr+wr*(Sa+Sa/qr),co=Vn*Xr*za-2*$i/(1+mr)+wr*Xr*$i+wr*Vn*(va-va/qr),uo=Vn*Xr*Ma-2*Qi/(1+mr)+wr*Xr*Qi+wr*Vn*(Sa-Sa/qr),fo=lo*co-uo*Ja;if(!fo)break;var Xi=(Ni*lo-Si*uo)/fo,mt=(Si*co-Ni*Ja)/fo;ft-=Xi,bt=p(-h,s(h,bt-mt))}while((x(Xi)>a||x(mt)>a)&&--vt>0);return x(x(bt)-h)<a?[0,bt]:vt&&[ft,bt]};var et=i(35*P);function yt(qe,We){var rt=u(We/2);return[qe*et*C(1-rt*rt),(1+et)*rt]}function Vt(qe,We){var rt=We/2,ft=i(rt);return[2*qe/T*i(We)*ft*ft,T*u(rt)]}function Gt(qe){var We=1-qe,rt=bt(y,0)[0]-bt(-y,0)[0],ft=C(2*(bt(0,h)[1]-bt(0,-h)[1])/rt);function bt(tn,rn){var Qt=i(rn),un=d(rn);return[Qt/(We+qe*Qt)*tn,We*rn+qe*un]}function vt(tn,rn){var Qt=bt(tn,rn);return[Qt[0]*ft,Qt[1]/ft]}function Pt(tn){return vt(0,tn)[1]}return vt.invert=function(tn,rn){var Qt=ee(Pt,rn);return[tn/ft*(qe+We/i(Qt)),Qt]},vt}function en(qe){return[qe[0]/2,z(u(qe[1]/2*P))*M]}function Jt(qe){return[2*qe[0],2*e(d(qe[1]*P))*M]}function cn(qe,We){var rt=2*y/We,ft=qe*qe;function bt(vt,Pt){var tn=t.geoAzimuthalEquidistantRaw(vt,Pt),rn=tn[0],Qt=tn[1],un=rn*rn+Qt*Qt;if(un>ft){var xn=C(un),Sn=r(Qt,rn),Cn=rt*l(Sn/rt),Vn=Sn-Cn,mr=qe*i(Vn),wr=(qe*d(Vn)-Vn*d(mr))/(h-mr),qr=Rt(Vn,wr),Gr=(y-qe)/je(qr,mr,y);rn=xn;var ni,Xr=50;do{rn-=ni=(qe+je(qr,mr,rn)*Gr-xn)/(qr(rn)*Gr)}while(x(ni)>a&&--Xr>0);Qt=Vn*d(rn),rn<h&&(Qt-=wr*(rn-h));var Si=d(Cn),Ni=i(Cn);tn[0]=rn*Ni-Qt*Si,tn[1]=rn*Si+Qt*Ni}return tn}return bt.invert=function(vt,Pt){var tn=vt*vt+Pt*Pt;if(tn>ft){var rn=C(tn),Qt=r(Pt,vt),un=rt*l(Qt/rt),xn=Qt-un;vt=rn*i(xn),Pt=rn*d(xn);for(var Sn=vt-h,Cn=d(vt),Vn=Pt/Cn,mr=vt<h?1/0:0,wr=10;;){var qr=qe*d(Vn),Gr=qe*i(Vn),ni=d(Gr),Xr=h-Gr,Si=(qr-Vn*ni)/Xr,Ni=Rt(Vn,Si);if(x(mr)<1e-12||!--wr)break;Vn-=mr=(Vn*Cn-Si*Sn-Pt)/(Cn-2*Sn*(Xr*(Gr+Vn*qr*i(Gr)-ni)-qr*(qr-Vn*ni))/(Xr*Xr))}vt=(rn=qe+je(Ni,Gr,vt)*(y-qe)/je(Ni,Gr,y))*i(Qt=un+Vn),Pt=rn*d(Qt)}return t.geoAzimuthalEquidistantRaw.invert(vt,Pt)},bt}function Rt(qe,We){return function(rt){var ft=qe*i(rt);return rt<h&&(ft-=We),C(1+ft*ft)}}function je(qe,We,rt){for(var ft=(rt-We)/50,bt=qe(We)+qe(rt),vt=1,Pt=We;vt<50;++vt)bt+=2*qe(Pt+=ft);return.5*bt*ft}function Ye(qe,We,rt,ft,bt,vt,Pt,tn){function rn(Qt,un){if(!un)return[qe*Qt/y,0];var xn=un*un,Sn=qe+xn*(We+xn*(rt+xn*ft)),Cn=un*(bt-1+xn*(vt-tn+xn*Pt)),Vn=(Sn*Sn+Cn*Cn)/(2*Cn),mr=Qt*z(Sn/Vn)/y;return[Vn*d(mr),un*(1+xn*tn)+Vn*(1-i(mr))]}return arguments.length<8&&(tn=0),rn.invert=function(Qt,un){var xn,Sn,Cn=y*Qt/qe,Vn=un,mr=50;do{var wr=Vn*Vn,qr=qe+wr*(We+wr*(rt+wr*ft)),Gr=Vn*(bt-1+wr*(vt-tn+wr*Pt)),ni=qr*qr+Gr*Gr,Xr=2*Gr,Si=ni/Xr,Ni=Si*Si,$i=z(qr/Si)/y,Qi=Cn*$i,ea=qr*qr,za=(2*We+wr*(4*rt+6*wr*ft))*Vn,Ma=bt+wr*(3*vt+5*wr*Pt),ga=(2*(qr*za+Gr*(Ma-1))*Xr-ni*(2*(Ma-1)))/(Xr*Xr),va=i(Qi),Sa=d(Qi),Ja=Si*va,lo=Si*Sa,co=Cn/y*(1/C(1-ea/Ni))*(za*Si-qr*ga)/Ni,uo=lo-Qt,fo=Vn*(1+wr*tn)+Si-Ja-un,Xi=ga*Sa+Ja*co,mt=Ja*$i,Bt=1+ga-(ga*va-lo*co),pn=lo*$i,Xt=Xi*pn-Bt*mt;if(!Xt)break;Cn-=xn=(fo*Xi-uo*Bt)/Xt,Vn-=Sn=(uo*pn-fo*mt)/Xt}while((x(xn)>a||x(Sn)>a)&&--mr>0);return[Cn,Vn]},rn}yt.invert=function(qe,We){var rt=We/(1+et);return[qe&&qe/(et*C(1-rt*rt)),2*e(rt)]},Vt.invert=function(qe,We){var rt=e(We/T),ft=i(rt),bt=2*rt;return[qe*T/2/(i(bt)*ft*ft),bt]};var he=Ye(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),be=Ye(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Fe=Ye(5/6*y,-.62636,-.0344,0,1.3493,-.05524,0,.045);function He(qe,We){var rt=qe*qe,ft=We*We;return[qe*(1-.162388*ft)*(.87-952426e-9*rt*rt),We*(1+ft/12)]}He.invert=function(qe,We){var rt,ft=qe,bt=We,vt=50;do{var Pt=bt*bt;bt-=rt=(bt*(1+Pt/12)-We)/(1+Pt/4)}while(x(rt)>a&&--vt>0);vt=50,qe/=1-.162388*Pt;do{var tn=(tn=ft*ft)*tn;ft-=rt=(ft*(.87-952426e-9*tn)-qe)/(.87-.00476213*tn)}while(x(rt)>a&&--vt>0);return[ft,bt]};var Ke=Ye(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Ze(qe){var We=qe(h,0)[0]-qe(-h,0)[0];function rt(ft,bt){var vt=ft>0?-.5:.5,Pt=qe(ft+vt*y,bt);return Pt[0]-=vt*We,Pt}return qe.invert&&(rt.invert=function(ft,bt){var vt=ft>0?-.5:.5,Pt=qe.invert(ft+vt*We,bt),tn=Pt[0]-vt*y;return tn<-y?tn+=2*y:tn>y&&(tn-=2*y),Pt[0]=tn,Pt}),rt}function ut(qe,We){var rt=o(qe),ft=o(We),bt=i(We),vt=i(qe)*bt,Pt=d(qe)*bt,tn=d(ft*We);qe=x(r(Pt,tn)),We=z(vt),x(qe-h)>a&&(qe%=h);var rn=function(Qt,un){if(un===h)return[0,0];var xn,Sn,Cn=d(un),Vn=Cn*Cn,mr=Vn*Vn,wr=1+mr,qr=1+3*mr,Gr=1-mr,ni=z(1/C(wr)),Xr=Gr+Vn*wr*ni,Si=(1-Cn)/Xr,Ni=C(Si),$i=Si*wr,Qi=C($i),ea=Ni*Gr;if(0===Qt)return[0,-(ea+Vn*Qi)];var za,Ma=i(un),ga=1/Ma,va=2*Cn*Ma,Sa=(-Xr*Ma-(-3*Vn+ni*qr)*va*(1-Cn))/(Xr*Xr),Ja=-ga*va,lo=-ga*(Vn*wr*Sa+Si*qr*va),co=-2*ga*(Gr*(.5*Sa/Ni)-2*Vn*Ni*va),uo=4*Qt/y;if(Qt>.222*y||un<y/4&&Qt>.175*y){if(xn=(ea+Vn*C($i*(1+mr)-ea*ea))/(1+mr),Qt>y/4)return[xn,xn];var fo=xn,Xi=.5*xn;xn=.5*(Xi+fo),Sn=50;do{var Bt=xn*(co+Ja*C($i-xn*xn))+lo*z(xn/Qi)-uo;if(!Bt)break;Bt<0?Xi=xn:fo=xn,xn=.5*(Xi+fo)}while(x(fo-Xi)>a&&--Sn>0)}else{xn=a,Sn=25;do{var pn=xn*xn,Xt=C($i-pn),dn=co+Ja*Xt,Fn=xn*dn+lo*z(xn/Qi)-uo;xn-=za=Xt?Fn/(dn+(lo-Ja*pn)/Xt):0}while(x(za)>a&&--Sn>0)}return[xn,-ea-Vn*C($i-xn*xn)]}(qe>y/4?h-qe:qe,We);return qe>y/4&&(tn=rn[0],rn[0]=-rn[1],rn[1]=-tn),rn[0]*=rt,rn[1]*=-ft,rn}function lt(qe,We){var rt,ft,bt,vt,Pt,tn;if(We<a)return[(vt=d(qe))-(rt=We*(qe-vt*(ft=i(qe)))/4)*ft,ft+rt*vt,1-We*vt*vt/2,qe-rt];if(We>=1-a)return rt=(1-We)/4,bt=1/(ft=D(qe)),[(vt=((tn=c(2*(tn=qe)))-1)/(tn+1))+rt*((Pt=ft*R(qe))-qe)/(ft*ft),bt-rt*vt*bt*(Pt-qe),bt+rt*vt*bt*(Pt+qe),2*e(c(qe))-h+rt*(Pt-qe)/ft];var rn=[1,0,0,0,0,0,0,0,0],Qt=[C(We),0,0,0,0,0,0,0,0],un=0;for(ft=C(1-We),Pt=1;x(Qt[un]/rn[un])>a&&un<8;)rt=rn[un++],Qt[un]=(rt-ft)/2,rn[un]=(rt+ft)/2,ft=C(rt*ft),Pt*=2;bt=Pt*rn[un]*qe;do{bt=(z(vt=Qt[un]*d(ft=bt)/rn[un])+bt)/2}while(--un);return[d(bt),vt=i(bt),vt/i(bt-ft),bt]}function Lt(qe,We){if(!We)return qe;if(1===We)return m(u(qe/2+_));for(var rt=1,ft=C(1-We),bt=C(We),vt=0;x(bt)>a;vt++){if(qe%y){var Pt=e(ft*u(qe)/rt);Pt<0&&(Pt+=y),qe+=Pt+~~(qe/y)*y}else qe+=qe;bt=(rt+ft)/2,ft=C(rt*ft),bt=((rt=bt)-ft)/2}return qe/(f(2,vt)*rt)}function Ot(qe,We){var Qt,un,xn,Sn,Cn,rt=(w-1)/(w+1),ft=C(1-rt*rt),bt=Lt(h,ft*ft),vt=m(u(y/4+x(We)/2)),Pt=c(-1*vt)/C(rt),tn=(Qt=Pt*i(-1*qe),Sn=(un=Pt*d(-1*qe))+1,[.5*((Qt>=0?h:-h)-r(Cn=1-(xn=Qt*Qt)-un*un,2*Qt)),-.25*m(Cn*Cn+4*xn)+.5*m(Sn*Sn+xn)]),rn=function(Qt,un,xn){var Sn=x(Qt),Cn=R(x(un));if(Sn){var Vn=1/d(Sn),mr=1/(u(Sn)*u(Sn)),wr=-(mr+xn*(Cn*Cn*Vn*Vn)-1+xn),qr=(-wr+C(wr*wr-(xn-1)*mr*4))/2;return[Lt(e(1/C(qr)),xn)*o(Qt),Lt(e(C((qr/mr-1)/xn)),1-xn)*o(un)]}return[0,Lt(e(Cn),1-xn)*o(un)]}(tn[0],tn[1],ft*ft);return[-rn[1],(We>=0?1:-1)*(.5*bt-rn[0])]}function ot(qe){var We=d(qe),rt=i(qe),ft=pt(qe);function bt(vt,Pt){var tn=ft(vt,Pt);vt=tn[0];var rn=d(Pt=tn[1]),Qt=i(Pt),un=i(vt),xn=S(We*rn+rt*Qt*un),Sn=d(xn),Cn=x(Sn)>a?xn/Sn:1;return[Cn*rt*d(vt),(x(vt)>h?Cn:-Cn)*(We*Qt-rt*rn*un)]}return ft.invert=pt(-qe),bt.invert=function(vt,Pt){var tn=C(vt*vt+Pt*Pt),rn=-d(tn),Qt=i(tn),un=tn*Qt,xn=-Pt*rn,Sn=tn*We,Cn=C(un*un+xn*xn-Sn*Sn),Vn=r(un*Sn+xn*Cn,xn*Sn-un*Cn),mr=(tn>h?-1:1)*r(vt*rn,tn*i(Vn)*Qt+Pt*d(Vn)*rn);return ft.invert(mr,Vn)},bt}function pt(qe){var We=d(qe),rt=i(qe);return function(ft,bt){var vt=i(bt),Pt=i(ft)*vt,tn=d(ft)*vt,rn=d(bt);return[r(tn,Pt*rt-rn*We),z(rn*rt+Pt*We)]}}ut.invert=function(qe,We){x(qe)>1&&(qe=2*o(qe)-qe),x(We)>1&&(We=2*o(We)-We);var rt=o(qe),ft=o(We),bt=-rt*qe,vt=-ft*We,Pt=vt/bt<1,tn=function(xn,Sn){for(var Cn=0,Vn=1,mr=.5,wr=50;;){var qr=mr*mr,Gr=C(mr),ni=z(1/C(1+qr)),Xr=1-qr+mr*(1+qr)*ni,Si=(1-Gr)/Xr,Ni=C(Si),$i=Si*(1+qr),Qi=Ni*(1-qr),ea=C($i-xn*xn),za=Sn+Qi+mr*ea;if(x(Vn-Cn)<1e-12||0==--wr||0===za)break;za>0?Cn=mr:Vn=mr,mr=.5*(Cn+Vn)}if(!wr)return null;var Ma=z(Gr),ga=i(Ma),va=1/ga,Sa=2*Gr*ga,Ja=(-Xr*ga-(-3*mr+ni*(1+3*qr))*Sa*(1-Gr))/(Xr*Xr);return[y/4*(xn*(-2*va*(.5*Ja/Ni*(1-qr)-2*mr*Ni*Sa)+-va*Sa*ea)+-va*(mr*(1+qr)*Ja+Si*(1+3*qr)*Sa)*z(xn/C($i))),Ma]}(Pt?vt:bt,Pt?bt:vt),rn=tn[0],Qt=tn[1],un=i(Qt);return Pt&&(rn=-h-rn),[rt*(r(d(rn)*un,-d(Qt))+y),ft*z(i(rn)*un)]},Ot.invert=function(qe,We){var rt,ft,bt,vt,Pt,tn,Cn,Vn,mr,rn=(w-1)/(w+1),Qt=C(1-rn*rn),xn=(ft=-qe,bt=Qt*Qt,(rt=.5*Lt(h,Qt*Qt)-We)?(vt=lt(rt,bt),ft?(tn=(Pt=lt(ft,1-bt))[1]*Pt[1]+bt*vt[0]*vt[0]*Pt[0]*Pt[0],[[vt[0]*Pt[2]/tn,vt[1]*vt[2]*Pt[0]*Pt[1]/tn],[vt[1]*Pt[1]/tn,-vt[0]*vt[2]*Pt[0]*Pt[2]/tn],[vt[2]*Pt[1]*Pt[2]/tn,-bt*vt[0]*vt[1]*Pt[0]/tn]]):[[vt[0],0],[vt[1],0],[vt[2],0]]):[[0,(Pt=lt(ft,1-bt))[0]/Pt[1]],[1/Pt[1],0],[Pt[2]/Pt[1],0]]),Sn=[((Cn=xn[0])[0]*(Vn=xn[1])[0]+Cn[1]*Vn[1])/(mr=Vn[0]*Vn[0]+Vn[1]*Vn[1]),(Cn[1]*Vn[0]-Cn[0]*Vn[1])/mr];return[r(Sn[1],Sn[0])/-1,2*e(c(-.5*m(rn*Sn[0]*Sn[0]+rn*Sn[1]*Sn[1])))-h]};var qt=z(1-1/3)*M,St=Ne(0);function Mt(qe){var We=qt*P,rt=De(y,We)[0]-De(-y,We)[0],ft=St(0,We)[1],bt=De(0,We)[1],vt=T-bt,Pt=L/qe,tn=4/L,rn=ft+vt*vt*4/L;function Qt(un,xn){var Sn,Cn=x(xn);if(Cn>We){var Vn=s(qe-1,p(0,n((un+y)/Pt)));(Sn=De(un+=y*(qe-1)/qe-Vn*Pt,Cn))[0]=Sn[0]*L/rt-L*(qe-1)/(2*qe)+Vn*L/qe,Sn[1]=ft+4*(Sn[1]-bt)*vt/L,xn<0&&(Sn[1]=-Sn[1])}else Sn=St(un,xn);return Sn[0]*=tn,Sn[1]/=rn,Sn}return Qt.invert=function(un,xn){un/=tn;var Sn=x(xn*=rn);if(Sn>ft){var Cn=s(qe-1,p(0,n((un+y)/Pt))),Vn=De.invert(un=(un+y*(qe-1)/qe-Cn*Pt)*rt/L,.25*(Sn-ft)*L/vt+bt);return Vn[0]-=y*(qe-1)/qe-Cn*Pt,xn<0&&(Vn[1]=-Vn[1]),Vn}return St.invert(un,xn)},Qt}function Ce(qe,We){return[qe,1&We?90-a:qt]}function Xe(qe,We){return[qe,1&We?-90+a:-qt]}function st(qe){return[qe[0]*(1-a),qe[1]]}function dt(qe){var We,rt=1+qe,ft=z(d(1/rt)),bt=2*C(y/(We=y+4*ft*rt)),vt=.5*bt*(rt+C(qe*(2+qe))),Pt=qe*qe,tn=rt*rt;function rn(Qt,un){var xn,Sn,Cn=1-d(un);if(Cn&&Cn<2){var Vn,mr=h-un,wr=25;do{var qr=d(mr),Gr=i(mr),ni=ft+r(qr,rt-Gr),Xr=1+tn-2*rt*Gr;mr-=Vn=(mr-Pt*ft-rt*qr+Xr*ni-.5*Cn*We)/(2*rt*qr*ni)}while(x(Vn)>1e-12&&--wr>0);xn=bt*C(Xr),Sn=Qt*ni/y}else xn=bt*(qe+Cn),Sn=Qt*ft/y;return[xn*d(Sn),vt-xn*i(Sn)]}return rn.invert=function(Qt,un){var xn=Qt*Qt+(un-=vt)*un,Sn=(1+tn-xn/(bt*bt))/(2*rt),Cn=S(Sn),Vn=d(Cn),mr=ft+r(Vn,rt-Sn);return[z(Qt/C(xn))*y/mr,z(1-2*(Cn-Pt*ft-rt*Vn+(1+tn-2*rt*Sn)*mr)/We)]},rn}function zt(qe,We){return We>-.7109889596207567?((qe=ae(qe,We))[1]+=.0528035274542,qe):xe(qe,We)}function Ht(qe,We){return x(We)>.7109889596207567?((qe=ae(qe,We))[1]-=We>0?.0528035274542:-.0528035274542,qe):xe(qe,We)}function Kt(qe,We,rt,ft){var bt=C(4*y/(2*rt+(1+qe-We/2)*d(2*rt)+(qe+We)/2*d(4*rt)+We/2*d(6*rt))),vt=C(ft*d(rt)*C((1+qe*i(2*rt)+We*i(4*rt))/(1+qe+We))),Pt=rt*rn(1);function tn(xn){return C(1+qe*i(2*xn)+We*i(4*xn))}function rn(xn){var Sn=xn*rt;return(2*Sn+(1+qe-We/2)*d(2*Sn)+(qe+We)/2*d(4*Sn)+We/2*d(6*Sn))/rt}function Qt(xn){return tn(xn)*d(xn)}var un=function(xn,Sn){var Cn=rt*ee(rn,Pt*d(Sn)/rt,Sn/y);isNaN(Cn)&&(Cn=rt*o(Sn));var Vn=bt*tn(Cn);return[Vn*vt*xn/y*i(Cn),Vn/vt*d(Cn)]};return un.invert=function(xn,Sn){var Cn=ee(Qt,Sn*vt/bt);return[xn*y/(i(Cn)*bt*vt*tn(Cn)),z(rt*rn(Cn/rt)/Pt)]},0===rt&&(bt=C(ft/y),(un=function(xn,Sn){return[xn*bt,d(Sn)/bt]}).invert=function(xn,Sn){return[xn/bt,z(Sn*bt)]}),un}function vn(qe,We,rt){function ft(Cn){return qe+(1-qe)*f(1-f(Cn,We),1/We)}function bt(Cn){return function Zt(qe,We,rt,ft,bt){void 0===ft&&(ft=1e-8),void 0===bt&&(bt=20);var vt=qe(We),Pt=qe(.5*(We+rt)),tn=qe(rt);return function rn(Qt,un,xn,Sn,Cn,Vn,mr,wr,qr,Gr,ni){if(ni.nanEncountered)return NaN;var Xr,Si,Ni,$i,Qi,ea,za,Ma,ga,va;if(Si=Qt(un+.25*(Xr=xn-un)),Ni=Qt(xn-.25*Xr),isNaN(Si))ni.nanEncountered=!0;else{if(!isNaN(Ni))return va=((ea=($i=Xr*(Sn+4*Si+Cn)/12)+(Qi=Xr*(Cn+4*Ni+Vn)/12))-mr)/15,Gr>qr?(ni.maxDepthCount++,ea+va):Math.abs(va)<wr?ea+va:(Ma=rn(Qt,un,za=un+.5*Xr,Sn,Si,Cn,$i,.5*wr,qr,Gr+1,ni),isNaN(Ma)?(ni.nanEncountered=!0,NaN):(ga=rn(Qt,za,xn,Cn,Ni,Vn,Qi,.5*wr,qr,Gr+1,ni),isNaN(ga)?(ni.nanEncountered=!0,NaN):Ma+ga));ni.nanEncountered=!0}}(qe,We,rt,vt,Pt,tn,(vt+4*Pt+tn)*(rt-We)/6,ft,bt,1,{maxDepthCount:0,nanEncountered:!1})}(ft,0,Cn,1e-4)}for(var vt=1/bt(1),tn=(1+1e-8)*vt,rn=[],Qt=0;Qt<=1e3;Qt++)rn.push(bt(Qt/1e3)*tn);function un(Cn){var Vn=0,mr=1e3,wr=500;do{rn[wr]>Cn?mr=wr:Vn=wr,wr=Vn+mr>>1}while(wr>Vn);var qr=rn[wr+1]-rn[wr];return qr&&(qr=(Cn-rn[wr+1])/qr),(wr+1+qr)/1e3}var xn=2*un(1)/y*vt/rt,Sn=function(Cn,Vn){var mr=un(x(d(Vn))),wr=ft(mr)*Cn;return mr/=xn,[wr,Vn>=0?mr:-mr]};return Sn.invert=function(Cn,Vn){var mr;return x(Vn*=xn)<1&&(mr=o(Vn)*z(bt(x(Vn))*vt)),[Cn/ft(x(Vn)),mr]},Sn}function zn(qe,We){return x(qe[0]-We[0])<a&&x(qe[1]-We[1])<a}function gn(qe,We){for(var rt,ft,bt,vt=-1,Pt=qe.length,tn=qe[0],rn=[];++vt<Pt;){ft=((rt=qe[vt])[0]-tn[0])/We,bt=(rt[1]-tn[1])/We;for(var Qt=0;Qt<We;++Qt)rn.push([tn[0]+Qt*ft,tn[1]+Qt*bt]);tn=rt}return rn.push(rt),rn}function nn(qe){var We,rt,bt,vt,tn,rn=[],Qt=qe[0].length;for(tn=0;tn<Qt;++tn)rt=(We=qe[0][tn])[0][0],rn.push(gn([[rt+a,We[0][1]+a],[rt+a,(bt=We[1][1])-a],[(vt=We[2][0])-a,bt-a],[vt-a,We[2][1]+a]],30));for(tn=qe[1].length-1;tn>=0;--tn)rt=(We=qe[1][tn])[0][0],rn.push(gn([[(vt=We[2][0])-a,We[2][1]-a],[vt-a,(bt=We[1][1])+a],[rt+a,bt+a],[rt+a,We[0][1]-a]],30));return{type:"Polygon",coordinates:[k.merge(rn)]}}function an(qe,We,rt){var ft,bt;function vt(rn,Qt){for(var un=Qt<0?-1:1,xn=We[+(Qt<0)],Sn=0,Cn=xn.length-1;Sn<Cn&&rn>xn[Sn][2][0];++Sn);var Vn=qe(rn-xn[Sn][1][0],Qt);return Vn[0]+=qe(xn[Sn][1][0],un*Qt>un*xn[Sn][0][1]?xn[Sn][0][1]:Qt)[0],Vn}rt?vt.invert=rt(vt):qe.invert&&(vt.invert=function(rn,Qt){for(var un=bt[+(Qt<0)],xn=We[+(Qt<0)],Sn=0,Cn=un.length;Sn<Cn;++Sn){var Vn=un[Sn];if(Vn[0][0]<=rn&&rn<Vn[1][0]&&Vn[0][1]<=Qt&&Qt<Vn[1][1]){var mr=qe.invert(rn-qe(xn[Sn][1][0],0)[0],Qt);return mr[0]+=xn[Sn][1][0],zn(vt(mr[0],mr[1]),[rn,Qt])?mr:null}}});var Pt=t.geoProjection(vt),tn=Pt.stream;return Pt.stream=function(rn){var Qt=Pt.rotate(),un=tn(rn),xn=(Pt.rotate([0,0]),tn(rn));return Pt.rotate(Qt),un.sphere=function(){t.geoStream(ft,xn)},un},Pt.lobes=function(rn){return arguments.length?(ft=nn(rn),We=rn.map(function(Qt){return Qt.map(function(un){return[[un[0][0]*P,un[0][1]*P],[un[1][0]*P,un[1][1]*P],[un[2][0]*P,un[2][1]*P]]})}),bt=We.map(function(Qt){return Qt.map(function(un){var xn,Sn=qe(un[0][0],un[0][1])[0],Cn=qe(un[2][0],un[2][1])[0],Vn=qe(un[1][0],un[0][1])[1],mr=qe(un[1][0],un[1][1])[1];return Vn>mr&&(xn=Vn,Vn=mr,mr=xn),[[Sn,Vn],[Cn,mr]]})}),Pt):We.map(function(Qt){return Qt.map(function(un){return[[un[0][0]*M,un[0][1]*M],[un[1][0]*M,un[1][1]*M],[un[2][0]*M,un[2][1]*M]]})})},null!=We&&Pt.lobes(We),Pt}zt.invert=function(qe,We){return We>-.7109889596207567?ae.invert(qe,We-.0528035274542):xe.invert(qe,We)},Ht.invert=function(qe,We){return x(We)>.7109889596207567?ae.invert(qe,We+(We>0?.0528035274542:-.0528035274542)):xe.invert(qe,We)};var on=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],mn=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],_n=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Pn=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Rn=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],qn=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Xn(qe,We){return[3/L*qe*C(y*y/3-We*We),We]}function br(qe){function We(rt,ft){if(x(x(ft)-h)<a)return[0,ft<0?-2:2];var bt=d(ft),vt=f((1+bt)/(1-bt),qe/2),Pt=.5*(vt+1/vt)+i(rt*=qe);return[2*d(rt)/Pt,(vt-1/vt)/Pt]}return We.invert=function(rt,ft){var bt=x(ft);if(x(bt-2)<a)return rt?null:[0,o(ft)*h];if(bt>2)return null;var vt=(rt/=2)*rt,Pt=(ft/=2)*ft,tn=2*ft/(1+vt+Pt);return tn=f((1+tn)/(1-tn),1/qe),[r(2*rt,1-vt-Pt)/qe,z((tn-1)/(tn+1))]},We}Xn.invert=function(qe,We){return[L/3*qe/C(y*y/3-We*We),We]};var fr=y/w;function Vr(qe,We){return[qe*(1+C(i(We)))/2,We/(i(We/2)*i(qe/6))]}function cr(qe,We){var rt=qe*qe,ft=We*We;return[qe*(.975534+ft*(-.0143059*rt-.119161+-.0547009*ft)),We*(1.00384+rt*(.0802894+-.02855*ft+199025e-9*rt)+ft*(.0998909+-.0491032*ft))]}function Sr(qe,We){return[d(qe)/i(We),u(We)*i(qe)]}function Cr(qe){var We=i(qe),rt=u(_+qe/2);function ft(bt,vt){var Pt=vt-qe,tn=x(Pt)<a?bt*We:x(tn=_+vt/2)<a||x(x(tn)-h)<a?0:bt*Pt/m(u(tn)/rt);return[tn,Pt]}return ft.invert=function(bt,vt){var Pt,tn=vt+qe;return[x(vt)<a?bt/We:x(Pt=_+tn/2)<a||x(x(Pt)-h)<a?0:bt*m(u(Pt)/rt)/vt,tn]},ft}function pi(qe,We){return[qe,1.25*m(u(_+.4*We))]}function Yn(qe){var We=qe.length-1;function rt(ft,bt){for(var vt,Pt=i(bt),tn=2/(1+Pt*i(ft)),rn=tn*Pt*d(ft),Qt=tn*d(bt),un=We,xn=qe[un],Sn=xn[0],Cn=xn[1];--un>=0;)Sn=(xn=qe[un])[0]+rn*(vt=Sn)-Qt*Cn,Cn=xn[1]+rn*Cn+Qt*vt;return[Sn=rn*(vt=Sn)-Qt*Cn,Cn=rn*Cn+Qt*vt]}return rt.invert=function(ft,bt){var vt=20,Pt=ft,tn=bt;do{for(var rn,Qt=We,un=qe[Qt],xn=un[0],Sn=un[1],Cn=0,Vn=0;--Qt>=0;)Cn=xn+Pt*(rn=Cn)-tn*Vn,Vn=Sn+Pt*Vn+tn*rn,xn=(un=qe[Qt])[0]+Pt*(rn=xn)-tn*Sn,Sn=un[1]+Pt*Sn+tn*rn;var mr,wr,qr=(Cn=xn+Pt*(rn=Cn)-tn*Vn)*Cn+(Vn=Sn+Pt*Vn+tn*rn)*Vn;Pt-=mr=((xn=Pt*(rn=xn)-tn*Sn-ft)*Cn+(Sn=Pt*Sn+tn*rn-bt)*Vn)/qr,tn-=wr=(Sn*Cn-xn*Vn)/qr}while(x(mr)+x(wr)>1e-12&&--vt>0);if(vt){var Gr=C(Pt*Pt+tn*tn),ni=2*e(.5*Gr),Xr=d(ni);return[r(Pt*Xr,Gr*i(ni)),Gr?z(tn*Xr/Gr):0]}},rt}Vr.invert=function(qe,We){var rt=x(qe),ft=x(We),bt=a,vt=h;ft<fr?vt*=ft/fr:bt+=6*S(fr/ft);for(var Pt=0;Pt<25;Pt++){var tn=d(vt),rn=C(i(vt)),Qt=d(vt/2),un=i(vt/2),xn=d(bt/6),Sn=i(bt/6),Cn=.5*bt*(1+rn)-rt,Vn=vt/(un*Sn)-ft,mr=rn?-.25*bt*tn/rn:0,wr=.5*(1+rn),qr=(1+.5*vt*Qt/un)/(un*Sn),Gr=vt/un*(xn/6)/(Sn*Sn),ni=mr*Gr-qr*wr,Xr=(Cn*Gr-Vn*wr)/ni,Si=(Vn*mr-Cn*qr)/ni;if(vt-=Xr,bt-=Si,x(Xr)<a&&x(Si)<a)break}return[qe<0?-bt:bt,We<0?-vt:vt]},cr.invert=function(qe,We){var rt=o(qe)*y,ft=We/2,bt=50;do{var vt=rt*rt,Pt=ft*ft,tn=rt*ft,rn=rt*(.975534+Pt*(-.0143059*vt-.119161+-.0547009*Pt))-qe,Qt=ft*(1.00384+vt*(.0802894+-.02855*Pt+199025e-9*vt)+Pt*(.0998909+-.0491032*Pt))-We,un=.975534-Pt*(.119161+3*vt*.0143059+.0547009*Pt),xn=-tn*(.238322+.2188036*Pt+.0286118*vt),Sn=tn*(.1605788+7961e-7*vt+-.0571*Pt),Cn=1.00384+vt*(.0802894+199025e-9*vt)+Pt*(3*(.0998909-.02855*vt)-.245516*Pt),Vn=xn*Sn-Cn*un,mr=(Qt*xn-rn*Cn)/Vn,wr=(rn*Sn-Qt*un)/Vn;rt-=mr,ft-=wr}while((x(mr)>a||x(wr)>a)&&--bt>0);return bt&&[rt,ft]},Sr.invert=function(qe,We){var rt=qe*qe,ft=We*We+1,bt=rt+ft,vt=qe?b*C((bt-C(bt*bt-4*rt))/rt):1/C(ft);return[z(qe*vt),o(We)*S(vt)]},pi.invert=function(qe,We){return[qe,2.5*e(c(.8*We))-.625*y]};var ar=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Ar=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],sr=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],dr=[[.9245,0],[0,0],[.01943,0]],$r=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Lr(qe,We){var rt=t.geoProjection(Yn(qe)).rotate(We).clipAngle(90),ft=t.geoRotation(We),bt=rt.center;return delete rt.rotate,rt.center=function(vt){return arguments.length?bt(ft(vt)):ft.invert(bt())},rt}var jr=C(6),ri=C(7);function sn(qe,We){var rt=z(7*d(We)/(3*jr));return[jr*qe*(2*i(2*rt/3)-1)/ri,9*d(rt/3)/ri]}function wn(qe,We){for(var rt,ft=(1+b)*d(We),bt=We,vt=0;vt<25&&(bt-=rt=(d(bt/2)+d(bt)-ft)/(.5*i(bt/2)+i(bt)),!(x(rt)<a));vt++);return[qe*(1+2*i(bt)/i(bt/2))/(3*w),2*C(3)*d(bt/2)/C(2+w)]}function It(qe,We){for(var rt,ft=C(6/(4+y)),bt=(1+y/4)*d(We),vt=We/2,Pt=0;Pt<25&&(vt-=rt=(vt/2+d(vt)-bt)/(.5+i(vt)),!(x(rt)<a));Pt++);return[ft*(.5+i(vt))*qe/1.5,ft*vt]}function hn(qe,We){var rt=We*We,ft=rt*rt,bt=rt*ft;return[qe*(.84719-.13063*rt+bt*bt*(.05494*rt-.04515-.02326*ft+.00331*bt)),We*(1.01183+ft*ft*(.01926*rt-.02625-.00396*ft))]}function yn(qe,We){return[qe*(1+i(We))/2,2*(We-u(We/2))]}sn.invert=function(qe,We){var rt=3*z(We*ri/9);return[qe*ri/(jr*(2*i(2*rt/3)-1)),z(3*d(rt)*jr/7)]},wn.invert=function(qe,We){var rt=We*C(2+w)/(2*C(3)),ft=2*z(rt);return[3*w*qe/(1+2*i(ft)/i(ft/2)),z((rt+d(ft))/(1+b))]},It.invert=function(qe,We){var rt=C(6/(4+y)),ft=We/rt;return x(x(ft)-h)<a&&(ft=ft<0?-h:h),[1.5*qe/(rt*(.5+i(ft))),z((ft/2+d(ft))/(1+y/4))]},hn.invert=function(qe,We){var rt,ft,bt,vt,Pt=We,tn=25;do{Pt-=rt=(Pt*(1.01183+(bt=(ft=Pt*Pt)*ft)*bt*(.01926*ft-.02625-.00396*bt))-We)/(1.01183+bt*bt*(.21186*ft-.23625+-.05148*bt))}while(x(rt)>1e-12&&--tn>0);return[qe/(.84719-.13063*(ft=Pt*Pt)+(vt=ft*(bt=ft*ft))*vt*(.05494*ft-.04515-.02326*bt+.00331*vt)),Pt]},yn.invert=function(qe,We){for(var rt=We/2,ft=0,bt=1/0;ft<10&&x(bt)>a;++ft){var vt=i(We/2);We-=bt=(We-u(We/2)-rt)/(1-.5/(vt*vt))}return[2*qe/(1+i(We)),We]};var Hn=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Un(qe,We){var rt=d(We),ft=i(We),bt=o(qe);if(0===qe||x(We)===h)return[0,We];if(0===We)return[qe,0];if(x(qe)===h)return[qe*ft,h*rt];var vt=y/(2*qe)-2*qe/y,Pt=2*We/y,tn=(1-Pt*Pt)/(rt-Pt),rn=vt*vt,Qt=tn*tn,un=1+rn/Qt,xn=1+Qt/rn,Sn=(vt*rt/tn-vt/2)/un,Cn=(Qt*rt/rn+tn/2)/xn,Vn=Cn*Cn-(Qt*rt*rt/rn+tn*rt-1)/xn;return[h*(Sn+C(Sn*Sn+ft*ft/un)*bt),h*(Cn+C(Vn<0?0:Vn)*o(-We*vt)*bt)]}function jn(qe,We){var rt=We*We;return[qe,We*(1.0148+rt*rt*(.23185+rt*(.02406*rt-.14499)))]}function On(qe,We){if(x(We)<a)return[qe,0];var rt=u(We),ft=qe*d(We);return[d(ft)/rt,We+(1-i(ft))/rt]}function Mn(qe,We){return[qe[0]*We[0]+qe[1]*We[3],qe[0]*We[1]+qe[1]*We[4],qe[0]*We[2]+qe[1]*We[5]+qe[2],qe[3]*We[0]+qe[4]*We[3],qe[3]*We[1]+qe[4]*We[4],qe[3]*We[2]+qe[4]*We[5]+qe[5]]}function Ln(qe,We){return[qe[0]-We[0],qe[1]-We[1]]}function Dn(qe){return C(qe[0]*qe[0]+qe[1]*qe[1])}function Kn(qe,We,rt){function ft(Pt,tn){var rn,Qt=We(Pt,tn),un=Qt.project([Pt*M,tn*M]);return(rn=Qt.transform)?[rn[0]*un[0]+rn[1]*un[1]+rn[2],-(rn[3]*un[0]+rn[4]*un[1]+rn[5])]:(un[1]=-un[1],un)}(function Pt(tn,rn){if(tn.edges=function(Vn){for(var mr=Vn.length,wr=[],qr=Vn[mr-1],Gr=0;Gr<mr;++Gr)wr.push([qr,qr=Vn[Gr]]);return wr}(tn.face),rn.face){var Qt=tn.shared=function(Vn,mr){for(var wr,qr,Gr=Vn.length,ni=null,Xr=0;Xr<Gr;++Xr){wr=Vn[Xr];for(var Si=mr.length;--Si>=0;)if(wr[0]===(qr=mr[Si])[0]&&wr[1]===qr[1]){if(ni)return[ni,wr];ni=wr}}}(tn.face,rn.face),un=function kn(qe,We){var Pt,tn,rt=Ln(qe[1],qe[0]),ft=Ln(We[1],We[0]),bt=r((Pt=rt)[0]*(tn=ft)[1]-Pt[1]*tn[0],Pt[0]*tn[0]+Pt[1]*tn[1]),vt=Dn(rt)/Dn(ft);return Mn([1,0,qe[0][0],0,1,qe[0][1]],Mn([vt,0,0,0,vt,0],Mn([i(bt),d(bt),0,-d(bt),i(bt),0],[1,0,-We[0][0],0,1,-We[0][1]])))}(Qt.map(rn.project),Qt.map(tn.project));tn.transform=rn.transform?Mn(rn.transform,un):un;for(var xn=rn.edges,Sn=0,Cn=xn.length;Sn<Cn;++Sn)Qn(Qt[0],xn[Sn][1])&&Qn(Qt[1],xn[Sn][0])&&(xn[Sn]=tn),Qn(Qt[0],xn[Sn][0])&&Qn(Qt[1],xn[Sn][1])&&(xn[Sn]=tn);for(Sn=0,Cn=(xn=tn.edges).length;Sn<Cn;++Sn)Qn(Qt[0],xn[Sn][0])&&Qn(Qt[1],xn[Sn][1])&&(xn[Sn]=rn),Qn(Qt[0],xn[Sn][1])&&Qn(Qt[1],xn[Sn][0])&&(xn[Sn]=rn)}else tn.transform=rn.transform;return tn.children&&tn.children.forEach(function(Vn){Pt(Vn,tn)}),tn})(qe,{transform:null}),lr(qe)&&(ft.invert=function(Pt,tn){var rn=function Qt(un,xn){var ni,Xr,Sn=un.project.invert,Cn=un.transform,Vn=xn;if(Cn&&(Vn=[(Cn=[(Xr=1/((ni=Cn)[0]*ni[4]-ni[1]*ni[3]))*ni[4],-Xr*ni[1],Xr*(ni[1]*ni[5]-ni[2]*ni[4]),-Xr*ni[3],Xr*ni[0],Xr*(ni[2]*ni[3]-ni[0]*ni[5])])[0]*Vn[0]+Cn[1]*Vn[1]+Cn[2],Cn[3]*Vn[0]+Cn[4]*Vn[1]+Cn[5]]),Sn&&un===function(ni){return We(ni[0]*P,ni[1]*P)}(mr=Sn(Vn)))return mr;for(var mr,wr=un.children,qr=0,Gr=wr&&wr.length;qr<Gr;++qr)if(mr=Qt(wr[qr],xn))return mr}(qe,[Pt,-tn]);return rn&&(rn[0]*=P,rn[1]*=P,rn)});var bt=t.geoProjection(ft),vt=bt.stream;return bt.stream=function(Pt){var tn=bt.rotate(),rn=vt(Pt),Qt=(bt.rotate([0,0]),vt(Pt));return bt.rotate(tn),rn.sphere=function(){Qt.polygonStart(),Qt.lineStart(),function un(xn,Sn,Cn){var Vn,mr,wr=Sn.edges,qr=wr.length,Gr={type:"MultiPoint",coordinates:Sn.face},ni=Sn.face.filter(function(za){return 90!==x(za[1])}),Xr=t.geoBounds({type:"MultiPoint",coordinates:ni}),Si=!1,Ni=-1,$i=Xr[1][0]-Xr[0][0],Qi=180===$i||360===$i?[(Xr[0][0]+Xr[1][0])/2,(Xr[0][1]+Xr[1][1])/2]:t.geoCentroid(Gr);if(Cn)for(;++Ni<qr&&wr[Ni]!==Cn;);++Ni;for(var ea=0;ea<qr;++ea)mr=wr[(ea+Ni)%qr],Array.isArray(mr)?(Si||(xn.point((Vn=t.geoInterpolate(mr[0],Qi)(a))[0],Vn[1]),Si=!0),xn.point((Vn=t.geoInterpolate(mr[1],Qi)(a))[0],Vn[1])):(Si=!1,mr!==Cn&&un(xn,mr,Sn))}(Qt,qe),Qt.lineEnd(),Qt.polygonEnd()},rn},bt.angle(null==rt?-30:rt*M)}function Qn(qe,We){return qe&&We&&qe[0]===We[0]&&qe[1]===We[1]}function lr(qe){return qe.project.invert||qe.children&&qe.children.some(lr)}Un.invert=function(qe,We){var rt=(qe/=h)*qe,ft=rt+(We/=h)*We,bt=y*y;return[qe?(ft-1+C((1-ft)*(1-ft)+4*rt))/(2*qe)*h:0,ee(function(vt){return ft*(y*d(vt)-2*vt)*y+4*vt*vt*(We-d(vt))+2*y*vt-bt*We},0)]},jn.invert=function(qe,We){We>1.790857183?We=1.790857183:We<-1.790857183&&(We=-1.790857183);var rt,ft=We;do{var bt=ft*ft;ft-=rt=(ft*(1.0148+bt*bt*(.23185+bt*(.02406*bt-.14499)))-We)/(1.0148+bt*bt*(5*.23185+bt*(.21654*bt-1.01493)))}while(x(rt)>a);return[qe,ft]},On.invert=function(qe,We){if(x(We)<a)return[qe,0];var rt,ft=qe*qe+We*We,bt=.5*We,vt=10;do{var Pt=u(bt),tn=1/i(bt),rn=ft-2*We*bt+bt*bt;bt-=rt=(Pt*rn+2*(bt-We))/(2+rn*tn*tn+2*(bt-We)*Pt)}while(x(rt)>a&&--vt>0);return Pt=u(bt),[(x(We)<x(bt+1/Pt)?z(qe*Pt):o(We)*o(qe)*(S(x(qe*Pt))+h))/d(bt),bt]};var hr=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Mr=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(qe){return qe.map(function(We){return hr[We]})}),Er=2/C(3);function Pr(qe,We){var rt=De(qe,We);return[rt[0]*Er,rt[1]]}function Ur(qe,We){for(var rt=0,ft=qe.length,bt=0;rt<ft;++rt)bt+=qe[rt]*We[rt];return bt}function Yr(qe){return[r(qe[1],qe[0])*M,z(p(-1,s(1,qe[2])))*M]}function si(qe){var We=qe[0]*P,rt=qe[1]*P,ft=i(rt);return[ft*i(We),ft*d(We),d(rt)]}function Fi(){}function Ri(qe,We){return{type:"FeatureCollection",features:qe.features.map(function(rt){return Fr(rt,We)})}}function Fr(qe,We){return{type:"Feature",id:qe.id,properties:qe.properties,geometry:fi(qe.geometry,We)}}function fi(qe,We){if(!qe)return null;if("GeometryCollection"===qe.type)return bt=We,{type:"GeometryCollection",geometries:qe.geometries.map(function(vt){return fi(vt,bt)})};var bt,rt;switch(qe.type){case"Point":case"MultiPoint":rt=Ta;break;case"LineString":case"MultiLineString":rt=Ba;break;case"Polygon":case"MultiPolygon":case"Sphere":rt=go;break;default:return null}return t.geoStream(qe,We(rt)),rt.result()}Pr.invert=function(qe,We){return De.invert(qe/Er,We)};var ci=[],Yi=[],Ta={point:function(qe,We){ci.push([qe,We])},result:function(){var qe=ci.length?ci.length<2?{type:"Point",coordinates:ci[0]}:{type:"MultiPoint",coordinates:ci}:null;return ci=[],qe}},Ba={lineStart:Fi,point:function(qe,We){ci.push([qe,We])},lineEnd:function(){ci.length&&(Yi.push(ci),ci=[])},result:function(){var qe=Yi.length?Yi.length<2?{type:"LineString",coordinates:Yi[0]}:{type:"MultiLineString",coordinates:Yi}:null;return Yi=[],qe}},go={polygonStart:Fi,lineStart:Fi,point:function(qe,We){ci.push([qe,We])},lineEnd:function(){var qe=ci.length;if(qe){do{ci.push(ci[0].slice())}while(++qe<4);Yi.push(ci),ci=[]}},polygonEnd:Fi,result:function(){if(!Yi.length)return null;var qe=[],We=[];return Yi.forEach(function(rt){!function(ft){if((bt=ft.length)<4)return!1;for(var bt,vt=0,Pt=ft[bt-1][1]*ft[0][0]-ft[bt-1][0]*ft[0][1];++vt<bt;)Pt+=ft[vt-1][1]*ft[vt][0]-ft[vt-1][0]*ft[vt][1];return Pt<=0}(rt)?We.push(rt):qe.push([rt])}),We.forEach(function(rt){var ft=rt[0];qe.some(function(bt){if(function(vt,Pt){for(var tn=Pt[0],rn=Pt[1],Qt=!1,un=0,xn=vt.length,Sn=xn-1;un<xn;Sn=un++){var Cn=vt[un],Vn=Cn[0],mr=Cn[1],wr=vt[Sn],Gr=wr[1];mr>rn^Gr>rn&&tn<(wr[0]-Vn)*(rn-mr)/(Gr-mr)+Vn&&(Qt=!Qt)}return Qt}(bt[0],ft))return bt.push(rt),!0})||qe.push([rt])}),Yi=[],qe.length?qe.length>1?{type:"MultiPolygon",coordinates:qe}:{type:"Polygon",coordinates:qe[0]}:null}};function ra(qe){var We=qe(h,0)[0]-qe(-h,0)[0];function rt(ft,bt){var vt=x(ft)<h,Pt=qe(vt?ft:ft>0?ft-y:ft+y,bt),tn=(Pt[0]-Pt[1])*b,rn=(Pt[0]+Pt[1])*b;if(vt)return[tn,rn];var Qt=We*b,un=tn>0^rn>0?-1:1;return[un*tn-o(rn)*Qt,un*rn-o(tn)*Qt]}return qe.invert&&(rt.invert=function(ft,bt){var vt=(ft+bt)*b,Pt=(bt-ft)*b,tn=x(vt)<.5*We&&x(Pt)<.5*We;if(!tn){var rn=We*b,Qt=vt>0^Pt>0?-1:1,un=-Qt*ft+(Pt>0?1:-1)*rn,xn=-Qt*bt+(vt>0?1:-1)*rn;vt=(-un-xn)*b,Pt=(un-xn)*b}var Sn=qe.invert(vt,Pt);return tn||(Sn[0]+=vt>0?y:-y),Sn}),t.geoProjection(rt).rotate([-90,-90,45]).clipAngle(179.999)}function ia(){return ra(Ot).scale(111.48)}function so(qe){var We=d(qe);function rt(ft,bt){var vt=We?u(ft*We/2)/We:ft/2;if(!bt)return[2*vt,-qe];var Pt=2*e(vt*d(bt)),tn=1/u(bt);return[d(Pt)*tn,bt+(1-i(Pt))*tn-qe]}return rt.invert=function(ft,bt){if(x(bt+=qe)<a)return[We?2*e(We*ft/2)/We:ft,0];var vt,Pt=ft*ft+bt*bt,tn=0,rn=10;do{var Qt=u(tn),un=1/i(tn),xn=Pt-2*bt*tn+tn*tn;tn-=vt=(Qt*xn+2*(tn-bt))/(2+xn*un*un+2*(tn-bt)*Qt)}while(x(vt)>a&&--rn>0);var Sn=ft*(Qt=u(tn)),Cn=u(x(bt)<x(tn+1/Qt)?.5*z(Sn):.5*S(Sn)+y/4)/d(tn);return[We?2*e(We*Cn)/We:2*Cn,tn]},rt}var Zi=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function Ra(qe,We){var rt,ft=s(18,36*x(We)/y),bt=n(ft),vt=ft-bt,Pt=(rt=Zi[bt])[0],tn=rt[1],rn=(rt=Zi[++bt])[0],Qt=rt[1],un=(rt=Zi[s(19,++bt)])[0],xn=rt[1];return[qe*(rn+vt*(un-Pt)/2+vt*vt*(un-2*rn+Pt)/2),(We>0?h:-h)*(Qt+vt*(xn-tn)/2+vt*vt*(xn-2*Qt+tn)/2)]}function Fa(qe,We){var rt=function(Pt){function tn(rn,Qt){var un=i(Qt),xn=(Pt-1)/(Pt-un*i(rn));return[xn*un*d(rn),xn*d(Qt)]}return tn.invert=function(rn,Qt){var un=rn*rn+Qt*Qt,xn=C(un),Sn=(Pt-C(1-un*(Pt+1)/(Pt-1)))/((Pt-1)/xn+xn/(Pt-1));return[r(rn*Sn,xn*C(1-Sn*Sn)),xn?z(Qt*Sn/xn):0]},tn}(qe);if(!We)return rt;var ft=i(We),bt=d(We);function vt(Pt,tn){var rn=rt(Pt,tn),Qt=rn[1],un=Qt*bt/(qe-1)+ft;return[rn[0]*ft/un,Qt/un]}return vt.invert=function(Pt,tn){var rn=(qe-1)/(qe-1-tn*bt);return rt.invert(rn*Pt,rn*tn*ft)},vt}Zi.forEach(function(qe){qe[1]*=1.0144}),Ra.invert=function(qe,We){var rt=We/h,ft=90*rt,bt=s(18,x(ft/5)),vt=p(0,n(bt));do{var Pt=Zi[vt][1],tn=Zi[vt+1][1],rn=Zi[s(19,vt+2)][1],Qt=rn-Pt,un=rn-2*tn+Pt,xn=2*(x(rt)-tn)/Qt,Sn=un/Qt,Cn=xn*(1-Sn*xn*(1-2*Sn*xn));if(Cn>=0||1===vt){ft=(We>=0?5:-5)*(Cn+bt);var Vn,mr=50;do{Cn=(bt=s(18,x(ft)/5))-(vt=n(bt)),Pt=Zi[vt][1],tn=Zi[vt+1][1],rn=Zi[s(19,vt+2)][1],ft-=(Vn=(We>=0?h:-h)*(tn+Cn*(rn-Pt)/2+Cn*Cn*(rn-2*tn+Pt)/2)-We)*M}while(x(Vn)>1e-12&&--mr>0);break}}while(--vt>=0);var wr=Zi[vt][0],qr=Zi[vt+1][0],Gr=Zi[s(19,vt+2)][0];return[qe/(qr+Cn*(Gr-wr)/2+Cn*Cn*(Gr-2*qr+wr)/2),ft*P]};var _a=-179.9999,Xa=179.9999,no=-89.9999;function _o(qe){return qe.length>0}function Wa(qe){return-90===qe||90===qe?[0,qe]:[-180,(We=qe,Math.floor(1e4*We)/1e4)];var We}function xa(qe){var We=qe[0],rt=qe[1],ft=!1;return We<=_a?(We=-180,ft=!0):We>=Xa&&(We=180,ft=!0),rt<=no?(rt=-90,ft=!0):rt>=89.9999&&(rt=90,ft=!0),ft?[We,rt]:qe}function ro(qe){return qe.map(xa)}function ds(qe,We,rt){for(var ft=0,bt=qe.length;ft<bt;++ft){var vt=qe[ft].slice();rt.push({index:-1,polygon:We,ring:vt});for(var Pt=0,tn=vt.length;Pt<tn;++Pt){var rn=vt[Pt],Qt=rn[0],un=rn[1];if(Qt<=_a||Qt>=Xa||un<=no||un>=89.9999){vt[Pt]=xa(rn);for(var xn=Pt+1;xn<tn;++xn){var Sn=vt[xn],Cn=Sn[0],Vn=Sn[1];if(Cn>_a&&Cn<Xa&&Vn>no&&Vn<89.9999)break}if(xn===Pt+1)continue;if(Pt){var mr={index:-1,polygon:We,ring:vt.slice(0,Pt+1)};mr.ring[mr.ring.length-1]=Wa(un),rt[rt.length-1]=mr}else rt.pop();if(xn>=tn)break;rt.push({index:-1,polygon:We,ring:vt=vt.slice(xn-1)}),vt[0]=Wa(vt[0][1]),Pt=-1,tn=vt.length}}}}function bs(qe){var We,rt,ft,bt,vt,Pt,tn=qe.length,rn={},Qt={};for(We=0;We<tn;++We)(ft=(rt=qe[We]).ring[0])[0]!==(vt=rt.ring[rt.ring.length-1])[0]||ft[1]!==vt[1]?(rt.index=We,rn[ft]=Qt[vt]=rt):(rt.polygon.push(rt.ring),qe[We]=null);for(We=0;We<tn;++We)if(rt=qe[We]){if(bt=Qt[ft=rt.ring[0]],Pt=rn[vt=rt.ring[rt.ring.length-1]],delete rn[ft],delete Qt[vt],ft[0]===vt[0]&&ft[1]===vt[1]){rt.polygon.push(rt.ring);continue}bt?(delete Qt[ft],delete rn[bt.ring[0]],bt.ring.pop(),qe[bt.index]=null,rt={index:-1,polygon:bt.polygon,ring:bt.ring.concat(rt.ring)},bt===Pt?rt.polygon.push(rt.ring):(rt.index=tn++,qe.push(rn[rt.ring[0]]=Qt[rt.ring[rt.ring.length-1]]=rt))):Pt?(delete rn[vt],delete Qt[Pt.ring[Pt.ring.length-1]],rt.ring.pop(),rt={index:tn++,polygon:Pt.polygon,ring:rt.ring.concat(Pt.ring)},qe[Pt.index]=null,qe.push(rn[rt.ring[0]]=Qt[rt.ring[rt.ring.length-1]]=rt)):(rt.ring.push(rt.ring[0]),rt.polygon.push(rt.ring))}}function ta(qe){var We={type:"Feature",geometry:ls(qe.geometry)};return null!=qe.id&&(We.id=qe.id),null!=qe.bbox&&(We.bbox=qe.bbox),null!=qe.properties&&(We.properties=qe.properties),We}function ls(qe){if(null==qe)return qe;var We,rt,ft,bt;switch(qe.type){case"GeometryCollection":We={type:"GeometryCollection",geometries:qe.geometries.map(ls)};break;case"Point":We={type:"Point",coordinates:xa(qe.coordinates)};break;case"MultiPoint":case"LineString":We={type:qe.type,coordinates:ro(qe.coordinates)};break;case"MultiLineString":We={type:"MultiLineString",coordinates:qe.coordinates.map(ro)};break;case"Polygon":var vt=[];ds(qe.coordinates,vt,rt=[]),bs(rt),We={type:"Polygon",coordinates:vt};break;case"MultiPolygon":rt=[],ft=-1,bt=qe.coordinates.length;for(var Pt=new Array(bt);++ft<bt;)ds(qe.coordinates[ft],Pt[ft]=[],rt);bs(rt),We={type:"MultiPolygon",coordinates:Pt.filter(_o)};break;default:return qe}return null!=qe.bbox&&(We.bbox=qe.bbox),We}function ts(qe,We){var rt=u(We/2),ft=d(_*rt);return[qe*(.74482-.34588*ft*ft),1.70711*rt]}function As(qe,We,rt){var ft=t.geoInterpolate(We,rt),bt=ft(.5),vt=t.geoRotation([-bt[0],-bt[1]])(We),Pt=ft.distance/2,tn=-z(d(vt[1]*P)/d(Pt)),rn=[-bt[0],-bt[1],-(vt[0]>0?y-tn:tn)*M],Qt=t.geoProjection(qe(Pt)).rotate(rn),un=t.geoRotation(rn),xn=Qt.center;return delete Qt.rotate,Qt.center=function(Sn){return arguments.length?xn(un(Sn)):un.invert(xn())},Qt.clipAngle(90)}function Ms(qe){var We=i(qe);function rt(ft,bt){var vt=t.geoGnomonicRaw(ft,bt);return vt[0]*=We,vt}return rt.invert=function(ft,bt){return t.geoGnomonicRaw.invert(ft/We,bt)},rt}function _s(qe,We){return As(Ms,qe,We)}function Ss(qe){if(!(qe*=2))return t.geoAzimuthalEquidistantRaw;var We=-qe/2,rt=-We,ft=qe*qe,bt=u(rt),vt=.5/d(rt);function Pt(tn,rn){var Qt=S(i(rn)*i(tn-We)),un=S(i(rn)*i(tn-rt));return[((Qt*=Qt)-(un*=un))/(2*qe),(rn<0?-1:1)*C(4*ft*un-(ft-Qt+un)*(ft-Qt+un))/(2*qe)]}return Pt.invert=function(tn,rn){var Qt,un,xn=rn*rn,Sn=i(C(xn+(Qt=tn+We)*Qt)),Cn=i(C(xn+(Qt=tn+rt)*Qt));return[r(un=Sn-Cn,Qt=(Sn+Cn)*bt),(rn<0?-1:1)*S(C(Qt*Qt+un*un)*vt)]},Pt}function vo(qe,We){return As(Ss,qe,We)}function Lo(qe,We){if(x(We)<a)return[qe,0];var rt=x(We/h),ft=z(rt);if(x(qe)<a||x(x(We)-h)<a)return[0,o(We)*y*u(ft/2)];var bt=i(ft),vt=x(y/qe-qe/y)/2,Pt=vt*vt,tn=bt/(rt+bt-1),rn=tn*(2/rt-1),Qt=rn*rn,un=Qt+Pt,xn=tn-Qt,Sn=Pt+tn;return[o(qe)*y*(vt*xn+C(Pt*xn*xn-un*(tn*tn-Qt)))/un,o(We)*y*(rn*Sn-vt*C((Pt+1)*un-Sn*Sn))/un]}function Bo(qe,We){if(x(We)<a)return[qe,0];var rt=x(We/h),ft=z(rt);if(x(qe)<a||x(x(We)-h)<a)return[0,o(We)*y*u(ft/2)];var bt=i(ft),vt=x(y/qe-qe/y)/2,Pt=vt*vt,tn=bt*(C(1+Pt)-vt*bt)/(1+Pt*rt*rt);return[o(qe)*y*tn,o(We)*y*C(1-tn*(2*vt+tn))]}function qo(qe,We){if(x(We)<a)return[qe,0];var rt=We/h,ft=z(rt);if(x(qe)<a||x(x(We)-h)<a)return[0,y*u(ft/2)];var bt=(y/qe-qe/y)/2,vt=rt/(1+i(ft));return[y*(o(qe)*C(bt*bt+1-vt*vt)-bt),y*vt]}function Ho(qe,We){if(!We)return[qe,0];var rt=x(We);if(!qe||rt===h)return[0,We];var ft=rt/h,bt=ft*ft,vt=(8*ft-bt*(bt+2)-5)/(2*bt*(ft-1)),Pt=vt*vt,tn=ft*vt,rn=bt+Pt+2*tn,Qt=ft+3*vt,un=qe/h,xn=un+1/un,Sn=o(x(qe)-h)*C(xn*xn-4),Cn=Sn*Sn,Vn=(Sn*(rn+Pt-1)+2*C(rn*(bt+Pt*Cn-1)+(1-bt)*(bt*(Qt*Qt+4*Pt)+12*tn*Pt+4*Pt*Pt)))/(4*rn+Cn);return[o(qe)*h*Vn,o(We)*h*C(1+Sn*x(Vn)-Vn*Vn)]}function ns(qe,We,rt,ft){var bt=y/3;qe=p(qe,a),We=p(We,a),qe=s(qe,h),We=s(We,y-a),rt=p(rt,0),rt=s(rt,100-a);var vt=(ft=p(ft,a))/100,Pt=S((rt/100+1)*i(bt))/bt,tn=d(qe)/d(Pt*h),rn=We/y,Qt=C(vt*d(qe/2)/d(We/2));return function(un,xn,Sn,Cn,Vn){function mr(wr,qr){var Gr=Sn*d(Cn*qr),ni=C(1-Gr*Gr),Xr=C(2/(1+ni*i(wr*=Vn)));return[un*ni*Xr*d(wr),xn*Gr*Xr]}return mr.invert=function(wr,qr){var Gr=wr/un,ni=qr/xn,Xr=C(Gr*Gr+ni*ni),Si=2*z(Xr/2);return[r(wr*u(Si),un*Xr)/Vn,Xr&&z(qr*d(Si)/(xn*Sn*Xr))/Cn]},mr}(Qt/C(rn*tn*Pt),1/(Qt*C(rn*tn*Pt)),tn,Pt,rn)}function wo(){var qe=65*P,We=60*P,rt=20,ft=200,bt=t.geoProjectionMutator(ns),vt=bt(qe,We,rt,ft);return vt.poleline=function(Pt){return arguments.length?bt(qe=+Pt*P,We,rt,ft):qe*M},vt.parallels=function(Pt){return arguments.length?bt(qe,We=+Pt*P,rt,ft):We*M},vt.inflation=function(Pt){return arguments.length?bt(qe,We,rt=+Pt,ft):rt},vt.ratio=function(Pt){return arguments.length?bt(qe,We,rt,ft=+Pt):ft},vt.scale(163.775)}ts.invert=function(qe,We){var rt=We/1.70711,ft=d(_*rt);return[qe/(.74482-.34588*ft*ft),2*e(rt)]},Lo.invert=function(qe,We){if(x(We)<a)return[qe,0];if(x(qe)<a)return[0,h*d(2*e(We/y))];var rt=(qe/=y)*qe,ft=(We/=y)*We,bt=rt+ft,vt=bt*bt,Pt=-x(We)*(1+bt),tn=Pt-2*ft+rt,rn=-2*Pt+1+2*ft+vt,Qt=ft/rn+(2*tn*tn*tn/(rn*rn*rn)-9*Pt*tn/(rn*rn))/27,un=(Pt-tn*tn/(3*rn))/rn,xn=2*C(-un/3),Sn=S(3*Qt/(un*xn))/3;return[y*(bt-1+C(1+2*(rt-ft)+vt))/(2*qe),o(We)*y*(-xn*i(Sn+y/3)-tn/(3*rn))]},Bo.invert=function(qe,We){if(!qe)return[0,h*d(2*e(We/y))];var rt=x(qe/y),ft=(1-rt*rt-(We/=y)*We)/(2*rt),bt=C(ft*ft+1);return[o(qe)*y*(bt-ft),o(We)*h*d(2*r(C((1-2*ft*rt)*(ft+bt)-rt),C(bt+ft+rt)))]},qo.invert=function(qe,We){if(!We)return[qe,0];var rt=We/y,ft=(y*y*(1-rt*rt)-qe*qe)/(2*y*qe);return[qe?y*(o(qe)*C(ft*ft+1)-ft):0,h*d(2*e(rt))]},Ho.invert=function(qe,We){var rt;if(!qe||!We)return[qe,We];We/=y;var ft=o(qe)*qe/h,bt=(ft*ft-1+4*We*We)/x(ft),vt=bt*bt,Pt=2*We,tn=50;do{var rn=Pt*Pt,Qt=(8*Pt-rn*(rn+2)-5)/(2*rn*(Pt-1)),un=(3*Pt-rn*Pt-10)/(2*rn*Pt),xn=Qt*Qt,Sn=Pt*Qt,Cn=Pt+Qt,Vn=Cn*Cn,mr=Pt+3*Qt,wr=-2*Cn*(4*Sn*xn+(1-4*rn+3*rn*rn)*(1+un)+xn*(14*rn-6-vt+(8*rn-8-2*vt)*un)+Sn*(12*rn-8+(10*rn-10-vt)*un)),qr=C(Vn*(rn+xn*vt-1)+(1-rn)*(rn*(mr*mr+4*xn)+xn*(12*Sn+4*xn)));Pt-=rt=(bt*(Vn+xn-1)+2*qr-ft*(4*Vn+vt))/(bt*(2*Qt*un+2*Cn*(1+un))+wr/qr-8*Cn*(bt*(-1+xn+Vn)+2*qr)*(1+un)/(vt+4*Vn))}while(rt>a&&--tn>0);return[o(qe)*(C(bt*bt+4)+bt)*y/4,h*Pt]};var ws=4*y+3*C(3),yo=2*C(2*y*C(3)/ws),Yo=te(yo*C(3)/y,yo,ws/6);function ms(qe,We){return[qe*C(1-3*We*We/(y*y)),We]}function zo(qe,We){var rt=i(We),ft=i(qe)*rt,bt=1-ft,vt=i(qe=r(d(qe)*rt,-d(We))),Pt=d(qe);return[Pt*(rt=C(1-ft*ft))-vt*bt,-vt*rt-Pt*bt]}function Gi(qe,We){var rt=q(qe,We);return[(rt[0]+qe/h)/2,(rt[1]+We)/2]}ms.invert=function(qe,We){return[qe/C(1-3*We*We/(y*y)),We]},zo.invert=function(qe,We){var rt=(qe*qe+We*We)/-2,ft=C(-rt*(2+rt)),bt=We*rt+qe*ft,vt=qe*rt-We*ft,Pt=C(vt*vt+bt*bt);return[r(ft*bt,Pt*(1+rt)),Pt?-z(ft*vt/Pt):0]},Gi.invert=function(qe,We){var rt=qe,ft=We,bt=25;do{var vt,Pt=i(ft),tn=d(ft),rn=d(2*ft),Qt=tn*tn,un=Pt*Pt,xn=d(rt),Sn=i(rt/2),Cn=d(rt/2),Vn=Cn*Cn,mr=1-un*Sn*Sn,wr=mr?S(Pt*Sn)*C(vt=1/mr):vt=0,qr=.5*(2*wr*Pt*Cn+rt/h)-qe,Gr=.5*(wr*tn+ft)-We,ni=.5*vt*(un*Vn+wr*Pt*Sn*Qt)+.5/h,Xr=vt*(xn*rn/4-wr*tn*Cn),Si=.125*vt*(rn*Cn-wr*tn*un*xn),Ni=.5*vt*(Qt*Sn+wr*Vn*Pt)+.5,$i=Xr*Si-Ni*ni,Qi=(Gr*Xr-qr*Ni)/$i,ea=(qr*Si-Gr*ni)/$i;rt-=Qi,ft-=ea}while((x(Qi)>a||x(ea)>a)&&--bt>0);return[rt,ft]},g.geoNaturalEarth=t.geoNaturalEarth1,g.geoNaturalEarthRaw=t.geoNaturalEarth1Raw,g.geoAiry=function(){var qe=h,We=t.geoProjectionMutator(j),rt=We(qe);return rt.radius=function(ft){return arguments.length?We(qe=ft*P):qe*M},rt.scale(179.976).clipAngle(147)},g.geoAiryRaw=j,g.geoAitoff=function(){return t.geoProjection(q).scale(152.63)},g.geoAitoffRaw=q,g.geoArmadillo=function(){var qe=20*P,We=qe>=0?1:-1,rt=u(We*qe),ft=t.geoProjectionMutator(Z),bt=ft(qe),vt=bt.stream;return bt.parallel=function(Pt){return arguments.length?(rt=u((We=(qe=Pt*P)>=0?1:-1)*qe),ft(qe)):qe*M},bt.stream=function(Pt){var tn=bt.rotate(),rn=vt(Pt),Qt=(bt.rotate([0,0]),vt(Pt)),un=bt.precision();return bt.rotate(tn),rn.sphere=function(){Qt.polygonStart(),Qt.lineStart();for(var xn=-180*We;We*xn<180;xn+=90*We)Qt.point(xn,90*We);if(qe)for(;We*(xn-=3*We*un)>=-180;)Qt.point(xn,We*-r(i(xn*P/2),rt)*M);Qt.lineEnd(),Qt.polygonEnd()},rn},bt.scale(218.695).center([0,28.0974])},g.geoArmadilloRaw=Z,g.geoAugust=function(){return t.geoProjection(W).scale(66.1603)},g.geoAugustRaw=W,g.geoBaker=function(){return t.geoProjection(ne).scale(112.314)},g.geoBakerRaw=ne,g.geoBerghaus=function(){var qe=5,We=t.geoProjectionMutator(V),rt=We(qe),ft=rt.stream,bt=-i(.01*P),vt=d(.01*P);return rt.lobes=function(Pt){return arguments.length?We(qe=+Pt):qe},rt.stream=function(Pt){var tn=rt.rotate(),rn=ft(Pt),Qt=(rt.rotate([0,0]),ft(Pt));return rt.rotate(tn),rn.sphere=function(){Qt.polygonStart(),Qt.lineStart();for(var un=0,xn=360/qe,Sn=2*y/qe,Cn=90-180/qe,Vn=h;un<qe;++un,Cn-=xn,Vn-=Sn)Qt.point(r(vt*i(Vn),bt)*M,z(vt*d(Vn))*M),Cn<-90?(Qt.point(-90,-180-Cn-.01),Qt.point(-90,-180-Cn+.01)):(Qt.point(90,Cn+.01),Qt.point(90,Cn-.01));Qt.lineEnd(),Qt.polygonEnd()},rn},rt.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},g.geoBerghausRaw=V,g.geoBertin1953=function(){return t.geoProjection(K()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},g.geoBertin1953Raw=K,g.geoBoggs=function(){return t.geoProjection(ve).scale(160.857)},g.geoBoggsRaw=ve,g.geoBonne=function(){return fe(Se).scale(123.082).center([0,26.1441]).parallel(45)},g.geoBonneRaw=Se,g.geoBottomley=function(){var qe=.5,We=t.geoProjectionMutator(pe),rt=We(qe);return rt.fraction=function(ft){return arguments.length?We(qe=+ft):qe},rt.scale(158.837)},g.geoBottomleyRaw=pe,g.geoBromley=function(){return t.geoProjection(ge).scale(152.63)},g.geoBromleyRaw=ge,g.geoChamberlin=Me,g.geoChamberlinRaw=Ae,g.geoChamberlinAfrica=function(){return Me([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},g.geoCollignon=function(){return t.geoProjection(De).scale(95.6464).center([0,30])},g.geoCollignonRaw=De,g.geoCraig=function(){return fe(Oe).scale(249.828).clipAngle(90)},g.geoCraigRaw=Oe,g.geoCraster=function(){return t.geoProjection(Qe).scale(156.19)},g.geoCrasterRaw=Qe,g.geoCylindricalEqualArea=function(){return fe(Ne).parallel(38.58).scale(195.044)},g.geoCylindricalEqualAreaRaw=Ne,g.geoCylindricalStereographic=function(){return fe(Pe).scale(124.75)},g.geoCylindricalStereographicRaw=Pe,g.geoEckert1=function(){return t.geoProjection(Re).scale(165.664)},g.geoEckert1Raw=Re,g.geoEckert2=function(){return t.geoProjection(Ge).scale(165.664)},g.geoEckert2Raw=Ge,g.geoEckert3=function(){return t.geoProjection(tt).scale(180.739)},g.geoEckert3Raw=tt,g.geoEckert4=function(){return t.geoProjection(ct).scale(180.739)},g.geoEckert4Raw=ct,g.geoEckert5=function(){return t.geoProjection(wt).scale(173.044)},g.geoEckert5Raw=wt,g.geoEckert6=function(){return t.geoProjection(kt).scale(173.044)},g.geoEckert6Raw=kt,g.geoEisenlohr=function(){return t.geoProjection(at).scale(62.5271)},g.geoEisenlohrRaw=at,g.geoFahey=function(){return t.geoProjection(yt).scale(137.152)},g.geoFaheyRaw=yt,g.geoFoucaut=function(){return t.geoProjection(Vt).scale(135.264)},g.geoFoucautRaw=Vt,g.geoFoucautSinusoidal=function(){var qe=.5,We=t.geoProjectionMutator(Gt),rt=We(qe);return rt.alpha=function(ft){return arguments.length?We(qe=+ft):qe},rt.scale(168.725)},g.geoFoucautSinusoidalRaw=Gt,g.geoGilbert=function(qe){null==qe&&(qe=t.geoOrthographic);var We=qe(),rt=t.geoEquirectangular().scale(M).precision(0).clipAngle(null).translate([0,0]);function ft(vt){return We(en(vt))}function bt(vt){ft[vt]=function(){return arguments.length?(We[vt].apply(We,arguments),ft):We[vt]()}}return We.invert&&(ft.invert=function(vt){return Jt(We.invert(vt))}),ft.stream=function(vt){var Pt=We.stream(vt),tn=rt.stream({point:function(rn,Qt){Pt.point(rn/2,z(u(-Qt/2*P))*M)},lineStart:function(){Pt.lineStart()},lineEnd:function(){Pt.lineEnd()},polygonStart:function(){Pt.polygonStart()},polygonEnd:function(){Pt.polygonEnd()}});return tn.sphere=Pt.sphere,tn},ft.rotate=function(vt){return arguments.length?(rt.rotate(vt),ft):rt.rotate()},ft.center=function(vt){return arguments.length?(We.center(en(vt)),ft):Jt(We.center())},bt("angle"),bt("clipAngle"),bt("clipExtent"),bt("fitExtent"),bt("fitHeight"),bt("fitSize"),bt("fitWidth"),bt("scale"),bt("translate"),bt("precision"),ft.scale(249.5)},g.geoGingery=function(){var qe=6,We=30*P,rt=i(We),ft=d(We),bt=t.geoProjectionMutator(cn),vt=bt(We,qe),Pt=vt.stream,tn=-i(.01*P),rn=d(.01*P);return vt.radius=function(Qt){return arguments.length?(rt=i(We=Qt*P),ft=d(We),bt(We,qe)):We*M},vt.lobes=function(Qt){return arguments.length?bt(We,qe=+Qt):qe},vt.stream=function(Qt){var un=vt.rotate(),xn=Pt(Qt),Sn=(vt.rotate([0,0]),Pt(Qt));return vt.rotate(un),xn.sphere=function(){Sn.polygonStart(),Sn.lineStart();for(var Cn=0,Vn=2*y/qe,mr=0;Cn<qe;++Cn,mr-=Vn)Sn.point(r(rn*i(mr),tn)*M,z(rn*d(mr))*M),Sn.point(r(ft*i(mr-Vn/2),rt)*M,z(ft*d(mr-Vn/2))*M);Sn.lineEnd(),Sn.polygonEnd()},xn},vt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},g.geoGingeryRaw=cn,g.geoGinzburg4=function(){return t.geoProjection(he).scale(149.995)},g.geoGinzburg4Raw=he,g.geoGinzburg5=function(){return t.geoProjection(be).scale(153.93)},g.geoGinzburg5Raw=be,g.geoGinzburg6=function(){return t.geoProjection(Fe).scale(130.945)},g.geoGinzburg6Raw=Fe,g.geoGinzburg8=function(){return t.geoProjection(He).scale(131.747)},g.geoGinzburg8Raw=He,g.geoGinzburg9=function(){return t.geoProjection(Ke).scale(131.087)},g.geoGinzburg9Raw=Ke,g.geoGringorten=function(){return t.geoProjection(Ze(ut)).scale(239.75)},g.geoGringortenRaw=ut,g.geoGuyou=function(){return t.geoProjection(Ze(Ot)).scale(151.496)},g.geoGuyouRaw=Ot,g.geoHammer=function(){var qe=2,We=t.geoProjectionMutator(N),rt=We(qe);return rt.coefficient=function(ft){return arguments.length?We(qe=+ft):qe},rt.scale(169.529)},g.geoHammerRaw=N,g.geoHammerRetroazimuthal=function(){var qe=0,We=t.geoProjectionMutator(ot),rt=We(qe),ft=rt.rotate,bt=rt.stream,vt=t.geoCircle();return rt.parallel=function(Pt){if(!arguments.length)return qe*M;var tn=rt.rotate();return We(qe=Pt*P).rotate(tn)},rt.rotate=function(Pt){return arguments.length?(ft.call(rt,[Pt[0],Pt[1]-qe*M]),vt.center([-Pt[0],-Pt[1]]),rt):((Pt=ft.call(rt))[1]+=qe*M,Pt)},rt.stream=function(Pt){return(Pt=bt(Pt)).sphere=function(){Pt.polygonStart();var tn,rn=vt.radius(89.99)().coordinates[0],Qt=rn.length-1,un=-1;for(Pt.lineStart();++un<Qt;)Pt.point((tn=rn[un])[0],tn[1]);for(Pt.lineEnd(),Qt=(rn=vt.radius(90.01)().coordinates[0]).length-1,Pt.lineStart();--un>=0;)Pt.point((tn=rn[un])[0],tn[1]);Pt.lineEnd(),Pt.polygonEnd()},Pt},rt.scale(79.4187).parallel(45).clipAngle(179.999)},g.geoHammerRetroazimuthalRaw=ot,g.geoHealpix=function(){var qe=4,We=t.geoProjectionMutator(Mt),rt=We(qe),ft=rt.stream;return rt.lobes=function(bt){return arguments.length?We(qe=+bt):qe},rt.stream=function(bt){var vt=rt.rotate(),Pt=ft(bt),tn=(rt.rotate([0,0]),ft(bt));return rt.rotate(vt),Pt.sphere=function(){var rn,Qt;t.geoStream((Qt=[].concat(k.range(-180,180+(rn=180/qe)/2,rn).map(Ce),k.range(180,-180-rn/2,-rn).map(Xe)),{type:"Polygon",coordinates:[180===rn?Qt.map(st):Qt]}),tn)},Pt},rt.scale(239.75)},g.geoHealpixRaw=Mt,g.geoHill=function(){var qe=1,We=t.geoProjectionMutator(dt),rt=We(qe);return rt.ratio=function(ft){return arguments.length?We(qe=+ft):qe},rt.scale(167.774).center([0,18.67])},g.geoHillRaw=dt,g.geoHomolosine=function(){return t.geoProjection(Ht).scale(152.63)},g.geoHomolosineRaw=Ht,g.geoHufnagel=function(){var qe=1,We=0,rt=45*P,ft=2,bt=t.geoProjectionMutator(Kt),vt=bt(qe,We,rt,ft);return vt.a=function(Pt){return arguments.length?bt(qe=+Pt,We,rt,ft):qe},vt.b=function(Pt){return arguments.length?bt(qe,We=+Pt,rt,ft):We},vt.psiMax=function(Pt){return arguments.length?bt(qe,We,rt=+Pt*P,ft):rt*M},vt.ratio=function(Pt){return arguments.length?bt(qe,We,rt,ft=+Pt):ft},vt.scale(180.739)},g.geoHufnagelRaw=Kt,g.geoHyperelliptical=function(){var qe=0,We=2.5,rt=1.183136,ft=t.geoProjectionMutator(vn),bt=ft(qe,We,rt);return bt.alpha=function(vt){return arguments.length?ft(qe=+vt,We,rt):qe},bt.k=function(vt){return arguments.length?ft(qe,We=+vt,rt):We},bt.gamma=function(vt){return arguments.length?ft(qe,We,rt=+vt):rt},bt.scale(152.63)},g.geoHyperellipticalRaw=vn,g.geoInterrupt=an,g.geoInterruptedBoggs=function(){return an(ve,on).scale(160.857)},g.geoInterruptedHomolosine=function(){return an(Ht,mn).scale(152.63)},g.geoInterruptedMollweide=function(){return an(ae,_n).scale(169.529)},g.geoInterruptedMollweideHemispheres=function(){return an(ae,Pn).scale(169.529).rotate([20,0])},g.geoInterruptedSinuMollweide=function(){return an(zt,Rn,B).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},g.geoInterruptedSinusoidal=function(){return an(xe,qn).scale(152.63).rotate([-20,0])},g.geoKavrayskiy7=function(){return t.geoProjection(Xn).scale(158.837)},g.geoKavrayskiy7Raw=Xn,g.geoLagrange=function(){var qe=.5,We=t.geoProjectionMutator(br),rt=We(qe);return rt.spacing=function(ft){return arguments.length?We(qe=+ft):qe},rt.scale(124.75)},g.geoLagrangeRaw=br,g.geoLarrivee=function(){return t.geoProjection(Vr).scale(97.2672)},g.geoLarriveeRaw=Vr,g.geoLaskowski=function(){return t.geoProjection(cr).scale(139.98)},g.geoLaskowskiRaw=cr,g.geoLittrow=function(){return t.geoProjection(Sr).scale(144.049).clipAngle(89.999)},g.geoLittrowRaw=Sr,g.geoLoximuthal=function(){return fe(Cr).parallel(40).scale(158.837)},g.geoLoximuthalRaw=Cr,g.geoMiller=function(){return t.geoProjection(pi).scale(108.318)},g.geoMillerRaw=pi,g.geoModifiedStereographic=Lr,g.geoModifiedStereographicRaw=Yn,g.geoModifiedStereographicAlaska=function(){return Lr(ar,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},g.geoModifiedStereographicGs48=function(){return Lr(Ar,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},g.geoModifiedStereographicGs50=function(){return Lr(sr,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},g.geoModifiedStereographicMiller=function(){return Lr(dr,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},g.geoModifiedStereographicLee=function(){return Lr($r,[165,10]).scale(250).clipAngle(130).center([-165,-10])},g.geoMollweide=function(){return t.geoProjection(ae).scale(169.529)},g.geoMollweideRaw=ae,g.geoMtFlatPolarParabolic=function(){return t.geoProjection(sn).scale(164.859)},g.geoMtFlatPolarParabolicRaw=sn,g.geoMtFlatPolarQuartic=function(){return t.geoProjection(wn).scale(188.209)},g.geoMtFlatPolarQuarticRaw=wn,g.geoMtFlatPolarSinusoidal=function(){return t.geoProjection(It).scale(166.518)},g.geoMtFlatPolarSinusoidalRaw=It,g.geoNaturalEarth2=function(){return t.geoProjection(hn).scale(175.295)},g.geoNaturalEarth2Raw=hn,g.geoNellHammer=function(){return t.geoProjection(yn).scale(152.63)},g.geoNellHammerRaw=yn,g.geoInterruptedQuarticAuthalic=function(){return an(N(1/0),Hn).rotate([20,0]).scale(152.63)},g.geoNicolosi=function(){return t.geoProjection(Un).scale(127.267)},g.geoNicolosiRaw=Un,g.geoPatterson=function(){return t.geoProjection(jn).scale(139.319)},g.geoPattersonRaw=jn,g.geoPolyconic=function(){return t.geoProjection(On).scale(103.74)},g.geoPolyconicRaw=On,g.geoPolyhedral=Kn,g.geoPolyhedralButterfly=function(qe){qe=qe||function(rt){var ft=t.geoCentroid({type:"MultiPoint",coordinates:rt});return t.geoGnomonic().scale(1).translate([0,0]).rotate([-ft[0],-ft[1]])};var We=Mr.map(function(rt){return{face:rt,project:qe(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ft){var bt=We[rt];bt&&(bt.children||(bt.children=[])).push(We[ft])}),Kn(We[0],function(rt,ft){return We[rt<-y/2?ft<0?6:4:rt<0?ft<0?2:0:rt<y/2?ft<0?3:1:ft<0?7:5]}).angle(-30).scale(101.858).center([0,45])},g.geoPolyhedralCollignon=function(qe){qe=qe||function(rt){var ft=t.geoCentroid({type:"MultiPoint",coordinates:rt});return t.geoProjection(Pr).translate([0,0]).scale(1).rotate(ft[1]>0?[-ft[0],0]:[180-ft[0],180])};var We=Mr.map(function(rt){return{face:rt,project:qe(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ft){var bt=We[rt];bt&&(bt.children||(bt.children=[])).push(We[ft])}),Kn(We[0],function(rt,ft){return We[rt<-y/2?ft<0?6:4:rt<0?ft<0?2:0:rt<y/2?ft<0?3:1:ft<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},g.geoPolyhedralWaterman=function(qe){qe=qe||function(vt){var Pt=6===vt.length?t.geoCentroid({type:"MultiPoint",coordinates:vt}):vt[0];return t.geoGnomonic().scale(1).translate([0,0]).rotate([-Pt[0],-Pt[1]])};var We=Mr.map(function(vt){for(var Pt,tn=vt.map(si),rn=tn.length,Qt=tn[rn-1],un=[],xn=0;xn<rn;++xn)un.push(Yr([.9486832980505138*Qt[0]+.31622776601683794*(Pt=tn[xn])[0],.9486832980505138*Qt[1]+.31622776601683794*Pt[1],.9486832980505138*Qt[2]+.31622776601683794*Pt[2]]),Yr([.9486832980505138*Pt[0]+.31622776601683794*Qt[0],.9486832980505138*Pt[1]+.31622776601683794*Qt[1],.9486832980505138*Pt[2]+.31622776601683794*Qt[2]])),Qt=Pt;return un}),rt=[],ft=[-1,0,0,1,0,1,4,5];We.forEach(function(vt,Pt){for(var tn,rn,Qt=Mr[Pt],un=Qt.length,xn=rt[Pt]=[],Sn=0;Sn<un;++Sn)We.push([Qt[Sn],vt[(2*Sn+2)%(2*un)],vt[(2*Sn+1)%(2*un)]]),ft.push(Pt),xn.push((tn=si(vt[(2*Sn+2)%(2*un)]),rn=si(vt[(2*Sn+1)%(2*un)]),[tn[1]*rn[2]-tn[2]*rn[1],tn[2]*rn[0]-tn[0]*rn[2],tn[0]*rn[1]-tn[1]*rn[0]]))});var bt=We.map(function(vt){return{project:qe(vt),face:vt}});return ft.forEach(function(vt,Pt){var tn=bt[vt];tn&&(tn.children||(tn.children=[])).push(bt[Pt])}),Kn(bt[0],function(vt,Pt){var tn=i(Pt),rn=[tn*i(vt),tn*d(vt),d(Pt)],Qt=vt<-y/2?Pt<0?6:4:vt<0?Pt<0?2:0:vt<y/2?Pt<0?3:1:Pt<0?7:5,un=rt[Qt];return bt[Ur(un[0],rn)<0?8+3*Qt:Ur(un[1],rn)<0?8+3*Qt+1:Ur(un[2],rn)<0?8+3*Qt+2:Qt]}).angle(-30).scale(110.625).center([0,45])},g.geoProject=function(qe,We){var rt,ft=We.stream;if(!ft)throw new Error("invalid projection");switch(qe&&qe.type){case"Feature":rt=Fr;break;case"FeatureCollection":rt=Ri;break;default:rt=fi}return rt(qe,ft)},g.geoGringortenQuincuncial=function(){return ra(ut).scale(176.423)},g.geoPeirceQuincuncial=ia,g.geoPierceQuincuncial=ia,g.geoQuantize=function(qe,We){if(!(0<=(We=+We)&&We<=20))throw new Error("invalid digits");function rt(Qt){var un=Qt.length,xn=2,Sn=new Array(un);for(Sn[0]=+Qt[0].toFixed(We),Sn[1]=+Qt[1].toFixed(We);xn<un;)Sn[xn]=Qt[xn],++xn;return Sn}function ft(Qt){return Qt.map(rt)}function bt(Qt){for(var un=rt(Qt[0]),xn=[un],Sn=1;Sn<Qt.length;Sn++){var Cn=rt(Qt[Sn]);(Cn.length>2||Cn[0]!=un[0]||Cn[1]!=un[1])&&(xn.push(Cn),un=Cn)}return 1===xn.length&&Qt.length>1&&xn.push(rt(Qt[Qt.length-1])),xn}function vt(Qt){return Qt.map(bt)}function Pt(Qt){if(null==Qt)return Qt;var un;switch(Qt.type){case"GeometryCollection":un={type:"GeometryCollection",geometries:Qt.geometries.map(Pt)};break;case"Point":un={type:"Point",coordinates:rt(Qt.coordinates)};break;case"MultiPoint":un={type:Qt.type,coordinates:ft(Qt.coordinates)};break;case"LineString":un={type:Qt.type,coordinates:bt(Qt.coordinates)};break;case"MultiLineString":case"Polygon":un={type:Qt.type,coordinates:vt(Qt.coordinates)};break;case"MultiPolygon":un={type:"MultiPolygon",coordinates:Qt.coordinates.map(vt)};break;default:return Qt}return null!=Qt.bbox&&(un.bbox=Qt.bbox),un}function tn(Qt){var un={type:"Feature",properties:Qt.properties,geometry:Pt(Qt.geometry)};return null!=Qt.id&&(un.id=Qt.id),null!=Qt.bbox&&(un.bbox=Qt.bbox),un}if(null!=qe)switch(qe.type){case"Feature":return tn(qe);case"FeatureCollection":var rn={type:"FeatureCollection",features:qe.features.map(tn)};return null!=qe.bbox&&(rn.bbox=qe.bbox),rn;default:return Pt(qe)}return qe},g.geoQuincuncial=ra,g.geoRectangularPolyconic=function(){return fe(so).scale(131.215)},g.geoRectangularPolyconicRaw=so,g.geoRobinson=function(){return t.geoProjection(Ra).scale(152.63)},g.geoRobinsonRaw=Ra,g.geoSatellite=function(){var qe=2,We=0,rt=t.geoProjectionMutator(Fa),ft=rt(qe,We);return ft.distance=function(bt){return arguments.length?rt(qe=+bt,We):qe},ft.tilt=function(bt){return arguments.length?rt(qe,We=bt*P):We*M},ft.scale(432.147).clipAngle(S(1/qe)*M-1e-6)},g.geoSatelliteRaw=Fa,g.geoSinuMollweide=function(){return t.geoProjection(zt).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},g.geoSinuMollweideRaw=zt,g.geoSinusoidal=function(){return t.geoProjection(xe).scale(152.63)},g.geoSinusoidalRaw=xe,g.geoStitch=function(qe){if(null==qe)return qe;switch(qe.type){case"Feature":return ta(qe);case"FeatureCollection":var We={type:"FeatureCollection",features:qe.features.map(ta)};return null!=qe.bbox&&(We.bbox=qe.bbox),We;default:return ls(qe)}},g.geoTimes=function(){return t.geoProjection(ts).scale(146.153)},g.geoTimesRaw=ts,g.geoTwoPointAzimuthal=_s,g.geoTwoPointAzimuthalRaw=Ms,g.geoTwoPointAzimuthalUsa=function(){return _s([-158,21.5],[-77,39]).clipAngle(60).scale(400)},g.geoTwoPointEquidistant=vo,g.geoTwoPointEquidistantRaw=Ss,g.geoTwoPointEquidistantUsa=function(){return vo([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},g.geoVanDerGrinten=function(){return t.geoProjection(Lo).scale(79.4183)},g.geoVanDerGrintenRaw=Lo,g.geoVanDerGrinten2=function(){return t.geoProjection(Bo).scale(79.4183)},g.geoVanDerGrinten2Raw=Bo,g.geoVanDerGrinten3=function(){return t.geoProjection(qo).scale(79.4183)},g.geoVanDerGrinten3Raw=qo,g.geoVanDerGrinten4=function(){return t.geoProjection(Ho).scale(127.16)},g.geoVanDerGrinten4Raw=Ho,g.geoWagner=wo,g.geoWagner7=function(){return wo().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},g.geoWagnerRaw=ns,g.geoWagner4=function(){return t.geoProjection(Yo).scale(176.84)},g.geoWagner4Raw=Yo,g.geoWagner6=function(){return t.geoProjection(ms).scale(152.63)},g.geoWagner6Raw=ms,g.geoWiechel=function(){return t.geoProjection(zo).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},g.geoWiechelRaw=zo,g.geoWinkel3=function(){return t.geoProjection(Gi).scale(158.837)},g.geoWinkel3Raw=Gi,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-geo"),v("d3-array")):t(g.d3=g.d3||{},g.d3,g.d3)},{"d3-array":107,"d3-geo":114}],114:[function(v,Q,$){var g,t;g=this,t=function(g,t){"use strict";function k(){return new x}function x(){this.reset()}x.prototype={constructor:x,reset:function(){this.s=this.t=0},add:function(mt){r(e,mt,this.t),r(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new x;function r(mt,Bt,pn){var Xt=mt.s=Bt+pn,dn=Xt-Bt;mt.t=Bt-(Xt-dn)+(pn-dn)}var i=1e-6,c=Math.PI,n=c/2,m=c/4,p=2*c,s=180/c,f=c/180,l=Math.abs,o=Math.atan,d=Math.atan2,u=Math.cos,a=Math.ceil,y=Math.exp,h=Math.log,_=Math.pow,b=Math.sin,w=Math.sign||function(mt){return mt>0?1:mt<0?-1:0},T=Math.sqrt,L=Math.tan;function M(mt){return mt>1?0:mt<-1?c:Math.acos(mt)}function P(mt){return mt>1?n:mt<-1?-n:Math.asin(mt)}function z(mt){return(mt=b(mt/2))*mt}function S(){}function C(mt,Bt){mt&&D.hasOwnProperty(mt.type)&&D[mt.type](mt,Bt)}var R={Feature:function(mt,Bt){C(mt.geometry,Bt)},FeatureCollection:function(mt,Bt){for(var pn=mt.features,Xt=-1,dn=pn.length;++Xt<dn;)C(pn[Xt].geometry,Bt)}},D={Sphere:function(mt,Bt){Bt.sphere()},Point:function(mt,Bt){Bt.point((mt=mt.coordinates)[0],mt[1],mt[2])},MultiPoint:function(mt,Bt){for(var pn=mt.coordinates,Xt=-1,dn=pn.length;++Xt<dn;)Bt.point((mt=pn[Xt])[0],mt[1],mt[2])},LineString:function(mt,Bt){j(mt.coordinates,Bt,0)},MultiLineString:function(mt,Bt){for(var pn=mt.coordinates,Xt=-1,dn=pn.length;++Xt<dn;)j(pn[Xt],Bt,0)},Polygon:function(mt,Bt){q(mt.coordinates,Bt)},MultiPolygon:function(mt,Bt){for(var pn=mt.coordinates,Xt=-1,dn=pn.length;++Xt<dn;)q(pn[Xt],Bt)},GeometryCollection:function(mt,Bt){for(var pn=mt.geometries,Xt=-1,dn=pn.length;++Xt<dn;)C(pn[Xt],Bt)}};function j(mt,Bt,pn){var Xt,dn=-1,Fn=mt.length-pn;for(Bt.lineStart();++dn<Fn;)Bt.point((Xt=mt[dn])[0],Xt[1],Xt[2]);Bt.lineEnd()}function q(mt,Bt){var pn=-1,Xt=mt.length;for(Bt.polygonStart();++pn<Xt;)j(mt[pn],Bt,1);Bt.polygonEnd()}function Z(mt,Bt){mt&&R.hasOwnProperty(mt.type)?R[mt.type](mt,Bt):C(mt,Bt)}var W,G,X,ne,V,N=k(),U=k(),ee={point:S,lineStart:S,lineEnd:S,polygonStart:function(){N.reset(),ee.lineStart=B,ee.lineEnd=K},polygonEnd:function(){var mt=+N;U.add(mt<0?p+mt:mt),this.lineStart=this.lineEnd=this.point=S},sphere:function(){U.add(p)}};function B(){ee.point=J}function K(){te(W,G)}function J(mt,Bt){ee.point=te,W=mt,G=Bt,X=mt*=f,ne=u(Bt=(Bt*=f)/2+m),V=b(Bt)}function te(mt,Bt){var pn=(mt*=f)-X,Xt=pn>=0?1:-1,dn=Xt*pn,Fn=u(Bt=(Bt*=f)/2+m),Zn=b(Bt),er=V*Zn,yr=ne*Fn+er*u(dn),gr=er*Xt*b(dn);N.add(d(gr,yr)),X=mt,ne=Fn,V=Zn}function ae(mt){return[d(mt[1],mt[0]),P(mt[2])]}function ce(mt){var Bt=mt[0],pn=mt[1],Xt=u(pn);return[Xt*u(Bt),Xt*b(Bt),b(pn)]}function oe(mt,Bt){return mt[0]*Bt[0]+mt[1]*Bt[1]+mt[2]*Bt[2]}function ve(mt,Bt){return[mt[1]*Bt[2]-mt[2]*Bt[1],mt[2]*Bt[0]-mt[0]*Bt[2],mt[0]*Bt[1]-mt[1]*Bt[0]]}function fe(mt,Bt){mt[0]+=Bt[0],mt[1]+=Bt[1],mt[2]+=Bt[2]}function xe(mt,Bt){return[mt[0]*Bt,mt[1]*Bt,mt[2]*Bt]}function Se(mt){var Bt=T(mt[0]*mt[0]+mt[1]*mt[1]+mt[2]*mt[2]);mt[0]/=Bt,mt[1]/=Bt,mt[2]/=Bt}var pe,ge,Te,se,de,Ae,Le,Me,De,Oe,Ie,Qe,Ne,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et,yt,Vt,Gt,en=k(),Jt={point:cn,lineStart:je,lineEnd:Ye,polygonStart:function(){Jt.point=he,Jt.lineStart=be,Jt.lineEnd=Fe,en.reset(),ee.polygonStart()},polygonEnd:function(){ee.polygonEnd(),Jt.point=cn,Jt.lineStart=je,Jt.lineEnd=Ye,N<0?(pe=-(Te=180),ge=-(se=90)):en>i?se=90:en<-i&&(ge=-90),Oe[0]=pe,Oe[1]=Te},sphere:function(){pe=-(Te=180),ge=-(se=90)}};function cn(mt,Bt){De.push(Oe=[pe=mt,Te=mt]),Bt<ge&&(ge=Bt),Bt>se&&(se=Bt)}function Rt(mt,Bt){var pn=ce([mt*f,Bt*f]);if(Me){var Xt=ve(Me,pn),dn=ve([Xt[1],-Xt[0],0],Xt);Se(dn),dn=ae(dn);var Fn,Zn=mt-de,er=Zn>0?1:-1,yr=dn[0]*s*er,gr=l(Zn)>180;gr^(er*de<yr&&yr<er*mt)?(Fn=dn[1]*s)>se&&(se=Fn):gr^(er*de<(yr=(yr+360)%360-180)&&yr<er*mt)?(Fn=-dn[1]*s)<ge&&(ge=Fn):(Bt<ge&&(ge=Bt),Bt>se&&(se=Bt)),gr?mt<de?He(pe,mt)>He(pe,Te)&&(Te=mt):He(mt,Te)>He(pe,Te)&&(pe=mt):Te>=pe?(mt<pe&&(pe=mt),mt>Te&&(Te=mt)):mt>de?He(pe,mt)>He(pe,Te)&&(Te=mt):He(mt,Te)>He(pe,Te)&&(pe=mt)}else De.push(Oe=[pe=mt,Te=mt]);Bt<ge&&(ge=Bt),Bt>se&&(se=Bt),Me=pn,de=mt}function je(){Jt.point=Rt}function Ye(){Oe[0]=pe,Oe[1]=Te,Jt.point=cn,Me=null}function he(mt,Bt){if(Me){var pn=mt-de;en.add(l(pn)>180?pn+(pn>0?360:-360):pn)}else Ae=mt,Le=Bt;ee.point(mt,Bt),Rt(mt,Bt)}function be(){ee.lineStart()}function Fe(){he(Ae,Le),ee.lineEnd(),l(en)>i&&(pe=-(Te=180)),Oe[0]=pe,Oe[1]=Te,Me=null}function He(mt,Bt){return(Bt-=mt)<0?Bt+360:Bt}function Ke(mt,Bt){return mt[0]-Bt[0]}function Ze(mt,Bt){return mt[0]<=mt[1]?mt[0]<=Bt&&Bt<=mt[1]:Bt<mt[0]||mt[1]<Bt}var ut={sphere:S,point:lt,lineStart:Ot,lineEnd:qt,polygonStart:function(){ut.lineStart=St,ut.lineEnd=Mt},polygonEnd:function(){ut.lineStart=Ot,ut.lineEnd=qt}};function lt(mt,Bt){mt*=f;var pn=u(Bt*=f);Lt(pn*u(mt),pn*b(mt),b(Bt))}function Lt(mt,Bt,pn){++Ie,Ne+=(mt-Ne)/Ie,Pe+=(Bt-Pe)/Ie,Re+=(pn-Re)/Ie}function Ot(){ut.point=ot}function ot(mt,Bt){mt*=f;var pn=u(Bt*=f);yt=pn*u(mt),Vt=pn*b(mt),Gt=b(Bt),ut.point=pt,Lt(yt,Vt,Gt)}function pt(mt,Bt){mt*=f;var pn=u(Bt*=f),Xt=pn*u(mt),dn=pn*b(mt),Fn=b(Bt),Zn=d(T((Zn=Vt*Fn-Gt*dn)*Zn+(Zn=Gt*Xt-yt*Fn)*Zn+(Zn=yt*dn-Vt*Xt)*Zn),yt*Xt+Vt*dn+Gt*Fn);Qe+=Zn,Ge+=Zn*(yt+(yt=Xt)),tt+=Zn*(Vt+(Vt=dn)),ct+=Zn*(Gt+(Gt=Fn)),Lt(yt,Vt,Gt)}function qt(){ut.point=lt}function St(){ut.point=Ce}function Mt(){Xe(at,et),ut.point=lt}function Ce(mt,Bt){at=mt,et=Bt,mt*=f,Bt*=f,ut.point=Xe;var pn=u(Bt);yt=pn*u(mt),Vt=pn*b(mt),Gt=b(Bt),Lt(yt,Vt,Gt)}function Xe(mt,Bt){mt*=f;var pn=u(Bt*=f),Xt=pn*u(mt),dn=pn*b(mt),Fn=b(Bt),Zn=Vt*Fn-Gt*dn,er=Gt*Xt-yt*Fn,yr=yt*dn-Vt*Xt,gr=T(Zn*Zn+er*er+yr*yr),Tr=P(gr),Ir=gr&&-Tr/gr;wt+=Ir*Zn,kt+=Ir*er,gt+=Ir*yr,Qe+=Tr,Ge+=Tr*(yt+(yt=Xt)),tt+=Tr*(Vt+(Vt=dn)),ct+=Tr*(Gt+(Gt=Fn)),Lt(yt,Vt,Gt)}function st(mt){return function(){return mt}}function dt(mt,Bt){function pn(Xt,dn){return Xt=mt(Xt,dn),Bt(Xt[0],Xt[1])}return mt.invert&&Bt.invert&&(pn.invert=function(Xt,dn){return(Xt=Bt.invert(Xt,dn))&&mt.invert(Xt[0],Xt[1])}),pn}function zt(mt,Bt){return[l(mt)>c?mt+Math.round(-mt/p)*p:mt,Bt]}function Ht(mt,Bt,pn){return(mt%=p)?Bt||pn?dt(Zt(mt),vn(Bt,pn)):Zt(mt):Bt||pn?vn(Bt,pn):zt}function Kt(mt){return function(Bt,pn){return[(Bt+=mt)>c?Bt-p:Bt<-c?Bt+p:Bt,pn]}}function Zt(mt){var Bt=Kt(mt);return Bt.invert=Kt(-mt),Bt}function vn(mt,Bt){var pn=u(mt),Xt=b(mt),dn=u(Bt),Fn=b(Bt);function Zn(er,yr){var gr=u(yr),Tr=u(er)*gr,Ir=b(er)*gr,xr=b(yr),Dr=xr*pn+Tr*Xt;return[d(Ir*dn-Dr*Fn,Tr*pn-xr*Xt),P(Dr*dn+Ir*Fn)]}return Zn.invert=function(er,yr){var gr=u(yr),Tr=u(er)*gr,Ir=b(er)*gr,xr=b(yr),Dr=xr*dn-Ir*Fn;return[d(Ir*dn+xr*Fn,Tr*pn+Dr*Xt),P(Dr*pn-Tr*Xt)]},Zn}function zn(mt){function Bt(pn){return(pn=mt(pn[0]*f,pn[1]*f))[0]*=s,pn[1]*=s,pn}return mt=Ht(mt[0]*f,mt[1]*f,mt.length>2?mt[2]*f:0),Bt.invert=function(pn){return(pn=mt.invert(pn[0]*f,pn[1]*f))[0]*=s,pn[1]*=s,pn},Bt}function gn(mt,Bt,pn,Xt,dn,Fn){if(pn){var Zn=u(Bt),er=b(Bt),yr=Xt*pn;null==dn?(dn=Bt+Xt*p,Fn=Bt-yr/2):(dn=nn(Zn,dn),Fn=nn(Zn,Fn),(Xt>0?dn<Fn:dn>Fn)&&(dn+=Xt*p));for(var gr,Tr=dn;Xt>0?Tr>Fn:Tr<Fn;Tr-=yr)gr=ae([Zn,-er*u(Tr),-er*b(Tr)]),mt.point(gr[0],gr[1])}}function nn(mt,Bt){(Bt=ce(Bt))[0]-=mt,Se(Bt);var pn=M(-Bt[1]);return((-Bt[2]<0?-pn:pn)+p-i)%p}function an(){var mt,Bt=[];return{point:function(pn,Xt,dn){mt.push([pn,Xt,dn])},lineStart:function(){Bt.push(mt=[])},lineEnd:S,rejoin:function(){Bt.length>1&&Bt.push(Bt.pop().concat(Bt.shift()))},result:function(){var pn=Bt;return Bt=[],mt=null,pn}}}function on(mt,Bt){return l(mt[0]-Bt[0])<i&&l(mt[1]-Bt[1])<i}function mn(mt,Bt,pn,Xt){this.x=mt,this.z=Bt,this.o=pn,this.e=Xt,this.v=!1,this.n=this.p=null}function _n(mt,Bt,pn,Xt,dn){var Fn,Zn,er=[],yr=[];if(mt.forEach(function(Zr){if(!((ei=Zr.length-1)<=0)){var ei,yi,nr=Zr[0],mi=Zr[ei];if(on(nr,mi)){if(!nr[2]&&!mi[2]){for(dn.lineStart(),Fn=0;Fn<ei;++Fn)dn.point((nr=Zr[Fn])[0],nr[1]);return void dn.lineEnd()}mi[0]+=2*i}er.push(yi=new mn(nr,Zr,null,!0)),yr.push(yi.o=new mn(nr,null,yi,!1)),er.push(yi=new mn(mi,Zr,null,!1)),yr.push(yi.o=new mn(mi,null,yi,!0))}}),er.length){for(yr.sort(Bt),Pn(er),Pn(yr),Fn=0,Zn=yr.length;Fn<Zn;++Fn)yr[Fn].e=pn=!pn;for(var gr,Tr,Ir=er[0];;){for(var xr=Ir,Dr=!0;xr.v;)if((xr=xr.n)===Ir)return;gr=xr.z,dn.lineStart();do{if(xr.v=xr.o.v=!0,xr.e){if(Dr)for(Fn=0,Zn=gr.length;Fn<Zn;++Fn)dn.point((Tr=gr[Fn])[0],Tr[1]);else Xt(xr.x,xr.n.x,1,dn);xr=xr.n}else{if(Dr)for(Fn=(gr=xr.p.z).length-1;Fn>=0;--Fn)dn.point((Tr=gr[Fn])[0],Tr[1]);else Xt(xr.x,xr.p.x,-1,dn);xr=xr.p}gr=(xr=xr.o).z,Dr=!Dr}while(!xr.v);dn.lineEnd()}}}function Pn(mt){if(Bt=mt.length){for(var Bt,pn,Xt=0,dn=mt[0];++Xt<Bt;)dn.n=pn=mt[Xt],pn.p=dn,dn=pn;dn.n=pn=mt[0],pn.p=dn}}zt.invert=zt;var Rn=k();function qn(mt){return l(mt[0])<=c?mt[0]:w(mt[0])*((l(mt[0])+c)%p-c)}function Xn(mt,Bt){var pn=qn(Bt),Xt=Bt[1],dn=b(Xt),Fn=[b(pn),-u(pn),0],Zn=0,er=0;Rn.reset(),1===dn?Xt=n+i:-1===dn&&(Xt=-n-i);for(var yr=0,gr=mt.length;yr<gr;++yr)if(Ir=(Tr=mt[yr]).length)for(var Tr,Ir,xr=Tr[Ir-1],Dr=qn(xr),Zr=xr[1]/2+m,ei=b(Zr),yi=u(Zr),nr=0;nr<Ir;++nr,Dr=Hr,ei=di,yi=Pi,xr=mi){var mi=Tr[nr],Hr=qn(mi),Jr=mi[1]/2+m,di=b(Jr),Pi=u(Jr),Vi=Hr-Dr,Br=Vi>=0?1:-1,Wi=Br*Vi,Ui=Wi>c,Mi=ei*di;if(Rn.add(d(Mi*Br*b(Wi),yi*Pi+Mi*u(Wi))),Zn+=Ui?Vi+Br*p:Vi,Ui^Dr>=pn^Hr>=pn){var Ji=ve(ce(xr),ce(mi));Se(Ji);var Bi=ve(Fn,Ji);Se(Bi);var ua=(Ui^Vi>=0?-1:1)*P(Bi[2]);(Xt>ua||Xt===ua&&(Ji[0]||Ji[1]))&&(er+=Ui^Vi>=0?1:-1)}}return(Zn<-i||Zn<i&&Rn<-i)^1&er}function br(mt,Bt,pn,Xt){return function(dn){var Fn,Zn,er,yr=Bt(dn),gr=an(),Tr=Bt(gr),Ir=!1,xr={point:Dr,lineStart:ei,lineEnd:yi,polygonStart:function(){xr.point=nr,xr.lineStart=mi,xr.lineEnd=Hr,Zn=[],Fn=[]},polygonEnd:function(){xr.point=Dr,xr.lineStart=ei,xr.lineEnd=yi,Zn=t.merge(Zn);var Jr=Xn(Fn,Xt);Zn.length?(Ir||(dn.polygonStart(),Ir=!0),_n(Zn,Vr,Jr,pn,dn)):Jr&&(Ir||(dn.polygonStart(),Ir=!0),dn.lineStart(),pn(null,null,1,dn),dn.lineEnd()),Ir&&(dn.polygonEnd(),Ir=!1),Zn=Fn=null},sphere:function(){dn.polygonStart(),dn.lineStart(),pn(null,null,1,dn),dn.lineEnd(),dn.polygonEnd()}};function Dr(Jr,di){mt(Jr,di)&&dn.point(Jr,di)}function Zr(Jr,di){yr.point(Jr,di)}function ei(){xr.point=Zr,yr.lineStart()}function yi(){xr.point=Dr,yr.lineEnd()}function nr(Jr,di){er.push([Jr,di]),Tr.point(Jr,di)}function mi(){Tr.lineStart(),er=[]}function Hr(){nr(er[0][0],er[0][1]),Tr.lineEnd();var Jr,di,Pi,Vi,Br=Tr.clean(),Wi=gr.result(),Ui=Wi.length;if(er.pop(),Fn.push(er),er=null,Ui)if(1&Br){if((di=(Pi=Wi[0]).length-1)>0){for(Ir||(dn.polygonStart(),Ir=!0),dn.lineStart(),Jr=0;Jr<di;++Jr)dn.point((Vi=Pi[Jr])[0],Vi[1]);dn.lineEnd()}}else Ui>1&&2&Br&&Wi.push(Wi.pop().concat(Wi.shift())),Zn.push(Wi.filter(fr))}return xr}}function fr(mt){return mt.length>1}function Vr(mt,Bt){return((mt=mt.x)[0]<0?mt[1]-n-i:n-mt[1])-((Bt=Bt.x)[0]<0?Bt[1]-n-i:n-Bt[1])}var cr=br(function(){return!0},function(mt){var Bt,pn=NaN,Xt=NaN,dn=NaN;return{lineStart:function(){mt.lineStart(),Bt=1},point:function(Fn,Zn){var gr,Tr,Ir,xr,Dr,Zr,ei,er=Fn>0?c:-c,yr=l(Fn-pn);l(yr-c)<i?(mt.point(pn,Xt=(Xt+Zn)/2>0?n:-n),mt.point(dn,Xt),mt.lineEnd(),mt.lineStart(),mt.point(er,Xt),mt.point(Fn,Xt),Bt=0):dn!==er&&yr>=c&&(l(pn-dn)<i&&(pn-=dn*i),l(Fn-er)<i&&(Fn-=er*i),Tr=Xt,xr=Zn,ei=b((gr=pn)-(Ir=Fn)),Xt=l(ei)>i?o((b(Tr)*(Zr=u(xr))*b(Ir)-b(xr)*(Dr=u(Tr))*b(gr))/(Dr*Zr*ei)):(Tr+xr)/2,mt.point(dn,Xt),mt.lineEnd(),mt.lineStart(),mt.point(er,Xt),Bt=0),mt.point(pn=Fn,Xt=Zn),dn=er},lineEnd:function(){mt.lineEnd(),pn=Xt=NaN},clean:function(){return 2-Bt}}},function(mt,Bt,pn,Xt){var dn;if(null==mt)Xt.point(-c,dn=pn*n),Xt.point(0,dn),Xt.point(c,dn),Xt.point(c,0),Xt.point(c,-dn),Xt.point(0,-dn),Xt.point(-c,-dn),Xt.point(-c,0),Xt.point(-c,dn);else if(l(mt[0]-Bt[0])>i){var Fn=mt[0]<Bt[0]?c:-c;Xt.point(-Fn,dn=pn*Fn/2),Xt.point(0,dn),Xt.point(Fn,dn)}else Xt.point(Bt[0],Bt[1])},[-c,-n]);function Sr(mt){var Bt=u(mt),pn=6*f,Xt=Bt>0,dn=l(Bt)>i;function Fn(yr,gr){return u(yr)*u(gr)>Bt}function Zn(yr,gr,Tr){var Ir=[1,0,0],xr=ve(ce(yr),ce(gr)),Dr=oe(xr,xr),Zr=xr[0],ei=Dr-Zr*Zr;if(!ei)return!Tr&&yr;var yi=Bt*Dr/ei,nr=-Bt*Zr/ei,mi=ve(Ir,xr),Hr=xe(Ir,yi);fe(Hr,xe(xr,nr));var Jr=mi,di=oe(Hr,Jr),Pi=oe(Jr,Jr),Vi=di*di-Pi*(oe(Hr,Hr)-1);if(!(Vi<0)){var Br=T(Vi),Wi=xe(Jr,(-di-Br)/Pi);if(fe(Wi,Hr),Wi=ae(Wi),!Tr)return Wi;var Ui,Mi=yr[0],Ji=gr[0],Bi=yr[1],ua=gr[1];Ji<Mi&&(Ui=Mi,Mi=Ji,Ji=Ui);var gi=Ji-Mi,aa=l(gi-c)<i;if(!aa&&ua<Bi&&(Ui=Bi,Bi=ua,ua=Ui),aa||gi<i?aa?Bi+ua>0^Wi[1]<(l(Wi[0]-Mi)<i?Bi:ua):Bi<=Wi[1]&&Wi[1]<=ua:gi>c^(Mi<=Wi[0]&&Wi[0]<=Ji)){var Qa=xe(Jr,(-di+Br)/Pi);return fe(Qa,Hr),[Wi,ae(Qa)]}}}function er(yr,gr){var Tr=Xt?mt:c-mt,Ir=0;return yr<-Tr?Ir|=1:yr>Tr&&(Ir|=2),gr<-Tr?Ir|=4:gr>Tr&&(Ir|=8),Ir}return br(Fn,function(yr){var gr,Tr,Ir,xr,Dr;return{lineStart:function(){xr=Ir=!1,Dr=1},point:function(Zr,ei){var yi,nr=[Zr,ei],mi=Fn(Zr,ei),Hr=Xt?mi?0:er(Zr,ei):mi?er(Zr+(Zr<0?c:-c),ei):0;if(!gr&&(xr=Ir=mi)&&yr.lineStart(),mi!==Ir&&(!(yi=Zn(gr,nr))||on(gr,yi)||on(nr,yi))&&(nr[2]=1),mi!==Ir)Dr=0,mi?(yr.lineStart(),yi=Zn(nr,gr),yr.point(yi[0],yi[1])):(yi=Zn(gr,nr),yr.point(yi[0],yi[1],2),yr.lineEnd()),gr=yi;else if(dn&&gr&&Xt^mi){var Jr;Hr&Tr||!(Jr=Zn(nr,gr,!0))||(Dr=0,Xt?(yr.lineStart(),yr.point(Jr[0][0],Jr[0][1]),yr.point(Jr[1][0],Jr[1][1]),yr.lineEnd()):(yr.point(Jr[1][0],Jr[1][1]),yr.lineEnd(),yr.lineStart(),yr.point(Jr[0][0],Jr[0][1],3)))}!mi||gr&&on(gr,nr)||yr.point(nr[0],nr[1]),gr=nr,Ir=mi,Tr=Hr},lineEnd:function(){Ir&&yr.lineEnd(),gr=null},clean:function(){return Dr|(xr&&Ir)<<1}}},function(yr,gr,Tr,Ir){gn(Ir,mt,pn,Tr,yr,gr)},Xt?[0,-mt]:[-c,mt-c])}function Cr(mt,Bt,pn,Xt){function dn(gr,Tr){return mt<=gr&&gr<=pn&&Bt<=Tr&&Tr<=Xt}function Fn(gr,Tr,Ir,xr){var Dr=0,Zr=0;if(null==gr||(Dr=Zn(gr,Ir))!==(Zr=Zn(Tr,Ir))||yr(gr,Tr)<0^Ir>0)do{xr.point(0===Dr||3===Dr?mt:pn,Dr>1?Xt:Bt)}while((Dr=(Dr+Ir+4)%4)!==Zr);else xr.point(Tr[0],Tr[1])}function Zn(gr,Tr){return l(gr[0]-mt)<i?Tr>0?0:3:l(gr[0]-pn)<i?Tr>0?2:1:l(gr[1]-Bt)<i?Tr>0?1:0:Tr>0?3:2}function er(gr,Tr){return yr(gr.x,Tr.x)}function yr(gr,Tr){var Ir=Zn(gr,1),xr=Zn(Tr,1);return Ir!==xr?Ir-xr:0===Ir?Tr[1]-gr[1]:1===Ir?gr[0]-Tr[0]:2===Ir?gr[1]-Tr[1]:Tr[0]-gr[0]}return function(gr){var Tr,Ir,xr,Dr,Zr,ei,yi,nr,mi,Hr,Jr,di=gr,Pi=an(),Vi={point:Br,lineStart:function(){Vi.point=Wi,Ir&&Ir.push(xr=[]),Hr=!0,mi=!1,yi=nr=NaN},lineEnd:function(){Tr&&(Wi(Dr,Zr),ei&&mi&&Pi.rejoin(),Tr.push(Pi.result())),Vi.point=Br,mi&&di.lineEnd()},polygonStart:function(){di=Pi,Tr=[],Ir=[],Jr=!0},polygonEnd:function(){var Ui=function(){for(var Bi=0,ua=0,gi=Ir.length;ua<gi;++ua)for(var aa,Qa,Jo=Ir[ua],jo=1,To=Jo.length,Ei=Jo[0],ka=Ei[0],ko=Ei[1];jo<To;++jo)aa=ka,Qa=ko,ka=(Ei=Jo[jo])[0],ko=Ei[1],Qa<=Xt?ko>Xt&&(ka-aa)*(Xt-Qa)>(ko-Qa)*(mt-aa)&&++Bi:ko<=Xt&&(ka-aa)*(Xt-Qa)<(ko-Qa)*(mt-aa)&&--Bi;return Bi}(),Mi=Jr&&Ui,Ji=(Tr=t.merge(Tr)).length;(Mi||Ji)&&(gr.polygonStart(),Mi&&(gr.lineStart(),Fn(null,null,1,gr),gr.lineEnd()),Ji&&_n(Tr,er,Ui,Fn,gr),gr.polygonEnd()),di=gr,Tr=Ir=xr=null}};function Br(Ui,Mi){dn(Ui,Mi)&&di.point(Ui,Mi)}function Wi(Ui,Mi){var Ji=dn(Ui,Mi);if(Ir&&xr.push([Ui,Mi]),Hr)Dr=Ui,Zr=Mi,ei=Ji,Hr=!1,Ji&&(di.lineStart(),di.point(Ui,Mi));else if(Ji&&mi)di.point(Ui,Mi);else{var Bi=[yi=Math.max(-1e9,Math.min(1e9,yi)),nr=Math.max(-1e9,Math.min(1e9,nr))],ua=[Ui=Math.max(-1e9,Math.min(1e9,Ui)),Mi=Math.max(-1e9,Math.min(1e9,Mi))];!function(gi,aa,Qa,Jo,jo,To){var Ei,ka=gi[0],ko=gi[1],oa=0,Pa=1,eo=aa[0]-ka,pa=aa[1]-ko;if(Ei=Qa-ka,eo||!(Ei>0)){if(Ei/=eo,eo<0){if(Ei<oa)return;Ei<Pa&&(Pa=Ei)}else if(eo>0){if(Ei>Pa)return;Ei>oa&&(oa=Ei)}if(Ei=jo-ka,eo||!(Ei<0)){if(Ei/=eo,eo<0){if(Ei>Pa)return;Ei>oa&&(oa=Ei)}else if(eo>0){if(Ei<oa)return;Ei<Pa&&(Pa=Ei)}if(Ei=Jo-ko,pa||!(Ei>0)){if(Ei/=pa,pa<0){if(Ei<oa)return;Ei<Pa&&(Pa=Ei)}else if(pa>0){if(Ei>Pa)return;Ei>oa&&(oa=Ei)}if(Ei=To-ko,pa||!(Ei<0)){if(Ei/=pa,pa<0){if(Ei>Pa)return;Ei>oa&&(oa=Ei)}else if(pa>0){if(Ei<oa)return;Ei<Pa&&(Pa=Ei)}return oa>0&&(gi[0]=ka+oa*eo,gi[1]=ko+oa*pa),Pa<1&&(aa[0]=ka+Pa*eo,aa[1]=ko+Pa*pa),!0}}}}}(Bi,ua,mt,Bt,pn,Xt)?Ji&&(di.lineStart(),di.point(Ui,Mi),Jr=!1):(mi||(di.lineStart(),di.point(Bi[0],Bi[1])),di.point(ua[0],ua[1]),Ji||di.lineEnd(),Jr=!1)}yi=Ui,nr=Mi,mi=Ji}return Vi}}var pi,Yn,ar,Ar=k(),sr={sphere:S,point:S,lineStart:function(){sr.point=$r,sr.lineEnd=dr},lineEnd:S,polygonStart:S,polygonEnd:S};function dr(){sr.point=sr.lineEnd=S}function $r(mt,Bt){pi=mt*=f,Yn=b(Bt*=f),ar=u(Bt),sr.point=Lr}function Lr(mt,Bt){mt*=f;var pn=b(Bt*=f),Xt=u(Bt),dn=l(mt-pi),Fn=u(dn),Zn=Xt*b(dn),er=ar*pn-Yn*Xt*Fn,yr=Yn*pn+ar*Xt*Fn;Ar.add(d(T(Zn*Zn+er*er),yr)),pi=mt,Yn=pn,ar=Xt}function jr(mt){return Ar.reset(),Z(mt,sr),+Ar}var ri=[null,null],sn={type:"LineString",coordinates:ri};function wn(mt,Bt){return ri[0]=mt,ri[1]=Bt,jr(sn)}var It={Feature:function(mt,Bt){return yn(mt.geometry,Bt)},FeatureCollection:function(mt,Bt){for(var pn=mt.features,Xt=-1,dn=pn.length;++Xt<dn;)if(yn(pn[Xt].geometry,Bt))return!0;return!1}},hn={Sphere:function(){return!0},Point:function(mt,Bt){return Hn(mt.coordinates,Bt)},MultiPoint:function(mt,Bt){for(var pn=mt.coordinates,Xt=-1,dn=pn.length;++Xt<dn;)if(Hn(pn[Xt],Bt))return!0;return!1},LineString:function(mt,Bt){return Un(mt.coordinates,Bt)},MultiLineString:function(mt,Bt){for(var pn=mt.coordinates,Xt=-1,dn=pn.length;++Xt<dn;)if(Un(pn[Xt],Bt))return!0;return!1},Polygon:function(mt,Bt){return jn(mt.coordinates,Bt)},MultiPolygon:function(mt,Bt){for(var pn=mt.coordinates,Xt=-1,dn=pn.length;++Xt<dn;)if(jn(pn[Xt],Bt))return!0;return!1},GeometryCollection:function(mt,Bt){for(var pn=mt.geometries,Xt=-1,dn=pn.length;++Xt<dn;)if(yn(pn[Xt],Bt))return!0;return!1}};function yn(mt,Bt){return!(!mt||!hn.hasOwnProperty(mt.type))&&hn[mt.type](mt,Bt)}function Hn(mt,Bt){return 0===wn(mt,Bt)}function Un(mt,Bt){for(var pn,Xt,dn,Fn=0,Zn=mt.length;Fn<Zn;Fn++){if(0===(Xt=wn(mt[Fn],Bt))||Fn>0&&(dn=wn(mt[Fn],mt[Fn-1]))>0&&pn<=dn&&Xt<=dn&&(pn+Xt-dn)*(1-Math.pow((pn-Xt)/dn,2))<1e-12*dn)return!0;pn=Xt}return!1}function jn(mt,Bt){return!!Xn(mt.map(On),kn(Bt))}function On(mt){return(mt=mt.map(kn)).pop(),mt}function kn(mt){return[mt[0]*f,mt[1]*f]}function Mn(mt,Bt,pn){var Xt=t.range(mt,Bt-i,pn).concat(Bt);return function(dn){return Xt.map(function(Fn){return[dn,Fn]})}}function Ln(mt,Bt,pn){var Xt=t.range(mt,Bt-i,pn).concat(Bt);return function(dn){return Xt.map(function(Fn){return[Fn,dn]})}}function Dn(){var mt,Bt,pn,Xt,dn,Fn,Zn,er,yr,gr,Tr,Ir,xr=10,Dr=xr,Zr=90,ei=360,yi=2.5;function nr(){return{type:"MultiLineString",coordinates:mi()}}function mi(){return t.range(a(Xt/Zr)*Zr,pn,Zr).map(Tr).concat(t.range(a(er/ei)*ei,Zn,ei).map(Ir)).concat(t.range(a(Bt/xr)*xr,mt,xr).filter(function(Hr){return l(Hr%Zr)>i}).map(yr)).concat(t.range(a(Fn/Dr)*Dr,dn,Dr).filter(function(Hr){return l(Hr%ei)>i}).map(gr))}return nr.lines=function(){return mi().map(function(Hr){return{type:"LineString",coordinates:Hr}})},nr.outline=function(){return{type:"Polygon",coordinates:[Tr(Xt).concat(Ir(Zn).slice(1),Tr(pn).reverse().slice(1),Ir(er).reverse().slice(1))]}},nr.extent=function(Hr){return arguments.length?nr.extentMajor(Hr).extentMinor(Hr):nr.extentMinor()},nr.extentMajor=function(Hr){return arguments.length?(er=+Hr[0][1],Zn=+Hr[1][1],(Xt=+Hr[0][0])>(pn=+Hr[1][0])&&(Hr=Xt,Xt=pn,pn=Hr),er>Zn&&(Hr=er,er=Zn,Zn=Hr),nr.precision(yi)):[[Xt,er],[pn,Zn]]},nr.extentMinor=function(Hr){return arguments.length?(Fn=+Hr[0][1],dn=+Hr[1][1],(Bt=+Hr[0][0])>(mt=+Hr[1][0])&&(Hr=Bt,Bt=mt,mt=Hr),Fn>dn&&(Hr=Fn,Fn=dn,dn=Hr),nr.precision(yi)):[[Bt,Fn],[mt,dn]]},nr.step=function(Hr){return arguments.length?nr.stepMajor(Hr).stepMinor(Hr):nr.stepMinor()},nr.stepMajor=function(Hr){return arguments.length?(Zr=+Hr[0],ei=+Hr[1],nr):[Zr,ei]},nr.stepMinor=function(Hr){return arguments.length?(xr=+Hr[0],Dr=+Hr[1],nr):[xr,Dr]},nr.precision=function(Hr){return arguments.length?(yi=+Hr,yr=Mn(Fn,dn,90),gr=Ln(Bt,mt,yi),Tr=Mn(er,Zn,90),Ir=Ln(Xt,pn,yi),nr):yi},nr.extentMajor([[-180,-90+i],[180,90-i]]).extentMinor([[-180,-80-i],[180,80+i]])}function Kn(mt){return mt}var Qn,lr,hr,Mr,Er=k(),Pr=k(),Ur={point:S,lineStart:S,lineEnd:S,polygonStart:function(){Ur.lineStart=Yr,Ur.lineEnd=Ri},polygonEnd:function(){Ur.lineStart=Ur.lineEnd=Ur.point=S,Er.add(l(Pr)),Pr.reset()},result:function(){var mt=Er/2;return Er.reset(),mt}};function Yr(){Ur.point=si}function si(mt,Bt){Ur.point=Fi,Qn=hr=mt,lr=Mr=Bt}function Fi(mt,Bt){Pr.add(Mr*mt-hr*Bt),hr=mt,Mr=Bt}function Ri(){Fi(Qn,lr)}var Ba,go,ra,ia,Fr=1/0,fi=Fr,ci=-Fr,Yi=ci,Ta={point:function(mt,Bt){mt<Fr&&(Fr=mt),mt>ci&&(ci=mt),Bt<fi&&(fi=Bt),Bt>Yi&&(Yi=Bt)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S,result:function(){var mt=[[Fr,fi],[ci,Yi]];return ci=Yi=-(fi=Fr=1/0),mt}},so=0,Zi=0,Ra=0,Fa=0,_a=0,Xa=0,no=0,_o=0,Wa=0,xa={point:ro,lineStart:ds,lineEnd:ls,polygonStart:function(){xa.lineStart=ts,xa.lineEnd=As},polygonEnd:function(){xa.point=ro,xa.lineStart=ds,xa.lineEnd=ls},result:function(){var mt=Wa?[no/Wa,_o/Wa]:Xa?[Fa/Xa,_a/Xa]:Ra?[so/Ra,Zi/Ra]:[NaN,NaN];return so=Zi=Ra=Fa=_a=Xa=no=_o=Wa=0,mt}};function ro(mt,Bt){so+=mt,Zi+=Bt,++Ra}function ds(){xa.point=bs}function bs(mt,Bt){xa.point=ta,ro(ra=mt,ia=Bt)}function ta(mt,Bt){var pn=mt-ra,Xt=Bt-ia,dn=T(pn*pn+Xt*Xt);Fa+=dn*(ra+mt)/2,_a+=dn*(ia+Bt)/2,Xa+=dn,ro(ra=mt,ia=Bt)}function ls(){xa.point=ro}function ts(){xa.point=Ms}function As(){_s(Ba,go)}function Ms(mt,Bt){xa.point=_s,ro(Ba=ra=mt,go=ia=Bt)}function _s(mt,Bt){var pn=mt-ra,Xt=Bt-ia,dn=T(pn*pn+Xt*Xt);Fa+=dn*(ra+mt)/2,_a+=dn*(ia+Bt)/2,Xa+=dn,no+=(dn=ia*mt-ra*Bt)*(ra+mt),_o+=dn*(ia+Bt),Wa+=3*dn,ro(ra=mt,ia=Bt)}function Ss(mt){this._context=mt}Ss.prototype={_radius:4.5,pointRadius:function(mt){return this._radius=mt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(mt,Bt){switch(this._point){case 0:this._context.moveTo(mt,Bt),this._point=1;break;case 1:this._context.lineTo(mt,Bt);break;default:this._context.moveTo(mt+this._radius,Bt),this._context.arc(mt,Bt,this._radius,0,p)}},result:S};var vo,Lo,Bo,qo,Ho,ns=k(),wo={point:S,lineStart:function(){wo.point=ws},lineEnd:function(){vo&&yo(Lo,Bo),wo.point=S},polygonStart:function(){vo=!0},polygonEnd:function(){vo=null},result:function(){var mt=+ns;return ns.reset(),mt}};function ws(mt,Bt){wo.point=yo,Lo=qo=mt,Bo=Ho=Bt}function yo(mt,Bt){ns.add(T((qo-=mt)*qo+(Ho-=Bt)*Ho)),qo=mt,Ho=Bt}function Yo(){this._string=[]}function ms(mt){return"m0,"+mt+"a"+mt+","+mt+" 0 1,1 0,"+-2*mt+"a"+mt+","+mt+" 0 1,1 0,"+2*mt+"z"}function zo(mt){return function(Bt){var pn=new Gi;for(var Xt in mt)pn[Xt]=mt[Xt];return pn.stream=Bt,pn}}function Gi(){}function qe(mt,Bt,pn){var Xt=mt.clipExtent&&mt.clipExtent();return mt.scale(150).translate([0,0]),null!=Xt&&mt.clipExtent(null),Z(pn,mt.stream(Ta)),Bt(Ta.result()),null!=Xt&&mt.clipExtent(Xt),mt}function We(mt,Bt,pn){return qe(mt,function(Xt){var dn=Bt[1][0]-Bt[0][0],Fn=Bt[1][1]-Bt[0][1],Zn=Math.min(dn/(Xt[1][0]-Xt[0][0]),Fn/(Xt[1][1]-Xt[0][1])),er=+Bt[0][0]+(dn-Zn*(Xt[1][0]+Xt[0][0]))/2,yr=+Bt[0][1]+(Fn-Zn*(Xt[1][1]+Xt[0][1]))/2;mt.scale(150*Zn).translate([er,yr])},pn)}function rt(mt,Bt,pn){return We(mt,[[0,0],Bt],pn)}function ft(mt,Bt,pn){return qe(mt,function(Xt){var dn=+Bt,Fn=dn/(Xt[1][0]-Xt[0][0]),Zn=(dn-Fn*(Xt[1][0]+Xt[0][0]))/2,er=-Fn*Xt[0][1];mt.scale(150*Fn).translate([Zn,er])},pn)}function bt(mt,Bt,pn){return qe(mt,function(Xt){var dn=+Bt,Fn=dn/(Xt[1][1]-Xt[0][1]),Zn=-Fn*Xt[0][0],er=(dn-Fn*(Xt[1][1]+Xt[0][1]))/2;mt.scale(150*Fn).translate([Zn,er])},pn)}Yo.prototype={_radius:4.5,_circle:ms(4.5),pointRadius:function(mt){return(mt=+mt)!==this._radius&&(this._radius=mt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(mt,Bt){switch(this._point){case 0:this._string.push("M",mt,",",Bt),this._point=1;break;case 1:this._string.push("L",mt,",",Bt);break;default:null==this._circle&&(this._circle=ms(this._radius)),this._string.push("M",mt,",",Bt,this._circle)}},result:function(){if(this._string.length){var mt=this._string.join("");return this._string=[],mt}return null}},Gi.prototype={constructor:Gi,point:function(mt,Bt){this.stream.point(mt,Bt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var vt=u(30*f);function Pt(mt,Bt){return+Bt?function(pn,Xt){function dn(Fn,Zn,er,yr,gr,Tr,Ir,xr,Dr,Zr,ei,yi,nr,mi){var Hr=Ir-Fn,Jr=xr-Zn,di=Hr*Hr+Jr*Jr;if(di>4*Xt&&nr--){var Pi=yr+Zr,Vi=gr+ei,Br=Tr+yi,Wi=T(Pi*Pi+Vi*Vi+Br*Br),Ui=P(Br/=Wi),Mi=l(l(Br)-1)<i||l(er-Dr)<i?(er+Dr)/2:d(Vi,Pi),Ji=pn(Mi,Ui),Bi=Ji[0],ua=Ji[1],gi=Bi-Fn,aa=ua-Zn,Qa=Jr*gi-Hr*aa;(Qa*Qa/di>Xt||l((Hr*gi+Jr*aa)/di-.5)>.3||yr*Zr+gr*ei+Tr*yi<vt)&&(dn(Fn,Zn,er,yr,gr,Tr,Bi,ua,Mi,Pi/=Wi,Vi/=Wi,Br,nr,mi),mi.point(Bi,ua),dn(Bi,ua,Mi,Pi,Vi,Br,Ir,xr,Dr,Zr,ei,yi,nr,mi))}}return function(Fn){var Zn,er,yr,gr,Tr,Ir,xr,Dr,Zr,ei,yi,nr,mi={point:Hr,lineStart:Jr,lineEnd:Pi,polygonStart:function(){Fn.polygonStart(),mi.lineStart=Vi},polygonEnd:function(){Fn.polygonEnd(),mi.lineStart=Jr}};function Hr(Ui,Mi){Ui=pn(Ui,Mi),Fn.point(Ui[0],Ui[1])}function Jr(){Dr=NaN,mi.point=di,Fn.lineStart()}function di(Ui,Mi){var Ji=ce([Ui,Mi]),Bi=pn(Ui,Mi);dn(Dr,Zr,xr,ei,yi,nr,Dr=Bi[0],Zr=Bi[1],xr=Ui,ei=Ji[0],yi=Ji[1],nr=Ji[2],16,Fn),Fn.point(Dr,Zr)}function Pi(){mi.point=Hr,Fn.lineEnd()}function Vi(){Jr(),mi.point=Br,mi.lineEnd=Wi}function Br(Ui,Mi){di(Zn=Ui,Mi),er=Dr,yr=Zr,gr=ei,Tr=yi,Ir=nr,mi.point=di}function Wi(){dn(Dr,Zr,xr,ei,yi,nr,er,yr,Zn,gr,Tr,Ir,16,Fn),mi.lineEnd=Pi,Pi()}return mi}}(mt,Bt):(pn=mt,zo({point:function(Xt,dn){Xt=pn(Xt,dn),this.stream.point(Xt[0],Xt[1])}}));var pn}var tn=zo({point:function(mt,Bt){this.stream.point(mt*f,Bt*f)}});function rn(mt,Bt,pn,Xt,dn){function Fn(Zn,er){return[Bt+mt*(Zn*=Xt),pn-mt*(er*=dn)]}return Fn.invert=function(Zn,er){return[(Zn-Bt)/mt*Xt,(pn-er)/mt*dn]},Fn}function Qt(mt,Bt,pn,Xt,dn,Fn){var Zn=u(Fn),er=b(Fn),yr=Zn*mt,gr=er*mt,Tr=Zn/mt,Ir=er/mt,xr=(er*pn-Zn*Bt)/mt,Dr=(er*Bt+Zn*pn)/mt;function Zr(ei,yi){return[yr*(ei*=Xt)-gr*(yi*=dn)+Bt,pn-gr*ei-yr*yi]}return Zr.invert=function(ei,yi){return[Xt*(Tr*ei-Ir*yi+xr),dn*(Dr-Ir*ei-Tr*yi)]},Zr}function un(mt){return xn(function(){return mt})()}function xn(mt){var Bt,pn,Xt,dn,Fn,Zn,er,yr,gr,Tr,Ir=150,xr=480,Dr=250,Zr=0,ei=0,yi=0,nr=0,mi=0,Hr=0,Jr=1,di=1,Pi=null,Vi=cr,Br=null,Wi=Kn,Ui=.5;function Mi(gi){return yr(gi[0]*f,gi[1]*f)}function Ji(gi){return(gi=yr.invert(gi[0],gi[1]))&&[gi[0]*s,gi[1]*s]}function Bi(){var gi=Qt(Ir,0,0,Jr,di,Hr).apply(null,Bt(Zr,ei)),aa=(Hr?Qt:rn)(Ir,xr-gi[0],Dr-gi[1],Jr,di,Hr);return pn=Ht(yi,nr,mi),er=dt(Bt,aa),yr=dt(pn,er),Zn=Pt(er,Ui),ua()}function ua(){return gr=Tr=null,Mi}return Mi.stream=function(gi){return gr&&Tr===gi?gr:gr=tn((aa=pn,zo({point:function(Qa,Jo){var jo=aa(Qa,Jo);return this.stream.point(jo[0],jo[1])}}))(Vi(Zn(Wi(Tr=gi)))));var aa},Mi.preclip=function(gi){return arguments.length?(Vi=gi,Pi=void 0,ua()):Vi},Mi.postclip=function(gi){return arguments.length?(Wi=gi,Br=Xt=dn=Fn=null,ua()):Wi},Mi.clipAngle=function(gi){return arguments.length?(Vi=+gi?Sr(Pi=gi*f):(Pi=null,cr),ua()):Pi*s},Mi.clipExtent=function(gi){return arguments.length?(Wi=null==gi?(Br=Xt=dn=Fn=null,Kn):Cr(Br=+gi[0][0],Xt=+gi[0][1],dn=+gi[1][0],Fn=+gi[1][1]),ua()):null==Br?null:[[Br,Xt],[dn,Fn]]},Mi.scale=function(gi){return arguments.length?(Ir=+gi,Bi()):Ir},Mi.translate=function(gi){return arguments.length?(xr=+gi[0],Dr=+gi[1],Bi()):[xr,Dr]},Mi.center=function(gi){return arguments.length?(Zr=gi[0]%360*f,ei=gi[1]%360*f,Bi()):[Zr*s,ei*s]},Mi.rotate=function(gi){return arguments.length?(yi=gi[0]%360*f,nr=gi[1]%360*f,mi=gi.length>2?gi[2]%360*f:0,Bi()):[yi*s,nr*s,mi*s]},Mi.angle=function(gi){return arguments.length?(Hr=gi%360*f,Bi()):Hr*s},Mi.reflectX=function(gi){return arguments.length?(Jr=gi?-1:1,Bi()):Jr<0},Mi.reflectY=function(gi){return arguments.length?(di=gi?-1:1,Bi()):di<0},Mi.precision=function(gi){return arguments.length?(Zn=Pt(er,Ui=gi*gi),ua()):T(Ui)},Mi.fitExtent=function(gi,aa){return We(Mi,gi,aa)},Mi.fitSize=function(gi,aa){return rt(Mi,gi,aa)},Mi.fitWidth=function(gi,aa){return ft(Mi,gi,aa)},Mi.fitHeight=function(gi,aa){return bt(Mi,gi,aa)},function(){return Bt=mt.apply(this,arguments),Mi.invert=Bt.invert&&Ji,Bi()}}function Sn(mt){var Bt=0,pn=c/3,Xt=xn(mt),dn=Xt(Bt,pn);return dn.parallels=function(Fn){return arguments.length?Xt(Bt=Fn[0]*f,pn=Fn[1]*f):[Bt*s,pn*s]},dn}function Cn(mt,Bt){var pn=b(mt),Xt=(pn+b(Bt))/2;if(l(Xt)<i)return function(er){var yr=u(er);function gr(Tr,Ir){return[Tr*yr,b(Ir)/yr]}return gr.invert=function(Tr,Ir){return[Tr/yr,P(Ir*yr)]},gr}(mt);var dn=1+pn*(2*Xt-pn),Fn=T(dn)/Xt;function Zn(er,yr){var gr=T(dn-2*Xt*b(yr))/Xt;return[gr*b(er*=Xt),Fn-gr*u(er)]}return Zn.invert=function(er,yr){var gr=Fn-yr,Tr=d(er,l(gr))*w(gr);return gr*Xt<0&&(Tr-=c*w(er)*w(gr)),[Tr/Xt,P((dn-(er*er+gr*gr)*Xt*Xt)/(2*Xt))]},Zn}function Vn(){return Sn(Cn).scale(155.424).center([0,33.6442])}function mr(){return Vn().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function wr(mt){return function(Bt,pn){var Xt=u(Bt),dn=u(pn),Fn=mt(Xt*dn);return[Fn*dn*b(Bt),Fn*b(pn)]}}function qr(mt){return function(Bt,pn){var Xt=T(Bt*Bt+pn*pn),dn=mt(Xt),Fn=b(dn),Zn=u(dn);return[d(Bt*Fn,Xt*Zn),P(Xt&&pn*Fn/Xt)]}}var Gr=wr(function(mt){return T(2/(1+mt))});Gr.invert=qr(function(mt){return 2*P(mt/2)});var ni=wr(function(mt){return(mt=M(mt))&&mt/b(mt)});function Xr(mt,Bt){return[mt,h(L((n+Bt)/2))]}function Si(mt){var Bt,pn,Xt,dn=un(mt),Fn=dn.center,Zn=dn.scale,er=dn.translate,yr=dn.clipExtent,gr=null;function Tr(){var Ir=c*Zn(),xr=dn(zn(dn.rotate()).invert([0,0]));return yr(null==gr?[[xr[0]-Ir,xr[1]-Ir],[xr[0]+Ir,xr[1]+Ir]]:mt===Xr?[[Math.max(xr[0]-Ir,gr),Bt],[Math.min(xr[0]+Ir,pn),Xt]]:[[gr,Math.max(xr[1]-Ir,Bt)],[pn,Math.min(xr[1]+Ir,Xt)]])}return dn.scale=function(Ir){return arguments.length?(Zn(Ir),Tr()):Zn()},dn.translate=function(Ir){return arguments.length?(er(Ir),Tr()):er()},dn.center=function(Ir){return arguments.length?(Fn(Ir),Tr()):Fn()},dn.clipExtent=function(Ir){return arguments.length?(null==Ir?gr=Bt=pn=Xt=null:(gr=+Ir[0][0],Bt=+Ir[0][1],pn=+Ir[1][0],Xt=+Ir[1][1]),Tr()):null==gr?null:[[gr,Bt],[pn,Xt]]},Tr()}function Ni(mt){return L((n+mt)/2)}function $i(mt,Bt){var pn=u(mt),Xt=mt===Bt?b(mt):h(pn/u(Bt))/h(Ni(Bt)/Ni(mt)),dn=pn*_(Ni(mt),Xt)/Xt;if(!Xt)return Xr;function Fn(Zn,er){dn>0?er<-n+i&&(er=-n+i):er>n-i&&(er=n-i);var yr=dn/_(Ni(er),Xt);return[yr*b(Xt*Zn),dn-yr*u(Xt*Zn)]}return Fn.invert=function(Zn,er){var yr=dn-er,gr=w(Xt)*T(Zn*Zn+yr*yr),Tr=d(Zn,l(yr))*w(yr);return yr*Xt<0&&(Tr-=c*w(Zn)*w(yr)),[Tr/Xt,2*o(_(dn/gr,1/Xt))-n]},Fn}function Qi(mt,Bt){return[mt,Bt]}function ea(mt,Bt){var pn=u(mt),Xt=mt===Bt?b(mt):(pn-u(Bt))/(Bt-mt),dn=pn/Xt+mt;if(l(Xt)<i)return Qi;function Fn(Zn,er){var yr=dn-er,gr=Xt*Zn;return[yr*b(gr),dn-yr*u(gr)]}return Fn.invert=function(Zn,er){var yr=dn-er,gr=d(Zn,l(yr))*w(yr);return yr*Xt<0&&(gr-=c*w(Zn)*w(yr)),[gr/Xt,dn-w(Xt)*T(Zn*Zn+yr*yr)]},Fn}ni.invert=qr(function(mt){return mt}),Xr.invert=function(mt,Bt){return[mt,2*o(y(Bt))-n]},Qi.invert=Qi;var za=1.340264,Ma=-.081106,ga=893e-6,va=.003796,Sa=T(3)/2;function Ja(mt,Bt){var pn=P(Sa*b(Bt)),Xt=pn*pn,dn=Xt*Xt*Xt;return[mt*u(pn)/(Sa*(za+3*Ma*Xt+dn*(7*ga+9*va*Xt))),pn*(za+Ma*Xt+dn*(ga+va*Xt))]}function lo(mt,Bt){var pn=u(Bt),Xt=u(mt)*pn;return[pn*b(mt)/Xt,b(Bt)/Xt]}function co(mt,Bt){var pn=Bt*Bt,Xt=pn*pn;return[mt*(.8707-.131979*pn+Xt*(Xt*(.003971*pn-.001529*Xt)-.013791)),Bt*(1.007226+pn*(.015085+Xt*(.028874*pn-.044475-.005916*Xt)))]}function uo(mt,Bt){return[u(Bt)*b(mt),b(Bt)]}function fo(mt,Bt){var pn=u(Bt),Xt=1+u(mt)*pn;return[pn*b(mt)/Xt,b(Bt)/Xt]}function Xi(mt,Bt){return[h(L((n+Bt)/2)),-mt]}Ja.invert=function(mt,Bt){for(var pn,Xt=Bt,dn=Xt*Xt,Fn=dn*dn*dn,Zn=0;Zn<12&&(Fn=(dn=(Xt-=pn=(Xt*(za+Ma*dn+Fn*(ga+va*dn))-Bt)/(za+3*Ma*dn+Fn*(7*ga+9*va*dn)))*Xt)*dn*dn,!(l(pn)<1e-12));++Zn);return[Sa*mt*(za+3*Ma*dn+Fn*(7*ga+9*va*dn))/u(Xt),P(b(Xt)/Sa)]},lo.invert=qr(o),co.invert=function(mt,Bt){var pn,Xt=Bt,dn=25;do{var Fn=Xt*Xt,Zn=Fn*Fn;Xt-=pn=(Xt*(1.007226+Fn*(.015085+Zn*(.028874*Fn-.044475-.005916*Zn)))-Bt)/(1.007226+Fn*(.045255+Zn*(.259866*Fn-.311325-.005916*11*Zn)))}while(l(pn)>i&&--dn>0);return[mt/(.8707+(Fn=Xt*Xt)*(Fn*(Fn*Fn*Fn*(.003971-.001529*Fn)-.013791)-.131979)),Xt]},uo.invert=qr(P),fo.invert=qr(function(mt){return 2*o(mt)}),Xi.invert=function(mt,Bt){return[-Bt,2*o(y(mt))-n]},g.geoAlbers=mr,g.geoAlbersUsa=function(){var mt,Bt,pn,Xt,dn,Fn,Zn=mr(),er=Vn().rotate([154,0]).center([-2,58.5]).parallels([55,65]),yr=Vn().rotate([157,0]).center([-3,19.9]).parallels([8,18]),gr={point:function(xr,Dr){Fn=[xr,Dr]}};function Tr(xr){var Dr=xr[0],Zr=xr[1];return Fn=null,pn.point(Dr,Zr),Fn||(Xt.point(Dr,Zr),Fn)||(dn.point(Dr,Zr),Fn)}function Ir(){return mt=Bt=null,Tr}return Tr.invert=function(xr){var Dr=Zn.scale(),Zr=Zn.translate(),ei=(xr[0]-Zr[0])/Dr,yi=(xr[1]-Zr[1])/Dr;return(yi>=.12&&yi<.234&&ei>=-.425&&ei<-.214?er:yi>=.166&&yi<.234&&ei>=-.214&&ei<-.115?yr:Zn).invert(xr)},Tr.stream=function(xr){return mt&&Bt===xr?mt:(Dr=[Zn.stream(Bt=xr),er.stream(xr),yr.stream(xr)],Zr=Dr.length,mt={point:function(ei,yi){for(var nr=-1;++nr<Zr;)Dr[nr].point(ei,yi)},sphere:function(){for(var ei=-1;++ei<Zr;)Dr[ei].sphere()},lineStart:function(){for(var ei=-1;++ei<Zr;)Dr[ei].lineStart()},lineEnd:function(){for(var ei=-1;++ei<Zr;)Dr[ei].lineEnd()},polygonStart:function(){for(var ei=-1;++ei<Zr;)Dr[ei].polygonStart()},polygonEnd:function(){for(var ei=-1;++ei<Zr;)Dr[ei].polygonEnd()}});var Dr,Zr},Tr.precision=function(xr){return arguments.length?(Zn.precision(xr),er.precision(xr),yr.precision(xr),Ir()):Zn.precision()},Tr.scale=function(xr){return arguments.length?(Zn.scale(xr),er.scale(.35*xr),yr.scale(xr),Tr.translate(Zn.translate())):Zn.scale()},Tr.translate=function(xr){if(!arguments.length)return Zn.translate();var Dr=Zn.scale(),Zr=+xr[0],ei=+xr[1];return pn=Zn.translate(xr).clipExtent([[Zr-.455*Dr,ei-.238*Dr],[Zr+.455*Dr,ei+.238*Dr]]).stream(gr),Xt=er.translate([Zr-.307*Dr,ei+.201*Dr]).clipExtent([[Zr-.425*Dr+i,ei+.12*Dr+i],[Zr-.214*Dr-i,ei+.234*Dr-i]]).stream(gr),dn=yr.translate([Zr-.205*Dr,ei+.212*Dr]).clipExtent([[Zr-.214*Dr+i,ei+.166*Dr+i],[Zr-.115*Dr-i,ei+.234*Dr-i]]).stream(gr),Ir()},Tr.fitExtent=function(xr,Dr){return We(Tr,xr,Dr)},Tr.fitSize=function(xr,Dr){return rt(Tr,xr,Dr)},Tr.fitWidth=function(xr,Dr){return ft(Tr,xr,Dr)},Tr.fitHeight=function(xr,Dr){return bt(Tr,xr,Dr)},Tr.scale(1070)},g.geoArea=function(mt){return U.reset(),Z(mt,ee),2*U},g.geoAzimuthalEqualArea=function(){return un(Gr).scale(124.75).clipAngle(179.999)},g.geoAzimuthalEqualAreaRaw=Gr,g.geoAzimuthalEquidistant=function(){return un(ni).scale(79.4188).clipAngle(179.999)},g.geoAzimuthalEquidistantRaw=ni,g.geoBounds=function(mt){var Bt,pn,Xt,dn,Fn,Zn,er;if(se=Te=-(pe=ge=1/0),De=[],Z(mt,Jt),pn=De.length){for(De.sort(Ke),Bt=1,Fn=[Xt=De[0]];Bt<pn;++Bt)Ze(Xt,(dn=De[Bt])[0])||Ze(Xt,dn[1])?(He(Xt[0],dn[1])>He(Xt[0],Xt[1])&&(Xt[1]=dn[1]),He(dn[0],Xt[1])>He(Xt[0],Xt[1])&&(Xt[0]=dn[0])):Fn.push(Xt=dn);for(Zn=-1/0,Bt=0,Xt=Fn[pn=Fn.length-1];Bt<=pn;Xt=dn,++Bt)(er=He(Xt[1],(dn=Fn[Bt])[0]))>Zn&&(Zn=er,pe=dn[0],Te=Xt[1])}return De=Oe=null,pe===1/0||ge===1/0?[[NaN,NaN],[NaN,NaN]]:[[pe,ge],[Te,se]]},g.geoCentroid=function(mt){Ie=Qe=Ne=Pe=Re=Ge=tt=ct=wt=kt=gt=0,Z(mt,ut);var Bt=wt,pn=kt,Xt=gt,dn=Bt*Bt+pn*pn+Xt*Xt;return dn<1e-12&&(Bt=Ge,pn=tt,Xt=ct,Qe<i&&(Bt=Ne,pn=Pe,Xt=Re),(dn=Bt*Bt+pn*pn+Xt*Xt)<1e-12)?[NaN,NaN]:[d(pn,Bt)*s,P(Xt/T(dn))*s]},g.geoCircle=function(){var mt,Bt,pn=st([0,0]),Xt=st(90),dn=st(6),Fn={point:function(er,yr){mt.push(er=Bt(er,yr)),er[0]*=s,er[1]*=s}};function Zn(){var er=pn.apply(this,arguments),yr=Xt.apply(this,arguments)*f,gr=dn.apply(this,arguments)*f;return mt=[],Bt=Ht(-er[0]*f,-er[1]*f,0).invert,gn(Fn,yr,gr,1),er={type:"Polygon",coordinates:[mt]},mt=Bt=null,er}return Zn.center=function(er){return arguments.length?(pn="function"==typeof er?er:st([+er[0],+er[1]]),Zn):pn},Zn.radius=function(er){return arguments.length?(Xt="function"==typeof er?er:st(+er),Zn):Xt},Zn.precision=function(er){return arguments.length?(dn="function"==typeof er?er:st(+er),Zn):dn},Zn},g.geoClipAntimeridian=cr,g.geoClipCircle=Sr,g.geoClipExtent=function(){var mt,Bt,pn,Xt=0,dn=0,Fn=960,Zn=500;return pn={stream:function(er){return mt&&Bt===er?mt:mt=Cr(Xt,dn,Fn,Zn)(Bt=er)},extent:function(er){return arguments.length?(Xt=+er[0][0],dn=+er[0][1],Fn=+er[1][0],Zn=+er[1][1],mt=Bt=null,pn):[[Xt,dn],[Fn,Zn]]}}},g.geoClipRectangle=Cr,g.geoConicConformal=function(){return Sn($i).scale(109.5).parallels([30,30])},g.geoConicConformalRaw=$i,g.geoConicEqualArea=Vn,g.geoConicEqualAreaRaw=Cn,g.geoConicEquidistant=function(){return Sn(ea).scale(131.154).center([0,13.9389])},g.geoConicEquidistantRaw=ea,g.geoContains=function(mt,Bt){return(mt&&It.hasOwnProperty(mt.type)?It[mt.type]:yn)(mt,Bt)},g.geoDistance=wn,g.geoEqualEarth=function(){return un(Ja).scale(177.158)},g.geoEqualEarthRaw=Ja,g.geoEquirectangular=function(){return un(Qi).scale(152.63)},g.geoEquirectangularRaw=Qi,g.geoGnomonic=function(){return un(lo).scale(144.049).clipAngle(60)},g.geoGnomonicRaw=lo,g.geoGraticule=Dn,g.geoGraticule10=function(){return Dn()()},g.geoIdentity=function(){var mt,Bt,pn,Xt,dn,Fn,Zn,er=1,yr=0,gr=0,Tr=1,Ir=1,xr=0,Dr=null,Zr=1,ei=1,yi=zo({point:function(Jr,di){var Pi=Hr([Jr,di]);this.stream.point(Pi[0],Pi[1])}}),nr=Kn;function mi(){return Zr=er*Tr,ei=er*Ir,Fn=Zn=null,Hr}function Hr(Jr){var di=Jr[0]*Zr,Pi=Jr[1]*ei;if(xr){var Vi=Pi*mt-di*Bt;di=di*mt+Pi*Bt,Pi=Vi}return[di+yr,Pi+gr]}return Hr.invert=function(Jr){var di=Jr[0]-yr,Pi=Jr[1]-gr;if(xr){var Vi=Pi*mt+di*Bt;di=di*mt-Pi*Bt,Pi=Vi}return[di/Zr,Pi/ei]},Hr.stream=function(Jr){return Fn&&Zn===Jr?Fn:Fn=yi(nr(Zn=Jr))},Hr.postclip=function(Jr){return arguments.length?(nr=Jr,Dr=pn=Xt=dn=null,mi()):nr},Hr.clipExtent=function(Jr){return arguments.length?(nr=null==Jr?(Dr=pn=Xt=dn=null,Kn):Cr(Dr=+Jr[0][0],pn=+Jr[0][1],Xt=+Jr[1][0],dn=+Jr[1][1]),mi()):null==Dr?null:[[Dr,pn],[Xt,dn]]},Hr.scale=function(Jr){return arguments.length?(er=+Jr,mi()):er},Hr.translate=function(Jr){return arguments.length?(yr=+Jr[0],gr=+Jr[1],mi()):[yr,gr]},Hr.angle=function(Jr){return arguments.length?(Bt=b(xr=Jr%360*f),mt=u(xr),mi()):xr*s},Hr.reflectX=function(Jr){return arguments.length?(Tr=Jr?-1:1,mi()):Tr<0},Hr.reflectY=function(Jr){return arguments.length?(Ir=Jr?-1:1,mi()):Ir<0},Hr.fitExtent=function(Jr,di){return We(Hr,Jr,di)},Hr.fitSize=function(Jr,di){return rt(Hr,Jr,di)},Hr.fitWidth=function(Jr,di){return ft(Hr,Jr,di)},Hr.fitHeight=function(Jr,di){return bt(Hr,Jr,di)},Hr},g.geoInterpolate=function(mt,Bt){var pn=mt[0]*f,Xt=mt[1]*f,dn=Bt[0]*f,Fn=Bt[1]*f,Zn=u(Xt),er=b(Xt),yr=u(Fn),gr=b(Fn),Tr=Zn*u(pn),Ir=Zn*b(pn),xr=yr*u(dn),Dr=yr*b(dn),Zr=2*P(T(z(Fn-Xt)+Zn*yr*z(dn-pn))),ei=b(Zr),yi=Zr?function(nr){var mi=b(nr*=Zr)/ei,Hr=b(Zr-nr)/ei,Jr=Hr*Tr+mi*xr,di=Hr*Ir+mi*Dr,Pi=Hr*er+mi*gr;return[d(di,Jr)*s,d(Pi,T(Jr*Jr+di*di))*s]}:function(){return[pn*s,Xt*s]};return yi.distance=Zr,yi},g.geoLength=jr,g.geoMercator=function(){return Si(Xr).scale(961/p)},g.geoMercatorRaw=Xr,g.geoNaturalEarth1=function(){return un(co).scale(175.295)},g.geoNaturalEarth1Raw=co,g.geoOrthographic=function(){return un(uo).scale(249.5).clipAngle(90+i)},g.geoOrthographicRaw=uo,g.geoPath=function(mt,Bt){var pn,Xt,dn=4.5;function Fn(Zn){return Zn&&("function"==typeof dn&&Xt.pointRadius(+dn.apply(this,arguments)),Z(Zn,pn(Xt))),Xt.result()}return Fn.area=function(Zn){return Z(Zn,pn(Ur)),Ur.result()},Fn.measure=function(Zn){return Z(Zn,pn(wo)),wo.result()},Fn.bounds=function(Zn){return Z(Zn,pn(Ta)),Ta.result()},Fn.centroid=function(Zn){return Z(Zn,pn(xa)),xa.result()},Fn.projection=function(Zn){return arguments.length?(pn=null==Zn?(mt=null,Kn):(mt=Zn).stream,Fn):mt},Fn.context=function(Zn){return arguments.length?(Xt=null==Zn?(Bt=null,new Yo):new Ss(Bt=Zn),"function"!=typeof dn&&Xt.pointRadius(dn),Fn):Bt},Fn.pointRadius=function(Zn){return arguments.length?(dn="function"==typeof Zn?Zn:(Xt.pointRadius(+Zn),+Zn),Fn):dn},Fn.projection(mt).context(Bt)},g.geoProjection=un,g.geoProjectionMutator=xn,g.geoRotation=zn,g.geoStereographic=function(){return un(fo).scale(250).clipAngle(142)},g.geoStereographicRaw=fo,g.geoStream=Z,g.geoTransform=function(mt){return{stream:zo(mt)}},g.geoTransverseMercator=function(){var mt=Si(Xi),Bt=mt.center,pn=mt.rotate;return mt.center=function(Xt){return arguments.length?Bt([-Xt[1],Xt[0]]):[(Xt=Bt())[1],-Xt[0]]},mt.rotate=function(Xt){return arguments.length?pn([Xt[0],Xt[1],Xt.length>2?Xt[2]+90:90]):[(Xt=pn())[0],Xt[1],Xt[2]-90]},pn([0,0,90]).scale(159.155)},g.geoTransverseMercatorRaw=Xi,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-array")):t((g=g||self).d3=g.d3||{},g.d3)},{"d3-array":107}],115:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";function t(oe,ve){return oe.parent===ve.parent?1:2}function k(oe,ve){return oe+ve.x}function x(oe,ve){return Math.max(oe,ve.y)}function e(oe){var ve=0,fe=oe.children,xe=fe&&fe.length;if(xe)for(;--xe>=0;)ve+=fe[xe].value;else ve=1;oe.value=ve}function r(oe,ve){var fe,xe,Se,pe,ge,Te=new m(oe),se=+oe.value&&(Te.value=oe.value),de=[Te];for(null==ve&&(ve=i);fe=de.pop();)if(se&&(fe.value=+fe.data.value),(Se=ve(fe.data))&&(ge=Se.length))for(fe.children=new Array(ge),pe=ge-1;pe>=0;--pe)de.push(xe=fe.children[pe]=new m(Se[pe])),xe.parent=fe,xe.depth=fe.depth+1;return Te.eachBefore(n)}function i(oe){return oe.children}function c(oe){oe.data=oe.data.data}function n(oe){var ve=0;do{oe.height=ve}while((oe=oe.parent)&&oe.height<++ve)}function m(oe){this.data=oe,this.depth=this.height=0,this.parent=null}m.prototype=r.prototype={constructor:m,count:function(){return this.eachAfter(e)},each:function(oe){var ve,fe,xe,Se,pe=this,ge=[pe];do{for(ve=ge.reverse(),ge=[];pe=ve.pop();)if(oe(pe),fe=pe.children)for(xe=0,Se=fe.length;xe<Se;++xe)ge.push(fe[xe])}while(ge.length);return this},eachAfter:function(oe){for(var ve,fe,xe,Se=this,pe=[Se],ge=[];Se=pe.pop();)if(ge.push(Se),ve=Se.children)for(fe=0,xe=ve.length;fe<xe;++fe)pe.push(ve[fe]);for(;Se=ge.pop();)oe(Se);return this},eachBefore:function(oe){for(var ve,fe,xe=this,Se=[xe];xe=Se.pop();)if(oe(xe),ve=xe.children)for(fe=ve.length-1;fe>=0;--fe)Se.push(ve[fe]);return this},sum:function(oe){return this.eachAfter(function(ve){for(var fe=+oe(ve.data)||0,xe=ve.children,Se=xe&&xe.length;--Se>=0;)fe+=xe[Se].value;ve.value=fe})},sort:function(oe){return this.eachBefore(function(ve){ve.children&&ve.children.sort(oe)})},path:function(oe){for(var ve=this,fe=function(pe,ge){if(pe===ge)return pe;var Te=pe.ancestors(),se=ge.ancestors(),de=null;for(pe=Te.pop(),ge=se.pop();pe===ge;)de=pe,pe=Te.pop(),ge=se.pop();return de}(ve,oe),xe=[ve];ve!==fe;)xe.push(ve=ve.parent);for(var Se=xe.length;oe!==fe;)xe.splice(Se,0,oe),oe=oe.parent;return xe},ancestors:function(){for(var oe=this,ve=[oe];oe=oe.parent;)ve.push(oe);return ve},descendants:function(){var oe=[];return this.each(function(ve){oe.push(ve)}),oe},leaves:function(){var oe=[];return this.eachBefore(function(ve){ve.children||oe.push(ve)}),oe},links:function(){var oe=this,ve=[];return oe.each(function(fe){fe!==oe&&ve.push({source:fe.parent,target:fe})}),ve},copy:function(){return r(this).eachBefore(c)}};var p=Array.prototype.slice;function s(oe){for(var ve,fe,xe=0,Se=(oe=function(ge){for(var Te,se,de=ge.length;de;)se=Math.random()*de--|0,Te=ge[de],ge[de]=ge[se],ge[se]=Te;return ge}(p.call(oe))).length,pe=[];xe<Se;)ve=oe[xe],fe&&o(fe,ve)?++xe:(fe=u(pe=f(pe,ve)),xe=0);return fe}function f(oe,ve){var fe,xe;if(d(ve,oe))return[ve];for(fe=0;fe<oe.length;++fe)if(l(ve,oe[fe])&&d(a(oe[fe],ve),oe))return[oe[fe],ve];for(fe=0;fe<oe.length-1;++fe)for(xe=fe+1;xe<oe.length;++xe)if(l(a(oe[fe],oe[xe]),ve)&&l(a(oe[fe],ve),oe[xe])&&l(a(oe[xe],ve),oe[fe])&&d(y(oe[fe],oe[xe],ve),oe))return[oe[fe],oe[xe],ve];throw new Error}function l(oe,ve){var fe=oe.r-ve.r,xe=ve.x-oe.x,Se=ve.y-oe.y;return fe<0||fe*fe<xe*xe+Se*Se}function o(oe,ve){var fe=oe.r-ve.r+1e-6,xe=ve.x-oe.x,Se=ve.y-oe.y;return fe>0&&fe*fe>xe*xe+Se*Se}function d(oe,ve){for(var fe=0;fe<ve.length;++fe)if(!o(oe,ve[fe]))return!1;return!0}function u(oe){switch(oe.length){case 1:return{x:(ve=oe[0]).x,y:ve.y,r:ve.r};case 2:return a(oe[0],oe[1]);case 3:return y(oe[0],oe[1],oe[2])}var ve}function a(oe,ve){var fe=oe.x,xe=oe.y,Se=oe.r,pe=ve.x,ge=ve.y,Te=ve.r,se=pe-fe,de=ge-xe,Ae=Te-Se,Le=Math.sqrt(se*se+de*de);return{x:(fe+pe+se/Le*Ae)/2,y:(xe+ge+de/Le*Ae)/2,r:(Le+Se+Te)/2}}function y(oe,ve,fe){var xe=oe.x,Se=oe.y,pe=oe.r,ge=ve.x,Te=ve.y,se=ve.r,de=fe.x,Ae=fe.y,Le=fe.r,Me=xe-ge,De=xe-de,Oe=Se-Te,Ie=Se-Ae,Qe=se-pe,Ne=Le-pe,Pe=xe*xe+Se*Se-pe*pe,Re=Pe-ge*ge-Te*Te+se*se,Ge=Pe-de*de-Ae*Ae+Le*Le,tt=De*Oe-Me*Ie,ct=(Oe*Ge-Ie*Re)/(2*tt)-xe,wt=(Ie*Qe-Oe*Ne)/tt,kt=(De*Re-Me*Ge)/(2*tt)-Se,gt=(Me*Ne-De*Qe)/tt,at=wt*wt+gt*gt-1,et=2*(pe+ct*wt+kt*gt),yt=ct*ct+kt*kt-pe*pe,Vt=-(at?(et+Math.sqrt(et*et-4*at*yt))/(2*at):yt/et);return{x:xe+ct+wt*Vt,y:Se+kt+gt*Vt,r:Vt}}function h(oe,ve,fe){var xe,Se,pe,ge,Te=oe.x-ve.x,se=oe.y-ve.y,de=Te*Te+se*se;de?(Se=ve.r+fe.r,ge=oe.r+fe.r,(Se*=Se)>(ge*=ge)?(xe=(de+ge-Se)/(2*de),pe=Math.sqrt(Math.max(0,ge/de-xe*xe)),fe.x=oe.x-xe*Te-pe*se,fe.y=oe.y-xe*se+pe*Te):(xe=(de+Se-ge)/(2*de),pe=Math.sqrt(Math.max(0,Se/de-xe*xe)),fe.x=ve.x+xe*Te-pe*se,fe.y=ve.y+xe*se+pe*Te)):(fe.x=ve.x+fe.r,fe.y=ve.y)}function _(oe,ve){var fe=oe.r+ve.r-1e-6,xe=ve.x-oe.x,Se=ve.y-oe.y;return fe>0&&fe*fe>xe*xe+Se*Se}function b(oe){var ve=oe._,fe=oe.next._,xe=ve.r+fe.r,Se=(ve.x*fe.r+fe.x*ve.r)/xe,pe=(ve.y*fe.r+fe.y*ve.r)/xe;return Se*Se+pe*pe}function w(oe){this._=oe,this.next=null,this.previous=null}function T(oe){if(!(Se=oe.length))return 0;var ve,fe,xe,Se,pe,ge,Te,se,de,Ae,Le;if((ve=oe[0]).x=0,ve.y=0,!(Se>1))return ve.r;if(ve.x=-(fe=oe[1]).r,fe.x=ve.r,fe.y=0,!(Se>2))return ve.r+fe.r;h(fe,ve,xe=oe[2]),ve=new w(ve),fe=new w(fe),xe=new w(xe),ve.next=xe.previous=fe,fe.next=ve.previous=xe,xe.next=fe.previous=ve;e:for(Te=3;Te<Se;++Te){h(ve._,fe._,xe=oe[Te]),xe=new w(xe),se=fe.next,de=ve.previous,Ae=fe._.r,Le=ve._.r;do{if(Ae<=Le){if(_(se._,xe._)){ve.next=fe=se,fe.previous=ve,--Te;continue e}Ae+=se._.r,se=se.next}else{if(_(de._,xe._)){(ve=de).next=fe,fe.previous=ve,--Te;continue e}Le+=de._.r,de=de.previous}}while(se!==de.next);for(xe.previous=ve,xe.next=fe,ve.next=fe.previous=fe=xe,pe=b(ve);(xe=xe.next)!==fe;)(ge=b(xe))<pe&&(ve=xe,pe=ge);fe=ve.next}for(ve=[fe._],xe=fe;(xe=xe.next)!==fe;)ve.push(xe._);for(xe=s(ve),Te=0;Te<Se;++Te)(ve=oe[Te]).x-=xe.x,ve.y-=xe.y;return xe.r}function L(oe){return null==oe?null:M(oe)}function M(oe){if("function"!=typeof oe)throw new Error;return oe}function P(){return 0}function z(oe){return function(){return oe}}function S(oe){return Math.sqrt(oe.value)}function C(oe){return function(ve){ve.children||(ve.r=Math.max(0,+oe(ve)||0))}}function R(oe,ve){return function(fe){if(xe=fe.children){var xe,Se,pe,ge=xe.length,Te=oe(fe)*ve||0;if(Te)for(Se=0;Se<ge;++Se)xe[Se].r+=Te;if(pe=T(xe),Te)for(Se=0;Se<ge;++Se)xe[Se].r-=Te;fe.r=pe+Te}}}function D(oe){return function(ve){var fe=ve.parent;ve.r*=oe,fe&&(ve.x=fe.x+oe*ve.x,ve.y=fe.y+oe*ve.y)}}function j(oe){oe.x0=Math.round(oe.x0),oe.y0=Math.round(oe.y0),oe.x1=Math.round(oe.x1),oe.y1=Math.round(oe.y1)}function q(oe,ve,fe,xe,Se){for(var pe,ge=oe.children,Te=-1,se=ge.length,de=oe.value&&(xe-ve)/oe.value;++Te<se;)(pe=ge[Te]).y0=fe,pe.y1=Se,pe.x0=ve,pe.x1=ve+=pe.value*de}var Z={depth:-1},W={};function G(oe){return oe.id}function X(oe){return oe.parentId}function ne(oe,ve){return oe.parent===ve.parent?1:2}function V(oe){var ve=oe.children;return ve?ve[0]:oe.t}function N(oe){var ve=oe.children;return ve?ve[ve.length-1]:oe.t}function U(oe,ve,fe){var xe=fe/(ve.i-oe.i);ve.c-=xe,ve.s+=fe,oe.c+=xe,ve.z+=fe,ve.m+=fe}function ee(oe,ve,fe){return oe.a.parent===ve.parent?oe.a:fe}function B(oe,ve){this._=oe,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=ve}function K(oe,ve,fe,xe,Se){for(var pe,ge=oe.children,Te=-1,se=ge.length,de=oe.value&&(Se-fe)/oe.value;++Te<se;)(pe=ge[Te]).x0=ve,pe.x1=xe,pe.y0=fe,pe.y1=fe+=pe.value*de}B.prototype=Object.create(m.prototype);var J=(1+Math.sqrt(5))/2;function te(oe,ve,fe,xe,Se,pe){for(var ge,Te,se,de,Ae,Le,Me,De,Oe,Ie,Qe,Ne=[],Pe=ve.children,Re=0,Ge=0,tt=Pe.length,ct=ve.value;Re<tt;){se=Se-fe,de=pe-xe;do{Ae=Pe[Ge++].value}while(!Ae&&Ge<tt);for(Le=Me=Ae,Qe=Ae*Ae*(Ie=Math.max(de/se,se/de)/(ct*oe)),Oe=Math.max(Me/Qe,Qe/Le);Ge<tt;++Ge){if(Ae+=Te=Pe[Ge].value,Te<Le&&(Le=Te),Te>Me&&(Me=Te),Qe=Ae*Ae*Ie,(De=Math.max(Me/Qe,Qe/Le))>Oe){Ae-=Te;break}Oe=De}Ne.push(ge={value:Ae,dice:se<de,children:Pe.slice(Re,Ge)}),ge.dice?q(ge,fe,xe,Se,ct?xe+=de*Ae/ct:pe):K(ge,fe,xe,ct?fe+=se*Ae/ct:Se,pe),ct-=Ae,Re=Ge}return Ne}var ae=function oe(ve){function fe(xe,Se,pe,ge,Te){te(ve,xe,Se,pe,ge,Te)}return fe.ratio=function(xe){return oe((xe=+xe)>1?xe:1)},fe}(J),ce=function oe(ve){function fe(xe,Se,pe,ge,Te){if((se=xe._squarify)&&se.ratio===ve)for(var se,de,Ae,Le,Me,De=-1,Oe=se.length,Ie=xe.value;++De<Oe;){for(Ae=(de=se[De]).children,Le=de.value=0,Me=Ae.length;Le<Me;++Le)de.value+=Ae[Le].value;de.dice?q(de,Se,pe,ge,pe+=(Te-pe)*de.value/Ie):K(de,Se,pe,Se+=(ge-Se)*de.value/Ie,Te),Ie-=de.value}else xe._squarify=se=te(ve,xe,Se,pe,ge,Te),se.ratio=ve}return fe.ratio=function(xe){return oe((xe=+xe)>1?xe:1)},fe}(J);g.cluster=function(){var oe=t,ve=1,fe=1,xe=!1;function Se(pe){var ge,Te=0;pe.eachAfter(function(Me){var Oe,De=Me.children;De?(Me.x=(Oe=De).reduce(k,0)/Oe.length,Me.y=function(Oe){return 1+Oe.reduce(x,0)}(De)):(Me.x=ge?Te+=oe(Me,ge):0,Me.y=0,ge=Me)});var se=function(Me){for(var De;De=Me.children;)Me=De[0];return Me}(pe),de=function(Me){for(var De;De=Me.children;)Me=De[De.length-1];return Me}(pe),Ae=se.x-oe(se,de)/2,Le=de.x+oe(de,se)/2;return pe.eachAfter(xe?function(Me){Me.x=(Me.x-pe.x)*ve,Me.y=(pe.y-Me.y)*fe}:function(Me){Me.x=(Me.x-Ae)/(Le-Ae)*ve,Me.y=(1-(pe.y?Me.y/pe.y:1))*fe})}return Se.separation=function(pe){return arguments.length?(oe=pe,Se):oe},Se.size=function(pe){return arguments.length?(xe=!1,ve=+pe[0],fe=+pe[1],Se):xe?null:[ve,fe]},Se.nodeSize=function(pe){return arguments.length?(xe=!0,ve=+pe[0],fe=+pe[1],Se):xe?[ve,fe]:null},Se},g.hierarchy=r,g.pack=function(){var oe=null,ve=1,fe=1,xe=P;function Se(pe){return pe.x=ve/2,pe.y=fe/2,oe?pe.eachBefore(C(oe)).eachAfter(R(xe,.5)).eachBefore(D(1)):pe.eachBefore(C(S)).eachAfter(R(P,1)).eachAfter(R(xe,pe.r/Math.min(ve,fe))).eachBefore(D(Math.min(ve,fe)/(2*pe.r))),pe}return Se.radius=function(pe){return arguments.length?(oe=L(pe),Se):oe},Se.size=function(pe){return arguments.length?(ve=+pe[0],fe=+pe[1],Se):[ve,fe]},Se.padding=function(pe){return arguments.length?(xe="function"==typeof pe?pe:z(+pe),Se):xe},Se},g.packEnclose=s,g.packSiblings=function(oe){return T(oe),oe},g.partition=function(){var oe=1,ve=1,fe=0,xe=!1;function Se(pe){var Te,se,ge=pe.height+1;return pe.x0=pe.y0=fe,pe.x1=oe,pe.y1=ve/ge,pe.eachBefore((Te=ve,se=ge,function(de){de.children&&q(de,de.x0,Te*(de.depth+1)/se,de.x1,Te*(de.depth+2)/se);var Ae=de.x0,Le=de.y0,Me=de.x1-fe,De=de.y1-fe;Me<Ae&&(Ae=Me=(Ae+Me)/2),De<Le&&(Le=De=(Le+De)/2),de.x0=Ae,de.y0=Le,de.x1=Me,de.y1=De})),xe&&pe.eachBefore(j),pe}return Se.round=function(pe){return arguments.length?(xe=!!pe,Se):xe},Se.size=function(pe){return arguments.length?(oe=+pe[0],ve=+pe[1],Se):[oe,ve]},Se.padding=function(pe){return arguments.length?(fe=+pe,Se):fe},Se},g.stratify=function(){var oe=G,ve=X;function fe(xe){var Se,pe,ge,Te,se,de,Ae,Le=xe.length,Me=new Array(Le),De={};for(pe=0;pe<Le;++pe)se=Me[pe]=new m(Se=xe[pe]),null!=(de=oe(Se,pe,xe))&&(de+="")&&(De[Ae="$"+(se.id=de)]=Ae in De?W:se);for(pe=0;pe<Le;++pe)if(se=Me[pe],null!=(de=ve(xe[pe],pe,xe))&&(de+="")){if(!(Te=De["$"+de]))throw new Error("missing: "+de);if(Te===W)throw new Error("ambiguous: "+de);Te.children?Te.children.push(se):Te.children=[se],se.parent=Te}else{if(ge)throw new Error("multiple roots");ge=se}if(!ge)throw new Error("no root");if(ge.parent=Z,ge.eachBefore(function(Oe){Oe.depth=Oe.parent.depth+1,--Le}).eachBefore(n),ge.parent=null,Le>0)throw new Error("cycle");return ge}return fe.id=function(xe){return arguments.length?(oe=M(xe),fe):oe},fe.parentId=function(xe){return arguments.length?(ve=M(xe),fe):ve},fe},g.tree=function(){var oe=ne,ve=1,fe=1,xe=null;function Se(se){var de=function(Ne){for(var Pe,Re,Ge,tt,ct,wt=new B(Ne,0),kt=[wt];Pe=kt.pop();)if(Ge=Pe._.children)for(Pe.children=new Array(ct=Ge.length),tt=ct-1;tt>=0;--tt)kt.push(Re=Pe.children[tt]=new B(Ge[tt],tt)),Re.parent=Pe;return(wt.parent=new B(null,0)).children=[wt],wt}(se);if(de.eachAfter(pe),de.parent.m=-de.z,de.eachBefore(ge),xe)se.eachBefore(Te);else{var Ae=se,Le=se,Me=se;se.eachBefore(function(Ne){Ne.x<Ae.x&&(Ae=Ne),Ne.x>Le.x&&(Le=Ne),Ne.depth>Me.depth&&(Me=Ne)});var De=Ae===Le?1:oe(Ae,Le)/2,Oe=De-Ae.x,Ie=ve/(Le.x+De+Oe),Qe=fe/(Me.depth||1);se.eachBefore(function(Ne){Ne.x=(Ne.x+Oe)*Ie,Ne.y=Ne.depth*Qe})}return se}function pe(se){var de=se.children,Ae=se.parent.children,Le=se.i?Ae[se.i-1]:null;if(de){!function(De){for(var Oe,Ie=0,Qe=0,Ne=De.children,Pe=Ne.length;--Pe>=0;)(Oe=Ne[Pe]).z+=Ie,Oe.m+=Ie,Ie+=Oe.s+(Qe+=Oe.c)}(se);var Me=(de[0].z+de[de.length-1].z)/2;Le?(se.z=Le.z+oe(se._,Le._),se.m=se.z-Me):se.z=Me}else Le&&(se.z=Le.z+oe(se._,Le._));se.parent.A=function(De,Oe,Ie){if(Oe){for(var Qe,Ne=De,Pe=De,Re=Oe,Ge=Ne.parent.children[0],tt=Ne.m,ct=Pe.m,wt=Re.m,kt=Ge.m;Re=N(Re),Ne=V(Ne),Re&&Ne;)Ge=V(Ge),(Pe=N(Pe)).a=De,(Qe=Re.z+wt-Ne.z-tt+oe(Re._,Ne._))>0&&(U(ee(Re,De,Ie),De,Qe),tt+=Qe,ct+=Qe),wt+=Re.m,tt+=Ne.m,kt+=Ge.m,ct+=Pe.m;Re&&!N(Pe)&&(Pe.t=Re,Pe.m+=wt-ct),Ne&&!V(Ge)&&(Ge.t=Ne,Ge.m+=tt-kt,Ie=De)}return Ie}(se,Le,se.parent.A||Ae[0])}function ge(se){se._.x=se.z+se.parent.m,se.m+=se.parent.m}function Te(se){se.x*=ve,se.y=se.depth*fe}return Se.separation=function(se){return arguments.length?(oe=se,Se):oe},Se.size=function(se){return arguments.length?(xe=!1,ve=+se[0],fe=+se[1],Se):xe?null:[ve,fe]},Se.nodeSize=function(se){return arguments.length?(xe=!0,ve=+se[0],fe=+se[1],Se):xe?[ve,fe]:null},Se},g.treemap=function(){var oe=ae,ve=!1,fe=1,xe=1,Se=[0],pe=P,ge=P,Te=P,se=P,de=P;function Ae(Me){return Me.x0=Me.y0=0,Me.x1=fe,Me.y1=xe,Me.eachBefore(Le),Se=[0],ve&&Me.eachBefore(j),Me}function Le(Me){var De=Se[Me.depth],Oe=Me.x0+De,Ie=Me.y0+De,Qe=Me.x1-De,Ne=Me.y1-De;Qe<Oe&&(Oe=Qe=(Oe+Qe)/2),Ne<Ie&&(Ie=Ne=(Ie+Ne)/2),Me.x0=Oe,Me.y0=Ie,Me.x1=Qe,Me.y1=Ne,Me.children&&(De=Se[Me.depth+1]=pe(Me)/2,Oe+=de(Me)-De,Ie+=ge(Me)-De,(Qe-=Te(Me)-De)<Oe&&(Oe=Qe=(Oe+Qe)/2),(Ne-=se(Me)-De)<Ie&&(Ie=Ne=(Ie+Ne)/2),oe(Me,Oe,Ie,Qe,Ne))}return Ae.round=function(Me){return arguments.length?(ve=!!Me,Ae):ve},Ae.size=function(Me){return arguments.length?(fe=+Me[0],xe=+Me[1],Ae):[fe,xe]},Ae.tile=function(Me){return arguments.length?(oe=M(Me),Ae):oe},Ae.padding=function(Me){return arguments.length?Ae.paddingInner(Me).paddingOuter(Me):Ae.paddingInner()},Ae.paddingInner=function(Me){return arguments.length?(pe="function"==typeof Me?Me:z(+Me),Ae):pe},Ae.paddingOuter=function(Me){return arguments.length?Ae.paddingTop(Me).paddingRight(Me).paddingBottom(Me).paddingLeft(Me):Ae.paddingTop()},Ae.paddingTop=function(Me){return arguments.length?(ge="function"==typeof Me?Me:z(+Me),Ae):ge},Ae.paddingRight=function(Me){return arguments.length?(Te="function"==typeof Me?Me:z(+Me),Ae):Te},Ae.paddingBottom=function(Me){return arguments.length?(se="function"==typeof Me?Me:z(+Me),Ae):se},Ae.paddingLeft=function(Me){return arguments.length?(de="function"==typeof Me?Me:z(+Me),Ae):de},Ae},g.treemapBinary=function(oe,ve,fe,xe,Se){var pe,ge,Te=oe.children,se=Te.length,de=new Array(se+1);for(de[0]=ge=pe=0;pe<se;++pe)de[pe+1]=ge+=Te[pe].value;!function Ae(Le,Me,De,Oe,Ie,Qe,Ne){if(Le>=Me-1){var Pe=Te[Le];return Pe.x0=Oe,Pe.y0=Ie,Pe.x1=Qe,void(Pe.y1=Ne)}for(var Re=de[Le],Ge=De/2+Re,tt=Le+1,ct=Me-1;tt<ct;){var wt=tt+ct>>>1;de[wt]<Ge?tt=wt+1:ct=wt}Ge-de[tt-1]<de[tt]-Ge&&Le+1<tt&&--tt;var kt=de[tt]-Re,gt=De-kt;if(Qe-Oe>Ne-Ie){var at=(Oe*gt+Qe*kt)/De;Ae(Le,tt,kt,Oe,Ie,at,Ne),Ae(tt,Me,gt,at,Ie,Qe,Ne)}else{var et=(Ie*gt+Ne*kt)/De;Ae(Le,tt,kt,Oe,Ie,Qe,et),Ae(tt,Me,gt,Oe,et,Qe,Ne)}}(0,se,oe.value,ve,fe,xe,Se)},g.treemapDice=q,g.treemapResquarify=ce,g.treemapSlice=K,g.treemapSliceDice=function(oe,ve,fe,xe,Se){(1&oe.depth?K:q)(oe,ve,fe,xe,Se)},g.treemapSquarify=ae,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],116:[function(v,Q,$){var g,t;g=this,t=function(g,t){"use strict";function k(J,te,ae,ce,oe){var ve=J*J,fe=ve*J;return((1-3*J+3*ve-fe)*te+(4-6*ve+3*fe)*ae+(1+3*J+3*ve-3*fe)*ce+fe*oe)/6}function x(J){var te=J.length-1;return function(ae){var ce=ae<=0?ae=0:ae>=1?(ae=1,te-1):Math.floor(ae*te),oe=J[ce],ve=J[ce+1];return k((ae-ce/te)*te,ce>0?J[ce-1]:2*oe-ve,oe,ve,ce<te-1?J[ce+2]:2*ve-oe)}}function e(J){var te=J.length;return function(ae){var ce=Math.floor(((ae%=1)<0?++ae:ae)*te);return k((ae-ce/te)*te,J[(ce+te-1)%te],J[ce%te],J[(ce+1)%te],J[(ce+2)%te])}}function r(J){return function(){return J}}function i(J,te){return function(ae){return J+ae*te}}function c(J,te){var ae=te-J;return ae?i(J,ae>180||ae<-180?ae-360*Math.round(ae/360):ae):r(isNaN(J)?te:J)}function m(J,te){var ae=te-J;return ae?i(J,ae):r(isNaN(J)?te:J)}var p=function J(te){var ae=function n(J){return 1==(J=+J)?m:function(te,ae){return ae-te?(ce=te,oe=ae,ve=J,ce=Math.pow(ce,ve),oe=Math.pow(oe,ve)-ce,ve=1/ve,function(fe){return Math.pow(ce+fe*oe,ve)}):r(isNaN(te)?ae:te);var ce,oe,ve}}(te);function ce(oe,ve){var fe=ae((oe=t.rgb(oe)).r,(ve=t.rgb(ve)).r),xe=ae(oe.g,ve.g),Se=ae(oe.b,ve.b),pe=m(oe.opacity,ve.opacity);return function(ge){return oe.r=fe(ge),oe.g=xe(ge),oe.b=Se(ge),oe.opacity=pe(ge),oe+""}}return ce.gamma=J,ce}(1);function s(J){return function(te){var ae,ce,oe=te.length,ve=new Array(oe),fe=new Array(oe),xe=new Array(oe);for(ae=0;ae<oe;++ae)ce=t.rgb(te[ae]),ve[ae]=ce.r||0,fe[ae]=ce.g||0,xe[ae]=ce.b||0;return ve=J(ve),fe=J(fe),xe=J(xe),ce.opacity=1,function(Se){return ce.r=ve(Se),ce.g=fe(Se),ce.b=xe(Se),ce+""}}}var f=s(x),l=s(e);function o(J,te){te||(te=[]);var ae,ce=J?Math.min(te.length,J.length):0,oe=te.slice();return function(ve){for(ae=0;ae<ce;++ae)oe[ae]=J[ae]*(1-ve)+te[ae]*ve;return oe}}function d(J){return ArrayBuffer.isView(J)&&!(J instanceof DataView)}function u(J,te){var ae,ce=te?te.length:0,oe=J?Math.min(ce,J.length):0,ve=new Array(oe),fe=new Array(ce);for(ae=0;ae<oe;++ae)ve[ae]=T(J[ae],te[ae]);for(;ae<ce;++ae)fe[ae]=te[ae];return function(xe){for(ae=0;ae<oe;++ae)fe[ae]=ve[ae](xe);return fe}}function a(J,te){var ae=new Date;return J=+J,te=+te,function(ce){return ae.setTime(J*(1-ce)+te*ce),ae}}function y(J,te){return J=+J,te=+te,function(ae){return J*(1-ae)+te*ae}}function h(J,te){var ae,ce={},oe={};for(ae in null!==J&&"object"==typeof J||(J={}),null!==te&&"object"==typeof te||(te={}),te)ae in J?ce[ae]=T(J[ae],te[ae]):oe[ae]=te[ae];return function(ve){for(ae in ce)oe[ae]=ce[ae](ve);return oe}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(_.source,"g");function w(J,te){var ae,ce,oe,pe,ve=_.lastIndex=b.lastIndex=0,fe=-1,xe=[],Se=[];for(J+="",te+="";(ae=_.exec(J))&&(ce=b.exec(te));)(oe=ce.index)>ve&&(oe=te.slice(ve,oe),xe[fe]?xe[fe]+=oe:xe[++fe]=oe),(ae=ae[0])===(ce=ce[0])?xe[fe]?xe[fe]+=ce:xe[++fe]=ce:(xe[++fe]=null,Se.push({i:fe,x:y(ae,ce)})),ve=b.lastIndex;return ve<te.length&&(oe=te.slice(ve),xe[fe]?xe[fe]+=oe:xe[++fe]=oe),xe.length<2?Se[0]?(pe=Se[0].x,function(ge){return pe(ge)+""}):function(pe){return function(){return pe}}(te):(te=Se.length,function(pe){for(var ge,Te=0;Te<te;++Te)xe[(ge=Se[Te]).i]=ge.x(pe);return xe.join("")})}function T(J,te){var ae,ce=typeof te;return null==te||"boolean"===ce?r(te):("number"===ce?y:"string"===ce?(ae=t.color(te))?(te=ae,p):w:te instanceof t.color?p:te instanceof Date?a:d(te)?o:Array.isArray(te)?u:"function"!=typeof te.valueOf&&"function"!=typeof te.toString||isNaN(te)?h:y)(J,te)}var L,M,P,z,S=180/Math.PI,C={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function R(J,te,ae,ce,oe,ve){var fe,xe,Se;return(fe=Math.sqrt(J*J+te*te))&&(J/=fe,te/=fe),(Se=J*ae+te*ce)&&(ae-=J*Se,ce-=te*Se),(xe=Math.sqrt(ae*ae+ce*ce))&&(ae/=xe,ce/=xe,Se/=xe),J*ce<te*ae&&(J=-J,te=-te,Se=-Se,fe=-fe),{translateX:oe,translateY:ve,rotate:Math.atan2(te,J)*S,skewX:Math.atan(Se)*S,scaleX:fe,scaleY:xe}}function D(J,te,ae,ce){function oe(ve){return ve.length?ve.pop()+" ":""}return function(ve,fe){var pe,ge,Te,xe=[],Se=[];return ve=J(ve),fe=J(fe),function(pe,ge,Te,se,de,Ae){if(pe!==Te||ge!==se){var Le=de.push("translate(",null,te,null,ae);Ae.push({i:Le-4,x:y(pe,Te)},{i:Le-2,x:y(ge,se)})}else(Te||se)&&de.push("translate("+Te+te+se+ae)}(ve.translateX,ve.translateY,fe.translateX,fe.translateY,xe,Se),Te=xe,(pe=ve.rotate)!==(ge=fe.rotate)?(pe-ge>180?ge+=360:ge-pe>180&&(pe+=360),Se.push({i:Te.push(oe(Te)+"rotate(",null,ce)-2,x:y(pe,ge)})):ge&&Te.push(oe(Te)+"rotate("+ge+ce),function(pe,ge,Te,se){pe!==ge?se.push({i:Te.push(oe(Te)+"skewX(",null,ce)-2,x:y(pe,ge)}):ge&&Te.push(oe(Te)+"skewX("+ge+ce)}(ve.skewX,fe.skewX,xe,Se),function(pe,ge,Te,se,de,Ae){if(pe!==Te||ge!==se){var Le=de.push(oe(de)+"scale(",null,",",null,")");Ae.push({i:Le-4,x:y(pe,Te)},{i:Le-2,x:y(ge,se)})}else 1===Te&&1===se||de.push(oe(de)+"scale("+Te+","+se+")")}(ve.scaleX,ve.scaleY,fe.scaleX,fe.scaleY,xe,Se),ve=fe=null,function(pe){for(var ge,Te=-1,se=Se.length;++Te<se;)xe[(ge=Se[Te]).i]=ge.x(pe);return xe.join("")}}}var j=D(function(J){return"none"===J?C:(L||(L=document.createElement("DIV"),M=document.documentElement,P=document.defaultView),L.style.transform=J,J=P.getComputedStyle(M.appendChild(L),null).getPropertyValue("transform"),M.removeChild(L),R(+(J=J.slice(7,-1).split(","))[0],+J[1],+J[2],+J[3],+J[4],+J[5]))},"px, ","px)","deg)"),q=D(function(J){return null==J?C:(z||(z=document.createElementNS("http://www.w3.org/2000/svg","g")),z.setAttribute("transform",J),(J=z.transform.baseVal.consolidate())?R((J=J.matrix).a,J.b,J.c,J.d,J.e,J.f):C)},", ",")",")"),Z=Math.SQRT2;function W(J){return((J=Math.exp(J))+1/J)/2}function G(J){return function(te,ae){var ce=J((te=t.hsl(te)).h,(ae=t.hsl(ae)).h),oe=m(te.s,ae.s),ve=m(te.l,ae.l),fe=m(te.opacity,ae.opacity);return function(xe){return te.h=ce(xe),te.s=oe(xe),te.l=ve(xe),te.opacity=fe(xe),te+""}}}var X=G(c),ne=G(m);function V(J){return function(te,ae){var ce=J((te=t.hcl(te)).h,(ae=t.hcl(ae)).h),oe=m(te.c,ae.c),ve=m(te.l,ae.l),fe=m(te.opacity,ae.opacity);return function(xe){return te.h=ce(xe),te.c=oe(xe),te.l=ve(xe),te.opacity=fe(xe),te+""}}}var N=V(c),U=V(m);function ee(J){return function te(ae){function ce(oe,ve){var fe=J((oe=t.cubehelix(oe)).h,(ve=t.cubehelix(ve)).h),xe=m(oe.s,ve.s),Se=m(oe.l,ve.l),pe=m(oe.opacity,ve.opacity);return function(ge){return oe.h=fe(ge),oe.s=xe(ge),oe.l=Se(Math.pow(ge,ae)),oe.opacity=pe(ge),oe+""}}return ae=+ae,ce.gamma=te,ce}(1)}var B=ee(c),K=ee(m);g.interpolate=T,g.interpolateArray=function(J,te){return(d(te)?o:u)(J,te)},g.interpolateBasis=x,g.interpolateBasisClosed=e,g.interpolateCubehelix=B,g.interpolateCubehelixLong=K,g.interpolateDate=a,g.interpolateDiscrete=function(J){var te=J.length;return function(ae){return J[Math.max(0,Math.min(te-1,Math.floor(ae*te)))]}},g.interpolateHcl=N,g.interpolateHclLong=U,g.interpolateHsl=X,g.interpolateHslLong=ne,g.interpolateHue=function(J,te){var ae=c(+J,+te);return function(ce){var oe=ae(ce);return oe-360*Math.floor(oe/360)}},g.interpolateLab=function(J,te){var ae=m((J=t.lab(J)).l,(te=t.lab(te)).l),ce=m(J.a,te.a),oe=m(J.b,te.b),ve=m(J.opacity,te.opacity);return function(fe){return J.l=ae(fe),J.a=ce(fe),J.b=oe(fe),J.opacity=ve(fe),J+""}},g.interpolateNumber=y,g.interpolateNumberArray=o,g.interpolateObject=h,g.interpolateRgb=p,g.interpolateRgbBasis=f,g.interpolateRgbBasisClosed=l,g.interpolateRound=function(J,te){return J=+J,te=+te,function(ae){return Math.round(J*(1-ae)+te*ae)}},g.interpolateString=w,g.interpolateTransformCss=j,g.interpolateTransformSvg=q,g.interpolateZoom=function(J,te){var ae,ce,oe=J[0],ve=J[1],fe=J[2],pe=te[2],ge=te[0]-oe,Te=te[1]-ve,se=ge*ge+Te*Te;if(se<1e-12)ce=Math.log(pe/fe)/Z,ae=function(Oe){return[oe+Oe*ge,ve+Oe*Te,fe*Math.exp(Z*Oe*ce)]};else{var de=Math.sqrt(se),Ae=(pe*pe-fe*fe+4*se)/(2*fe*2*de),Le=(pe*pe-fe*fe-4*se)/(2*pe*2*de),Me=Math.log(Math.sqrt(Ae*Ae+1)-Ae),De=Math.log(Math.sqrt(Le*Le+1)-Le);ce=(De-Me)/Z,ae=function(Oe){var Ie,Re,Qe=Oe*ce,Ne=W(Me),Pe=fe/(2*de)*(Ne*(Ie=Z*Qe+Me,((Ie=Math.exp(2*Ie))-1)/(Ie+1))-(Re=Me,((Re=Math.exp(Re))-1/Re)/2));return[oe+Pe*ge,ve+Pe*Te,fe*Ne/W(Z*Qe+Me)]}}return ae.duration=1e3*ce,ae},g.piecewise=function(J,te){for(var ae=0,ce=te.length-1,oe=te[0],ve=new Array(ce<0?0:ce);ae<ce;)ve[ae]=J(oe,oe=te[++ae]);return function(fe){var xe=Math.max(0,Math.min(ce-1,Math.floor(fe*=ce)));return ve[xe](fe-xe)}},g.quantize=function(J,te){for(var ae=new Array(te),ce=0;ce<te;++ce)ae[ce]=J(ce/(te-1));return ae},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-color")):t((g=g||self).d3=g.d3||{},g.d3)},{"d3-color":109}],117:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";var t=Math.PI,k=2*t,x=k-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function r(){return new e}e.prototype=r.prototype={constructor:e,moveTo:function(i,c){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+c)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(i,c){this._+="L"+(this._x1=+i)+","+(this._y1=+c)},quadraticCurveTo:function(i,c,n,m){this._+="Q"+ +i+","+ +c+","+(this._x1=+n)+","+(this._y1=+m)},bezierCurveTo:function(i,c,n,m,p,s){this._+="C"+ +i+","+ +c+","+ +n+","+ +m+","+(this._x1=+p)+","+(this._y1=+s)},arcTo:function(i,c,n,m,p){var s=this._x1,f=this._y1,l=(n=+n)-(i=+i),o=(m=+m)-(c=+c),d=s-i,u=f-c,a=d*d+u*u;if((p=+p)<0)throw new Error("negative radius: "+p);if(null===this._x1)this._+="M"+(this._x1=i)+","+(this._y1=c);else if(a>1e-6)if(Math.abs(u*l-o*d)>1e-6&&p){var y=n-s,h=m-f,_=l*l+o*o,b=y*y+h*h,w=Math.sqrt(_),T=Math.sqrt(a),L=p*Math.tan((t-Math.acos((_+a-b)/(2*w*T)))/2),M=L/T,P=L/w;Math.abs(M-1)>1e-6&&(this._+="L"+(i+M*d)+","+(c+M*u)),this._+="A"+p+","+p+",0,0,"+ +(u*y>d*h)+","+(this._x1=i+P*l)+","+(this._y1=c+P*o)}else this._+="L"+(this._x1=i)+","+(this._y1=c)},arc:function(i,c,n,m,p,s){i=+i,c=+c,s=!!s;var f=(n=+n)*Math.cos(m),l=n*Math.sin(m),o=i+f,d=c+l,u=1^s,a=s?m-p:p-m;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+o+","+d:(Math.abs(this._x1-o)>1e-6||Math.abs(this._y1-d)>1e-6)&&(this._+="L"+o+","+d),n&&(a<0&&(a=a%k+k),a>x?this._+="A"+n+","+n+",0,1,"+u+","+(i-f)+","+(c-l)+"A"+n+","+n+",0,1,"+u+","+(this._x1=o)+","+(this._y1=d):a>1e-6&&(this._+="A"+n+","+n+",0,"+ +(a>=t)+","+u+","+(this._x1=i+n*Math.cos(p))+","+(this._y1=c+n*Math.sin(p))))},rect:function(i,c,n,m){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+c)+"h"+ +n+"v"+ +m+"h"+-n+"Z"},toString:function(){return this._}},g.path=r,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],118:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";function t(m,p,s,f){if(isNaN(p)||isNaN(s))return m;var l,o,d,u,a,y,h,_,b,w=m._root,T={data:f},L=m._x0,M=m._y0,P=m._x1,z=m._y1;if(!w)return m._root=T,m;for(;w.length;)if((y=p>=(o=(L+P)/2))?L=o:P=o,(h=s>=(d=(M+z)/2))?M=d:z=d,l=w,!(w=w[_=h<<1|y]))return l[_]=T,m;if(u=+m._x.call(null,w.data),a=+m._y.call(null,w.data),p===u&&s===a)return T.next=w,l?l[_]=T:m._root=T,m;do{l=l?l[_]=new Array(4):m._root=new Array(4),(y=p>=(o=(L+P)/2))?L=o:P=o,(h=s>=(d=(M+z)/2))?M=d:z=d}while((_=h<<1|y)==(b=(a>=d)<<1|u>=o));return l[b]=w,l[_]=T,m}function k(m,p,s,f,l){this.node=m,this.x0=p,this.y0=s,this.x1=f,this.y1=l}function x(m){return m[0]}function e(m){return m[1]}function r(m,p,s){var f=new i(null==p?x:p,null==s?e:s,NaN,NaN,NaN,NaN);return null==m?f:f.addAll(m)}function i(m,p,s,f,l,o){this._x=m,this._y=p,this._x0=s,this._y0=f,this._x1=l,this._y1=o,this._root=void 0}function c(m){for(var p={data:m.data},s=p;m=m.next;)s=s.next={data:m.data};return p}var n=r.prototype=i.prototype;n.copy=function(){var m,p,s=new i(this._x,this._y,this._x0,this._y0,this._x1,this._y1),f=this._root;if(!f)return s;if(!f.length)return s._root=c(f),s;for(m=[{source:f,target:s._root=new Array(4)}];f=m.pop();)for(var l=0;l<4;++l)(p=f.source[l])&&(p.length?m.push({source:p,target:f.target[l]=new Array(4)}):f.target[l]=c(p));return s},n.add=function(m){var p=+this._x.call(null,m),s=+this._y.call(null,m);return t(this.cover(p,s),p,s,m)},n.addAll=function(m){var p,s,f,l,o=m.length,d=new Array(o),u=new Array(o),a=1/0,y=1/0,h=-1/0,_=-1/0;for(s=0;s<o;++s)isNaN(f=+this._x.call(null,p=m[s]))||isNaN(l=+this._y.call(null,p))||(d[s]=f,u[s]=l,f<a&&(a=f),f>h&&(h=f),l<y&&(y=l),l>_&&(_=l));if(a>h||y>_)return this;for(this.cover(a,y).cover(h,_),s=0;s<o;++s)t(this,d[s],u[s],m[s]);return this},n.cover=function(m,p){if(isNaN(m=+m)||isNaN(p=+p))return this;var s=this._x0,f=this._y0,l=this._x1,o=this._y1;if(isNaN(s))l=(s=Math.floor(m))+1,o=(f=Math.floor(p))+1;else{for(var d,u,a=l-s,y=this._root;s>m||m>=l||f>p||p>=o;)switch(u=(p<f)<<1|m<s,(d=new Array(4))[u]=y,y=d,a*=2,u){case 0:l=s+a,o=f+a;break;case 1:s=l-a,o=f+a;break;case 2:l=s+a,f=o-a;break;case 3:s=l-a,f=o-a}this._root&&this._root.length&&(this._root=y)}return this._x0=s,this._y0=f,this._x1=l,this._y1=o,this},n.data=function(){var m=[];return this.visit(function(p){if(!p.length)do{m.push(p.data)}while(p=p.next)}),m},n.extent=function(m){return arguments.length?this.cover(+m[0][0],+m[0][1]).cover(+m[1][0],+m[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},n.find=function(m,p,s){var f,l,o,d,u,a,y,h=this._x0,_=this._y0,b=this._x1,w=this._y1,T=[],L=this._root;for(L&&T.push(new k(L,h,_,b,w)),null==s?s=1/0:(h=m-s,_=p-s,b=m+s,w=p+s,s*=s);a=T.pop();)if(!(!(L=a.node)||(l=a.x0)>b||(o=a.y0)>w||(d=a.x1)<h||(u=a.y1)<_))if(L.length){var M=(l+d)/2,P=(o+u)/2;T.push(new k(L[3],M,P,d,u),new k(L[2],l,P,M,u),new k(L[1],M,o,d,P),new k(L[0],l,o,M,P)),(y=(p>=P)<<1|m>=M)&&(a=T[T.length-1],T[T.length-1]=T[T.length-1-y],T[T.length-1-y]=a)}else{var z=m-+this._x.call(null,L.data),S=p-+this._y.call(null,L.data),C=z*z+S*S;if(C<s){var R=Math.sqrt(s=C);h=m-R,_=p-R,b=m+R,w=p+R,f=L.data}}return f},n.remove=function(m){if(isNaN(o=+this._x.call(null,m))||isNaN(d=+this._y.call(null,m)))return this;var p,s,f,l,o,d,u,a,y,h,_,b,w=this._root,T=this._x0,L=this._y0,M=this._x1,P=this._y1;if(!w)return this;if(w.length)for(;;){if((y=o>=(u=(T+M)/2))?T=u:M=u,(h=d>=(a=(L+P)/2))?L=a:P=a,p=w,!(w=w[_=h<<1|y]))return this;if(!w.length)break;(p[_+1&3]||p[_+2&3]||p[_+3&3])&&(s=p,b=_)}for(;w.data!==m;)if(f=w,!(w=w.next))return this;return(l=w.next)&&delete w.next,f?(l?f.next=l:delete f.next,this):p?(l?p[_]=l:delete p[_],(w=p[0]||p[1]||p[2]||p[3])&&w===(p[3]||p[2]||p[1]||p[0])&&!w.length&&(s?s[b]=w:this._root=w),this):(this._root=l,this)},n.removeAll=function(m){for(var p=0,s=m.length;p<s;++p)this.remove(m[p]);return this},n.root=function(){return this._root},n.size=function(){var m=0;return this.visit(function(p){if(!p.length)do{++m}while(p=p.next)}),m},n.visit=function(m){var p,s,f,l,o,d,u=[],a=this._root;for(a&&u.push(new k(a,this._x0,this._y0,this._x1,this._y1));p=u.pop();)if(!m(a=p.node,f=p.x0,l=p.y0,o=p.x1,d=p.y1)&&a.length){var y=(f+o)/2,h=(l+d)/2;(s=a[3])&&u.push(new k(s,y,h,o,d)),(s=a[2])&&u.push(new k(s,f,h,y,d)),(s=a[1])&&u.push(new k(s,y,l,o,h)),(s=a[0])&&u.push(new k(s,f,l,y,h))}return this},n.visitAfter=function(m){var p,s=[],f=[];for(this._root&&s.push(new k(this._root,this._x0,this._y0,this._x1,this._y1));p=s.pop();){var l=p.node;if(l.length){var o,d=p.x0,u=p.y0,a=p.x1,y=p.y1,h=(d+a)/2,_=(u+y)/2;(o=l[0])&&s.push(new k(o,d,u,h,_)),(o=l[1])&&s.push(new k(o,h,u,a,_)),(o=l[2])&&s.push(new k(o,d,_,h,y)),(o=l[3])&&s.push(new k(o,h,_,a,y))}f.push(p)}for(;p=f.pop();)m(p.node,p.x0,p.y0,p.x1,p.y1);return this},n.x=function(m){return arguments.length?(this._x=m,this):this._x},n.y=function(m){return arguments.length?(this._y=m,this):this._y},g.quadtree=r,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],119:[function(v,Q,$){var g,t;g=this,t=function(g,t){"use strict";function k(Ce){return function(){return Ce}}var x=Math.abs,e=Math.atan2,r=Math.cos,i=Math.max,c=Math.min,n=Math.sin,m=Math.sqrt,p=Math.PI,s=p/2,f=2*p;function l(Ce){return Ce>1?0:Ce<-1?p:Math.acos(Ce)}function o(Ce){return Ce>=1?s:Ce<=-1?-s:Math.asin(Ce)}function d(Ce){return Ce.innerRadius}function u(Ce){return Ce.outerRadius}function a(Ce){return Ce.startAngle}function y(Ce){return Ce.endAngle}function h(Ce){return Ce&&Ce.padAngle}function _(Ce,Xe,st,dt,zt,Ht,Kt,Zt){var vn=st-Ce,zn=dt-Xe,gn=Kt-zt,nn=Zt-Ht,an=nn*vn-gn*zn;if(!(an*an<1e-12))return[Ce+(an=(gn*(Xe-Ht)-nn*(Ce-zt))/an)*vn,Xe+an*zn]}function b(Ce,Xe,st,dt,zt,Ht,Kt){var Zt=Ce-st,vn=Xe-dt,zn=(Kt?Ht:-Ht)/m(Zt*Zt+vn*vn),gn=zn*vn,nn=-zn*Zt,an=Ce+gn,on=Xe+nn,mn=st+gn,_n=dt+nn,Pn=(an+mn)/2,Rn=(on+_n)/2,qn=mn-an,Xn=_n-on,br=qn*qn+Xn*Xn,fr=zt-Ht,Vr=an*_n-mn*on,cr=(Xn<0?-1:1)*m(i(0,fr*fr*br-Vr*Vr)),Sr=(Vr*Xn-qn*cr)/br,Cr=(-Vr*qn-Xn*cr)/br,pi=(Vr*Xn+qn*cr)/br,Yn=(-Vr*qn+Xn*cr)/br,ar=Sr-Pn,Ar=Cr-Rn,sr=pi-Pn,dr=Yn-Rn;return ar*ar+Ar*Ar>sr*sr+dr*dr&&(Sr=pi,Cr=Yn),{cx:Sr,cy:Cr,x01:-gn,y01:-nn,x11:Sr*(zt/fr-1),y11:Cr*(zt/fr-1)}}function w(Ce){this._context=Ce}function T(Ce){return new w(Ce)}function L(Ce){return Ce[0]}function M(Ce){return Ce[1]}function P(){var Ce=L,Xe=M,st=k(!0),dt=null,zt=T,Ht=null;function Kt(Zt){var vn,zn,gn,nn=Zt.length,an=!1;for(null==dt&&(Ht=zt(gn=t.path())),vn=0;vn<=nn;++vn)!(vn<nn&&st(zn=Zt[vn],vn,Zt))===an&&((an=!an)?Ht.lineStart():Ht.lineEnd()),an&&Ht.point(+Ce(zn,vn,Zt),+Xe(zn,vn,Zt));if(gn)return Ht=null,gn+""||null}return Kt.x=function(Zt){return arguments.length?(Ce="function"==typeof Zt?Zt:k(+Zt),Kt):Ce},Kt.y=function(Zt){return arguments.length?(Xe="function"==typeof Zt?Zt:k(+Zt),Kt):Xe},Kt.defined=function(Zt){return arguments.length?(st="function"==typeof Zt?Zt:k(!!Zt),Kt):st},Kt.curve=function(Zt){return arguments.length?(zt=Zt,null!=dt&&(Ht=zt(dt)),Kt):zt},Kt.context=function(Zt){return arguments.length?(null==Zt?dt=Ht=null:Ht=zt(dt=Zt),Kt):dt},Kt}function z(){var Ce=L,Xe=null,st=k(0),dt=M,zt=k(!0),Ht=null,Kt=T,Zt=null;function vn(gn){var nn,an,on,mn,_n,Pn=gn.length,Rn=!1,qn=new Array(Pn),Xn=new Array(Pn);for(null==Ht&&(Zt=Kt(_n=t.path())),nn=0;nn<=Pn;++nn){if(!(nn<Pn&&zt(mn=gn[nn],nn,gn))===Rn)if(Rn=!Rn)an=nn,Zt.areaStart(),Zt.lineStart();else{for(Zt.lineEnd(),Zt.lineStart(),on=nn-1;on>=an;--on)Zt.point(qn[on],Xn[on]);Zt.lineEnd(),Zt.areaEnd()}Rn&&(qn[nn]=+Ce(mn,nn,gn),Xn[nn]=+st(mn,nn,gn),Zt.point(Xe?+Xe(mn,nn,gn):qn[nn],dt?+dt(mn,nn,gn):Xn[nn]))}if(_n)return Zt=null,_n+""||null}function zn(){return P().defined(zt).curve(Kt).context(Ht)}return vn.x=function(gn){return arguments.length?(Ce="function"==typeof gn?gn:k(+gn),Xe=null,vn):Ce},vn.x0=function(gn){return arguments.length?(Ce="function"==typeof gn?gn:k(+gn),vn):Ce},vn.x1=function(gn){return arguments.length?(Xe=null==gn?null:"function"==typeof gn?gn:k(+gn),vn):Xe},vn.y=function(gn){return arguments.length?(st="function"==typeof gn?gn:k(+gn),dt=null,vn):st},vn.y0=function(gn){return arguments.length?(st="function"==typeof gn?gn:k(+gn),vn):st},vn.y1=function(gn){return arguments.length?(dt=null==gn?null:"function"==typeof gn?gn:k(+gn),vn):dt},vn.lineX0=vn.lineY0=function(){return zn().x(Ce).y(st)},vn.lineY1=function(){return zn().x(Ce).y(dt)},vn.lineX1=function(){return zn().x(Xe).y(st)},vn.defined=function(gn){return arguments.length?(zt="function"==typeof gn?gn:k(!!gn),vn):zt},vn.curve=function(gn){return arguments.length?(Kt=gn,null!=Ht&&(Zt=Kt(Ht)),vn):Kt},vn.context=function(gn){return arguments.length?(null==gn?Ht=Zt=null:Zt=Kt(Ht=gn),vn):Ht},vn}function S(Ce,Xe){return Xe<Ce?-1:Xe>Ce?1:Xe>=Ce?0:NaN}function C(Ce){return Ce}w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,Xe):this._context.moveTo(Ce,Xe);break;case 1:this._point=2;default:this._context.lineTo(Ce,Xe)}}};var R=j(T);function D(Ce){this._curve=Ce}function j(Ce){function Xe(st){return new D(Ce(st))}return Xe._curve=Ce,Xe}function q(Ce){var Xe=Ce.curve;return Ce.angle=Ce.x,delete Ce.x,Ce.radius=Ce.y,delete Ce.y,Ce.curve=function(st){return arguments.length?Xe(j(st)):Xe()._curve},Ce}function Z(){return q(P().curve(R))}function W(){var Ce=z().curve(R),Xe=Ce.curve,st=Ce.lineX0,dt=Ce.lineX1,zt=Ce.lineY0,Ht=Ce.lineY1;return Ce.angle=Ce.x,delete Ce.x,Ce.startAngle=Ce.x0,delete Ce.x0,Ce.endAngle=Ce.x1,delete Ce.x1,Ce.radius=Ce.y,delete Ce.y,Ce.innerRadius=Ce.y0,delete Ce.y0,Ce.outerRadius=Ce.y1,delete Ce.y1,Ce.lineStartAngle=function(){return q(st())},delete Ce.lineX0,Ce.lineEndAngle=function(){return q(dt())},delete Ce.lineX1,Ce.lineInnerRadius=function(){return q(zt())},delete Ce.lineY0,Ce.lineOuterRadius=function(){return q(Ht())},delete Ce.lineY1,Ce.curve=function(Kt){return arguments.length?Xe(j(Kt)):Xe()._curve},Ce}function G(Ce,Xe){return[(Xe=+Xe)*Math.cos(Ce-=Math.PI/2),Xe*Math.sin(Ce)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ce,Xe){this._curve.point(Xe*Math.sin(Ce),Xe*-Math.cos(Ce))}};var X=Array.prototype.slice;function ne(Ce){return Ce.source}function V(Ce){return Ce.target}function N(Ce){var Xe=ne,st=V,dt=L,zt=M,Ht=null;function Kt(){var Zt,vn=X.call(arguments),zn=Xe.apply(this,vn),gn=st.apply(this,vn);if(Ht||(Ht=Zt=t.path()),Ce(Ht,+dt.apply(this,(vn[0]=zn,vn)),+zt.apply(this,vn),+dt.apply(this,(vn[0]=gn,vn)),+zt.apply(this,vn)),Zt)return Ht=null,Zt+""||null}return Kt.source=function(Zt){return arguments.length?(Xe=Zt,Kt):Xe},Kt.target=function(Zt){return arguments.length?(st=Zt,Kt):st},Kt.x=function(Zt){return arguments.length?(dt="function"==typeof Zt?Zt:k(+Zt),Kt):dt},Kt.y=function(Zt){return arguments.length?(zt="function"==typeof Zt?Zt:k(+Zt),Kt):zt},Kt.context=function(Zt){return arguments.length?(Ht=null==Zt?null:Zt,Kt):Ht},Kt}function U(Ce,Xe,st,dt,zt){Ce.moveTo(Xe,st),Ce.bezierCurveTo(Xe=(Xe+dt)/2,st,Xe,zt,dt,zt)}function ee(Ce,Xe,st,dt,zt){Ce.moveTo(Xe,st),Ce.bezierCurveTo(Xe,st=(st+zt)/2,dt,st,dt,zt)}function B(Ce,Xe,st,dt,zt){var Ht=G(Xe,st),Kt=G(Xe,st=(st+zt)/2),Zt=G(dt,st),vn=G(dt,zt);Ce.moveTo(Ht[0],Ht[1]),Ce.bezierCurveTo(Kt[0],Kt[1],Zt[0],Zt[1],vn[0],vn[1])}var K={draw:function(Ce,Xe){var st=Math.sqrt(Xe/p);Ce.moveTo(st,0),Ce.arc(0,0,st,0,f)}},J={draw:function(Ce,Xe){var st=Math.sqrt(Xe/5)/2;Ce.moveTo(-3*st,-st),Ce.lineTo(-st,-st),Ce.lineTo(-st,-3*st),Ce.lineTo(st,-3*st),Ce.lineTo(st,-st),Ce.lineTo(3*st,-st),Ce.lineTo(3*st,st),Ce.lineTo(st,st),Ce.lineTo(st,3*st),Ce.lineTo(-st,3*st),Ce.lineTo(-st,st),Ce.lineTo(-3*st,st),Ce.closePath()}},te=Math.sqrt(1/3),ae=2*te,ce={draw:function(Ce,Xe){var st=Math.sqrt(Xe/ae),dt=st*te;Ce.moveTo(0,-st),Ce.lineTo(dt,0),Ce.lineTo(0,st),Ce.lineTo(-dt,0),Ce.closePath()}},oe=Math.sin(p/10)/Math.sin(7*p/10),ve=Math.sin(f/10)*oe,fe=-Math.cos(f/10)*oe,xe={draw:function(Ce,Xe){var st=Math.sqrt(.8908130915292852*Xe),dt=ve*st,zt=fe*st;Ce.moveTo(0,-st),Ce.lineTo(dt,zt);for(var Ht=1;Ht<5;++Ht){var Kt=f*Ht/5,Zt=Math.cos(Kt),vn=Math.sin(Kt);Ce.lineTo(vn*st,-Zt*st),Ce.lineTo(Zt*dt-vn*zt,vn*dt+Zt*zt)}Ce.closePath()}},Se={draw:function(Ce,Xe){var st=Math.sqrt(Xe),dt=-st/2;Ce.rect(dt,dt,st,st)}},pe=Math.sqrt(3),ge={draw:function(Ce,Xe){var st=-Math.sqrt(Xe/(3*pe));Ce.moveTo(0,2*st),Ce.lineTo(-pe*st,-st),Ce.lineTo(pe*st,-st),Ce.closePath()}},Te=-.5,se=Math.sqrt(3)/2,de=1/Math.sqrt(12),Ae=3*(de/2+1),Le={draw:function(Ce,Xe){var st=Math.sqrt(Xe/Ae),dt=st/2,zt=st*de,Ht=dt,Kt=st*de+st,Zt=-Ht,vn=Kt;Ce.moveTo(dt,zt),Ce.lineTo(Ht,Kt),Ce.lineTo(Zt,vn),Ce.lineTo(Te*dt-se*zt,se*dt+Te*zt),Ce.lineTo(Te*Ht-se*Kt,se*Ht+Te*Kt),Ce.lineTo(Te*Zt-se*vn,se*Zt+Te*vn),Ce.lineTo(Te*dt+se*zt,Te*zt-se*dt),Ce.lineTo(Te*Ht+se*Kt,Te*Kt-se*Ht),Ce.lineTo(Te*Zt+se*vn,Te*vn-se*Zt),Ce.closePath()}},Me=[K,J,ce,Se,xe,ge,Le];function De(){}function Oe(Ce,Xe,st){Ce._context.bezierCurveTo((2*Ce._x0+Ce._x1)/3,(2*Ce._y0+Ce._y1)/3,(Ce._x0+2*Ce._x1)/3,(Ce._y0+2*Ce._y1)/3,(Ce._x0+4*Ce._x1+Xe)/6,(Ce._y0+4*Ce._y1+st)/6)}function Ie(Ce){this._context=Ce}function Qe(Ce){this._context=Ce}function Ne(Ce){this._context=Ce}function Pe(Ce,Xe){this._basis=new Ie(Ce),this._beta=Xe}Ie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Oe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,Xe):this._context.moveTo(Ce,Xe);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Oe(this,Ce,Xe)}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=Xe}},Qe.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1,this._x2=Ce,this._y2=Xe;break;case 1:this._point=2,this._x3=Ce,this._y3=Xe;break;case 2:this._point=3,this._x4=Ce,this._y4=Xe,this._context.moveTo((this._x0+4*this._x1+Ce)/6,(this._y0+4*this._y1+Xe)/6);break;default:Oe(this,Ce,Xe)}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=Xe}},Ne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var st=(this._x0+4*this._x1+Ce)/6,dt=(this._y0+4*this._y1+Xe)/6;this._line?this._context.lineTo(st,dt):this._context.moveTo(st,dt);break;case 3:this._point=4;default:Oe(this,Ce,Xe)}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=Xe}},Pe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ce=this._x,Xe=this._y,st=Ce.length-1;if(st>0)for(var dt,zt=Ce[0],Ht=Xe[0],Kt=Ce[st]-zt,Zt=Xe[st]-Ht,vn=-1;++vn<=st;)this._basis.point(this._beta*Ce[vn]+(1-this._beta)*(zt+(dt=vn/st)*Kt),this._beta*Xe[vn]+(1-this._beta)*(Ht+dt*Zt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ce,Xe){this._x.push(+Ce),this._y.push(+Xe)}};var Re=function Ce(Xe){function st(dt){return 1===Xe?new Ie(dt):new Pe(dt,Xe)}return st.beta=function(dt){return Ce(+dt)},st}(.85);function Ge(Ce,Xe,st){Ce._context.bezierCurveTo(Ce._x1+Ce._k*(Ce._x2-Ce._x0),Ce._y1+Ce._k*(Ce._y2-Ce._y0),Ce._x2+Ce._k*(Ce._x1-Xe),Ce._y2+Ce._k*(Ce._y1-st),Ce._x2,Ce._y2)}function tt(Ce,Xe){this._context=Ce,this._k=(1-Xe)/6}tt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ge(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,Xe):this._context.moveTo(Ce,Xe);break;case 1:this._point=2,this._x1=Ce,this._y1=Xe;break;case 2:this._point=3;default:Ge(this,Ce,Xe)}this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var ct=function Ce(Xe){function st(dt){return new tt(dt,Xe)}return st.tension=function(dt){return Ce(+dt)},st}(0);function wt(Ce,Xe){this._context=Ce,this._k=(1-Xe)/6}wt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1,this._x3=Ce,this._y3=Xe;break;case 1:this._point=2,this._context.moveTo(this._x4=Ce,this._y4=Xe);break;case 2:this._point=3,this._x5=Ce,this._y5=Xe;break;default:Ge(this,Ce,Xe)}this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var kt=function Ce(Xe){function st(dt){return new wt(dt,Xe)}return st.tension=function(dt){return Ce(+dt)},st}(0);function gt(Ce,Xe){this._context=Ce,this._k=(1-Xe)/6}gt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ge(this,Ce,Xe)}this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var at=function Ce(Xe){function st(dt){return new gt(dt,Xe)}return st.tension=function(dt){return Ce(+dt)},st}(0);function et(Ce,Xe,st){var dt=Ce._x1,zt=Ce._y1,Ht=Ce._x2,Kt=Ce._y2;if(Ce._l01_a>1e-12){var Zt=2*Ce._l01_2a+3*Ce._l01_a*Ce._l12_a+Ce._l12_2a,vn=3*Ce._l01_a*(Ce._l01_a+Ce._l12_a);dt=(dt*Zt-Ce._x0*Ce._l12_2a+Ce._x2*Ce._l01_2a)/vn,zt=(zt*Zt-Ce._y0*Ce._l12_2a+Ce._y2*Ce._l01_2a)/vn}if(Ce._l23_a>1e-12){var zn=2*Ce._l23_2a+3*Ce._l23_a*Ce._l12_a+Ce._l12_2a,gn=3*Ce._l23_a*(Ce._l23_a+Ce._l12_a);Ht=(Ht*zn+Ce._x1*Ce._l23_2a-Xe*Ce._l12_2a)/gn,Kt=(Kt*zn+Ce._y1*Ce._l23_2a-st*Ce._l12_2a)/gn}Ce._context.bezierCurveTo(dt,zt,Ht,Kt,Ce._x2,Ce._y2)}function yt(Ce,Xe){this._context=Ce,this._alpha=Xe}yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){if(Ce=+Ce,Xe=+Xe,this._point){var st=this._x2-Ce,dt=this._y2-Xe;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(st*st+dt*dt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,Xe):this._context.moveTo(Ce,Xe);break;case 1:this._point=2;break;case 2:this._point=3;default:et(this,Ce,Xe)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var Vt=function Ce(Xe){function st(dt){return Xe?new yt(dt,Xe):new tt(dt,0)}return st.alpha=function(dt){return Ce(+dt)},st}(.5);function Gt(Ce,Xe){this._context=Ce,this._alpha=Xe}Gt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ce,Xe){if(Ce=+Ce,Xe=+Xe,this._point){var st=this._x2-Ce,dt=this._y2-Xe;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(st*st+dt*dt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ce,this._y3=Xe;break;case 1:this._point=2,this._context.moveTo(this._x4=Ce,this._y4=Xe);break;case 2:this._point=3,this._x5=Ce,this._y5=Xe;break;default:et(this,Ce,Xe)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var en=function Ce(Xe){function st(dt){return Xe?new Gt(dt,Xe):new wt(dt,0)}return st.alpha=function(dt){return Ce(+dt)},st}(.5);function Jt(Ce,Xe){this._context=Ce,this._alpha=Xe}Jt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){if(Ce=+Ce,Xe=+Xe,this._point){var st=this._x2-Ce,dt=this._y2-Xe;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(st*st+dt*dt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:et(this,Ce,Xe)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var cn=function Ce(Xe){function st(dt){return Xe?new Jt(dt,Xe):new gt(dt,0)}return st.alpha=function(dt){return Ce(+dt)},st}(.5);function Rt(Ce){this._context=Ce}function je(Ce){return Ce<0?-1:1}function Ye(Ce,Xe,st){var dt=Ce._x1-Ce._x0,zt=Xe-Ce._x1,Ht=(Ce._y1-Ce._y0)/(dt||zt<0&&-0),Kt=(st-Ce._y1)/(zt||dt<0&&-0),Zt=(Ht*zt+Kt*dt)/(dt+zt);return(je(Ht)+je(Kt))*Math.min(Math.abs(Ht),Math.abs(Kt),.5*Math.abs(Zt))||0}function he(Ce,Xe){var st=Ce._x1-Ce._x0;return st?(3*(Ce._y1-Ce._y0)/st-Xe)/2:Xe}function be(Ce,Xe,st){var dt=Ce._x0,Ht=Ce._x1,Kt=Ce._y1,Zt=(Ht-dt)/3;Ce._context.bezierCurveTo(dt+Zt,Ce._y0+Zt*Xe,Ht-Zt,Kt-Zt*st,Ht,Kt)}function Fe(Ce){this._context=Ce}function He(Ce){this._context=new Ke(Ce)}function Ke(Ce){this._context=Ce}function Ze(Ce){this._context=Ce}function ut(Ce){var Xe,st,dt=Ce.length-1,zt=new Array(dt),Ht=new Array(dt),Kt=new Array(dt);for(zt[0]=0,Ht[0]=2,Kt[0]=Ce[0]+2*Ce[1],Xe=1;Xe<dt-1;++Xe)zt[Xe]=1,Ht[Xe]=4,Kt[Xe]=4*Ce[Xe]+2*Ce[Xe+1];for(zt[dt-1]=2,Ht[dt-1]=7,Kt[dt-1]=8*Ce[dt-1]+Ce[dt],Xe=1;Xe<dt;++Xe)Ht[Xe]-=st=zt[Xe]/Ht[Xe-1],Kt[Xe]-=st*Kt[Xe-1];for(zt[dt-1]=Kt[dt-1]/Ht[dt-1],Xe=dt-2;Xe>=0;--Xe)zt[Xe]=(Kt[Xe]-zt[Xe+1])/Ht[Xe];for(Ht[dt-1]=(Ce[dt]+zt[dt-1])/2,Xe=0;Xe<dt-1;++Xe)Ht[Xe]=2*Ce[Xe+1]-zt[Xe+1];return[zt,Ht]}function lt(Ce,Xe){this._context=Ce,this._t=Xe}function Lt(Ce,Xe){if((zt=Ce.length)>1)for(var st,dt,zt,Ht=1,Kt=Ce[Xe[0]],Zt=Kt.length;Ht<zt;++Ht)for(dt=Kt,Kt=Ce[Xe[Ht]],st=0;st<Zt;++st)Kt[st][1]+=Kt[st][0]=isNaN(dt[st][1])?dt[st][0]:dt[st][1]}function Ot(Ce){for(var Xe=Ce.length,st=new Array(Xe);--Xe>=0;)st[Xe]=Xe;return st}function ot(Ce,Xe){return Ce[Xe]}function pt(Ce){var Xe=Ce.map(qt);return Ot(Ce).sort(function(st,dt){return Xe[st]-Xe[dt]})}function qt(Ce){for(var Xe,st=-1,dt=0,zt=Ce.length,Ht=-1/0;++st<zt;)(Xe=+Ce[st][1])>Ht&&(Ht=Xe,dt=st);return dt}function St(Ce){var Xe=Ce.map(Mt);return Ot(Ce).sort(function(st,dt){return Xe[st]-Xe[dt]})}function Mt(Ce){for(var Xe,st=0,dt=-1,zt=Ce.length;++dt<zt;)(Xe=+Ce[dt][1])&&(st+=Xe);return st}Rt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ce,Xe){Ce=+Ce,Xe=+Xe,this._point?this._context.lineTo(Ce,Xe):(this._point=1,this._context.moveTo(Ce,Xe))}},Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:be(this,this._t0,he(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,Xe){var st=NaN;if(Xe=+Xe,(Ce=+Ce)!==this._x1||Xe!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,Xe):this._context.moveTo(Ce,Xe);break;case 1:this._point=2;break;case 2:this._point=3,be(this,he(this,st=Ye(this,Ce,Xe)),st);break;default:be(this,this._t0,st=Ye(this,Ce,Xe))}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=Xe,this._t0=st}}},(He.prototype=Object.create(Fe.prototype)).point=function(Ce,Xe){Fe.prototype.point.call(this,Xe,Ce)},Ke.prototype={moveTo:function(Ce,Xe){this._context.moveTo(Xe,Ce)},closePath:function(){this._context.closePath()},lineTo:function(Ce,Xe){this._context.lineTo(Xe,Ce)},bezierCurveTo:function(Ce,Xe,st,dt,zt,Ht){this._context.bezierCurveTo(Xe,Ce,dt,st,Ht,zt)}},Ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ce=this._x,Xe=this._y,st=Ce.length;if(st)if(this._line?this._context.lineTo(Ce[0],Xe[0]):this._context.moveTo(Ce[0],Xe[0]),2===st)this._context.lineTo(Ce[1],Xe[1]);else for(var dt=ut(Ce),zt=ut(Xe),Ht=0,Kt=1;Kt<st;++Ht,++Kt)this._context.bezierCurveTo(dt[0][Ht],zt[0][Ht],dt[1][Ht],zt[1][Ht],Ce[Kt],Xe[Kt]);(this._line||0!==this._line&&1===st)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ce,Xe){this._x.push(+Ce),this._y.push(+Xe)}},lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ce,Xe){switch(Ce=+Ce,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,Xe):this._context.moveTo(Ce,Xe);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Xe),this._context.lineTo(Ce,Xe);else{var st=this._x*(1-this._t)+Ce*this._t;this._context.lineTo(st,this._y),this._context.lineTo(st,Xe)}}this._x=Ce,this._y=Xe}},g.arc=function(){var Ce=d,Xe=u,st=k(0),dt=null,zt=a,Ht=y,Kt=h,Zt=null;function vn(){var zn,gn,nn=+Ce.apply(this,arguments),an=+Xe.apply(this,arguments),on=zt.apply(this,arguments)-s,mn=Ht.apply(this,arguments)-s,_n=x(mn-on),Pn=mn>on;if(Zt||(Zt=zn=t.path()),an<nn&&(gn=an,an=nn,nn=gn),an>1e-12)if(_n>f-1e-12)Zt.moveTo(an*r(on),an*n(on)),Zt.arc(0,0,an,on,mn,!Pn),nn>1e-12&&(Zt.moveTo(nn*r(mn),nn*n(mn)),Zt.arc(0,0,nn,mn,on,Pn));else{var Rn,qn,Xn=on,br=mn,fr=on,Vr=mn,cr=_n,Sr=_n,Cr=Kt.apply(this,arguments)/2,pi=Cr>1e-12&&(dt?+dt.apply(this,arguments):m(nn*nn+an*an)),Yn=c(x(an-nn)/2,+st.apply(this,arguments)),ar=Yn,Ar=Yn;if(pi>1e-12){var sr=o(pi/nn*n(Cr)),dr=o(pi/an*n(Cr));(cr-=2*sr)>1e-12?(fr+=sr*=Pn?1:-1,Vr-=sr):(cr=0,fr=Vr=(on+mn)/2),(Sr-=2*dr)>1e-12?(Xn+=dr*=Pn?1:-1,br-=dr):(Sr=0,Xn=br=(on+mn)/2)}var $r=an*r(Xn),Lr=an*n(Xn),jr=nn*r(Vr),ri=nn*n(Vr);if(Yn>1e-12){var sn,wn=an*r(br),It=an*n(br),hn=nn*r(fr),yn=nn*n(fr);if(_n<p&&(sn=_($r,Lr,hn,yn,wn,It,jr,ri))){var Hn=$r-sn[0],Un=Lr-sn[1],jn=wn-sn[0],On=It-sn[1],kn=1/n(l((Hn*jn+Un*On)/(m(Hn*Hn+Un*Un)*m(jn*jn+On*On)))/2),Mn=m(sn[0]*sn[0]+sn[1]*sn[1]);ar=c(Yn,(nn-Mn)/(kn-1)),Ar=c(Yn,(an-Mn)/(kn+1))}}Sr>1e-12?Ar>1e-12?(Rn=b(hn,yn,$r,Lr,an,Ar,Pn),qn=b(wn,It,jr,ri,an,Ar,Pn),Zt.moveTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),Ar<Yn?Zt.arc(Rn.cx,Rn.cy,Ar,e(Rn.y01,Rn.x01),e(qn.y01,qn.x01),!Pn):(Zt.arc(Rn.cx,Rn.cy,Ar,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!Pn),Zt.arc(0,0,an,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(qn.cy+qn.y11,qn.cx+qn.x11),!Pn),Zt.arc(qn.cx,qn.cy,Ar,e(qn.y11,qn.x11),e(qn.y01,qn.x01),!Pn))):(Zt.moveTo($r,Lr),Zt.arc(0,0,an,Xn,br,!Pn)):Zt.moveTo($r,Lr),nn>1e-12&&cr>1e-12?ar>1e-12?(Rn=b(jr,ri,wn,It,nn,-ar,Pn),qn=b($r,Lr,hn,yn,nn,-ar,Pn),Zt.lineTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ar<Yn?Zt.arc(Rn.cx,Rn.cy,ar,e(Rn.y01,Rn.x01),e(qn.y01,qn.x01),!Pn):(Zt.arc(Rn.cx,Rn.cy,ar,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!Pn),Zt.arc(0,0,nn,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(qn.cy+qn.y11,qn.cx+qn.x11),Pn),Zt.arc(qn.cx,qn.cy,ar,e(qn.y11,qn.x11),e(qn.y01,qn.x01),!Pn))):Zt.arc(0,0,nn,Vr,fr,Pn):Zt.lineTo(jr,ri)}else Zt.moveTo(0,0);if(Zt.closePath(),zn)return Zt=null,zn+""||null}return vn.centroid=function(){var zn=(+Ce.apply(this,arguments)+ +Xe.apply(this,arguments))/2,gn=(+zt.apply(this,arguments)+ +Ht.apply(this,arguments))/2-p/2;return[r(gn)*zn,n(gn)*zn]},vn.innerRadius=function(zn){return arguments.length?(Ce="function"==typeof zn?zn:k(+zn),vn):Ce},vn.outerRadius=function(zn){return arguments.length?(Xe="function"==typeof zn?zn:k(+zn),vn):Xe},vn.cornerRadius=function(zn){return arguments.length?(st="function"==typeof zn?zn:k(+zn),vn):st},vn.padRadius=function(zn){return arguments.length?(dt=null==zn?null:"function"==typeof zn?zn:k(+zn),vn):dt},vn.startAngle=function(zn){return arguments.length?(zt="function"==typeof zn?zn:k(+zn),vn):zt},vn.endAngle=function(zn){return arguments.length?(Ht="function"==typeof zn?zn:k(+zn),vn):Ht},vn.padAngle=function(zn){return arguments.length?(Kt="function"==typeof zn?zn:k(+zn),vn):Kt},vn.context=function(zn){return arguments.length?(Zt=null==zn?null:zn,vn):Zt},vn},g.area=z,g.areaRadial=W,g.curveBasis=function(Ce){return new Ie(Ce)},g.curveBasisClosed=function(Ce){return new Qe(Ce)},g.curveBasisOpen=function(Ce){return new Ne(Ce)},g.curveBundle=Re,g.curveCardinal=ct,g.curveCardinalClosed=kt,g.curveCardinalOpen=at,g.curveCatmullRom=Vt,g.curveCatmullRomClosed=en,g.curveCatmullRomOpen=cn,g.curveLinear=T,g.curveLinearClosed=function(Ce){return new Rt(Ce)},g.curveMonotoneX=function(Ce){return new Fe(Ce)},g.curveMonotoneY=function(Ce){return new He(Ce)},g.curveNatural=function(Ce){return new Ze(Ce)},g.curveStep=function(Ce){return new lt(Ce,.5)},g.curveStepAfter=function(Ce){return new lt(Ce,1)},g.curveStepBefore=function(Ce){return new lt(Ce,0)},g.line=P,g.lineRadial=Z,g.linkHorizontal=function(){return N(U)},g.linkRadial=function(){var Ce=N(B);return Ce.angle=Ce.x,delete Ce.x,Ce.radius=Ce.y,delete Ce.y,Ce},g.linkVertical=function(){return N(ee)},g.pie=function(){var Ce=C,Xe=S,st=null,dt=k(0),zt=k(f),Ht=k(0);function Kt(Zt){var vn,zn,gn,nn,an,on=Zt.length,mn=0,_n=new Array(on),Pn=new Array(on),Rn=+dt.apply(this,arguments),qn=Math.min(f,Math.max(-f,zt.apply(this,arguments)-Rn)),Xn=Math.min(Math.abs(qn)/on,Ht.apply(this,arguments)),br=Xn*(qn<0?-1:1);for(vn=0;vn<on;++vn)(an=Pn[_n[vn]=vn]=+Ce(Zt[vn],vn,Zt))>0&&(mn+=an);for(null!=Xe?_n.sort(function(fr,Vr){return Xe(Pn[fr],Pn[Vr])}):null!=st&&_n.sort(function(fr,Vr){return st(Zt[fr],Zt[Vr])}),vn=0,gn=mn?(qn-on*br)/mn:0;vn<on;++vn,Rn=nn)nn=Rn+((an=Pn[zn=_n[vn]])>0?an*gn:0)+br,Pn[zn]={data:Zt[zn],index:vn,value:an,startAngle:Rn,endAngle:nn,padAngle:Xn};return Pn}return Kt.value=function(Zt){return arguments.length?(Ce="function"==typeof Zt?Zt:k(+Zt),Kt):Ce},Kt.sortValues=function(Zt){return arguments.length?(Xe=Zt,st=null,Kt):Xe},Kt.sort=function(Zt){return arguments.length?(st=Zt,Xe=null,Kt):st},Kt.startAngle=function(Zt){return arguments.length?(dt="function"==typeof Zt?Zt:k(+Zt),Kt):dt},Kt.endAngle=function(Zt){return arguments.length?(zt="function"==typeof Zt?Zt:k(+Zt),Kt):zt},Kt.padAngle=function(Zt){return arguments.length?(Ht="function"==typeof Zt?Zt:k(+Zt),Kt):Ht},Kt},g.pointRadial=G,g.radialArea=W,g.radialLine=Z,g.stack=function(){var Ce=k([]),Xe=Ot,st=Lt,dt=ot;function zt(Ht){var Kt,Zt,vn=Ce.apply(this,arguments),zn=Ht.length,gn=vn.length,nn=new Array(gn);for(Kt=0;Kt<gn;++Kt){for(var an,on=vn[Kt],mn=nn[Kt]=new Array(zn),_n=0;_n<zn;++_n)mn[_n]=an=[0,+dt(Ht[_n],on,_n,Ht)],an.data=Ht[_n];mn.key=on}for(Kt=0,Zt=Xe(nn);Kt<gn;++Kt)nn[Zt[Kt]].index=Kt;return st(nn,Zt),nn}return zt.keys=function(Ht){return arguments.length?(Ce="function"==typeof Ht?Ht:k(X.call(Ht)),zt):Ce},zt.value=function(Ht){return arguments.length?(dt="function"==typeof Ht?Ht:k(+Ht),zt):dt},zt.order=function(Ht){return arguments.length?(Xe=null==Ht?Ot:"function"==typeof Ht?Ht:k(X.call(Ht)),zt):Xe},zt.offset=function(Ht){return arguments.length?(st=null==Ht?Lt:Ht,zt):st},zt},g.stackOffsetDiverging=function(Ce,Xe){if((Zt=Ce.length)>0)for(var st,dt,zt,Ht,Kt,Zt,vn=0,zn=Ce[Xe[0]].length;vn<zn;++vn)for(Ht=Kt=0,st=0;st<Zt;++st)(zt=(dt=Ce[Xe[st]][vn])[1]-dt[0])>0?(dt[0]=Ht,dt[1]=Ht+=zt):zt<0?(dt[1]=Kt,dt[0]=Kt+=zt):(dt[0]=0,dt[1]=zt)},g.stackOffsetExpand=function(Ce,Xe){if((dt=Ce.length)>0){for(var st,dt,zt,Ht=0,Kt=Ce[0].length;Ht<Kt;++Ht){for(zt=st=0;st<dt;++st)zt+=Ce[st][Ht][1]||0;if(zt)for(st=0;st<dt;++st)Ce[st][Ht][1]/=zt}Lt(Ce,Xe)}},g.stackOffsetNone=Lt,g.stackOffsetSilhouette=function(Ce,Xe){if((st=Ce.length)>0){for(var st,dt=0,zt=Ce[Xe[0]],Ht=zt.length;dt<Ht;++dt){for(var Kt=0,Zt=0;Kt<st;++Kt)Zt+=Ce[Kt][dt][1]||0;zt[dt][1]+=zt[dt][0]=-Zt/2}Lt(Ce,Xe)}},g.stackOffsetWiggle=function(Ce,Xe){if((zt=Ce.length)>0&&(dt=(st=Ce[Xe[0]]).length)>0){for(var st,dt,zt,Ht=0,Kt=1;Kt<dt;++Kt){for(var Zt=0,vn=0,zn=0;Zt<zt;++Zt){for(var gn=Ce[Xe[Zt]],nn=gn[Kt][1]||0,an=(nn-(gn[Kt-1][1]||0))/2,on=0;on<Zt;++on){var mn=Ce[Xe[on]];an+=(mn[Kt][1]||0)-(mn[Kt-1][1]||0)}vn+=nn,zn+=an*nn}st[Kt-1][1]+=st[Kt-1][0]=Ht,vn&&(Ht-=zn/vn)}st[Kt-1][1]+=st[Kt-1][0]=Ht,Lt(Ce,Xe)}},g.stackOrderAppearance=pt,g.stackOrderAscending=St,g.stackOrderDescending=function(Ce){return St(Ce).reverse()},g.stackOrderInsideOut=function(Ce){var Xe,st,dt=Ce.length,zt=Ce.map(Mt),Ht=pt(Ce),Kt=0,Zt=0,vn=[],zn=[];for(Xe=0;Xe<dt;++Xe)st=Ht[Xe],Kt<Zt?(Kt+=zt[st],vn.push(st)):(Zt+=zt[st],zn.push(st));return zn.reverse().concat(vn)},g.stackOrderNone=Ot,g.stackOrderReverse=function(Ce){return Ot(Ce).reverse()},g.symbol=function(){var Ce=k(K),Xe=k(64),st=null;function dt(){var zt;if(st||(st=zt=t.path()),Ce.apply(this,arguments).draw(st,+Xe.apply(this,arguments)),zt)return st=null,zt+""||null}return dt.type=function(zt){return arguments.length?(Ce="function"==typeof zt?zt:k(zt),dt):Ce},dt.size=function(zt){return arguments.length?(Xe="function"==typeof zt?zt:k(+zt),dt):Xe},dt.context=function(zt){return arguments.length?(st=null==zt?null:zt,dt):st},dt},g.symbolCircle=K,g.symbolCross=J,g.symbolDiamond=ce,g.symbolSquare=Se,g.symbolStar=xe,g.symbolTriangle=ge,g.symbolWye=Le,g.symbols=Me,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-path")):t((g=g||self).d3=g.d3||{},g.d3)},{"d3-path":117}],120:[function(v,Q,$){var g,t;g=this,t=function(g,t){"use strict";function k(at){if(0<=at.y&&at.y<100){var et=new Date(-1,at.m,at.d,at.H,at.M,at.S,at.L);return et.setFullYear(at.y),et}return new Date(at.y,at.m,at.d,at.H,at.M,at.S,at.L)}function x(at){if(0<=at.y&&at.y<100){var et=new Date(Date.UTC(-1,at.m,at.d,at.H,at.M,at.S,at.L));return et.setUTCFullYear(at.y),et}return new Date(Date.UTC(at.y,at.m,at.d,at.H,at.M,at.S,at.L))}function e(at,et,yt){return{y:at,m:et,d:yt,H:0,M:0,S:0,L:0}}function r(at){var et=at.dateTime,yt=at.date,Vt=at.time,Gt=at.periods,en=at.days,Jt=at.shortDays,cn=at.months,Rt=at.shortMonths,je=l(Gt),Ye=o(Gt),he=l(en),be=o(en),Fe=l(Jt),He=o(Jt),Ke=l(cn),Ze=o(cn),ut=l(Rt),lt=o(Rt),Lt={a:function(Mt){return Jt[Mt.getDay()]},A:function(Mt){return en[Mt.getDay()]},b:function(Mt){return Rt[Mt.getMonth()]},B:function(Mt){return cn[Mt.getMonth()]},c:null,d:W,e:W,f:N,H:G,I:X,j:ne,L:V,m:U,M:ee,p:function(Mt){return Gt[+(Mt.getHours()>=12)]},q:function(Mt){return 1+~~(Mt.getMonth()/3)},Q:tt,s:ct,S:B,u:K,U:J,V:te,w:ae,W:ce,x:null,X:null,y:oe,Y:ve,Z:fe,"%":Ge},Ot={a:function(Mt){return Jt[Mt.getUTCDay()]},A:function(Mt){return en[Mt.getUTCDay()]},b:function(Mt){return Rt[Mt.getUTCMonth()]},B:function(Mt){return cn[Mt.getUTCMonth()]},c:null,d:xe,e:xe,f:se,H:Se,I:pe,j:ge,L:Te,m:de,M:Ae,p:function(Mt){return Gt[+(Mt.getUTCHours()>=12)]},q:function(Mt){return 1+~~(Mt.getUTCMonth()/3)},Q:tt,s:ct,S:Le,u:Me,U:De,V:Oe,w:Ie,W:Qe,x:null,X:null,y:Ne,Y:Pe,Z:Re,"%":Ge},ot={a:function(Mt,Ce,Xe){var st=Fe.exec(Ce.slice(Xe));return st?(Mt.w=He[st[0].toLowerCase()],Xe+st[0].length):-1},A:function(Mt,Ce,Xe){var st=he.exec(Ce.slice(Xe));return st?(Mt.w=be[st[0].toLowerCase()],Xe+st[0].length):-1},b:function(Mt,Ce,Xe){var st=ut.exec(Ce.slice(Xe));return st?(Mt.m=lt[st[0].toLowerCase()],Xe+st[0].length):-1},B:function(Mt,Ce,Xe){var st=Ke.exec(Ce.slice(Xe));return st?(Mt.m=Ze[st[0].toLowerCase()],Xe+st[0].length):-1},c:function(Mt,Ce,Xe){return St(Mt,et,Ce,Xe)},d:M,e:M,f:D,H:z,I:z,j:P,L:R,m:L,M:S,p:function(Mt,Ce,Xe){var st=je.exec(Ce.slice(Xe));return st?(Mt.p=Ye[st[0].toLowerCase()],Xe+st[0].length):-1},q:T,Q:q,s:Z,S:C,u,U:a,V:y,w:d,W:h,x:function(Mt,Ce,Xe){return St(Mt,yt,Ce,Xe)},X:function(Mt,Ce,Xe){return St(Mt,Vt,Ce,Xe)},y:b,Y:_,Z:w,"%":j};function pt(Mt,Ce){return function(Xe){var st,dt,zt,Ht=[],Kt=-1,Zt=0,vn=Mt.length;for(Xe instanceof Date||(Xe=new Date(+Xe));++Kt<vn;)37===Mt.charCodeAt(Kt)&&(Ht.push(Mt.slice(Zt,Kt)),null!=(dt=c[st=Mt.charAt(++Kt)])?st=Mt.charAt(++Kt):dt="e"===st?" ":"0",(zt=Ce[st])&&(st=zt(Xe,dt)),Ht.push(st),Zt=Kt+1);return Ht.push(Mt.slice(Zt,Kt)),Ht.join("")}}function qt(Mt,Ce){return function(Xe){var st,dt,zt=e(1900,void 0,1);if(St(zt,Mt,Xe+="",0)!=Xe.length)return null;if("Q"in zt)return new Date(zt.Q);if("s"in zt)return new Date(1e3*zt.s+("L"in zt?zt.L:0));if(Ce&&!("Z"in zt)&&(zt.Z=0),"p"in zt&&(zt.H=zt.H%12+12*zt.p),void 0===zt.m&&(zt.m="q"in zt?zt.q:0),"V"in zt){if(zt.V<1||zt.V>53)return null;"w"in zt||(zt.w=1),"Z"in zt?(dt=(st=x(e(zt.y,0,1))).getUTCDay(),st=dt>4||0===dt?t.utcMonday.ceil(st):t.utcMonday(st),st=t.utcDay.offset(st,7*(zt.V-1)),zt.y=st.getUTCFullYear(),zt.m=st.getUTCMonth(),zt.d=st.getUTCDate()+(zt.w+6)%7):(dt=(st=k(e(zt.y,0,1))).getDay(),st=dt>4||0===dt?t.timeMonday.ceil(st):t.timeMonday(st),st=t.timeDay.offset(st,7*(zt.V-1)),zt.y=st.getFullYear(),zt.m=st.getMonth(),zt.d=st.getDate()+(zt.w+6)%7)}else("W"in zt||"U"in zt)&&("w"in zt||(zt.w="u"in zt?zt.u%7:"W"in zt?1:0),dt="Z"in zt?x(e(zt.y,0,1)).getUTCDay():k(e(zt.y,0,1)).getDay(),zt.m=0,zt.d="W"in zt?(zt.w+6)%7+7*zt.W-(dt+5)%7:zt.w+7*zt.U-(dt+6)%7);return"Z"in zt?(zt.H+=zt.Z/100|0,zt.M+=zt.Z%100,x(zt)):k(zt)}}function St(Mt,Ce,Xe,st){for(var dt,zt,Ht=0,Kt=Ce.length,Zt=Xe.length;Ht<Kt;){if(st>=Zt)return-1;if(37===(dt=Ce.charCodeAt(Ht++))){if(dt=Ce.charAt(Ht++),!(zt=ot[dt in c?Ce.charAt(Ht++):dt])||(st=zt(Mt,Xe,st))<0)return-1}else if(dt!=Xe.charCodeAt(st++))return-1}return st}return Lt.x=pt(yt,Lt),Lt.X=pt(Vt,Lt),Lt.c=pt(et,Lt),Ot.x=pt(yt,Ot),Ot.X=pt(Vt,Ot),Ot.c=pt(et,Ot),{format:function(Mt){var Ce=pt(Mt+="",Lt);return Ce.toString=function(){return Mt},Ce},parse:function(Mt){var Ce=qt(Mt+="",!1);return Ce.toString=function(){return Mt},Ce},utcFormat:function(Mt){var Ce=pt(Mt+="",Ot);return Ce.toString=function(){return Mt},Ce},utcParse:function(Mt){var Ce=qt(Mt+="",!0);return Ce.toString=function(){return Mt},Ce}}}var i,c={"-":"",_:" ",0:"0"},n=/^\s*\d+/,m=/^%/,p=/[\\^$*+?|[\]().{}]/g;function s(at,et,yt){var Vt=at<0?"-":"",Gt=(Vt?-at:at)+"",en=Gt.length;return Vt+(en<yt?new Array(yt-en+1).join(et)+Gt:Gt)}function f(at){return at.replace(p,"\\$&")}function l(at){return new RegExp("^(?:"+at.map(f).join("|")+")","i")}function o(at){for(var et={},yt=-1,Vt=at.length;++yt<Vt;)et[at[yt].toLowerCase()]=yt;return et}function d(at,et,yt){var Vt=n.exec(et.slice(yt,yt+1));return Vt?(at.w=+Vt[0],yt+Vt[0].length):-1}function u(at,et,yt){var Vt=n.exec(et.slice(yt,yt+1));return Vt?(at.u=+Vt[0],yt+Vt[0].length):-1}function a(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.U=+Vt[0],yt+Vt[0].length):-1}function y(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.V=+Vt[0],yt+Vt[0].length):-1}function h(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.W=+Vt[0],yt+Vt[0].length):-1}function _(at,et,yt){var Vt=n.exec(et.slice(yt,yt+4));return Vt?(at.y=+Vt[0],yt+Vt[0].length):-1}function b(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.y=+Vt[0]+(+Vt[0]>68?1900:2e3),yt+Vt[0].length):-1}function w(at,et,yt){var Vt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(et.slice(yt,yt+6));return Vt?(at.Z=Vt[1]?0:-(Vt[2]+(Vt[3]||"00")),yt+Vt[0].length):-1}function T(at,et,yt){var Vt=n.exec(et.slice(yt,yt+1));return Vt?(at.q=3*Vt[0]-3,yt+Vt[0].length):-1}function L(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.m=Vt[0]-1,yt+Vt[0].length):-1}function M(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.d=+Vt[0],yt+Vt[0].length):-1}function P(at,et,yt){var Vt=n.exec(et.slice(yt,yt+3));return Vt?(at.m=0,at.d=+Vt[0],yt+Vt[0].length):-1}function z(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.H=+Vt[0],yt+Vt[0].length):-1}function S(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.M=+Vt[0],yt+Vt[0].length):-1}function C(at,et,yt){var Vt=n.exec(et.slice(yt,yt+2));return Vt?(at.S=+Vt[0],yt+Vt[0].length):-1}function R(at,et,yt){var Vt=n.exec(et.slice(yt,yt+3));return Vt?(at.L=+Vt[0],yt+Vt[0].length):-1}function D(at,et,yt){var Vt=n.exec(et.slice(yt,yt+6));return Vt?(at.L=Math.floor(Vt[0]/1e3),yt+Vt[0].length):-1}function j(at,et,yt){var Vt=m.exec(et.slice(yt,yt+1));return Vt?yt+Vt[0].length:-1}function q(at,et,yt){var Vt=n.exec(et.slice(yt));return Vt?(at.Q=+Vt[0],yt+Vt[0].length):-1}function Z(at,et,yt){var Vt=n.exec(et.slice(yt));return Vt?(at.s=+Vt[0],yt+Vt[0].length):-1}function W(at,et){return s(at.getDate(),et,2)}function G(at,et){return s(at.getHours(),et,2)}function X(at,et){return s(at.getHours()%12||12,et,2)}function ne(at,et){return s(1+t.timeDay.count(t.timeYear(at),at),et,3)}function V(at,et){return s(at.getMilliseconds(),et,3)}function N(at,et){return V(at,et)+"000"}function U(at,et){return s(at.getMonth()+1,et,2)}function ee(at,et){return s(at.getMinutes(),et,2)}function B(at,et){return s(at.getSeconds(),et,2)}function K(at){var et=at.getDay();return 0===et?7:et}function J(at,et){return s(t.timeSunday.count(t.timeYear(at)-1,at),et,2)}function te(at,et){var yt=at.getDay();return at=yt>=4||0===yt?t.timeThursday(at):t.timeThursday.ceil(at),s(t.timeThursday.count(t.timeYear(at),at)+(4===t.timeYear(at).getDay()),et,2)}function ae(at){return at.getDay()}function ce(at,et){return s(t.timeMonday.count(t.timeYear(at)-1,at),et,2)}function oe(at,et){return s(at.getFullYear()%100,et,2)}function ve(at,et){return s(at.getFullYear()%1e4,et,4)}function fe(at){var et=at.getTimezoneOffset();return(et>0?"-":(et*=-1,"+"))+s(et/60|0,"0",2)+s(et%60,"0",2)}function xe(at,et){return s(at.getUTCDate(),et,2)}function Se(at,et){return s(at.getUTCHours(),et,2)}function pe(at,et){return s(at.getUTCHours()%12||12,et,2)}function ge(at,et){return s(1+t.utcDay.count(t.utcYear(at),at),et,3)}function Te(at,et){return s(at.getUTCMilliseconds(),et,3)}function se(at,et){return Te(at,et)+"000"}function de(at,et){return s(at.getUTCMonth()+1,et,2)}function Ae(at,et){return s(at.getUTCMinutes(),et,2)}function Le(at,et){return s(at.getUTCSeconds(),et,2)}function Me(at){var et=at.getUTCDay();return 0===et?7:et}function De(at,et){return s(t.utcSunday.count(t.utcYear(at)-1,at),et,2)}function Oe(at,et){var yt=at.getUTCDay();return at=yt>=4||0===yt?t.utcThursday(at):t.utcThursday.ceil(at),s(t.utcThursday.count(t.utcYear(at),at)+(4===t.utcYear(at).getUTCDay()),et,2)}function Ie(at){return at.getUTCDay()}function Qe(at,et){return s(t.utcMonday.count(t.utcYear(at)-1,at),et,2)}function Ne(at,et){return s(at.getUTCFullYear()%100,et,2)}function Pe(at,et){return s(at.getUTCFullYear()%1e4,et,4)}function Re(){return"+0000"}function Ge(){return"%"}function tt(at){return+at}function ct(at){return Math.floor(+at/1e3)}function wt(at){return i=r(at),g.timeFormat=i.format,g.timeParse=i.parse,g.utcFormat=i.utcFormat,g.utcParse=i.utcParse,i}wt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var kt=Date.prototype.toISOString?function(at){return at.toISOString()}:g.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),gt=+new Date("2000-01-01T00:00:00.000Z")?function(at){var et=new Date(at);return isNaN(et)?null:et}:g.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");g.isoFormat=kt,g.isoParse=gt,g.timeFormatDefaultLocale=wt,g.timeFormatLocale=r,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof $&&void 0!==Q?t($,v("d3-time")):t((g=g||self).d3=g.d3||{},g.d3)},{"d3-time":121}],121:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";var t=new Date,k=new Date;function x(de,Ae,Le,Me){function De(Oe){return de(Oe=0===arguments.length?new Date:new Date(+Oe)),Oe}return De.floor=function(Oe){return de(Oe=new Date(+Oe)),Oe},De.ceil=function(Oe){return de(Oe=new Date(Oe-1)),Ae(Oe,1),de(Oe),Oe},De.round=function(Oe){var Ie=De(Oe),Qe=De.ceil(Oe);return Oe-Ie<Qe-Oe?Ie:Qe},De.offset=function(Oe,Ie){return Ae(Oe=new Date(+Oe),null==Ie?1:Math.floor(Ie)),Oe},De.range=function(Oe,Ie,Qe){var Ne,Pe=[];if(Oe=De.ceil(Oe),Qe=null==Qe?1:Math.floor(Qe),!(Oe<Ie&&Qe>0))return Pe;do{Pe.push(Ne=new Date(+Oe)),Ae(Oe,Qe),de(Oe)}while(Ne<Oe&&Oe<Ie);return Pe},De.filter=function(Oe){return x(function(Ie){if(Ie>=Ie)for(;de(Ie),!Oe(Ie);)Ie.setTime(Ie-1)},function(Ie,Qe){if(Ie>=Ie)if(Qe<0)for(;++Qe<=0;)for(;Ae(Ie,-1),!Oe(Ie););else for(;--Qe>=0;)for(;Ae(Ie,1),!Oe(Ie););})},Le&&(De.count=function(Oe,Ie){return t.setTime(+Oe),k.setTime(+Ie),de(t),de(k),Math.floor(Le(t,k))},De.every=function(Oe){return Oe=Math.floor(Oe),isFinite(Oe)&&Oe>0?Oe>1?De.filter(Me?function(Ie){return Me(Ie)%Oe==0}:function(Ie){return De.count(0,Ie)%Oe==0}):De:null}),De}var e=x(function(){},function(de,Ae){de.setTime(+de+Ae)},function(de,Ae){return Ae-de});e.every=function(de){return de=Math.floor(de),isFinite(de)&&de>0?de>1?x(function(Ae){Ae.setTime(Math.floor(Ae/de)*de)},function(Ae,Le){Ae.setTime(+Ae+Le*de)},function(Ae,Le){return(Le-Ae)/de}):e:null};var r=e.range,i=x(function(de){de.setTime(de-de.getMilliseconds())},function(de,Ae){de.setTime(+de+1e3*Ae)},function(de,Ae){return(Ae-de)/1e3},function(de){return de.getUTCSeconds()}),c=i.range,n=x(function(de){de.setTime(de-de.getMilliseconds()-1e3*de.getSeconds())},function(de,Ae){de.setTime(+de+6e4*Ae)},function(de,Ae){return(Ae-de)/6e4},function(de){return de.getMinutes()}),m=n.range,p=x(function(de){de.setTime(de-de.getMilliseconds()-1e3*de.getSeconds()-6e4*de.getMinutes())},function(de,Ae){de.setTime(+de+36e5*Ae)},function(de,Ae){return(Ae-de)/36e5},function(de){return de.getHours()}),s=p.range,f=x(function(de){de.setHours(0,0,0,0)},function(de,Ae){de.setDate(de.getDate()+Ae)},function(de,Ae){return(Ae-de-6e4*(Ae.getTimezoneOffset()-de.getTimezoneOffset()))/864e5},function(de){return de.getDate()-1}),l=f.range;function o(de){return x(function(Ae){Ae.setDate(Ae.getDate()-(Ae.getDay()+7-de)%7),Ae.setHours(0,0,0,0)},function(Ae,Le){Ae.setDate(Ae.getDate()+7*Le)},function(Ae,Le){return(Le-Ae-6e4*(Le.getTimezoneOffset()-Ae.getTimezoneOffset()))/6048e5})}var d=o(0),u=o(1),a=o(2),y=o(3),h=o(4),_=o(5),b=o(6),w=d.range,T=u.range,L=a.range,M=y.range,P=h.range,z=_.range,S=b.range,C=x(function(de){de.setDate(1),de.setHours(0,0,0,0)},function(de,Ae){de.setMonth(de.getMonth()+Ae)},function(de,Ae){return Ae.getMonth()-de.getMonth()+12*(Ae.getFullYear()-de.getFullYear())},function(de){return de.getMonth()}),R=C.range,D=x(function(de){de.setMonth(0,1),de.setHours(0,0,0,0)},function(de,Ae){de.setFullYear(de.getFullYear()+Ae)},function(de,Ae){return Ae.getFullYear()-de.getFullYear()},function(de){return de.getFullYear()});D.every=function(de){return isFinite(de=Math.floor(de))&&de>0?x(function(Ae){Ae.setFullYear(Math.floor(Ae.getFullYear()/de)*de),Ae.setMonth(0,1),Ae.setHours(0,0,0,0)},function(Ae,Le){Ae.setFullYear(Ae.getFullYear()+Le*de)}):null};var j=D.range,q=x(function(de){de.setUTCSeconds(0,0)},function(de,Ae){de.setTime(+de+6e4*Ae)},function(de,Ae){return(Ae-de)/6e4},function(de){return de.getUTCMinutes()}),Z=q.range,W=x(function(de){de.setUTCMinutes(0,0,0)},function(de,Ae){de.setTime(+de+36e5*Ae)},function(de,Ae){return(Ae-de)/36e5},function(de){return de.getUTCHours()}),G=W.range,X=x(function(de){de.setUTCHours(0,0,0,0)},function(de,Ae){de.setUTCDate(de.getUTCDate()+Ae)},function(de,Ae){return(Ae-de)/864e5},function(de){return de.getUTCDate()-1}),ne=X.range;function V(de){return x(function(Ae){Ae.setUTCDate(Ae.getUTCDate()-(Ae.getUTCDay()+7-de)%7),Ae.setUTCHours(0,0,0,0)},function(Ae,Le){Ae.setUTCDate(Ae.getUTCDate()+7*Le)},function(Ae,Le){return(Le-Ae)/6048e5})}var N=V(0),U=V(1),ee=V(2),B=V(3),K=V(4),J=V(5),te=V(6),ae=N.range,ce=U.range,oe=ee.range,ve=B.range,fe=K.range,xe=J.range,Se=te.range,pe=x(function(de){de.setUTCDate(1),de.setUTCHours(0,0,0,0)},function(de,Ae){de.setUTCMonth(de.getUTCMonth()+Ae)},function(de,Ae){return Ae.getUTCMonth()-de.getUTCMonth()+12*(Ae.getUTCFullYear()-de.getUTCFullYear())},function(de){return de.getUTCMonth()}),ge=pe.range,Te=x(function(de){de.setUTCMonth(0,1),de.setUTCHours(0,0,0,0)},function(de,Ae){de.setUTCFullYear(de.getUTCFullYear()+Ae)},function(de,Ae){return Ae.getUTCFullYear()-de.getUTCFullYear()},function(de){return de.getUTCFullYear()});Te.every=function(de){return isFinite(de=Math.floor(de))&&de>0?x(function(Ae){Ae.setUTCFullYear(Math.floor(Ae.getUTCFullYear()/de)*de),Ae.setUTCMonth(0,1),Ae.setUTCHours(0,0,0,0)},function(Ae,Le){Ae.setUTCFullYear(Ae.getUTCFullYear()+Le*de)}):null};var se=Te.range;g.timeDay=f,g.timeDays=l,g.timeFriday=_,g.timeFridays=z,g.timeHour=p,g.timeHours=s,g.timeInterval=x,g.timeMillisecond=e,g.timeMilliseconds=r,g.timeMinute=n,g.timeMinutes=m,g.timeMonday=u,g.timeMondays=T,g.timeMonth=C,g.timeMonths=R,g.timeSaturday=b,g.timeSaturdays=S,g.timeSecond=i,g.timeSeconds=c,g.timeSunday=d,g.timeSundays=w,g.timeThursday=h,g.timeThursdays=P,g.timeTuesday=a,g.timeTuesdays=L,g.timeWednesday=y,g.timeWednesdays=M,g.timeWeek=d,g.timeWeeks=w,g.timeYear=D,g.timeYears=j,g.utcDay=X,g.utcDays=ne,g.utcFriday=J,g.utcFridays=xe,g.utcHour=W,g.utcHours=G,g.utcMillisecond=e,g.utcMilliseconds=r,g.utcMinute=q,g.utcMinutes=Z,g.utcMonday=U,g.utcMondays=ce,g.utcMonth=pe,g.utcMonths=ge,g.utcSaturday=te,g.utcSaturdays=Se,g.utcSecond=i,g.utcSeconds=c,g.utcSunday=N,g.utcSundays=ae,g.utcThursday=K,g.utcThursdays=fe,g.utcTuesday=ee,g.utcTuesdays=oe,g.utcWednesday=B,g.utcWednesdays=ve,g.utcWeek=N,g.utcWeeks=ae,g.utcYear=Te,g.utcYears=se,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],122:[function(v,Q,$){arguments[4][121][0].apply($,arguments)},{dup:121}],123:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";var t,k,x=0,e=0,r=0,i=0,c=0,n=0,m="object"==typeof performance&&performance.now?performance:Date,p="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(h){setTimeout(h,17)};function s(){return c||(p(f),c=m.now()+n)}function f(){c=0}function l(){this._call=this._time=this._next=null}function o(h,_,b){var w=new l;return w.restart(h,_,b),w}function d(){s(),++x;for(var h,_=t;_;)(h=c-_._time)>=0&&_._call.call(null,h),_=_._next;--x}function u(){c=(i=m.now())+n,x=e=0;try{d()}finally{x=0,function(){for(var h,_,b=t,w=1/0;b;)b._call?(w>b._time&&(w=b._time),h=b,b=b._next):(_=b._next,b._next=null,b=h?h._next=_:t=_);k=h,y(w)}(),c=0}}function a(){var h=m.now(),_=h-i;_>1e3&&(n-=_,i=h)}function y(h){x||(e&&(e=clearTimeout(e)),h-c>24?(h<1/0&&(e=setTimeout(u,h-m.now()-n)),r&&(r=clearInterval(r))):(r||(i=m.now(),r=setInterval(a,1e3)),x=1,p(u)))}l.prototype=o.prototype={constructor:l,restart:function(h,_,b){if("function"!=typeof h)throw new TypeError("callback is not a function");b=(null==b?s():+b)+(null==_?0:+_),this._next||k===this||(k?k._next=this:t=this,k=this),this._call=h,this._time=b,y()},stop:function(){this._call&&(this._call=null,this._time=1/0,y())}},g.interval=function(h,_,b){var w=new l,T=_;return null==_?(w.restart(h,_,b),w):(_=+_,b=null==b?s():+b,w.restart(function L(M){M+=T,w.restart(L,T+=_,b),h(M)},_,b),w)},g.now=s,g.timeout=function(h,_,b){var w=new l;return w.restart(function(T){w.stop(),h(T+_)},_=null==_?0:+_,b),w},g.timer=o,g.timerFlush=d,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).d3=g.d3||{})},{}],124:[function(v,Q,$){Q.exports=function(){for(var g=0;g<arguments.length;g++)if(void 0!==arguments[g])return arguments[g]}},{}],125:[function(v,Q,$){"use strict";Q.exports=k;var g=(k.canvas=document.createElement("canvas")).getContext("2d"),t=x([32,126]);function k(e,r){Array.isArray(e)&&(e=e.join(", "));var i,c={},n=16,m=.05;r&&(2===r.length&&"number"==typeof r[0]?i=x(r):Array.isArray(r)?i=r:(r.o?i=x(r.o):r.pairs&&(i=r.pairs),r.fontSize&&(n=r.fontSize),null!=r.threshold&&(m=r.threshold))),i||(i=t),g.font=n+"px "+e;for(var p=0;p<i.length;p++){var s=i[p],f=g.measureText(s[0]).width+g.measureText(s[1]).width,l=g.measureText(s).width;Math.abs(f-l)>n*m&&(c[s]=(l-f)/n*1e3)}return c}function x(e){for(var r=[],i=e[0];i<=e[1];i++)for(var c=String.fromCharCode(i),n=e[0];n<e[1];n++){var m=c+String.fromCharCode(n);r.push(m)}return r}k.createPairs=x,k.ascii=t},{}],126:[function(v,Q,$){var g=v("abs-svg-path"),t=v("normalize-svg-path"),k={M:"moveTo",C:"bezierCurveTo"};Q.exports=function(x,e){x.beginPath(),t(g(e)).forEach(function(r){var i=r[0],c=r.slice(1);x[k[i]].apply(x,c)}),x.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(v,Q,$){Q.exports=function(g){switch(g){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(v,Q,$){"use strict";Q.exports=function(g,t){switch(void 0===t&&(t=0),typeof g){case"number":if(g>0)return function(k,x){var e,r;for(e=new Array(k),r=0;r<k;++r)e[r]=x;return e}(0|g,t);break;case"object":if("number"==typeof g.length)return function k(x,e,r){var i=0|x[r];if(i<=0)return[];var c,n=new Array(i);if(r===x.length-1)for(c=0;c<i;++c)n[c]=e;else for(c=0;c<i;++c)n[c]=k(x,e,r+1);return n}(g,t,0)}return[]}},{}],129:[function(v,Q,$){"use strict";function g(P,z,S){S=S||2;var C,R,D,j,q,Z,W,G=z&&z.length,X=G?z[0]*S:P.length,ne=t(P,0,X,S,!0),V=[];if(!ne||ne.next===ne.prev)return V;if(G&&(ne=function(U,ee,B,K){var J,te,oe,ve=[];for(J=0,te=ee.length;J<te;J++)(oe=t(U,ee[J]*K,J<te-1?ee[J+1]*K:U.length,K,!1))===oe.next&&(oe.steiner=!0),ve.push(f(oe));for(ve.sort(n),J=0;J<ve.length;J++)m(ve[J],B),B=k(B,B.next);return B}(P,z,ne,S)),P.length>80*S){C=D=P[0],R=j=P[1];for(var N=S;N<X;N+=S)(q=P[N])<C&&(C=q),(Z=P[N+1])<R&&(R=Z),q>D&&(D=q),Z>j&&(j=Z);W=0!==(W=Math.max(D-C,j-R))?1/W:0}return x(ne,V,S,C,R,W),V}function t(P,z,S,C,R){var D,j;if(R===M(P,z,S,C)>0)for(D=z;D<S;D+=C)j=w(D,P[D],P[D+1],j);else for(D=S-C;D>=z;D-=C)j=w(D,P[D],P[D+1],j);return j&&u(j,j.next)&&(T(j),j=j.next),j}function k(P,z){if(!P)return P;z||(z=P);var S,C=P;do{if(S=!1,C.steiner||!u(C,C.next)&&0!==d(C.prev,C,C.next))C=C.next;else{if(T(C),(C=z=C.prev)===C.next)break;S=!0}}while(S||C!==z);return z}function x(P,z,S,C,R,D,j){if(P){!j&&D&&function(G,X,ne,V){var N=G;do{null===N.z&&(N.z=s(N.x,N.y,X,ne,V)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next}while(N!==G);N.prevZ.nextZ=null,N.prevZ=null,function(U){var ee,B,K,J,te,ae,ce,oe,ve=1;do{for(B=U,U=null,te=null,ae=0;B;){for(ae++,K=B,ce=0,ee=0;ee<ve&&(ce++,K=K.nextZ);ee++);for(oe=ve;ce>0||oe>0&&K;)0!==ce&&(0===oe||!K||B.z<=K.z)?(J=B,B=B.nextZ,ce--):(J=K,K=K.nextZ,oe--),te?te.nextZ=J:U=J,J.prevZ=te,te=J;B=K}te.nextZ=null,ve*=2}while(ae>1)}(N)}(P,C,R,D);for(var q,Z,W=P;P.prev!==P.next;)if(q=P.prev,Z=P.next,D?r(P,C,R,D):e(P))z.push(q.i/S),z.push(P.i/S),z.push(Z.i/S),T(P),P=Z.next,W=Z.next;else if((P=Z)===W){j?1===j?x(P=i(k(P),z,S),z,S,C,R,D,2):2===j&&c(P,z,S,C,R,D):x(k(P),z,S,C,R,D,1);break}}}function e(P){var z=P.prev,S=P,C=P.next;if(d(z,S,C)>=0)return!1;for(var R=P.next.next;R!==P.prev;){if(l(z.x,z.y,S.x,S.y,C.x,C.y,R.x,R.y)&&d(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function r(P,z,S,C){var R=P.prev,D=P,j=P.next;if(d(R,D,j)>=0)return!1;for(var W=R.x>D.x?R.x>j.x?R.x:j.x:D.x>j.x?D.x:j.x,G=R.y>D.y?R.y>j.y?R.y:j.y:D.y>j.y?D.y:j.y,X=s(R.x<D.x?R.x<j.x?R.x:j.x:D.x<j.x?D.x:j.x,R.y<D.y?R.y<j.y?R.y:j.y:D.y<j.y?D.y:j.y,z,S,C),ne=s(W,G,z,S,C),V=P.prevZ,N=P.nextZ;V&&V.z>=X&&N&&N.z<=ne;){if(V!==P.prev&&V!==P.next&&l(R.x,R.y,D.x,D.y,j.x,j.y,V.x,V.y)&&d(V.prev,V,V.next)>=0||(V=V.prevZ,N!==P.prev&&N!==P.next&&l(R.x,R.y,D.x,D.y,j.x,j.y,N.x,N.y)&&d(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;V&&V.z>=X;){if(V!==P.prev&&V!==P.next&&l(R.x,R.y,D.x,D.y,j.x,j.y,V.x,V.y)&&d(V.prev,V,V.next)>=0)return!1;V=V.prevZ}for(;N&&N.z<=ne;){if(N!==P.prev&&N!==P.next&&l(R.x,R.y,D.x,D.y,j.x,j.y,N.x,N.y)&&d(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function i(P,z,S){var C=P;do{var R=C.prev,D=C.next.next;!u(R,D)&&a(R,C,C.next,D)&&_(R,D)&&_(D,R)&&(z.push(R.i/S),z.push(C.i/S),z.push(D.i/S),T(C),T(C.next),C=P=D),C=C.next}while(C!==P);return k(C)}function c(P,z,S,C,R,D){var j=P;do{for(var q=j.next.next;q!==j.prev;){if(j.i!==q.i&&o(j,q)){var Z=b(j,q);return j=k(j,j.next),Z=k(Z,Z.next),x(j,z,S,C,R,D),void x(Z,z,S,C,R,D)}q=q.next}j=j.next}while(j!==P)}function n(P,z){return P.x-z.x}function m(P,z){if(z=function(C,R){var D,j=R,q=C.x,Z=C.y,W=-1/0;do{if(Z<=j.y&&Z>=j.next.y&&j.next.y!==j.y){var G=j.x+(Z-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(G<=q&&G>W){if(W=G,G===q){if(Z===j.y)return j;if(Z===j.next.y)return j.next}D=j.x<j.next.x?j:j.next}}j=j.next}while(j!==R);if(!D)return null;if(q===W)return D;var X,ne=D,V=D.x,N=D.y,U=1/0;j=D;do{q>=j.x&&j.x>=V&&q!==j.x&&l(Z<N?q:W,Z,V,N,Z<N?W:q,Z,j.x,j.y)&&(X=Math.abs(Z-j.y)/(q-j.x),_(j,C)&&(X<U||X===U&&(j.x>D.x||j.x===D.x&&p(D,j)))&&(D=j,U=X)),j=j.next}while(j!==ne);return D}(P,z)){var S=b(z,P);k(z,z.next),k(S,S.next)}}function p(P,z){return d(P.prev,P,z.prev)<0&&d(z.next,P,P.next)<0}function s(P,z,S,C,R){return(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-S)*R)|P<<8))|P<<4))|P<<2))|P<<1))|(z=1431655765&((z=858993459&((z=252645135&((z=16711935&((z=32767*(z-C)*R)|z<<8))|z<<4))|z<<2))|z<<1))<<1}function f(P){var z=P,S=P;do{(z.x<S.x||z.x===S.x&&z.y<S.y)&&(S=z),z=z.next}while(z!==P);return S}function l(P,z,S,C,R,D,j,q){return(R-j)*(z-q)-(P-j)*(D-q)>=0&&(P-j)*(C-q)-(S-j)*(z-q)>=0&&(S-j)*(D-q)-(R-j)*(C-q)>=0}function o(P,z){return P.next.i!==z.i&&P.prev.i!==z.i&&!function(S,C){var R=S;do{if(R.i!==S.i&&R.next.i!==S.i&&R.i!==C.i&&R.next.i!==C.i&&a(R,R.next,S,C))return!0;R=R.next}while(R!==S);return!1}(P,z)&&(_(P,z)&&_(z,P)&&function(S,C){var R=S,D=!1,j=(S.x+C.x)/2,q=(S.y+C.y)/2;do{R.y>q!=R.next.y>q&&R.next.y!==R.y&&j<(R.next.x-R.x)*(q-R.y)/(R.next.y-R.y)+R.x&&(D=!D),R=R.next}while(R!==S);return D}(P,z)&&(d(P.prev,P,z.prev)||d(P,z.prev,z))||u(P,z)&&d(P.prev,P,P.next)>0&&d(z.prev,z,z.next)>0)}function d(P,z,S){return(z.y-P.y)*(S.x-z.x)-(z.x-P.x)*(S.y-z.y)}function u(P,z){return P.x===z.x&&P.y===z.y}function a(P,z,S,C){var R=h(d(P,z,S)),D=h(d(P,z,C)),j=h(d(S,C,P)),q=h(d(S,C,z));return R!==D&&j!==q||!(0!==R||!y(P,S,z))||!(0!==D||!y(P,C,z))||!(0!==j||!y(S,P,C))||!(0!==q||!y(S,z,C))}function y(P,z,S){return z.x<=Math.max(P.x,S.x)&&z.x>=Math.min(P.x,S.x)&&z.y<=Math.max(P.y,S.y)&&z.y>=Math.min(P.y,S.y)}function h(P){return P>0?1:P<0?-1:0}function _(P,z){return d(P.prev,P,P.next)<0?d(P,z,P.next)>=0&&d(P,P.prev,z)>=0:d(P,z,P.prev)<0||d(P,P.next,z)<0}function b(P,z){var S=new L(P.i,P.x,P.y),C=new L(z.i,z.x,z.y),R=P.next,D=z.prev;return P.next=z,z.prev=P,S.next=R,R.prev=S,C.next=S,S.prev=C,D.next=C,C.prev=D,C}function w(P,z,S,C){var R=new L(P,z,S);return C?(R.next=C.next,R.prev=C,C.next.prev=R,C.next=R):(R.prev=R,R.next=R),R}function T(P){P.next.prev=P.prev,P.prev.next=P.next,P.prevZ&&(P.prevZ.nextZ=P.nextZ),P.nextZ&&(P.nextZ.prevZ=P.prevZ)}function L(P,z,S){this.i=P,this.x=z,this.y=S,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(P,z,S,C){for(var R=0,D=z,j=S-C;D<S;D+=C)R+=(P[j]-P[D])*(P[D+1]+P[j+1]),j=D;return R}Q.exports=g,Q.exports.default=g,g.deviation=function(P,z,S,C){var R=z&&z.length,j=Math.abs(M(P,0,R?z[0]*S:P.length,S));if(R)for(var q=0,Z=z.length;q<Z;q++)j-=Math.abs(M(P,z[q]*S,q<Z-1?z[q+1]*S:P.length,S));var X=0;for(q=0;q<C.length;q+=3){var ne=C[q]*S,V=C[q+1]*S,N=C[q+2]*S;X+=Math.abs((P[ne]-P[N])*(P[V+1]-P[ne+1])-(P[ne]-P[V])*(P[N+1]-P[ne+1]))}return 0===j&&0===X?0:Math.abs((X-j)/j)},g.flatten=function(P){for(var z=P[0][0].length,S={vertices:[],holes:[],dimensions:z},C=0,R=0;R<P.length;R++){for(var D=0;D<P[R].length;D++)for(var j=0;j<z;j++)S.vertices.push(P[R][D][j]);R>0&&S.holes.push(C+=P[R-1].length)}return S}},{}],130:[function(v,Q,$){var g=v("strongly-connected-components");Q.exports=function(t,k){var x,e=[],r=[],i=[],c={},n=[];function m(a){var y,h,_=!1;for(r.push(a),i[a]=!0,y=0;y<n[a].length;y++)(h=n[a][y])===x?(p(x,r),_=!0):i[h]||(_=m(h));if(_)!function w(T){i[T]=!1,c.hasOwnProperty(T)&&Object.keys(c[T]).forEach(function(L){delete c[T][L],i[L]&&w(L)})}(a);else for(y=0;y<n[a].length;y++){var b=c[h=n[a][y]];b||(c[h]=b={}),b[h]=!0}return r.pop(),_}function p(a,y){var h=[].concat(y).concat(a);k?k(m):e.push(h)}function s(a){!function(L){for(var M=0;M<t.length;M++)M<L&&(t[M]=[]),t[M]=t[M].filter(function(P){return P>=L})}(a);for(var y,h=g(t).components.filter(function(L){return L.length>1}),_=1/0,b=0;b<h.length;b++)for(var w=0;w<h[b].length;w++)h[b][w]<_&&(_=h[b][w],y=b);var T=h[y];return!!T&&{leastVertex:_,adjList:t.map(function(L,M){return-1===T.indexOf(M)?[]:L.filter(function(P){return-1!==T.indexOf(P)})})}}x=0;for(var f=t.length;x<f;){var l=s(x);if(x=l.leastVertex,n=l.adjList){for(var o=0;o<n.length;o++)for(var d=0;d<n[o].length;d++){var u=n[o][d];i[+u]=!1,c[u]={}}m(x),x+=1}else x=f}return k?void 0:e}},{"strongly-connected-components":307}],131:[function(v,Q,$){"use strict";var g=v("../../object/valid-value");Q.exports=function(){return g(this).length=0,this}},{"../../object/valid-value":162}],132:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?Array.from:v("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(v,Q,$){"use strict";Q.exports=function(){var g,t,k=Array.from;return"function"==typeof k&&(t=k(g=["raz","dwa"]),Boolean(t&&t!==g&&"dwa"===t[1]))}},{}],134:[function(v,Q,$){"use strict";var g=v("es6-symbol").iterator,t=v("../../function/is-arguments"),k=v("../../function/is-function"),x=v("../../number/to-pos-integer"),e=v("../../object/valid-callable"),r=v("../../object/valid-value"),i=v("../../object/is-value"),c=v("../../string/is-string"),n=Array.isArray,m=Function.prototype.call,p={configurable:!0,enumerable:!0,writable:!0,value:null},s=Object.defineProperty;Q.exports=function(f){var l,o,d,u,a,y,h,_,b,w,T=arguments[1],L=arguments[2];if(f=Object(r(f)),i(T)&&e(T),this&&this!==Array&&k(this))l=this;else{if(!T){if(t(f))return 1!==(a=f.length)?Array.apply(null,f):((u=new Array(1))[0]=f[0],u);if(n(f)){for(u=new Array(a=f.length),o=0;o<a;++o)u[o]=f[o];return u}}u=[]}if(!n(f))if(void 0!==(b=f[g])){for(h=e(b).call(f),l&&(u=new l),_=h.next(),o=0;!_.done;)w=T?m.call(T,L,_.value,o):_.value,l?(p.value=w,s(u,o,p)):u[o]=w,_=h.next(),++o;a=o}else if(c(f)){for(a=f.length,l&&(u=new l),o=0,d=0;o<a;++o)w=f[o],o+1<a&&(y=w.charCodeAt(0))>=55296&&y<=56319&&(w+=f[++o]),w=T?m.call(T,L,w,d):w,l?(p.value=w,s(u,d,p)):u[d]=w,++d;a=d}if(void 0===a)for(a=x(f.length),l&&(u=new l(a)),o=0;o<a;++o)w=T?m.call(T,L,f[o],o):f[o],l?(p.value=w,s(u,o,p)):u[o]=w;return l&&(p.value=null,u.length=a),u}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(v,Q,$){"use strict";var g=Object.prototype.toString,t=g.call(function(){return arguments}());Q.exports=function(k){return g.call(k)===t}},{}],136:[function(v,Q,$){"use strict";var g=Object.prototype.toString,t=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);Q.exports=function(k){return"function"==typeof k&&t(g.call(k))}},{}],137:[function(v,Q,$){"use strict";Q.exports=function(){}},{}],138:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?Math.sign:v("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(v,Q,$){"use strict";Q.exports=function(){var g=Math.sign;return"function"==typeof g&&1===g(10)&&-1===g(-20)}},{}],140:[function(v,Q,$){"use strict";Q.exports=function(g){return g=Number(g),isNaN(g)||0===g?g:g>0?1:-1}},{}],141:[function(v,Q,$){"use strict";var g=v("../math/sign"),t=Math.abs,k=Math.floor;Q.exports=function(x){return isNaN(x)?0:0!==(x=Number(x))&&isFinite(x)?g(x)*k(t(x)):x}},{"../math/sign":138}],142:[function(v,Q,$){"use strict";var g=v("./to-integer"),t=Math.max;Q.exports=function(k){return t(0,g(k))}},{"./to-integer":141}],143:[function(v,Q,$){"use strict";var g=v("./valid-callable"),t=v("./valid-value"),k=Function.prototype.bind,x=Function.prototype.call,e=Object.keys,r=Object.prototype.propertyIsEnumerable;Q.exports=function(i,c){return function(n,m){var p,s=arguments[2],f=arguments[3];return n=Object(t(n)),g(m),p=e(n),f&&p.sort("function"==typeof f?k.call(f,n):void 0),"function"!=typeof i&&(i=p[i]),x.call(i,p,function(l,o){return r.call(n,l)?x.call(m,s,n[l],l,n,o):c})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?Object.assign:v("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(v,Q,$){"use strict";Q.exports=function(){var g,t=Object.assign;return"function"==typeof t&&(t(g={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),g.foo+g.bar+g.trzy==="razdwatrzy")}},{}],146:[function(v,Q,$){"use strict";var g=v("../keys"),t=v("../valid-value"),k=Math.max;Q.exports=function(x,e){var r,i,c,n=k(arguments.length,2);for(x=Object(t(x)),c=function(m){try{x[m]=e[m]}catch(p){r||(r=p)}},i=1;i<n;++i)g(e=arguments[i]).forEach(c);if(void 0!==r)throw r;return x}},{"../keys":152,"../valid-value":162}],147:[function(v,Q,$){"use strict";var g=v("../array/from"),t=v("./assign"),k=v("./valid-value");Q.exports=function(x){var e=Object(k(x)),r=arguments[1],i=Object(arguments[2]);if(e!==x&&!r)return e;var c={};return r?g(r,function(n){(i.ensure||n in x)&&(c[n]=x[n])}):t(c,x),c}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(v,Q,$){"use strict";var g,t,k,x,e=Object.create;v("./set-prototype-of/is-implemented")()||(g=v("./set-prototype-of/shim")),Q.exports=g?1!==g.level?e:(t={},k={},x={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(r){k[r]="__proto__"!==r?x:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(t,k),Object.defineProperty(g,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:t}),function(r,i){return e(null===r?t:r,i)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(v,Q,$){"use strict";Q.exports=v("./_iterate")("forEach")},{"./_iterate":143}],150:[function(v,Q,$){"use strict";var g=v("./is-value"),t={function:!0,object:!0};Q.exports=function(k){return g(k)&&t[typeof k]||!1}},{"./is-value":151}],151:[function(v,Q,$){"use strict";var g=v("../function/noop")();Q.exports=function(t){return t!==g&&null!==t}},{"../function/noop":137}],152:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?Object.keys:v("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(v,Q,$){"use strict";Q.exports=function(){try{return Object.keys("primitive"),!0}catch(g){return!1}}},{}],154:[function(v,Q,$){"use strict";var g=v("../is-value"),t=Object.keys;Q.exports=function(k){return t(g(k)?Object(k):k)}},{"../is-value":151}],155:[function(v,Q,$){"use strict";var g=v("./valid-callable"),t=v("./for-each"),k=Function.prototype.call;Q.exports=function(x,e){var r={},i=arguments[2];return g(e),t(x,function(c,n,m,p){r[n]=k.call(e,i,c,n,m,p)}),r}},{"./for-each":149,"./valid-callable":160}],156:[function(v,Q,$){"use strict";var g=v("./is-value"),t=Array.prototype.forEach,k=Object.create,x=function(e,r){var i;for(i in e)r[i]=e[i]};Q.exports=function(e){var r=k(null);return t.call(arguments,function(i){g(i)&&x(Object(i),r)}),r}},{"./is-value":151}],157:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?Object.setPrototypeOf:v("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(v,Q,$){"use strict";var g=Object.create,t=Object.getPrototypeOf,k={};Q.exports=function(){var x=Object.setPrototypeOf;return"function"==typeof x&&t(x((arguments[0]||g)(null),k))===k}},{}],159:[function(v,Q,$){"use strict";var g,i,c,n,t=v("../is-object"),k=v("../valid-value"),x=Object.prototype.isPrototypeOf,e=Object.defineProperty,r={configurable:!0,enumerable:!1,writable:!0,value:void 0};g=function(i,c){if(k(i),null===c||t(c))return i;throw new TypeError("Prototype must be null or an object")},Q.exports=(i=function(){var i,c=Object.create(null),n={},m=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(m){try{(i=m.set).call(c,n)}catch(p){}if(Object.getPrototypeOf(c)===n)return{set:i,level:2}}return c.__proto__=n,Object.getPrototypeOf(c)===n?{level:2}:((c={}).__proto__=n,Object.getPrototypeOf(c)===n&&{level:1})}(),i?(2===i.level?i.set?(n=i.set,c=function(m,p){return n.call(g(m,p),p),m}):c=function(m,p){return g(m,p).__proto__=p,m}:c=function m(p,s){var f;return g(p,s),(f=x.call(m.nullPolyfill,p))&&delete m.nullPolyfill.__proto__,null===s&&(s=m.nullPolyfill),p.__proto__=s,f&&e(m.nullPolyfill,"__proto__",r),p},Object.defineProperty(c,"level",{configurable:!1,enumerable:!1,writable:!1,value:i.level})):null),v("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(v,Q,$){"use strict";Q.exports=function(g){if("function"!=typeof g)throw new TypeError(g+" is not a function");return g}},{}],161:[function(v,Q,$){"use strict";var g=v("./is-object");Q.exports=function(t){if(!g(t))throw new TypeError(t+" is not an Object");return t}},{"./is-object":150}],162:[function(v,Q,$){"use strict";var g=v("./is-value");Q.exports=function(t){if(!g(t))throw new TypeError("Cannot use null or undefined");return t}},{"./is-value":151}],163:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?String.prototype.contains:v("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(v,Q,$){"use strict";var g="razdwatrzy";Q.exports=function(){return"function"==typeof g.contains&&!0===g.contains("dwa")&&!1===g.contains("foo")}},{}],165:[function(v,Q,$){"use strict";var g=String.prototype.indexOf;Q.exports=function(t){return g.call(this,t,arguments[1])>-1}},{}],166:[function(v,Q,$){"use strict";var g=Object.prototype.toString,t=g.call("");Q.exports=function(k){return"string"==typeof k||k&&"object"==typeof k&&(k instanceof String||g.call(k)===t)||!1}},{}],167:[function(v,Q,$){"use strict";var g=Object.create(null),t=Math.random;Q.exports=function(){var k;do{k=t().toString(36).slice(2)}while(g[k]);return k}},{}],168:[function(v,Q,$){"use strict";var g,t=v("es5-ext/object/set-prototype-of"),k=v("es5-ext/string/#/contains"),x=v("d"),e=v("es6-symbol"),r=v("./"),i=Object.defineProperty;g=Q.exports=function(c,n){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");r.call(this,c),n=n?k.call(n,"key+value")?"key+value":k.call(n,"key")?"key":"value":"value",i(this,"__kind__",x("",n))},t&&t(g,r),delete g.prototype.constructor,g.prototype=Object.create(r.prototype,{_resolve:x(function(c){return"value"===this.__kind__?this.__list__[c]:"key+value"===this.__kind__?[c,this.__list__[c]]:c})}),i(g.prototype,e.toStringTag,x("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(v,Q,$){"use strict";var g=v("es5-ext/function/is-arguments"),t=v("es5-ext/object/valid-callable"),k=v("es5-ext/string/is-string"),x=v("./get"),e=Array.isArray,r=Function.prototype.call,i=Array.prototype.some;Q.exports=function(c,n){var m,p,s,f,l,o,d,u,a=arguments[2];if(e(c)||g(c)?m="array":k(c)?m="string":c=x(c),t(n),s=function(){f=!0},"array"!==m)if("string"!==m)for(p=c.next();!p.done;){if(r.call(n,a,p.value,s),f)return;p=c.next()}else for(o=c.length,l=0;l<o&&(d=c[l],l+1<o&&(u=d.charCodeAt(0))>=55296&&u<=56319&&(d+=c[++l]),r.call(n,a,d,s),!f);++l);else i.call(c,function(y){return r.call(n,a,y,s),f})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(v,Q,$){"use strict";var g=v("es5-ext/function/is-arguments"),t=v("es5-ext/string/is-string"),k=v("./array"),x=v("./string"),e=v("./valid-iterable"),r=v("es6-symbol").iterator;Q.exports=function(i){return"function"==typeof e(i)[r]?i[r]():g(i)?new k(i):t(i)?new x(i):new k(i)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(v,Q,$){"use strict";var g,t=v("es5-ext/array/#/clear"),k=v("es5-ext/object/assign"),x=v("es5-ext/object/valid-callable"),e=v("es5-ext/object/valid-value"),r=v("d"),i=v("d/auto-bind"),c=v("es6-symbol"),n=Object.defineProperty,m=Object.defineProperties;Q.exports=g=function(p,s){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");m(this,{__list__:r("w",e(p)),__context__:r("w",s),__nextIndex__:r("w",0)}),s&&(x(s.on),s.on("_add",this._onAdd),s.on("_delete",this._onDelete),s.on("_clear",this._onClear))},delete g.prototype.constructor,m(g.prototype,k({_next:r(function(){var p;if(this.__list__)return this.__redo__&&void 0!==(p=this.__redo__.shift())?p:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:r(function(){return this._createResult(this._next())}),_createResult:r(function(p){return void 0===p?{done:!0,value:void 0}:{done:!1,value:this._resolve(p)}}),_resolve:r(function(p){return this.__list__[p]}),_unBind:r(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:r(function(){return"[object "+(this[c.toStringTag]||"Object")+"]"})},i({_onAdd:r(function(p){p>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(s,f){s>=p&&(this.__redo__[f]=++s)},this),this.__redo__.push(p)):n(this,"__redo__",r("c",[p])))}),_onDelete:r(function(p){var s;p>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(s=this.__redo__.indexOf(p))&&this.__redo__.splice(s,1),this.__redo__.forEach(function(f,l){f>p&&(this.__redo__[l]=--f)},this)))}),_onClear:r(function(){this.__redo__&&t.call(this.__redo__),this.__nextIndex__=0})}))),n(g.prototype,c.iterator,r(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(v,Q,$){"use strict";var g=v("es5-ext/function/is-arguments"),t=v("es5-ext/object/is-value"),k=v("es5-ext/string/is-string"),x=v("es6-symbol").iterator,e=Array.isArray;Q.exports=function(r){return!(!t(r)||!e(r)&&!k(r)&&!g(r)&&"function"!=typeof r[x])}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(v,Q,$){"use strict";var g,t=v("es5-ext/object/set-prototype-of"),k=v("d"),x=v("es6-symbol"),e=v("./"),r=Object.defineProperty;g=Q.exports=function(i){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");i=String(i),e.call(this,i),r(this,"__length__",k("",i.length))},t&&t(g,e),delete g.prototype.constructor,g.prototype=Object.create(e.prototype,{_next:k(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:k(function(i){var c,n=this.__list__[i];return this.__nextIndex__===this.__length__?n:(c=n.charCodeAt(0))>=55296&&c<=56319?n+this.__list__[this.__nextIndex__++]:n})}),r(g.prototype,x.toStringTag,k("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(v,Q,$){"use strict";var g=v("./is-iterable");Q.exports=function(t){if(!g(t))throw new TypeError(t+" is not iterable");return t}},{"./is-iterable":172}],175:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?v("ext/global-this").Symbol:v("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(v,Q,$){"use strict";var g=v("ext/global-this"),t={object:!0,symbol:!0};Q.exports=function(){var k,x=g.Symbol;if("function"!=typeof x)return!1;k=x("test symbol");try{String(k)}catch(e){return!1}return!!t[typeof x.iterator]&&!!t[typeof x.toPrimitive]&&!!t[typeof x.toStringTag]}},{"ext/global-this":188}],177:[function(v,Q,$){"use strict";Q.exports=function(g){return!!g&&("symbol"==typeof g||!!g.constructor&&"Symbol"===g.constructor.name&&"Symbol"===g[g.constructor.toStringTag])}},{}],178:[function(v,Q,$){"use strict";var g=v("d"),k=Object.defineProperty,x=Object.prototype,e=(0,Object.create)(null);Q.exports=function(r){for(var i,c,n=0;e[r+(n||"")];)++n;return e[r+=n||""]=!0,k(x,i="@@"+r,g.gs(null,function(m){c||(c=!0,k(this,i,g(m)),c=!1)})),i}},{d:106}],179:[function(v,Q,$){"use strict";var g=v("d"),t=v("ext/global-this").Symbol;Q.exports=function(k){return Object.defineProperties(k,{hasInstance:g("",t&&t.hasInstance||k("hasInstance")),isConcatSpreadable:g("",t&&t.isConcatSpreadable||k("isConcatSpreadable")),iterator:g("",t&&t.iterator||k("iterator")),match:g("",t&&t.match||k("match")),replace:g("",t&&t.replace||k("replace")),search:g("",t&&t.search||k("search")),species:g("",t&&t.species||k("species")),split:g("",t&&t.split||k("split")),toPrimitive:g("",t&&t.toPrimitive||k("toPrimitive")),toStringTag:g("",t&&t.toStringTag||k("toStringTag")),unscopables:g("",t&&t.unscopables||k("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(v,Q,$){"use strict";var g=v("d"),t=v("../../../validate-symbol"),k=Object.create(null);Q.exports=function(x){return Object.defineProperties(x,{for:g(function(e){return k[e]?k[e]:k[e]=x(String(e))}),keyFor:g(function(e){var r;for(r in t(e),k)if(k[r]===e)return r})})}},{"../../../validate-symbol":182,d:106}],181:[function(v,Q,$){"use strict";var g,t,k,x=v("d"),e=v("./validate-symbol"),r=v("ext/global-this").Symbol,i=v("./lib/private/generate-name"),c=v("./lib/private/setup/standard-symbols"),n=v("./lib/private/setup/symbol-registry"),m=Object.create,p=Object.defineProperties,s=Object.defineProperty;if("function"==typeof r)try{String(r()),k=!0}catch(f){}else r=null;t=function(f){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return g(f)},Q.exports=g=function f(l){var o;if(this instanceof f)throw new TypeError("Symbol is not a constructor");return k?r(l):(o=m(t.prototype),l=void 0===l?"":String(l),p(o,{__description__:x("",l),__name__:x("",i(l))}))},c(g),n(g),p(t.prototype,{constructor:x(g),toString:x("",function(){return this.__name__})}),p(g.prototype,{toString:x(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:x(function(){return e(this)})}),s(g.prototype,g.toPrimitive,x("",function(){var f=e(this);return"symbol"==typeof f?f:f.toString()})),s(g.prototype,g.toStringTag,x("c","Symbol")),s(t.prototype,g.toStringTag,x("c",g.prototype[g.toStringTag])),s(t.prototype,g.toPrimitive,x("c",g.prototype[g.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(v,Q,$){"use strict";var g=v("./is-symbol");Q.exports=function(t){if(!g(t))throw new TypeError(t+" is not a symbol");return t}},{"./is-symbol":177}],183:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?WeakMap:v("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(v,Q,$){"use strict";Q.exports=function(){var g,t;if("function"!=typeof WeakMap)return!1;try{g=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(k){return!1}return"[object WeakMap]"===String(g)&&"function"==typeof g.set&&g.set({},1)===g&&"function"==typeof g.delete&&"function"==typeof g.has&&"one"===g.get(t)}},{}],185:[function(v,Q,$){"use strict";Q.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],186:[function(v,Q,$){"use strict";var g,t=v("es5-ext/object/is-value"),k=v("es5-ext/object/set-prototype-of"),x=v("es5-ext/object/valid-object"),e=v("es5-ext/object/valid-value"),r=v("es5-ext/string/random-uniq"),i=v("d"),c=v("es6-iterator/get"),n=v("es6-iterator/for-of"),m=v("es6-symbol").toStringTag,p=v("./is-native-implemented"),s=Array.isArray,f=Object.defineProperty,l=Object.prototype.hasOwnProperty,o=Object.getPrototypeOf;Q.exports=g=function(){var d,u=arguments[0];if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");return d=p&&k&&WeakMap!==g?k(new WeakMap,o(this)):this,t(u)&&(s(u)||(u=c(u))),f(d,"__weakMapData__",i("c","$weakMap$"+r())),u&&n(u,function(a){e(a),d.set(a[0],a[1])}),d},p&&(k&&k(g,WeakMap),g.prototype=Object.create(WeakMap.prototype,{constructor:i(g)})),Object.defineProperties(g.prototype,{delete:i(function(d){return!!l.call(x(d),this.__weakMapData__)&&(delete d[this.__weakMapData__],!0)}),get:i(function(d){if(l.call(x(d),this.__weakMapData__))return d[this.__weakMapData__]}),has:i(function(d){return l.call(x(d),this.__weakMapData__)}),set:i(function(d,u){return f(x(d),this.__weakMapData__,i("c",u)),this}),toString:i(function(){return"[object WeakMap]"})}),f(g.prototype,m,i("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(v,Q,$){var g=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};Q.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return g()}try{return __global__||g()}finally{delete Object.prototype.__global__}}()},{}],188:[function(v,Q,$){"use strict";Q.exports=v("./is-implemented")()?globalThis:v("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(v,Q,$){"use strict";Q.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(v,Q,$){"use strict";var g=v("is-string-blank");Q.exports=function(t){var k=typeof t;if("string"===k){var x=t;if(0==(t=+t)&&g(x))return!1}else if("number"!==k)return!1;return t-t<1}},{"is-string-blank":237}],191:[function(v,Q,$){var g=v("dtype");Q.exports=function(t,k,x){if(!t)throw new TypeError("must specify data as first parameter");if(x=0|+(x||0),Array.isArray(t)&&t[0]&&"number"==typeof t[0][0]){var e,r,i,c,n=t[0].length,m=t.length*n;k&&"string"!=typeof k||(k=new(g(k||"float32"))(m+x));var p=k.length-x;if(m!==p)throw new Error("source length "+m+" ("+n+"x"+t.length+") does not match destination length "+p);for(e=0,i=x;e<t.length;e++)for(r=0;r<n;r++)k[i++]=null===t[e][r]?NaN:t[e][r]}else if(k&&"string"!=typeof k)k.set(t,x);else{var s=g(k||"float32");if(Array.isArray(t)||"array"===k)for(e=0,i=x,c=(k=new s(t.length+x)).length;i<c;i++,e++)k[i]=null===t[e]?NaN:t[e];else 0===x?k=new s(t):(k=new s(t.length+x)).set(t,x)}return k}},{dtype:127}],192:[function(v,Q,$){"use strict";var g=v("css-font/stringify"),t=[32,126];Q.exports=function(k){var x=(k=k||{}).shape?k.shape:k.canvas?[k.canvas.width,k.canvas.height]:[512,512],e=k.canvas||document.createElement("canvas"),r=k.font,i="number"==typeof k.step?[k.step,k.step]:k.step||[32,32],c=k.chars||t;if(r&&"string"!=typeof r&&(r=g(r)),Array.isArray(c)){if(2===c.length&&"number"==typeof c[0]&&"number"==typeof c[1]){for(var n=[],m=c[0],p=0;m<=c[1];m++)n[p++]=String.fromCharCode(m);c=n}}else c=String(c).split("");x=x.slice(),e.width=x[0],e.height=x[1];var s=e.getContext("2d");s.fillStyle="#000",s.fillRect(0,0,e.width,e.height),s.font=r,s.textAlign="center",s.textBaseline="middle",s.fillStyle="#fff";var f=i[0]/2,l=i[1]/2;for(m=0;m<c.length;m++)s.fillText(c[m],f,l),(f+=i[0])>x[0]-i[0]/2&&(f=i[0]/2,l+=i[1]);return e}},{"css-font/stringify":102}],193:[function(v,Q,$){"use strict";function g(e,r){r||(r={}),("string"==typeof e||Array.isArray(e))&&(r.family=e);var i=Array.isArray(r.family)?r.family.join(", "):r.family;if(!i)throw Error("`family` must be defined");var c=r.size||r.fontSize||r.em||48,m=(e=[r.style||r.fontStyle||"",r.weight||r.fontWeight||"",c].join(" ")+"px "+i,r.origin||"top");if(g.cache[i]&&c<=g.cache[i].em)return t(g.cache[i],m);var p=r.canvas||g.canvas,s=p.getContext("2d"),f={upper:void 0!==r.upper?r.upper:"H",lower:void 0!==r.lower?r.lower:"x",descent:void 0!==r.descent?r.descent:"p",ascent:void 0!==r.ascent?r.ascent:"h",tittle:void 0!==r.tittle?r.tittle:"i",overshoot:void 0!==r.overshoot?r.overshoot:"O"},l=Math.ceil(1.5*c);p.height=l,p.width=.5*l,s.font=e;var o={top:0};s.clearRect(0,0,l,l),s.textBaseline="top",s.fillStyle="black",s.fillText("H",0,0);var d=k(s.getImageData(0,0,l,l));s.clearRect(0,0,l,l),s.textBaseline="bottom",s.fillText("H",0,l);var u=k(s.getImageData(0,0,l,l));o.lineHeight=o.bottom=l-u+d,s.clearRect(0,0,l,l),s.textBaseline="alphabetic",s.fillText("H",0,l);var a=l-k(s.getImageData(0,0,l,l))-1+d;o.baseline=o.alphabetic=a,s.clearRect(0,0,l,l),s.textBaseline="middle",s.fillText("H",0,.5*l);var y=k(s.getImageData(0,0,l,l));o.median=o.middle=l-y-1+d-.5*l,s.clearRect(0,0,l,l),s.textBaseline="hanging",s.fillText("H",0,.5*l);var h=k(s.getImageData(0,0,l,l));o.hanging=l-h-1+d-.5*l,s.clearRect(0,0,l,l),s.textBaseline="ideographic",s.fillText("H",0,l);var _=k(s.getImageData(0,0,l,l));if(o.ideographic=l-_-1+d,f.upper&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(f.upper,0,0),o.upper=k(s.getImageData(0,0,l,l)),o.capHeight=o.baseline-o.upper),f.lower&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(f.lower,0,0),o.lower=k(s.getImageData(0,0,l,l)),o.xHeight=o.baseline-o.lower),f.tittle&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(f.tittle,0,0),o.tittle=k(s.getImageData(0,0,l,l))),f.ascent&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(f.ascent,0,0),o.ascent=k(s.getImageData(0,0,l,l))),f.descent&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(f.descent,0,0),o.descent=x(s.getImageData(0,0,l,l))),f.overshoot){s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(f.overshoot,0,0);var b=x(s.getImageData(0,0,l,l));o.overshoot=b-a}for(var w in o)o[w]/=c;return o.em=c,g.cache[i]=o,t(o,m)}function t(e,r){var i={};for(var c in"string"==typeof r&&(r=e[r]),e)"em"!==c&&(i[c]=e[c]-r);return i}function k(e){for(var r=e.height,i=e.data,c=3;c<i.length;c+=4)if(0!==i[c])return Math.floor(.25*(c-3)/r)}function x(e){for(var r=e.height,i=e.data,c=i.length-1;c>0;c-=4)if(0!==i[c])return Math.floor(.25*(c-3)/r)}Q.exports=g,g.canvas=document.createElement("canvas"),g.cache={}},{}],194:[function(v,Q,$){Q.exports=function(g,t){if("string"!=typeof g)throw new TypeError("must specify type string");if(t=t||{},"undefined"==typeof document&&!t.canvas)return null;var k=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(k.width=t.width),"number"==typeof t.height&&(k.height=t.height);var x,e=t;try{var r=[g];0===g.indexOf("webgl")&&r.push("experimental-"+g);for(var i=0;i<r.length;i++)if(x=k.getContext(r[i],e))return x}catch(c){x=null}return x||null}},{}],195:[function(v,Q,$){Q.exports=function(g,t){var k=t[0],x=t[1],e=t[2],r=t[3],i=t[4],c=t[5],n=t[6],m=t[7],p=t[8],s=t[9],f=t[10],l=t[11],o=t[12],d=t[13],u=t[14],a=t[15];return g[0]=c*(f*a-l*u)-s*(n*a-m*u)+d*(n*l-m*f),g[1]=-(x*(f*a-l*u)-s*(e*a-r*u)+d*(e*l-r*f)),g[2]=x*(n*a-m*u)-c*(e*a-r*u)+d*(e*m-r*n),g[3]=-(x*(n*l-m*f)-c*(e*l-r*f)+s*(e*m-r*n)),g[4]=-(i*(f*a-l*u)-p*(n*a-m*u)+o*(n*l-m*f)),g[5]=k*(f*a-l*u)-p*(e*a-r*u)+o*(e*l-r*f),g[6]=-(k*(n*a-m*u)-i*(e*a-r*u)+o*(e*m-r*n)),g[7]=k*(n*l-m*f)-i*(e*l-r*f)+p*(e*m-r*n),g[8]=i*(s*a-l*d)-p*(c*a-m*d)+o*(c*l-m*s),g[9]=-(k*(s*a-l*d)-p*(x*a-r*d)+o*(x*l-r*s)),g[10]=k*(c*a-m*d)-i*(x*a-r*d)+o*(x*m-r*c),g[11]=-(k*(c*l-m*s)-i*(x*l-r*s)+p*(x*m-r*c)),g[12]=-(i*(s*u-f*d)-p*(c*u-n*d)+o*(c*f-n*s)),g[13]=k*(s*u-f*d)-p*(x*u-e*d)+o*(x*f-e*s),g[14]=-(k*(c*u-n*d)-i*(x*u-e*d)+o*(x*n-e*c)),g[15]=k*(c*f-n*s)-i*(x*f-e*s)+p*(x*n-e*c),g}},{}],196:[function(v,Q,$){Q.exports=function(g){var t=new Float32Array(16);return t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3],t[4]=g[4],t[5]=g[5],t[6]=g[6],t[7]=g[7],t[8]=g[8],t[9]=g[9],t[10]=g[10],t[11]=g[11],t[12]=g[12],t[13]=g[13],t[14]=g[14],t[15]=g[15],t}},{}],197:[function(v,Q,$){Q.exports=function(g,t){return g[0]=t[0],g[1]=t[1],g[2]=t[2],g[3]=t[3],g[4]=t[4],g[5]=t[5],g[6]=t[6],g[7]=t[7],g[8]=t[8],g[9]=t[9],g[10]=t[10],g[11]=t[11],g[12]=t[12],g[13]=t[13],g[14]=t[14],g[15]=t[15],g}},{}],198:[function(v,Q,$){Q.exports=function(){var g=new Float32Array(16);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],199:[function(v,Q,$){Q.exports=function(g){var t=g[0],k=g[1],x=g[2],e=g[3],r=g[4],i=g[5],c=g[6],n=g[7],m=g[8],p=g[9],s=g[10],f=g[11],l=g[12],o=g[13],d=g[14],u=g[15];return(t*i-k*r)*(s*u-f*d)-(t*c-x*r)*(p*u-f*o)+(t*n-e*r)*(p*d-s*o)+(k*c-x*i)*(m*u-f*l)-(k*n-e*i)*(m*d-s*l)+(x*n-e*c)*(m*o-p*l)}},{}],200:[function(v,Q,$){Q.exports=function(g,t){var k=t[0],x=t[1],e=t[2],r=t[3],i=k+k,c=x+x,n=e+e,m=k*i,p=x*i,s=x*c,f=e*i,l=e*c,o=e*n,d=r*i,u=r*c,a=r*n;return g[0]=1-s-o,g[1]=p+a,g[2]=f-u,g[3]=0,g[4]=p-a,g[5]=1-m-o,g[6]=l+d,g[7]=0,g[8]=f+u,g[9]=l-d,g[10]=1-m-s,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],201:[function(v,Q,$){Q.exports=function(g,t,k){var x,e,r,i=k[0],c=k[1],n=k[2],m=Math.sqrt(i*i+c*c+n*n);return Math.abs(m)<1e-6?null:(i*=m=1/m,c*=m,n*=m,x=Math.sin(t),e=Math.cos(t),g[0]=i*i*(r=1-e)+e,g[1]=c*i*r+n*x,g[2]=n*i*r-c*x,g[3]=0,g[4]=i*c*r-n*x,g[5]=c*c*r+e,g[6]=n*c*r+i*x,g[7]=0,g[8]=i*n*r+c*x,g[9]=c*n*r-i*x,g[10]=n*n*r+e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g)}},{}],202:[function(v,Q,$){Q.exports=function(g,t,k){var x=t[0],e=t[1],r=t[2],i=t[3],c=x+x,n=e+e,m=r+r,p=x*c,s=x*n,f=x*m,l=e*n,o=e*m,d=r*m,u=i*c,a=i*n,y=i*m;return g[0]=1-(l+d),g[1]=s+y,g[2]=f-a,g[3]=0,g[4]=s-y,g[5]=1-(p+d),g[6]=o+u,g[7]=0,g[8]=f+a,g[9]=o-u,g[10]=1-(p+l),g[11]=0,g[12]=k[0],g[13]=k[1],g[14]=k[2],g[15]=1,g}},{}],203:[function(v,Q,$){Q.exports=function(g,t){return g[0]=t[0],g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=t[1],g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=t[2],g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],204:[function(v,Q,$){Q.exports=function(g,t){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=t[0],g[13]=t[1],g[14]=t[2],g[15]=1,g}},{}],205:[function(v,Q,$){Q.exports=function(g,t){var k=Math.sin(t),x=Math.cos(t);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=x,g[6]=k,g[7]=0,g[8]=0,g[9]=-k,g[10]=x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],206:[function(v,Q,$){Q.exports=function(g,t){var k=Math.sin(t),x=Math.cos(t);return g[0]=x,g[1]=0,g[2]=-k,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=k,g[9]=0,g[10]=x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],207:[function(v,Q,$){Q.exports=function(g,t){var k=Math.sin(t),x=Math.cos(t);return g[0]=x,g[1]=k,g[2]=0,g[3]=0,g[4]=-k,g[5]=x,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],208:[function(v,Q,$){Q.exports=function(g,t,k,x,e,r,i){var c=1/(k-t),n=1/(e-x),m=1/(r-i);return g[0]=2*r*c,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*r*n,g[6]=0,g[7]=0,g[8]=(k+t)*c,g[9]=(e+x)*n,g[10]=(i+r)*m,g[11]=-1,g[12]=0,g[13]=0,g[14]=i*r*2*m,g[15]=0,g}},{}],209:[function(v,Q,$){Q.exports=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],210:[function(v,Q,$){Q.exports={create:v("./create"),clone:v("./clone"),copy:v("./copy"),identity:v("./identity"),transpose:v("./transpose"),invert:v("./invert"),adjoint:v("./adjoint"),determinant:v("./determinant"),multiply:v("./multiply"),translate:v("./translate"),scale:v("./scale"),rotate:v("./rotate"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),fromRotation:v("./fromRotation"),fromRotationTranslation:v("./fromRotationTranslation"),fromScaling:v("./fromScaling"),fromTranslation:v("./fromTranslation"),fromXRotation:v("./fromXRotation"),fromYRotation:v("./fromYRotation"),fromZRotation:v("./fromZRotation"),fromQuat:v("./fromQuat"),frustum:v("./frustum"),perspective:v("./perspective"),perspectiveFromFieldOfView:v("./perspectiveFromFieldOfView"),ortho:v("./ortho"),lookAt:v("./lookAt"),str:v("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(v,Q,$){Q.exports=function(g,t){var k=t[0],x=t[1],e=t[2],r=t[3],i=t[4],c=t[5],n=t[6],m=t[7],p=t[8],s=t[9],f=t[10],l=t[11],o=t[12],d=t[13],u=t[14],a=t[15],y=k*c-x*i,h=k*n-e*i,_=k*m-r*i,b=x*n-e*c,w=x*m-r*c,T=e*m-r*n,L=p*d-s*o,M=p*u-f*o,P=p*a-l*o,z=s*u-f*d,S=s*a-l*d,C=f*a-l*u,R=y*C-h*S+_*z+b*P-w*M+T*L;return R?(g[0]=(c*C-n*S+m*z)*(R=1/R),g[1]=(e*S-x*C-r*z)*R,g[2]=(d*T-u*w+a*b)*R,g[3]=(f*w-s*T-l*b)*R,g[4]=(n*P-i*C-m*M)*R,g[5]=(k*C-e*P+r*M)*R,g[6]=(u*_-o*T-a*h)*R,g[7]=(p*T-f*_+l*h)*R,g[8]=(i*S-c*P+m*L)*R,g[9]=(x*P-k*S-r*L)*R,g[10]=(o*w-d*_+a*y)*R,g[11]=(s*_-p*w-l*y)*R,g[12]=(c*M-i*z-n*L)*R,g[13]=(k*z-x*M+e*L)*R,g[14]=(d*h-o*b-u*y)*R,g[15]=(p*b-s*h+f*y)*R,g):null}},{}],212:[function(v,Q,$){var g=v("./identity");Q.exports=function(t,k,x,e){var r,i,c,n,m,p,s,f,l,o,d=k[0],u=k[1],a=k[2],y=e[0],h=e[1],_=e[2],b=x[0],w=x[1],T=x[2];return Math.abs(d-b)<1e-6&&Math.abs(u-w)<1e-6&&Math.abs(a-T)<1e-6?g(t):(s=d-b,f=u-w,l=a-T,r=h*(l*=o=1/Math.sqrt(s*s+f*f+l*l))-_*(f*=o),i=_*(s*=o)-y*l,c=y*f-h*s,(o=Math.sqrt(r*r+i*i+c*c))?(r*=o=1/o,i*=o,c*=o):(r=0,i=0,c=0),n=f*c-l*i,m=l*r-s*c,p=s*i-f*r,(o=Math.sqrt(n*n+m*m+p*p))?(n*=o=1/o,m*=o,p*=o):(n=0,m=0,p=0),t[0]=r,t[1]=n,t[2]=s,t[3]=0,t[4]=i,t[5]=m,t[6]=f,t[7]=0,t[8]=c,t[9]=p,t[10]=l,t[11]=0,t[12]=-(r*d+i*u+c*a),t[13]=-(n*d+m*u+p*a),t[14]=-(s*d+f*u+l*a),t[15]=1,t)}},{"./identity":209}],213:[function(v,Q,$){Q.exports=function(g,t,k){var x=t[0],e=t[1],r=t[2],i=t[3],c=t[4],n=t[5],m=t[6],p=t[7],s=t[8],f=t[9],l=t[10],o=t[11],d=t[12],u=t[13],a=t[14],y=t[15],h=k[0],_=k[1],b=k[2],w=k[3];return g[0]=h*x+_*c+b*s+w*d,g[1]=h*e+_*n+b*f+w*u,g[2]=h*r+_*m+b*l+w*a,g[3]=h*i+_*p+b*o+w*y,g[4]=(h=k[4])*x+(_=k[5])*c+(b=k[6])*s+(w=k[7])*d,g[5]=h*e+_*n+b*f+w*u,g[6]=h*r+_*m+b*l+w*a,g[7]=h*i+_*p+b*o+w*y,g[8]=(h=k[8])*x+(_=k[9])*c+(b=k[10])*s+(w=k[11])*d,g[9]=h*e+_*n+b*f+w*u,g[10]=h*r+_*m+b*l+w*a,g[11]=h*i+_*p+b*o+w*y,g[12]=(h=k[12])*x+(_=k[13])*c+(b=k[14])*s+(w=k[15])*d,g[13]=h*e+_*n+b*f+w*u,g[14]=h*r+_*m+b*l+w*a,g[15]=h*i+_*p+b*o+w*y,g}},{}],214:[function(v,Q,$){Q.exports=function(g,t,k,x,e,r,i){var c=1/(t-k),n=1/(x-e),m=1/(r-i);return g[0]=-2*c,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*n,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*m,g[11]=0,g[12]=(t+k)*c,g[13]=(e+x)*n,g[14]=(i+r)*m,g[15]=1,g}},{}],215:[function(v,Q,$){Q.exports=function(g,t,k,x,e){var r=1/Math.tan(t/2),i=1/(x-e);return g[0]=r/k,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=r,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=(e+x)*i,g[11]=-1,g[12]=0,g[13]=0,g[14]=2*e*x*i,g[15]=0,g}},{}],216:[function(v,Q,$){Q.exports=function(g,t,k,x){var e=Math.tan(t.upDegrees*Math.PI/180),r=Math.tan(t.downDegrees*Math.PI/180),i=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),n=2/(i+c),m=2/(e+r);return g[0]=n,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=m,g[6]=0,g[7]=0,g[8]=-(i-c)*n*.5,g[9]=(e-r)*m*.5,g[10]=x/(k-x),g[11]=-1,g[12]=0,g[13]=0,g[14]=x*k/(k-x),g[15]=0,g}},{}],217:[function(v,Q,$){Q.exports=function(g,t,k,x){var e,r,i,c,n,m,p,s,f,l,o,d,u,a,y,h,_,b,w,T,L,M,P,z,S=x[0],C=x[1],R=x[2],D=Math.sqrt(S*S+C*C+R*R);return Math.abs(D)<1e-6?null:(S*=D=1/D,C*=D,R*=D,e=Math.sin(k),r=Math.cos(k),n=t[1],m=t[2],p=t[3],f=t[5],l=t[6],o=t[7],u=t[9],a=t[10],y=t[11],w=S*C*(i=1-r)-R*e,T=C*C*i+r,L=R*C*i+S*e,M=S*R*i+C*e,P=C*R*i-S*e,z=R*R*i+r,g[0]=(c=t[0])*(h=S*S*i+r)+(s=t[4])*(_=C*S*i+R*e)+(d=t[8])*(b=R*S*i-C*e),g[1]=n*h+f*_+u*b,g[2]=m*h+l*_+a*b,g[3]=p*h+o*_+y*b,g[4]=c*w+s*T+d*L,g[5]=n*w+f*T+u*L,g[6]=m*w+l*T+a*L,g[7]=p*w+o*T+y*L,g[8]=c*M+s*P+d*z,g[9]=n*M+f*P+u*z,g[10]=m*M+l*P+a*z,g[11]=p*M+o*P+y*z,t!==g&&(g[12]=t[12],g[13]=t[13],g[14]=t[14],g[15]=t[15]),g)}},{}],218:[function(v,Q,$){Q.exports=function(g,t,k){var x=Math.sin(k),e=Math.cos(k),r=t[4],i=t[5],c=t[6],n=t[7],m=t[8],p=t[9],s=t[10],f=t[11];return t!==g&&(g[0]=t[0],g[1]=t[1],g[2]=t[2],g[3]=t[3],g[12]=t[12],g[13]=t[13],g[14]=t[14],g[15]=t[15]),g[4]=r*e+m*x,g[5]=i*e+p*x,g[6]=c*e+s*x,g[7]=n*e+f*x,g[8]=m*e-r*x,g[9]=p*e-i*x,g[10]=s*e-c*x,g[11]=f*e-n*x,g}},{}],219:[function(v,Q,$){Q.exports=function(g,t,k){var x=Math.sin(k),e=Math.cos(k),r=t[0],i=t[1],c=t[2],n=t[3],m=t[8],p=t[9],s=t[10],f=t[11];return t!==g&&(g[4]=t[4],g[5]=t[5],g[6]=t[6],g[7]=t[7],g[12]=t[12],g[13]=t[13],g[14]=t[14],g[15]=t[15]),g[0]=r*e-m*x,g[1]=i*e-p*x,g[2]=c*e-s*x,g[3]=n*e-f*x,g[8]=r*x+m*e,g[9]=i*x+p*e,g[10]=c*x+s*e,g[11]=n*x+f*e,g}},{}],220:[function(v,Q,$){Q.exports=function(g,t,k){var x=Math.sin(k),e=Math.cos(k),r=t[0],i=t[1],c=t[2],n=t[3],m=t[4],p=t[5],s=t[6],f=t[7];return t!==g&&(g[8]=t[8],g[9]=t[9],g[10]=t[10],g[11]=t[11],g[12]=t[12],g[13]=t[13],g[14]=t[14],g[15]=t[15]),g[0]=r*e+m*x,g[1]=i*e+p*x,g[2]=c*e+s*x,g[3]=n*e+f*x,g[4]=m*e-r*x,g[5]=p*e-i*x,g[6]=s*e-c*x,g[7]=f*e-n*x,g}},{}],221:[function(v,Q,$){Q.exports=function(g,t,k){var x=k[0],e=k[1],r=k[2];return g[0]=t[0]*x,g[1]=t[1]*x,g[2]=t[2]*x,g[3]=t[3]*x,g[4]=t[4]*e,g[5]=t[5]*e,g[6]=t[6]*e,g[7]=t[7]*e,g[8]=t[8]*r,g[9]=t[9]*r,g[10]=t[10]*r,g[11]=t[11]*r,g[12]=t[12],g[13]=t[13],g[14]=t[14],g[15]=t[15],g}},{}],222:[function(v,Q,$){Q.exports=function(g){return"mat4("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+", "+g[9]+", "+g[10]+", "+g[11]+", "+g[12]+", "+g[13]+", "+g[14]+", "+g[15]+")"}},{}],223:[function(v,Q,$){Q.exports=function(g,t,k){var x,e,r,i,c,n,m,p,s,f,l,o,d=k[0],u=k[1],a=k[2];return t===g?(g[12]=t[0]*d+t[4]*u+t[8]*a+t[12],g[13]=t[1]*d+t[5]*u+t[9]*a+t[13],g[14]=t[2]*d+t[6]*u+t[10]*a+t[14],g[15]=t[3]*d+t[7]*u+t[11]*a+t[15]):(e=t[1],r=t[2],i=t[3],c=t[4],n=t[5],m=t[6],p=t[7],s=t[8],f=t[9],l=t[10],o=t[11],g[0]=x=t[0],g[1]=e,g[2]=r,g[3]=i,g[4]=c,g[5]=n,g[6]=m,g[7]=p,g[8]=s,g[9]=f,g[10]=l,g[11]=o,g[12]=x*d+c*u+s*a+t[12],g[13]=e*d+n*u+f*a+t[13],g[14]=r*d+m*u+l*a+t[14],g[15]=i*d+p*u+o*a+t[15]),g}},{}],224:[function(v,Q,$){Q.exports=function(g,t){if(g===t){var k=t[1],x=t[2],e=t[3],r=t[6],i=t[7],c=t[11];g[1]=t[4],g[2]=t[8],g[3]=t[12],g[4]=k,g[6]=t[9],g[7]=t[13],g[8]=x,g[9]=r,g[11]=t[14],g[12]=e,g[13]=i,g[14]=c}else g[0]=t[0],g[1]=t[4],g[2]=t[8],g[3]=t[12],g[4]=t[1],g[5]=t[5],g[6]=t[9],g[7]=t[13],g[8]=t[2],g[9]=t[6],g[10]=t[10],g[11]=t[14],g[12]=t[3],g[13]=t[7],g[14]=t[11],g[15]=t[15];return g}},{}],225:[function(v,Q,$){"use strict";var g=v("css-font"),t=v("pick-by-alias"),k=v("regl"),x=v("gl-util/context"),e=v("es6-weak-map"),r=v("color-normalize"),i=v("font-atlas"),c=v("typedarray-pool"),n=v("parse-rect"),m=v("is-plain-obj"),p=v("parse-unit"),s=v("to-px"),f=v("detect-kerning"),l=v("object-assign"),o=v("font-measure"),d=v("flatten-vertex-data"),u=v("bit-twiddle").nextPow2,a=new e,y=!1;if(document.body){var h=document.body.appendChild(document.createElement("div"));h.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(h).fontStretch&&(y=!0),document.body.removeChild(h)}var _=function(b){var w;this.gl="function"==typeof(w=b)&&w._gl&&w.prop&&w.texture&&w.buffer?(b={regl:b}).regl._gl:x(b),this.shader=a.get(this.gl),this.regl=this.shader?this.shader.regl:b.regl||k({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),a.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(m(b)?b:{})};_.prototype.createShader=function(){var b=this.regl,w=b({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:b.prop("count"),offset:b.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:b.this("sizeBuffer")},width:{offset:0,stride:8,buffer:b.this("sizeBuffer")},char:b.this("charBuffer"),position:b.this("position")},uniforms:{atlasSize:function(T,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(T,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(T,L){return L.atlas.texture},charStep:function(T,L){return L.atlas.step},em:function(T,L){return L.atlas.em},color:b.prop("color"),opacity:b.prop("opacity"),viewport:b.this("viewportArray"),scale:b.this("scale"),align:b.prop("align"),baseline:b.prop("baseline"),translate:b.this("translate"),positionOffset:b.prop("positionOffset")},primitive:"points",viewport:b.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ vec2(positionOffset.x, -positionOffset.y)))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform sampler2D atlas;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:b,draw:w,atlas:{}}},_.prototype.update=function(b){var w=this;if("string"==typeof b)b={text:b};else if(!b)return;null!=(b=t(b,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(this.opacity=Array.isArray(b.opacity)?b.opacity.map(function(de){return parseFloat(de)}):parseFloat(b.opacity)),null!=b.viewport&&(this.viewport=n(b.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=b.kerning&&(this.kerning=b.kerning),null!=b.offset&&("number"==typeof b.offset&&(b.offset=[b.offset,0]),this.positionOffset=d(b.offset)),b.direction&&(this.direction=b.direction),b.range&&(this.range=b.range,this.scale=[1/(b.range[2]-b.range[0]),1/(b.range[3]-b.range[1])],this.translate=[-b.range[0],-b.range[1]]),b.scale&&(this.scale=b.scale),b.translate&&(this.translate=b.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||b.font||(b.font=_.baseFontSize+"px sans-serif");var T,L=!1,M=!1;if(b.font&&(Array.isArray(b.font)?b.font:[b.font]).forEach(function(de,Ae){if("string"==typeof de)try{de=g.parse(de)}catch(Qe){de=g.parse(_.baseFontSize+"px "+de)}else de=g.parse(g.stringify(de));var Le=g.stringify({size:_.baseFontSize,family:de.family,stretch:y?de.stretch:void 0,variant:de.variant,weight:de.weight,style:de.style}),Me=p(de.size),De=Math.round(Me[0]*s(Me[1]));if(De!==w.fontSize[Ae]&&(M=!0,w.fontSize[Ae]=De),!(w.font[Ae]&&Le==w.font[Ae].baseString||(L=!0,w.font[Ae]=_.fonts[Le],w.font[Ae]))){var Oe=de.family.join(", "),Ie=[de.style];de.style!=de.variant&&Ie.push(de.variant),de.variant!=de.weight&&Ie.push(de.weight),y&&de.weight!=de.stretch&&Ie.push(de.stretch),w.font[Ae]={baseString:Le,family:Oe,weight:de.weight,stretch:de.stretch,style:de.style,variant:de.variant,width:{},kerning:{},metrics:o(Oe,{origin:"top",fontSize:_.baseFontSize,fontStyle:Ie.join(" ")})},_.fonts[Le]=w.font[Ae]}}),(L||M)&&this.font.forEach(function(de,Ae){var Le=g.stringify({size:w.fontSize[Ae],family:de.family,stretch:y?de.stretch:void 0,variant:de.variant,weight:de.weight,style:de.style});w.fontAtlas[Ae]=w.shader.atlas[Le],w.fontAtlas[Ae]||(w.shader.atlas[Le]=w.fontAtlas[Ae]={fontString:Le,step:2*Math.ceil(w.fontSize[Ae]*de.metrics.bottom*.5),em:w.fontSize[Ae],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:w.regl.texture()}),null==b.text&&(b.text=w.text)}),"string"==typeof b.text&&b.position&&b.position.length>2){for(var P=Array(.5*b.position.length),z=0;z<P.length;z++)P[z]=b.text;b.text=P}if(null!=b.text||L){if(this.textOffsets=[0],Array.isArray(b.text)){this.count=b.text[0].length,this.counts=[this.count];for(var S=1;S<b.text.length;S++)this.textOffsets[S]=this.textOffsets[S-1]+b.text[S-1].length,this.count+=b.text[S].length,this.counts.push(b.text[S].length);this.text=b.text.join("")}else this.text=b.text,this.count=this.text.length,this.counts=[this.count];T=[],this.font.forEach(function(de,Ae){_.atlasContext.font=de.baseString;for(var Le=w.fontAtlas[Ae],Me=0;Me<w.text.length;Me++){var De=w.text.charAt(Me);if(null==Le.ids[De]&&(Le.ids[De]=Le.chars.length,Le.chars.push(De),T.push(De)),null==de.width[De]&&(de.width[De]=_.atlasContext.measureText(De).width/_.baseFontSize,w.kerning)){var Oe=[];for(var Ie in de.width)Oe.push(Ie+De,De+Ie);l(de.kerning,f(de.family,{pairs:Oe}))}}})}if(b.position)if(b.position.length>2){for(var C=!b.position[0].length,R=c.mallocFloat(2*this.count),D=0,j=0;D<this.counts.length;D++){var q=this.counts[D];if(C)for(var Z=0;Z<q;Z++)R[j++]=b.position[2*D],R[j++]=b.position[2*D+1];else for(var W=0;W<q;W++)R[j++]=b.position[D][0],R[j++]=b.position[D][1]}this.position.call?this.position({type:"float",data:R}):this.position=this.regl.buffer({type:"float",data:R}),c.freeFloat(R)}else this.position.destroy&&this.position.destroy(),this.position={constant:b.position};if(b.text||L){var G=c.mallocUint8(this.count),X=c.mallocFloat(2*this.count);this.textWidth=[];for(var ne=0,V=0;ne<this.counts.length;ne++){for(var N=this.counts[ne],U=this.font[ne]||this.font[0],ee=this.fontAtlas[ne]||this.fontAtlas[0],B=0;B<N;B++){var K=this.text.charAt(V),J=this.text.charAt(V-1);if(G[V]=ee.ids[K],X[2*V]=U.width[K],B){var ce=X[2*V-1]+.5*X[2*V-2]+.5*X[2*V];if(this.kerning){var oe=U.kerning[J+K];oe&&(ce+=.001*oe)}X[2*V+1]=ce}else X[2*V+1]=.5*X[2*V];V++}this.textWidth.push(X.length?.5*X[2*V-2]+X[2*V-1]:0)}b.align||(b.align=this.align),this.charBuffer({data:G,type:"uint8",usage:"stream"}),this.sizeBuffer({data:X,type:"float",usage:"stream"}),c.freeUint8(G),c.freeFloat(X),T.length&&this.font.forEach(function(de,Ae){var Le=w.fontAtlas[Ae],Me=Le.step,De=Math.floor(_.maxAtlasSize/Me),Oe=Math.min(De,Le.chars.length),Ie=Math.ceil(Le.chars.length/Oe),Qe=u(Oe*Me),Ne=u(Ie*Me);Le.width=Qe,Le.height=Ne,Le.rows=Ie,Le.cols=Oe,Le.em&&Le.texture({data:i({canvas:_.atlasCanvas,font:Le.fontString,chars:Le.chars,shape:[Qe,Ne],step:[Me,Me]})})})}if(b.align&&(this.align=b.align,this.alignOffset=this.textWidth.map(function(de,Ae){var Le=Array.isArray(w.align)?w.align.length>1?w.align[Ae]:w.align[0]:w.align;if("number"==typeof Le)return Le;switch(Le){case"right":case"end":return-de;case"center":case"centre":case"middle":return.5*-de}return 0})),null==this.baseline&&null==b.baseline&&(b.baseline=0),null!=b.baseline&&(this.baseline=b.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(de,Ae){var Le=(w.font[Ae]||w.font[0]).metrics,Me=0;return-1*((Me+=.5*Le.bottom)+("number"==typeof de?de-Le.baseline:-Le[de]))})),null!=b.color)if(b.color||(b.color="transparent"),"string"!=typeof b.color&&isNaN(b.color)){var ve;if("number"==typeof b.color[0]&&b.color.length>this.counts.length){var fe=b.color.length;ve=c.mallocUint8(fe);for(var xe=(b.color.subarray||b.color.slice).bind(b.color),Se=0;Se<fe;Se+=4)ve.set(r(xe(Se,Se+4),"uint8"),Se)}else{var pe=b.color.length;ve=c.mallocUint8(4*pe);for(var ge=0;ge<pe;ge++)ve.set(r(b.color[ge]||0,"uint8"),4*ge)}this.color=ve}else this.color=r(b.color,"uint8");if(b.position||b.text||b.color||b.baseline||b.align||b.font||b.offset||b.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Te=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Te);for(var se=0;se<this.batch.length;se++)this.batch[se]={count:this.counts.length>1?this.counts[se]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[se]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*se,4*se+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[se]:this.opacity,baseline:null!=this.baselineOffset[se]?this.baselineOffset[se]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[se]?this.alignOffset[se]:this.alignOffset[0]:0,atlas:this.fontAtlas[se]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*se,2*se+2):this.positionOffset}}else this.batch=this.count?[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:[]},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={},Q.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(v,Q,$){(function(g){(function(){"use strict";var t=v("pick-by-alias");function k(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*g.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*g.innerHeight);else{var i=r.container.getBoundingClientRect();r.canvas.width=r.width||i.right-i.left,r.canvas.height=r.height||i.bottom-i.top}}function x(r){return"function"==typeof r.getContext&&"width"in r&&"height"in r}function e(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}Q.exports=function(r){var i,n;if(r?"string"==typeof r&&(r={container:r}):r={},(r=x(r)||"string"==typeof(i=r).nodeName&&"function"==typeof i.appendChild&&"function"==typeof i.getBoundingClientRect?{container:r}:"function"==typeof(n=r).drawArrays||"function"==typeof n.drawElements?{gl:r}:t(r,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(r.pixelRatio=g.pixelRatio||1),r.gl)return r.gl;if(r.canvas&&(r.container=r.canvas.parentNode),r.container){if("string"==typeof r.container){var c=document.querySelector(r.container);if(!c)throw Error("Element "+r.container+" is not found");r.container=c}x(r.container)?(r.canvas=r.container,r.container=r.canvas.parentNode):r.canvas||(r.canvas=e(),r.container.appendChild(r.canvas),k(r))}else if(!r.canvas){if("undefined"==typeof document)throw Error("Not DOM environment. Use headless-gl.");r.container=document.body||document.documentElement,r.canvas=e(),r.container.appendChild(r.canvas),k(r)}return r.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(n){try{r.gl=r.canvas.getContext(n,r.attrs)}catch(m){}return r.gl}),r.gl}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pick-by-alias":253}],227:[function(v,Q,$){Q.exports=function(g){"string"==typeof g&&(g=[g]);for(var t=[].slice.call(arguments,1),k=[],x=0;x<g.length-1;x++)k.push(g[x],t[x]||"");return k.push(g[x]),k.join("")}},{}],228:[function(v,Q,$){(function(g){(function(){"use strict";var t,k=v("is-browser");t="function"==typeof g.matchMedia?!g.matchMedia("(hover: none)").matches:k,Q.exports=t}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"is-browser":232}],229:[function(v,Q,$){"use strict";var g=v("is-browser");Q.exports=g&&function(){var t=!1;try{var k=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,k),window.removeEventListener("test",null,k)}catch(x){t=!1}return t}()},{"is-browser":232}],230:[function(v,Q,$){$.read=function(g,t,k,x,e){var r,i,c=8*e-x-1,n=(1<<c)-1,m=n>>1,p=-7,s=k?e-1:0,f=k?-1:1,l=g[t+s];for(s+=f,r=l&(1<<-p)-1,l>>=-p,p+=c;p>0;r=256*r+g[t+s],s+=f,p-=8);for(i=r&(1<<-p)-1,r>>=-p,p+=x;p>0;i=256*i+g[t+s],s+=f,p-=8);if(0===r)r=1-m;else{if(r===n)return i?NaN:1/0*(l?-1:1);i+=Math.pow(2,x),r-=m}return(l?-1:1)*i*Math.pow(2,r-x)},$.write=function(g,t,k,x,e,r){var i,c,n,m=8*r-e-1,p=(1<<m)-1,s=p>>1,f=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,l=x?0:r-1,o=x?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,i=p):(i=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-i))<1&&(i--,n*=2),(t+=i+s>=1?f/n:f*Math.pow(2,1-s))*n>=2&&(i++,n/=2),i+s>=p?(c=0,i=p):i+s>=1?(c=(t*n-1)*Math.pow(2,e),i+=s):(c=t*Math.pow(2,s-1)*Math.pow(2,e),i=0));e>=8;g[k+l]=255&c,l+=o,c/=256,e-=8);for(i=i<<e|c,m+=e;m>0;g[k+l]=255&i,l+=o,i/=256,m-=8);g[k+l-o]|=128*d}},{}],231:[function(v,Q,$){Q.exports="function"==typeof Object.create?function(g,t){t&&(g.super_=t,g.prototype=Object.create(t.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}))}:function(g,t){if(t){g.super_=t;var k=function(){};k.prototype=t.prototype,g.prototype=new k,g.prototype.constructor=g}}},{}],232:[function(v,Q,$){Q.exports=!0},{}],233:[function(v,Q,$){"use strict";Q.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(v,Q,$){"use strict";Q.exports=k,Q.exports.isMobile=k,Q.exports.default=k;var g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function k(x){x||(x={});var e=x.ua;if(e||"undefined"==typeof navigator||(e=navigator.userAgent),e&&e.headers&&"string"==typeof e.headers["user-agent"]&&(e=e.headers["user-agent"]),"string"!=typeof e)return!1;var r=x.tablet?t.test(e):g.test(e);return!r&&x.tablet&&x.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==e.indexOf("Macintosh")&&-1!==e.indexOf("Safari")&&(r=!0),r}},{}],235:[function(v,Q,$){"use strict";Q.exports=function(g){var t=typeof g;return null!==g&&("object"===t||"function"===t)}},{}],236:[function(v,Q,$){"use strict";var g=Object.prototype.toString;Q.exports=function(t){var k;return"[object Object]"===g.call(t)&&(null===(k=Object.getPrototypeOf(t))||k===Object.getPrototypeOf({}))}},{}],237:[function(v,Q,$){"use strict";Q.exports=function(g){for(var t,k=g.length,x=0;x<k;x++)if(((t=g.charCodeAt(x))<9||t>13)&&32!==t&&133!==t&&160!==t&&5760!==t&&6158!==t&&(t<8192||t>8205)&&8232!==t&&8233!==t&&8239!==t&&8287!==t&&8288!==t&&12288!==t&&65279!==t)return!1;return!0}},{}],238:[function(v,Q,$){"use strict";Q.exports=function(g){return"string"==typeof g&&(g=g.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(g)&&/[\dz]$/i.test(g)&&g.length>4))}},{}],239:[function(v,Q,$){var g,t;g=this,t=function(){"use strict";var g,t,k;function x(e,r){if(g)if(t){var i="var sharedChunk = {}; ("+g+")(sharedChunk); ("+t+")(sharedChunk);",c={};g(c),(k=r(c)).workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}else t=r;else g=r}return x(0,function(e){function r(A,O){return A(O={exports:{}},O.exports),O.exports}var i=c;function c(A,O,Y,ie){this.cx=3*A,this.bx=3*(Y-A)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(ie-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=A,this.p1y=ie,this.p2x=Y,this.p2y=ie}c.prototype.sampleCurveX=function(A){return((this.ax*A+this.bx)*A+this.cx)*A},c.prototype.sampleCurveY=function(A){return((this.ay*A+this.by)*A+this.cy)*A},c.prototype.sampleCurveDerivativeX=function(A){return(3*this.ax*A+2*this.bx)*A+this.cx},c.prototype.solveCurveX=function(A,O){var Y,ie,me,we,ze;for(void 0===O&&(O=1e-6),me=A,ze=0;ze<8;ze++){if(we=this.sampleCurveX(me)-A,Math.abs(we)<O)return me;var Ve=this.sampleCurveDerivativeX(me);if(Math.abs(Ve)<1e-6)break;me-=we/Ve}if((me=A)<(Y=0))return Y;if(me>(ie=1))return ie;for(;Y<ie;){if(we=this.sampleCurveX(me),Math.abs(we-A)<O)return me;A>we?Y=me:ie=me,me=.5*(ie-Y)+Y}return me},c.prototype.solve=function(A,O){return this.sampleCurveY(this.solveCurveX(A,O))};var n=m;function m(A,O){this.x=A,this.y=O}function p(A,O,Y,ie){var me=new i(A,O,Y,ie);return function(we){return me.solve(we)}}m.prototype={clone:function(){return new m(this.x,this.y)},add:function(A){return this.clone()._add(A)},sub:function(A){return this.clone()._sub(A)},multByPoint:function(A){return this.clone()._multByPoint(A)},divByPoint:function(A){return this.clone()._divByPoint(A)},mult:function(A){return this.clone()._mult(A)},div:function(A){return this.clone()._div(A)},rotate:function(A){return this.clone()._rotate(A)},rotateAround:function(A,O){return this.clone()._rotateAround(A,O)},matMult:function(A){return this.clone()._matMult(A)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(A){return this.x===A.x&&this.y===A.y},dist:function(A){return Math.sqrt(this.distSqr(A))},distSqr:function(A){var O=A.x-this.x,Y=A.y-this.y;return O*O+Y*Y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(A){return Math.atan2(this.y-A.y,this.x-A.x)},angleWith:function(A){return this.angleWithSep(A.x,A.y)},angleWithSep:function(A,O){return Math.atan2(this.x*O-this.y*A,this.x*A+this.y*O)},_matMult:function(A){var Y=A[2]*this.x+A[3]*this.y;return this.x=A[0]*this.x+A[1]*this.y,this.y=Y,this},_add:function(A){return this.x+=A.x,this.y+=A.y,this},_sub:function(A){return this.x-=A.x,this.y-=A.y,this},_mult:function(A){return this.x*=A,this.y*=A,this},_div:function(A){return this.x/=A,this.y/=A,this},_multByPoint:function(A){return this.x*=A.x,this.y*=A.y,this},_divByPoint:function(A){return this.x/=A.x,this.y/=A.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var A=this.y;return this.y=this.x,this.x=-A,this},_rotate:function(A){var O=Math.cos(A),Y=Math.sin(A),me=Y*this.x+O*this.y;return this.x=O*this.x-Y*this.y,this.y=me,this},_rotateAround:function(A,O){var Y=Math.cos(A),ie=Math.sin(A),we=O.y+ie*(this.x-O.x)+Y*(this.y-O.y);return this.x=O.x+Y*(this.x-O.x)-ie*(this.y-O.y),this.y=we,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(A){return A instanceof m?A:Array.isArray(A)?new m(A[0],A[1]):A};var s=p(.25,.1,.25,1);function f(A,O,Y){return Math.min(Y,Math.max(O,A))}function l(A,O,Y){var ie=Y-O,me=((A-O)%ie+ie)%ie+O;return me===O?Y:me}function o(A){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];for(var ie=0,me=O;ie<me.length;ie+=1){var we=me[ie];for(var ze in we)A[ze]=we[ze]}return A}var d=1;function u(){return d++}function a(){return function A(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,A)}()}function y(A){return!!A&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(A)}function h(A,O){A.forEach(function(Y){O[Y]&&(O[Y]=O[Y].bind(O))})}function _(A,O){return-1!==A.indexOf(O,A.length-O.length)}function b(A,O,Y){var ie={};for(var me in A)ie[me]=O.call(Y||this,A[me],me,A);return ie}function w(A,O,Y){var ie={};for(var me in A)O.call(Y||this,A[me],me,A)&&(ie[me]=A[me]);return ie}function T(A){return Array.isArray(A)?A.map(T):"object"==typeof A&&A?b(A,T):A}var L={};function M(A){L[A]||("undefined"!=typeof console&&console.warn(A),L[A]=!0)}function P(A,O,Y){return(Y.y-A.y)*(O.x-A.x)>(O.y-A.y)*(Y.x-A.x)}function z(A){for(var O=0,Y=0,ie=A.length,me=ie-1,we=void 0,ze=void 0;Y<ie;me=Y++)O+=((ze=A[me]).x-(we=A[Y]).x)*(we.y+ze.y);return O}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function C(A){var O={};if(A.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ie,me,we,ze){var Ve=we||ze;return O[me]=!Ve||Ve.toLowerCase(),""}),O["max-age"]){var Y=parseInt(O["max-age"],10);isNaN(Y)?delete O["max-age"]:O["max-age"]=Y}return O}var R=null;function D(A){if(null==R){var O=A.navigator?A.navigator.userAgent:null;R=!!A.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return R}function j(A){try{var O=self[A];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch(Y){return!1}}var q,Z,W,G,X=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),ne=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,V=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,N={now:X,frame:function(A){var O=ne(A);return{cancel:function(){return V(O)}}},getImageData:function(A,O){void 0===O&&(O=0);var Y=self.document.createElement("canvas"),ie=Y.getContext("2d");if(!ie)throw new Error("failed to create canvas 2d context");return Y.width=A.width,Y.height=A.height,ie.drawImage(A,0,0,A.width,A.height),ie.getImageData(-O,-O,A.width+2*O,A.height+2*O)},resolveURL:function(A){return q||(q=self.document.createElement("a")),q.href=A,q.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==Z&&(Z=self.matchMedia("(prefers-reduced-motion: reduce)")),Z.matches)}},U={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(A){B||!G||(K?J(A):W=A)}},B=!1,K=!1;function J(A){var O=A.createTexture();A.bindTexture(A.TEXTURE_2D,O);try{if(A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,G),A.isContextLost())return;ee.supported=!0}catch(Y){}A.deleteTexture(O),B=!0}self.document&&((G=self.document.createElement("img")).onload=function(){W&&J(W),W=null,K=!0},G.onerror=function(){B=!0,W=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var te="01",ae=function(A,O){this._transformRequestFn=A,this._customAccessToken=O,this._createSkuToken()};function ce(A){return 0===A.indexOf("mapbox:")}ae.prototype._createSkuToken=function(){var A=function(){for(var O="",Y=0;Y<10;Y++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",te,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=A.token,this._skuTokenExpiresAt=A.tokenExpiresAt},ae.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ae.prototype.transformRequest=function(A,O){return this._transformRequestFn&&this._transformRequestFn(A,O)||{url:A}},ae.prototype.normalizeStyleURL=function(A,O){if(!ce(A))return A;var Y=xe(A);return Y.path="/styles/v1"+Y.path,this._makeAPIURL(Y,this._customAccessToken||O)},ae.prototype.normalizeGlyphsURL=function(A,O){if(!ce(A))return A;var Y=xe(A);return Y.path="/fonts/v1"+Y.path,this._makeAPIURL(Y,this._customAccessToken||O)},ae.prototype.normalizeSourceURL=function(A,O){if(!ce(A))return A;var Y=xe(A);return Y.path="/v4/"+Y.authority+".json",Y.params.push("secure"),this._makeAPIURL(Y,this._customAccessToken||O)},ae.prototype.normalizeSpriteURL=function(A,O,Y,ie){var me=xe(A);return ce(A)?(me.path="/styles/v1"+me.path+"/sprite"+O+Y,this._makeAPIURL(me,this._customAccessToken||ie)):(me.path+=""+O+Y,Se(me))},ae.prototype.normalizeTileURL=function(A,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),A&&!ce(A))return A;var Y=xe(A);Y.path=Y.path.replace(/(\.(png|jpg)\d*)(?=$)/,(N.devicePixelRatio>=2||512===O?"@2x":"")+(ee.supported?".webp":"$1")),Y.path=Y.path.replace(/^.+\/v4\//,"/"),Y.path="/v4"+Y.path;var we=this._customAccessToken||function(ze){for(var Ve=0,nt=ze;Ve<nt.length;Ve+=1){var ht=nt[Ve].match(/^access_token=(.*)$/);if(ht)return ht[1]}return null}(Y.params)||U.ACCESS_TOKEN;return U.REQUIRE_ACCESS_TOKEN&&we&&this._skuToken&&Y.params.push("sku="+this._skuToken),this._makeAPIURL(Y,we)},ae.prototype.canonicalizeTileURL=function(A,O){var Y=xe(A);if(!Y.path.match(/(^\/v4\/)/)||!Y.path.match(/\.[\w]+$/))return A;var ie="mapbox://tiles/";ie+=Y.path.replace("/v4/","");var me=Y.params;return O&&(me=me.filter(function(we){return!we.match(/^access_token=/)})),me.length&&(ie+="?"+me.join("&")),ie},ae.prototype.canonicalizeTileset=function(A,O){for(var Y=!!O&&ce(O),ie=[],me=0,we=A.tiles||[];me<we.length;me+=1){var ze=we[me];ve(ze)?ie.push(this.canonicalizeTileURL(ze,Y)):ie.push(ze)}return ie},ae.prototype._makeAPIURL=function(A,O){var Y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ie=xe(U.API_URL);if(A.protocol=ie.protocol,A.authority=ie.authority,"/"!==ie.path&&(A.path=""+ie.path+A.path),!U.REQUIRE_ACCESS_TOKEN)return Se(A);if(!(O=O||U.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+Y);if("s"===O[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Y);return A.params=A.params.filter(function(me){return-1===me.indexOf("access_token")}),A.params.push("access_token="+O),Se(A)};var oe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ve(A){return oe.test(A)}var fe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(A){var O=A.match(fe);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function Se(A){var O=A.params.length?"?"+A.params.join("&"):"";return A.protocol+"://"+A.authority+A.path+O}function pe(A){if(!A)return null;var Y=A.split(".");if(!Y||3!==Y.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(Y[1]).split("").map(function(ie){return"%"+("00"+ie.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(ie){return null}}var ge=function(A){this.type=A,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ge.prototype.getStorageKey=function(A){var ie,Y=pe(U.ACCESS_TOKEN);return ie=Y&&Y.u?self.btoa(encodeURIComponent(Y.u).replace(/%([0-9A-F]{2})/g,function(me,we){return String.fromCharCode(Number("0x"+we))})):U.ACCESS_TOKEN||"",A?"mapbox.eventData."+A+":"+ie:"mapbox.eventData:"+ie},ge.prototype.fetchEventData=function(){var A=j("localStorage"),O=this.getStorageKey(),Y=this.getStorageKey("uuid");if(A)try{var ie=self.localStorage.getItem(O);ie&&(this.eventData=JSON.parse(ie));var me=self.localStorage.getItem(Y);me&&(this.anonId=me)}catch(we){M("Unable to read from LocalStorage")}},ge.prototype.saveEventData=function(){var A=j("localStorage"),O=this.getStorageKey(),Y=this.getStorageKey("uuid");if(A)try{self.localStorage.setItem(Y,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch(ie){M("Unable to write to LocalStorage")}},ge.prototype.processRequests=function(A){},ge.prototype.postEvent=function(A,O,Y,ie){var me=this;if(U.EVENTS_URL){var we=xe(U.EVENTS_URL);we.params.push("access_token="+(ie||U.ACCESS_TOKEN||""));var ze={event:this.type,created:new Date(A).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:te,userId:this.anonId},Ve=O?o(ze,O):ze,nt={url:Se(we),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Ve])};this.pendingRequest=Vt(nt,function(ht){me.pendingRequest=null,Y(ht),me.saveEventData(),me.processRequests(ie)})}},ge.prototype.queueRequest=function(A,O){this.queue.push(A),this.processRequests(O)};var Te,se,de=function(A){function O(){A.call(this,"map.load"),this.success={},this.skuToken=""}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.postMapLoadEvent=function(Y,ie,me,we){this.skuToken=me,(U.EVENTS_URL&&we||U.ACCESS_TOKEN&&Array.isArray(Y)&&Y.some(function(ze){return ce(ze)||ve(ze)}))&&this.queueRequest({id:ie,timestamp:Date.now()},we)},O.prototype.processRequests=function(Y){var ie=this;if(!this.pendingRequest&&0!==this.queue.length){var me=this.queue.shift(),we=me.id,ze=me.timestamp;we&&this.success[we]||(this.anonId||this.fetchEventData(),y(this.anonId)||(this.anonId=a()),this.postEvent(ze,{skuToken:this.skuToken},function(Ve){Ve||we&&(ie.success[we]=!0)},Y))}},O}(ge),Ae=new(function(A){function O(Y){A.call(this,"appUserTurnstile"),this._customAccessToken=Y}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.postTurnstileEvent=function(Y,ie){U.EVENTS_URL&&U.ACCESS_TOKEN&&Array.isArray(Y)&&Y.some(function(me){return ce(me)||ve(me)})&&this.queueRequest(Date.now(),ie)},O.prototype.processRequests=function(Y){var ie=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var me=pe(U.ACCESS_TOKEN),we=me?me.u:U.ACCESS_TOKEN,ze=we!==this.eventData.tokenU;y(this.anonId)||(this.anonId=a(),ze=!0);var Ve=this.queue.shift();if(this.eventData.lastSuccess){var nt=new Date(this.eventData.lastSuccess),ht=new Date(Ve),xt=(Ve-this.eventData.lastSuccess)/864e5;ze=ze||xt>=1||xt<-1||nt.getDate()!==ht.getDate()}else ze=!0;if(!ze)return this.processRequests();this.postEvent(Ve,{"enabled.telemetry":!1},function(Ut){Ut||(ie.eventData.lastSuccess=Ve,ie.eventData.tokenU=we)},Y)}},O}(ge)),Le=Ae.postTurnstileEvent.bind(Ae),Me=new de,De=Me.postMapLoadEvent.bind(Me),Oe=500,Ie=50;function Qe(){self.caches&&!Te&&(Te=self.caches.open("mapbox-tiles"))}function Pe(A){var O=A.indexOf("?");return O<0?A:A.slice(0,O)}var Ge,tt=1/0;function ct(){return null==Ge&&(Ge=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Ge}var wt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(wt);var kt=function(A){function O(Y,ie,me){401===ie&&ve(me)&&(Y+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),A.call(this,Y),this.status=ie,this.url=me,this.name=this.constructor.name,this.message=Y}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),gt=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href};function at(A,O){var Y,ie=new self.AbortController,me=new self.Request(A.url,{method:A.method||"GET",body:A.body,credentials:A.credentials,headers:A.headers,referrer:gt(),signal:ie.signal}),we=!1,ze=!1,Ve=(Y=me.url).indexOf("sku=")>0&&ve(Y);"json"===A.type&&me.headers.set("Accept","application/json");var nt=function(xt,Ut,$t){if(!ze){if(xt&&"SecurityError"!==xt.message&&M(xt),Ut&&$t)return ht(Ut);var Wt=Date.now();self.fetch(me).then(function(fn){if(fn.ok){var An=Ve?fn.clone():null;return ht(fn,An,Wt)}return O(new kt(fn.statusText,fn.status,A.url))}).catch(function(fn){20!==fn.code&&O(new Error(fn.message))})}},ht=function(xt,Ut,$t){("arrayBuffer"===A.type?xt.arrayBuffer():"json"===A.type?xt.json():xt.text()).then(function(Wt){ze||(Ut&&$t&&function Ne(A,O,Y){if(Qe(),Te){var ie={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(we,ze){return ie.headers.set(ze,we)});var me=C(O.headers.get("Cache-Control")||"");me["no-store"]||(me["max-age"]&&ie.headers.set("Expires",new Date(Y+1e3*me["max-age"]).toUTCString()),new Date(ie.headers.get("Expires")).getTime()-Y<42e4||function(we,ze){if(void 0===se)try{new Response(new ReadableStream),se=!0}catch(Ve){se=!1}se?ze(we.body):we.blob().then(ze)}(O,function(we){var ze=new self.Response(we,ie);Qe(),Te&&Te.then(function(Ve){return Ve.put(Pe(A.url),ze)}).catch(function(Ve){return M(Ve.message)})}))}}(me,Ut,$t),we=!0,O(null,Wt,xt.headers.get("Cache-Control"),xt.headers.get("Expires")))}).catch(function(Wt){ze||O(new Error(Wt.message))})};return Ve?function Re(A,O){if(Qe(),!Te)return O(null);var Y=Pe(A.url);Te.then(function(ie){ie.match(Y).then(function(me){var we=function(ze){if(!ze)return!1;var Ve=new Date(ze.headers.get("Expires")||0),nt=C(ze.headers.get("Cache-Control")||"");return Ve>Date.now()&&!nt["no-cache"]}(me);ie.delete(Y),we&&ie.put(Y,me.clone()),O(null,me,we)}).catch(O)}).catch(O)}(me,nt):nt(null,null),{cancel:function(){ze=!0,we||ie.abort()}}}var Gt,en,et=function(A,O){if(!(/^file:/.test(Y=A.url)||/^file:/.test(gt())&&!/^\w+:/.test(Y))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return at(A,O);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",A,O,void 0,!0)}var Y;return function(ie,me){var we=new self.XMLHttpRequest;for(var ze in we.open(ie.method||"GET",ie.url,!0),"arrayBuffer"===ie.type&&(we.responseType="arraybuffer"),ie.headers)we.setRequestHeader(ze,ie.headers[ze]);return"json"===ie.type&&(we.responseType="text",we.setRequestHeader("Accept","application/json")),we.withCredentials="include"===ie.credentials,we.onerror=function(){me(new Error(we.statusText))},we.onload=function(){if((we.status>=200&&we.status<300||0===we.status)&&null!==we.response){var Ve=we.response;if("json"===ie.type)try{Ve=JSON.parse(we.response)}catch(nt){return me(nt)}me(null,Ve,we.getResponseHeader("Cache-Control"),we.getResponseHeader("Expires"))}else me(new kt(we.statusText,we.status,ie.url))},we.send(ie.body),{cancel:function(){return we.abort()}}}(A,O)},yt=function(A,O){return et(o(A,{type:"arrayBuffer"}),O)},Vt=function(A,O){return et(o(A,{method:"POST"}),O)};Gt=[],en=0;var Jt=function(A,O){if(ee.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),en>=U.MAX_PARALLEL_IMAGE_REQUESTS){var Y={requestParameters:A,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return Gt.push(Y),Y}en++;var ie=!1,me=function(){if(!ie)for(ie=!0,en--;Gt.length&&en<U.MAX_PARALLEL_IMAGE_REQUESTS;){var ze=Gt.shift();ze.cancelled||(ze.cancel=Jt(ze.requestParameters,ze.callback).cancel)}},we=yt(A,function(ze,Ve,nt,ht){var Ut,$t;me(),ze?O(ze):Ve&&(ct()?(Ut=O,$t=new self.Blob([new Uint8Array(Ve)],{type:"image/png"}),self.createImageBitmap($t).then(function(Wt){Ut(null,Wt)}).catch(function(Wt){Ut(new Error("Could not load image because of "+Wt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(xt,Ut,$t,Wt){var fn=new self.Image,An=self.URL;fn.onload=function(){Ut(null,fn),An.revokeObjectURL(fn.src)},fn.onerror=function(){return Ut(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Bn=new self.Blob([new Uint8Array(xt)],{type:"image/png"});fn.cacheControl=$t,fn.expires=Wt,fn.src=xt.byteLength?An.createObjectURL(Bn):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(Ve,O,nt,ht))});return{cancel:function(){we.cancel(),me()}}};function cn(A,O,Y){Y[A]&&-1!==Y[A].indexOf(O)||(Y[A]=Y[A]||[],Y[A].push(O))}function Rt(A,O,Y){if(Y&&Y[A]){var ie=Y[A].indexOf(O);-1!==ie&&Y[A].splice(ie,1)}}var je=function(A,O){void 0===O&&(O={}),o(this,O),this.type=A},Ye=function(A){function O(Y,ie){void 0===ie&&(ie={}),A.call(this,"error",o({error:Y},ie))}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(je),he=function(){};he.prototype.on=function(A,O){return this._listeners=this._listeners||{},cn(A,O,this._listeners),this},he.prototype.off=function(A,O){return Rt(A,O,this._listeners),Rt(A,O,this._oneTimeListeners),this},he.prototype.once=function(A,O){return this._oneTimeListeners=this._oneTimeListeners||{},cn(A,O,this._oneTimeListeners),this},he.prototype.fire=function(A,O){"string"==typeof A&&(A=new je(A,O||{}));var Y=A.type;if(this.listens(Y)){A.target=this;for(var ie=0,me=this._listeners&&this._listeners[Y]?this._listeners[Y].slice():[];ie<me.length;ie+=1)me[ie].call(this,A);for(var we=0,ze=this._oneTimeListeners&&this._oneTimeListeners[Y]?this._oneTimeListeners[Y].slice():[];we<ze.length;we+=1){var Ve=ze[we];Rt(Y,Ve,this._oneTimeListeners),Ve.call(this,A)}var nt=this._eventedParent;nt&&(o(A,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),nt.fire(A))}else A instanceof Ye&&console.error(A.error);return this},he.prototype.listens=function(A){return this._listeners&&this._listeners[A]&&this._listeners[A].length>0||this._oneTimeListeners&&this._oneTimeListeners[A]&&this._oneTimeListeners[A].length>0||this._eventedParent&&this._eventedParent.listens(A)},he.prototype.setEventedParent=function(A,O){return this._eventedParent=A,this._eventedParentData=O,this};var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Fe=function(A,O,Y,ie){this.message=(A?A+": ":"")+Y,ie&&(this.identifier=ie),null!=O&&O.__line__&&(this.line=O.__line__)};function He(A){var Y=A.value;return Y?[new Fe(A.key,Y,"constants have been deprecated as of v8")]:[]}function Ke(A){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];for(var ie=0,me=O;ie<me.length;ie+=1){var we=me[ie];for(var ze in we)A[ze]=we[ze]}return A}function Ze(A){return A instanceof Number||A instanceof String||A instanceof Boolean?A.valueOf():A}function ut(A){if(Array.isArray(A))return A.map(ut);if(A instanceof Object&&!(A instanceof Number||A instanceof String||A instanceof Boolean)){var O={};for(var Y in A)O[Y]=ut(A[Y]);return O}return Ze(A)}var lt=function(A){function O(Y,ie){A.call(this,ie),this.message=ie,this.key=Y}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Error),Lt=function(A,O){void 0===O&&(O=[]),this.parent=A,this.bindings={};for(var Y=0,ie=O;Y<ie.length;Y+=1){var me=ie[Y];this.bindings[me[0]]=me[1]}};Lt.prototype.concat=function(A){return new Lt(this,A)},Lt.prototype.get=function(A){if(this.bindings[A])return this.bindings[A];if(this.parent)return this.parent.get(A);throw new Error(A+" not found in scope.")},Lt.prototype.has=function(A){return!!this.bindings[A]||!!this.parent&&this.parent.has(A)};var Ot={kind:"null"},ot={kind:"number"},pt={kind:"string"},qt={kind:"boolean"},St={kind:"color"},Mt={kind:"object"},Ce={kind:"value"},Xe={kind:"collator"},st={kind:"formatted"},dt={kind:"resolvedImage"};function zt(A,O){return{kind:"array",itemType:A,N:O}}function Ht(A){if("array"===A.kind){var O=Ht(A.itemType);return"number"==typeof A.N?"array<"+O+", "+A.N+">":"value"===A.itemType.kind?"array":"array<"+O+">"}return A.kind}var Kt=[Ot,ot,pt,qt,St,st,Mt,zt(Ce),dt];function Zt(A,O){if("error"===O.kind)return null;if("array"===A.kind){if("array"===O.kind&&(0===O.N&&"value"===O.itemType.kind||!Zt(A.itemType,O.itemType))&&("number"!=typeof A.N||A.N===O.N))return null}else{if(A.kind===O.kind)return null;if("value"===A.kind)for(var Y=0,ie=Kt;Y<ie.length;Y+=1)if(!Zt(ie[Y],O))return null}return"Expected "+Ht(A)+" but found "+Ht(O)+" instead."}function vn(A,O){return O.some(function(Y){return Y.kind===A.kind})}function zn(A,O){return O.some(function(Y){return"null"===Y?null===A:"array"===Y?Array.isArray(A):"object"===Y?A&&!Array.isArray(A)&&"object"==typeof A:Y===typeof A})}var gn=r(function(A,O){var Y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ie(nt){return(nt=Math.round(nt))<0?0:nt>255?255:nt}function we(nt){return ie("%"===nt[nt.length-1]?parseFloat(nt)/100*255:parseInt(nt))}function ze(nt){return function me(nt){return nt<0?0:nt>1?1:nt}("%"===nt[nt.length-1]?parseFloat(nt)/100:parseFloat(nt))}function Ve(nt,ht,xt){return xt<0?xt+=1:xt>1&&(xt-=1),6*xt<1?nt+(ht-nt)*xt*6:2*xt<1?ht:3*xt<2?nt+(ht-nt)*(2/3-xt)*6:nt}try{O.parseCSSColor=function(nt){var ht,xt=nt.replace(/ /g,"").toLowerCase();if(xt in Y)return Y[xt].slice();if("#"===xt[0])return 4===xt.length?(ht=parseInt(xt.substr(1),16))>=0&&ht<=4095?[(3840&ht)>>4|(3840&ht)>>8,240&ht|(240&ht)>>4,15&ht|(15&ht)<<4,1]:null:7===xt.length&&(ht=parseInt(xt.substr(1),16))>=0&&ht<=16777215?[(16711680&ht)>>16,(65280&ht)>>8,255&ht,1]:null;var Ut=xt.indexOf("("),$t=xt.indexOf(")");if(-1!==Ut&&$t+1===xt.length){var Wt=xt.substr(0,Ut),fn=xt.substr(Ut+1,$t-(Ut+1)).split(","),An=1;switch(Wt){case"rgba":if(4!==fn.length)return null;An=ze(fn.pop());case"rgb":return 3!==fn.length?null:[we(fn[0]),we(fn[1]),we(fn[2]),An];case"hsla":if(4!==fn.length)return null;An=ze(fn.pop());case"hsl":if(3!==fn.length)return null;var Bn=(parseFloat(fn[0])%360+360)%360/360,Nn=ze(fn[1]),Gn=ze(fn[2]),Jn=Gn<=.5?Gn*(Nn+1):Gn+Nn-Gn*Nn,tr=2*Gn-Jn;return[ie(255*Ve(tr,Jn,Bn+1/3)),ie(255*Ve(tr,Jn,Bn)),ie(255*Ve(tr,Jn,Bn-1/3)),An];default:return null}}return null}}catch(nt){}}).parseCSSColor,nn=function(A,O,Y,ie){void 0===ie&&(ie=1),this.r=A,this.g=O,this.b=Y,this.a=ie};nn.parse=function(A){if(A){if(A instanceof nn)return A;if("string"==typeof A){var O=gn(A);if(O)return new nn(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},nn.prototype.toString=function(){var A=this.toArray(),Y=A[1],ie=A[2],me=A[3];return"rgba("+Math.round(A[0])+","+Math.round(Y)+","+Math.round(ie)+","+me+")"},nn.prototype.toArray=function(){var ie=this.a;return 0===ie?[0,0,0,0]:[255*this.r/ie,255*this.g/ie,255*this.b/ie,ie]},nn.black=new nn(0,0,0,1),nn.white=new nn(1,1,1,1),nn.transparent=new nn(0,0,0,0),nn.red=new nn(1,0,0,1);var an=function(A,O,Y){this.sensitivity=A?O?"variant":"case":O?"accent":"base",this.locale=Y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};an.prototype.compare=function(A,O){return this.collator.compare(A,O)},an.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var on=function(A,O,Y,ie,me){this.text=A,this.image=O,this.scale=Y,this.fontStack=ie,this.textColor=me},mn=function(A){this.sections=A};mn.fromString=function(A){return new mn([new on(A,null,null,null,null)])},mn.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(A){return 0!==A.text.length||A.image&&0!==A.image.name.length})},mn.factory=function(A){return A instanceof mn?A:mn.fromString(A)},mn.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(A){return A.text}).join("")},mn.prototype.serialize=function(){for(var A=["format"],O=0,Y=this.sections;O<Y.length;O+=1){var ie=Y[O];if(ie.image)A.push(["image",ie.image.name]);else{A.push(ie.text);var me={};ie.fontStack&&(me["text-font"]=["literal",ie.fontStack.split(",")]),ie.scale&&(me["font-scale"]=ie.scale),ie.textColor&&(me["text-color"]=["rgba"].concat(ie.textColor.toArray())),A.push(me)}}return A};var _n=function(A){this.name=A.name,this.available=A.available};function Pn(A,O,Y,ie){return"number"==typeof A&&A>=0&&A<=255&&"number"==typeof O&&O>=0&&O<=255&&"number"==typeof Y&&Y>=0&&Y<=255?void 0===ie||"number"==typeof ie&&ie>=0&&ie<=1?null:"Invalid rgba value ["+[A,O,Y,ie].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof ie?[A,O,Y,ie]:[A,O,Y]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Rn(A){if(null===A||"string"==typeof A||"boolean"==typeof A||"number"==typeof A||A instanceof nn||A instanceof an||A instanceof mn||A instanceof _n)return!0;if(Array.isArray(A)){for(var O=0,Y=A;O<Y.length;O+=1)if(!Rn(Y[O]))return!1;return!0}if("object"==typeof A){for(var ie in A)if(!Rn(A[ie]))return!1;return!0}return!1}function qn(A){if(null===A)return Ot;if("string"==typeof A)return pt;if("boolean"==typeof A)return qt;if("number"==typeof A)return ot;if(A instanceof nn)return St;if(A instanceof an)return Xe;if(A instanceof mn)return st;if(A instanceof _n)return dt;if(Array.isArray(A)){for(var O,Y=A.length,ie=0,me=A;ie<me.length;ie+=1){var we=qn(me[ie]);if(O){if(O===we)continue;O=Ce;break}O=we}return zt(O||Ce,Y)}return Mt}function Xn(A){var O=typeof A;return null===A?"":"string"===O||"number"===O||"boolean"===O?String(A):A instanceof nn||A instanceof mn||A instanceof _n?A.toString():JSON.stringify(A)}_n.prototype.toString=function(){return this.name},_n.fromString=function(A){return A?new _n({name:A,available:!1}):null},_n.prototype.serialize=function(){return["image",this.name]};var br=function(A,O){this.type=A,this.value=O};br.parse=function(A,O){if(2!==A.length)return O.error("'literal' expression requires exactly one argument, but found "+(A.length-1)+" instead.");if(!Rn(A[1]))return O.error("invalid value");var Y=A[1],ie=qn(Y),me=O.expectedType;return"array"!==ie.kind||0!==ie.N||!me||"array"!==me.kind||"number"==typeof me.N&&0!==me.N||(ie=me),new br(ie,Y)},br.prototype.evaluate=function(){return this.value},br.prototype.eachChild=function(){},br.prototype.outputDefined=function(){return!0},br.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof nn?["rgba"].concat(this.value.toArray()):this.value instanceof mn?this.value.serialize():this.value};var fr=function(A){this.name="ExpressionEvaluationError",this.message=A};fr.prototype.toJSON=function(){return this.message};var Vr={string:pt,number:ot,boolean:qt,object:Mt},cr=function(A,O){this.type=A,this.args=O};cr.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var Y,ie=1,me=A[0];if("array"===me){var we,ze;if(A.length>2){var Ve=A[1];if("string"!=typeof Ve||!(Ve in Vr)||"object"===Ve)return O.error('The item type argument of "array" must be one of string, number, boolean',1);we=Vr[Ve],ie++}else we=Ce;if(A.length>3){if(null!==A[2]&&("number"!=typeof A[2]||A[2]<0||A[2]!==Math.floor(A[2])))return O.error('The length argument to "array" must be a positive integer literal',2);ze=A[2],ie++}Y=zt(we,ze)}else Y=Vr[me];for(var nt=[];ie<A.length;ie++){var ht=O.parse(A[ie],ie,Ce);if(!ht)return null;nt.push(ht)}return new cr(Y,nt)},cr.prototype.evaluate=function(A){for(var O=0;O<this.args.length;O++){var Y=this.args[O].evaluate(A);if(!Zt(this.type,qn(Y)))return Y;if(O===this.args.length-1)throw new fr("Expected value to be of type "+Ht(this.type)+", but found "+Ht(qn(Y))+" instead.")}return null},cr.prototype.eachChild=function(A){this.args.forEach(A)},cr.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},cr.prototype.serialize=function(){var A=this.type,O=[A.kind];if("array"===A.kind){var Y=A.itemType;if("string"===Y.kind||"number"===Y.kind||"boolean"===Y.kind){O.push(Y.kind);var ie=A.N;("number"==typeof ie||this.args.length>1)&&O.push(ie)}}return O.concat(this.args.map(function(me){return me.serialize()}))};var Sr=function(A){this.type=st,this.sections=A};Sr.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var Y=A[1];if(!Array.isArray(Y)&&"object"==typeof Y)return O.error("First argument must be an image or text section.");for(var ie=[],me=!1,we=1;we<=A.length-1;++we){var ze=A[we];if(me&&"object"==typeof ze&&!Array.isArray(ze)){me=!1;var Ve=null;if(ze["font-scale"]&&!(Ve=O.parse(ze["font-scale"],1,ot)))return null;var nt=null;if(ze["text-font"]&&!(nt=O.parse(ze["text-font"],1,zt(pt))))return null;var ht=null;if(ze["text-color"]&&!(ht=O.parse(ze["text-color"],1,St)))return null;var xt=ie[ie.length-1];xt.scale=Ve,xt.font=nt,xt.textColor=ht}else{var Ut=O.parse(A[we],1,Ce);if(!Ut)return null;var $t=Ut.type.kind;if("string"!==$t&&"value"!==$t&&"null"!==$t&&"resolvedImage"!==$t)return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");me=!0,ie.push({content:Ut,scale:null,font:null,textColor:null})}}return new Sr(ie)},Sr.prototype.evaluate=function(A){return new mn(this.sections.map(function(O){var Y=O.content.evaluate(A);return qn(Y)===dt?new on("",Y,null,null,null):new on(Xn(Y),null,O.scale?O.scale.evaluate(A):null,O.font?O.font.evaluate(A).join(","):null,O.textColor?O.textColor.evaluate(A):null)}))},Sr.prototype.eachChild=function(A){for(var O=0,Y=this.sections;O<Y.length;O+=1){var ie=Y[O];A(ie.content),ie.scale&&A(ie.scale),ie.font&&A(ie.font),ie.textColor&&A(ie.textColor)}},Sr.prototype.outputDefined=function(){return!1},Sr.prototype.serialize=function(){for(var A=["format"],O=0,Y=this.sections;O<Y.length;O+=1){var ie=Y[O];A.push(ie.content.serialize());var me={};ie.scale&&(me["font-scale"]=ie.scale.serialize()),ie.font&&(me["text-font"]=ie.font.serialize()),ie.textColor&&(me["text-color"]=ie.textColor.serialize()),A.push(me)}return A};var Cr=function(A){this.type=dt,this.input=A};Cr.parse=function(A,O){if(2!==A.length)return O.error("Expected two arguments.");var Y=O.parse(A[1],1,pt);return Y?new Cr(Y):O.error("No image name provided.")},Cr.prototype.evaluate=function(A){var O=this.input.evaluate(A),Y=_n.fromString(O);return Y&&A.availableImages&&(Y.available=A.availableImages.indexOf(O)>-1),Y},Cr.prototype.eachChild=function(A){A(this.input)},Cr.prototype.outputDefined=function(){return!1},Cr.prototype.serialize=function(){return["image",this.input.serialize()]};var pi={"to-boolean":qt,"to-color":St,"to-number":ot,"to-string":pt},Yn=function(A,O){this.type=A,this.args=O};Yn.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var Y=A[0];if(("to-boolean"===Y||"to-string"===Y)&&2!==A.length)return O.error("Expected one argument.");for(var ie=pi[Y],me=[],we=1;we<A.length;we++){var ze=O.parse(A[we],we,Ce);if(!ze)return null;me.push(ze)}return new Yn(ie,me)},Yn.prototype.evaluate=function(A){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(A));if("color"===this.type.kind){for(var O,Y,ie=0,me=this.args;ie<me.length;ie+=1){if(Y=null,(O=me[ie].evaluate(A))instanceof nn)return O;if("string"==typeof O){var we=A.parseColor(O);if(we)return we}else if(Array.isArray(O)&&!(Y=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Pn(O[0],O[1],O[2],O[3])))return new nn(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new fr(Y||"Could not parse color from value '"+("string"==typeof O?O:String(JSON.stringify(O)))+"'")}if("number"===this.type.kind){for(var ze=null,Ve=0,nt=this.args;Ve<nt.length;Ve+=1){if(null===(ze=nt[Ve].evaluate(A)))return 0;var ht=Number(ze);if(!isNaN(ht))return ht}throw new fr("Could not convert "+JSON.stringify(ze)+" to number.")}return"formatted"===this.type.kind?mn.fromString(Xn(this.args[0].evaluate(A))):"resolvedImage"===this.type.kind?_n.fromString(Xn(this.args[0].evaluate(A))):Xn(this.args[0].evaluate(A))},Yn.prototype.eachChild=function(A){this.args.forEach(A)},Yn.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},Yn.prototype.serialize=function(){if("formatted"===this.type.kind)return new Sr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Cr(this.args[0]).serialize();var A=["to-"+this.type.kind];return this.eachChild(function(O){A.push(O.serialize())}),A};var ar=["Unknown","Point","LineString","Polygon"],Ar=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ar.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ar.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ar[this.feature.type]:this.feature.type:null},Ar.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ar.prototype.canonicalID=function(){return this.canonical},Ar.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ar.prototype.parseColor=function(A){var O=this._parseColorCache[A];return O||(O=this._parseColorCache[A]=nn.parse(A)),O};var sr=function(A,O,Y,ie){this.name=A,this.type=O,this._evaluate=Y,this.args=ie};sr.prototype.evaluate=function(A){return this._evaluate(A,this.args)},sr.prototype.eachChild=function(A){this.args.forEach(A)},sr.prototype.outputDefined=function(){return!1},sr.prototype.serialize=function(){return[this.name].concat(this.args.map(function(A){return A.serialize()}))},sr.parse=function(A,O){var Y,ie=A[0],me=sr.definitions[ie];if(!me)return O.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0);for(var we=Array.isArray(me)?me[0]:me.type,ze=Array.isArray(me)?[[me[1],me[2]]]:me.overloads,Ve=ze.filter(function(_i){var hi=_i[0];return!Array.isArray(hi)||hi.length===A.length-1}),nt=null,ht=0,xt=Ve;ht<xt.length;ht+=1){var Ut=xt[ht],$t=Ut[0],Wt=Ut[1];nt=new hr(O.registry,O.path,null,O.scope);for(var fn=[],An=!1,Bn=1;Bn<A.length;Bn++){var Nn=A[Bn],Gn=Array.isArray($t)?$t[Bn-1]:$t.type,Jn=nt.parse(Nn,1+fn.length,Gn);if(!Jn){An=!0;break}fn.push(Jn)}if(!An)if(Array.isArray($t)&&$t.length!==fn.length)nt.error("Expected "+$t.length+" arguments, but found "+fn.length+" instead.");else{for(var tr=0;tr<fn.length;tr++){var kr=Array.isArray($t)?$t[tr]:$t.type,zr=fn[tr];nt.concat(tr+1).checkSubtype(kr,zr.type)}if(0===nt.errors.length)return new sr(ie,we,Wt,fn)}}if(1===Ve.length)(Y=O.errors).push.apply(Y,nt.errors);else{for(var Kr=(Ve.length?Ve:ze).map(function(_i){var hi;return hi=_i[0],Array.isArray(hi)?"("+hi.map(Ht).join(", ")+")":"("+Ht(hi.type)+"...)"}).join(" | "),Wr=[],ai=1;ai<A.length;ai++){var bi=O.parse(A[ai],1+Wr.length);if(!bi)return null;Wr.push(Ht(bi.type))}O.error("Expected arguments of type "+Kr+", but found ("+Wr.join(", ")+") instead.")}return null},sr.register=function(A,O){for(var Y in sr.definitions=O,O)A[Y]=sr};var dr=function(A,O,Y){this.type=Xe,this.locale=Y,this.caseSensitive=A,this.diacriticSensitive=O};function $r(A,O){A[0]=Math.min(A[0],O[0]),A[1]=Math.min(A[1],O[1]),A[2]=Math.max(A[2],O[0]),A[3]=Math.max(A[3],O[1])}function Lr(A,O){return!(A[0]<=O[0]||A[2]>=O[2]||A[1]<=O[1]||A[3]>=O[3])}function jr(A,O){var ie=(180+A[0])/360,me=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+A[1]*Math.PI/360)))/360,we=Math.pow(2,O.z);return[Math.round(ie*we*8192),Math.round(me*we*8192)]}function ri(A,O,Y){return O[1]>A[1]!=Y[1]>A[1]&&A[0]<(Y[0]-O[0])*(A[1]-O[1])/(Y[1]-O[1])+O[0]}function sn(A,O){for(var Y,ie,me,we,ze,Ve,nt,ht=!1,xt=0,Ut=O.length;xt<Ut;xt++)for(var $t=O[xt],Wt=0,fn=$t.length;Wt<fn-1;Wt++){if(void 0,void 0,void 0,void 0,(we=(Y=A)[0]-(ie=$t[Wt])[0])*(nt=Y[1]-(me=$t[Wt+1])[1])-(Ve=Y[0]-me[0])*(ze=Y[1]-ie[1])==0&&we*Ve<=0&&ze*nt<=0)return!1;ri(A,$t[Wt],$t[Wt+1])&&(ht=!ht)}return ht}function wn(A,O){for(var Y=0;Y<O.length;Y++)if(sn(A,O[Y]))return!0;return!1}function It(A,O,Y,ie){var nt=ie[0]-Y[0],ht=ie[1]-Y[1],xt=(A[0]-Y[0])*ht-nt*(A[1]-Y[1]),Ut=(O[0]-Y[0])*ht-nt*(O[1]-Y[1]);return xt>0&&Ut<0||xt<0&&Ut>0}function hn(A,O,Y){for(var ie=0,me=Y;ie<me.length;ie+=1)for(var we=me[ie],ze=0;ze<we.length-1;++ze)if(void 0,void 0,(Ut=[(xt=we[ze+1])[0]-(ht=we[ze])[0],xt[1]-ht[1]])[0]*($t=[(nt=O)[0]-(Ve=A)[0],nt[1]-Ve[1]])[1]-Ut[1]*$t[0]!=0&&It(Ve,nt,ht,xt)&&It(ht,xt,Ve,nt))return!0;var Ve,nt,ht,xt,Ut,$t;return!1}function yn(A,O){for(var Y=0;Y<A.length;++Y)if(!sn(A[Y],O))return!1;for(var ie=0;ie<A.length-1;++ie)if(hn(A[ie],A[ie+1],O))return!1;return!0}function Hn(A,O){for(var Y=0;Y<O.length;Y++)if(yn(A,O[Y]))return!0;return!1}function Un(A,O,Y){for(var ie=[],me=0;me<A.length;me++){for(var we=[],ze=0;ze<A[me].length;ze++){var Ve=jr(A[me][ze],Y);$r(O,Ve),we.push(Ve)}ie.push(we)}return ie}function jn(A,O,Y){for(var ie=[],me=0;me<A.length;me++){var we=Un(A[me],O,Y);ie.push(we)}return ie}function On(A,O,Y,ie){if(A[0]<Y[0]||A[0]>Y[2]){var me=.5*ie,we=A[0]-Y[0]>me?-ie:Y[0]-A[0]>me?ie:0;0===we&&(we=A[0]-Y[2]>me?-ie:Y[2]-A[0]>me?ie:0),A[0]+=we}$r(O,A)}function kn(A,O,Y,ie){for(var me=8192*Math.pow(2,ie.z),we=[8192*ie.x,8192*ie.y],ze=[],Ve=0,nt=A;Ve<nt.length;Ve+=1)for(var ht=0,xt=nt[Ve];ht<xt.length;ht+=1){var Ut=xt[ht],$t=[Ut.x+we[0],Ut.y+we[1]];On($t,O,Y,me),ze.push($t)}return ze}function Mn(A,O,Y,ie){for(var me,we=8192*Math.pow(2,ie.z),ze=[8192*ie.x,8192*ie.y],Ve=[],nt=0,ht=A;nt<ht.length;nt+=1){for(var xt=[],Ut=0,$t=ht[nt];Ut<$t.length;Ut+=1){var Wt=$t[Ut],fn=[Wt.x+ze[0],Wt.y+ze[1]];$r(O,fn),xt.push(fn)}Ve.push(xt)}if(O[2]-O[0]<=we/2){(me=O)[0]=me[1]=1/0,me[2]=me[3]=-1/0;for(var An=0,Bn=Ve;An<Bn.length;An+=1)for(var Nn=0,Gn=Bn[An];Nn<Gn.length;Nn+=1)On(Gn[Nn],O,Y,we)}return Ve}dr.parse=function(A,O){if(2!==A.length)return O.error("Expected one argument.");var Y=A[1];if("object"!=typeof Y||Array.isArray(Y))return O.error("Collator options argument must be an object.");var ie=O.parse(void 0!==Y["case-sensitive"]&&Y["case-sensitive"],1,qt);if(!ie)return null;var me=O.parse(void 0!==Y["diacritic-sensitive"]&&Y["diacritic-sensitive"],1,qt);if(!me)return null;var we=null;return Y.locale&&!(we=O.parse(Y.locale,1,pt))?null:new dr(ie,me,we)},dr.prototype.evaluate=function(A){return new an(this.caseSensitive.evaluate(A),this.diacriticSensitive.evaluate(A),this.locale?this.locale.evaluate(A):null)},dr.prototype.eachChild=function(A){A(this.caseSensitive),A(this.diacriticSensitive),this.locale&&A(this.locale)},dr.prototype.outputDefined=function(){return!1},dr.prototype.serialize=function(){var A={};return A["case-sensitive"]=this.caseSensitive.serialize(),A["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(A.locale=this.locale.serialize()),["collator",A]};var Ln=function(A,O){this.type=qt,this.geojson=A,this.geometries=O};function Dn(A){if(A instanceof sr&&("get"===A.name&&1===A.args.length||"feature-state"===A.name||"has"===A.name&&1===A.args.length||"properties"===A.name||"geometry-type"===A.name||"id"===A.name||/^filter-/.test(A.name))||A instanceof Ln)return!1;var O=!0;return A.eachChild(function(Y){O&&!Dn(Y)&&(O=!1)}),O}function Kn(A){if(A instanceof sr&&"feature-state"===A.name)return!1;var O=!0;return A.eachChild(function(Y){O&&!Kn(Y)&&(O=!1)}),O}function Qn(A,O){if(A instanceof sr&&O.indexOf(A.name)>=0)return!1;var Y=!0;return A.eachChild(function(ie){Y&&!Qn(ie,O)&&(Y=!1)}),Y}Ln.parse=function(A,O){if(2!==A.length)return O.error("'within' expression requires exactly one argument, but found "+(A.length-1)+" instead.");if(Rn(A[1])){var Y=A[1];if("FeatureCollection"===Y.type)for(var ie=0;ie<Y.features.length;++ie){var me=Y.features[ie].geometry.type;if("Polygon"===me||"MultiPolygon"===me)return new Ln(Y,Y.features[ie].geometry)}else if("Feature"===Y.type){var we=Y.geometry.type;if("Polygon"===we||"MultiPolygon"===we)return new Ln(Y,Y.geometry)}else if("Polygon"===Y.type||"MultiPolygon"===Y.type)return new Ln(Y,Y)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ln.prototype.evaluate=function(A){if(null!=A.geometry()&&null!=A.canonicalID()){if("Point"===A.geometryType())return function(O,Y){var ie=[1/0,1/0,-1/0,-1/0],me=[1/0,1/0,-1/0,-1/0],we=O.canonicalID();if("Polygon"===Y.type){var ze=Un(Y.coordinates,me,we),Ve=kn(O.geometry(),ie,me,we);if(!Lr(ie,me))return!1;for(var nt=0,ht=Ve;nt<ht.length;nt+=1)if(!sn(ht[nt],ze))return!1}if("MultiPolygon"===Y.type){var xt=jn(Y.coordinates,me,we),Ut=kn(O.geometry(),ie,me,we);if(!Lr(ie,me))return!1;for(var $t=0,Wt=Ut;$t<Wt.length;$t+=1)if(!wn(Wt[$t],xt))return!1}return!0}(A,this.geometries);if("LineString"===A.geometryType())return function(O,Y){var ie=[1/0,1/0,-1/0,-1/0],me=[1/0,1/0,-1/0,-1/0],we=O.canonicalID();if("Polygon"===Y.type){var ze=Un(Y.coordinates,me,we),Ve=Mn(O.geometry(),ie,me,we);if(!Lr(ie,me))return!1;for(var nt=0,ht=Ve;nt<ht.length;nt+=1)if(!yn(ht[nt],ze))return!1}if("MultiPolygon"===Y.type){var xt=jn(Y.coordinates,me,we),Ut=Mn(O.geometry(),ie,me,we);if(!Lr(ie,me))return!1;for(var $t=0,Wt=Ut;$t<Wt.length;$t+=1)if(!Hn(Wt[$t],xt))return!1}return!0}(A,this.geometries)}return!1},Ln.prototype.eachChild=function(){},Ln.prototype.outputDefined=function(){return!0},Ln.prototype.serialize=function(){return["within",this.geojson]};var lr=function(A,O){this.type=O.type,this.name=A,this.boundExpression=O};lr.parse=function(A,O){if(2!==A.length||"string"!=typeof A[1])return O.error("'var' expression requires exactly one string literal argument.");var Y=A[1];return O.scope.has(Y)?new lr(Y,O.scope.get(Y)):O.error('Unknown variable "'+Y+'". Make sure "'+Y+'" has been bound in an enclosing "let" expression before using it.',1)},lr.prototype.evaluate=function(A){return this.boundExpression.evaluate(A)},lr.prototype.eachChild=function(){},lr.prototype.outputDefined=function(){return!1},lr.prototype.serialize=function(){return["var",this.name]};var hr=function(A,O,Y,ie,me){void 0===O&&(O=[]),void 0===ie&&(ie=new Lt),void 0===me&&(me=[]),this.registry=A,this.path=O,this.key=O.map(function(we){return"["+we+"]"}).join(""),this.scope=ie,this.errors=me,this.expectedType=Y};function Mr(A,O){for(var Y,me=A.length-1,we=0,ze=me,Ve=0;we<=ze;)if((Y=A[Ve=Math.floor((we+ze)/2)])<=O){if(Ve===me||O<A[Ve+1])return Ve;we=Ve+1}else{if(!(Y>O))throw new fr("Input is not a number.");ze=Ve-1}return 0}hr.prototype.parse=function(A,O,Y,ie,me){return void 0===me&&(me={}),O?this.concat(O,Y,ie)._parse(A,me):this._parse(A,me)},hr.prototype._parse=function(A,O){function Y(ht,xt,Ut){return"assert"===Ut?new cr(xt,[ht]):"coerce"===Ut?new Yn(xt,[ht]):ht}if(null!==A&&"string"!=typeof A&&"boolean"!=typeof A&&"number"!=typeof A||(A=["literal",A]),Array.isArray(A)){if(0===A.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ie=A[0];if("string"!=typeof ie)return this.error("Expression name must be a string, but found "+typeof ie+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var me=this.registry[ie];if(me){var we=me.parse(A,this);if(!we)return null;if(this.expectedType){var ze=this.expectedType,Ve=we.type;if("string"!==ze.kind&&"number"!==ze.kind&&"boolean"!==ze.kind&&"object"!==ze.kind&&"array"!==ze.kind||"value"!==Ve.kind)if("color"!==ze.kind&&"formatted"!==ze.kind&&"resolvedImage"!==ze.kind||"value"!==Ve.kind&&"string"!==Ve.kind){if(this.checkSubtype(ze,Ve))return null}else we=Y(we,ze,O.typeAnnotation||"coerce");else we=Y(we,ze,O.typeAnnotation||"assert")}if(!(we instanceof br)&&"resolvedImage"!==we.type.kind&&function ht(xt){if(xt instanceof lr)return ht(xt.boundExpression);if(xt instanceof sr&&"error"===xt.name||xt instanceof dr||xt instanceof Ln)return!1;var Ut=xt instanceof Yn||xt instanceof cr,$t=!0;return xt.eachChild(function(Wt){$t=Ut?$t&&ht(Wt):$t&&Wt instanceof br}),!!$t&&Dn(xt)&&Qn(xt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(we)){var nt=new Ar;try{we=new br(we.type,we.evaluate(nt))}catch(ht){return this.error(ht.message),null}}return we}return this.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===A?"'undefined' value invalid. Use null instead.":"object"==typeof A?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof A+" instead.")},hr.prototype.concat=function(A,O,Y){var ie="number"==typeof A?this.path.concat(A):this.path,me=Y?this.scope.concat(Y):this.scope;return new hr(this.registry,ie,O||null,me,this.errors)},hr.prototype.error=function(A){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];var ie=""+this.key+O.map(function(me){return"["+me+"]"}).join("");this.errors.push(new lt(ie,A))},hr.prototype.checkSubtype=function(A,O){var Y=Zt(A,O);return Y&&this.error(Y),Y};var Er=function(A,O,Y){this.type=A,this.input=O,this.labels=[],this.outputs=[];for(var ie=0,me=Y;ie<me.length;ie+=1){var we=me[ie],Ve=we[1];this.labels.push(we[0]),this.outputs.push(Ve)}};function Pr(A,O,Y){return A*(1-Y)+O*Y}Er.parse=function(A,O){if(A.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if((A.length-1)%2!=0)return O.error("Expected an even number of arguments.");var Y=O.parse(A[1],1,ot);if(!Y)return null;var ie=[],me=null;O.expectedType&&"value"!==O.expectedType.kind&&(me=O.expectedType);for(var we=1;we<A.length;we+=2){var ze=1===we?-1/0:A[we],Ve=A[we+1],nt=we,ht=we+1;if("number"!=typeof ze)return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',nt);if(ie.length&&ie[ie.length-1][0]>=ze)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',nt);var xt=O.parse(Ve,ht,me);if(!xt)return null;me=me||xt.type,ie.push([ze,xt])}return new Er(me,Y,ie)},Er.prototype.evaluate=function(A){var O=this.labels,Y=this.outputs;if(1===O.length)return Y[0].evaluate(A);var ie=this.input.evaluate(A);if(ie<=O[0])return Y[0].evaluate(A);var me=O.length;return ie>=O[me-1]?Y[me-1].evaluate(A):Y[Mr(O,ie)].evaluate(A)},Er.prototype.eachChild=function(A){A(this.input);for(var O=0,Y=this.outputs;O<Y.length;O+=1)A(Y[O])},Er.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})},Er.prototype.serialize=function(){for(var A=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&A.push(this.labels[O]),A.push(this.outputs[O].serialize());return A};var Ur=Object.freeze({__proto__:null,number:Pr,color:function(A,O,Y){return new nn(Pr(A.r,O.r,Y),Pr(A.g,O.g,Y),Pr(A.b,O.b,Y),Pr(A.a,O.a,Y))},array:function(A,O,Y){return A.map(function(ie,me){return Pr(ie,O[me],Y)})}}),Yr=6/29,si=3*Yr*Yr,Fi=Math.PI/180,Ri=180/Math.PI;function Fr(A){return A>.008856451679035631?Math.pow(A,1/3):A/si+4/29}function fi(A){return A>Yr?A*A*A:si*(A-4/29)}function ci(A){return 255*(A<=.0031308?12.92*A:1.055*Math.pow(A,1/2.4)-.055)}function Yi(A){return(A/=255)<=.04045?A/12.92:Math.pow((A+.055)/1.055,2.4)}function Ta(A){var O=Yi(A.r),Y=Yi(A.g),ie=Yi(A.b),me=Fr((.4124564*O+.3575761*Y+.1804375*ie)/.95047),we=Fr((.2126729*O+.7151522*Y+.072175*ie)/1);return{l:116*we-16,a:500*(me-we),b:200*(we-Fr((.0193339*O+.119192*Y+.9503041*ie)/1.08883)),alpha:A.a}}function Ba(A){var O=(A.l+16)/116,Y=isNaN(A.a)?O:O+A.a/500,ie=isNaN(A.b)?O:O-A.b/200;return O=1*fi(O),Y=.95047*fi(Y),ie=1.08883*fi(ie),new nn(ci(3.2404542*Y-1.5371385*O-.4985314*ie),ci(-.969266*Y+1.8760108*O+.041556*ie),ci(.0556434*Y-.2040259*O+1.0572252*ie),A.alpha)}function go(A,O,Y){var ie=O-A;return A+Y*(ie>180||ie<-180?ie-360*Math.round(ie/360):ie)}var ra={forward:Ta,reverse:Ba,interpolate:function(A,O,Y){return{l:Pr(A.l,O.l,Y),a:Pr(A.a,O.a,Y),b:Pr(A.b,O.b,Y),alpha:Pr(A.alpha,O.alpha,Y)}}},ia={forward:function(A){var O=Ta(A),Y=O.l,ie=O.a,me=O.b,we=Math.atan2(me,ie)*Ri;return{h:we<0?we+360:we,c:Math.sqrt(ie*ie+me*me),l:Y,alpha:A.a}},reverse:function(A){var O=A.h*Fi,Y=A.c;return Ba({l:A.l,a:Math.cos(O)*Y,b:Math.sin(O)*Y,alpha:A.alpha})},interpolate:function(A,O,Y){return{h:go(A.h,O.h,Y),c:Pr(A.c,O.c,Y),l:Pr(A.l,O.l,Y),alpha:Pr(A.alpha,O.alpha,Y)}}},so=Object.freeze({__proto__:null,lab:ra,hcl:ia}),Zi=function(A,O,Y,ie,me){this.type=A,this.operator=O,this.interpolation=Y,this.input=ie,this.labels=[],this.outputs=[];for(var we=0,ze=me;we<ze.length;we+=1){var Ve=ze[we],ht=Ve[1];this.labels.push(Ve[0]),this.outputs.push(ht)}};function Ra(A,O,Y,ie){var me=ie-Y,we=A-Y;return 0===me?0:1===O?we/me:(Math.pow(O,we)-1)/(Math.pow(O,me)-1)}Zi.interpolationFactor=function(A,O,Y,ie){var me=0;if("exponential"===A.name)me=Ra(O,A.base,Y,ie);else if("linear"===A.name)me=Ra(O,1,Y,ie);else if("cubic-bezier"===A.name){var we=A.controlPoints;me=new i(we[0],we[1],we[2],we[3]).solve(Ra(O,1,Y,ie))}return me},Zi.parse=function(A,O){var Y=A[0],ie=A[1],me=A[2],we=A.slice(3);if(!Array.isArray(ie)||0===ie.length)return O.error("Expected an interpolation type expression.",1);if("linear"===ie[0])ie={name:"linear"};else if("exponential"===ie[0]){var ze=ie[1];if("number"!=typeof ze)return O.error("Exponential interpolation requires a numeric base.",1,1);ie={name:"exponential",base:ze}}else{if("cubic-bezier"!==ie[0])return O.error("Unknown interpolation type "+String(ie[0]),1,0);var Ve=ie.slice(1);if(4!==Ve.length||Ve.some(function(Bn){return"number"!=typeof Bn||Bn<0||Bn>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ie={name:"cubic-bezier",controlPoints:Ve}}if(A.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if((A.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(me=O.parse(me,2,ot)))return null;var nt=[],ht=null;"interpolate-hcl"===Y||"interpolate-lab"===Y?ht=St:O.expectedType&&"value"!==O.expectedType.kind&&(ht=O.expectedType);for(var xt=0;xt<we.length;xt+=2){var Ut=we[xt],$t=we[xt+1],Wt=xt+3,fn=xt+4;if("number"!=typeof Ut)return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Wt);if(nt.length&&nt[nt.length-1][0]>=Ut)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Wt);var An=O.parse($t,fn,ht);if(!An)return null;ht=ht||An.type,nt.push([Ut,An])}return"number"===ht.kind||"color"===ht.kind||"array"===ht.kind&&"number"===ht.itemType.kind&&"number"==typeof ht.N?new Zi(ht,Y,ie,me,nt):O.error("Type "+Ht(ht)+" is not interpolatable.")},Zi.prototype.evaluate=function(A){var O=this.labels,Y=this.outputs;if(1===O.length)return Y[0].evaluate(A);var ie=this.input.evaluate(A);if(ie<=O[0])return Y[0].evaluate(A);var me=O.length;if(ie>=O[me-1])return Y[me-1].evaluate(A);var we=Mr(O,ie),nt=Zi.interpolationFactor(this.interpolation,ie,O[we],O[we+1]),ht=Y[we].evaluate(A),xt=Y[we+1].evaluate(A);return"interpolate"===this.operator?Ur[this.type.kind.toLowerCase()](ht,xt,nt):"interpolate-hcl"===this.operator?ia.reverse(ia.interpolate(ia.forward(ht),ia.forward(xt),nt)):ra.reverse(ra.interpolate(ra.forward(ht),ra.forward(xt),nt))},Zi.prototype.eachChild=function(A){A(this.input);for(var O=0,Y=this.outputs;O<Y.length;O+=1)A(Y[O])},Zi.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})},Zi.prototype.serialize=function(){var A;A="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,A,this.input.serialize()],Y=0;Y<this.labels.length;Y++)O.push(this.labels[Y],this.outputs[Y].serialize());return O};var Fa=function(A,O){this.type=A,this.args=O};Fa.parse=function(A,O){if(A.length<2)return O.error("Expectected at least one argument.");var Y=null,ie=O.expectedType;ie&&"value"!==ie.kind&&(Y=ie);for(var me=[],we=0,ze=A.slice(1);we<ze.length;we+=1){var nt=O.parse(ze[we],1+me.length,Y,void 0,{typeAnnotation:"omit"});if(!nt)return null;Y=Y||nt.type,me.push(nt)}var ht=ie&&me.some(function(xt){return Zt(ie,xt.type)});return new Fa(ht?Ce:Y,me)},Fa.prototype.evaluate=function(A){for(var O,Y=null,ie=0,me=0,we=this.args;me<we.length&&(ie++,(Y=we[me].evaluate(A))&&Y instanceof _n&&!Y.available&&(O||(O=Y.name),Y=null,ie===this.args.length&&(Y=O)),null===Y);me+=1);return Y},Fa.prototype.eachChild=function(A){this.args.forEach(A)},Fa.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},Fa.prototype.serialize=function(){var A=["coalesce"];return this.eachChild(function(O){A.push(O.serialize())}),A};var _a=function(A,O){this.type=O.type,this.bindings=[].concat(A),this.result=O};_a.prototype.evaluate=function(A){return this.result.evaluate(A)},_a.prototype.eachChild=function(A){for(var O=0,Y=this.bindings;O<Y.length;O+=1)A(Y[O][1]);A(this.result)},_a.parse=function(A,O){if(A.length<4)return O.error("Expected at least 3 arguments, but found "+(A.length-1)+" instead.");for(var Y=[],ie=1;ie<A.length-1;ie+=2){var me=A[ie];if("string"!=typeof me)return O.error("Expected string, but found "+typeof me+" instead.",ie);if(/[^a-zA-Z0-9_]/.test(me))return O.error("Variable names must contain only alphanumeric characters or '_'.",ie);var we=O.parse(A[ie+1],ie+1);if(!we)return null;Y.push([me,we])}var ze=O.parse(A[A.length-1],A.length-1,O.expectedType,Y);return ze?new _a(Y,ze):null},_a.prototype.outputDefined=function(){return this.result.outputDefined()},_a.prototype.serialize=function(){for(var A=["let"],O=0,Y=this.bindings;O<Y.length;O+=1){var ie=Y[O];A.push(ie[0],ie[1].serialize())}return A.push(this.result.serialize()),A};var Xa=function(A,O,Y){this.type=A,this.index=O,this.input=Y};Xa.parse=function(A,O){if(3!==A.length)return O.error("Expected 2 arguments, but found "+(A.length-1)+" instead.");var Y=O.parse(A[1],1,ot),ie=O.parse(A[2],2,zt(O.expectedType||Ce));return Y&&ie?new Xa(ie.type.itemType,Y,ie):null},Xa.prototype.evaluate=function(A){var O=this.index.evaluate(A),Y=this.input.evaluate(A);if(O<0)throw new fr("Array index out of bounds: "+O+" < 0.");if(O>=Y.length)throw new fr("Array index out of bounds: "+O+" > "+(Y.length-1)+".");if(O!==Math.floor(O))throw new fr("Array index must be an integer, but found "+O+" instead.");return Y[O]},Xa.prototype.eachChild=function(A){A(this.index),A(this.input)},Xa.prototype.outputDefined=function(){return!1},Xa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var no=function(A,O){this.type=qt,this.needle=A,this.haystack=O};no.parse=function(A,O){if(3!==A.length)return O.error("Expected 2 arguments, but found "+(A.length-1)+" instead.");var Y=O.parse(A[1],1,Ce),ie=O.parse(A[2],2,Ce);return Y&&ie?vn(Y.type,[qt,pt,ot,Ot,Ce])?new no(Y,ie):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(Y.type)+" instead"):null},no.prototype.evaluate=function(A){var O=this.needle.evaluate(A),Y=this.haystack.evaluate(A);if(!Y)return!1;if(!zn(O,["boolean","string","number","null"]))throw new fr("Expected first argument to be of type boolean, string, number or null, but found "+Ht(qn(O))+" instead.");if(!zn(Y,["string","array"]))throw new fr("Expected second argument to be of type array or string, but found "+Ht(qn(Y))+" instead.");return Y.indexOf(O)>=0},no.prototype.eachChild=function(A){A(this.needle),A(this.haystack)},no.prototype.outputDefined=function(){return!0},no.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var _o=function(A,O,Y){this.type=ot,this.needle=A,this.haystack=O,this.fromIndex=Y};_o.parse=function(A,O){if(A.length<=2||A.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(A.length-1)+" instead.");var Y=O.parse(A[1],1,Ce),ie=O.parse(A[2],2,Ce);if(!Y||!ie)return null;if(!vn(Y.type,[qt,pt,ot,Ot,Ce]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(Y.type)+" instead");if(4===A.length){var me=O.parse(A[3],3,ot);return me?new _o(Y,ie,me):null}return new _o(Y,ie)},_o.prototype.evaluate=function(A){var O=this.needle.evaluate(A),Y=this.haystack.evaluate(A);if(!zn(O,["boolean","string","number","null"]))throw new fr("Expected first argument to be of type boolean, string, number or null, but found "+Ht(qn(O))+" instead.");if(!zn(Y,["string","array"]))throw new fr("Expected second argument to be of type array or string, but found "+Ht(qn(Y))+" instead.");if(this.fromIndex){var ie=this.fromIndex.evaluate(A);return Y.indexOf(O,ie)}return Y.indexOf(O)},_o.prototype.eachChild=function(A){A(this.needle),A(this.haystack),this.fromIndex&&A(this.fromIndex)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var A=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),A]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Wa=function(A,O,Y,ie,me,we){this.inputType=A,this.type=O,this.input=Y,this.cases=ie,this.outputs=me,this.otherwise=we};Wa.parse=function(A,O){if(A.length<5)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if(A.length%2!=1)return O.error("Expected an even number of arguments.");var Y,ie;O.expectedType&&"value"!==O.expectedType.kind&&(ie=O.expectedType);for(var me={},we=[],ze=2;ze<A.length-1;ze+=2){var Ve=A[ze],nt=A[ze+1];Array.isArray(Ve)||(Ve=[Ve]);var ht=O.concat(ze);if(0===Ve.length)return ht.error("Expected at least one branch label.");for(var xt=0,Ut=Ve;xt<Ut.length;xt+=1){var $t=Ut[xt];if("number"!=typeof $t&&"string"!=typeof $t)return ht.error("Branch labels must be numbers or strings.");if("number"==typeof $t&&Math.abs($t)>Number.MAX_SAFE_INTEGER)return ht.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof $t&&Math.floor($t)!==$t)return ht.error("Numeric branch labels must be integer values.");if(Y){if(ht.checkSubtype(Y,qn($t)))return null}else Y=qn($t);if(void 0!==me[String($t)])return ht.error("Branch labels must be unique.");me[String($t)]=we.length}var Wt=O.parse(nt,ze,ie);if(!Wt)return null;ie=ie||Wt.type,we.push(Wt)}var fn=O.parse(A[1],1,Ce);if(!fn)return null;var An=O.parse(A[A.length-1],A.length-1,ie);return An?"value"!==fn.type.kind&&O.concat(1).checkSubtype(Y,fn.type)?null:new Wa(Y,ie,fn,me,we,An):null},Wa.prototype.evaluate=function(A){var O=this.input.evaluate(A);return(qn(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(A)},Wa.prototype.eachChild=function(A){A(this.input),this.outputs.forEach(A),A(this.otherwise)},Wa.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})&&this.otherwise.outputDefined()},Wa.prototype.serialize=function(){for(var A=this,O=["match",this.input.serialize()],Y=[],ie={},me=0,we=Object.keys(this.cases).sort();me<we.length;me+=1){var ze=we[me];void 0===(Ut=ie[this.cases[ze]])?(ie[this.cases[ze]]=Y.length,Y.push([this.cases[ze],[ze]])):Y[Ut][1].push(ze)}for(var Ve=function(Wt){return"number"===A.inputType.kind?Number(Wt):Wt},nt=0,ht=Y;nt<ht.length;nt+=1){var xt=ht[nt],Ut=xt[0],$t=xt[1];O.push(1===$t.length?Ve($t[0]):$t.map(Ve)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var xa=function(A,O,Y){this.type=A,this.branches=O,this.otherwise=Y};xa.parse=function(A,O){if(A.length<4)return O.error("Expected at least 3 arguments, but found only "+(A.length-1)+".");if(A.length%2!=0)return O.error("Expected an odd number of arguments.");var Y;O.expectedType&&"value"!==O.expectedType.kind&&(Y=O.expectedType);for(var ie=[],me=1;me<A.length-1;me+=2){var we=O.parse(A[me],me,qt);if(!we)return null;var ze=O.parse(A[me+1],me+1,Y);if(!ze)return null;ie.push([we,ze]),Y=Y||ze.type}var Ve=O.parse(A[A.length-1],A.length-1,Y);return Ve?new xa(Y,ie,Ve):null},xa.prototype.evaluate=function(A){for(var O=0,Y=this.branches;O<Y.length;O+=1){var ie=Y[O],we=ie[1];if(ie[0].evaluate(A))return we.evaluate(A)}return this.otherwise.evaluate(A)},xa.prototype.eachChild=function(A){for(var O=0,Y=this.branches;O<Y.length;O+=1){var ie=Y[O],we=ie[1];A(ie[0]),A(we)}A(this.otherwise)},xa.prototype.outputDefined=function(){return this.branches.every(function(A){return A[1].outputDefined()})&&this.otherwise.outputDefined()},xa.prototype.serialize=function(){var A=["case"];return this.eachChild(function(O){A.push(O.serialize())}),A};var ro=function(A,O,Y,ie){this.type=A,this.input=O,this.beginIndex=Y,this.endIndex=ie};function ds(A,O){return"=="===A||"!="===A?"boolean"===O.kind||"string"===O.kind||"number"===O.kind||"null"===O.kind||"value"===O.kind:"string"===O.kind||"number"===O.kind||"value"===O.kind}function bs(A,O,Y,ie){return 0===ie.compare(O,Y)}function ta(A,O,Y){var ie="=="!==A&&"!="!==A;return function(){function me(we,ze,Ve){this.type=qt,this.lhs=we,this.rhs=ze,this.collator=Ve,this.hasUntypedArgument="value"===we.type.kind||"value"===ze.type.kind}return me.parse=function(we,ze){if(3!==we.length&&4!==we.length)return ze.error("Expected two or three arguments.");var Ve=we[0],nt=ze.parse(we[1],1,Ce);if(!nt)return null;if(!ds(Ve,nt.type))return ze.concat(1).error('"'+Ve+"\" comparisons are not supported for type '"+Ht(nt.type)+"'.");var ht=ze.parse(we[2],2,Ce);if(!ht)return null;if(!ds(Ve,ht.type))return ze.concat(2).error('"'+Ve+"\" comparisons are not supported for type '"+Ht(ht.type)+"'.");if(nt.type.kind!==ht.type.kind&&"value"!==nt.type.kind&&"value"!==ht.type.kind)return ze.error("Cannot compare types '"+Ht(nt.type)+"' and '"+Ht(ht.type)+"'.");ie&&("value"===nt.type.kind&&"value"!==ht.type.kind?nt=new cr(ht.type,[nt]):"value"!==nt.type.kind&&"value"===ht.type.kind&&(ht=new cr(nt.type,[ht])));var xt=null;if(4===we.length){if("string"!==nt.type.kind&&"string"!==ht.type.kind&&"value"!==nt.type.kind&&"value"!==ht.type.kind)return ze.error("Cannot use collator to compare non-string types.");if(!(xt=ze.parse(we[3],3,Xe)))return null}return new me(nt,ht,xt)},me.prototype.evaluate=function(we){var ze=this.lhs.evaluate(we),Ve=this.rhs.evaluate(we);if(ie&&this.hasUntypedArgument){var nt=qn(ze),ht=qn(Ve);if(nt.kind!==ht.kind||"string"!==nt.kind&&"number"!==nt.kind)throw new fr('Expected arguments for "'+A+'" to be (string, string) or (number, number), but found ('+nt.kind+", "+ht.kind+") instead.")}if(this.collator&&!ie&&this.hasUntypedArgument){var xt=qn(ze),Ut=qn(Ve);if("string"!==xt.kind||"string"!==Ut.kind)return O(we,ze,Ve)}return this.collator?Y(we,ze,Ve,this.collator.evaluate(we)):O(we,ze,Ve)},me.prototype.eachChild=function(we){we(this.lhs),we(this.rhs),this.collator&&we(this.collator)},me.prototype.outputDefined=function(){return!0},me.prototype.serialize=function(){var we=[A];return this.eachChild(function(ze){we.push(ze.serialize())}),we},me}()}ro.parse=function(A,O){if(A.length<=2||A.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(A.length-1)+" instead.");var Y=O.parse(A[1],1,Ce),ie=O.parse(A[2],2,ot);if(!Y||!ie)return null;if(!vn(Y.type,[zt(Ce),pt,Ce]))return O.error("Expected first argument to be of type array or string, but found "+Ht(Y.type)+" instead");if(4===A.length){var me=O.parse(A[3],3,ot);return me?new ro(Y.type,Y,ie,me):null}return new ro(Y.type,Y,ie)},ro.prototype.evaluate=function(A){var O=this.input.evaluate(A),Y=this.beginIndex.evaluate(A);if(!zn(O,["string","array"]))throw new fr("Expected first argument to be of type array or string, but found "+Ht(qn(O))+" instead.");if(this.endIndex){var ie=this.endIndex.evaluate(A);return O.slice(Y,ie)}return O.slice(Y)},ro.prototype.eachChild=function(A){A(this.input),A(this.beginIndex),this.endIndex&&A(this.endIndex)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var A=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),A]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var ls=ta("==",function(A,O,Y){return O===Y},bs),ts=ta("!=",function(A,O,Y){return O!==Y},function(A,O,Y,ie){return!bs(0,O,Y,ie)}),As=ta("<",function(A,O,Y){return O<Y},function(A,O,Y,ie){return ie.compare(O,Y)<0}),Ms=ta(">",function(A,O,Y){return O>Y},function(A,O,Y,ie){return ie.compare(O,Y)>0}),_s=ta("<=",function(A,O,Y){return O<=Y},function(A,O,Y,ie){return ie.compare(O,Y)<=0}),Ss=ta(">=",function(A,O,Y){return O>=Y},function(A,O,Y,ie){return ie.compare(O,Y)>=0}),vo=function(A,O,Y,ie,me){this.type=pt,this.number=A,this.locale=O,this.currency=Y,this.minFractionDigits=ie,this.maxFractionDigits=me};vo.parse=function(A,O){if(3!==A.length)return O.error("Expected two arguments.");var Y=O.parse(A[1],1,ot);if(!Y)return null;var ie=A[2];if("object"!=typeof ie||Array.isArray(ie))return O.error("NumberFormat options argument must be an object.");var me=null;if(ie.locale&&!(me=O.parse(ie.locale,1,pt)))return null;var we=null;if(ie.currency&&!(we=O.parse(ie.currency,1,pt)))return null;var ze=null;if(ie["min-fraction-digits"]&&!(ze=O.parse(ie["min-fraction-digits"],1,ot)))return null;var Ve=null;return ie["max-fraction-digits"]&&!(Ve=O.parse(ie["max-fraction-digits"],1,ot))?null:new vo(Y,me,we,ze,Ve)},vo.prototype.evaluate=function(A){return new Intl.NumberFormat(this.locale?this.locale.evaluate(A):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(A):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(A):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(A):void 0}).format(this.number.evaluate(A))},vo.prototype.eachChild=function(A){A(this.number),this.locale&&A(this.locale),this.currency&&A(this.currency),this.minFractionDigits&&A(this.minFractionDigits),this.maxFractionDigits&&A(this.maxFractionDigits)},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){var A={};return this.locale&&(A.locale=this.locale.serialize()),this.currency&&(A.currency=this.currency.serialize()),this.minFractionDigits&&(A["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(A["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),A]};var Lo=function(A){this.type=ot,this.input=A};Lo.parse=function(A,O){if(2!==A.length)return O.error("Expected 1 argument, but found "+(A.length-1)+" instead.");var Y=O.parse(A[1],1);return Y?"array"!==Y.type.kind&&"string"!==Y.type.kind&&"value"!==Y.type.kind?O.error("Expected argument of type string or array, but found "+Ht(Y.type)+" instead."):new Lo(Y):null},Lo.prototype.evaluate=function(A){var O=this.input.evaluate(A);if("string"==typeof O||Array.isArray(O))return O.length;throw new fr("Expected value to be of type string or array, but found "+Ht(qn(O))+" instead.")},Lo.prototype.eachChild=function(A){A(this.input)},Lo.prototype.outputDefined=function(){return!1},Lo.prototype.serialize=function(){var A=["length"];return this.eachChild(function(O){A.push(O.serialize())}),A};var Bo={"==":ls,"!=":ts,">":Ms,"<":As,">=":Ss,"<=":_s,array:cr,at:Xa,boolean:cr,case:xa,coalesce:Fa,collator:dr,format:Sr,image:Cr,in:no,"index-of":_o,interpolate:Zi,"interpolate-hcl":Zi,"interpolate-lab":Zi,length:Lo,let:_a,literal:br,match:Wa,number:cr,"number-format":vo,object:cr,slice:ro,step:Er,string:cr,"to-boolean":Yn,"to-color":Yn,"to-number":Yn,"to-string":Yn,var:lr,within:Ln};function qo(A,O){var Y=O[0],ie=O[1],me=O[2],we=O[3];Y=Y.evaluate(A),ie=ie.evaluate(A),me=me.evaluate(A);var ze=we?we.evaluate(A):1,Ve=Pn(Y,ie,me,ze);if(Ve)throw new fr(Ve);return new nn(Y/255*ze,ie/255*ze,me/255*ze,ze)}function Ho(A,O){return A in O}function ns(A,O){var Y=O[A];return void 0===Y?null:Y}function wo(A){return{type:A}}function ws(A){return{result:"success",value:A}}function yo(A){return{result:"error",value:A}}function Yo(A){return"data-driven"===A["property-type"]||"cross-faded-data-driven"===A["property-type"]}function ms(A){return!!A.expression&&A.expression.parameters.indexOf("zoom")>-1}function zo(A){return!!A.expression&&A.expression.interpolated}function Gi(A){return A instanceof Number?"number":A instanceof String?"string":A instanceof Boolean?"boolean":Array.isArray(A)?"array":null===A?"null":typeof A}function qe(A){return"object"==typeof A&&null!==A&&!Array.isArray(A)}function We(A){return A}function rt(A,O,Y){return void 0!==A?A:void 0!==O?O:void 0!==Y?Y:void 0}function ft(A,O,Y,ie,me){return rt(typeof Y===me?ie[Y]:void 0,A.default,O.default)}function bt(A,O,Y){if("number"!==Gi(Y))return rt(A.default,O.default);var ie=A.stops.length;if(1===ie||Y<=A.stops[0][0])return A.stops[0][1];if(Y>=A.stops[ie-1][0])return A.stops[ie-1][1];var me=Mr(A.stops.map(function(we){return we[0]}),Y);return A.stops[me][1]}function vt(A,O,Y){var ie=void 0!==A.base?A.base:1;if("number"!==Gi(Y))return rt(A.default,O.default);var me=A.stops.length;if(1===me||Y<=A.stops[0][0])return A.stops[0][1];if(Y>=A.stops[me-1][0])return A.stops[me-1][1];var $t,Wt,An,Bn,we=Mr(A.stops.map(function(Ut){return Ut[0]}),Y),ze=($t=ie,Bn=Y-(Wt=A.stops[we][0]),0==(An=A.stops[we+1][0]-Wt)?0:1===$t?Bn/An:(Math.pow($t,Bn)-1)/(Math.pow($t,An)-1)),Ve=A.stops[we][1],nt=A.stops[we+1][1],ht=Ur[O.type]||We;if(A.colorSpace&&"rgb"!==A.colorSpace){var xt=so[A.colorSpace];ht=function(Ut,$t){return xt.reverse(xt.interpolate(xt.forward(Ut),xt.forward($t),ze))}}return"function"==typeof Ve.evaluate?{evaluate:function(){for(var Ut=[],$t=arguments.length;$t--;)Ut[$t]=arguments[$t];var Wt=Ve.evaluate.apply(void 0,Ut),fn=nt.evaluate.apply(void 0,Ut);if(void 0!==Wt&&void 0!==fn)return ht(Wt,fn,ze)}}:ht(Ve,nt,ze)}function Pt(A,O,Y){return"color"===O.type?Y=nn.parse(Y):"formatted"===O.type?Y=mn.fromString(Y.toString()):"resolvedImage"===O.type?Y=_n.fromString(Y.toString()):Gi(Y)===O.type||"enum"===O.type&&O.values[Y]||(Y=void 0),rt(Y,A.default,O.default)}sr.register(Bo,{error:[{kind:"error"},[pt],function(A,O){throw new fr(O[0].evaluate(A))}],typeof:[pt,[Ce],function(A,O){return Ht(qn(O[0].evaluate(A)))}],"to-rgba":[zt(ot,4),[St],function(A,O){return O[0].evaluate(A).toArray()}],rgb:[St,[ot,ot,ot],qo],rgba:[St,[ot,ot,ot,ot],qo],has:{type:qt,overloads:[[[pt],function(A,O){return Ho(O[0].evaluate(A),A.properties())}],[[pt,Mt],function(A,O){var ie=O[1];return Ho(O[0].evaluate(A),ie.evaluate(A))}]]},get:{type:Ce,overloads:[[[pt],function(A,O){return ns(O[0].evaluate(A),A.properties())}],[[pt,Mt],function(A,O){var ie=O[1];return ns(O[0].evaluate(A),ie.evaluate(A))}]]},"feature-state":[Ce,[pt],function(A,O){return ns(O[0].evaluate(A),A.featureState||{})}],properties:[Mt,[],function(A){return A.properties()}],"geometry-type":[pt,[],function(A){return A.geometryType()}],id:[Ce,[],function(A){return A.id()}],zoom:[ot,[],function(A){return A.globals.zoom}],"heatmap-density":[ot,[],function(A){return A.globals.heatmapDensity||0}],"line-progress":[ot,[],function(A){return A.globals.lineProgress||0}],accumulated:[Ce,[],function(A){return void 0===A.globals.accumulated?null:A.globals.accumulated}],"+":[ot,wo(ot),function(A,O){for(var Y=0,ie=0,me=O;ie<me.length;ie+=1)Y+=me[ie].evaluate(A);return Y}],"*":[ot,wo(ot),function(A,O){for(var Y=1,ie=0,me=O;ie<me.length;ie+=1)Y*=me[ie].evaluate(A);return Y}],"-":{type:ot,overloads:[[[ot,ot],function(A,O){var ie=O[1];return O[0].evaluate(A)-ie.evaluate(A)}],[[ot],function(A,O){return-O[0].evaluate(A)}]]},"/":[ot,[ot,ot],function(A,O){var ie=O[1];return O[0].evaluate(A)/ie.evaluate(A)}],"%":[ot,[ot,ot],function(A,O){var ie=O[1];return O[0].evaluate(A)%ie.evaluate(A)}],ln2:[ot,[],function(){return Math.LN2}],pi:[ot,[],function(){return Math.PI}],e:[ot,[],function(){return Math.E}],"^":[ot,[ot,ot],function(A,O){var ie=O[1];return Math.pow(O[0].evaluate(A),ie.evaluate(A))}],sqrt:[ot,[ot],function(A,O){return Math.sqrt(O[0].evaluate(A))}],log10:[ot,[ot],function(A,O){return Math.log(O[0].evaluate(A))/Math.LN10}],ln:[ot,[ot],function(A,O){return Math.log(O[0].evaluate(A))}],log2:[ot,[ot],function(A,O){return Math.log(O[0].evaluate(A))/Math.LN2}],sin:[ot,[ot],function(A,O){return Math.sin(O[0].evaluate(A))}],cos:[ot,[ot],function(A,O){return Math.cos(O[0].evaluate(A))}],tan:[ot,[ot],function(A,O){return Math.tan(O[0].evaluate(A))}],asin:[ot,[ot],function(A,O){return Math.asin(O[0].evaluate(A))}],acos:[ot,[ot],function(A,O){return Math.acos(O[0].evaluate(A))}],atan:[ot,[ot],function(A,O){return Math.atan(O[0].evaluate(A))}],min:[ot,wo(ot),function(A,O){return Math.min.apply(Math,O.map(function(Y){return Y.evaluate(A)}))}],max:[ot,wo(ot),function(A,O){return Math.max.apply(Math,O.map(function(Y){return Y.evaluate(A)}))}],abs:[ot,[ot],function(A,O){return Math.abs(O[0].evaluate(A))}],round:[ot,[ot],function(A,O){var Y=O[0].evaluate(A);return Y<0?-Math.round(-Y):Math.round(Y)}],floor:[ot,[ot],function(A,O){return Math.floor(O[0].evaluate(A))}],ceil:[ot,[ot],function(A,O){return Math.ceil(O[0].evaluate(A))}],"filter-==":[qt,[pt,Ce],function(A,O){var Y=O[0],ie=O[1];return A.properties()[Y.value]===ie.value}],"filter-id-==":[qt,[Ce],function(A,O){var Y=O[0];return A.id()===Y.value}],"filter-type-==":[qt,[pt],function(A,O){var Y=O[0];return A.geometryType()===Y.value}],"filter-<":[qt,[pt,Ce],function(A,O){var Y=O[0],ie=O[1],me=A.properties()[Y.value],we=ie.value;return typeof me==typeof we&&me<we}],"filter-id-<":[qt,[Ce],function(A,O){var Y=O[0],ie=A.id(),me=Y.value;return typeof ie==typeof me&&ie<me}],"filter->":[qt,[pt,Ce],function(A,O){var Y=O[0],ie=O[1],me=A.properties()[Y.value],we=ie.value;return typeof me==typeof we&&me>we}],"filter-id->":[qt,[Ce],function(A,O){var Y=O[0],ie=A.id(),me=Y.value;return typeof ie==typeof me&&ie>me}],"filter-<=":[qt,[pt,Ce],function(A,O){var Y=O[0],ie=O[1],me=A.properties()[Y.value],we=ie.value;return typeof me==typeof we&&me<=we}],"filter-id-<=":[qt,[Ce],function(A,O){var Y=O[0],ie=A.id(),me=Y.value;return typeof ie==typeof me&&ie<=me}],"filter->=":[qt,[pt,Ce],function(A,O){var Y=O[0],ie=O[1],me=A.properties()[Y.value],we=ie.value;return typeof me==typeof we&&me>=we}],"filter-id->=":[qt,[Ce],function(A,O){var Y=O[0],ie=A.id(),me=Y.value;return typeof ie==typeof me&&ie>=me}],"filter-has":[qt,[Ce],function(A,O){return O[0].value in A.properties()}],"filter-has-id":[qt,[],function(A){return null!==A.id()&&void 0!==A.id()}],"filter-type-in":[qt,[zt(pt)],function(A,O){return O[0].value.indexOf(A.geometryType())>=0}],"filter-id-in":[qt,[zt(Ce)],function(A,O){return O[0].value.indexOf(A.id())>=0}],"filter-in-small":[qt,[pt,zt(Ce)],function(A,O){var Y=O[0];return O[1].value.indexOf(A.properties()[Y.value])>=0}],"filter-in-large":[qt,[pt,zt(Ce)],function(A,O){var Y=O[0],ie=O[1];return function(me,we,ze,Ve){for(;ze<=Ve;){var nt=ze+Ve>>1;if(we[nt]===me)return!0;we[nt]>me?Ve=nt-1:ze=nt+1}return!1}(A.properties()[Y.value],ie.value,0,ie.value.length-1)}],all:{type:qt,overloads:[[[qt,qt],function(A,O){var ie=O[1];return O[0].evaluate(A)&&ie.evaluate(A)}],[wo(qt),function(A,O){for(var Y=0,ie=O;Y<ie.length;Y+=1)if(!ie[Y].evaluate(A))return!1;return!0}]]},any:{type:qt,overloads:[[[qt,qt],function(A,O){var ie=O[1];return O[0].evaluate(A)||ie.evaluate(A)}],[wo(qt),function(A,O){for(var Y=0,ie=O;Y<ie.length;Y+=1)if(ie[Y].evaluate(A))return!0;return!1}]]},"!":[qt,[qt],function(A,O){return!O[0].evaluate(A)}],"is-supported-script":[qt,[pt],function(A,O){var ie=A.globals&&A.globals.isSupportedScript;return!ie||ie(O[0].evaluate(A))}],upcase:[pt,[pt],function(A,O){return O[0].evaluate(A).toUpperCase()}],downcase:[pt,[pt],function(A,O){return O[0].evaluate(A).toLowerCase()}],concat:[pt,wo(Ce),function(A,O){return O.map(function(Y){return Xn(Y.evaluate(A))}).join("")}],"resolved-locale":[pt,[Xe],function(A,O){return O[0].evaluate(A).resolvedLocale()}]});var tn=function(A,O){var Y;this.expression=A,this._warningHistory={},this._evaluator=new Ar,this._defaultValue=O?"color"===(Y=O).type&&qe(Y.default)?new nn(0,0,0,0):"color"===Y.type?nn.parse(Y.default)||null:void 0===Y.default?null:Y.default:null,this._enumValues=O&&"enum"===O.type?O.values:null};function rn(A){return Array.isArray(A)&&A.length>0&&"string"==typeof A[0]&&A[0]in Bo}function Qt(A,O){var me,we,Y=new hr(Bo,[],O?(we={color:St,string:pt,number:ot,enum:pt,boolean:qt,formatted:st,resolvedImage:dt},"array"===(me=O).type?zt(we[me.value]||Ce,me.length):we[me.type]):void 0),ie=Y.parse(A,void 0,void 0,void 0,O&&"string"===O.type?{typeAnnotation:"coerce"}:void 0);return ie?ws(new tn(ie,O)):yo(Y.errors)}tn.prototype.evaluateWithoutErrorHandling=function(A,O,Y,ie,me,we){return this._evaluator.globals=A,this._evaluator.feature=O,this._evaluator.featureState=Y,this._evaluator.canonical=ie,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=we,this.expression.evaluate(this._evaluator)},tn.prototype.evaluate=function(A,O,Y,ie,me,we){this._evaluator.globals=A,this._evaluator.feature=O||null,this._evaluator.featureState=Y||null,this._evaluator.canonical=ie,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=we||null;try{var ze=this.expression.evaluate(this._evaluator);if(null==ze||"number"==typeof ze&&ze!=ze)return this._defaultValue;if(this._enumValues&&!(ze in this._enumValues))throw new fr("Expected value to be one of "+Object.keys(this._enumValues).map(function(Ve){return JSON.stringify(Ve)}).join(", ")+", but found "+JSON.stringify(ze)+" instead.");return ze}catch(Ve){return this._warningHistory[Ve.message]||(this._warningHistory[Ve.message]=!0,"undefined"!=typeof console&&console.warn(Ve.message)),this._defaultValue}};var un=function(A,O){this.kind=A,this._styleExpression=O,this.isStateDependent="constant"!==A&&!Kn(O.expression)};un.prototype.evaluateWithoutErrorHandling=function(A,O,Y,ie,me,we){return this._styleExpression.evaluateWithoutErrorHandling(A,O,Y,ie,me,we)},un.prototype.evaluate=function(A,O,Y,ie,me,we){return this._styleExpression.evaluate(A,O,Y,ie,me,we)};var xn=function(A,O,Y,ie){this.kind=A,this.zoomStops=Y,this._styleExpression=O,this.isStateDependent="camera"!==A&&!Kn(O.expression),this.interpolationType=ie};function Sn(A,O){if("error"===(A=Qt(A,O)).result)return A;var Y=A.value.expression,ie=Dn(Y);if(!ie&&!Yo(O))return yo([new lt("","data expressions not supported")]);var me=Qn(Y,["zoom"]);if(!me&&!ms(O))return yo([new lt("","zoom expressions not supported")]);var we=function Ve(nt){var ht=null;if(nt instanceof _a)ht=Ve(nt.result);else if(nt instanceof Fa)for(var xt=0,Ut=nt.args;xt<Ut.length&&!(ht=Ve(Ut[xt]));xt+=1);else(nt instanceof Er||nt instanceof Zi)&&nt.input instanceof sr&&"zoom"===nt.input.name&&(ht=nt);return ht instanceof lt||nt.eachChild(function(Wt){var fn=Ve(Wt);fn instanceof lt?ht=fn:!ht&&fn?ht=new lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ht&&fn&&ht!==fn&&(ht=new lt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ht}(Y);return we||me?we instanceof lt?yo([we]):we instanceof Zi&&!zo(O)?yo([new lt("",'"interpolate" expressions cannot be used with this property')]):ws(we?new xn(ie?"camera":"composite",A.value,we.labels,we instanceof Zi?we.interpolation:void 0):new un(ie?"constant":"source",A.value)):yo([new lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}xn.prototype.evaluateWithoutErrorHandling=function(A,O,Y,ie,me,we){return this._styleExpression.evaluateWithoutErrorHandling(A,O,Y,ie,me,we)},xn.prototype.evaluate=function(A,O,Y,ie,me,we){return this._styleExpression.evaluate(A,O,Y,ie,me,we)},xn.prototype.interpolationFactor=function(A,O,Y){return this.interpolationType?Zi.interpolationFactor(this.interpolationType,A,O,Y):0};var Cn=function(A,O){this._parameters=A,this._specification=O,Ke(this,function Y(ie,me){var we,ze,Ve,nt="color"===me.type,ht=ie.stops&&"object"==typeof ie.stops[0][0],Ut=ht||!(ht||void 0!==ie.property),$t=ie.type||(zo(me)?"exponential":"interval");if(nt&&((ie=Ke({},ie)).stops&&(ie.stops=ie.stops.map(function(_i){return[_i[0],nn.parse(_i[1])]})),ie.default=nn.parse(ie.default?ie.default:me.default)),ie.colorSpace&&"rgb"!==ie.colorSpace&&!so[ie.colorSpace])throw new Error("Unknown color space: "+ie.colorSpace);if("exponential"===$t)we=vt;else if("interval"===$t)we=bt;else if("categorical"===$t){we=ft,ze=Object.create(null);for(var Wt=0,fn=ie.stops;Wt<fn.length;Wt+=1){var An=fn[Wt];ze[An[0]]=An[1]}Ve=typeof ie.stops[0][0]}else{if("identity"!==$t)throw new Error('Unknown function type "'+$t+'"');we=Pt}if(ht){for(var Bn={},Nn=[],Gn=0;Gn<ie.stops.length;Gn++){var Jn=ie.stops[Gn],tr=Jn[0].zoom;void 0===Bn[tr]&&(Bn[tr]={zoom:tr,type:ie.type,property:ie.property,default:ie.default,stops:[]},Nn.push(tr)),Bn[tr].stops.push([Jn[0].value,Jn[1]])}for(var kr=[],zr=0,Kr=Nn;zr<Kr.length;zr+=1){var Wr=Kr[zr];kr.push([Bn[Wr].zoom,Y(Bn[Wr],me)])}var ai={name:"linear"};return{kind:"composite",interpolationType:ai,interpolationFactor:Zi.interpolationFactor.bind(void 0,ai),zoomStops:kr.map(function(_i){return _i[0]}),evaluate:function(_i,hi){var Ci=_i.zoom;return vt({stops:kr,base:ie.base},me,Ci).evaluate(Ci,hi)}}}if(Ut){var bi="exponential"===$t?{name:"exponential",base:void 0!==ie.base?ie.base:1}:null;return{kind:"camera",interpolationType:bi,interpolationFactor:Zi.interpolationFactor.bind(void 0,bi),zoomStops:ie.stops.map(function(_i){return _i[0]}),evaluate:function(_i){return we(ie,me,_i.zoom,ze,Ve)}}}return{kind:"source",evaluate:function(_i,hi){var Ci=hi&&hi.properties?hi.properties[ie.property]:void 0;return void 0===Ci?rt(ie.default,me.default):we(ie,me,Ci,ze,Ve)}}}(this._parameters,this._specification))};function Vn(A){var O=A.key,Y=A.value,ie=A.valueSpec||{},me=A.objectElementValidators||{},we=A.style,ze=A.styleSpec,Ve=[],nt=Gi(Y);if("object"!==nt)return[new Fe(O,Y,"object expected, "+nt+" found")];for(var ht in Y){var xt=ht.split(".")[0],Ut=ie[xt]||ie["*"],$t=void 0;if(me[xt])$t=me[xt];else if(ie[xt])$t=pn;else if(me["*"])$t=me["*"];else{if(!ie["*"]){Ve.push(new Fe(O,Y[ht],'unknown property "'+ht+'"'));continue}$t=pn}Ve=Ve.concat($t({key:(O&&O+".")+ht,value:Y[ht],valueSpec:Ut,style:we,styleSpec:ze,object:Y,objectKey:ht},Y))}for(var Wt in ie)me[Wt]||ie[Wt].required&&void 0===ie[Wt].default&&void 0===Y[Wt]&&Ve.push(new Fe(O,Y,'missing required property "'+Wt+'"'));return Ve}function mr(A){var O=A.value,Y=A.valueSpec,ie=A.style,me=A.styleSpec,we=A.key,ze=A.arrayElementValidator||pn;if("array"!==Gi(O))return[new Fe(we,O,"array expected, "+Gi(O)+" found")];if(Y.length&&O.length!==Y.length)return[new Fe(we,O,"array length "+Y.length+" expected, length "+O.length+" found")];if(Y["min-length"]&&O.length<Y["min-length"])return[new Fe(we,O,"array length at least "+Y["min-length"]+" expected, length "+O.length+" found")];var Ve={type:Y.value,values:Y.values};me.$version<7&&(Ve.function=Y.function),"object"===Gi(Y.value)&&(Ve=Y.value);for(var nt=[],ht=0;ht<O.length;ht++)nt=nt.concat(ze({array:O,arrayIndex:ht,value:O[ht],valueSpec:Ve,style:ie,styleSpec:me,key:we+"["+ht+"]"}));return nt}function wr(A){var O=A.key,Y=A.value,ie=A.valueSpec,me=Gi(Y);return"number"===me&&Y!=Y&&(me="NaN"),"number"!==me?[new Fe(O,Y,"number expected, "+me+" found")]:"minimum"in ie&&Y<ie.minimum?[new Fe(O,Y,Y+" is less than the minimum value "+ie.minimum)]:"maximum"in ie&&Y>ie.maximum?[new Fe(O,Y,Y+" is greater than the maximum value "+ie.maximum)]:[]}function qr(A){var O,Y,ie,me=A.valueSpec,we=Ze(A.value.type),ze={},Ve="categorical"!==we&&void 0===A.value.property,nt=!Ve,ht="array"===Gi(A.value.stops)&&"array"===Gi(A.value.stops[0])&&"object"===Gi(A.value.stops[0][0]),xt=Vn({key:A.key,value:A.value,valueSpec:A.styleSpec.function,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{stops:function(Wt){if("identity"===we)return[new Fe(Wt.key,Wt.value,'identity function may not have a "stops" property')];var fn=[],An=Wt.value;return fn=fn.concat(mr({key:Wt.key,value:An,valueSpec:Wt.valueSpec,style:Wt.style,styleSpec:Wt.styleSpec,arrayElementValidator:Ut})),"array"===Gi(An)&&0===An.length&&fn.push(new Fe(Wt.key,An,"array must have at least one stop")),fn},default:function(Wt){return pn({key:Wt.key,value:Wt.value,valueSpec:me,style:Wt.style,styleSpec:Wt.styleSpec})}}});return"identity"===we&&Ve&&xt.push(new Fe(A.key,A.value,'missing required property "property"')),"identity"===we||A.value.stops||xt.push(new Fe(A.key,A.value,'missing required property "stops"')),"exponential"===we&&A.valueSpec.expression&&!zo(A.valueSpec)&&xt.push(new Fe(A.key,A.value,"exponential functions not supported")),A.styleSpec.$version>=8&&(nt&&!Yo(A.valueSpec)?xt.push(new Fe(A.key,A.value,"property functions not supported")):Ve&&!ms(A.valueSpec)&&xt.push(new Fe(A.key,A.value,"zoom functions not supported"))),"categorical"!==we&&!ht||void 0!==A.value.property||xt.push(new Fe(A.key,A.value,'"property" property is required')),xt;function Ut(Wt){var fn=[],An=Wt.value,Bn=Wt.key;if("array"!==Gi(An))return[new Fe(Bn,An,"array expected, "+Gi(An)+" found")];if(2!==An.length)return[new Fe(Bn,An,"array length 2 expected, length "+An.length+" found")];if(ht){if("object"!==Gi(An[0]))return[new Fe(Bn,An,"object expected, "+Gi(An[0])+" found")];if(void 0===An[0].zoom)return[new Fe(Bn,An,"object stop key must have zoom")];if(void 0===An[0].value)return[new Fe(Bn,An,"object stop key must have value")];if(ie&&ie>Ze(An[0].zoom))return[new Fe(Bn,An[0].zoom,"stop zoom values must appear in ascending order")];Ze(An[0].zoom)!==ie&&(ie=Ze(An[0].zoom),Y=void 0,ze={}),fn=fn.concat(Vn({key:Bn+"[0]",value:An[0],valueSpec:{zoom:{}},style:Wt.style,styleSpec:Wt.styleSpec,objectElementValidators:{zoom:wr,value:$t}}))}else fn=fn.concat($t({key:Bn+"[0]",value:An[0],valueSpec:{},style:Wt.style,styleSpec:Wt.styleSpec},An));return rn(ut(An[1]))?fn.concat([new Fe(Bn+"[1]",An[1],"expressions are not allowed in function stops.")]):fn.concat(pn({key:Bn+"[1]",value:An[1],valueSpec:me,style:Wt.style,styleSpec:Wt.styleSpec}))}function $t(Wt,fn){var An=Gi(Wt.value),Bn=Ze(Wt.value),Nn=null!==Wt.value?Wt.value:fn;if(O){if(An!==O)return[new Fe(Wt.key,Nn,An+" stop domain type must match previous stop domain type "+O)]}else O=An;if("number"!==An&&"string"!==An&&"boolean"!==An)return[new Fe(Wt.key,Nn,"stop domain value must be a number, string, or boolean")];if("number"!==An&&"categorical"!==we){var Gn="number expected, "+An+" found";return Yo(me)&&void 0===we&&(Gn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(Wt.key,Nn,Gn)]}return"categorical"!==we||"number"!==An||isFinite(Bn)&&Math.floor(Bn)===Bn?"categorical"!==we&&"number"===An&&void 0!==Y&&Bn<Y?[new Fe(Wt.key,Nn,"stop domain values must appear in ascending order")]:(Y=Bn,"categorical"===we&&Bn in ze?[new Fe(Wt.key,Nn,"stop domain values must be unique")]:(ze[Bn]=!0,[])):[new Fe(Wt.key,Nn,"integer expected, found "+Bn)]}}function Gr(A){var O=("property"===A.expressionContext?Sn:Qt)(ut(A.value),A.valueSpec);if("error"===O.result)return O.value.map(function(ie){return new Fe(""+A.key+ie.key,A.value,ie.message)});var Y=O.value.expression||O.value._styleExpression.expression;if("property"===A.expressionContext&&"text-font"===A.propertyKey&&!Y.outputDefined())return[new Fe(A.key,A.value,'Invalid data expression for "'+A.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===A.expressionContext&&"layout"===A.propertyType&&!Kn(Y))return[new Fe(A.key,A.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===A.expressionContext&&!Kn(Y))return[new Fe(A.key,A.value,'"feature-state" data expressions are not supported with filters.')];if(A.expressionContext&&0===A.expressionContext.indexOf("cluster")){if(!Qn(Y,["zoom","feature-state"]))return[new Fe(A.key,A.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===A.expressionContext&&!Dn(Y))return[new Fe(A.key,A.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ni(A){var O=A.key,Y=A.value,ie=A.valueSpec,me=[];return Array.isArray(ie.values)?-1===ie.values.indexOf(Ze(Y))&&me.push(new Fe(O,Y,"expected one of ["+ie.values.join(", ")+"], "+JSON.stringify(Y)+" found")):-1===Object.keys(ie.values).indexOf(Ze(Y))&&me.push(new Fe(O,Y,"expected one of ["+Object.keys(ie.values).join(", ")+"], "+JSON.stringify(Y)+" found")),me}function Xr(A){if(!0===A||!1===A)return!0;if(!Array.isArray(A)||0===A.length)return!1;switch(A[0]){case"has":return A.length>=2&&"$id"!==A[1]&&"$type"!==A[1];case"in":return A.length>=3&&("string"!=typeof A[1]||Array.isArray(A[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==A.length||Array.isArray(A[1])||Array.isArray(A[2]);case"any":case"all":for(var O=0,Y=A.slice(1);O<Y.length;O+=1){var ie=Y[O];if(!Xr(ie)&&"boolean"!=typeof ie)return!1}return!0;default:return!0}}Cn.deserialize=function(A){return new Cn(A._parameters,A._specification)},Cn.serialize=function(A){return{_parameters:A._parameters,_specification:A._specification}};var Si={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ni(A){if(null==A)return{filter:function(){return!0},needGeometry:!1};Xr(A)||(A=Qi(A));var O=Qt(A,Si);if("error"===O.result)throw new Error(O.value.map(function(Y){return Y.key+": "+Y.message}).join(", "));return{filter:function(Y,ie,me){return O.value.evaluate(Y,ie,{},me)},needGeometry:function Y(ie){if(!Array.isArray(ie))return!1;if("within"===ie[0])return!0;for(var me=1;me<ie.length;me++)if(Y(ie[me]))return!0;return!1}(A)}}function $i(A,O){return A<O?-1:A>O?1:0}function Qi(A){if(!A)return!0;var O,Y=A[0];return A.length<=1?"any"!==Y:"=="===Y?ea(A[1],A[2],"=="):"!="===Y?ga(ea(A[1],A[2],"==")):"<"===Y||">"===Y||"<="===Y||">="===Y?ea(A[1],A[2],Y):"any"===Y?(O=A.slice(1),["any"].concat(O.map(Qi))):"all"===Y?["all"].concat(A.slice(1).map(Qi)):"none"===Y?["all"].concat(A.slice(1).map(Qi).map(ga)):"in"===Y?za(A[1],A.slice(2)):"!in"===Y?ga(za(A[1],A.slice(2))):"has"===Y?Ma(A[1]):"!has"===Y?ga(Ma(A[1])):"within"!==Y||A}function ea(A,O,Y){switch(A){case"$type":return["filter-type-"+Y,O];case"$id":return["filter-id-"+Y,O];default:return["filter-"+Y,A,O]}}function za(A,O){if(0===O.length)return!1;switch(A){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(Y){return typeof Y!=typeof O[0]})?["filter-in-large",A,["literal",O.sort($i)]]:["filter-in-small",A,["literal",O]]}}function Ma(A){switch(A){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",A]}}function ga(A){return["!",A]}function va(A){return Xr(ut(A.value))?Gr(Ke({},A,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(Y){var ie=Y.value,me=Y.key;if("array"!==Gi(ie))return[new Fe(me,ie,"array expected, "+Gi(ie)+" found")];var we,ze=Y.styleSpec,Ve=[];if(ie.length<1)return[new Fe(me,ie,"filter array must have at least 1 element")];switch(Ve=Ve.concat(ni({key:me+"[0]",value:ie[0],valueSpec:ze.filter_operator,style:Y.style,styleSpec:Y.styleSpec})),Ze(ie[0])){case"<":case"<=":case">":case">=":ie.length>=2&&"$type"===Ze(ie[1])&&Ve.push(new Fe(me,ie,'"$type" cannot be use with operator "'+ie[0]+'"'));case"==":case"!=":3!==ie.length&&Ve.push(new Fe(me,ie,'filter array for operator "'+ie[0]+'" must have 3 elements'));case"in":case"!in":ie.length>=2&&"string"!==(we=Gi(ie[1]))&&Ve.push(new Fe(me+"[1]",ie[1],"string expected, "+we+" found"));for(var nt=2;nt<ie.length;nt++)we=Gi(ie[nt]),"$type"===Ze(ie[1])?Ve=Ve.concat(ni({key:me+"["+nt+"]",value:ie[nt],valueSpec:ze.geometry_type,style:Y.style,styleSpec:Y.styleSpec})):"string"!==we&&"number"!==we&&"boolean"!==we&&Ve.push(new Fe(me+"["+nt+"]",ie[nt],"string, number, or boolean expected, "+we+" found"));break;case"any":case"all":case"none":for(var ht=1;ht<ie.length;ht++)Ve=Ve.concat(O({key:me+"["+ht+"]",value:ie[ht],style:Y.style,styleSpec:Y.styleSpec}));break;case"has":case"!has":we=Gi(ie[1]),2!==ie.length?Ve.push(new Fe(me,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):"string"!==we&&Ve.push(new Fe(me+"[1]",ie[1],"string expected, "+we+" found"));break;case"within":we=Gi(ie[1]),2!==ie.length?Ve.push(new Fe(me,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):"object"!==we&&Ve.push(new Fe(me+"[1]",ie[1],"object expected, "+we+" found"))}return Ve}(A)}function Sa(A,O){var Y=A.key,ie=A.style,me=A.styleSpec,we=A.value,ze=A.objectKey,Ve=me[O+"_"+A.layerType];if(!Ve)return[];var nt=ze.match(/^(.*)-transition$/);if("paint"===O&&nt&&Ve[nt[1]]&&Ve[nt[1]].transition)return pn({key:Y,value:we,valueSpec:me.transition,style:ie,styleSpec:me});var ht,xt=A.valueSpec||Ve[ze];if(!xt)return[new Fe(Y,we,'unknown property "'+ze+'"')];if("string"===Gi(we)&&Yo(xt)&&!xt.tokens&&(ht=/^{([^}]+)}$/.exec(we)))return[new Fe(Y,we,'"'+ze+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ht[1])+" }`.")];var Ut=[];return"symbol"===A.layerType&&("text-field"===ze&&ie&&!ie.glyphs&&Ut.push(new Fe(Y,we,'use of "text-field" requires a style "glyphs" property')),"text-font"===ze&&qe(ut(we))&&"identity"===Ze(we.type)&&Ut.push(new Fe(Y,we,'"text-font" does not support identity functions'))),Ut.concat(pn({key:A.key,value:we,valueSpec:xt,style:ie,styleSpec:me,expressionContext:"property",propertyType:O,propertyKey:ze}))}function Ja(A){return Sa(A,"paint")}function lo(A){return Sa(A,"layout")}function co(A){var O=[],Y=A.value,ie=A.key,me=A.style,we=A.styleSpec;Y.type||Y.ref||O.push(new Fe(ie,Y,'either "type" or "ref" is required'));var ze,Ve=Ze(Y.type),nt=Ze(Y.ref);if(Y.id)for(var ht=Ze(Y.id),xt=0;xt<A.arrayIndex;xt++){var Ut=me.layers[xt];Ze(Ut.id)===ht&&O.push(new Fe(ie,Y.id,'duplicate layer id "'+Y.id+'", previously used at line '+Ut.id.__line__))}if("ref"in Y)["type","source","source-layer","filter","layout"].forEach(function(fn){fn in Y&&O.push(new Fe(ie,Y[fn],'"'+fn+'" is prohibited for ref layers'))}),me.layers.forEach(function(fn){Ze(fn.id)===nt&&(ze=fn)}),ze?ze.ref?O.push(new Fe(ie,Y.ref,"ref cannot reference another ref layer")):Ve=Ze(ze.type):O.push(new Fe(ie,Y.ref,'ref layer "'+nt+'" not found'));else if("background"!==Ve)if(Y.source){var $t=me.sources&&me.sources[Y.source],Wt=$t&&Ze($t.type);$t?"vector"===Wt&&"raster"===Ve?O.push(new Fe(ie,Y.source,'layer "'+Y.id+'" requires a raster source')):"raster"===Wt&&"raster"!==Ve?O.push(new Fe(ie,Y.source,'layer "'+Y.id+'" requires a vector source')):"vector"!==Wt||Y["source-layer"]?"raster-dem"===Wt&&"hillshade"!==Ve?O.push(new Fe(ie,Y.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==Ve||!Y.paint||!Y.paint["line-gradient"]||"geojson"===Wt&&$t.lineMetrics||O.push(new Fe(ie,Y,'layer "'+Y.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new Fe(ie,Y,'layer "'+Y.id+'" must specify a "source-layer"')):O.push(new Fe(ie,Y.source,'source "'+Y.source+'" not found'))}else O.push(new Fe(ie,Y,'missing required property "source"'));return O=O.concat(Vn({key:ie,value:Y,valueSpec:we.layer,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return pn({key:ie+".type",value:Y.type,valueSpec:we.layer.type,style:A.style,styleSpec:A.styleSpec,object:Y,objectKey:"type"})},filter:va,layout:function(fn){return Vn({layer:Y,key:fn.key,value:fn.value,style:fn.style,styleSpec:fn.styleSpec,objectElementValidators:{"*":function(An){return lo(Ke({layerType:Ve},An))}}})},paint:function(fn){return Vn({layer:Y,key:fn.key,value:fn.value,style:fn.style,styleSpec:fn.styleSpec,objectElementValidators:{"*":function(An){return Ja(Ke({layerType:Ve},An))}}})}}}))}function uo(A){var O=A.value,Y=A.key,ie=Gi(O);return"string"!==ie?[new Fe(Y,O,"string expected, "+ie+" found")]:[]}var fo={promoteId:function(A){var O=A.key,Y=A.value;if("string"===Gi(Y))return uo({key:O,value:Y});var ie=[];for(var me in Y)ie.push.apply(ie,uo({key:O+"."+me,value:Y[me]}));return ie}};function Xi(A){var O=A.value,Y=A.key,ie=A.styleSpec,me=A.style;if(!O.type)return[new Fe(Y,O,'"type" is required')];var we,ze=Ze(O.type);switch(ze){case"vector":case"raster":case"raster-dem":return Vn({key:Y,value:O,valueSpec:ie["source_"+ze.replace("-","_")],style:A.style,styleSpec:ie,objectElementValidators:fo});case"geojson":if(we=Vn({key:Y,value:O,valueSpec:ie.source_geojson,style:me,styleSpec:ie,objectElementValidators:fo}),O.cluster)for(var Ve in O.clusterProperties){var nt=O.clusterProperties[Ve],ht=nt[0],Ut="string"==typeof ht?[ht,["accumulated"],["get",Ve]]:ht;we.push.apply(we,Gr({key:Y+"."+Ve+".map",value:nt[1],expressionContext:"cluster-map"})),we.push.apply(we,Gr({key:Y+"."+Ve+".reduce",value:Ut,expressionContext:"cluster-reduce"}))}return we;case"video":return Vn({key:Y,value:O,valueSpec:ie.source_video,style:me,styleSpec:ie});case"image":return Vn({key:Y,value:O,valueSpec:ie.source_image,style:me,styleSpec:ie});case"canvas":return[new Fe(Y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ni({key:Y+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:me,styleSpec:ie})}}function mt(A){var O=A.value,Y=A.styleSpec,ie=Y.light,me=A.style,we=[],ze=Gi(O);if(void 0===O)return we;if("object"!==ze)return we.concat([new Fe("light",O,"object expected, "+ze+" found")]);for(var Ve in O){var nt=Ve.match(/^(.*)-transition$/);we=we.concat(nt&&ie[nt[1]]&&ie[nt[1]].transition?pn({key:Ve,value:O[Ve],valueSpec:Y.transition,style:me,styleSpec:Y}):ie[Ve]?pn({key:Ve,value:O[Ve],valueSpec:ie[Ve],style:me,styleSpec:Y}):[new Fe(Ve,O[Ve],'unknown property "'+Ve+'"')])}return we}var Bt={"*":function(){return[]},array:mr,boolean:function(A){var O=A.value,Y=A.key,ie=Gi(O);return"boolean"!==ie?[new Fe(Y,O,"boolean expected, "+ie+" found")]:[]},number:wr,color:function(A){var O=A.key,Y=A.value,ie=Gi(Y);return"string"!==ie?[new Fe(O,Y,"color expected, "+ie+" found")]:null===gn(Y)?[new Fe(O,Y,'color expected, "'+Y+'" found')]:[]},constants:He,enum:ni,filter:va,function:qr,layer:co,object:Vn,source:Xi,light:mt,string:uo,formatted:function(A){return 0===uo(A).length?[]:Gr(A)},resolvedImage:function(A){return 0===uo(A).length?[]:Gr(A)}};function pn(A){var O=A.value,Y=A.valueSpec,ie=A.styleSpec;return Y.expression&&qe(Ze(O))?qr(A):Y.expression&&rn(ut(O))?Gr(A):Y.type&&Bt[Y.type]?Bt[Y.type](A):Vn(Ke({},A,{valueSpec:Y.type?ie[Y.type]:Y}))}function Xt(A){var O=A.value,Y=A.key,ie=uo(A);return ie.length||(-1===O.indexOf("{fontstack}")&&ie.push(new Fe(Y,O,'"glyphs" url must include a "{fontstack}" token')),-1===O.indexOf("{range}")&&ie.push(new Fe(Y,O,'"glyphs" url must include a "{range}" token'))),ie}function dn(A,O){void 0===O&&(O=be);var Y=[];return Y=Y.concat(pn({key:"",value:A,valueSpec:O.$root,styleSpec:O,style:A,objectElementValidators:{glyphs:Xt,"*":function(){return[]}}})),A.constants&&(Y=Y.concat(He({key:"constants",value:A.constants,style:A,styleSpec:O}))),Fn(Y)}function Fn(A){return[].concat(A).sort(function(O,Y){return O.line-Y.line})}function Zn(A){return function(){for(var O=[],Y=arguments.length;Y--;)O[Y]=arguments[Y];return Fn(A.apply(this,O))}}dn.source=Zn(Xi),dn.light=Zn(mt),dn.layer=Zn(co),dn.filter=Zn(va),dn.paintProperty=Zn(Ja),dn.layoutProperty=Zn(lo);var er=dn,yr=er.light,gr=er.paintProperty,Tr=er.layoutProperty;function Ir(A,O){var Y=!1;if(O&&O.length)for(var ie=0,me=O;ie<me.length;ie+=1)A.fire(new Ye(new Error(me[ie].message))),Y=!0;return Y}var xr=Dr;function Dr(A,O,Y){var ie=this.cells=[];if(A instanceof ArrayBuffer){this.arrayBuffer=A;var me=new Int32Array(this.arrayBuffer);A=me[0],this.d=(O=me[1])+2*(Y=me[2]);for(var we=0;we<this.d*this.d;we++){var ze=me[3+we],Ve=me[3+we+1];ie.push(ze===Ve?null:me.subarray(ze,Ve))}var ht=me[3+ie.length+1];this.keys=me.subarray(me[3+ie.length],ht),this.bboxes=me.subarray(ht),this.insert=this._insertReadonly}else{this.d=O+2*Y;for(var xt=0;xt<this.d*this.d;xt++)ie.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=A,this.padding=Y,this.scale=O/A,this.uid=0;var Ut=Y/O*A;this.min=-Ut,this.max=A+Ut}Dr.prototype.insert=function(A,O,Y,ie,me){this._forEachCell(O,Y,ie,me,this._insertCell,this.uid++),this.keys.push(A),this.bboxes.push(O),this.bboxes.push(Y),this.bboxes.push(ie),this.bboxes.push(me)},Dr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Dr.prototype._insertCell=function(A,O,Y,ie,me,we){this.cells[me].push(we)},Dr.prototype.query=function(A,O,Y,ie,me){var we=this.min,ze=this.max;if(A<=we&&O<=we&&ze<=Y&&ze<=ie&&!me)return Array.prototype.slice.call(this.keys);var Ve=[];return this._forEachCell(A,O,Y,ie,this._queryCell,Ve,{},me),Ve},Dr.prototype._queryCell=function(A,O,Y,ie,me,we,ze,Ve){var nt=this.cells[me];if(null!==nt)for(var ht=this.keys,xt=this.bboxes,Ut=0;Ut<nt.length;Ut++){var $t=nt[Ut];if(void 0===ze[$t]){var Wt=4*$t;(Ve?Ve(xt[Wt+0],xt[Wt+1],xt[Wt+2],xt[Wt+3]):A<=xt[Wt+2]&&O<=xt[Wt+3]&&Y>=xt[Wt+0]&&ie>=xt[Wt+1])?(ze[$t]=!0,we.push(ht[$t])):ze[$t]=!1}}},Dr.prototype._forEachCell=function(A,O,Y,ie,me,we,ze,Ve){for(var nt=this._convertToCellCoord(A),ht=this._convertToCellCoord(O),xt=this._convertToCellCoord(Y),Ut=this._convertToCellCoord(ie),$t=nt;$t<=xt;$t++)for(var Wt=ht;Wt<=Ut;Wt++){var fn=this.d*Wt+$t;if((!Ve||Ve(this._convertFromCellCoord($t),this._convertFromCellCoord(Wt),this._convertFromCellCoord($t+1),this._convertFromCellCoord(Wt+1)))&&me.call(this,A,O,Y,ie,fn,we,ze,Ve))return}},Dr.prototype._convertFromCellCoord=function(A){return(A-this.padding)/this.scale},Dr.prototype._convertToCellCoord=function(A){return Math.max(0,Math.min(this.d-1,Math.floor(A*this.scale)+this.padding))},Dr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var A=this.cells,O=3+this.cells.length+1+1,Y=0,ie=0;ie<this.cells.length;ie++)Y+=this.cells[ie].length;var me=new Int32Array(O+Y+this.keys.length+this.bboxes.length);me[0]=this.extent,me[1]=this.n,me[2]=this.padding;for(var we=O,ze=0;ze<A.length;ze++){var Ve=A[ze];me[3+ze]=we,me.set(Ve,we),we+=Ve.length}return me[3+A.length]=we,me.set(this.keys,we),me[3+A.length+1]=we+=this.keys.length,me.set(this.bboxes,we),we+=this.bboxes.length,me.buffer};var Zr=self.ImageData,ei=self.ImageBitmap,yi={};function nr(A,O,Y){void 0===Y&&(Y={}),Object.defineProperty(O,"_classRegistryKey",{value:A,writeable:!1}),yi[A]={klass:O,omit:Y.omit||[],shallow:Y.shallow||[]}}for(var mi in nr("Object",Object),xr.serialize=function(A,O){var Y=A.toArrayBuffer();return O&&O.push(Y),{buffer:Y}},xr.deserialize=function(A){return new xr(A.buffer)},nr("Grid",xr),nr("Color",nn),nr("Error",Error),nr("ResolvedImage",_n),nr("StylePropertyFunction",Cn),nr("StyleExpression",tn,{omit:["_evaluator"]}),nr("ZoomDependentExpression",xn),nr("ZoomConstantExpression",un),nr("CompoundExpression",sr,{omit:["_evaluate"]}),Bo)Bo[mi]._classRegistryKey||nr("Expression_"+mi,Bo[mi]);function Hr(A){return A&&"undefined"!=typeof ArrayBuffer&&(A instanceof ArrayBuffer||A.constructor&&"ArrayBuffer"===A.constructor.name)}function Jr(A){return ei&&A instanceof ei}function di(A,O){if(null==A||"boolean"==typeof A||"number"==typeof A||"string"==typeof A||A instanceof Boolean||A instanceof Number||A instanceof String||A instanceof Date||A instanceof RegExp)return A;if(Hr(A)||Jr(A))return O&&O.push(A),A;if(ArrayBuffer.isView(A)){var Y=A;return O&&O.push(Y.buffer),Y}if(A instanceof Zr)return O&&O.push(A.data.buffer),A;if(Array.isArray(A)){for(var ie=[],me=0,we=A;me<we.length;me+=1)ie.push(di(we[me],O));return ie}if("object"==typeof A){var Ve=A.constructor,nt=Ve._classRegistryKey;if(!nt)throw new Error("can't serialize object of unregistered class");var ht=Ve.serialize?Ve.serialize(A,O):{};if(!Ve.serialize){for(var xt in A)if(A.hasOwnProperty(xt)&&!(yi[nt].omit.indexOf(xt)>=0)){var Ut=A[xt];ht[xt]=yi[nt].shallow.indexOf(xt)>=0?Ut:di(Ut,O)}A instanceof Error&&(ht.message=A.message)}if(ht.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==nt&&(ht.$name=nt),ht}throw new Error("can't serialize object of type "+typeof A)}function Pi(A){if(null==A||"boolean"==typeof A||"number"==typeof A||"string"==typeof A||A instanceof Boolean||A instanceof Number||A instanceof String||A instanceof Date||A instanceof RegExp||Hr(A)||Jr(A)||ArrayBuffer.isView(A)||A instanceof Zr)return A;if(Array.isArray(A))return A.map(Pi);if("object"==typeof A){var O=A.$name||"Object",Y=yi[O].klass;if(!Y)throw new Error("can't deserialize unregistered class "+O);if(Y.deserialize)return Y.deserialize(A);for(var ie=Object.create(Y.prototype),me=0,we=Object.keys(A);me<we.length;me+=1){var ze=we[me];if("$name"!==ze){var Ve=A[ze];ie[ze]=yi[O].shallow.indexOf(ze)>=0?Ve:Pi(Ve)}}return ie}throw new Error("can't deserialize object of type "+typeof A)}var Vi=function(){this.first=!0};Vi.prototype.update=function(A,O){var Y=Math.floor(A);return this.first?(this.first=!1,this.lastIntegerZoom=Y,this.lastIntegerZoomTime=0,this.lastZoom=A,this.lastFloorZoom=Y,!0):(this.lastFloorZoom>Y?(this.lastIntegerZoom=Y+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<Y&&(this.lastIntegerZoom=Y,this.lastIntegerZoomTime=O),A!==this.lastZoom&&(this.lastZoom=A,this.lastFloorZoom=Y,!0))};var Br={"Latin-1 Supplement":function(A){return A>=128&&A<=255},Arabic:function(A){return A>=1536&&A<=1791},"Arabic Supplement":function(A){return A>=1872&&A<=1919},"Arabic Extended-A":function(A){return A>=2208&&A<=2303},"Hangul Jamo":function(A){return A>=4352&&A<=4607},"Unified Canadian Aboriginal Syllabics":function(A){return A>=5120&&A<=5759},Khmer:function(A){return A>=6016&&A<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(A){return A>=6320&&A<=6399},"General Punctuation":function(A){return A>=8192&&A<=8303},"Letterlike Symbols":function(A){return A>=8448&&A<=8527},"Number Forms":function(A){return A>=8528&&A<=8591},"Miscellaneous Technical":function(A){return A>=8960&&A<=9215},"Control Pictures":function(A){return A>=9216&&A<=9279},"Optical Character Recognition":function(A){return A>=9280&&A<=9311},"Enclosed Alphanumerics":function(A){return A>=9312&&A<=9471},"Geometric Shapes":function(A){return A>=9632&&A<=9727},"Miscellaneous Symbols":function(A){return A>=9728&&A<=9983},"Miscellaneous Symbols and Arrows":function(A){return A>=11008&&A<=11263},"CJK Radicals Supplement":function(A){return A>=11904&&A<=12031},"Kangxi Radicals":function(A){return A>=12032&&A<=12255},"Ideographic Description Characters":function(A){return A>=12272&&A<=12287},"CJK Symbols and Punctuation":function(A){return A>=12288&&A<=12351},Hiragana:function(A){return A>=12352&&A<=12447},Katakana:function(A){return A>=12448&&A<=12543},Bopomofo:function(A){return A>=12544&&A<=12591},"Hangul Compatibility Jamo":function(A){return A>=12592&&A<=12687},Kanbun:function(A){return A>=12688&&A<=12703},"Bopomofo Extended":function(A){return A>=12704&&A<=12735},"CJK Strokes":function(A){return A>=12736&&A<=12783},"Katakana Phonetic Extensions":function(A){return A>=12784&&A<=12799},"Enclosed CJK Letters and Months":function(A){return A>=12800&&A<=13055},"CJK Compatibility":function(A){return A>=13056&&A<=13311},"CJK Unified Ideographs Extension A":function(A){return A>=13312&&A<=19903},"Yijing Hexagram Symbols":function(A){return A>=19904&&A<=19967},"CJK Unified Ideographs":function(A){return A>=19968&&A<=40959},"Yi Syllables":function(A){return A>=40960&&A<=42127},"Yi Radicals":function(A){return A>=42128&&A<=42191},"Hangul Jamo Extended-A":function(A){return A>=43360&&A<=43391},"Hangul Syllables":function(A){return A>=44032&&A<=55215},"Hangul Jamo Extended-B":function(A){return A>=55216&&A<=55295},"Private Use Area":function(A){return A>=57344&&A<=63743},"CJK Compatibility Ideographs":function(A){return A>=63744&&A<=64255},"Arabic Presentation Forms-A":function(A){return A>=64336&&A<=65023},"Vertical Forms":function(A){return A>=65040&&A<=65055},"CJK Compatibility Forms":function(A){return A>=65072&&A<=65103},"Small Form Variants":function(A){return A>=65104&&A<=65135},"Arabic Presentation Forms-B":function(A){return A>=65136&&A<=65279},"Halfwidth and Fullwidth Forms":function(A){return A>=65280&&A<=65519}};function Wi(A){for(var O=0,Y=A;O<Y.length;O+=1)if(Mi(Y[O].charCodeAt(0)))return!0;return!1}function Ui(A){return!(Br.Arabic(A)||Br["Arabic Supplement"](A)||Br["Arabic Extended-A"](A)||Br["Arabic Presentation Forms-A"](A)||Br["Arabic Presentation Forms-B"](A))}function Mi(A){return!(746!==A&&747!==A&&(A<4352||!(Br["Bopomofo Extended"](A)||Br.Bopomofo(A)||Br["CJK Compatibility Forms"](A)&&!(A>=65097&&A<=65103)||Br["CJK Compatibility Ideographs"](A)||Br["CJK Compatibility"](A)||Br["CJK Radicals Supplement"](A)||Br["CJK Strokes"](A)||!(!Br["CJK Symbols and Punctuation"](A)||A>=12296&&A<=12305||A>=12308&&A<=12319||12336===A)||Br["CJK Unified Ideographs Extension A"](A)||Br["CJK Unified Ideographs"](A)||Br["Enclosed CJK Letters and Months"](A)||Br["Hangul Compatibility Jamo"](A)||Br["Hangul Jamo Extended-A"](A)||Br["Hangul Jamo Extended-B"](A)||Br["Hangul Jamo"](A)||Br["Hangul Syllables"](A)||Br.Hiragana(A)||Br["Ideographic Description Characters"](A)||Br.Kanbun(A)||Br["Kangxi Radicals"](A)||Br["Katakana Phonetic Extensions"](A)||Br.Katakana(A)&&12540!==A||!(!Br["Halfwidth and Fullwidth Forms"](A)||65288===A||65289===A||65293===A||A>=65306&&A<=65310||65339===A||65341===A||65343===A||A>=65371&&A<=65503||65507===A||A>=65512&&A<=65519)||!(!Br["Small Form Variants"](A)||A>=65112&&A<=65118||A>=65123&&A<=65126)||Br["Unified Canadian Aboriginal Syllabics"](A)||Br["Unified Canadian Aboriginal Syllabics Extended"](A)||Br["Vertical Forms"](A)||Br["Yijing Hexagram Symbols"](A)||Br["Yi Syllables"](A)||Br["Yi Radicals"](A))))}function Ji(A){return!(Mi(A)||(O=A,Br["Latin-1 Supplement"](O)&&(167===O||169===O||174===O||177===O||188===O||189===O||190===O||215===O||247===O)||Br["General Punctuation"](O)&&(8214===O||8224===O||8225===O||8240===O||8241===O||8251===O||8252===O||8258===O||8263===O||8264===O||8265===O||8273===O)||Br["Letterlike Symbols"](O)||Br["Number Forms"](O)||Br["Miscellaneous Technical"](O)&&(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||9003===O||O>=9085&&O<=9114||O>=9150&&O<=9165||9167===O||O>=9169&&O<=9179||O>=9186&&O<=9215)||Br["Control Pictures"](O)&&9251!==O||Br["Optical Character Recognition"](O)||Br["Enclosed Alphanumerics"](O)||Br["Geometric Shapes"](O)||Br["Miscellaneous Symbols"](O)&&!(O>=9754&&O<=9759)||Br["Miscellaneous Symbols and Arrows"](O)&&(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243)||Br["CJK Symbols and Punctuation"](O)||Br.Katakana(O)||Br["Private Use Area"](O)||Br["CJK Compatibility Forms"](O)||Br["Small Form Variants"](O)||Br["Halfwidth and Fullwidth Forms"](O)||8734===O||8756===O||8757===O||O>=9984&&O<=10087||O>=10102&&O<=10131||65532===O||65533===O));var O}function Bi(A){return A>=1424&&A<=2303||Br["Arabic Presentation Forms-A"](A)||Br["Arabic Presentation Forms-B"](A)}function ua(A,O){return!(!O&&Bi(A)||A>=2304&&A<=3583||A>=3840&&A<=4255||Br.Khmer(A))}function gi(A){for(var O=0,Y=A;O<Y.length;O+=1)if(Bi(Y[O].charCodeAt(0)))return!0;return!1}var aa="deferred",Qa="loading",Jo="loaded",To=null,Ei="unavailable",ka=null,ko=function(A){A&&"string"==typeof A&&A.indexOf("NetworkError")>-1&&(Ei="error"),To&&To(A)};function oa(){Pa.fire(new je("pluginStateChange",{pluginStatus:Ei,pluginURL:ka}))}var Pa=new he,eo=function(){return Ei},pa=function(){if(Ei!==aa||!ka)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ei=Qa,oa(),ka&&yt({url:ka},function(A){A?ko(A):(Ei=Jo,oa())})},xo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ei===Jo||null!=xo.applyArabicShaping},isLoading:function(){return Ei===Qa},setState:function(A){Ei=A.pluginStatus,ka=A.pluginURL},isParsed:function(){return null!=xo.applyArabicShaping&&null!=xo.processBidirectionalText&&null!=xo.processStyledBidirectionalText},getPluginURL:function(){return ka}},fa=function(A,O){this.zoom=A,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Vi,this.transition={})};fa.prototype.isSupportedScript=function(A){return function(O,Y){for(var ie=0,me=O;ie<me.length;ie+=1)if(!ua(me[ie].charCodeAt(0),Y))return!1;return!0}(A,xo.isLoaded())},fa.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},fa.prototype.getCrossfadeParameters=function(){var A=this.zoom,O=A-Math.floor(A),Y=this.crossFadingFactor();return A>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*Y}:{fromScale:.5,toScale:1,t:1-(1-Y)*O}};var ho=function(A,O){this.property=A,this.value=O,this.expression=function(Y,ie){if(qe(Y))return new Cn(Y,ie);if(rn(Y)){var me=Sn(Y,ie);if("error"===me.result)throw new Error(me.value.map(function(ze){return ze.key+": "+ze.message}).join(", "));return me.value}var we=Y;return"string"==typeof Y&&"color"===ie.type&&(we=nn.parse(Y)),{kind:"constant",evaluate:function(){return we}}}(void 0===O?A.specification.default:O,A.specification)};ho.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ho.prototype.possiblyEvaluate=function(A,O,Y){return this.property.possiblyEvaluate(this,A,O,Y)};var cs=function(A){this.property=A,this.value=new ho(A,void 0)};cs.prototype.transitioned=function(A,O){return new Es(this.property,this.value,O,o({},A.transition,this.transition),A.now)},cs.prototype.untransitioned=function(){return new Es(this.property,this.value,null,{},0)};var rs=function(A){this._properties=A,this._values=Object.create(A.defaultTransitionablePropertyValues)};rs.prototype.getValue=function(A){return T(this._values[A].value.value)},rs.prototype.setValue=function(A,O){this._values.hasOwnProperty(A)||(this._values[A]=new cs(this._values[A].property)),this._values[A].value=new ho(this._values[A].property,null===O?void 0:T(O))},rs.prototype.getTransition=function(A){return T(this._values[A].transition)},rs.prototype.setTransition=function(A,O){this._values.hasOwnProperty(A)||(this._values[A]=new cs(this._values[A].property)),this._values[A].transition=T(O)||void 0},rs.prototype.serialize=function(){for(var A={},O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ie=Y[O],me=this.getValue(ie);void 0!==me&&(A[ie]=me);var we=this.getTransition(ie);void 0!==we&&(A[ie+"-transition"]=we)}return A},rs.prototype.transitioned=function(A,O){for(var Y=new ja(this._properties),ie=0,me=Object.keys(this._values);ie<me.length;ie+=1){var we=me[ie];Y._values[we]=this._values[we].transitioned(A,O._values[we])}return Y},rs.prototype.untransitioned=function(){for(var A=new ja(this._properties),O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ie=Y[O];A._values[ie]=this._values[ie].untransitioned()}return A};var Es=function(A,O,Y,ie,me){this.property=A,this.value=O,this.begin=me+ie.delay||0,this.end=this.begin+ie.duration||0,A.specification.transition&&(ie.delay||ie.duration)&&(this.prior=Y)};Es.prototype.possiblyEvaluate=function(A,O,Y){var ie=A.now||0,me=this.value.possiblyEvaluate(A,O,Y),we=this.prior;if(we){if(ie>this.end)return this.prior=null,me;if(this.value.isDataDriven())return this.prior=null,me;if(ie<this.begin)return we.possiblyEvaluate(A,O,Y);var ze=(ie-this.begin)/(this.end-this.begin);return this.property.interpolate(we.possiblyEvaluate(A,O,Y),me,function(Ve){if(Ve<=0)return 0;if(Ve>=1)return 1;var nt=Ve*Ve,ht=nt*Ve;return 4*(Ve<.5?ht:3*(Ve-nt)+ht-.75)}(ze))}return me};var ja=function(A){this._properties=A,this._values=Object.create(A.defaultTransitioningPropertyValues)};ja.prototype.possiblyEvaluate=function(A,O,Y){for(var ie=new is(this._properties),me=0,we=Object.keys(this._values);me<we.length;me+=1){var ze=we[me];ie._values[ze]=this._values[ze].possiblyEvaluate(A,O,Y)}return ie},ja.prototype.hasTransition=function(){for(var A=0,O=Object.keys(this._values);A<O.length;A+=1)if(this._values[O[A]].prior)return!0;return!1};var Ls=function(A){this._properties=A,this._values=Object.create(A.defaultPropertyValues)};Ls.prototype.getValue=function(A){return T(this._values[A].value)},Ls.prototype.setValue=function(A,O){this._values[A]=new ho(this._values[A].property,null===O?void 0:T(O))},Ls.prototype.serialize=function(){for(var A={},O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ie=Y[O],me=this.getValue(ie);void 0!==me&&(A[ie]=me)}return A},Ls.prototype.possiblyEvaluate=function(A,O,Y){for(var ie=new is(this._properties),me=0,we=Object.keys(this._values);me<we.length;me+=1){var ze=we[me];ie._values[ze]=this._values[ze].possiblyEvaluate(A,O,Y)}return ie};var Ua=function(A,O,Y){this.property=A,this.value=O,this.parameters=Y};Ua.prototype.isConstant=function(){return"constant"===this.value.kind},Ua.prototype.constantOr=function(A){return"constant"===this.value.kind?this.value.value:A},Ua.prototype.evaluate=function(A,O,Y,ie){return this.property.evaluate(this.value,this.parameters,A,O,Y,ie)};var is=function(A){this._properties=A,this._values=Object.create(A.defaultPossiblyEvaluatedValues)};is.prototype.get=function(A){return this._values[A]};var Ti=function(A){this.specification=A};Ti.prototype.possiblyEvaluate=function(A,O){return A.expression.evaluate(O)},Ti.prototype.interpolate=function(A,O,Y){var ie=Ur[this.specification.type];return ie?ie(A,O,Y):A};var Li=function(A,O){this.specification=A,this.overrides=O};Li.prototype.possiblyEvaluate=function(A,O,Y,ie){return new Ua(this,"constant"===A.expression.kind||"camera"===A.expression.kind?{kind:"constant",value:A.expression.evaluate(O,null,{},Y,ie)}:A.expression,O)},Li.prototype.interpolate=function(A,O,Y){if("constant"!==A.value.kind||"constant"!==O.value.kind)return A;if(void 0===A.value.value||void 0===O.value.value)return new Ua(this,{kind:"constant",value:void 0},A.parameters);var ie=Ur[this.specification.type];return ie?new Ua(this,{kind:"constant",value:ie(A.value.value,O.value.value,Y)},A.parameters):A},Li.prototype.evaluate=function(A,O,Y,ie,me,we){return"constant"===A.kind?A.value:A.evaluate(O,Y,ie,me,we)};var zs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.possiblyEvaluate=function(Y,ie,me,we){if(void 0===Y.value)return new Ua(this,{kind:"constant",value:void 0},ie);if("constant"===Y.expression.kind){var ze=Y.expression.evaluate(ie,null,{},me,we),Ve="resolvedImage"===Y.property.specification.type&&"string"!=typeof ze?ze.name:ze,nt=this._calculate(Ve,Ve,Ve,ie);return new Ua(this,{kind:"constant",value:nt},ie)}if("camera"===Y.expression.kind){var ht=this._calculate(Y.expression.evaluate({zoom:ie.zoom-1}),Y.expression.evaluate({zoom:ie.zoom}),Y.expression.evaluate({zoom:ie.zoom+1}),ie);return new Ua(this,{kind:"constant",value:ht},ie)}return new Ua(this,Y.expression,ie)},O.prototype.evaluate=function(Y,ie,me,we,ze,Ve){if("source"===Y.kind){var nt=Y.evaluate(ie,me,we,ze,Ve);return this._calculate(nt,nt,nt,ie)}return"composite"===Y.kind?this._calculate(Y.evaluate({zoom:Math.floor(ie.zoom)-1},me,we),Y.evaluate({zoom:Math.floor(ie.zoom)},me,we),Y.evaluate({zoom:Math.floor(ie.zoom)+1},me,we),ie):Y.value},O.prototype._calculate=function(Y,ie,me,we){return we.zoom>we.zoomHistory.lastIntegerZoom?{from:Y,to:ie}:{from:me,to:ie}},O.prototype.interpolate=function(Y){return Y},O}(Li),Ps=function(A){this.specification=A};Ps.prototype.possiblyEvaluate=function(A,O,Y,ie){if(void 0!==A.value){if("constant"===A.expression.kind){var me=A.expression.evaluate(O,null,{},Y,ie);return this._calculate(me,me,me,O)}return this._calculate(A.expression.evaluate(new fa(Math.floor(O.zoom-1),O)),A.expression.evaluate(new fa(Math.floor(O.zoom),O)),A.expression.evaluate(new fa(Math.floor(O.zoom+1),O)),O)}},Ps.prototype._calculate=function(A,O,Y,ie){return ie.zoom>ie.zoomHistory.lastIntegerZoom?{from:A,to:O}:{from:Y,to:O}},Ps.prototype.interpolate=function(A){return A};var as=function(A){this.specification=A};as.prototype.possiblyEvaluate=function(A,O,Y,ie){return!!A.expression.evaluate(O,null,{},Y,ie)},as.prototype.interpolate=function(){return!1};var Oo=function(A){for(var O in this.properties=A,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],A){var Y=A[O];Y.specification.overridable&&this.overridableProperties.push(O);var ie=this.defaultPropertyValues[O]=new ho(Y,void 0),me=this.defaultTransitionablePropertyValues[O]=new cs(Y);this.defaultTransitioningPropertyValues[O]=me.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=ie.possiblyEvaluate({})}};nr("DataDrivenProperty",Li),nr("DataConstantProperty",Ti),nr("CrossFadedDataDrivenProperty",zs),nr("CrossFadedProperty",Ps),nr("ColorRampProperty",as);var Zo=function(A){function O(Y,ie){if(A.call(this),this.id=Y.id,this.type=Y.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==Y.type&&(this.metadata=Y.metadata,this.minzoom=Y.minzoom,this.maxzoom=Y.maxzoom,"background"!==Y.type&&(this.source=Y.source,this.sourceLayer=Y["source-layer"],this.filter=Y.filter),ie.layout&&(this._unevaluatedLayout=new Ls(ie.layout)),ie.paint)){for(var me in this._transitionablePaint=new rs(ie.paint),Y.paint)this.setPaintProperty(me,Y.paint[me],{validate:!1});for(var we in Y.layout)this.setLayoutProperty(we,Y.layout[we],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new is(ie.paint)}}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(Y){return"visibility"===Y?this.visibility:this._unevaluatedLayout.getValue(Y)},O.prototype.setLayoutProperty=function(Y,ie,me){void 0===me&&(me={}),null!=ie&&this._validate(Tr,"layers."+this.id+".layout."+Y,Y,ie,me)||("visibility"!==Y?this._unevaluatedLayout.setValue(Y,ie):this.visibility=ie)},O.prototype.getPaintProperty=function(Y){return _(Y,"-transition")?this._transitionablePaint.getTransition(Y.slice(0,-11)):this._transitionablePaint.getValue(Y)},O.prototype.setPaintProperty=function(Y,ie,me){if(void 0===me&&(me={}),null!=ie&&this._validate(gr,"layers."+this.id+".paint."+Y,Y,ie,me))return!1;if(_(Y,"-transition"))return this._transitionablePaint.setTransition(Y.slice(0,-11),ie||void 0),!1;var ze=this._transitionablePaint._values[Y],Ve="cross-faded-data-driven"===ze.property.specification["property-type"],nt=ze.value.isDataDriven(),ht=ze.value;this._transitionablePaint.setValue(Y,ie),this._handleSpecialPaintPropertyUpdate(Y);var xt=this._transitionablePaint._values[Y].value;return xt.isDataDriven()||nt||Ve||this._handleOverridablePaintPropertyUpdate(Y,ht,xt)},O.prototype._handleSpecialPaintPropertyUpdate=function(Y){},O.prototype._handleOverridablePaintPropertyUpdate=function(Y,ie,me){return!1},O.prototype.isHidden=function(Y){return!!(this.minzoom&&Y<this.minzoom)||!!(this.maxzoom&&Y>=this.maxzoom)||"none"===this.visibility},O.prototype.updateTransitions=function(Y){this._transitioningPaint=this._transitionablePaint.transitioned(Y,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(Y,ie){Y.getCrossfadeParameters&&(this._crossfadeParameters=Y.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Y,void 0,ie)),this.paint=this._transitioningPaint.possiblyEvaluate(Y,void 0,ie)},O.prototype.serialize=function(){var Y={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(Y.layout=Y.layout||{},Y.layout.visibility=this.visibility),w(Y,function(ie,me){return!(void 0===ie||"layout"===me&&!Object.keys(ie).length||"paint"===me&&!Object.keys(ie).length)})},O.prototype._validate=function(Y,ie,me,we,ze){return void 0===ze&&(ze={}),(!ze||!1!==ze.validate)&&Ir(this,Y.call(er,{key:ie,layerType:this.type,objectKey:me,value:we,styleSpec:be,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var Y in this.paint._values){var ie=this.paint.get(Y);if(ie instanceof Ua&&Yo(ie.property.specification)&&("source"===ie.value.kind||"composite"===ie.value.kind)&&ie.value.isStateDependent)return!0}return!1},O}(he),Zs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Cs=function(A,O){this._structArray=A,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},sa=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function da(A,O){void 0===O&&(O=1);var Y=0,ie=0;return{members:A.map(function(me){var ze=Zs[me.type].BYTES_PER_ELEMENT,Ve=Y=gs(Y,Math.max(O,ze)),nt=me.components||1;return ie=Math.max(ie,ze),Y+=ze*nt,{name:me.name,type:me.type,components:nt,offset:Ve}}),size:gs(Y,Math.max(ie,O)),alignment:O}}function gs(A,O){return Math.ceil(A/O)*O}sa.serialize=function(A,O){return A._trim(),O&&(A.isTransferred=!0,O.push(A.arrayBuffer)),{length:A.length,arrayBuffer:A.arrayBuffer}},sa.deserialize=function(A){var O=Object.create(this.prototype);return O.arrayBuffer=A.arrayBuffer,O.length=A.length,O.capacity=A.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},sa.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},sa.prototype.clear=function(){this.length=0},sa.prototype.resize=function(A){this.reserve(A),this.length=A},sa.prototype.reserve=function(A){if(A>this.capacity){this.capacity=Math.max(A,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},sa.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var us=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie){var me=this.length;return this.resize(me+1),this.emplace(me,Y,ie)},O.prototype.emplace=function(Y,ie,me){var we=2*Y;return this.int16[we+0]=ie,this.int16[we+1]=me,Y},O}(sa);us.prototype.bytesPerElement=4,nr("StructArrayLayout2i4",us);var Na=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we){var ze=this.length;return this.resize(ze+1),this.emplace(ze,Y,ie,me,we)},O.prototype.emplace=function(Y,ie,me,we,ze){var Ve=4*Y;return this.int16[Ve+0]=ie,this.int16[Ve+1]=me,this.int16[Ve+2]=we,this.int16[Ve+3]=ze,Y},O}(sa);Na.prototype.bytesPerElement=8,nr("StructArrayLayout4i8",Na);var Je=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve){var nt=this.length;return this.resize(nt+1),this.emplace(nt,Y,ie,me,we,ze,Ve)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt){var ht=6*Y;return this.int16[ht+0]=ie,this.int16[ht+1]=me,this.int16[ht+2]=we,this.int16[ht+3]=ze,this.int16[ht+4]=Ve,this.int16[ht+5]=nt,Y},O}(sa);Je.prototype.bytesPerElement=12,nr("StructArrayLayout2i4i12",Je);var Dt=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve){var nt=this.length;return this.resize(nt+1),this.emplace(nt,Y,ie,me,we,ze,Ve)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt){var ht=4*Y,xt=8*Y;return this.int16[ht+0]=ie,this.int16[ht+1]=me,this.uint8[xt+4]=we,this.uint8[xt+5]=ze,this.uint8[xt+6]=Ve,this.uint8[xt+7]=nt,Y},O}(sa);Dt.prototype.bytesPerElement=8,nr("StructArrayLayout2i4ub8",Dt);var _e=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut){var $t=this.length;return this.resize($t+1),this.emplace($t,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t){var Wt=9*Y,fn=18*Y;return this.uint16[Wt+0]=ie,this.uint16[Wt+1]=me,this.uint16[Wt+2]=we,this.uint16[Wt+3]=ze,this.uint16[Wt+4]=Ve,this.uint16[Wt+5]=nt,this.uint16[Wt+6]=ht,this.uint16[Wt+7]=xt,this.uint8[fn+16]=Ut,this.uint8[fn+17]=$t,Y},O}(sa);_e.prototype.bytesPerElement=18,nr("StructArrayLayout8ui2ub18",_e);var Be=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt){var fn=this.length;return this.resize(fn+1),this.emplace(fn,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn){var An=12*Y;return this.int16[An+0]=ie,this.int16[An+1]=me,this.int16[An+2]=we,this.int16[An+3]=ze,this.uint16[An+4]=Ve,this.uint16[An+5]=nt,this.uint16[An+6]=ht,this.uint16[An+7]=xt,this.int16[An+8]=Ut,this.int16[An+9]=$t,this.int16[An+10]=Wt,this.int16[An+11]=fn,Y},O}(sa);Be.prototype.bytesPerElement=24,nr("StructArrayLayout4i4ui4i24",Be);var Ft=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,me)},O.prototype.emplace=function(Y,ie,me,we){var ze=3*Y;return this.float32[ze+0]=ie,this.float32[ze+1]=me,this.float32[ze+2]=we,Y},O}(sa);Ft.prototype.bytesPerElement=12,nr("StructArrayLayout3f12",Ft);var Tn=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Y)},O.prototype.emplace=function(Y,ie){return this.uint32[1*Y+0]=ie,Y},O}(sa);Tn.prototype.bytesPerElement=4,nr("StructArrayLayout1ul4",Tn);var $n=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve,nt,ht,xt){var Ut=this.length;return this.resize(Ut+1),this.emplace(Ut,Y,ie,me,we,ze,Ve,nt,ht,xt)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut){var $t=10*Y,Wt=5*Y;return this.int16[$t+0]=ie,this.int16[$t+1]=me,this.int16[$t+2]=we,this.int16[$t+3]=ze,this.int16[$t+4]=Ve,this.int16[$t+5]=nt,this.uint32[Wt+3]=ht,this.uint16[$t+8]=xt,this.uint16[$t+9]=Ut,Y},O}(sa);$n.prototype.bytesPerElement=20,nr("StructArrayLayout6i1ul2ui20",$n);var or=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve){var nt=this.length;return this.resize(nt+1),this.emplace(nt,Y,ie,me,we,ze,Ve)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt){var ht=6*Y;return this.int16[ht+0]=ie,this.int16[ht+1]=me,this.int16[ht+2]=we,this.int16[ht+3]=ze,this.int16[ht+4]=Ve,this.int16[ht+5]=nt,Y},O}(sa);or.prototype.bytesPerElement=12,nr("StructArrayLayout2i2i2i12",or);var vr=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze){var Ve=this.length;return this.resize(Ve+1),this.emplace(Ve,Y,ie,me,we,ze)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve){var nt=4*Y,ht=8*Y;return this.float32[nt+0]=ie,this.float32[nt+1]=me,this.float32[nt+2]=we,this.int16[ht+6]=ze,this.int16[ht+7]=Ve,Y},O}(sa);vr.prototype.bytesPerElement=16,nr("StructArrayLayout2f1f2i16",vr);var ur=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we){var ze=this.length;return this.resize(ze+1),this.emplace(ze,Y,ie,me,we)},O.prototype.emplace=function(Y,ie,me,we,ze){var Ve=12*Y,nt=3*Y;return this.uint8[Ve+0]=ie,this.uint8[Ve+1]=me,this.float32[nt+1]=we,this.float32[nt+2]=ze,Y},O}(sa);ur.prototype.bytesPerElement=12,nr("StructArrayLayout2ub2f12",ur);var Or=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,me)},O.prototype.emplace=function(Y,ie,me,we){var ze=3*Y;return this.uint16[ze+0]=ie,this.uint16[ze+1]=me,this.uint16[ze+2]=we,Y},O}(sa);Or.prototype.bytesPerElement=6,nr("StructArrayLayout3ui6",Or);var Nr=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An,Bn,Nn,Gn){var Jn=this.length;return this.resize(Jn+1),this.emplace(Jn,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An,Bn,Nn,Gn)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An,Bn,Nn,Gn,Jn){var tr=24*Y,kr=12*Y,zr=48*Y;return this.int16[tr+0]=ie,this.int16[tr+1]=me,this.uint16[tr+2]=we,this.uint16[tr+3]=ze,this.uint32[kr+2]=Ve,this.uint32[kr+3]=nt,this.uint32[kr+4]=ht,this.uint16[tr+10]=xt,this.uint16[tr+11]=Ut,this.uint16[tr+12]=$t,this.float32[kr+7]=Wt,this.float32[kr+8]=fn,this.uint8[zr+36]=An,this.uint8[zr+37]=Bn,this.uint8[zr+38]=Nn,this.uint32[kr+10]=Gn,this.int16[tr+22]=Jn,Y},O}(sa);Nr.prototype.bytesPerElement=48,nr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Nr);var ii=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An,Bn,Nn,Gn,Jn,tr,kr,zr,Kr,Wr,ai,bi,_i,hi,Ci){var Ai=this.length;return this.resize(Ai+1),this.emplace(Ai,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An,Bn,Nn,Gn,Jn,tr,kr,zr,Kr,Wr,ai,bi,_i,hi,Ci)},O.prototype.emplace=function(Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An,Bn,Nn,Gn,Jn,tr,kr,zr,Kr,Wr,ai,bi,_i,hi,Ci,Ai){var wi=34*Y,ha=17*Y;return this.int16[wi+0]=ie,this.int16[wi+1]=me,this.int16[wi+2]=we,this.int16[wi+3]=ze,this.int16[wi+4]=Ve,this.int16[wi+5]=nt,this.int16[wi+6]=ht,this.int16[wi+7]=xt,this.uint16[wi+8]=Ut,this.uint16[wi+9]=$t,this.uint16[wi+10]=Wt,this.uint16[wi+11]=fn,this.uint16[wi+12]=An,this.uint16[wi+13]=Bn,this.uint16[wi+14]=Nn,this.uint16[wi+15]=Gn,this.uint16[wi+16]=Jn,this.uint16[wi+17]=tr,this.uint16[wi+18]=kr,this.uint16[wi+19]=zr,this.uint16[wi+20]=Kr,this.uint16[wi+21]=Wr,this.uint16[wi+22]=ai,this.uint32[ha+12]=bi,this.float32[ha+13]=_i,this.float32[ha+14]=hi,this.float32[ha+15]=Ci,this.float32[ha+16]=Ai,Y},O}(sa);ii.prototype.bytesPerElement=68,nr("StructArrayLayout8i15ui1ul4f68",ii);var le=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Y)},O.prototype.emplace=function(Y,ie){return this.float32[1*Y+0]=ie,Y},O}(sa);le.prototype.bytesPerElement=4,nr("StructArrayLayout1f4",le);var E=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,me)},O.prototype.emplace=function(Y,ie,me,we){var ze=3*Y;return this.int16[ze+0]=ie,this.int16[ze+1]=me,this.int16[ze+2]=we,Y},O}(sa);E.prototype.bytesPerElement=6,nr("StructArrayLayout3i6",E);var I=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,me)},O.prototype.emplace=function(Y,ie,me,we){var Ve=4*Y;return this.uint32[2*Y+0]=ie,this.uint16[Ve+2]=me,this.uint16[Ve+3]=we,Y},O}(sa);I.prototype.bytesPerElement=8,nr("StructArrayLayout1ul2ui8",I);var F=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie){var me=this.length;return this.resize(me+1),this.emplace(me,Y,ie)},O.prototype.emplace=function(Y,ie,me){var we=2*Y;return this.uint16[we+0]=ie,this.uint16[we+1]=me,Y},O}(sa);F.prototype.bytesPerElement=4,nr("StructArrayLayout2ui4",F);var H=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Y)},O.prototype.emplace=function(Y,ie){return this.uint16[1*Y+0]=ie,Y},O}(sa);H.prototype.bytesPerElement=2,nr("StructArrayLayout1ui2",H);var re=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie){var me=this.length;return this.resize(me+1),this.emplace(me,Y,ie)},O.prototype.emplace=function(Y,ie,me){var we=2*Y;return this.float32[we+0]=ie,this.float32[we+1]=me,Y},O}(sa);re.prototype.bytesPerElement=8,nr("StructArrayLayout2f8",re);var ue=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,me,we){var ze=this.length;return this.resize(ze+1),this.emplace(ze,Y,ie,me,we)},O.prototype.emplace=function(Y,ie,me,we,ze){var Ve=4*Y;return this.float32[Ve+0]=ie,this.float32[Ve+1]=me,this.float32[Ve+2]=we,this.float32[Ve+3]=ze,Y},O}(sa);ue.prototype.bytesPerElement=16,nr("StructArrayLayout4f16",ue);var ye=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Y={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return Y.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},Y.x1.get=function(){return this._structArray.int16[this._pos2+2]},Y.y1.get=function(){return this._structArray.int16[this._pos2+3]},Y.x2.get=function(){return this._structArray.int16[this._pos2+4]},Y.y2.get=function(){return this._structArray.int16[this._pos2+5]},Y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},Y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Y.anchorPoint.get=function(){return new n(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,Y),O}(Cs);ye.prototype.size=20;var ke=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Y){return new ye(this,Y)},O}($n);nr("CollisionBoxArray",ke);var Ee=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Y={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return Y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Y.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Y.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},Y.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},Y.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Y.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},Y.segment.get=function(){return this._structArray.uint16[this._pos2+10]},Y.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},Y.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},Y.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},Y.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},Y.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},Y.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},Y.placedOrientation.set=function(ie){this._structArray.uint8[this._pos1+37]=ie},Y.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},Y.hidden.set=function(ie){this._structArray.uint8[this._pos1+38]=ie},Y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},Y.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+10]=ie},Y.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,Y),O}(Cs);Ee.prototype.size=48;var Ue=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Y){return new Ee(this,Y)},O}(Nr);nr("PlacedSymbolArray",Ue);var $e=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Y={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return Y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Y.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},Y.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},Y.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},Y.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},Y.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},Y.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},Y.key.get=function(){return this._structArray.uint16[this._pos2+8]},Y.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Y.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},Y.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},Y.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},Y.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},Y.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},Y.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},Y.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},Y.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},Y.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},Y.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},Y.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},Y.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},Y.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},Y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},Y.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+12]=ie},Y.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},Y.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},Y.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},Y.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,Y),O}(Cs);$e.prototype.size=68;var it=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Y){return new $e(this,Y)},O}(ii);nr("SymbolInstanceArray",it);var _t=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getoffsetX=function(Y){return this.float32[1*Y+0]},O}(le);nr("GlyphOffsetArray",_t);var Ct=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getx=function(Y){return this.int16[3*Y+0]},O.prototype.gety=function(Y){return this.int16[3*Y+1]},O.prototype.gettileUnitDistanceFromAnchor=function(Y){return this.int16[3*Y+2]},O}(E);nr("SymbolLineVertexArray",Ct);var At=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Y={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return Y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},Y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,Y),O}(Cs);At.prototype.size=8;var Et=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Y){return new At(this,Y)},O}(I);nr("FeatureIndexArray",Et);var Tt=da([{name:"a_pos",components:2,type:"Int16"}],4).members,jt=function(A){void 0===A&&(A=[]),this.segments=A};function Nt(A,O){return 256*(A=f(Math.floor(A),0,255))+f(Math.floor(O),0,255)}jt.prototype.prepareSegment=function(A,O,Y,ie){var me=this.segments[this.segments.length-1];return A>jt.MAX_VERTEX_ARRAY_LENGTH&&M("Max vertices per segment is "+jt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+A),(!me||me.vertexLength+A>jt.MAX_VERTEX_ARRAY_LENGTH||me.sortKey!==ie)&&(me={vertexOffset:O.length,primitiveOffset:Y.length,vertexLength:0,primitiveLength:0},void 0!==ie&&(me.sortKey=ie),this.segments.push(me)),me},jt.prototype.get=function(){return this.segments},jt.prototype.destroy=function(){for(var A=0,O=this.segments;A<O.length;A+=1){var Y=O[A];for(var ie in Y.vaos)Y.vaos[ie].destroy()}},jt.simpleSegment=function(A,O,Y,ie){return new jt([{vertexOffset:A,primitiveOffset:O,vertexLength:Y,primitiveLength:ie,vaos:{},sortKey:0}])},jt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nr("SegmentVector",jt);var Yt=da([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),ln=r(function(A){A.exports=function(O,Y){var ie,me,we,ze,Ve,nt,ht,xt;for(me=O.length-(ie=3&O.length),we=Y,Ve=3432918353,nt=461845907,xt=0;xt<me;)ht=255&O.charCodeAt(xt)|(255&O.charCodeAt(++xt))<<8|(255&O.charCodeAt(++xt))<<16|(255&O.charCodeAt(++xt))<<24,++xt,we=27492+(65535&(ze=5*(65535&(we=(we^=ht=(65535&(ht=(ht=(65535&ht)*Ve+(((ht>>>16)*Ve&65535)<<16)&4294967295)<<15|ht>>>17))*nt+(((ht>>>16)*nt&65535)<<16)&4294967295)<<13|we>>>19))+((5*(we>>>16)&65535)<<16)&4294967295))+((58964+(ze>>>16)&65535)<<16);switch(ht=0,ie){case 3:ht^=(255&O.charCodeAt(xt+2))<<16;case 2:ht^=(255&O.charCodeAt(xt+1))<<8;case 1:we^=ht=(65535&(ht=(ht=(65535&(ht^=255&O.charCodeAt(xt)))*Ve+(((ht>>>16)*Ve&65535)<<16)&4294967295)<<15|ht>>>17))*nt+(((ht>>>16)*nt&65535)<<16)&4294967295}return we^=O.length,we=2246822507*(65535&(we^=we>>>16))+((2246822507*(we>>>16)&65535)<<16)&4294967295,we=3266489909*(65535&(we^=we>>>13))+((3266489909*(we>>>16)&65535)<<16)&4294967295,(we^=we>>>16)>>>0}}),bn=r(function(A){A.exports=function(O,Y){for(var ie,me=O.length,we=Y^me,ze=0;me>=4;)ie=1540483477*(65535&(ie=255&O.charCodeAt(ze)|(255&O.charCodeAt(++ze))<<8|(255&O.charCodeAt(++ze))<<16|(255&O.charCodeAt(++ze))<<24))+((1540483477*(ie>>>16)&65535)<<16),we=1540483477*(65535&we)+((1540483477*(we>>>16)&65535)<<16)^(ie=1540483477*(65535&(ie^=ie>>>24))+((1540483477*(ie>>>16)&65535)<<16)),me-=4,++ze;switch(me){case 3:we^=(255&O.charCodeAt(ze+2))<<16;case 2:we^=(255&O.charCodeAt(ze+1))<<8;case 1:we=1540483477*(65535&(we^=255&O.charCodeAt(ze)))+((1540483477*(we>>>16)&65535)<<16)}return we=1540483477*(65535&(we^=we>>>13))+((1540483477*(we>>>16)&65535)<<16),(we^=we>>>15)>>>0}}),In=ln,ir=bn;In.murmur3=ln,In.murmur2=ir;var rr=function(){this.ids=[],this.positions=[],this.indexed=!1};rr.prototype.add=function(A,O,Y,ie){this.ids.push(pr(A)),this.positions.push(O,Y,ie)},rr.prototype.getPositions=function(A){for(var O=pr(A),Y=0,ie=this.ids.length-1;Y<ie;){var me=Y+ie>>1;this.ids[me]>=O?ie=me:Y=me+1}for(var we=[];this.ids[Y]===O;)we.push({index:this.positions[3*Y],start:this.positions[3*Y+1],end:this.positions[3*Y+2]}),Y++;return we},rr.serialize=function(A,O){var Y=new Float64Array(A.ids),ie=new Uint32Array(A.positions);return function me(we,ze,Ve,nt){for(;Ve<nt;){for(var ht=we[Ve+nt>>1],xt=Ve-1,Ut=nt+1;;){do{xt++}while(we[xt]<ht);do{Ut--}while(we[Ut]>ht);if(xt>=Ut)break;Qr(we,xt,Ut),Qr(ze,3*xt,3*Ut),Qr(ze,3*xt+1,3*Ut+1),Qr(ze,3*xt+2,3*Ut+2)}Ut-Ve<nt-Ut?(me(we,ze,Ve,Ut),Ve=Ut+1):(me(we,ze,Ut+1,nt),nt=Ut)}}(Y,ie,0,Y.length-1),O&&O.push(Y.buffer,ie.buffer),{ids:Y,positions:ie}},rr.deserialize=function(A){var O=new rr;return O.ids=A.ids,O.positions=A.positions,O.indexed=!0,O};var _r=Math.pow(2,53)-1;function pr(A){var O=+A;return!isNaN(O)&&O<=_r?O:In(String(A))}function Qr(A,O,Y){var ie=A[O];A[O]=A[Y],A[Y]=ie}nr("FeaturePositionMap",rr);var li=function(A,O){this.gl=A.gl,this.location=O},xi=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=0}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){this.current!==Y&&(this.current=Y,this.gl.uniform1i(this.location,Y))},O}(li),Wn=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=0}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){this.current!==Y&&(this.current=Y,this.gl.uniform1f(this.location,Y))},O}(li),Rr=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=[0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]||(this.current=Y,this.gl.uniform2f(this.location,Y[0],Y[1]))},O}(li),oi=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=[0,0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]&&Y[2]===this.current[2]||(this.current=Y,this.gl.uniform3f(this.location,Y[0],Y[1],Y[2]))},O}(li),ti=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=[0,0,0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]&&Y[2]===this.current[2]&&Y[3]===this.current[3]||(this.current=Y,this.gl.uniform4f(this.location,Y[0],Y[1],Y[2],Y[3]))},O}(li),vi=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=nn.transparent}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){Y.r===this.current.r&&Y.g===this.current.g&&Y.b===this.current.b&&Y.a===this.current.a||(this.current=Y,this.gl.uniform4f(this.location,Y.r,Y.g,Y.b,Y.a))},O}(li),ki=new Float32Array(16),ji=function(A){function O(Y,ie){A.call(this,Y,ie),this.current=ki}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Y){if(Y[12]!==this.current[12]||Y[0]!==this.current[0])return this.current=Y,void this.gl.uniformMatrix4fv(this.location,!1,Y);for(var ie=1;ie<16;ie++)if(Y[ie]!==this.current[ie]){this.current=Y,this.gl.uniformMatrix4fv(this.location,!1,Y);break}},O}(li);function ui(A){return[Nt(255*A.r,255*A.g),Nt(255*A.b,255*A.a)]}var Oi=function(A,O,Y){this.value=A,this.uniformNames=O.map(function(ie){return"u_"+ie}),this.type=Y};Oi.prototype.setUniform=function(A,O,Y){A.set(Y.constantOr(this.value))},Oi.prototype.getBinding=function(A,O,Y){return"color"===this.type?new vi(A,O):new Wn(A,O)};var zi=function(A,O){this.uniformNames=O.map(function(Y){return"u_"+Y}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};zi.prototype.setConstantPatternPositions=function(A,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=A.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=A.tlbr},zi.prototype.setUniform=function(A,O,Y,ie){var me="u_pattern_to"===ie?this.patternTo:"u_pattern_from"===ie?this.patternFrom:"u_pixel_ratio_to"===ie?this.pixelRatioTo:"u_pixel_ratio_from"===ie?this.pixelRatioFrom:null;me&&A.set(me)},zi.prototype.getBinding=function(A,O,Y){return"u_pattern"===Y.substr(0,9)?new ti(A,O):new Wn(A,O)};var qi=function(A,O,Y,ie){this.expression=A,this.type=Y,this.maxValue=0,this.paintVertexAttributes=O.map(function(me){return{name:"a_"+me,type:"Float32",components:"color"===Y?2:1,offset:0}}),this.paintVertexArray=new ie};qi.prototype.populatePaintArray=function(A,O,Y,ie,me){var we=this.paintVertexArray.length,ze=this.expression.evaluate(new fa(0),O,{},ie,[],me);this.paintVertexArray.resize(A),this._setPaintValue(we,A,ze)},qi.prototype.updatePaintArray=function(A,O,Y,ie){var me=this.expression.evaluate({zoom:0},Y,ie);this._setPaintValue(A,O,me)},qi.prototype._setPaintValue=function(A,O,Y){if("color"===this.type)for(var ie=ui(Y),me=A;me<O;me++)this.paintVertexArray.emplace(me,ie[0],ie[1]);else{for(var we=A;we<O;we++)this.paintVertexArray.emplace(we,Y);this.maxValue=Math.max(this.maxValue,Math.abs(Y))}},qi.prototype.upload=function(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},qi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ii=function(A,O,Y,ie,me,we){this.expression=A,this.uniformNames=O.map(function(ze){return"u_"+ze+"_t"}),this.type=Y,this.useIntegerZoom=ie,this.zoom=me,this.maxValue=0,this.paintVertexAttributes=O.map(function(ze){return{name:"a_"+ze,type:"Float32",components:"color"===Y?4:2,offset:0}}),this.paintVertexArray=new we};Ii.prototype.populatePaintArray=function(A,O,Y,ie,me){var we=this.expression.evaluate(new fa(this.zoom),O,{},ie,[],me),ze=this.expression.evaluate(new fa(this.zoom+1),O,{},ie,[],me),Ve=this.paintVertexArray.length;this.paintVertexArray.resize(A),this._setPaintValue(Ve,A,we,ze)},Ii.prototype.updatePaintArray=function(A,O,Y,ie){var me=this.expression.evaluate({zoom:this.zoom},Y,ie),we=this.expression.evaluate({zoom:this.zoom+1},Y,ie);this._setPaintValue(A,O,me,we)},Ii.prototype._setPaintValue=function(A,O,Y,ie){if("color"===this.type)for(var me=ui(Y),we=ui(ie),ze=A;ze<O;ze++)this.paintVertexArray.emplace(ze,me[0],me[1],we[0],we[1]);else{for(var Ve=A;Ve<O;Ve++)this.paintVertexArray.emplace(Ve,Y,ie);this.maxValue=Math.max(this.maxValue,Math.abs(Y),Math.abs(ie))}},Ii.prototype.upload=function(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ii.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ii.prototype.setUniform=function(A,O){var Y=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,ie=f(this.expression.interpolationFactor(Y,this.zoom,this.zoom+1),0,1);A.set(ie)},Ii.prototype.getBinding=function(A,O,Y){return new Wn(A,O)};var Hi=function(A,O,Y,ie,me,we){this.expression=A,this.type=O,this.useIntegerZoom=Y,this.zoom=ie,this.layerId=we,this.zoomInPaintVertexArray=new me,this.zoomOutPaintVertexArray=new me};Hi.prototype.populatePaintArray=function(A,O,Y){var ie=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(A),this.zoomOutPaintVertexArray.resize(A),this._setPaintValues(ie,A,O.patterns&&O.patterns[this.layerId],Y)},Hi.prototype.updatePaintArray=function(A,O,Y,ie,me){this._setPaintValues(A,O,Y.patterns&&Y.patterns[this.layerId],me)},Hi.prototype._setPaintValues=function(A,O,Y,ie){if(ie&&Y){var Ve=ie[Y.min],nt=ie[Y.mid],ht=ie[Y.max];if(Ve&&nt&&ht)for(var xt=A;xt<O;xt++)this.zoomInPaintVertexArray.emplace(xt,nt.tl[0],nt.tl[1],nt.br[0],nt.br[1],Ve.tl[0],Ve.tl[1],Ve.br[0],Ve.br[1],nt.pixelRatio,Ve.pixelRatio),this.zoomOutPaintVertexArray.emplace(xt,nt.tl[0],nt.tl[1],nt.br[0],nt.br[1],ht.tl[0],ht.tl[1],ht.br[0],ht.br[1],nt.pixelRatio,ht.pixelRatio)}},Hi.prototype.upload=function(A){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=A.createVertexBuffer(this.zoomInPaintVertexArray,Yt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=A.createVertexBuffer(this.zoomOutPaintVertexArray,Yt.members,this.expression.isStateDependent))},Hi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var na=function(A,O,Y,ie){this.binders={},this.layoutAttributes=ie,this._buffers=[];var me=[];for(var we in A.paint._values)if(Y(we)){var ze=A.paint.get(we);if(ze instanceof Ua&&Yo(ze.property.specification)){var Ve=Ka(we,A.type),nt=ze.value,ht=ze.property.specification.type,xt=ze.property.useIntegerZoom,Ut=ze.property.specification["property-type"],$t="cross-faded"===Ut||"cross-faded-data-driven"===Ut;if("constant"===nt.kind)this.binders[we]=$t?new zi(nt.value,Ve):new Oi(nt.value,Ve,ht),me.push("/u_"+we);else if("source"===nt.kind||$t){var Wt=$a(we,ht,"source");this.binders[we]=$t?new Hi(nt,ht,xt,O,Wt,A.id):new qi(nt,Ve,ht,Wt),me.push("/a_"+we)}else{var fn=$a(we,ht,"composite");this.binders[we]=new Ii(nt,Ve,ht,xt,O,fn),me.push("/z_"+we)}}}this.cacheKey=me.sort().join("")};na.prototype.getMaxValue=function(A){var O=this.binders[A];return O instanceof qi||O instanceof Ii?O.maxValue:0},na.prototype.populatePaintArrays=function(A,O,Y,ie,me){for(var we in this.binders){var ze=this.binders[we];(ze instanceof qi||ze instanceof Ii||ze instanceof Hi)&&ze.populatePaintArray(A,O,Y,ie,me)}},na.prototype.setConstantPatternPositions=function(A,O){for(var Y in this.binders){var ie=this.binders[Y];ie instanceof zi&&ie.setConstantPatternPositions(A,O)}},na.prototype.updatePaintArrays=function(A,O,Y,ie,me){var we=!1;for(var ze in A)for(var Ve=0,nt=O.getPositions(ze);Ve<nt.length;Ve+=1){var ht=nt[Ve],xt=Y.feature(ht.index);for(var Ut in this.binders){var $t=this.binders[Ut];if(($t instanceof qi||$t instanceof Ii||$t instanceof Hi)&&!0===$t.expression.isStateDependent){var Wt=ie.paint.get(Ut);$t.expression=Wt.value,$t.updatePaintArray(ht.start,ht.end,xt,A[ze],me),we=!0}}}return we},na.prototype.defines=function(){var A=[];for(var O in this.binders){var Y=this.binders[O];(Y instanceof Oi||Y instanceof zi)&&A.push.apply(A,Y.uniformNames.map(function(ie){return"#define HAS_UNIFORM_"+ie}))}return A},na.prototype.getPaintVertexBuffers=function(){return this._buffers},na.prototype.getUniforms=function(A,O){var Y=[];for(var ie in this.binders){var me=this.binders[ie];if(me instanceof Oi||me instanceof zi||me instanceof Ii)for(var we=0,ze=me.uniformNames;we<ze.length;we+=1){var Ve=ze[we];if(O[Ve]){var nt=me.getBinding(A,O[Ve],Ve);Y.push({name:Ve,property:ie,binding:nt})}}}return Y},na.prototype.setUniforms=function(A,O,Y,ie){for(var me=0,we=O;me<we.length;me+=1){var ze=we[me],Ve=ze.name,nt=ze.property;this.binders[nt].setUniform(ze.binding,ie,Y.get(nt),Ve)}},na.prototype.updatePaintBuffers=function(A){for(var O in this._buffers=[],this.binders){var Y=this.binders[O];if(A&&Y instanceof Hi){var ie=2===A.fromScale?Y.zoomInPaintVertexBuffer:Y.zoomOutPaintVertexBuffer;ie&&this._buffers.push(ie)}else(Y instanceof qi||Y instanceof Ii)&&Y.paintVertexBuffer&&this._buffers.push(Y.paintVertexBuffer)}},na.prototype.upload=function(A){for(var O in this.binders){var Y=this.binders[O];(Y instanceof qi||Y instanceof Ii||Y instanceof Hi)&&Y.upload(A)}this.updatePaintBuffers()},na.prototype.destroy=function(){for(var A in this.binders){var O=this.binders[A];(O instanceof qi||O instanceof Ii||O instanceof Hi)&&O.destroy()}};var Ca=function(A,O,Y,ie){void 0===ie&&(ie=function(){return!0}),this.programConfigurations={};for(var me=0,we=O;me<we.length;me+=1){var ze=we[me];this.programConfigurations[ze.id]=new na(ze,Y,ie,A)}this.needsUpload=!1,this._featureMap=new rr,this._bufferOffset=0};function Ka(A,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[A]||[A.replace(O+"-","").replace(/-/g,"_")]}function $a(A,O,Y){var me={"line-pattern":{source:_e,composite:_e},"fill-pattern":{source:_e,composite:_e},"fill-extrusion-pattern":{source:_e,composite:_e}}[A];return me&&me[Y]||{color:{source:re,composite:ue},number:{source:le,composite:re}}[O][Y]}Ca.prototype.populatePaintArrays=function(A,O,Y,ie,me,we){for(var ze in this.programConfigurations)this.programConfigurations[ze].populatePaintArrays(A,O,ie,me,we);void 0!==O.id&&this._featureMap.add(O.id,Y,this._bufferOffset,A),this._bufferOffset=A,this.needsUpload=!0},Ca.prototype.updatePaintArrays=function(A,O,Y,ie){for(var me=0,we=Y;me<we.length;me+=1){var ze=we[me];this.needsUpload=this.programConfigurations[ze.id].updatePaintArrays(A,this._featureMap,O,ze,ie)||this.needsUpload}},Ca.prototype.get=function(A){return this.programConfigurations[A]},Ca.prototype.upload=function(A){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(A);this.needsUpload=!1}},Ca.prototype.destroy=function(){for(var A in this.programConfigurations)this.programConfigurations[A].destroy()},nr("ConstantBinder",Oi),nr("CrossFadedConstantBinder",zi),nr("SourceExpressionBinder",qi),nr("CrossFadedCompositeBinder",Hi),nr("CompositeExpressionBinder",Ii),nr("ProgramConfiguration",na,{omit:["_buffers"]}),nr("ProgramConfigurationSet",Ca);var Va=(15,{min:-1*Math.pow(2,14),max:Math.pow(2,14)-1});function Oa(A){for(var O=8192/A.extent,Y=A.loadGeometry(),ie=0;ie<Y.length;ie++)for(var me=Y[ie],we=0;we<me.length;we++){var ze=me[we];ze.x=Math.round(ze.x*O),ze.y=Math.round(ze.y*O),(ze.x<Va.min||ze.x>Va.max||ze.y<Va.min||ze.y>Va.max)&&(M("Geometry exceeds allowed extent, reduce your vector tile buffer size"),ze.x=f(ze.x,Va.min,Va.max),ze.y=f(ze.y,Va.min,Va.max))}return Y}function Io(A,O,Y,ie,me){A.emplaceBack(2*O+(ie+1)/2,2*Y+(me+1)/2)}var po=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new us,this.indexArray=new Or,this.segments=new jt,this.programConfigurations=new Ca(Tt,A.layers,A.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Qo(A,O){for(var Y=0;Y<A.length;Y++)if(vs(O,A[Y]))return!0;for(var ie=0;ie<O.length;ie++)if(vs(A,O[ie]))return!0;return!!$s(A,O)}function Os(A,O,Y){return!!vs(A,O)||!!Do(O,A,Y)}function Us(A,O){if(1===A.length)return ll(O,A[0]);for(var Y=0;Y<O.length;Y++)for(var ie=O[Y],me=0;me<ie.length;me++)if(vs(A,ie[me]))return!0;for(var we=0;we<A.length;we++)if(ll(O,A[we]))return!0;for(var ze=0;ze<O.length;ze++)if($s(A,O[ze]))return!0;return!1}function sl(A,O,Y){if(A.length>1){if($s(A,O))return!0;for(var ie=0;ie<O.length;ie++)if(Do(O[ie],A,Y))return!0}for(var me=0;me<A.length;me++)if(Do(A[me],O,Y))return!0;return!1}function $s(A,O){if(0===A.length||0===O.length)return!1;for(var Y=0;Y<A.length-1;Y++)for(var ie=A[Y],me=A[Y+1],we=0;we<O.length-1;we++)if(el(ie,me,O[we],O[we+1]))return!0;return!1}function el(A,O,Y,ie){return P(A,Y,ie)!==P(O,Y,ie)&&P(A,O,Y)!==P(A,O,ie)}function Do(A,O,Y){var ie=Y*Y;if(1===O.length)return A.distSqr(O[0])<ie;for(var me=1;me<O.length;me++)if(Gs(A,O[me-1],O[me])<ie)return!0;return!1}function Gs(A,O,Y){var ie=O.distSqr(Y);if(0===ie)return A.distSqr(O);var me=((A.x-O.x)*(Y.x-O.x)+(A.y-O.y)*(Y.y-O.y))/ie;return A.distSqr(me<0?O:me>1?Y:Y.sub(O)._mult(me)._add(O))}function ll(A,O){for(var Y,ie,me,we=!1,ze=0;ze<A.length;ze++)for(var Ve=0,nt=(Y=A[ze]).length-1;Ve<Y.length;nt=Ve++)(ie=Y[Ve]).y>O.y!=(me=Y[nt]).y>O.y&&O.x<(me.x-ie.x)*(O.y-ie.y)/(me.y-ie.y)+ie.x&&(we=!we);return we}function vs(A,O){for(var Y=!1,ie=0,me=A.length-1;ie<A.length;me=ie++){var we=A[ie],ze=A[me];we.y>O.y!=ze.y>O.y&&O.x<(ze.x-we.x)*(O.y-we.y)/(ze.y-we.y)+we.x&&(Y=!Y)}return Y}function cl(A,O,Y){var ie=Y[0],me=Y[2];if(A.x<ie.x&&O.x<ie.x||A.x>me.x&&O.x>me.x||A.y<ie.y&&O.y<ie.y||A.y>me.y&&O.y>me.y)return!1;var we=P(A,O,Y[0]);return we!==P(A,O,Y[1])||we!==P(A,O,Y[2])||we!==P(A,O,Y[3])}function qa(A,O,Y){var ie=O.paint.get(A).value;return"constant"===ie.kind?ie.value:Y.programConfigurations.get(O.id).getMaxValue(A)}function Go(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])}function Xo(A,O,Y,ie,me){if(!O[0]&&!O[1])return A;var we=n.convert(O)._mult(me);"viewport"===Y&&we._rotate(-ie);for(var ze=[],Ve=0;Ve<A.length;Ve++)ze.push(A[Ve].sub(we));return ze}po.prototype.populate=function(A,O,Y){var ie=this.layers[0],me=[],we=null;"circle"===ie.type&&(we=ie.layout.get("circle-sort-key"));for(var ze=0,Ve=A;ze<Ve.length;ze+=1){var nt=Ve[ze],ht=nt.feature,xt=nt.id,Ut=nt.index,$t=nt.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,fn={type:ht.type,id:xt,properties:ht.properties,geometry:Wt?Oa(ht):[]};if(this.layers[0]._featureFilter.filter(new fa(this.zoom),fn,Y)){Wt||(fn.geometry=Oa(ht));var An=we?we.evaluate(fn,{},Y):void 0;me.push({id:xt,properties:ht.properties,type:ht.type,sourceLayerIndex:$t,index:Ut,geometry:fn.geometry,patterns:{},sortKey:An})}}we&&me.sort(function(ai,bi){return ai.sortKey-bi.sortKey});for(var Nn=0,Gn=me;Nn<Gn.length;Nn+=1){var Jn=Gn[Nn],kr=Jn.geometry,zr=Jn.index,Kr=Jn.sourceLayerIndex,Wr=A[zr].feature;this.addFeature(Jn,kr,zr,Y),O.featureIndex.insert(Wr,kr,zr,Kr,this.index)}},po.prototype.update=function(A,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Y)},po.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},po.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},po.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Tt),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},po.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},po.prototype.addFeature=function(A,O,Y,ie){for(var me=0,we=O;me<we.length;me+=1)for(var ze=0,Ve=we[me];ze<Ve.length;ze+=1){var nt=Ve[ze],ht=nt.x,xt=nt.y;if(!(ht<0||ht>=8192||xt<0||xt>=8192)){var Ut=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,A.sortKey),$t=Ut.vertexLength;Io(this.layoutVertexArray,ht,xt,-1,-1),Io(this.layoutVertexArray,ht,xt,1,-1),Io(this.layoutVertexArray,ht,xt,1,1),Io(this.layoutVertexArray,ht,xt,-1,1),this.indexArray.emplaceBack($t,$t+1,$t+2),this.indexArray.emplaceBack($t,$t+3,$t+2),Ut.vertexLength+=4,Ut.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Y,{},ie)},nr("CircleBucket",po,{omit:["layers"]});var yl=new Oo({"circle-sort-key":new Li(be.layout_circle["circle-sort-key"])}),Wc={paint:new Oo({"circle-radius":new Li(be.paint_circle["circle-radius"]),"circle-color":new Li(be.paint_circle["circle-color"]),"circle-blur":new Li(be.paint_circle["circle-blur"]),"circle-opacity":new Li(be.paint_circle["circle-opacity"]),"circle-translate":new Ti(be.paint_circle["circle-translate"]),"circle-translate-anchor":new Ti(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ti(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ti(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Li(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Li(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Li(be.paint_circle["circle-stroke-opacity"])}),layout:yl},fs="undefined"!=typeof Float32Array?Float32Array:Array;function Hl(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function ul(A,O,Y){var ie=O[0],me=O[1],we=O[2],ze=O[3],Ve=O[4],nt=O[5],ht=O[6],xt=O[7],Ut=O[8],$t=O[9],Wt=O[10],fn=O[11],An=O[12],Bn=O[13],Nn=O[14],Gn=O[15],Jn=Y[0],tr=Y[1],kr=Y[2],zr=Y[3];return A[0]=Jn*ie+tr*Ve+kr*Ut+zr*An,A[1]=Jn*me+tr*nt+kr*$t+zr*Bn,A[2]=Jn*we+tr*ht+kr*Wt+zr*Nn,A[3]=Jn*ze+tr*xt+kr*fn+zr*Gn,A[4]=(Jn=Y[4])*ie+(tr=Y[5])*Ve+(kr=Y[6])*Ut+(zr=Y[7])*An,A[5]=Jn*me+tr*nt+kr*$t+zr*Bn,A[6]=Jn*we+tr*ht+kr*Wt+zr*Nn,A[7]=Jn*ze+tr*xt+kr*fn+zr*Gn,A[8]=(Jn=Y[8])*ie+(tr=Y[9])*Ve+(kr=Y[10])*Ut+(zr=Y[11])*An,A[9]=Jn*me+tr*nt+kr*$t+zr*Bn,A[10]=Jn*we+tr*ht+kr*Wt+zr*Nn,A[11]=Jn*ze+tr*xt+kr*fn+zr*Gn,A[12]=(Jn=Y[12])*ie+(tr=Y[13])*Ve+(kr=Y[14])*Ut+(zr=Y[15])*An,A[13]=Jn*me+tr*nt+kr*$t+zr*Bn,A[14]=Jn*we+tr*ht+kr*Wt+zr*Nn,A[15]=Jn*ze+tr*xt+kr*fn+zr*Gn,A}Math.hypot||(Math.hypot=function(){for(var A=arguments,O=0,Y=arguments.length;Y--;)O+=A[Y]*A[Y];return Math.sqrt(O)});var Vs,O,Jc=ul;function tl(A,O,Y){var ie=O[0],me=O[1],we=O[2],ze=O[3];return A[0]=Y[0]*ie+Y[4]*me+Y[8]*we+Y[12]*ze,A[1]=Y[1]*ie+Y[5]*me+Y[9]*we+Y[13]*ze,A[2]=Y[2]*ie+Y[6]*me+Y[10]*we+Y[14]*ze,A[3]=Y[3]*ie+Y[7]*me+Y[11]*we+Y[15]*ze,A}Vs=new fs(3),fs!=Float32Array&&(Vs[0]=0,Vs[1]=0,Vs[2]=0),O=new fs(4),fs!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[3]=0);var ch=(function(){var O=new fs(2);fs!=Float32Array&&(O[0]=0,O[1]=0)}(),function(A){function O(Y){A.call(this,Y,Wc)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(Y){return new po(Y)},O.prototype.queryRadius=function(Y){var ie=Y;return qa("circle-radius",this,ie)+qa("circle-stroke-width",this,ie)+Go(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(Y,ie,me,we,ze,Ve,nt,ht){for(var xt=Xo(Y,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Ve.angle,nt),Ut=this.paint.get("circle-radius").evaluate(ie,me)+this.paint.get("circle-stroke-width").evaluate(ie,me),$t="map"===this.paint.get("circle-pitch-alignment"),Wt=$t?xt:function(Kr,Wr){return Kr.map(function(ai){return Du(ai,Wr)})}(xt,ht),fn=$t?Ut*nt:Ut,An=0,Bn=we;An<Bn.length;An+=1)for(var Nn=0,Gn=Bn[An];Nn<Gn.length;Nn+=1){var Jn=Gn[Nn],tr=$t?Jn:Du(Jn,ht),kr=fn,zr=tl([],[Jn.x,Jn.y,0,1],ht);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?kr*=zr[3]/Ve.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(kr*=Ve.cameraToCenterDistance/zr[3]),Os(Wt,tr,kr))return!0}return!1},O}(Zo));function Du(A,O){var Y=tl([],[A.x,A.y,0,1],O);return new n(Y[0]/Y[3],Y[1]/Y[3])}var Ru=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(po);function $c(A,O,Y,ie){var me=O.width,we=O.height;if(ie){if(ie instanceof Uint8ClampedArray)ie=new Uint8Array(ie.buffer);else if(ie.length!==me*we*Y)throw new RangeError("mismatched image size")}else ie=new Uint8Array(me*we*Y);return A.width=me,A.height=we,A.data=ie,A}function Fu(A,O,Y){var ie=O.width,me=O.height;if(ie!==A.width||me!==A.height){var we=$c({},{width:ie,height:me},Y);eu(A,we,{x:0,y:0},{x:0,y:0},{width:Math.min(A.width,ie),height:Math.min(A.height,me)},Y),A.width=ie,A.height=me,A.data=we.data}}function eu(A,O,Y,ie,me,we){if(0===me.width||0===me.height)return O;if(me.width>A.width||me.height>A.height||Y.x>A.width-me.width||Y.y>A.height-me.height)throw new RangeError("out of range source coordinates for image copy");if(me.width>O.width||me.height>O.height||ie.x>O.width-me.width||ie.y>O.height-me.height)throw new RangeError("out of range destination coordinates for image copy");for(var ze=A.data,Ve=O.data,nt=0;nt<me.height;nt++)for(var ht=((Y.y+nt)*A.width+Y.x)*we,xt=((ie.y+nt)*O.width+ie.x)*we,Ut=0;Ut<me.width*we;Ut++)Ve[xt+Ut]=ze[ht+Ut];return O}nr("HeatmapBucket",Ru,{omit:["layers"]});var fl=function(A,O){$c(this,A,1,O)};fl.prototype.resize=function(A){Fu(this,A,1)},fl.prototype.clone=function(){return new fl({width:this.width,height:this.height},new Uint8Array(this.data))},fl.copy=function(A,O,Y,ie,me){eu(A,O,Y,ie,me,1)};var hs=function(A,O){$c(this,A,4,O)};hs.prototype.resize=function(A){Fu(this,A,4)},hs.prototype.replace=function(A,O){O?this.data.set(A):this.data=A instanceof Uint8ClampedArray?new Uint8Array(A.buffer):A},hs.prototype.clone=function(){return new hs({width:this.width,height:this.height},new Uint8Array(this.data))},hs.copy=function(A,O,Y,ie,me){eu(A,O,Y,ie,me,4)},nr("AlphaImage",fl),nr("RGBAImage",hs);var uh={paint:new Oo({"heatmap-radius":new Li(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Li(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ti(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new as(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ti(be.paint_heatmap["heatmap-opacity"])})};function Nu(A,O){for(var Y=new Uint8Array(1024),ie={},me=0,we=0;me<256;me++,we+=4){ie[O]=me/255;var ze=A.evaluate(ie);Y[we+0]=Math.floor(255*ze.r/ze.a),Y[we+1]=Math.floor(255*ze.g/ze.a),Y[we+2]=Math.floor(255*ze.b/ze.a),Y[we+3]=Math.floor(255*ze.a)}return new hs({width:256,height:1},Y)}var fh=function(A){function O(Y){A.call(this,Y,uh),this._updateColorRamp()}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(Y){return new Ru(Y)},O.prototype._handleSpecialPaintPropertyUpdate=function(Y){"heatmap-color"===Y&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){this.colorRamp=Nu(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},O}(Zo),hh={paint:new Oo({"hillshade-illumination-direction":new Ti(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ti(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ti(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ti(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ti(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ti(be.paint_hillshade["hillshade-accent-color"])})},ph=function(A){function O(Y){A.call(this,Y,hh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},O}(Zo),Bu=da([{name:"a_pos",components:2,type:"Int16"}],4).members,tu=hc,dh=hc;function hc(A,O,Y){Y=Y||2;var ie,me,we,ze,Ve,nt,ht,xt=O&&O.length,Ut=xt?O[0]*Y:A.length,$t=ju(A,0,Ut,Y,!0),Wt=[];if(!$t||$t.next===$t.prev)return Wt;if(xt&&($t=function(An,Bn,Nn,Gn){var Jn,tr,Kr,Wr=[];for(Jn=0,tr=Bn.length;Jn<tr;Jn++)(Kr=ju(An,Bn[Jn]*Gn,Jn<tr-1?Bn[Jn+1]*Gn:An.length,Gn,!1))===Kr.next&&(Kr.steiner=!0),Wr.push(wh(Kr));for(Wr.sort(xh),Jn=0;Jn<Wr.length;Jn++)bh(Wr[Jn],Nn),Nn=nl(Nn,Nn.next);return Nn}(A,O,$t,Y)),A.length>80*Y){ie=we=A[0],me=ze=A[1];for(var fn=Y;fn<Ut;fn+=Y)(Ve=A[fn])<ie&&(ie=Ve),(nt=A[fn+1])<me&&(me=nt),Ve>we&&(we=Ve),nt>ze&&(ze=nt);ht=0!==(ht=Math.max(we-ie,ze-me))?1/ht:0}return Yl($t,Wt,Y,ie,me,ht),Wt}function ju(A,O,Y,ie,me){var we,ze;if(me===iu(A,O,Y,ie)>0)for(we=O;we<Y;we+=ie)ze=qu(we,A[we],A[we+1],ze);else for(we=Y-ie;we>=O;we-=ie)ze=qu(we,A[we],A[we+1],ze);return ze&&pc(ze,ze.next)&&(Gl(ze),ze=ze.next),ze}function nl(A,O){if(!A)return A;O||(O=A);var Y,ie=A;do{if(Y=!1,ie.steiner||!pc(ie,ie.next)&&0!==Ao(ie.prev,ie,ie.next))ie=ie.next;else{if(Gl(ie),(ie=O=ie.prev)===ie.next)break;Y=!0}}while(Y||ie!==O);return O}function Yl(A,O,Y,ie,me,we,ze){if(A){!ze&&we&&function(xt,Ut,$t,Wt){var fn=xt;do{null===fn.z&&(fn.z=nu(fn.x,fn.y,Ut,$t,Wt)),fn.prevZ=fn.prev,fn.nextZ=fn.next,fn=fn.next}while(fn!==xt);fn.prevZ.nextZ=null,fn.prevZ=null,function(An){var Bn,Nn,Gn,Jn,tr,kr,zr,Kr,Wr=1;do{for(Nn=An,An=null,tr=null,kr=0;Nn;){for(kr++,Gn=Nn,zr=0,Bn=0;Bn<Wr&&(zr++,Gn=Gn.nextZ);Bn++);for(Kr=Wr;zr>0||Kr>0&&Gn;)0!==zr&&(0===Kr||!Gn||Nn.z<=Gn.z)?(Jn=Nn,Nn=Nn.nextZ,zr--):(Jn=Gn,Gn=Gn.nextZ,Kr--),tr?tr.nextZ=Jn:An=Jn,Jn.prevZ=tr,tr=Jn;Nn=Gn}tr.nextZ=null,Wr*=2}while(kr>1)}(fn)}(A,ie,me,we);for(var Ve,nt,ht=A;A.prev!==A.next;)if(Ve=A.prev,nt=A.next,we?gh(A,ie,me,we):mh(A))O.push(Ve.i/Y),O.push(A.i/Y),O.push(nt.i/Y),Gl(A),A=nt.next,ht=nt.next;else if((A=nt)===ht){ze?1===ze?Yl(A=vh(nl(A),O,Y),O,Y,ie,me,we,2):2===ze&&yh(A,O,Y,ie,me,we):Yl(nl(A),O,Y,ie,me,we,1);break}}}function mh(A){var O=A.prev,Y=A,ie=A.next;if(Ao(O,Y,ie)>=0)return!1;for(var me=A.next.next;me!==A.prev;){if(xl(O.x,O.y,Y.x,Y.y,ie.x,ie.y,me.x,me.y)&&Ao(me.prev,me,me.next)>=0)return!1;me=me.next}return!0}function gh(A,O,Y,ie){var me=A.prev,we=A,ze=A.next;if(Ao(me,we,ze)>=0)return!1;for(var ht=me.x>we.x?me.x>ze.x?me.x:ze.x:we.x>ze.x?we.x:ze.x,xt=me.y>we.y?me.y>ze.y?me.y:ze.y:we.y>ze.y?we.y:ze.y,Ut=nu(me.x<we.x?me.x<ze.x?me.x:ze.x:we.x<ze.x?we.x:ze.x,me.y<we.y?me.y<ze.y?me.y:ze.y:we.y<ze.y?we.y:ze.y,O,Y,ie),$t=nu(ht,xt,O,Y,ie),Wt=A.prevZ,fn=A.nextZ;Wt&&Wt.z>=Ut&&fn&&fn.z<=$t;){if(Wt!==A.prev&&Wt!==A.next&&xl(me.x,me.y,we.x,we.y,ze.x,ze.y,Wt.x,Wt.y)&&Ao(Wt.prev,Wt,Wt.next)>=0||(Wt=Wt.prevZ,fn!==A.prev&&fn!==A.next&&xl(me.x,me.y,we.x,we.y,ze.x,ze.y,fn.x,fn.y)&&Ao(fn.prev,fn,fn.next)>=0))return!1;fn=fn.nextZ}for(;Wt&&Wt.z>=Ut;){if(Wt!==A.prev&&Wt!==A.next&&xl(me.x,me.y,we.x,we.y,ze.x,ze.y,Wt.x,Wt.y)&&Ao(Wt.prev,Wt,Wt.next)>=0)return!1;Wt=Wt.prevZ}for(;fn&&fn.z<=$t;){if(fn!==A.prev&&fn!==A.next&&xl(me.x,me.y,we.x,we.y,ze.x,ze.y,fn.x,fn.y)&&Ao(fn.prev,fn,fn.next)>=0)return!1;fn=fn.nextZ}return!0}function vh(A,O,Y){var ie=A;do{var me=ie.prev,we=ie.next.next;!pc(me,we)&&Uu(me,ie,ie.next,we)&&Zl(me,we)&&Zl(we,me)&&(O.push(me.i/Y),O.push(ie.i/Y),O.push(we.i/Y),Gl(ie),Gl(ie.next),ie=A=we),ie=ie.next}while(ie!==A);return nl(ie)}function yh(A,O,Y,ie,me,we){var ze=A;do{for(var Ve=ze.next.next;Ve!==ze.prev;){if(ze.i!==Ve.i&&Th(ze,Ve)){var nt=Vu(ze,Ve);return ze=nl(ze,ze.next),nt=nl(nt,nt.next),Yl(ze,O,Y,ie,me,we),void Yl(nt,O,Y,ie,me,we)}Ve=Ve.next}ze=ze.next}while(ze!==A)}function xh(A,O){return A.x-O.x}function bh(A,O){if(O=function(ie,me){var we,ze=me,Ve=ie.x,nt=ie.y,ht=-1/0;do{if(nt<=ze.y&&nt>=ze.next.y&&ze.next.y!==ze.y){var xt=ze.x+(nt-ze.y)*(ze.next.x-ze.x)/(ze.next.y-ze.y);if(xt<=Ve&&xt>ht){if(ht=xt,xt===Ve){if(nt===ze.y)return ze;if(nt===ze.next.y)return ze.next}we=ze.x<ze.next.x?ze:ze.next}}ze=ze.next}while(ze!==me);if(!we)return null;if(Ve===ht)return we;var Ut,$t=we,Wt=we.x,fn=we.y,An=1/0;ze=we;do{Ve>=ze.x&&ze.x>=Wt&&Ve!==ze.x&&xl(nt<fn?Ve:ht,nt,Wt,fn,nt<fn?ht:Ve,nt,ze.x,ze.y)&&(Ut=Math.abs(nt-ze.y)/(Ve-ze.x),Zl(ze,ie)&&(Ut<An||Ut===An&&(ze.x>we.x||ze.x===we.x&&_h(we,ze)))&&(we=ze,An=Ut)),ze=ze.next}while(ze!==$t);return we}(A,O)){var Y=Vu(O,A);nl(O,O.next),nl(Y,Y.next)}}function _h(A,O){return Ao(A.prev,A,O.prev)<0&&Ao(O.next,A,A.next)<0}function nu(A,O,Y,ie,me){return(A=1431655765&((A=858993459&((A=252645135&((A=16711935&((A=32767*(A-Y)*me)|A<<8))|A<<4))|A<<2))|A<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-ie)*me)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function wh(A){var O=A,Y=A;do{(O.x<Y.x||O.x===Y.x&&O.y<Y.y)&&(Y=O),O=O.next}while(O!==A);return Y}function xl(A,O,Y,ie,me,we,ze,Ve){return(me-ze)*(O-Ve)-(A-ze)*(we-Ve)>=0&&(A-ze)*(ie-Ve)-(Y-ze)*(O-Ve)>=0&&(Y-ze)*(we-Ve)-(me-ze)*(ie-Ve)>=0}function Th(A,O){return A.next.i!==O.i&&A.prev.i!==O.i&&!function(Y,ie){var me=Y;do{if(me.i!==Y.i&&me.next.i!==Y.i&&me.i!==ie.i&&me.next.i!==ie.i&&Uu(me,me.next,Y,ie))return!0;me=me.next}while(me!==Y);return!1}(A,O)&&(Zl(A,O)&&Zl(O,A)&&function(Y,ie){var me=Y,we=!1,ze=(Y.x+ie.x)/2,Ve=(Y.y+ie.y)/2;do{me.y>Ve!=me.next.y>Ve&&me.next.y!==me.y&&ze<(me.next.x-me.x)*(Ve-me.y)/(me.next.y-me.y)+me.x&&(we=!we),me=me.next}while(me!==Y);return we}(A,O)&&(Ao(A.prev,A,O.prev)||Ao(A,O.prev,O))||pc(A,O)&&Ao(A.prev,A,A.next)>0&&Ao(O.prev,O,O.next)>0)}function Ao(A,O,Y){return(O.y-A.y)*(Y.x-O.x)-(O.x-A.x)*(Y.y-O.y)}function pc(A,O){return A.x===O.x&&A.y===O.y}function Uu(A,O,Y,ie){var me=mc(Ao(A,O,Y)),we=mc(Ao(A,O,ie)),ze=mc(Ao(Y,ie,A)),Ve=mc(Ao(Y,ie,O));return me!==we&&ze!==Ve||!(0!==me||!dc(A,Y,O))||!(0!==we||!dc(A,ie,O))||!(0!==ze||!dc(Y,A,ie))||!(0!==Ve||!dc(Y,O,ie))}function dc(A,O,Y){return O.x<=Math.max(A.x,Y.x)&&O.x>=Math.min(A.x,Y.x)&&O.y<=Math.max(A.y,Y.y)&&O.y>=Math.min(A.y,Y.y)}function mc(A){return A>0?1:A<0?-1:0}function Zl(A,O){return Ao(A.prev,A,A.next)<0?Ao(A,O,A.next)>=0&&Ao(A,A.prev,O)>=0:Ao(A,O,A.prev)<0||Ao(A,A.next,O)<0}function Vu(A,O){var Y=new ru(A.i,A.x,A.y),ie=new ru(O.i,O.x,O.y),me=A.next,we=O.prev;return A.next=O,O.prev=A,Y.next=me,me.prev=Y,ie.next=Y,Y.prev=ie,we.next=ie,ie.prev=we,ie}function qu(A,O,Y,ie){var me=new ru(A,O,Y);return ie?(me.next=ie.next,me.prev=ie,ie.next.prev=me,ie.next=me):(me.prev=me,me.next=me),me}function Gl(A){A.next.prev=A.prev,A.prev.next=A.next,A.prevZ&&(A.prevZ.nextZ=A.nextZ),A.nextZ&&(A.nextZ.prevZ=A.prevZ)}function ru(A,O,Y){this.i=A,this.x=O,this.y=Y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iu(A,O,Y,ie){for(var me=0,we=O,ze=Y-ie;we<Y;we+=ie)me+=(A[ze]-A[we])*(A[we+1]+A[ze+1]),ze=we;return me}function kh(A,O,Y,ie,me){!function we(ze,Ve,nt,ht,xt){for(;ht>nt;){if(ht-nt>600){var Ut=ht-nt+1,$t=Ve-nt+1,Wt=Math.log(Ut),fn=.5*Math.exp(2*Wt/3),An=.5*Math.sqrt(Wt*fn*(Ut-fn)/Ut)*($t-Ut/2<0?-1:1);we(ze,Ve,Math.max(nt,Math.floor(Ve-$t*fn/Ut+An)),Math.min(ht,Math.floor(Ve+(Ut-$t)*fn/Ut+An)),xt)}var Gn=ze[Ve],Jn=nt,tr=ht;for(Xl(ze,nt,Ve),xt(ze[ht],Gn)>0&&Xl(ze,nt,ht);Jn<tr;){for(Xl(ze,Jn,tr),Jn++,tr--;xt(ze[Jn],Gn)<0;)Jn++;for(;xt(ze[tr],Gn)>0;)tr--}0===xt(ze[nt],Gn)?Xl(ze,nt,tr):Xl(ze,++tr,ht),tr<=Ve&&(nt=tr+1),Ve<=tr&&(ht=tr-1)}}(A,O,Y||0,ie||A.length-1,me||Ah)}function Xl(A,O,Y){var ie=A[O];A[O]=A[Y],A[Y]=ie}function Ah(A,O){return A<O?-1:A>O?1:0}function au(A,O){var Y=A.length;if(Y<=1)return[A];for(var ie,me,we=[],ze=0;ze<Y;ze++){var Ve=z(A[ze]);0!==Ve&&(A[ze].area=Math.abs(Ve),void 0===me&&(me=Ve<0),me===Ve<0?(ie&&we.push(ie),ie=[A[ze]]):ie.push(A[ze]))}if(ie&&we.push(ie),O>1)for(var nt=0;nt<we.length;nt++)we[nt].length<=O||(kh(we[nt],O,1,we[nt].length-1,Mh),we[nt]=we[nt].slice(0,O));return we}function Mh(A,O){return O.area-A.area}function ou(A,O,Y){for(var ie=Y.patternDependencies,me=!1,we=0,ze=O;we<ze.length;we+=1){var Ve=ze[we].paint.get(A+"-pattern");Ve.isConstant()||(me=!0);var nt=Ve.constantOr(null);nt&&(me=!0,ie[nt.to]=!0,ie[nt.from]=!0)}return me}function su(A,O,Y,ie,me){for(var we=me.patternDependencies,ze=0,Ve=O;ze<Ve.length;ze+=1){var nt=Ve[ze],ht=nt.paint.get(A+"-pattern").value;if("constant"!==ht.kind){var xt=ht.evaluate({zoom:ie-1},Y,{},me.availableImages),Ut=ht.evaluate({zoom:ie},Y,{},me.availableImages),$t=ht.evaluate({zoom:ie+1},Y,{},me.availableImages);Ut=Ut&&Ut.name?Ut.name:Ut,$t=$t&&$t.name?$t.name:$t,we[xt=xt&&xt.name?xt.name:xt]=!0,we[Ut]=!0,we[$t]=!0,Y.patterns[nt.id]={min:xt,mid:Ut,max:$t}}}return Y}hc.deviation=function(A,O,Y,ie){var me=O&&O.length,ze=Math.abs(iu(A,0,me?O[0]*Y:A.length,Y));if(me)for(var Ve=0,nt=O.length;Ve<nt;Ve++)ze-=Math.abs(iu(A,O[Ve]*Y,Ve<nt-1?O[Ve+1]*Y:A.length,Y));var Ut=0;for(Ve=0;Ve<ie.length;Ve+=3){var $t=ie[Ve]*Y,Wt=ie[Ve+1]*Y,fn=ie[Ve+2]*Y;Ut+=Math.abs((A[$t]-A[fn])*(A[Wt+1]-A[$t+1])-(A[$t]-A[Wt])*(A[fn+1]-A[$t+1]))}return 0===ze&&0===Ut?0:Math.abs((Ut-ze)/ze)},hc.flatten=function(A){for(var O=A[0][0].length,Y={vertices:[],holes:[],dimensions:O},ie=0,me=0;me<A.length;me++){for(var we=0;we<A[me].length;we++)for(var ze=0;ze<O;ze++)Y.vertices.push(A[me][we][ze]);me>0&&Y.holes.push(ie+=A[me-1].length)}return Y},tu.default=dh;var Is=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new us,this.indexArray=new Or,this.indexArray2=new F,this.programConfigurations=new Ca(Bu,A.layers,A.zoom),this.segments=new jt,this.segments2=new jt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};Is.prototype.populate=function(A,O,Y){this.hasPattern=ou("fill",this.layers,O);for(var ie=this.layers[0].layout.get("fill-sort-key"),me=[],we=0,ze=A;we<ze.length;we+=1){var Ve=ze[we],nt=Ve.feature,ht=Ve.id,xt=Ve.index,Ut=Ve.sourceLayerIndex,$t=this.layers[0]._featureFilter.needGeometry,Wt={type:nt.type,id:ht,properties:nt.properties,geometry:$t?Oa(nt):[]};if(this.layers[0]._featureFilter.filter(new fa(this.zoom),Wt,Y)){$t||(Wt.geometry=Oa(nt));var fn=ie?ie.evaluate(Wt,{},Y,O.availableImages):void 0;me.push({id:ht,properties:nt.properties,type:nt.type,sourceLayerIndex:Ut,index:xt,geometry:Wt.geometry,patterns:{},sortKey:fn})}}ie&&me.sort(function(ai,bi){return ai.sortKey-bi.sortKey});for(var Bn=0,Nn=me;Bn<Nn.length;Bn+=1){var Gn=Nn[Bn],tr=Gn.geometry,kr=Gn.index,zr=Gn.sourceLayerIndex;if(this.hasPattern){var Kr=su("fill",this.layers,Gn,this.zoom,O);this.patternFeatures.push(Kr)}else this.addFeature(Gn,tr,kr,Y,{});O.featureIndex.insert(A[kr].feature,tr,kr,zr,this.index)}},Is.prototype.update=function(A,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Y)},Is.prototype.addFeatures=function(A,O,Y){for(var ie=0,me=this.patternFeatures;ie<me.length;ie+=1){var we=me[ie];this.addFeature(we,we.geometry,we.index,O,Y)}},Is.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Is.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Is.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Bu),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.indexBuffer2=A.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(A),this.uploaded=!0},Is.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Is.prototype.addFeature=function(A,O,Y,ie,me){for(var we=0,ze=au(O,500);we<ze.length;we+=1){for(var Ve=ze[we],nt=0,ht=0,xt=Ve;ht<xt.length;ht+=1)nt+=xt[ht].length;for(var Ut=this.segments.prepareSegment(nt,this.layoutVertexArray,this.indexArray),$t=Ut.vertexLength,Wt=[],fn=[],An=0,Bn=Ve;An<Bn.length;An+=1){var Nn=Bn[An];if(0!==Nn.length){Nn!==Ve[0]&&fn.push(Wt.length/2);var Gn=this.segments2.prepareSegment(Nn.length,this.layoutVertexArray,this.indexArray2),Jn=Gn.vertexLength;this.layoutVertexArray.emplaceBack(Nn[0].x,Nn[0].y),this.indexArray2.emplaceBack(Jn+Nn.length-1,Jn),Wt.push(Nn[0].x),Wt.push(Nn[0].y);for(var tr=1;tr<Nn.length;tr++)this.layoutVertexArray.emplaceBack(Nn[tr].x,Nn[tr].y),this.indexArray2.emplaceBack(Jn+tr-1,Jn+tr),Wt.push(Nn[tr].x),Wt.push(Nn[tr].y);Gn.vertexLength+=Nn.length,Gn.primitiveLength+=Nn.length}}for(var kr=tu(Wt,fn),zr=0;zr<kr.length;zr+=3)this.indexArray.emplaceBack($t+kr[zr],$t+kr[zr+1],$t+kr[zr+2]);Ut.vertexLength+=nt,Ut.primitiveLength+=kr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Y,me,ie)},nr("FillBucket",Is,{omit:["layers","patternFeatures"]});var Sh=new Oo({"fill-sort-key":new Li(be.layout_fill["fill-sort-key"])}),Ch={paint:new Oo({"fill-antialias":new Ti(be.paint_fill["fill-antialias"]),"fill-opacity":new Li(be.paint_fill["fill-opacity"]),"fill-color":new Li(be.paint_fill["fill-color"]),"fill-outline-color":new Li(be.paint_fill["fill-outline-color"]),"fill-translate":new Ti(be.paint_fill["fill-translate"]),"fill-translate-anchor":new Ti(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new zs(be.paint_fill["fill-pattern"])}),layout:Sh},Eh=function(A){function O(Y){A.call(this,Y,Ch)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.recalculate=function(Y,ie){A.prototype.recalculate.call(this,Y,ie);var me=this.paint._values["fill-outline-color"];"constant"===me.value.kind&&void 0===me.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(Y){return new Is(Y)},O.prototype.queryRadius=function(){return Go(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(Y,ie,me,we,ze,Ve,nt){return Us(Xo(Y,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Ve.angle,nt),we)},O.prototype.isTileClipped=function(){return!0},O}(Zo),Hu=da([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Yu=bl;function bl(A,O,Y,ie,me){this.properties={},this.extent=Y,this.type=0,this._pbf=A,this._geometry=-1,this._keys=ie,this._values=me,A.readFields(Lh,this,O)}function Lh(A,O,Y){1==A?O.id=Y.readVarint():2==A?function(ie,me){for(var we=ie.readVarint()+ie.pos;ie.pos<we;){var ze=me._keys[ie.readVarint()],Ve=me._values[ie.readVarint()];me.properties[ze]=Ve}}(Y,O):3==A?O.type=Y.readVarint():4==A&&(O._geometry=Y.pos)}function zh(A){for(var O,Y,ie=0,me=0,we=A.length,ze=we-1;me<we;ze=me++)ie+=((Y=A[ze]).x-(O=A[me]).x)*(O.y+Y.y);return ie}bl.types=["Unknown","Point","LineString","Polygon"],bl.prototype.loadGeometry=function(){var A=this._pbf;A.pos=this._geometry;for(var O,Y=A.readVarint()+A.pos,ie=1,me=0,we=0,ze=0,Ve=[];A.pos<Y;){if(me<=0){var nt=A.readVarint();ie=7&nt,me=nt>>3}if(me--,1===ie||2===ie)we+=A.readSVarint(),ze+=A.readSVarint(),1===ie&&(O&&Ve.push(O),O=[]),O.push(new n(we,ze));else{if(7!==ie)throw new Error("unknown command "+ie);O&&O.push(O[0].clone())}}return O&&Ve.push(O),Ve},bl.prototype.bbox=function(){var A=this._pbf;A.pos=this._geometry;for(var O=A.readVarint()+A.pos,Y=1,ie=0,me=0,we=0,ze=1/0,Ve=-1/0,nt=1/0,ht=-1/0;A.pos<O;){if(ie<=0){var xt=A.readVarint();Y=7&xt,ie=xt>>3}if(ie--,1===Y||2===Y)(me+=A.readSVarint())<ze&&(ze=me),me>Ve&&(Ve=me),(we+=A.readSVarint())<nt&&(nt=we),we>ht&&(ht=we);else if(7!==Y)throw new Error("unknown command "+Y)}return[ze,nt,Ve,ht]},bl.prototype.toGeoJSON=function(A,O,Y){var ie,me,we=this.extent*Math.pow(2,Y),ze=this.extent*A,Ve=this.extent*O,nt=this.loadGeometry(),ht=bl.types[this.type];function xt(Wt){for(var fn=0;fn<Wt.length;fn++){var An=Wt[fn];Wt[fn]=[360*(An.x+ze)/we-180,360/Math.PI*Math.atan(Math.exp((180-360*(An.y+Ve)/we)*Math.PI/180))-90]}}switch(this.type){case 1:var Ut=[];for(ie=0;ie<nt.length;ie++)Ut[ie]=nt[ie][0];xt(nt=Ut);break;case 2:for(ie=0;ie<nt.length;ie++)xt(nt[ie]);break;case 3:for(nt=function(Wt){var fn=Wt.length;if(fn<=1)return[Wt];for(var An,Bn,Nn=[],Gn=0;Gn<fn;Gn++){var Jn=zh(Wt[Gn]);0!==Jn&&(void 0===Bn&&(Bn=Jn<0),Bn===Jn<0?(An&&Nn.push(An),An=[Wt[Gn]]):An.push(Wt[Gn]))}return An&&Nn.push(An),Nn}(nt),ie=0;ie<nt.length;ie++)for(me=0;me<nt[ie].length;me++)xt(nt[ie][me])}1===nt.length?nt=nt[0]:ht="Multi"+ht;var $t={type:"Feature",geometry:{type:ht,coordinates:nt},properties:this.properties};return"id"in this&&($t.id=this.id),$t};var Zu=Gu;function Gu(A,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=A,this._keys=[],this._values=[],this._features=[],A.readFields(Ph,this,O),this.length=this._features.length}function Ph(A,O,Y){15===A?O.version=Y.readVarint():1===A?O.name=Y.readString():5===A?O.extent=Y.readVarint():2===A?O._features.push(Y.pos):3===A?O._keys.push(Y.readString()):4===A&&O._values.push(function(ie){for(var me=null,we=ie.readVarint()+ie.pos;ie.pos<we;){var ze=ie.readVarint()>>3;me=1===ze?ie.readString():2===ze?ie.readFloat():3===ze?ie.readDouble():4===ze?ie.readVarint64():5===ze?ie.readVarint():6===ze?ie.readSVarint():7===ze?ie.readBoolean():null}return me}(Y))}function Oh(A,O,Y){if(3===A){var ie=new Zu(Y,Y.readVarint()+Y.pos);ie.length&&(O[ie.name]=ie)}}Gu.prototype.feature=function(A){if(A<0||A>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[A];var O=this._pbf.readVarint()+this._pbf.pos;return new Yu(this._pbf,O,this.extent,this._keys,this._values)};var _l={VectorTile:function(A,O){this.layers=A.readFields(Oh,{},O)},VectorTileFeature:Yu,VectorTileLayer:Zu},Ih=_l.VectorTileFeature.types,lu=Math.pow(2,13);function Wl(A,O,Y,ie,me,we,ze,Ve){A.emplaceBack(O,Y,2*Math.floor(ie*lu)+ze,me*lu*2,we*lu*2,Math.round(Ve))}var Ds=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new Je,this.indexArray=new Or,this.programConfigurations=new Ca(Hu,A.layers,A.zoom),this.segments=new jt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Dh(A,O){return A.x===O.x&&(A.x<0||A.x>8192)||A.y===O.y&&(A.y<0||A.y>8192)}function Rh(A){return A.every(function(O){return O.x<0})||A.every(function(O){return O.x>8192})||A.every(function(O){return O.y<0})||A.every(function(O){return O.y>8192})}Ds.prototype.populate=function(A,O,Y){this.features=[],this.hasPattern=ou("fill-extrusion",this.layers,O);for(var ie=0,me=A;ie<me.length;ie+=1){var we=me[ie],ze=we.feature,Ve=we.id,nt=we.index,ht=we.sourceLayerIndex,xt=this.layers[0]._featureFilter.needGeometry,Ut={type:ze.type,id:Ve,properties:ze.properties,geometry:xt?Oa(ze):[]};if(this.layers[0]._featureFilter.filter(new fa(this.zoom),Ut,Y)){var $t={id:Ve,sourceLayerIndex:ht,index:nt,geometry:xt?Ut.geometry:Oa(ze),properties:ze.properties,type:ze.type,patterns:{}};void 0!==ze.id&&($t.id=ze.id),this.hasPattern?this.features.push(su("fill-extrusion",this.layers,$t,this.zoom,O)):this.addFeature($t,$t.geometry,nt,Y,{}),O.featureIndex.insert(ze,$t.geometry,nt,ht,this.index,!0)}}},Ds.prototype.addFeatures=function(A,O,Y){for(var ie=0,me=this.features;ie<me.length;ie+=1){var we=me[ie];this.addFeature(we,we.geometry,we.index,O,Y)}},Ds.prototype.update=function(A,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Y)},Ds.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ds.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ds.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Hu),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},Ds.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ds.prototype.addFeature=function(A,O,Y,ie,me){for(var we=0,ze=au(O,500);we<ze.length;we+=1){for(var Ve=ze[we],nt=0,ht=0,xt=Ve;ht<xt.length;ht+=1)nt+=xt[ht].length;for(var Ut=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),$t=0,Wt=Ve;$t<Wt.length;$t+=1){var fn=Wt[$t];if(0!==fn.length&&!Rh(fn))for(var An=0,Bn=0;Bn<fn.length;Bn++){var Nn=fn[Bn];if(Bn>=1){var Gn=fn[Bn-1];if(!Dh(Nn,Gn)){Ut.vertexLength+4>jt.MAX_VERTEX_ARRAY_LENGTH&&(Ut=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Jn=Nn.sub(Gn)._perp()._unit(),tr=Gn.dist(Nn);An+tr>32768&&(An=0),Wl(this.layoutVertexArray,Nn.x,Nn.y,Jn.x,Jn.y,0,0,An),Wl(this.layoutVertexArray,Nn.x,Nn.y,Jn.x,Jn.y,0,1,An),Wl(this.layoutVertexArray,Gn.x,Gn.y,Jn.x,Jn.y,0,0,An+=tr),Wl(this.layoutVertexArray,Gn.x,Gn.y,Jn.x,Jn.y,0,1,An);var kr=Ut.vertexLength;this.indexArray.emplaceBack(kr,kr+2,kr+1),this.indexArray.emplaceBack(kr+1,kr+2,kr+3),Ut.vertexLength+=4,Ut.primitiveLength+=2}}}}if(Ut.vertexLength+nt>jt.MAX_VERTEX_ARRAY_LENGTH&&(Ut=this.segments.prepareSegment(nt,this.layoutVertexArray,this.indexArray)),"Polygon"===Ih[A.type]){for(var zr=[],Kr=[],Wr=Ut.vertexLength,ai=0,bi=Ve;ai<bi.length;ai+=1){var _i=bi[ai];if(0!==_i.length){_i!==Ve[0]&&Kr.push(zr.length/2);for(var hi=0;hi<_i.length;hi++){var Ci=_i[hi];Wl(this.layoutVertexArray,Ci.x,Ci.y,0,0,1,1,0),zr.push(Ci.x),zr.push(Ci.y)}}}for(var Ai=tu(zr,Kr),wi=0;wi<Ai.length;wi+=3)this.indexArray.emplaceBack(Wr+Ai[wi],Wr+Ai[wi+2],Wr+Ai[wi+1]);Ut.primitiveLength+=Ai.length/3,Ut.vertexLength+=nt}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Y,me,ie)},nr("FillExtrusionBucket",Ds,{omit:["layers","features"]});var Fh={paint:new Oo({"fill-extrusion-opacity":new Ti(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Li(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ti(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ti(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zs(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Li(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Li(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ti(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Nh=function(A){function O(Y){A.call(this,Y,Fh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(Y){return new Ds(Y)},O.prototype.queryRadius=function(){return Go(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(Y,ie,me,we,ze,Ve,nt,ht){var xt=Xo(Y,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Ve.angle,nt),Ut=this.paint.get("fill-extrusion-height").evaluate(ie,me),$t=this.paint.get("fill-extrusion-base").evaluate(ie,me),Wt=function(An,Bn,Nn,Gn){for(var Jn=[],tr=0,kr=An;tr<kr.length;tr+=1){var zr=kr[tr],Kr=[zr.x,zr.y,0,1];tl(Kr,Kr,Bn),Jn.push(new n(Kr[0]/Kr[3],Kr[1]/Kr[3]))}return Jn}(xt,ht),fn=function(An,Bn,Nn,Gn){for(var Jn=[],tr=[],kr=Gn[8]*Bn,zr=Gn[9]*Bn,Kr=Gn[10]*Bn,Wr=Gn[11]*Bn,ai=Gn[8]*Nn,bi=Gn[9]*Nn,_i=Gn[10]*Nn,hi=Gn[11]*Nn,Ci=0,Ai=An;Ci<Ai.length;Ci+=1){for(var ha=[],la=[],ya=0,Di=Ai[Ci];ya<Di.length;ya+=1){var ca=Di[ya],Da=ca.x,Ea=ca.y,Ya=Gn[0]*Da+Gn[4]*Ea+Gn[12],La=Gn[1]*Da+Gn[5]*Ea+Gn[13],Co=Gn[2]*Da+Gn[6]*Ea+Gn[14],Za=Gn[3]*Da+Gn[7]*Ea+Gn[15],Wo=Co+Kr,Fo=Za+Wr,Uo=Ya+ai,os=La+bi,$o=Co+_i,Eo=Za+hi,Vo=new n((Ya+kr)/Fo,(La+zr)/Fo);Vo.z=Wo/Fo,ha.push(Vo);var bo=new n(Uo/Eo,os/Eo);bo.z=$o/Eo,la.push(bo)}Jn.push(ha),tr.push(la)}return[Jn,tr]}(we,$t,Ut,ht);return function(An,Bn,Nn){var Gn=1/0;Us(Nn,Bn)&&(Gn=Xu(Nn,Bn[0]));for(var Jn=0;Jn<Bn.length;Jn++)for(var tr=Bn[Jn],kr=An[Jn],zr=0;zr<tr.length-1;zr++){var Kr=tr[zr],_i=[Kr,tr[zr+1],kr[zr+1],kr[zr],Kr];Qo(Nn,_i)&&(Gn=Math.min(Gn,Xu(Nn,_i)))}return Gn!==1/0&&Gn}(fn[0],fn[1],Wt)},O}(Zo);function Jl(A,O){return A.x*O.x+A.y*O.y}function Xu(A,O){if(1===A.length){for(var Y,ie=0,me=O[ie++];!Y||me.equals(Y);)if(!(Y=O[ie++]))return 1/0;for(;ie<O.length;ie++){var we=O[ie],ze=A[0],Ve=Y.sub(me),nt=we.sub(me),ht=ze.sub(me),xt=Jl(Ve,Ve),Ut=Jl(Ve,nt),$t=Jl(nt,nt),Wt=Jl(ht,Ve),fn=Jl(ht,nt),An=xt*$t-Ut*Ut,Bn=($t*Wt-Ut*fn)/An,Nn=(xt*fn-Ut*Wt)/An,Jn=me.z*(1-Bn-Nn)+Y.z*Bn+we.z*Nn;if(isFinite(Jn))return Jn}return 1/0}for(var tr=1/0,kr=0,zr=O;kr<zr.length;kr+=1)tr=Math.min(tr,zr[kr].z);return tr}var Wu=da([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Bh=_l.VectorTileFeature.types,jh=Math.cos(Math.PI/180*37.5),Ju=Math.pow(2,14)/.5,ps=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dt,this.indexArray=new Or,this.programConfigurations=new Ca(Wu,A.layers,A.zoom),this.segments=new jt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};ps.prototype.populate=function(A,O,Y){this.hasPattern=ou("line",this.layers,O);for(var ie=this.layers[0].layout.get("line-sort-key"),me=[],we=0,ze=A;we<ze.length;we+=1){var Ve=ze[we],nt=Ve.feature,ht=Ve.id,xt=Ve.index,Ut=Ve.sourceLayerIndex,$t=this.layers[0]._featureFilter.needGeometry,Wt={type:nt.type,id:ht,properties:nt.properties,geometry:$t?Oa(nt):[]};if(this.layers[0]._featureFilter.filter(new fa(this.zoom),Wt,Y)){$t||(Wt.geometry=Oa(nt));var fn=ie?ie.evaluate(Wt,{},Y):void 0;me.push({id:ht,properties:nt.properties,type:nt.type,sourceLayerIndex:Ut,index:xt,geometry:Wt.geometry,patterns:{},sortKey:fn})}}ie&&me.sort(function(ai,bi){return ai.sortKey-bi.sortKey});for(var Bn=0,Nn=me;Bn<Nn.length;Bn+=1){var Gn=Nn[Bn],tr=Gn.geometry,kr=Gn.index,zr=Gn.sourceLayerIndex;if(this.hasPattern){var Kr=su("line",this.layers,Gn,this.zoom,O);this.patternFeatures.push(Kr)}else this.addFeature(Gn,tr,kr,Y,{});O.featureIndex.insert(A[kr].feature,tr,kr,zr,this.index)}},ps.prototype.update=function(A,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Y)},ps.prototype.addFeatures=function(A,O,Y){for(var ie=0,me=this.patternFeatures;ie<me.length;ie+=1){var we=me[ie];this.addFeature(we,we.geometry,we.index,O,Y)}},ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ps.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Wu),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ps.prototype.addFeature=function(A,O,Y,ie,me){for(var we=this.layers[0].layout,ze=we.get("line-join").evaluate(A,{}),Ve=we.get("line-cap"),nt=we.get("line-miter-limit"),ht=we.get("line-round-limit"),xt=0,Ut=O;xt<Ut.length;xt+=1)this.addLine(Ut[xt],A,ze,Ve,nt,ht);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Y,me,ie)},ps.prototype.addLine=function(A,O,Y,ie,me,we){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var ze=0;ze<A.length-1;ze++)this.totalDistance+=A[ze].dist(A[ze+1]);this.updateScaledDistance()}for(var Ve="Polygon"===Bh[O.type],nt=A.length;nt>=2&&A[nt-1].equals(A[nt-2]);)nt--;for(var ht=0;ht<nt-1&&A[ht].equals(A[ht+1]);)ht++;if(!(nt<(Ve?3:2))){"bevel"===Y&&(me=1.05);var xt,Ut=this.overscaling<=16?122880/(512*this.overscaling):0,$t=this.segments.prepareSegment(10*nt,this.layoutVertexArray,this.indexArray),Wt=void 0,fn=void 0,An=void 0,Bn=void 0;this.e1=this.e2=-1,Ve&&(Bn=A[ht].sub(xt=A[nt-2])._unit()._perp());for(var Nn=ht;Nn<nt;Nn++)if(!(fn=Nn===nt-1?Ve?A[ht+1]:void 0:A[Nn+1])||!A[Nn].equals(fn)){Bn&&(An=Bn),xt&&(Wt=xt),xt=A[Nn],Bn=fn?fn.sub(xt)._unit()._perp():An;var Gn=(An=An||Bn).add(Bn);0===Gn.x&&0===Gn.y||Gn._unit();var Jn=An.x*Bn.x+An.y*Bn.y,tr=Gn.x*Bn.x+Gn.y*Bn.y,kr=0!==tr?1/tr:1/0,zr=2*Math.sqrt(2-2*tr),Kr=tr<jh&&Wt&&fn,Wr=An.x*Bn.y-An.y*Bn.x>0;if(Kr&&Nn>ht){var ai=xt.dist(Wt);if(ai>2*Ut){var bi=xt.sub(xt.sub(Wt)._mult(Ut/ai)._round());this.updateDistance(Wt,bi),this.addCurrentVertex(bi,An,0,0,$t),Wt=bi}}var _i=Wt&&fn,hi=_i?Y:Ve?"butt":ie;if(_i&&"round"===hi&&(kr<we?hi="miter":kr<=2&&(hi="fakeround")),"miter"===hi&&kr>me&&(hi="bevel"),"bevel"===hi&&(kr>2&&(hi="flipbevel"),kr<me&&(hi="miter")),Wt&&this.updateDistance(Wt,xt),"miter"===hi)Gn._mult(kr),this.addCurrentVertex(xt,Gn,0,0,$t);else if("flipbevel"===hi){if(kr>100)Gn=Bn.mult(-1);else{var Ci=kr*An.add(Bn).mag()/An.sub(Bn).mag();Gn._perp()._mult(Ci*(Wr?-1:1))}this.addCurrentVertex(xt,Gn,0,0,$t),this.addCurrentVertex(xt,Gn.mult(-1),0,0,$t)}else if("bevel"===hi||"fakeround"===hi){var Ai=-Math.sqrt(kr*kr-1),wi=Wr?Ai:0,ha=Wr?0:Ai;if(Wt&&this.addCurrentVertex(xt,An,wi,ha,$t),"fakeround"===hi)for(var la=Math.round(180*zr/Math.PI/20),ya=1;ya<la;ya++){var Di=ya/la;if(.5!==Di){var ca=Di-.5;Di+=Di*ca*(Di-1)*((1.0904+Jn*(Jn*(3.55645-1.43519*Jn)-3.2452))*ca*ca+(.848013+Jn*(.215638*Jn-1.06021)))}var Da=Bn.sub(An)._mult(Di)._add(An)._unit()._mult(Wr?-1:1);this.addHalfVertex(xt,Da.x,Da.y,!1,Wr,0,$t)}fn&&this.addCurrentVertex(xt,Bn,-wi,-ha,$t)}else if("butt"===hi)this.addCurrentVertex(xt,Gn,0,0,$t);else if("square"===hi){var Ea=Wt?1:-1;this.addCurrentVertex(xt,Gn,Ea,Ea,$t)}else"round"===hi&&(Wt&&(this.addCurrentVertex(xt,An,0,0,$t),this.addCurrentVertex(xt,An,1,1,$t,!0)),fn&&(this.addCurrentVertex(xt,Bn,-1,-1,$t,!0),this.addCurrentVertex(xt,Bn,0,0,$t)));if(Kr&&Nn<nt-1){var Ya=xt.dist(fn);if(Ya>2*Ut){var La=xt.add(fn.sub(xt)._mult(Ut/Ya)._round());this.updateDistance(xt,La),this.addCurrentVertex(La,Bn,0,0,$t),xt=La}}}}},ps.prototype.addCurrentVertex=function(A,O,Y,ie,me,we){void 0===we&&(we=!1);var nt=O.y*ie-O.x,ht=-O.y-O.x*ie;this.addHalfVertex(A,O.x+O.y*Y,O.y-O.x*Y,we,!1,Y,me),this.addHalfVertex(A,nt,ht,we,!0,-ie,me),this.distance>Ju/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(A,O,Y,ie,me,we))},ps.prototype.addHalfVertex=function(A,O,Y,ie,me,we,ze){var ht=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((A.x<<1)+(ie?1:0),(A.y<<1)+(me?1:0),Math.round(63*O)+128,Math.round(63*Y)+128,1+(0===we?0:we<0?-1:1)|(63&ht)<<2,ht>>6);var xt=ze.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,xt),ze.primitiveLength++),me?this.e2=xt:this.e1=xt},ps.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ju-1):this.distance},ps.prototype.updateDistance=function(A,O){this.distance+=A.dist(O),this.updateScaledDistance()},nr("LineBucket",ps,{omit:["layers","patternFeatures"]});var Uh=new Oo({"line-cap":new Ti(be.layout_line["line-cap"]),"line-join":new Li(be.layout_line["line-join"]),"line-miter-limit":new Ti(be.layout_line["line-miter-limit"]),"line-round-limit":new Ti(be.layout_line["line-round-limit"]),"line-sort-key":new Li(be.layout_line["line-sort-key"])}),Qu={paint:new Oo({"line-opacity":new Li(be.paint_line["line-opacity"]),"line-color":new Li(be.paint_line["line-color"]),"line-translate":new Ti(be.paint_line["line-translate"]),"line-translate-anchor":new Ti(be.paint_line["line-translate-anchor"]),"line-width":new Li(be.paint_line["line-width"]),"line-gap-width":new Li(be.paint_line["line-gap-width"]),"line-offset":new Li(be.paint_line["line-offset"]),"line-blur":new Li(be.paint_line["line-blur"]),"line-dasharray":new Ps(be.paint_line["line-dasharray"]),"line-pattern":new zs(be.paint_line["line-pattern"]),"line-gradient":new as(be.paint_line["line-gradient"])}),layout:Uh},Ku=new(function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.possiblyEvaluate=function(Y,ie){return ie=new fa(Math.floor(ie.zoom),{now:ie.now,fadeDuration:ie.fadeDuration,zoomHistory:ie.zoomHistory,transition:ie.transition}),A.prototype.possiblyEvaluate.call(this,Y,ie)},O.prototype.evaluate=function(Y,ie,me,we){return ie=o({},ie,{zoom:Math.floor(ie.zoom)}),A.prototype.evaluate.call(this,Y,ie,me,we)},O}(Li))(Qu.paint.properties["line-width"].specification);Ku.useIntegerZoom=!0;var Vh=function(A){function O(Y){A.call(this,Y,Qu)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(Y){"line-gradient"===Y&&this._updateGradient()},O.prototype._updateGradient=function(){this.gradient=Nu(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(Y,ie){A.prototype.recalculate.call(this,Y,ie),this.paint._values["line-floorwidth"]=Ku.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Y)},O.prototype.createBucket=function(Y){return new ps(Y)},O.prototype.queryRadius=function(Y){var ie=Y,me=$u(qa("line-width",this,ie),qa("line-gap-width",this,ie)),we=qa("line-offset",this,ie);return me/2+Math.abs(we)+Go(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(Y,ie,me,we,ze,Ve,nt){var ht=Xo(Y,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Ve.angle,nt),xt=nt/2*$u(this.paint.get("line-width").evaluate(ie,me),this.paint.get("line-gap-width").evaluate(ie,me)),Ut=this.paint.get("line-offset").evaluate(ie,me);return Ut&&(we=function($t,Wt){for(var fn=[],An=new n(0,0),Bn=0;Bn<$t.length;Bn++){for(var Nn=$t[Bn],Gn=[],Jn=0;Jn<Nn.length;Jn++){var kr=Nn[Jn],zr=Nn[Jn+1],Kr=0===Jn?An:kr.sub(Nn[Jn-1])._unit()._perp(),Wr=Jn===Nn.length-1?An:zr.sub(kr)._unit()._perp(),ai=Kr._add(Wr)._unit();ai._mult(1/(ai.x*Wr.x+ai.y*Wr.y)),Gn.push(ai._mult(Wt)._add(kr))}fn.push(Gn)}return fn}(we,Ut*nt)),function($t,Wt,fn){for(var An=0;An<Wt.length;An++){var Bn=Wt[An];if($t.length>=3)for(var Nn=0;Nn<Bn.length;Nn++)if(vs($t,Bn[Nn]))return!0;if(sl($t,Bn,fn))return!0}return!1}(ht,we,xt)},O.prototype.isTileClipped=function(){return!0},O}(Zo);function $u(A,O){return O>0?O+2*A:A}var cu=da([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),qh=da([{name:"a_projected_pos",components:3,type:"Float32"}],4),Hh=(da([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),da([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ef=(da([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),da([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Yh=da([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Zh(A,O,Y){return A.sections.forEach(function(ie){var me,ze,Ve;ie.text=(me=ie.text,ze=Y,"uppercase"===(Ve=O.layout.get("text-transform").evaluate(ze,{}))?me=me.toLocaleUpperCase():"lowercase"===Ve&&(me=me.toLocaleLowerCase()),xo.applyArabicShaping&&(me=xo.applyArabicShaping(me)),me)}),A}da([{name:"triangle",components:3,type:"Uint16"}]),da([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),da([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),da([{type:"Float32",name:"offsetX"}]),da([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ql={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},tf=function(A,O,Y,ie,me){var we,ze,Ve=8*me-ie-1,nt=(1<<Ve)-1,ht=nt>>1,xt=-7,Ut=Y?me-1:0,$t=Y?-1:1,Wt=A[O+Ut];for(Ut+=$t,we=Wt&(1<<-xt)-1,Wt>>=-xt,xt+=Ve;xt>0;we=256*we+A[O+Ut],Ut+=$t,xt-=8);for(ze=we&(1<<-xt)-1,we>>=-xt,xt+=ie;xt>0;ze=256*ze+A[O+Ut],Ut+=$t,xt-=8);if(0===we)we=1-ht;else{if(we===nt)return ze?NaN:1/0*(Wt?-1:1);ze+=Math.pow(2,ie),we-=ht}return(Wt?-1:1)*ze*Math.pow(2,we-ie)},nf=function(A,O,Y,ie,me,we){var ze,Ve,nt,ht=8*we-me-1,xt=(1<<ht)-1,Ut=xt>>1,$t=23===me?Math.pow(2,-24)-Math.pow(2,-77):0,Wt=ie?0:we-1,fn=ie?1:-1,An=O<0||0===O&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(Ve=isNaN(O)?1:0,ze=xt):(ze=Math.floor(Math.log(O)/Math.LN2),O*(nt=Math.pow(2,-ze))<1&&(ze--,nt*=2),(O+=ze+Ut>=1?$t/nt:$t*Math.pow(2,1-Ut))*nt>=2&&(ze++,nt/=2),ze+Ut>=xt?(Ve=0,ze=xt):ze+Ut>=1?(Ve=(O*nt-1)*Math.pow(2,me),ze+=Ut):(Ve=O*Math.pow(2,Ut-1)*Math.pow(2,me),ze=0));me>=8;A[Y+Wt]=255&Ve,Wt+=fn,Ve/=256,me-=8);for(ze=ze<<me|Ve,ht+=me;ht>0;A[Y+Wt]=255&ze,Wt+=fn,ze/=256,ht-=8);A[Y+Wt-fn]|=128*An},gc=Ia;function Ia(A){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(A)?A:new Uint8Array(A||0),this.pos=0,this.type=0,this.length=this.buf.length}Ia.Varint=0,Ia.Fixed64=1,Ia.Bytes=2,Ia.Fixed32=5;var rf="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Xs(A){return A.type===Ia.Bytes?A.readVarint()+A.pos:A.pos+1}function af(A,O,Y){var ie=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));Y.realloc(ie);for(var me=Y.pos-1;me>=A;me--)Y.buf[me+ie]=Y.buf[me]}function Gh(A,O){for(var Y=0;Y<A.length;Y++)O.writeVarint(A[Y])}function Xh(A,O){for(var Y=0;Y<A.length;Y++)O.writeSVarint(A[Y])}function Wh(A,O){for(var Y=0;Y<A.length;Y++)O.writeFloat(A[Y])}function Jh(A,O){for(var Y=0;Y<A.length;Y++)O.writeDouble(A[Y])}function Qh(A,O){for(var Y=0;Y<A.length;Y++)O.writeBoolean(A[Y])}function Kh(A,O){for(var Y=0;Y<A.length;Y++)O.writeFixed32(A[Y])}function $h(A,O){for(var Y=0;Y<A.length;Y++)O.writeSFixed32(A[Y])}function ep(A,O){for(var Y=0;Y<A.length;Y++)O.writeFixed64(A[Y])}function tp(A,O){for(var Y=0;Y<A.length;Y++)O.writeSFixed64(A[Y])}function vc(A,O){return(A[O]|A[O+1]<<8|A[O+2]<<16)+16777216*A[O+3]}function Tl(A,O,Y){A[Y]=O,A[Y+1]=O>>>8,A[Y+2]=O>>>16,A[Y+3]=O>>>24}function of(A,O){return(A[O]|A[O+1]<<8|A[O+2]<<16)+(A[O+3]<<24)}function np(A,O,Y){1===A&&Y.readMessage(rp,O)}function rp(A,O,Y){if(3===A){var ie=Y.readMessage(ip,{}),ze=ie.width,Ve=ie.height,nt=ie.left,ht=ie.top,xt=ie.advance;O.push({id:ie.id,bitmap:new fl({width:ze+6,height:Ve+6},ie.bitmap),metrics:{width:ze,height:Ve,left:nt,top:ht,advance:xt}})}}function ip(A,O,Y){1===A?O.id=Y.readVarint():2===A?O.bitmap=Y.readBytes():3===A?O.width=Y.readVarint():4===A?O.height=Y.readVarint():5===A?O.left=Y.readSVarint():6===A?O.top=Y.readSVarint():7===A&&(O.advance=Y.readVarint())}function sf(A){for(var O=0,Y=0,ie=0,me=A;ie<me.length;ie+=1){var we=me[ie];O+=we.w*we.h,Y=Math.max(Y,we.w)}A.sort(function(An,Bn){return Bn.h-An.h});for(var ze=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),Y),h:1/0}],Ve=0,nt=0,ht=0,xt=A;ht<xt.length;ht+=1)for(var Ut=xt[ht],$t=ze.length-1;$t>=0;$t--){var Wt=ze[$t];if(!(Ut.w>Wt.w||Ut.h>Wt.h)){if(Ut.x=Wt.x,Ut.y=Wt.y,nt=Math.max(nt,Ut.y+Ut.h),Ve=Math.max(Ve,Ut.x+Ut.w),Ut.w===Wt.w&&Ut.h===Wt.h){var fn=ze.pop();$t<ze.length&&(ze[$t]=fn)}else Ut.h===Wt.h?(Wt.x+=Ut.w,Wt.w-=Ut.w):Ut.w===Wt.w?(Wt.y+=Ut.h,Wt.h-=Ut.h):(ze.push({x:Wt.x+Ut.w,y:Wt.y,w:Wt.w-Ut.w,h:Ut.h}),Wt.y+=Ut.h,Wt.h-=Ut.h);break}}return{w:Ve,h:nt,fill:O/(Ve*nt)||0}}Ia.prototype={destroy:function(){this.buf=null},readFields:function(A,O,Y){for(Y=Y||this.length;this.pos<Y;){var ie=this.readVarint(),me=ie>>3,we=this.pos;this.type=7&ie,A(me,O,this),this.pos===we&&this.skip(ie)}return O},readMessage:function(A,O){return this.readFields(A,O,this.readVarint()+this.pos)},readFixed32:function(){var A=vc(this.buf,this.pos);return this.pos+=4,A},readSFixed32:function(){var A=of(this.buf,this.pos);return this.pos+=4,A},readFixed64:function(){var A=vc(this.buf,this.pos)+4294967296*vc(this.buf,this.pos+4);return this.pos+=8,A},readSFixed64:function(){var A=vc(this.buf,this.pos)+4294967296*of(this.buf,this.pos+4);return this.pos+=8,A},readFloat:function(){var A=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,A},readDouble:function(){var A=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,A},readVarint:function(A){var O,Y,ie=this.buf;return O=127&(Y=ie[this.pos++]),Y<128?O:(O|=(127&(Y=ie[this.pos++]))<<7,Y<128?O:(O|=(127&(Y=ie[this.pos++]))<<14,Y<128?O:(O|=(127&(Y=ie[this.pos++]))<<21,Y<128?O:function(me,we,ze){var Ve,nt,ht=ze.buf;if(Ve=(112&(nt=ht[ze.pos++]))>>4,nt<128||(Ve|=(127&(nt=ht[ze.pos++]))<<3,nt<128)||(Ve|=(127&(nt=ht[ze.pos++]))<<10,nt<128)||(Ve|=(127&(nt=ht[ze.pos++]))<<17,nt<128)||(Ve|=(127&(nt=ht[ze.pos++]))<<24,nt<128)||(Ve|=(1&(nt=ht[ze.pos++]))<<31,nt<128))return function wl(A,O,Y){return Y?4294967296*O+(A>>>0):4294967296*(O>>>0)+(A>>>0)}(me,Ve,we);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(Y=ie[this.pos]))<<28,A,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var A=this.readVarint();return A%2==1?(A+1)/-2:A/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var A=this.readVarint()+this.pos,O=this.pos;return this.pos=A,A-O>=12&&rf?rf.decode(this.buf.subarray(O,A)):function(Y,ie,me){for(var we="",ze=ie;ze<me;){var Ve,nt,ht,xt=Y[ze],Ut=null,$t=xt>239?4:xt>223?3:xt>191?2:1;if(ze+$t>me)break;1===$t?xt<128&&(Ut=xt):2===$t?128==(192&(Ve=Y[ze+1]))&&(Ut=(31&xt)<<6|63&Ve)<=127&&(Ut=null):3===$t?(nt=Y[ze+2],128==(192&(Ve=Y[ze+1]))&&128==(192&nt)&&((Ut=(15&xt)<<12|(63&Ve)<<6|63&nt)<=2047||Ut>=55296&&Ut<=57343)&&(Ut=null)):4===$t&&(nt=Y[ze+2],ht=Y[ze+3],128==(192&(Ve=Y[ze+1]))&&128==(192&nt)&&128==(192&ht)&&((Ut=(15&xt)<<18|(63&Ve)<<12|(63&nt)<<6|63&ht)<=65535||Ut>=1114112)&&(Ut=null)),null===Ut?(Ut=65533,$t=1):Ut>65535&&(Ut-=65536,we+=String.fromCharCode(Ut>>>10&1023|55296),Ut=56320|1023&Ut),we+=String.fromCharCode(Ut),ze+=$t}return we}(this.buf,O,A)},readBytes:function(){var A=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,A);return this.pos=A,O},readPackedVarint:function(A,O){if(this.type!==Ia.Bytes)return A.push(this.readVarint(O));var Y=Xs(this);for(A=A||[];this.pos<Y;)A.push(this.readVarint(O));return A},readPackedSVarint:function(A){if(this.type!==Ia.Bytes)return A.push(this.readSVarint());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readSVarint());return A},readPackedBoolean:function(A){if(this.type!==Ia.Bytes)return A.push(this.readBoolean());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readBoolean());return A},readPackedFloat:function(A){if(this.type!==Ia.Bytes)return A.push(this.readFloat());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readFloat());return A},readPackedDouble:function(A){if(this.type!==Ia.Bytes)return A.push(this.readDouble());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readDouble());return A},readPackedFixed32:function(A){if(this.type!==Ia.Bytes)return A.push(this.readFixed32());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readFixed32());return A},readPackedSFixed32:function(A){if(this.type!==Ia.Bytes)return A.push(this.readSFixed32());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readSFixed32());return A},readPackedFixed64:function(A){if(this.type!==Ia.Bytes)return A.push(this.readFixed64());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readFixed64());return A},readPackedSFixed64:function(A){if(this.type!==Ia.Bytes)return A.push(this.readSFixed64());var O=Xs(this);for(A=A||[];this.pos<O;)A.push(this.readSFixed64());return A},skip:function(A){var O=7&A;if(O===Ia.Varint)for(;this.buf[this.pos++]>127;);else if(O===Ia.Bytes)this.pos=this.readVarint()+this.pos;else if(O===Ia.Fixed32)this.pos+=4;else{if(O!==Ia.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(A,O){this.writeVarint(A<<3|O)},realloc:function(A){for(var O=this.length||16;O<this.pos+A;)O*=2;if(O!==this.length){var Y=new Uint8Array(O);Y.set(this.buf),this.buf=Y,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(A){this.realloc(4),Tl(this.buf,A,this.pos),this.pos+=4},writeSFixed32:function(A){this.realloc(4),Tl(this.buf,A,this.pos),this.pos+=4},writeFixed64:function(A){this.realloc(8),Tl(this.buf,-1&A,this.pos),Tl(this.buf,Math.floor(A*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(A){this.realloc(8),Tl(this.buf,-1&A,this.pos),Tl(this.buf,Math.floor(A*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(A){(A=+A||0)>268435455||A<0?function(O,Y){var ie,me,we,Ve;if(O>=0?(ie=O%4294967296|0,me=O/4294967296|0):(me=~(-O/4294967296),4294967295^(ie=~(-O%4294967296))?ie=ie+1|0:(ie=0,me=me+1|0)),O>=0x10000000000000000||O<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");Y.realloc(10),we=ie,(Ve=Y).buf[Ve.pos++]=127&we|128,we>>>=7,Ve.buf[Ve.pos++]=127&we|128,we>>>=7,Ve.buf[Ve.pos++]=127&we|128,we>>>=7,Ve.buf[Ve.pos++]=127&we|128,Ve.buf[Ve.pos]=127&(we>>>=7),function(we,ze){var Ve=(7&we)<<4;ze.buf[ze.pos++]|=Ve|((we>>>=3)?128:0),we&&(ze.buf[ze.pos++]=127&we|((we>>>=7)?128:0),we&&(ze.buf[ze.pos++]=127&we|((we>>>=7)?128:0),we&&(ze.buf[ze.pos++]=127&we|((we>>>=7)?128:0),we&&(ze.buf[ze.pos++]=127&we|((we>>>=7)?128:0),we&&(ze.buf[ze.pos++]=127&we)))))}(me,Y)}(A,this):(this.realloc(4),this.buf[this.pos++]=127&A|(A>127?128:0),A<=127||(this.buf[this.pos++]=127&(A>>>=7)|(A>127?128:0),A<=127||(this.buf[this.pos++]=127&(A>>>=7)|(A>127?128:0),A<=127||(this.buf[this.pos++]=A>>>7&127))))},writeSVarint:function(A){this.writeVarint(A<0?2*-A-1:2*A)},writeBoolean:function(A){this.writeVarint(Boolean(A))},writeString:function(A){A=String(A),this.realloc(4*A.length),this.pos++;var O=this.pos;this.pos=function(ie,me,we){for(var ze,Ve,nt=0;nt<me.length;nt++){if((ze=me.charCodeAt(nt))>55295&&ze<57344){if(!Ve){ze>56319||nt+1===me.length?(ie[we++]=239,ie[we++]=191,ie[we++]=189):Ve=ze;continue}if(ze<56320){ie[we++]=239,ie[we++]=191,ie[we++]=189,Ve=ze;continue}ze=Ve-55296<<10|ze-56320|65536,Ve=null}else Ve&&(ie[we++]=239,ie[we++]=191,ie[we++]=189,Ve=null);ze<128?ie[we++]=ze:(ze<2048?ie[we++]=ze>>6|192:(ze<65536?ie[we++]=ze>>12|224:(ie[we++]=ze>>18|240,ie[we++]=ze>>12&63|128),ie[we++]=ze>>6&63|128),ie[we++]=63&ze|128)}return we}(this.buf,A,this.pos);var Y=this.pos-O;Y>=128&&af(O,Y,this),this.pos=O-1,this.writeVarint(Y),this.pos+=Y},writeFloat:function(A){this.realloc(4),nf(this.buf,A,this.pos,!0,23,4),this.pos+=4},writeDouble:function(A){this.realloc(8),nf(this.buf,A,this.pos,!0,52,8),this.pos+=8},writeBytes:function(A){var O=A.length;this.writeVarint(O),this.realloc(O);for(var Y=0;Y<O;Y++)this.buf[this.pos++]=A[Y]},writeRawMessage:function(A,O){this.pos++;var Y=this.pos;A(O,this);var ie=this.pos-Y;ie>=128&&af(Y,ie,this),this.pos=Y-1,this.writeVarint(ie),this.pos+=ie},writeMessage:function(A,O,Y){this.writeTag(A,Ia.Bytes),this.writeRawMessage(O,Y)},writePackedVarint:function(A,O){O.length&&this.writeMessage(A,Gh,O)},writePackedSVarint:function(A,O){O.length&&this.writeMessage(A,Xh,O)},writePackedBoolean:function(A,O){O.length&&this.writeMessage(A,Qh,O)},writePackedFloat:function(A,O){O.length&&this.writeMessage(A,Wh,O)},writePackedDouble:function(A,O){O.length&&this.writeMessage(A,Jh,O)},writePackedFixed32:function(A,O){O.length&&this.writeMessage(A,Kh,O)},writePackedSFixed32:function(A,O){O.length&&this.writeMessage(A,$h,O)},writePackedFixed64:function(A,O){O.length&&this.writeMessage(A,ep,O)},writePackedSFixed64:function(A,O){O.length&&this.writeMessage(A,tp,O)},writeBytesField:function(A,O){this.writeTag(A,Ia.Bytes),this.writeBytes(O)},writeFixed32Field:function(A,O){this.writeTag(A,Ia.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(A,O){this.writeTag(A,Ia.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(A,O){this.writeTag(A,Ia.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(A,O){this.writeTag(A,Ia.Fixed64),this.writeSFixed64(O)},writeVarintField:function(A,O){this.writeTag(A,Ia.Varint),this.writeVarint(O)},writeSVarintField:function(A,O){this.writeTag(A,Ia.Varint),this.writeSVarint(O)},writeStringField:function(A,O){this.writeTag(A,Ia.Bytes),this.writeString(O)},writeFloatField:function(A,O){this.writeTag(A,Ia.Fixed32),this.writeFloat(O)},writeDoubleField:function(A,O){this.writeTag(A,Ia.Fixed64),this.writeDouble(O)},writeBooleanField:function(A,O){this.writeVarintField(A,Boolean(O))}};var yc=function(A,O){var Y=O.pixelRatio,ie=O.version,me=O.stretchX,we=O.stretchY,ze=O.content;this.paddedRect=A,this.pixelRatio=Y,this.stretchX=me,this.stretchY=we,this.content=ze,this.version=ie},Kl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kl.tlbr.get=function(){return this.tl.concat(this.br)},Kl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yc.prototype,Kl);var $l=function(A,O){var Y={},ie={};this.haveRenderCallbacks=[];var me=[];this.addImages(A,Y,me),this.addImages(O,ie,me);var we=sf(me),nt=new hs({width:we.w||1,height:we.h||1});for(var ht in A){var xt=A[ht],Ut=Y[ht].paddedRect;hs.copy(xt.data,nt,{x:0,y:0},{x:Ut.x+1,y:Ut.y+1},xt.data)}for(var $t in O){var Wt=O[$t],fn=ie[$t].paddedRect,An=fn.x+1,Bn=fn.y+1,Nn=Wt.data.width,Gn=Wt.data.height;hs.copy(Wt.data,nt,{x:0,y:0},{x:An,y:Bn},Wt.data),hs.copy(Wt.data,nt,{x:0,y:Gn-1},{x:An,y:Bn-1},{width:Nn,height:1}),hs.copy(Wt.data,nt,{x:0,y:0},{x:An,y:Bn+Gn},{width:Nn,height:1}),hs.copy(Wt.data,nt,{x:Nn-1,y:0},{x:An-1,y:Bn},{width:1,height:Gn}),hs.copy(Wt.data,nt,{x:0,y:0},{x:An+Nn,y:Bn},{width:1,height:Gn})}this.image=nt,this.iconPositions=Y,this.patternPositions=ie};$l.prototype.addImages=function(A,O,Y){for(var ie in A){var me=A[ie],we={x:0,y:0,w:me.data.width+2,h:me.data.height+2};Y.push(we),O[ie]=new yc(we,me),me.hasRenderCallback&&this.haveRenderCallbacks.push(ie)}},$l.prototype.patchUpdatedImages=function(A,O){for(var Y in A.dispatchRenderCallbacks(this.haveRenderCallbacks),A.updatedImages)this.patchUpdatedImage(this.iconPositions[Y],A.getImage(Y),O),this.patchUpdatedImage(this.patternPositions[Y],A.getImage(Y),O)},$l.prototype.patchUpdatedImage=function(A,O,Y){if(A&&O&&A.version!==O.version){A.version=O.version;var ie=A.tl;Y.update(O.data,void 0,{x:ie[0],y:ie[1]})}},nr("ImagePosition",yc),nr("ImageAtlas",$l);var Ts={horizontal:1,vertical:2,horizontalOnly:3},kl=function(){this.scale=1,this.fontStack="",this.imageName=null};kl.forText=function(A,O){var Y=new kl;return Y.scale=A||1,Y.fontStack=O,Y},kl.forImage=function(A){var O=new kl;return O.imageName=A,O};var Ko=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function xc(A,O,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An){var Bn,Nn=Ko.fromFeature(A,me);Ut===Ts.vertical&&Nn.verticalizePunctuation();var Gn=xo.processBidirectionalText,Jn=xo.processStyledBidirectionalText;if(Gn&&1===Nn.sections.length){Bn=[];for(var tr=0,kr=Gn(Nn.toString(),uu(Nn,ht,we,O,ie,Wt,fn));tr<kr.length;tr+=1){var zr=kr[tr],Kr=new Ko;Kr.text=zr,Kr.sections=Nn.sections;for(var Wr=0;Wr<zr.length;Wr++)Kr.sectionIndex.push(0);Bn.push(Kr)}}else if(Jn){Bn=[];for(var ai=0,bi=Jn(Nn.text,Nn.sectionIndex,uu(Nn,ht,we,O,ie,Wt,fn));ai<bi.length;ai+=1){var _i=bi[ai],hi=new Ko;hi.text=_i[0],hi.sectionIndex=_i[1],hi.sections=Nn.sections,Bn.push(hi)}}else Bn=function(wi,ha){for(var la=[],ya=wi.text,Di=0,ca=0,Da=ha;ca<Da.length;ca+=1){var Ea=Da[ca];la.push(wi.substring(Di,Ea)),Di=Ea}return Di<ya.length&&la.push(wi.substring(Di,ya.length)),la}(Nn,uu(Nn,ht,we,O,ie,Wt,fn));var Ci=[],Ai={positionedLines:Ci,text:Nn.toString(),top:xt[1],bottom:xt[1],left:xt[0],right:xt[0],writingMode:Ut,iconsInText:!1,verticalizable:!1};return function(wi,ha,la,ya,Di,ca,Da,Ea,Ya,La,Co,Za){for(var Wo=0,Fo=-17,Uo=0,os=0,$o="right"===Ea?1:"left"===Ea?0:.5,Eo=0,Vo=0,bo=Di;Vo<bo.length;Vo+=1){var Po=bo[Vo];Po.trim();var Ki=Po.getMaxScale(),ma=24*(Ki-1),io={positionedGlyphs:[],lineOffset:0};wi.positionedLines[Eo]=io;var ao=io.positionedGlyphs,to=0;if(Po.length()){for(var Ga=0;Ga<Po.length();Ga++){var ba=Po.getSection(Ga),oo=Po.getSectionIndex(Ga),ss=Po.getCharCode(Ga),xs=0,es=null,Rs=null,Qs=null,No=24,Fs=!(Ya===Ts.horizontal||!Co&&!Mi(ss)||Co&&(bc[ss]||(il=ss,Br.Arabic(il)||Br["Arabic Supplement"](il)||Br["Arabic Extended-A"](il)||Br["Arabic Presentation Forms-A"](il)||Br["Arabic Presentation Forms-B"](il))));if(ba.imageName){var Ns=ya[ba.imageName];if(!Ns)continue;Qs=ba.imageName,wi.iconsInText=wi.iconsInText||!0,Rs=Ns.paddedRect;var Bs=Ns.displaySize;ba.scale=24*ba.scale/Za,xs=ma+(24-Bs[1]*ba.scale),No=(es={width:Bs[0],height:Bs[1],left:1,top:-3,advance:Fs?Bs[1]:Bs[0]}).advance;var Pl=Fs?Bs[0]*ba.scale-24*Ki:Bs[1]*ba.scale-24*Ki;Pl>0&&Pl>to&&(to=Pl)}else{var Ec=la[ba.fontStack],ml=Ec&&Ec[ss];if(ml&&ml.rect)Rs=ml.rect,es=ml.metrics;else{var Lc=ha[ba.fontStack],zc=Lc&&Lc[ss];if(!zc)continue;es=zc.metrics}xs=24*(Ki-ba.scale)}Fs?(wi.verticalizable=!0,ao.push({glyph:ss,imageName:Qs,x:Wo,y:Fo+xs,vertical:Fs,scale:ba.scale,fontStack:ba.fontStack,sectionIndex:oo,metrics:es,rect:Rs}),Wo+=No*ba.scale+La):(ao.push({glyph:ss,imageName:Qs,x:Wo,y:Fo+xs,vertical:Fs,scale:ba.scale,fontStack:ba.fontStack,sectionIndex:oo,metrics:es,rect:Rs}),Wo+=es.advance*ba.scale+La)}0!==ao.length&&(Uo=Math.max(Wo-La,Uo),op(ao,0,ao.length-1,$o,to)),Wo=0;var Oc=ca*Ki+to;io.lineOffset=Math.max(to,ma),Fo+=Oc,os=Math.max(Oc,os),++Eo}else Fo+=ca,++Eo}var il,Ol=Fo- -17,Ic=fu(Da),Il=Ic.horizontalAlign,al=Ic.verticalAlign;(function(nc,Dc,Rc,Fc,rc,Nc,ic,Bc,ac){var Dl,jc=(Dc-Rc)*rc;Dl=Nc!==ic?-Bc*Fc- -17:(-Fc*ac+.5)*ic;for(var Rl=0,Fl=nc;Rl<Fl.length;Rl+=1)for(var Nl=0,oc=Fl[Rl].positionedGlyphs;Nl<oc.length;Nl+=1){var Bl=oc[Nl];Bl.x+=jc,Bl.y+=Dl}})(wi.positionedLines,$o,Il,al,Uo,os,ca,Ol,Di.length),wi.top+=-al*Ol,wi.bottom=wi.top+Ol,wi.left+=-Il*Uo,wi.right=wi.left+Uo}(Ai,O,Y,ie,Bn,ze,Ve,nt,Ut,ht,$t,An),!function(wi){for(var ha=0,la=wi;ha<la.length;ha+=1)if(0!==la[ha].positionedGlyphs.length)return!1;return!0}(Ci)&&Ai}Ko.fromFeature=function(A,O){for(var Y=new Ko,ie=0;ie<A.sections.length;ie++){var me=A.sections[ie];me.image?Y.addImageSection(me):Y.addTextSection(me,O)}return Y},Ko.prototype.length=function(){return this.text.length},Ko.prototype.getSection=function(A){return this.sections[this.sectionIndex[A]]},Ko.prototype.getSectionIndex=function(A){return this.sectionIndex[A]},Ko.prototype.getCharCode=function(A){return this.text.charCodeAt(A)},Ko.prototype.verticalizePunctuation=function(){this.text=function(A){for(var O="",Y=0;Y<A.length;Y++){var ie=A.charCodeAt(Y+1)||null,me=A.charCodeAt(Y-1)||null;ie&&Ji(ie)&&!Ql[A[Y+1]]||me&&Ji(me)&&!Ql[A[Y-1]]||!Ql[A[Y]]?O+=A[Y]:O+=Ql[A[Y]]}return O}(this.text)},Ko.prototype.trim=function(){for(var A=0,O=0;O<this.text.length&&bc[this.text.charCodeAt(O)];O++)A++;for(var Y=this.text.length,ie=this.text.length-1;ie>=0&&ie>=A&&bc[this.text.charCodeAt(ie)];ie--)Y--;this.text=this.text.substring(A,Y),this.sectionIndex=this.sectionIndex.slice(A,Y)},Ko.prototype.substring=function(A,O){var Y=new Ko;return Y.text=this.text.substring(A,O),Y.sectionIndex=this.sectionIndex.slice(A,O),Y.sections=this.sections,Y},Ko.prototype.toString=function(){return this.text},Ko.prototype.getMaxScale=function(){var A=this;return this.sectionIndex.reduce(function(O,Y){return Math.max(O,A.sections[Y].scale)},0)},Ko.prototype.addTextSection=function(A,O){this.text+=A.text,this.sections.push(kl.forText(A.scale,A.fontStack||O));for(var Y=this.sections.length-1,ie=0;ie<A.text.length;++ie)this.sectionIndex.push(Y)},Ko.prototype.addImageSection=function(A){var O=A.image?A.image.name:"";if(0!==O.length){var Y=this.getNextImageSectionCharCode();Y?(this.text+=String.fromCharCode(Y),this.sections.push(kl.forImage(O)),this.sectionIndex.push(this.sections.length-1)):M("Reached maximum number of images 6401")}else M("Can't add FormattedSection with an empty image.")},Ko.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var bc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ys={};function lf(A,O,Y,ie,me,we){if(O.imageName){var ze=ie[O.imageName];return ze?ze.displaySize[0]*O.scale*24/we+me:0}var Ve=Y[O.fontStack],nt=Ve&&Ve[A];return nt?nt.metrics.advance*O.scale+me:0}function cf(A,O,Y,ie){var me=Math.pow(A-O,2);return ie?A<O?me/2:2*me:me+Math.abs(Y)*Y}function ap(A,O,Y){var ie=0;return 10===A&&(ie-=1e4),Y&&(ie+=150),40!==A&&65288!==A||(ie+=50),41!==O&&65289!==O||(ie+=50),ie}function uf(A,O,Y,ie,me,we){for(var ze=null,Ve=cf(O,Y,me,we),nt=0,ht=ie;nt<ht.length;nt+=1){var xt=ht[nt],Ut=cf(O-xt.x,Y,me,we)+xt.badness;Ut<=Ve&&(ze=xt,Ve=Ut)}return{index:A,x:O,priorBreak:ze,badness:Ve}}function uu(A,O,Y,ie,me,we,ze){if("point"!==we)return[];if(!A)return[];for(var Ve,nt=[],ht=function(Bn,Nn,Gn,Jn,tr,kr){for(var zr=0,Kr=0;Kr<Bn.length();Kr++){var Wr=Bn.getSection(Kr);zr+=lf(Bn.getCharCode(Kr),Wr,Jn,tr,Nn,kr)}return zr/Math.max(1,Math.ceil(zr/Gn))}(A,O,Y,ie,me,ze),xt=A.text.indexOf("\u200b")>=0,Ut=0,$t=0;$t<A.length();$t++){var Wt=A.getSection($t),fn=A.getCharCode($t);if(bc[fn]||(Ut+=lf(fn,Wt,ie,me,O,ze)),$t<A.length()-1){var An=!((Ve=fn)<11904||!(Br["Bopomofo Extended"](Ve)||Br.Bopomofo(Ve)||Br["CJK Compatibility Forms"](Ve)||Br["CJK Compatibility Ideographs"](Ve)||Br["CJK Compatibility"](Ve)||Br["CJK Radicals Supplement"](Ve)||Br["CJK Strokes"](Ve)||Br["CJK Symbols and Punctuation"](Ve)||Br["CJK Unified Ideographs Extension A"](Ve)||Br["CJK Unified Ideographs"](Ve)||Br["Enclosed CJK Letters and Months"](Ve)||Br["Halfwidth and Fullwidth Forms"](Ve)||Br.Hiragana(Ve)||Br["Ideographic Description Characters"](Ve)||Br["Kangxi Radicals"](Ve)||Br["Katakana Phonetic Extensions"](Ve)||Br.Katakana(Ve)||Br["Vertical Forms"](Ve)||Br["Yi Radicals"](Ve)||Br["Yi Syllables"](Ve)));(ys[fn]||An||Wt.imageName)&&nt.push(uf($t+1,Ut,ht,nt,ap(fn,A.getCharCode($t+1),An&&xt),!1))}}return function Bn(Nn){return Nn?Bn(Nn.priorBreak).concat(Nn.index):[]}(uf(A.length(),Ut,ht,nt,0,!0))}function fu(A){var O=.5,Y=.5;switch(A){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(A){case"bottom":case"bottom-right":case"bottom-left":Y=1;break;case"top":case"top-right":case"top-left":Y=0}return{horizontalAlign:O,verticalAlign:Y}}function op(A,O,Y,ie,me){if(ie||me)for(var we=A[Y],Ve=(A[Y].x+we.metrics.advance*we.scale)*ie,nt=O;nt<=Y;nt++)A[nt].x-=Ve,A[nt].y+=me}function ff(A,O,Y,ie,me,we){var ze,Ve=A.image;if(Ve.content){var nt=Ve.content,ht=Ve.pixelRatio||1;ze=[nt[0]/ht,nt[1]/ht,Ve.displaySize[0]-nt[2]/ht,Ve.displaySize[1]-nt[3]/ht]}var xt,Ut,$t,Wt,fn=O.left*we,An=O.right*we;"width"===Y||"both"===Y?(Wt=me[0]+fn-ie[3],Ut=me[0]+An+ie[1]):Ut=(Wt=me[0]+(fn+An-Ve.displaySize[0])/2)+Ve.displaySize[0];var Bn=O.top*we,Nn=O.bottom*we;return"height"===Y||"both"===Y?(xt=me[1]+Bn-ie[0],$t=me[1]+Nn+ie[2]):$t=(xt=me[1]+(Bn+Nn-Ve.displaySize[1])/2)+Ve.displaySize[1],{image:Ve,top:xt,right:Ut,bottom:$t,left:Wt,collisionPadding:ze}}ys[10]=!0,ys[32]=!0,ys[38]=!0,ys[40]=!0,ys[41]=!0,ys[43]=!0,ys[45]=!0,ys[47]=!0,ys[173]=!0,ys[183]=!0,ys[8203]=!0,ys[8208]=!0,ys[8211]=!0,ys[8231]=!0;var Al=function(A){function O(Y,ie,me,we){A.call(this,Y,ie),this.angle=me,void 0!==we&&(this.segment=we)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(n);function hu(A,O){var Y=O.expression;if("constant"===Y.kind)return{kind:"constant",layoutSize:Y.evaluate(new fa(A+1))};if("source"===Y.kind)return{kind:"source"};for(var ie=Y.zoomStops,me=Y.interpolationType,we=0;we<ie.length&&ie[we]<=A;)we++;for(var ze=we=Math.max(0,we-1);ze<ie.length&&ie[ze]<A+1;)ze++;ze=Math.min(ie.length-1,ze);var Ve=ie[we],nt=ie[ze];return"composite"===Y.kind?{kind:"composite",minZoom:Ve,maxZoom:nt,interpolationType:me}:{kind:"camera",minZoom:Ve,maxZoom:nt,minSize:Y.evaluate(new fa(Ve)),maxSize:Y.evaluate(new fa(nt)),interpolationType:me}}function hf(A,O,Y){var ie=O.uSize,we=Y.lowerSize;return"source"===A.kind?we/128:"composite"===A.kind?Pr(we/128,Y.upperSize/128,O.uSizeT):ie}function pf(A,O){var Y=0,ie=0;if("constant"===A.kind)ie=A.layoutSize;else if("source"!==A.kind){var me=A.interpolationType,Ve=me?f(Zi.interpolationFactor(me,O,A.minZoom,A.maxZoom),0,1):0;"camera"===A.kind?ie=Pr(A.minSize,A.maxSize,Ve):Y=Ve}return{uSizeT:Y,uSize:ie}}nr("Anchor",Al);var sp=Object.freeze({__proto__:null,getSizeData:hu,evaluateSizeForFeature:hf,evaluateSizeForZoom:pf,SIZE_PACK_FACTOR:128});function df(A,O,Y,ie,me){if(void 0===O.segment)return!0;for(var we=O,ze=O.segment+1,Ve=0;Ve>-Y/2;){if(--ze<0)return!1;Ve-=A[ze].dist(we),we=A[ze]}Ve+=A[ze].dist(A[ze+1]),ze++;for(var nt=[],ht=0;Ve<Y/2;){var Ut=A[ze],$t=A[ze+1];if(!$t)return!1;var Wt=A[ze-1].angleTo(Ut)-Ut.angleTo($t);for(Wt=Math.abs((Wt+3*Math.PI)%(2*Math.PI)-Math.PI),nt.push({distance:Ve,angleDelta:Wt}),ht+=Wt;Ve-nt[0].distance>ie;)ht-=nt.shift().angleDelta;if(ht>me)return!1;ze++,Ve+=Ut.dist($t)}return!0}function mf(A){for(var O=0,Y=0;Y<A.length-1;Y++)O+=A[Y].dist(A[Y+1]);return O}function gf(A,O,Y){return A?.6*O*Y:0}function vf(A,O){return Math.max(A?A.right-A.left:0,O?O.right-O.left:0)}function lp(A,O,Y,ie,me,we){for(var ze=gf(Y,me,we),Ve=vf(Y,ie)*we,nt=0,ht=mf(A)/2,xt=0;xt<A.length-1;xt++){var Ut=A[xt],$t=A[xt+1],Wt=Ut.dist($t);if(nt+Wt>ht){var fn=(ht-nt)/Wt,An=Pr(Ut.x,$t.x,fn),Bn=Pr(Ut.y,$t.y,fn),Nn=new Al(An,Bn,$t.angleTo(Ut),xt);return Nn._round(),!ze||df(A,Nn,Ve,ze,O)?Nn:void 0}nt+=Wt}}function cp(A,O,Y,ie,me,we,ze,Ve,nt){var ht=gf(ie,we,ze),xt=vf(ie,me),Ut=xt*ze,$t=0===A[0].x||A[0].x===nt||0===A[0].y||A[0].y===nt;return O-Ut<O/4&&(O=Ut+O/4),function Wt(fn,An,Bn,Nn,Gn,Jn,tr,kr,zr){for(var Kr=Jn/2,Wr=mf(fn),ai=0,bi=An-Bn,_i=[],hi=0;hi<fn.length-1;hi++){for(var Ci=fn[hi],Ai=fn[hi+1],wi=Ci.dist(Ai),ha=Ai.angleTo(Ci);bi+Bn<ai+wi;){var la=((bi+=Bn)-ai)/wi,ya=Pr(Ci.x,Ai.x,la),Di=Pr(Ci.y,Ai.y,la);if(ya>=0&&ya<zr&&Di>=0&&Di<zr&&bi-Kr>=0&&bi+Kr<=Wr){var ca=new Al(ya,Di,ha,hi);ca._round(),Nn&&!df(fn,ca,Jn,Nn,Gn)||_i.push(ca)}}ai+=wi}return kr||_i.length||tr||(_i=Wt(fn,ai/2,Bn,Nn,Gn,Jn,tr,!0,zr)),_i}(A,$t?O/2*Ve%O:(xt/2+2*we)*ze*Ve%O,O,ht,Y,Ut,$t,!1,nt)}function yf(A,O,Y,ie,me){for(var we=[],ze=0;ze<A.length;ze++)for(var Ve=A[ze],nt=void 0,ht=0;ht<Ve.length-1;ht++){var xt=Ve[ht],Ut=Ve[ht+1];xt.x<O&&Ut.x<O||(xt.x<O?xt=new n(O,xt.y+(O-xt.x)/(Ut.x-xt.x)*(Ut.y-xt.y))._round():Ut.x<O&&(Ut=new n(O,xt.y+(O-xt.x)/(Ut.x-xt.x)*(Ut.y-xt.y))._round()),xt.y<Y&&Ut.y<Y||(xt.y<Y?xt=new n(xt.x+(Y-xt.y)/(Ut.y-xt.y)*(Ut.x-xt.x),Y)._round():Ut.y<Y&&(Ut=new n(xt.x+(Y-xt.y)/(Ut.y-xt.y)*(Ut.x-xt.x),Y)._round()),xt.x>=ie&&Ut.x>=ie||(xt.x>=ie?xt=new n(ie,xt.y+(ie-xt.x)/(Ut.x-xt.x)*(Ut.y-xt.y))._round():Ut.x>=ie&&(Ut=new n(ie,xt.y+(ie-xt.x)/(Ut.x-xt.x)*(Ut.y-xt.y))._round()),xt.y>=me&&Ut.y>=me||(xt.y>=me?xt=new n(xt.x+(me-xt.y)/(Ut.y-xt.y)*(Ut.x-xt.x),me)._round():Ut.y>=me&&(Ut=new n(xt.x+(me-xt.y)/(Ut.y-xt.y)*(Ut.x-xt.x),me)._round()),nt&&xt.equals(nt[nt.length-1])||we.push(nt=[xt]),nt.push(Ut)))))}return we}function xf(A,O,Y,ie){var me=[],we=A.image,ze=we.pixelRatio,Ve=we.paddedRect.w-2,nt=we.paddedRect.h-2,ht=A.right-A.left,xt=A.bottom-A.top,Ut=we.stretchX||[[0,Ve]],$t=we.stretchY||[[0,nt]],Wt=function(ca,Da){return ca+Da[1]-Da[0]},fn=Ut.reduce(Wt,0),An=$t.reduce(Wt,0),Bn=Ve-fn,Nn=nt-An,Gn=0,Jn=fn,tr=0,kr=An,zr=0,Kr=Bn,Wr=0,ai=Nn;if(we.content&&ie){var bi=we.content;Gn=_c(Ut,0,bi[0]),tr=_c($t,0,bi[1]),Jn=_c(Ut,bi[0],bi[2]),kr=_c($t,bi[1],bi[3]),zr=bi[0]-Gn,Wr=bi[1]-tr,Kr=bi[2]-bi[0]-Jn,ai=bi[3]-bi[1]-kr}var _i=function(ca,Da,Ea,Ya){var La=wc(ca.stretch-Gn,Jn,ht,A.left),Co=Tc(ca.fixed-zr,Kr,ca.stretch,fn),Za=wc(Da.stretch-tr,kr,xt,A.top),Wo=Tc(Da.fixed-Wr,ai,Da.stretch,An),Fo=wc(Ea.stretch-Gn,Jn,ht,A.left),Uo=Tc(Ea.fixed-zr,Kr,Ea.stretch,fn),os=wc(Ya.stretch-tr,kr,xt,A.top),$o=Tc(Ya.fixed-Wr,ai,Ya.stretch,An),Eo=new n(La,Za),Vo=new n(Fo,Za),bo=new n(Fo,os),Po=new n(La,os),Ki=new n(Co/ze,Wo/ze),ma=new n(Uo/ze,$o/ze),io=O*Math.PI/180;if(io){var ao=Math.sin(io),to=Math.cos(io),Ga=[to,-ao,ao,to];Eo._matMult(Ga),Vo._matMult(Ga),Po._matMult(Ga),bo._matMult(Ga)}var ba=ca.stretch+ca.fixed,ss=Da.stretch+Da.fixed;return{tl:Eo,tr:Vo,bl:Po,br:bo,tex:{x:we.paddedRect.x+1+ba,y:we.paddedRect.y+1+ss,w:Ea.stretch+Ea.fixed-ba,h:Ya.stretch+Ya.fixed-ss},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ki,pixelOffsetBR:ma,minFontScaleX:Kr/ze/ht,minFontScaleY:ai/ze/xt,isSDF:Y}};if(ie&&(we.stretchX||we.stretchY))for(var hi=bf(Ut,Bn,fn),Ci=bf($t,Nn,An),Ai=0;Ai<hi.length-1;Ai++)for(var wi=hi[Ai],ha=hi[Ai+1],la=0;la<Ci.length-1;la++)me.push(_i(wi,Ci[la],ha,Ci[la+1]));else me.push(_i({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Ve+1},{fixed:0,stretch:nt+1}));return me}function _c(A,O,Y){for(var ie=0,me=0,we=A;me<we.length;me+=1){var ze=we[me];ie+=Math.max(O,Math.min(Y,ze[1]))-Math.max(O,Math.min(Y,ze[0]))}return ie}function bf(A,O,Y){for(var ie=[{fixed:-1,stretch:0}],me=0,we=A;me<we.length;me+=1){var ze=we[me],Ve=ze[0],nt=ze[1],ht=ie[ie.length-1];ie.push({fixed:Ve-ht.stretch,stretch:ht.stretch}),ie.push({fixed:Ve-ht.stretch,stretch:ht.stretch+(nt-Ve)})}return ie.push({fixed:O+1,stretch:Y}),ie}function wc(A,O,Y,ie){return A/O*Y+ie}function Tc(A,O,Y,ie){return A-O*Y/ie}var kc=function(A,O,Y,ie,me,we,ze,Ve,nt,ht){if(this.boxStartIndex=A.length,nt){var xt=we.top,Ut=we.bottom,$t=we.collisionPadding;$t&&(xt-=$t[1],Ut+=$t[3]);var Wt=Ut-xt;Wt>0&&(Wt=Math.max(10,Wt),this.circleDiameter=Wt)}else{var fn=we.top*ze-Ve,An=we.bottom*ze+Ve,Bn=we.left*ze-Ve,Nn=we.right*ze+Ve,Gn=we.collisionPadding;if(Gn&&(Bn-=Gn[0]*ze,fn-=Gn[1]*ze,Nn+=Gn[2]*ze,An+=Gn[3]*ze),ht){var Jn=new n(Bn,fn),tr=new n(Nn,fn),kr=new n(Bn,An),zr=new n(Nn,An),Kr=ht*Math.PI/180;Jn._rotate(Kr),tr._rotate(Kr),kr._rotate(Kr),zr._rotate(Kr),Bn=Math.min(Jn.x,tr.x,kr.x,zr.x),Nn=Math.max(Jn.x,tr.x,kr.x,zr.x),fn=Math.min(Jn.y,tr.y,kr.y,zr.y),An=Math.max(Jn.y,tr.y,kr.y,zr.y)}A.emplaceBack(O.x,O.y,Bn,fn,Nn,An,Y,ie,me)}this.boxEndIndex=A.length},Ml=function(A,O){if(void 0===A&&(A=[]),void 0===O&&(O=up),this.data=A,this.length=this.data.length,this.compare=O,this.length>0)for(var Y=(this.length>>1)-1;Y>=0;Y--)this._down(Y)};function up(A,O){return A<O?-1:A>O?1:0}function fp(A,O,Y){void 0===O&&(O=1),void 0===Y&&(Y=!1);for(var ie=1/0,me=1/0,we=-1/0,ze=-1/0,Ve=A[0],nt=0;nt<Ve.length;nt++){var ht=Ve[nt];(!nt||ht.x<ie)&&(ie=ht.x),(!nt||ht.y<me)&&(me=ht.y),(!nt||ht.x>we)&&(we=ht.x),(!nt||ht.y>ze)&&(ze=ht.y)}var $t=Math.min(we-ie,ze-me),Wt=$t/2,fn=new Ml([],hp);if(0===$t)return new n(ie,me);for(var An=ie;An<we;An+=$t)for(var Bn=me;Bn<ze;Bn+=$t)fn.push(new Sl(An+Wt,Bn+Wt,Wt,A));for(var Nn=function(tr){for(var kr=0,zr=0,Kr=0,Wr=tr[0],ai=0,bi=Wr.length,_i=bi-1;ai<bi;_i=ai++){var hi=Wr[ai],Ci=Wr[_i],Ai=hi.x*Ci.y-Ci.x*hi.y;zr+=(hi.x+Ci.x)*Ai,Kr+=(hi.y+Ci.y)*Ai,kr+=3*Ai}return new Sl(zr/kr,Kr/kr,0,tr)}(A),Gn=fn.length;fn.length;){var Jn=fn.pop();(Jn.d>Nn.d||!Nn.d)&&(Nn=Jn,Y&&console.log("found best %d after %d probes",Math.round(1e4*Jn.d)/1e4,Gn)),Jn.max-Nn.d<=O||(fn.push(new Sl(Jn.p.x-(Wt=Jn.h/2),Jn.p.y-Wt,Wt,A)),fn.push(new Sl(Jn.p.x+Wt,Jn.p.y-Wt,Wt,A)),fn.push(new Sl(Jn.p.x-Wt,Jn.p.y+Wt,Wt,A)),fn.push(new Sl(Jn.p.x+Wt,Jn.p.y+Wt,Wt,A)),Gn+=4)}return Y&&(console.log("num probes: "+Gn),console.log("best distance: "+Nn.d)),Nn.p}function hp(A,O){return O.max-A.max}function Sl(A,O,Y,ie){this.p=new n(A,O),this.h=Y,this.d=function(me,we){for(var ze=!1,Ve=1/0,nt=0;nt<we.length;nt++)for(var ht=we[nt],xt=0,Ut=ht.length,$t=Ut-1;xt<Ut;$t=xt++){var Wt=ht[xt],fn=ht[$t];Wt.y>me.y!=fn.y>me.y&&me.x<(fn.x-Wt.x)*(me.y-Wt.y)/(fn.y-Wt.y)+Wt.x&&(ze=!ze),Ve=Math.min(Ve,Gs(me,Wt,fn))}return(ze?1:-1)*Math.sqrt(Ve)}(this.p,ie),this.max=this.d+this.h*Math.SQRT2}Ml.prototype.push=function(A){this.data.push(A),this.length++,this._up(this.length-1)},Ml.prototype.pop=function(){if(0!==this.length){var A=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),A}},Ml.prototype.peek=function(){return this.data[0]},Ml.prototype._up=function(A){for(var O=this.data,Y=this.compare,ie=O[A];A>0;){var me=A-1>>1,we=O[me];if(Y(ie,we)>=0)break;O[A]=we,A=me}O[A]=ie},Ml.prototype._down=function(A){for(var O=this.data,Y=this.compare,ie=this.length>>1,me=O[A];A<ie;){var we=1+(A<<1),ze=O[we],Ve=we+1;if(Ve<this.length&&Y(O[Ve],ze)<0&&(we=Ve,ze=O[Ve]),Y(ze,me)>=0)break;O[A]=ze,A=we}O[A]=me};var pu=Number.POSITIVE_INFINITY;function _f(A,O){return O[1]!==pu?function(Y,ie,me){var we=0,ze=0;switch(ie=Math.abs(ie),me=Math.abs(me),Y){case"top-right":case"top-left":case"top":ze=me-7;break;case"bottom-right":case"bottom-left":case"bottom":ze=7-me}switch(Y){case"top-right":case"bottom-right":case"right":we=-ie;break;case"top-left":case"bottom-left":case"left":we=ie}return[we,ze]}(A,O[0],O[1]):function(Y,ie){var me=0,we=0;ie<0&&(ie=0);var ze=ie/Math.sqrt(2);switch(Y){case"top-right":case"top-left":we=ze-7;break;case"bottom-right":case"bottom-left":we=7-ze;break;case"bottom":we=7-ie;break;case"top":we=ie-7}switch(Y){case"top-right":case"bottom-right":me=-ze;break;case"top-left":case"bottom-left":me=ze;break;case"left":me=ie;break;case"right":me=-ie}return[me,we]}(A,O[0])}function du(A){switch(A){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wf(A,O,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn){var An=function(tr,kr,zr,Kr,Wr,ai,bi,_i){for(var hi=Kr.layout.get("text-rotate").evaluate(ai,{})*Math.PI/180,Ci=[],Ai=0,wi=kr.positionedLines;Ai<wi.length;Ai+=1)for(var ha=wi[Ai],la=0,ya=ha.positionedGlyphs;la<ya.length;la+=1){var Di=ya[la];if(Di.rect){var ca=Di.rect||{},Da=4,Ea=!0,Ya=1,La=0,Co=(Wr||_i)&&Di.vertical,Za=Di.metrics.advance*Di.scale/2;if(_i&&kr.verticalizable&&(La=ha.lineOffset/2-(Di.imageName?-(24-Di.metrics.width*Di.scale)/2:24*(Di.scale-1))),Di.imageName){var Uo=bi[Di.imageName];Ea=Uo.sdf,Da=1/(Ya=Uo.pixelRatio)}var os=Wr?[Di.x+Za,Di.y]:[0,0],$o=Wr?[0,0]:[Di.x+Za+zr[0],Di.y+zr[1]-La],Eo=[0,0];Co&&(Eo=$o,$o=[0,0]);var Vo=(Di.metrics.left-Da)*Di.scale-Za+$o[0],bo=(-Di.metrics.top-Da)*Di.scale+$o[1],Po=Vo+ca.w*Di.scale/Ya,Ki=bo+ca.h*Di.scale/Ya,ma=new n(Vo,bo),io=new n(Po,bo),ao=new n(Vo,Ki),to=new n(Po,Ki);if(Co){var Ga=new n(-Za,Za- -17),ba=-Math.PI/2,oo=12-Za,xs=new n(22-oo,-(Di.imageName?oo:0)),es=new(Function.prototype.bind.apply(n,[null].concat(Eo)));ma._rotateAround(ba,Ga)._add(xs)._add(es),io._rotateAround(ba,Ga)._add(xs)._add(es),ao._rotateAround(ba,Ga)._add(xs)._add(es),to._rotateAround(ba,Ga)._add(xs)._add(es)}if(hi){var Rs=Math.sin(hi),Qs=Math.cos(hi),No=[Qs,-Rs,Rs,Qs];ma._matMult(No),io._matMult(No),ao._matMult(No),to._matMult(No)}var Fs=new n(0,0),Ns=new n(0,0);Ci.push({tl:ma,tr:io,bl:ao,br:to,tex:ca,writingMode:kr.writingMode,glyphOffset:os,sectionIndex:Di.sectionIndex,isSDF:Ea,pixelOffsetTL:Fs,pixelOffsetBR:Ns,minFontScaleX:0,minFontScaleY:0})}}return Ci}(0,Y,Ve,me,we,ze,ie,A.allowVerticalPlacement),Bn=A.textSizeData,Nn=null;"source"===Bn.kind?(Nn=[128*me.layout.get("text-size").evaluate(ze,{})])[0]>32640&&M(A.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Bn.kind&&((Nn=[128*Wt.compositeTextSizes[0].evaluate(ze,{},fn),128*Wt.compositeTextSizes[1].evaluate(ze,{},fn)])[0]>32640||Nn[1]>32640)&&M(A.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),A.addSymbols(A.text,An,Nn,Ve,we,ze,ht,O,nt.lineStartIndex,nt.lineLength,$t,fn);for(var Gn=0,Jn=xt;Gn<Jn.length;Gn+=1)Ut[Jn[Gn]]=A.text.placedSymbolArray.length-1;return 4*An.length}function Tf(A){for(var O in A)return A[O];return null}function pp(A,O,Y,ie){var me=A.compareText;if(O in me){for(var we=me[O],ze=we.length-1;ze>=0;ze--)if(ie.dist(we[ze])<Y)return!0}else me[O]=[];return me[O].push(ie),!1}var dp=_l.VectorTileFeature.types,mp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ac(A,O,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut,$t){var Wt=Ve?Math.min(32640,Math.round(Ve[0])):0,fn=Ve?Math.min(32640,Math.round(Ve[1])):0;A.emplaceBack(O,Y,Math.round(32*ie),Math.round(32*me),we,ze,(Wt<<1)+(nt?1:0),fn,16*ht,16*xt,256*Ut,256*$t)}function mu(A,O,Y){A.emplaceBack(O.x,O.y,Y),A.emplaceBack(O.x,O.y,Y),A.emplaceBack(O.x,O.y,Y),A.emplaceBack(O.x,O.y,Y)}function gp(A){for(var O=0,Y=A.sections;O<Y.length;O+=1)if(gi(Y[O].text))return!0;return!1}var Cl=function(A){this.layoutVertexArray=new Be,this.indexArray=new Or,this.programConfigurations=A,this.segments=new jt,this.dynamicLayoutVertexArray=new Ft,this.opacityVertexArray=new Tn,this.placedSymbolArray=new Ue};Cl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Cl.prototype.upload=function(A,O,Y,ie){this.isEmpty()||(Y&&(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,cu.members),this.indexBuffer=A.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=A.createVertexBuffer(this.dynamicLayoutVertexArray,qh.members,!0),this.opacityVertexBuffer=A.createVertexBuffer(this.opacityVertexArray,mp,!0),this.opacityVertexBuffer.itemSize=1),(Y||ie)&&this.programConfigurations.upload(A))},Cl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},nr("SymbolBuffers",Cl);var ec=function(A,O,Y){this.layoutVertexArray=new A,this.layoutAttributes=O,this.indexArray=new Y,this.segments=new jt,this.collisionVertexArray=new ur};ec.prototype.upload=function(A){this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=A.createVertexBuffer(this.collisionVertexArray,Hh.members,!0)},ec.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},nr("CollisionBuffers",ec);var wa=function(A){this.collisionBoxArray=A.collisionBoxArray,this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(ze){return ze.id}),this.index=A.index,this.pixelRatio=A.pixelRatio,this.sourceLayerIndex=A.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Hl([]),this.placementViewportMatrix=Hl([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hu(this.zoom,O["text-size"]),this.iconSizeData=hu(this.zoom,O["icon-size"]);var Y=this.layers[0].layout,ie=Y.get("symbol-sort-key"),me=Y.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==me&&void 0!==ie.constantOr(1),this.sortFeaturesByY=("viewport-y"===me||"auto"===me&&!this.sortFeaturesByKey)&&(Y.get("text-allow-overlap")||Y.get("icon-allow-overlap")||Y.get("text-ignore-placement")||Y.get("icon-ignore-placement")),"point"===Y.get("symbol-placement")&&(this.writingModes=Y.get("text-writing-mode").map(function(ze){return Ts[ze]})),this.stateDependentLayerIds=this.layers.filter(function(ze){return ze.isStateDependent()}).map(function(ze){return ze.id}),this.sourceID=A.sourceID};wa.prototype.createArrays=function(){this.text=new Cl(new Ca(cu.members,this.layers,this.zoom,function(A){return/^text/.test(A)})),this.icon=new Cl(new Ca(cu.members,this.layers,this.zoom,function(A){return/^icon/.test(A)})),this.glyphOffsetArray=new _t,this.lineVertexArray=new Ct,this.symbolInstances=new it},wa.prototype.calculateGlyphDependencies=function(A,O,Y,ie,me){for(var we=0;we<A.length;we++)if(O[A.charCodeAt(we)]=!0,(Y||ie)&&me){var ze=Ql[A.charAt(we)];ze&&(O[ze.charCodeAt(0)]=!0)}},wa.prototype.populate=function(A,O,Y){var ie=this.layers[0],me=ie.layout,we=me.get("text-font"),ze=me.get("text-field"),Ve=me.get("icon-image"),nt=("constant"!==ze.value.kind||ze.value.value instanceof mn&&!ze.value.value.isEmpty()||ze.value.value.toString().length>0)&&("constant"!==we.value.kind||we.value.value.length>0),ht="constant"!==Ve.value.kind||!!Ve.value.value||Object.keys(Ve.parameters).length>0,xt=me.get("symbol-sort-key");if(this.features=[],nt||ht){for(var Ut=O.iconDependencies,$t=O.glyphDependencies,Wt=O.availableImages,fn=new fa(this.zoom),An=0,Bn=A;An<Bn.length;An+=1){var Nn=Bn[An],Gn=Nn.feature,Jn=Nn.id,tr=Nn.index,kr=Nn.sourceLayerIndex,zr=ie._featureFilter.needGeometry,Kr={type:Gn.type,id:Jn,properties:Gn.properties,geometry:zr?Oa(Gn):[]};if(ie._featureFilter.filter(fn,Kr,Y)){zr||(Kr.geometry=Oa(Gn));var Wr=void 0;if(nt){var ai=ie.getValueAndResolveTokens("text-field",Kr,Y,Wt),bi=mn.factory(ai);gp(bi)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===eo()||this.hasRTLText&&xo.isParsed())&&(Wr=Zh(bi,ie,Kr))}var _i=void 0;if(ht){var hi=ie.getValueAndResolveTokens("icon-image",Kr,Y,Wt);_i=hi instanceof _n?hi:_n.fromString(hi)}if(Wr||_i){var Ci=this.sortFeaturesByKey?xt.evaluate(Kr,{},Y):void 0,Ai={id:Jn,text:Wr,icon:_i,index:tr,sourceLayerIndex:kr,geometry:Oa(Gn),properties:Gn.properties,type:dp[Gn.type],sortKey:Ci};if(this.features.push(Ai),_i&&(Ut[_i.name]=!0),Wr){var wi=we.evaluate(Kr,{},Y).join(","),ha="map"===me.get("text-rotation-alignment")&&"point"!==me.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ts.vertical)>=0;for(var la=0,ya=Wr.sections;la<ya.length;la+=1){var Di=ya[la];if(Di.image)Ut[Di.image.name]=!0;else{var ca=Wi(Wr.toString()),Da=Di.fontStack||wi,Ea=$t[Da]=$t[Da]||{};this.calculateGlyphDependencies(Di.text,Ea,ha,this.allowVerticalPlacement,ca)}}}}}}"line"===me.get("symbol-placement")&&(this.features=function(Ya){var La={},Co={},Za=[],Wo=0;function Fo(to){Za.push(Ya[to]),Wo++}function Uo(to,Ga,ba){var oo=Co[to];return delete Co[to],Co[Ga]=oo,Za[oo].geometry[0].pop(),Za[oo].geometry[0]=Za[oo].geometry[0].concat(ba[0]),oo}function os(to,Ga,ba){var oo=La[Ga];return delete La[Ga],La[to]=oo,Za[oo].geometry[0].shift(),Za[oo].geometry[0]=ba[0].concat(Za[oo].geometry[0]),oo}function $o(to,Ga,ba){var oo=ba?Ga[0][Ga[0].length-1]:Ga[0][0];return to+":"+oo.x+":"+oo.y}for(var Eo=0;Eo<Ya.length;Eo++){var Vo=Ya[Eo],bo=Vo.geometry,Po=Vo.text?Vo.text.toString():null;if(Po){var Ki=$o(Po,bo),ma=$o(Po,bo,!0);if(Ki in Co&&ma in La&&Co[Ki]!==La[ma]){var io=os(Ki,ma,bo),ao=Uo(Ki,ma,Za[io].geometry);delete La[Ki],delete Co[ma],Co[$o(Po,Za[ao].geometry,!0)]=ao,Za[io].geometry=null}else Ki in Co?Uo(Ki,ma,bo):ma in La?os(Ki,ma,bo):(Fo(Eo),La[Ki]=Wo-1,Co[ma]=Wo-1)}else Fo(Eo)}return Za.filter(function(to){return to.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ya,La){return Ya.sortKey-La.sortKey})}},wa.prototype.update=function(A,O,Y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(A,O,this.layers,Y),this.icon.programConfigurations.updatePaintArrays(A,O,this.layers,Y))},wa.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},wa.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},wa.prototype.upload=function(A){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(A),this.iconCollisionBox.upload(A)),this.text.upload(A,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(A,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},wa.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},wa.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},wa.prototype.addToLineVertexArray=function(A,O){var Y=this.lineVertexArray.length;if(void 0!==A.segment){for(var ie=A.dist(O[A.segment+1]),me=A.dist(O[A.segment]),we={},ze=A.segment+1;ze<O.length;ze++)we[ze]={x:O[ze].x,y:O[ze].y,tileUnitDistanceFromAnchor:ie},ze<O.length-1&&(ie+=O[ze+1].dist(O[ze]));for(var Ve=A.segment||0;Ve>=0;Ve--)we[Ve]={x:O[Ve].x,y:O[Ve].y,tileUnitDistanceFromAnchor:me},Ve>0&&(me+=O[Ve-1].dist(O[Ve]));for(var nt=0;nt<O.length;nt++){var ht=we[nt];this.lineVertexArray.emplaceBack(ht.x,ht.y,ht.tileUnitDistanceFromAnchor)}}return{lineStartIndex:Y,lineLength:this.lineVertexArray.length-Y}},wa.prototype.addSymbols=function(A,O,Y,ie,me,we,ze,Ve,nt,ht,xt,Ut){for(var $t=A.indexArray,Wt=A.layoutVertexArray,fn=A.segments.prepareSegment(4*O.length,Wt,$t,we.sortKey),An=this.glyphOffsetArray.length,Bn=fn.vertexLength,Nn=this.allowVerticalPlacement&&ze===Ts.vertical?Math.PI/2:0,Gn=we.text&&we.text.sections,Jn=0;Jn<O.length;Jn++){var tr=O[Jn],kr=tr.tl,zr=tr.tr,Kr=tr.bl,Wr=tr.br,ai=tr.tex,bi=tr.pixelOffsetTL,_i=tr.pixelOffsetBR,hi=tr.minFontScaleX,Ci=tr.minFontScaleY,Ai=tr.glyphOffset,wi=tr.isSDF,ha=tr.sectionIndex,la=fn.vertexLength,ya=Ai[1];Ac(Wt,Ve.x,Ve.y,kr.x,ya+kr.y,ai.x,ai.y,Y,wi,bi.x,bi.y,hi,Ci),Ac(Wt,Ve.x,Ve.y,zr.x,ya+zr.y,ai.x+ai.w,ai.y,Y,wi,_i.x,bi.y,hi,Ci),Ac(Wt,Ve.x,Ve.y,Kr.x,ya+Kr.y,ai.x,ai.y+ai.h,Y,wi,bi.x,_i.y,hi,Ci),Ac(Wt,Ve.x,Ve.y,Wr.x,ya+Wr.y,ai.x+ai.w,ai.y+ai.h,Y,wi,_i.x,_i.y,hi,Ci),mu(A.dynamicLayoutVertexArray,Ve,Nn),$t.emplaceBack(la,la+1,la+2),$t.emplaceBack(la+1,la+2,la+3),fn.vertexLength+=4,fn.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ai[0]),Jn!==O.length-1&&ha===O[Jn+1].sectionIndex||A.programConfigurations.populatePaintArrays(Wt.length,we,we.index,{},Ut,Gn&&Gn[ha])}A.placedSymbolArray.emplaceBack(Ve.x,Ve.y,An,this.glyphOffsetArray.length-An,Bn,nt,ht,Ve.segment,Y?Y[0]:0,Y?Y[1]:0,ie[0],ie[1],ze,0,!1,0,xt)},wa.prototype._addCollisionDebugVertex=function(A,O,Y,ie,me,we){return O.emplaceBack(0,0),A.emplaceBack(Y.x,Y.y,ie,me,Math.round(we.x),Math.round(we.y))},wa.prototype.addCollisionDebugVertices=function(A,O,Y,ie,me,we,ze){var Ve=me.segments.prepareSegment(4,me.layoutVertexArray,me.indexArray),nt=Ve.vertexLength,ht=me.layoutVertexArray,xt=me.collisionVertexArray,Ut=ze.anchorX,$t=ze.anchorY;this._addCollisionDebugVertex(ht,xt,we,Ut,$t,new n(A,O)),this._addCollisionDebugVertex(ht,xt,we,Ut,$t,new n(Y,O)),this._addCollisionDebugVertex(ht,xt,we,Ut,$t,new n(Y,ie)),this._addCollisionDebugVertex(ht,xt,we,Ut,$t,new n(A,ie)),Ve.vertexLength+=4;var Wt=me.indexArray;Wt.emplaceBack(nt,nt+1),Wt.emplaceBack(nt+1,nt+2),Wt.emplaceBack(nt+2,nt+3),Wt.emplaceBack(nt+3,nt),Ve.primitiveLength+=4},wa.prototype.addDebugCollisionBoxes=function(A,O,Y,ie){for(var me=A;me<O;me++){var we=this.collisionBoxArray.get(me);this.addCollisionDebugVertices(we.x1,we.y1,we.x2,we.y2,ie?this.textCollisionBox:this.iconCollisionBox,we.anchorPoint,Y)}},wa.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ec(or,ef.members,F),this.iconCollisionBox=new ec(or,ef.members,F);for(var A=0;A<this.symbolInstances.length;A++){var O=this.symbolInstances.get(A);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},wa.prototype._deserializeCollisionBoxesForSymbol=function(A,O,Y,ie,me,we,ze,Ve,nt){for(var ht={},xt=O;xt<Y;xt++){var Ut=A.get(xt);ht.textBox={x1:Ut.x1,y1:Ut.y1,x2:Ut.x2,y2:Ut.y2,anchorPointX:Ut.anchorPointX,anchorPointY:Ut.anchorPointY},ht.textFeatureIndex=Ut.featureIndex;break}for(var $t=ie;$t<me;$t++){var Wt=A.get($t);ht.verticalTextBox={x1:Wt.x1,y1:Wt.y1,x2:Wt.x2,y2:Wt.y2,anchorPointX:Wt.anchorPointX,anchorPointY:Wt.anchorPointY},ht.verticalTextFeatureIndex=Wt.featureIndex;break}for(var fn=we;fn<ze;fn++){var An=A.get(fn);ht.iconBox={x1:An.x1,y1:An.y1,x2:An.x2,y2:An.y2,anchorPointX:An.anchorPointX,anchorPointY:An.anchorPointY},ht.iconFeatureIndex=An.featureIndex;break}for(var Bn=Ve;Bn<nt;Bn++){var Nn=A.get(Bn);ht.verticalIconBox={x1:Nn.x1,y1:Nn.y1,x2:Nn.x2,y2:Nn.y2,anchorPointX:Nn.anchorPointX,anchorPointY:Nn.anchorPointY},ht.verticalIconFeatureIndex=Nn.featureIndex;break}return ht},wa.prototype.deserializeCollisionBoxes=function(A){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var Y=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(A,Y.textBoxStartIndex,Y.textBoxEndIndex,Y.verticalTextBoxStartIndex,Y.verticalTextBoxEndIndex,Y.iconBoxStartIndex,Y.iconBoxEndIndex,Y.verticalIconBoxStartIndex,Y.verticalIconBoxEndIndex))}},wa.prototype.hasTextData=function(){return this.text.segments.get().length>0},wa.prototype.hasIconData=function(){return this.icon.segments.get().length>0},wa.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},wa.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},wa.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},wa.prototype.addIndicesForPlacedSymbol=function(A,O){for(var Y=A.placedSymbolArray.get(O),ie=Y.vertexStartIndex+4*Y.numGlyphs,me=Y.vertexStartIndex;me<ie;me+=4)A.indexArray.emplaceBack(me,me+1,me+2),A.indexArray.emplaceBack(me+1,me+2,me+3)},wa.prototype.getSortedSymbolIndexes=function(A){if(this.sortedAngle===A&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var O=Math.sin(A),Y=Math.cos(A),ie=[],me=[],we=[],ze=0;ze<this.symbolInstances.length;++ze){we.push(ze);var Ve=this.symbolInstances.get(ze);ie.push(0|Math.round(O*Ve.anchorX+Y*Ve.anchorY)),me.push(Ve.featureIndex)}return we.sort(function(nt,ht){return ie[nt]-ie[ht]||me[ht]-me[nt]}),we},wa.prototype.addToSortKeyRanges=function(A,O){var Y=this.sortKeyRanges[this.sortKeyRanges.length-1];Y&&Y.sortKey===O?Y.symbolInstanceEnd=A+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:A,symbolInstanceEnd:A+1})},wa.prototype.sortFeatures=function(A){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==A&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(A),this.sortedAngle=A,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var Y=0,ie=this.symbolInstanceIndexes;Y<ie.length;Y+=1){var we=this.symbolInstances.get(ie[Y]);this.featureSortOrder.push(we.featureIndex),[we.rightJustifiedTextSymbolIndex,we.centerJustifiedTextSymbolIndex,we.leftJustifiedTextSymbolIndex].forEach(function(ze,Ve,nt){ze>=0&&nt.indexOf(ze)===Ve&&O.addIndicesForPlacedSymbol(O.text,ze)}),we.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,we.verticalPlacedTextSymbolIndex),we.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,we.placedIconSymbolIndex),we.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,we.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},nr("SymbolBucket",wa,{omit:["layers","collisionBoxArray","features","compareText"]}),wa.MAX_GLYPHS=65535,wa.addDynamicAttributes=mu;var vp=new Oo({"symbol-placement":new Ti(be.layout_symbol["symbol-placement"]),"symbol-spacing":new Ti(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ti(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Li(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ti(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ti(be.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ti(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ti(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ti(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new Li(be.layout_symbol["icon-size"]),"icon-text-fit":new Ti(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ti(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new Li(be.layout_symbol["icon-image"]),"icon-rotate":new Li(be.layout_symbol["icon-rotate"]),"icon-padding":new Ti(be.layout_symbol["icon-padding"]),"icon-keep-upright":new Ti(be.layout_symbol["icon-keep-upright"]),"icon-offset":new Li(be.layout_symbol["icon-offset"]),"icon-anchor":new Li(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ti(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ti(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ti(be.layout_symbol["text-rotation-alignment"]),"text-field":new Li(be.layout_symbol["text-field"]),"text-font":new Li(be.layout_symbol["text-font"]),"text-size":new Li(be.layout_symbol["text-size"]),"text-max-width":new Li(be.layout_symbol["text-max-width"]),"text-line-height":new Ti(be.layout_symbol["text-line-height"]),"text-letter-spacing":new Li(be.layout_symbol["text-letter-spacing"]),"text-justify":new Li(be.layout_symbol["text-justify"]),"text-radial-offset":new Li(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ti(be.layout_symbol["text-variable-anchor"]),"text-anchor":new Li(be.layout_symbol["text-anchor"]),"text-max-angle":new Ti(be.layout_symbol["text-max-angle"]),"text-writing-mode":new Ti(be.layout_symbol["text-writing-mode"]),"text-rotate":new Li(be.layout_symbol["text-rotate"]),"text-padding":new Ti(be.layout_symbol["text-padding"]),"text-keep-upright":new Ti(be.layout_symbol["text-keep-upright"]),"text-transform":new Li(be.layout_symbol["text-transform"]),"text-offset":new Li(be.layout_symbol["text-offset"]),"text-allow-overlap":new Ti(be.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ti(be.layout_symbol["text-ignore-placement"]),"text-optional":new Ti(be.layout_symbol["text-optional"])}),gu={paint:new Oo({"icon-opacity":new Li(be.paint_symbol["icon-opacity"]),"icon-color":new Li(be.paint_symbol["icon-color"]),"icon-halo-color":new Li(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new Li(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Li(be.paint_symbol["icon-halo-blur"]),"icon-translate":new Ti(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ti(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new Li(be.paint_symbol["text-opacity"]),"text-color":new Li(be.paint_symbol["text-color"],{runtimeType:St,getOverride:function(A){return A.textColor},hasOverride:function(A){return!!A.textColor}}),"text-halo-color":new Li(be.paint_symbol["text-halo-color"]),"text-halo-width":new Li(be.paint_symbol["text-halo-width"]),"text-halo-blur":new Li(be.paint_symbol["text-halo-blur"]),"text-translate":new Ti(be.paint_symbol["text-translate"]),"text-translate-anchor":new Ti(be.paint_symbol["text-translate-anchor"])}),layout:vp},El=function(A){this.type=A.property.overrides?A.property.overrides.runtimeType:Ot,this.defaultValue=A};El.prototype.evaluate=function(A){if(A.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(A.formattedSection))return O.getOverride(A.formattedSection)}return A.feature&&A.featureState?this.defaultValue.evaluate(A.feature,A.featureState):this.defaultValue.property.specification.default},El.prototype.eachChild=function(A){this.defaultValue.isConstant()||A(this.defaultValue.value._styleExpression.expression)},El.prototype.outputDefined=function(){return!1},El.prototype.serialize=function(){return null},nr("FormatSectionOverride",El,{omit:["defaultValue"]});var yp=function(A){function O(Y){A.call(this,Y,gu)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.recalculate=function(Y,ie){if(A.prototype.recalculate.call(this,Y,ie),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var me=this.layout.get("text-writing-mode");if(me){for(var we=[],ze=0,Ve=me;ze<Ve.length;ze+=1){var nt=Ve[ze];we.indexOf(nt)<0&&we.push(nt)}this.layout._values["text-writing-mode"]=we}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(Y,ie,me,we){var nt,ze=this.layout.get(Y).evaluate(ie,{},me,we),Ve=this._unevaluatedLayout._values[Y];return Ve.isDataDriven()||rn(Ve.value)||!ze?ze:(nt=ie.properties,ze.replace(/{([^{}]+)}/g,function(xt,Ut){return Ut in nt?String(nt[Ut]):""}))},O.prototype.createBucket=function(Y){return new wa(Y)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var Y=0,ie=gu.paint.overridableProperties;Y<ie.length;Y+=1){var me=ie[Y];if(O.hasPaintOverride(this.layout,me)){var nt,we=this.paint.get(me),ze=new El(we),Ve=new tn(ze,we.property.specification);nt="constant"===we.value.kind||"source"===we.value.kind?new un("source",Ve):new xn("composite",Ve,we.value.zoomStops,we.value._interpolationType),this.paint._values[me]=new Ua(we.property,nt,we.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(Y,ie,me){return!(!this.layout||ie.isDataDriven()||me.isDataDriven())&&O.hasPaintOverride(this.layout,Y)},O.hasPaintOverride=function(Y,ie){var me=Y.get("text-field"),we=gu.paint.properties[ie],ze=!1,Ve=function(xt){for(var Ut=0,$t=xt;Ut<$t.length;Ut+=1)if(we.overrides&&we.overrides.hasOverride($t[Ut]))return void(ze=!0)};if("constant"===me.value.kind&&me.value.value instanceof mn)Ve(me.value.value.sections);else if("source"===me.value.kind){var nt=function(xt){ze||(xt instanceof br&&qn(xt.value)===st?Ve(xt.value.sections):xt instanceof Sr?Ve(xt.sections):xt.eachChild(nt))},ht=me.value;ht._styleExpression&&nt(ht._styleExpression.expression)}return ze},O}(Zo),xp={paint:new Oo({"background-color":new Ti(be.paint_background["background-color"]),"background-pattern":new Ps(be.paint_background["background-pattern"]),"background-opacity":new Ti(be.paint_background["background-opacity"])})},bp=function(A){function O(Y){A.call(this,Y,xp)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Zo),_p={paint:new Oo({"raster-opacity":new Ti(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ti(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ti(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ti(be.paint_raster["raster-brightness-max"]),"raster-saturation":new Ti(be.paint_raster["raster-saturation"]),"raster-contrast":new Ti(be.paint_raster["raster-contrast"]),"raster-resampling":new Ti(be.paint_raster["raster-resampling"]),"raster-fade-duration":new Ti(be.paint_raster["raster-fade-duration"])})},wp=function(A){function O(Y){A.call(this,Y,_p)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Zo),Tp=function(A){function O(Y){A.call(this,Y,{}),this.implementation=Y}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},O.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(Y){this.implementation.onAdd&&this.implementation.onAdd(Y,Y.painter.context.gl)},O.prototype.onRemove=function(Y){this.implementation.onRemove&&this.implementation.onRemove(Y,Y.painter.context.gl)},O}(Zo),kp={circle:ch,heatmap:fh,hillshade:ph,fill:Eh,"fill-extrusion":Nh,line:Vh,symbol:yp,background:bp,raster:wp},kf=self.HTMLImageElement,Af=self.HTMLCanvasElement,Mf=self.HTMLVideoElement,Sf=self.ImageData,Mc=self.ImageBitmap,hl=function(A,O,Y,ie){this.context=A,this.format=Y,this.texture=A.gl.createTexture(),this.update(O,ie)};hl.prototype.update=function(A,O,Y){var ie=A.width,me=A.height,we=!(this.size&&this.size[0]===ie&&this.size[1]===me||Y),ze=this.context,Ve=ze.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),Ve.bindTexture(Ve.TEXTURE_2D,this.texture),ze.pixelStoreUnpackFlipY.set(!1),ze.pixelStoreUnpack.set(1),ze.pixelStoreUnpackPremultiplyAlpha.set(this.format===Ve.RGBA&&(!O||!1!==O.premultiply)),we)this.size=[ie,me],A instanceof kf||A instanceof Af||A instanceof Mf||A instanceof Sf||Mc&&A instanceof Mc?Ve.texImage2D(Ve.TEXTURE_2D,0,this.format,this.format,Ve.UNSIGNED_BYTE,A):Ve.texImage2D(Ve.TEXTURE_2D,0,this.format,ie,me,0,this.format,Ve.UNSIGNED_BYTE,A.data);else{var nt=Y||{x:0,y:0},ht=nt.x,xt=nt.y;A instanceof kf||A instanceof Af||A instanceof Mf||A instanceof Sf||Mc&&A instanceof Mc?Ve.texSubImage2D(Ve.TEXTURE_2D,0,ht,xt,Ve.RGBA,Ve.UNSIGNED_BYTE,A):Ve.texSubImage2D(Ve.TEXTURE_2D,0,ht,xt,ie,me,Ve.RGBA,Ve.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Ve.generateMipmap(Ve.TEXTURE_2D)},hl.prototype.bind=function(A,O,Y){var ie=this.context.gl;ie.bindTexture(ie.TEXTURE_2D,this.texture),Y!==ie.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(Y=ie.LINEAR),A!==this.filter&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,A),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,Y||A),this.filter=A),O!==this.wrap&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,O),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,O),this.wrap=O)},hl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},hl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var vu=function(A){var O=this;this._callback=A,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};vu.prototype.trigger=function(){var A=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){A._triggered=!1,A._callback()},0))},vu.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ll=function(A,O,Y){this.target=A,this.parent=O,this.mapId=Y,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},h(["receive","process"],this),this.invoker=new vu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?A:self};function Cf(A,O,Y){var ie=2*Math.PI*6378137/256/Math.pow(2,Y);return[A*ie-2*Math.PI*6378137/2,O*ie-2*Math.PI*6378137/2]}Ll.prototype.send=function(A,O,Y,ie,me){var we=this;void 0===me&&(me=!1);var ze=Math.round(1e18*Math.random()).toString(36).substring(0,10);Y&&(this.callbacks[ze]=Y);var Ve=D(this.globalScope)?void 0:[];return this.target.postMessage({id:ze,type:A,hasCallback:!!Y,targetMapId:ie,mustQueue:me,sourceMapId:this.mapId,data:di(O,Ve)},Ve),{cancel:function(){Y&&delete we.callbacks[ze],we.target.postMessage({id:ze,type:"<cancel>",targetMapId:ie,sourceMapId:we.mapId})}}},Ll.prototype.receive=function(A){var O=A.data,Y=O.id;if(Y&&(!O.targetMapId||this.mapId===O.targetMapId))if("<cancel>"===O.type){delete this.tasks[Y];var ie=this.cancelCallbacks[Y];delete this.cancelCallbacks[Y],ie&&ie()}else S()||O.mustQueue?(this.tasks[Y]=O,this.taskQueue.push(Y),this.invoker.trigger()):this.processTask(Y,O)},Ll.prototype.process=function(){if(this.taskQueue.length){var A=this.taskQueue.shift(),O=this.tasks[A];delete this.tasks[A],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(A,O)}},Ll.prototype.processTask=function(A,O){var Y=this;if("<response>"===O.type){var ie=this.callbacks[A];delete this.callbacks[A],ie&&(O.error?ie(Pi(O.error)):ie(null,Pi(O.data)))}else{var me=!1,we=D(this.globalScope)?void 0:[],ze=O.hasCallback?function(xt,Ut){me=!0,delete Y.cancelCallbacks[A],Y.target.postMessage({id:A,type:"<response>",sourceMapId:Y.mapId,error:xt?di(xt):null,data:di(Ut,we)},we)}:function(xt){me=!0},Ve=null,nt=Pi(O.data);if(this.parent[O.type])Ve=this.parent[O.type](O.sourceMapId,nt,ze);else if(this.parent.getWorkerSource){var ht=O.type.split(".");Ve=this.parent.getWorkerSource(O.sourceMapId,ht[0],nt.source)[ht[1]](nt,ze)}else ze(new Error("Could not find function "+O.type));!me&&Ve&&Ve.cancel&&(this.cancelCallbacks[A]=Ve.cancel)}},Ll.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Mo=function(A,O){A&&(O?this.setSouthWest(A).setNorthEast(O):4===A.length?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1]))};Mo.prototype.setNorthEast=function(A){return this._ne=A instanceof Ha?new Ha(A.lng,A.lat):Ha.convert(A),this},Mo.prototype.setSouthWest=function(A){return this._sw=A instanceof Ha?new Ha(A.lng,A.lat):Ha.convert(A),this},Mo.prototype.extend=function(A){var O,Y,ie=this._sw,me=this._ne;if(A instanceof Ha)O=A,Y=A;else{if(!(A instanceof Mo))return Array.isArray(A)?4===A.length||A.every(Array.isArray)?this.extend(Mo.convert(A)):this.extend(Ha.convert(A)):this;if(Y=A._ne,!(O=A._sw)||!Y)return this}return ie||me?(ie.lng=Math.min(O.lng,ie.lng),ie.lat=Math.min(O.lat,ie.lat),me.lng=Math.max(Y.lng,me.lng),me.lat=Math.max(Y.lat,me.lat)):(this._sw=new Ha(O.lng,O.lat),this._ne=new Ha(Y.lng,Y.lat)),this},Mo.prototype.getCenter=function(){return new Ha((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Mo.prototype.getSouthWest=function(){return this._sw},Mo.prototype.getNorthEast=function(){return this._ne},Mo.prototype.getNorthWest=function(){return new Ha(this.getWest(),this.getNorth())},Mo.prototype.getSouthEast=function(){return new Ha(this.getEast(),this.getSouth())},Mo.prototype.getWest=function(){return this._sw.lng},Mo.prototype.getSouth=function(){return this._sw.lat},Mo.prototype.getEast=function(){return this._ne.lng},Mo.prototype.getNorth=function(){return this._ne.lat},Mo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Mo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Mo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Mo.prototype.contains=function(A){var O=Ha.convert(A),Y=O.lng,ie=O.lat,we=this._sw.lng<=Y&&Y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(we=this._sw.lng>=Y&&Y>=this._ne.lng),this._sw.lat<=ie&&ie<=this._ne.lat&&we},Mo.convert=function(A){return!A||A instanceof Mo?A:new Mo(A)};var Ha=function(A,O){if(isNaN(A)||isNaN(O))throw new Error("Invalid LngLat object: ("+A+", "+O+")");if(this.lng=+A,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ha.prototype.wrap=function(){return new Ha(l(this.lng,-180,180),this.lat)},Ha.prototype.toArray=function(){return[this.lng,this.lat]},Ha.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ha.prototype.distanceTo=function(A){var O=Math.PI/180,Y=this.lat*O,ie=A.lat*O,me=Math.sin(Y)*Math.sin(ie)+Math.cos(Y)*Math.cos(ie)*Math.cos((A.lng-this.lng)*O);return 6371008.8*Math.acos(Math.min(me,1))},Ha.prototype.toBounds=function(A){void 0===A&&(A=0);var O=360*A/40075017,Y=O/Math.cos(Math.PI/180*this.lat);return new Mo(new Ha(this.lng-Y,this.lat-O),new Ha(this.lng+Y,this.lat+O))},Ha.convert=function(A){if(A instanceof Ha)return A;if(Array.isArray(A)&&(2===A.length||3===A.length))return new Ha(Number(A[0]),Number(A[1]));if(!Array.isArray(A)&&"object"==typeof A&&null!==A)return new Ha(Number("lng"in A?A.lng:A.lon),Number(A.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ef=2*Math.PI*6371008.8;function Lf(A){return Ef*Math.cos(A*Math.PI/180)}function zf(A){return(180+A)/360}function Pf(A){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+A*Math.PI/360)))/360}function Of(A,O){return A/Lf(O)}function yu(A){return 360/Math.PI*Math.atan(Math.exp((180-360*A)*Math.PI/180))-90}var pl=function(A,O,Y){void 0===Y&&(Y=0),this.x=+A,this.y=+O,this.z=+Y};pl.fromLngLat=function(A,O){void 0===O&&(O=0);var Y=Ha.convert(A);return new pl(zf(Y.lng),Pf(Y.lat),Of(O,Y.lat))},pl.prototype.toLngLat=function(){return new Ha(360*this.x-180,yu(this.y))},pl.prototype.toAltitude=function(){return this.z*Lf(yu(this.y))},pl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ef*(A=yu(this.y),1/Math.cos(A*Math.PI/180));var A};var dl=function(A,O,Y){this.z=A,this.x=O,this.y=Y,this.key=tc(0,A,A,O,Y)};dl.prototype.equals=function(A){return this.z===A.z&&this.x===A.x&&this.y===A.y},dl.prototype.url=function(A,O){var Y,ie,me,we,ze,Ve=(ie=this.y,me=this.z,we=Cf(256*(Y=this.x),256*(ie=Math.pow(2,me)-ie-1),me),ze=Cf(256*(Y+1),256*(ie+1),me),we[0]+","+we[1]+","+ze[0]+","+ze[1]),nt=function(ht,xt,Ut){for(var $t,Wt="",fn=ht;fn>0;fn--)Wt+=(xt&($t=1<<fn-1)?1:0)+(Ut&$t?2:0);return Wt}(this.z,this.x,this.y);return A[(this.x+this.y)%A.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===O?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",nt).replace("{bbox-epsg-3857}",Ve)},dl.prototype.getTilePoint=function(A){var O=Math.pow(2,this.z);return new n(8192*(A.x*O-this.x),8192*(A.y*O-this.y))},dl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var If=function(A,O){this.wrap=A,this.canonical=O,this.key=tc(A,O.z,O.z,O.x,O.y)},So=function(A,O,Y,ie,me){this.overscaledZ=A,this.wrap=O,this.canonical=new dl(Y,+ie,+me),this.key=tc(O,A,Y,ie,me)};function tc(A,O,Y,ie,me){(A*=2)<0&&(A=-1*A-1);var we=1<<Y;return(we*we*A+we*me+ie).toString(36)+Y.toString(36)+O.toString(36)}So.prototype.equals=function(A){return this.overscaledZ===A.overscaledZ&&this.wrap===A.wrap&&this.canonical.equals(A.canonical)},So.prototype.scaledTo=function(A){var O=this.canonical.z-A;return A>this.canonical.z?new So(A,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new So(A,this.wrap,A,this.canonical.x>>O,this.canonical.y>>O)},So.prototype.calculateScaledKey=function(A,O){var Y=this.canonical.z-A;return A>this.canonical.z?tc(this.wrap*+O,A,this.canonical.z,this.canonical.x,this.canonical.y):tc(this.wrap*+O,A,A,this.canonical.x>>Y,this.canonical.y>>Y)},So.prototype.isChildOf=function(A){if(A.wrap!==this.wrap)return!1;var O=this.canonical.z-A.canonical.z;return 0===A.overscaledZ||A.overscaledZ<this.overscaledZ&&A.canonical.x===this.canonical.x>>O&&A.canonical.y===this.canonical.y>>O},So.prototype.children=function(A){if(this.overscaledZ>=A)return[new So(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,Y=2*this.canonical.x,ie=2*this.canonical.y;return[new So(O,this.wrap,O,Y,ie),new So(O,this.wrap,O,Y+1,ie),new So(O,this.wrap,O,Y,ie+1),new So(O,this.wrap,O,Y+1,ie+1)]},So.prototype.isLessThan=function(A){return this.wrap<A.wrap||!(this.wrap>A.wrap)&&(this.overscaledZ<A.overscaledZ||!(this.overscaledZ>A.overscaledZ)&&(this.canonical.x<A.canonical.x||!(this.canonical.x>A.canonical.x)&&this.canonical.y<A.canonical.y))},So.prototype.wrapped=function(){return new So(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},So.prototype.unwrapTo=function(A){return new So(this.overscaledZ,A,this.canonical.z,this.canonical.x,this.canonical.y)},So.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},So.prototype.toUnwrapped=function(){return new If(this.wrap,this.canonical)},So.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},So.prototype.getTilePoint=function(A){return this.canonical.getTilePoint(new pl(A.x-this.wrap,A.y))},nr("CanonicalTileID",dl),nr("OverscaledTileID",So,{omit:["posMatrix"]});var Ws=function(A,O,Y){if(this.uid=A,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(Y&&"mapbox"!==Y&&"terrarium"!==Y)return M('"'+Y+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var ie=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=Y||"mapbox";for(var me=0;me<ie;me++)this.data[this._idx(-1,me)]=this.data[this._idx(0,me)],this.data[this._idx(ie,me)]=this.data[this._idx(ie-1,me)],this.data[this._idx(me,-1)]=this.data[this._idx(me,0)],this.data[this._idx(me,ie)]=this.data[this._idx(me,ie-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ie,-1)]=this.data[this._idx(ie-1,0)],this.data[this._idx(-1,ie)]=this.data[this._idx(0,ie-1)],this.data[this._idx(ie,ie)]=this.data[this._idx(ie-1,ie-1)]};Ws.prototype.get=function(A,O){var Y=new Uint8Array(this.data.buffer),ie=4*this._idx(A,O);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(Y[ie],Y[ie+1],Y[ie+2])},Ws.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ws.prototype._idx=function(A,O){if(A<-1||A>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(A+1)},Ws.prototype._unpackMapbox=function(A,O,Y){return(256*A*256+256*O+Y)/10-1e4},Ws.prototype._unpackTerrarium=function(A,O,Y){return 256*A+O+Y/256-32768},Ws.prototype.getPixels=function(){return new hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ws.prototype.backfillBorder=function(A,O,Y){if(this.dim!==A.dim)throw new Error("dem dimension mismatch");var ie=O*this.dim,me=O*this.dim+this.dim,we=Y*this.dim,ze=Y*this.dim+this.dim;switch(O){case-1:ie=me-1;break;case 1:me=ie+1}switch(Y){case-1:we=ze-1;break;case 1:ze=we+1}for(var Ve=-O*this.dim,nt=-Y*this.dim,ht=we;ht<ze;ht++)for(var xt=ie;xt<me;xt++)this.data[this._idx(xt,ht)]=A.data[this._idx(xt+Ve,ht+nt)]},nr("DEMData",Ws);var Sc=function(A){this._stringToNumber={},this._numberToString=[];for(var O=0;O<A.length;O++){var Y=A[O];this._stringToNumber[Y]=O,this._numberToString[O]=Y}};Sc.prototype.encode=function(A){return this._stringToNumber[A]},Sc.prototype.decode=function(A){return this._numberToString[A]};var Cc=function(A,O,Y,ie,me){this.type="Feature",this._vectorTileFeature=A,A._z=O,A._x=Y,A._y=ie,this.properties=A.properties,this.id=me},xu={geometry:{configurable:!0}};xu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},xu.geometry.set=function(A){this._geometry=A},Cc.prototype.toJSON=function(){var A={geometry:this.geometry};for(var O in this)"_geometry"!==O&&"_vectorTileFeature"!==O&&(A[O]=this[O]);return A},Object.defineProperties(Cc.prototype,xu);var zl=function(){this.state={},this.stateChanges={},this.deletedStates={}};zl.prototype.updateState=function(A,O,Y){var ie=String(O);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][ie]=this.stateChanges[A][ie]||{},o(this.stateChanges[A][ie],Y),null===this.deletedStates[A])for(var me in this.deletedStates[A]={},this.state[A])me!==ie&&(this.deletedStates[A][me]=null);else if(this.deletedStates[A]&&null===this.deletedStates[A][ie])for(var we in this.deletedStates[A][ie]={},this.state[A][ie])Y[we]||(this.deletedStates[A][ie][we]=null);else for(var ze in Y)this.deletedStates[A]&&this.deletedStates[A][ie]&&null===this.deletedStates[A][ie][ze]&&delete this.deletedStates[A][ie][ze]},zl.prototype.removeFeatureState=function(A,O,Y){if(null!==this.deletedStates[A]){var ie=String(O);if(this.deletedStates[A]=this.deletedStates[A]||{},Y&&void 0!==O)null!==this.deletedStates[A][ie]&&(this.deletedStates[A][ie]=this.deletedStates[A][ie]||{},this.deletedStates[A][ie][Y]=null);else if(void 0!==O)if(this.stateChanges[A]&&this.stateChanges[A][ie])for(Y in this.deletedStates[A][ie]={},this.stateChanges[A][ie])this.deletedStates[A][ie][Y]=null;else this.deletedStates[A][ie]=null;else this.deletedStates[A]=null}},zl.prototype.getState=function(A,O){var Y=String(O),we=o({},(this.state[A]||{})[Y],(this.stateChanges[A]||{})[Y]);if(null===this.deletedStates[A])return{};if(this.deletedStates[A]){var ze=this.deletedStates[A][O];if(null===ze)return{};for(var Ve in ze)delete we[Ve]}return we},zl.prototype.initializeTileState=function(A,O){A.setFeatureState(this.state,O)},zl.prototype.coalesceChanges=function(A,O){var Y={};for(var ie in this.stateChanges){this.state[ie]=this.state[ie]||{};var me={};for(var we in this.stateChanges[ie])this.state[ie][we]||(this.state[ie][we]={}),o(this.state[ie][we],this.stateChanges[ie][we]),me[we]=this.state[ie][we];Y[ie]=me}for(var ze in this.deletedStates){this.state[ze]=this.state[ze]||{};var Ve={};if(null===this.deletedStates[ze])for(var nt in this.state[ze])Ve[nt]={},this.state[ze][nt]={};else for(var ht in this.deletedStates[ze]){if(null===this.deletedStates[ze][ht])this.state[ze][ht]={};else for(var xt=0,Ut=Object.keys(this.deletedStates[ze][ht]);xt<Ut.length;xt+=1)delete this.state[ze][ht][Ut[xt]];Ve[ht]=this.state[ze][ht]}Y[ze]=Y[ze]||{},o(Y[ze],Ve)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(Y).length)for(var Wt in A)A[Wt].setFeatureState(Y,O)};var Js=function(A,O){this.tileID=A,this.x=A.canonical.x,this.y=A.canonical.y,this.z=A.canonical.z,this.grid=new xr(8192,16,0),this.grid3D=new xr(8192,16,0),this.featureIndexArray=new Et,this.promoteId=O};function Df(A,O,Y,ie,me){return b(A,function(we,ze){var Ve=O instanceof is?O.get(ze):null;return Ve&&Ve.evaluate?Ve.evaluate(Y,ie,me):Ve})}function Rf(A){for(var O=1/0,Y=1/0,ie=-1/0,me=-1/0,we=0,ze=A;we<ze.length;we+=1){var Ve=ze[we];O=Math.min(O,Ve.x),Y=Math.min(Y,Ve.y),ie=Math.max(ie,Ve.x),me=Math.max(me,Ve.y)}return{minX:O,minY:Y,maxX:ie,maxY:me}}function Ap(A,O){return O-A}Js.prototype.insert=function(A,O,Y,ie,me,we){var ze=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Y,ie,me);for(var Ve=we?this.grid3D:this.grid,nt=0;nt<O.length;nt++){for(var ht=O[nt],xt=[1/0,1/0,-1/0,-1/0],Ut=0;Ut<ht.length;Ut++){var $t=ht[Ut];xt[0]=Math.min(xt[0],$t.x),xt[1]=Math.min(xt[1],$t.y),xt[2]=Math.max(xt[2],$t.x),xt[3]=Math.max(xt[3],$t.y)}xt[0]<8192&&xt[1]<8192&&xt[2]>=0&&xt[3]>=0&&Ve.insert(ze,xt[0],xt[1],xt[2],xt[3])}},Js.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new _l.VectorTile(new gc(this.rawTileData)).layers,this.sourceLayerCoder=new Sc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Js.prototype.query=function(A,O,Y,ie){var me=this;this.loadVTLayers();for(var we=A.params||{},ze=8192/A.tileSize/A.scale,Ve=Ni(we.filter),nt=A.queryGeometry,ht=A.queryPadding*ze,xt=Rf(nt),Ut=this.grid.query(xt.minX-ht,xt.minY-ht,xt.maxX+ht,xt.maxY+ht),$t=Rf(A.cameraQueryGeometry),fn=0,An=this.grid3D.query($t.minX-ht,$t.minY-ht,$t.maxX+ht,$t.maxY+ht,function(kr,zr,Kr,Wr){return function(ai,bi,_i,hi,Ci){for(var Ai=0,wi=ai;Ai<wi.length;Ai+=1){var ha=wi[Ai];if(bi<=ha.x&&_i<=ha.y&&hi>=ha.x&&Ci>=ha.y)return!0}var la=[new n(bi,_i),new n(bi,Ci),new n(hi,Ci),new n(hi,_i)];if(ai.length>2)for(var ya=0,Di=la;ya<Di.length;ya+=1)if(vs(ai,Di[ya]))return!0;for(var ca=0;ca<ai.length-1;ca++)if(cl(ai[ca],ai[ca+1],la))return!0;return!1}(A.cameraQueryGeometry,kr-ht,zr-ht,Kr+ht,Wr+ht)});fn<An.length;fn+=1)Ut.push(An[fn]);Ut.sort(Ap);for(var Nn,Gn={},Jn=function(kr){var zr=Ut[kr];if(zr!==Nn){Nn=zr;var Kr=me.featureIndexArray.get(zr),Wr=null;me.loadMatchingFeature(Gn,Kr.bucketIndex,Kr.sourceLayerIndex,Kr.featureIndex,Ve,we.layers,we.availableImages,O,Y,ie,function(ai,bi,_i){return Wr||(Wr=Oa(ai)),bi.queryIntersectsFeature(nt,ai,_i,Wr,me.z,A.transform,ze,A.pixelPosMatrix)})}},tr=0;tr<Ut.length;tr++)Jn(tr);return Gn},Js.prototype.loadMatchingFeature=function(A,O,Y,ie,me,we,ze,Ve,nt,ht,xt){var Ut=this.bucketLayerIDs[O];if(!we||function(Kr,Wr){for(var ai=0;ai<Kr.length;ai++)if(Wr.indexOf(Kr[ai])>=0)return!0;return!1}(we,Ut)){var $t=this.sourceLayerCoder.decode(Y),Wt=this.vtLayers[$t].feature(ie);if(me.filter(new fa(this.tileID.overscaledZ),Wt))for(var fn=this.getId(Wt,$t),An=0;An<Ut.length;An++){var Bn=Ut[An];if(!(we&&we.indexOf(Bn)<0)){var Nn=Ve[Bn];if(Nn){var Gn={};void 0!==fn&&ht&&(Gn=ht.getState(Nn.sourceLayer||"_geojsonTileLayer",fn));var Jn=nt[Bn];Jn.paint=Df(Jn.paint,Nn.paint,Wt,Gn,ze),Jn.layout=Df(Jn.layout,Nn.layout,Wt,Gn,ze);var tr=!xt||xt(Wt,Nn,Gn);if(tr){var kr=new Cc(Wt,this.z,this.x,this.y,fn);kr.layer=Jn;var zr=A[Bn];void 0===zr&&(zr=A[Bn]=[]),zr.push({featureIndex:ie,feature:kr,intersectionZ:tr})}}}}}},Js.prototype.lookupSymbolFeatures=function(A,O,Y,ie,me,we,ze,Ve){var nt={};this.loadVTLayers();for(var ht=Ni(me),xt=0,Ut=A;xt<Ut.length;xt+=1)this.loadMatchingFeature(nt,Y,ie,Ut[xt],ht,we,ze,Ve,O);return nt},Js.prototype.hasLayer=function(A){for(var O=0,Y=this.bucketLayerIDs;O<Y.length;O+=1)for(var ie=0,me=Y[O];ie<me.length;ie+=1)if(A===me[ie])return!0;return!1},Js.prototype.getId=function(A,O){var Y=A.id;return this.promoteId&&"boolean"==typeof(Y=A.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[O]])&&(Y=Number(Y)),Y},nr("FeatureIndex",Js,{omit:["rawTileData","sourceLayerCoder"]});var Ro=function(A,O){this.tileID=A,this.uid=u(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ro.prototype.registerFadeDuration=function(A){var O=A+this.timeAdded;O<N.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},Ro.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ro.prototype.loadVectorData=function(A,O,Y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){for(var ie in A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(ht,xt){var Ut={};if(!xt)return Ut;for(var $t=function(){var An=fn[Wt],Bn=An.layerIds.map(function(tr){return xt.getLayer(tr)}).filter(Boolean);if(0!==Bn.length){An.layers=Bn,An.stateDependentLayerIds&&(An.stateDependentLayers=An.stateDependentLayerIds.map(function(tr){return Bn.filter(function(kr){return kr.id===tr})[0]}));for(var Nn=0,Gn=Bn;Nn<Gn.length;Nn+=1)Ut[Gn[Nn].id]=An}},Wt=0,fn=ht;Wt<fn.length;Wt+=1)$t();return Ut}(A.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var me=this.buckets[ie];if(me instanceof wa){if(this.hasSymbolBuckets=!0,!Y)break;me.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var we in this.buckets){var ze=this.buckets[we];if(ze instanceof wa&&ze.hasRTLText){this.hasRTLText=!0,xo.isLoading()||xo.isLoaded()||"deferred"!==eo()||pa();break}}for(var Ve in this.queryPadding=0,this.buckets){var nt=this.buckets[Ve];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(Ve).queryRadius(nt))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new ke},Ro.prototype.unloadVectorData=function(){for(var A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ro.prototype.getBucket=function(A){return this.buckets[A.id]},Ro.prototype.upload=function(A){for(var O in this.buckets){var Y=this.buckets[O];Y.uploadPending()&&Y.upload(A)}var ie=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hl(A,this.imageAtlas.image,ie.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hl(A,this.glyphAtlasImage,ie.ALPHA),this.glyphAtlasImage=null)},Ro.prototype.prepare=function(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)},Ro.prototype.queryRenderedFeatures=function(A,O,Y,ie,me,we,ze,Ve,nt,ht){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ie,cameraQueryGeometry:me,scale:we,tileSize:this.tileSize,pixelPosMatrix:ht,transform:Ve,params:ze,queryPadding:this.queryPadding*nt},A,O,Y):{}},Ro.prototype.querySourceFeatures=function(A,O){var Y=this.latestFeatureIndex;if(Y&&Y.rawTileData){var ie=Y.loadVTLayers(),me=O?O.sourceLayer:"",we=ie._geojsonTileLayer||ie[me];if(we)for(var ze=Ni(O&&O.filter),Ve=this.tileID.canonical,nt=Ve.z,ht=Ve.x,xt=Ve.y,Ut={z:nt,x:ht,y:xt},$t=0;$t<we.length;$t++){var Wt=we.feature($t);if(ze.filter(new fa(this.tileID.overscaledZ),Wt)){var fn=Y.getId(Wt,me),An=new Cc(Wt,nt,ht,xt,fn);An.tile=Ut,A.push(An)}}}},Ro.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ro.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ro.prototype.setExpiryData=function(A){var O=this.expirationTime;if(A.cacheControl){var Y=C(A.cacheControl);Y["max-age"]&&(this.expirationTime=Date.now()+1e3*Y["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){var ie=Date.now(),me=!1;if(this.expirationTime>ie)me=!1;else if(O)if(this.expirationTime<O)me=!0;else{var we=this.expirationTime-O;we?this.expirationTime=ie+Math.max(we,3e4):me=!0}else me=!0;me?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ro.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ro.prototype.setFeatureState=function(A,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(A).length){var Y=this.latestFeatureIndex.loadVTLayers();for(var ie in this.buckets)if(O.style.hasLayer(ie)){var me=this.buckets[ie],we=me.layers[0].sourceLayer||"_geojsonTileLayer",ze=Y[we],Ve=A[we];if(ze&&Ve&&0!==Object.keys(Ve).length){me.update(Ve,ze,this.imageAtlas&&this.imageAtlas.patternPositions||{});var nt=O&&O.style&&O.style.getLayer(ie);nt&&(this.queryPadding=Math.max(this.queryPadding,nt.queryRadius(me)))}}}},Ro.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Ro.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},Ro.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ro.prototype.setHoldDuration=function(A){this.symbolFadeHoldUntil=N.now()+A},Ro.prototype.setDependencies=function(A,O){for(var Y={},ie=0,me=O;ie<me.length;ie+=1)Y[me[ie]]=!0;this.dependencies[A]=Y},Ro.prototype.hasDependency=function(A,O){for(var Y=0,ie=A;Y<ie.length;Y+=1){var we=this.dependencies[ie[Y]];if(we)for(var ze=0,Ve=O;ze<Ve.length;ze+=1)if(we[Ve[ze]])return!0}return!1};var rl=self.performance,Ff=function(A){this._marks={start:[A.url,"start"].join("#"),end:[A.url,"end"].join("#"),measure:A.url.toString()},rl.mark(this._marks.start)};Ff.prototype.finish=function(){rl.mark(this._marks.end);var A=rl.getEntriesByName(this._marks.measure);return 0===A.length&&(rl.measure(this._marks.measure,this._marks.start,this._marks.end),A=rl.getEntriesByName(this._marks.measure),rl.clearMarks(this._marks.start),rl.clearMarks(this._marks.end),rl.clearMeasures(this._marks.measure)),A},e.Actor=Ll,e.AlphaImage=fl,e.CanonicalTileID=dl,e.CollisionBoxArray=ke,e.Color=nn,e.DEMData=Ws,e.DataConstantProperty=Ti,e.DictionaryCoder=Sc,e.EXTENT=8192,e.ErrorEvent=Ye,e.EvaluationParameters=fa,e.Event=je,e.Evented=he,e.FeatureIndex=Js,e.FillBucket=Is,e.FillExtrusionBucket=Ds,e.ImageAtlas=$l,e.ImagePosition=yc,e.LineBucket=ps,e.LngLat=Ha,e.LngLatBounds=Mo,e.MercatorCoordinate=pl,e.ONE_EM=24,e.OverscaledTileID=So,e.Point=n,e.Point$1=n,e.Properties=Oo,e.Protobuf=gc,e.RGBAImage=hs,e.RequestManager=ae,e.RequestPerformance=Ff,e.ResourceType=wt,e.SegmentVector=jt,e.SourceFeatureState=zl,e.StructArrayLayout1ui2=H,e.StructArrayLayout2f1f2i16=vr,e.StructArrayLayout2i4=us,e.StructArrayLayout3ui6=Or,e.StructArrayLayout4i8=Na,e.SymbolBucket=wa,e.Texture=hl,e.Tile=Ro,e.Transitionable=rs,e.Uniform1f=Wn,e.Uniform1i=xi,e.Uniform2f=Rr,e.Uniform3f=oi,e.Uniform4f=ti,e.UniformColor=vi,e.UniformMatrix4f=ji,e.UnwrappedTileID=If,e.ValidationError=Fe,e.WritingMode=Ts,e.ZoomHistory=Vi,e.add=function(A,O,Y){return A[0]=O[0]+Y[0],A[1]=O[1]+Y[1],A[2]=O[2]+Y[2],A},e.addDynamicAttributes=mu,e.asyncAll=function(A,O,Y){if(!A.length)return Y(null,[]);var ie=A.length,me=new Array(A.length),we=null;A.forEach(function(ze,Ve){O(ze,function(nt,ht){nt&&(we=nt),me[Ve]=ht,0==--ie&&Y(we,me)})})},e.bezier=p,e.bindAll=h,e.browser=N,e.cacheEntryPossiblyAdded=function(A){++tt>Ie&&(A.getActor().send("enforceCacheSizeLimit",Oe),tt=0)},e.clamp=f,e.clearTileCache=function(A){var O=self.caches.delete("mapbox-tiles");A&&O.catch(A).then(function(){return A()})},e.clipLine=yf,e.clone=function(A){var O=new fs(16);return O[0]=A[0],O[1]=A[1],O[2]=A[2],O[3]=A[3],O[4]=A[4],O[5]=A[5],O[6]=A[6],O[7]=A[7],O[8]=A[8],O[9]=A[9],O[10]=A[10],O[11]=A[11],O[12]=A[12],O[13]=A[13],O[14]=A[14],O[15]=A[15],O},e.clone$1=T,e.clone$2=function(A){var O=new fs(3);return O[0]=A[0],O[1]=A[1],O[2]=A[2],O},e.collisionCircleLayout=Yh,e.config=U,e.create=function(){var A=new fs(16);return fs!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0),A[0]=1,A[5]=1,A[10]=1,A[15]=1,A},e.create$1=function(){var A=new fs(9);return fs!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A},e.create$2=function(){var A=new fs(4);return fs!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A},e.createCommonjsModule=r,e.createExpression=Qt,e.createLayout=da,e.createStyleLayer=function(A){return"custom"===A.type?new Tp(A):new kp[A.type](A)},e.cross=function(A,O,Y){var ie=O[0],me=O[1],we=O[2],ze=Y[0],Ve=Y[1],nt=Y[2];return A[0]=me*nt-we*Ve,A[1]=we*ze-ie*nt,A[2]=ie*Ve-me*ze,A},e.deepEqual=function A(O,Y){if(Array.isArray(O)){if(!Array.isArray(Y)||O.length!==Y.length)return!1;for(var ie=0;ie<O.length;ie++)if(!A(O[ie],Y[ie]))return!1;return!0}if("object"==typeof O&&null!==O&&null!==Y){if("object"!=typeof Y||Object.keys(O).length!==Object.keys(Y).length)return!1;for(var me in O)if(!A(O[me],Y[me]))return!1;return!0}return O===Y},e.dot=function(A,O){return A[0]*O[0]+A[1]*O[1]+A[2]*O[2]},e.dot$1=function(A,O){return A[0]*O[0]+A[1]*O[1]+A[2]*O[2]+A[3]*O[3]},e.ease=s,e.emitValidationErrors=Ir,e.endsWith=_,e.enforceCacheSizeLimit=function(A){Qe(),Te&&Te.then(function(O){O.keys().then(function(Y){for(var ie=0;ie<Y.length-A;ie++)O.delete(Y[ie])})})},e.evaluateSizeForFeature=hf,e.evaluateSizeForZoom=pf,e.evaluateVariableOffset=_f,e.evented=Pa,e.extend=o,e.featureFilter=Ni,e.filterObject=w,e.fromRotation=function(A,O){var Y=Math.sin(O),ie=Math.cos(O);return A[0]=ie,A[1]=Y,A[2]=0,A[3]=-Y,A[4]=ie,A[5]=0,A[6]=0,A[7]=0,A[8]=1,A},e.getAnchorAlignment=fu,e.getAnchorJustification=du,e.getArrayBuffer=yt,e.getImage=Jt,e.getJSON=function(A,O){return et(o(A,{type:"json"}),O)},e.getRTLTextPluginStatus=eo,e.getReferrer=gt,e.getVideo=function(A,O){var Y,ie,me=self.document.createElement("video");me.muted=!0,me.onloadstart=function(){O(null,me)};for(var we=0;we<A.length;we++){var ze=self.document.createElement("source");Y=A[we],ie=void 0,(ie=self.document.createElement("a")).href=Y,(ie.protocol!==self.document.location.protocol||ie.host!==self.document.location.host)&&(me.crossOrigin="Anonymous"),ze.src=A[we],me.appendChild(ze)}return{cancel:function(){}}},e.identity=Hl,e.invert=function(A,O){var Y=O[0],ie=O[1],me=O[2],we=O[3],ze=O[4],Ve=O[5],nt=O[6],ht=O[7],xt=O[8],Ut=O[9],$t=O[10],Wt=O[11],fn=O[12],An=O[13],Bn=O[14],Nn=O[15],Gn=Y*Ve-ie*ze,Jn=Y*nt-me*ze,tr=Y*ht-we*ze,kr=ie*nt-me*Ve,zr=ie*ht-we*Ve,Kr=me*ht-we*nt,Wr=xt*An-Ut*fn,ai=xt*Bn-$t*fn,bi=xt*Nn-Wt*fn,_i=Ut*Bn-$t*An,hi=Ut*Nn-Wt*An,Ci=$t*Nn-Wt*Bn,Ai=Gn*Ci-Jn*hi+tr*_i+kr*bi-zr*ai+Kr*Wr;return Ai?(A[0]=(Ve*Ci-nt*hi+ht*_i)*(Ai=1/Ai),A[1]=(me*hi-ie*Ci-we*_i)*Ai,A[2]=(An*Kr-Bn*zr+Nn*kr)*Ai,A[3]=($t*zr-Ut*Kr-Wt*kr)*Ai,A[4]=(nt*bi-ze*Ci-ht*ai)*Ai,A[5]=(Y*Ci-me*bi+we*ai)*Ai,A[6]=(Bn*tr-fn*Kr-Nn*Jn)*Ai,A[7]=(xt*Kr-$t*tr+Wt*Jn)*Ai,A[8]=(ze*hi-Ve*bi+ht*Wr)*Ai,A[9]=(ie*bi-Y*hi-we*Wr)*Ai,A[10]=(fn*zr-An*tr+Nn*Gn)*Ai,A[11]=(Ut*tr-xt*zr-Wt*Gn)*Ai,A[12]=(Ve*ai-ze*_i-nt*Wr)*Ai,A[13]=(Y*_i-ie*ai+me*Wr)*Ai,A[14]=(An*Jn-fn*kr-Bn*Gn)*Ai,A[15]=(xt*kr-Ut*Jn+$t*Gn)*Ai,A):null},e.isChar=Br,e.isMapboxURL=ce,e.keysDifference=function(A,O){var Y=[];for(var ie in A)ie in O||Y.push(ie);return Y},e.makeRequest=et,e.mapObject=b,e.mercatorXfromLng=zf,e.mercatorYfromLat=Pf,e.mercatorZfromAltitude=Of,e.mul=Jc,e.multiply=ul,e.mvt=_l,e.normalize=function(A,O){var Y=O[0],ie=O[1],me=O[2],we=Y*Y+ie*ie+me*me;return we>0&&(we=1/Math.sqrt(we)),A[0]=O[0]*we,A[1]=O[1]*we,A[2]=O[2]*we,A},e.number=Pr,e.offscreenCanvasSupported=ct,e.ortho=function(A,O,Y,ie,me,we,ze){var Ve=1/(O-Y),nt=1/(ie-me),ht=1/(we-ze);return A[0]=-2*Ve,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=-2*nt,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=2*ht,A[11]=0,A[12]=(O+Y)*Ve,A[13]=(me+ie)*nt,A[14]=(ze+we)*ht,A[15]=1,A},e.parseGlyphPBF=function(A){return new gc(A).readFields(np,[])},e.pbf=gc,e.performSymbolLayout=function(A,O,Y,ie,me,we,ze){A.createArrays(),A.tilePixelRatio=8192/(512*A.overscaling),A.compareText={},A.iconsNeedLinear=!1;var nt=A.layers[0].layout,ht=A.layers[0]._unevaluatedLayout._values,xt={};if("composite"===A.textSizeData.kind){var Ut=A.textSizeData,Wt=Ut.maxZoom;xt.compositeTextSizes=[ht["text-size"].possiblyEvaluate(new fa(Ut.minZoom),ze),ht["text-size"].possiblyEvaluate(new fa(Wt),ze)]}if("composite"===A.iconSizeData.kind){var fn=A.iconSizeData,Bn=fn.maxZoom;xt.compositeIconSizes=[ht["icon-size"].possiblyEvaluate(new fa(fn.minZoom),ze),ht["icon-size"].possiblyEvaluate(new fa(Bn),ze)]}xt.layoutTextSize=ht["text-size"].possiblyEvaluate(new fa(A.zoom+1),ze),xt.layoutIconSize=ht["icon-size"].possiblyEvaluate(new fa(A.zoom+1),ze),xt.textMaxSize=ht["text-size"].possiblyEvaluate(new fa(18));for(var Nn=24*nt.get("text-line-height"),Gn="map"===nt.get("text-rotation-alignment")&&"point"!==nt.get("symbol-placement"),Jn=nt.get("text-keep-upright"),tr=nt.get("text-size"),kr=function(){var Wr=Kr[zr],ai=nt.get("text-font").evaluate(Wr,{},ze).join(","),bi=tr.evaluate(Wr,{},ze),_i=xt.layoutTextSize.evaluate(Wr,{},ze),hi=xt.layoutIconSize.evaluate(Wr,{},ze),Ci={horizontal:{},vertical:void 0},Ai=Wr.text,wi=[0,0];if(Ai){var ha=Ai.toString(),la=24*nt.get("text-letter-spacing").evaluate(Wr,{},ze),ya=function(Ki){for(var ma=0,io=Ki;ma<io.length;ma+=1)if(!Ui(io[ma].charCodeAt(0)))return!1;return!0}(ha)?la:0,Di=nt.get("text-anchor").evaluate(Wr,{},ze),ca=nt.get("text-variable-anchor");if(!ca){var Da=nt.get("text-radial-offset").evaluate(Wr,{},ze);wi=Da?_f(Di,[24*Da,pu]):nt.get("text-offset").evaluate(Wr,{},ze).map(function(Ki){return 24*Ki})}var Ea=Gn?"center":nt.get("text-justify").evaluate(Wr,{},ze),Ya=nt.get("symbol-placement"),La="point"===Ya?24*nt.get("text-max-width").evaluate(Wr,{},ze):0,Co=function(){A.allowVerticalPlacement&&Wi(ha)&&(Ci.vertical=xc(Ai,O,Y,me,ai,La,Nn,Di,"left",ya,wi,Ts.vertical,!0,Ya,_i,bi))};if(!Gn&&ca){for(var Za="auto"===Ea?ca.map(function(Ki){return du(Ki)}):[Ea],Wo=!1,Fo=0;Fo<Za.length;Fo++){var Uo=Za[Fo];if(!Ci.horizontal[Uo])if(Wo)Ci.horizontal[Uo]=Ci.horizontal[0];else{var os=xc(Ai,O,Y,me,ai,La,Nn,"center",Uo,ya,wi,Ts.horizontal,!1,Ya,_i,bi);os&&(Ci.horizontal[Uo]=os,Wo=1===os.positionedLines.length)}}Co()}else{"auto"===Ea&&(Ea=du(Di));var $o=xc(Ai,O,Y,me,ai,La,Nn,Di,Ea,ya,wi,Ts.horizontal,!1,Ya,_i,bi);$o&&(Ci.horizontal[Ea]=$o),Co(),Wi(ha)&&Gn&&Jn&&(Ci.vertical=xc(Ai,O,Y,me,ai,La,Nn,Di,Ea,ya,wi,Ts.vertical,!1,Ya,_i,bi))}}var Ki,ma,ao,ss,es,Eo=void 0,Vo=!1;if(Wr.icon&&Wr.icon.name){var bo=ie[Wr.icon.name];bo&&(Ki=me[Wr.icon.name],ma=nt.get("icon-offset").evaluate(Wr,{},ze),ao=fu(nt.get("icon-anchor").evaluate(Wr,{},ze)),Eo={image:Ki,top:es=ma[1]-Ki.displaySize[1]*ao.verticalAlign,bottom:es+Ki.displaySize[1],left:ss=ma[0]-Ki.displaySize[0]*ao.horizontalAlign,right:ss+Ki.displaySize[0]},Vo=bo.sdf,void 0===A.sdfIcons?A.sdfIcons=bo.sdf:A.sdfIcons!==bo.sdf&&M("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(bo.pixelRatio!==A.pixelRatio||0!==nt.get("icon-rotate").constantOr(1))&&(A.iconsNeedLinear=!0))}var Po=Tf(Ci.horizontal)||Ci.vertical;A.iconsInText=!!Po&&Po.iconsInText,(Po||Eo)&&function(Ki,ma,io,ao,to,Ga,ba,oo,ss,xs,es){var Rs=Ga.textMaxSize.evaluate(ma,{});void 0===Rs&&(Rs=ba);var Qs,No=Ki.layers[0].layout,Fs=No.get("icon-offset").evaluate(ma,{},es),Ns=Tf(io.horizontal),Bs=ba/24,bu=Ki.tilePixelRatio*Bs,Pl=Ki.tilePixelRatio*Rs/24,Ec=Ki.tilePixelRatio*oo,ml=Ki.tilePixelRatio*No.get("symbol-spacing"),Lc=No.get("text-padding")*Ki.tilePixelRatio,zc=No.get("icon-padding")*Ki.tilePixelRatio,Pc=No.get("text-max-angle")/180*Math.PI,Oc="map"===No.get("text-rotation-alignment")&&"point"!==No.get("symbol-placement"),il="map"===No.get("icon-rotation-alignment")&&"point"!==No.get("symbol-placement"),Ol=No.get("symbol-placement"),Ic=ml/2,Il=No.get("icon-text-fit");ao&&"none"!==Il&&(Ki.allowVerticalPlacement&&io.vertical&&(Qs=ff(ao,io.vertical,Il,No.get("icon-text-fit-padding"),Fs,Bs)),Ns&&(ao=ff(ao,Ns,Il,No.get("icon-text-fit-padding"),Fs,Bs)));var al=function(Sp,sc){sc.x<0||sc.x>=8192||sc.y<0||sc.y>=8192||function(mo,js,Cp,ol,Au,Uf,Vc,qs,qc,lc,Hc,Yc,Mu,Vf,cc,qf,Hf,Yf,Zf,Gf,ks,Zc,Xf,Hs,Ep){var Su,vl,jl,Ul,Vl,ql=mo.addToLineVertexArray(js,Cp),Wf=0,Jf=0,Qf=0,Kf=0,Cu=-1,Eu=-1,Ks={},$f=In(""),Lu=0,zu=0;if(void 0===qs._unevaluatedLayout.getValue("text-radial-offset")?(Lu=(Su=qs.layout.get("text-offset").evaluate(ks,{},Hs).map(function(fc){return 24*fc}))[0],zu=Su[1]):(Lu=24*qs.layout.get("text-radial-offset").evaluate(ks,{},Hs),zu=pu),mo.allowVerticalPlacement&&ol.vertical){var eh=qs.layout.get("text-rotate").evaluate(ks,{},Hs)+90;Ul=new kc(qc,js,lc,Hc,Yc,ol.vertical,Mu,Vf,cc,eh),Vc&&(Vl=new kc(qc,js,lc,Hc,Yc,Vc,Hf,Yf,cc,eh))}if(Au){var Pu=qs.layout.get("icon-rotate").evaluate(ks,{}),th="none"!==qs.layout.get("icon-text-fit"),nh=xf(Au,Pu,Xf,th),Ou=Vc?xf(Vc,Pu,Xf,th):void 0;jl=new kc(qc,js,lc,Hc,Yc,Au,Hf,Yf,!1,Pu),Wf=4*nh.length;var rh=mo.iconSizeData,uc=null;"source"===rh.kind?(uc=[128*qs.layout.get("icon-size").evaluate(ks,{})])[0]>32640&&M(mo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===rh.kind&&((uc=[128*Zc.compositeIconSizes[0].evaluate(ks,{},Hs),128*Zc.compositeIconSizes[1].evaluate(ks,{},Hs)])[0]>32640||uc[1]>32640)&&M(mo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),mo.addSymbols(mo.icon,nh,uc,Gf,Zf,ks,!1,js,ql.lineStartIndex,ql.lineLength,-1,Hs),Cu=mo.icon.placedSymbolArray.length-1,Ou&&(Jf=4*Ou.length,mo.addSymbols(mo.icon,Ou,uc,Gf,Zf,ks,Ts.vertical,js,ql.lineStartIndex,ql.lineLength,-1,Hs),Eu=mo.icon.placedSymbolArray.length-1)}for(var ih in ol.horizontal){var Gc=ol.horizontal[ih];if(!vl){$f=In(Gc.text);var zp=qs.layout.get("text-rotate").evaluate(ks,{},Hs);vl=new kc(qc,js,lc,Hc,Yc,Gc,Mu,Vf,cc,zp)}var ah=1===Gc.positionedLines.length;if(Qf+=wf(mo,js,Gc,Uf,qs,cc,ks,qf,ql,ol.vertical?Ts.horizontal:Ts.horizontalOnly,ah?Object.keys(ol.horizontal):[ih],Ks,Cu,Zc,Hs),ah)break}ol.vertical&&(Kf+=wf(mo,js,ol.vertical,Uf,qs,cc,ks,qf,ql,Ts.vertical,["vertical"],Ks,Eu,Zc,Hs));var Pp=vl?vl.boxStartIndex:mo.collisionBoxArray.length,Op=vl?vl.boxEndIndex:mo.collisionBoxArray.length,Ip=Ul?Ul.boxStartIndex:mo.collisionBoxArray.length,Dp=Ul?Ul.boxEndIndex:mo.collisionBoxArray.length,Rp=jl?jl.boxStartIndex:mo.collisionBoxArray.length,Fp=jl?jl.boxEndIndex:mo.collisionBoxArray.length,Np=Vl?Vl.boxStartIndex:mo.collisionBoxArray.length,Bp=Vl?Vl.boxEndIndex:mo.collisionBoxArray.length,Ys=-1,Xc=function(fc,sh){return fc&&fc.circleDiameter?Math.max(fc.circleDiameter,sh):sh};Ys=Xc(vl,Ys),Ys=Xc(Ul,Ys),Ys=Xc(jl,Ys);var oh=(Ys=Xc(Vl,Ys))>-1?1:0;oh&&(Ys*=Ep/24),mo.glyphOffsetArray.length>=wa.MAX_GLYPHS&&M("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ks.sortKey&&mo.addToSortKeyRanges(mo.symbolInstances.length,ks.sortKey),mo.symbolInstances.emplaceBack(js.x,js.y,Ks.right>=0?Ks.right:-1,Ks.center>=0?Ks.center:-1,Ks.left>=0?Ks.left:-1,Ks.vertical||-1,Cu,Eu,$f,Pp,Op,Ip,Dp,Rp,Fp,Np,Bp,lc,Qf,Kf,Wf,Jf,oh,0,Mu,Lu,zu,Ys)}(Ki,sc,Sp,io,ao,to,Qs,Ki.layers[0],Ki.collisionBoxArray,ma.index,ma.sourceLayerIndex,Ki.index,bu,Lc,Oc,ss,Ec,zc,il,Fs,ma,Ga,xs,es,ba)};if("line"===Ol)for(var nc=0,Dc=yf(ma.geometry,0,0,8192,8192);nc<Dc.length;nc+=1)for(var Rc=Dc[nc],rc=0,Nc=cp(Rc,ml,Pc,io.vertical||Ns,ao,24,Pl,Ki.overscaling,8192);rc<Nc.length;rc+=1){var ic=Nc[rc];Ns&&pp(Ki,Ns.text,Ic,ic)||al(Rc,ic)}else if("line-center"===Ol)for(var ac=0,jc=ma.geometry;ac<jc.length;ac+=1){var Dl=jc[ac];if(Dl.length>1){var Rl=lp(Dl,Pc,io.vertical||Ns,ao,24,Pl);Rl&&al(Dl,Rl)}}else if("Polygon"===ma.type)for(var Fl=0,Uc=au(ma.geometry,0);Fl<Uc.length;Fl+=1){var Nl=Uc[Fl],oc=fp(Nl,16);al(Nl[0],new Al(oc.x,oc.y,0))}else if("LineString"===ma.type)for(var Bl=0,Nf=ma.geometry;Bl<Nf.length;Bl+=1){var _u=Nf[Bl];al(_u,new Al(_u[0].x,_u[0].y,0))}else if("Point"===ma.type)for(var wu=0,Bf=ma.geometry;wu<Bf.length;wu+=1)for(var Tu=0,jf=Bf[wu];Tu<jf.length;Tu+=1){var ku=jf[Tu];al([ku],new Al(ku.x,ku.y,0))}}(A,Wr,Ci,Eo,ie,xt,_i,hi,wi,Vo,ze)},zr=0,Kr=A.features;zr<Kr.length;zr+=1)kr();we&&A.generateCollisionDebugBuffers()},e.perspective=function(A,O,Y,ie,me){var we,ze=1/Math.tan(O/2);return A[0]=ze/Y,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=ze,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=-1,A[12]=0,A[13]=0,A[15]=0,null!=me&&me!==1/0?(A[10]=(me+ie)*(we=1/(ie-me)),A[14]=2*me*ie*we):(A[10]=-1,A[14]=-2*ie),A},e.pick=function(A,O){for(var Y={},ie=0;ie<O.length;ie++){var me=O[ie];me in A&&(Y[me]=A[me])}return Y},e.plugin=xo,e.polygonIntersectsPolygon=Qo,e.postMapLoadEvent=De,e.postTurnstileEvent=Le,e.potpack=sf,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=nr,e.registerForPluginStateChange=function(A){return A({pluginStatus:Ei,pluginURL:ka}),Pa.on("pluginStateChange",A),A},e.rotate=function(A,O,Y){var ie=O[0],me=O[1],we=O[2],ze=O[3],Ve=Math.sin(Y),nt=Math.cos(Y);return A[0]=ie*nt+we*Ve,A[1]=me*nt+ze*Ve,A[2]=ie*-Ve+we*nt,A[3]=me*-Ve+ze*nt,A},e.rotateX=function(A,O,Y){var ie=Math.sin(Y),me=Math.cos(Y),we=O[4],ze=O[5],Ve=O[6],nt=O[7],ht=O[8],xt=O[9],Ut=O[10],$t=O[11];return O!==A&&(A[0]=O[0],A[1]=O[1],A[2]=O[2],A[3]=O[3],A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15]),A[4]=we*me+ht*ie,A[5]=ze*me+xt*ie,A[6]=Ve*me+Ut*ie,A[7]=nt*me+$t*ie,A[8]=ht*me-we*ie,A[9]=xt*me-ze*ie,A[10]=Ut*me-Ve*ie,A[11]=$t*me-nt*ie,A},e.rotateZ=function(A,O,Y){var ie=Math.sin(Y),me=Math.cos(Y),we=O[0],ze=O[1],Ve=O[2],nt=O[3],ht=O[4],xt=O[5],Ut=O[6],$t=O[7];return O!==A&&(A[8]=O[8],A[9]=O[9],A[10]=O[10],A[11]=O[11],A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15]),A[0]=we*me+ht*ie,A[1]=ze*me+xt*ie,A[2]=Ve*me+Ut*ie,A[3]=nt*me+$t*ie,A[4]=ht*me-we*ie,A[5]=xt*me-ze*ie,A[6]=Ut*me-Ve*ie,A[7]=$t*me-nt*ie,A},e.scale=function(A,O,Y){var ie=Y[0],me=Y[1],we=Y[2];return A[0]=O[0]*ie,A[1]=O[1]*ie,A[2]=O[2]*ie,A[3]=O[3]*ie,A[4]=O[4]*me,A[5]=O[5]*me,A[6]=O[6]*me,A[7]=O[7]*me,A[8]=O[8]*we,A[9]=O[9]*we,A[10]=O[10]*we,A[11]=O[11]*we,A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15],A},e.scale$1=function(A,O,Y){return A[0]=O[0]*Y,A[1]=O[1]*Y,A[2]=O[2]*Y,A[3]=O[3]*Y,A},e.scale$2=function(A,O,Y){return A[0]=O[0]*Y,A[1]=O[1]*Y,A[2]=O[2]*Y,A},e.setCacheLimits=function(A,O){Oe=A,Ie=O},e.setRTLTextPlugin=function(A,O,Y){if(void 0===Y&&(Y=!1),Ei===aa||Ei===Qa||Ei===Jo)throw new Error("setRTLTextPlugin cannot be called multiple times.");ka=N.resolveURL(A),Ei=aa,To=O,oa(),Y||pa()},e.sphericalToCartesian=function(A){var O=A[0],Y=A[1],ie=A[2];return Y+=90,Y*=Math.PI/180,ie*=Math.PI/180,{x:O*Math.cos(Y)*Math.sin(ie),y:O*Math.sin(Y)*Math.sin(ie),z:O*Math.cos(ie)}},e.sqrLen=function(A){var O=A[0],Y=A[1];return O*O+Y*Y},e.styleSpec=be,e.sub=function(A,O,Y){return A[0]=O[0]-Y[0],A[1]=O[1]-Y[1],A[2]=O[2]-Y[2],A},e.symbolSize=sp,e.transformMat3=function(A,O,Y){var ie=O[0],me=O[1],we=O[2];return A[0]=ie*Y[0]+me*Y[3]+we*Y[6],A[1]=ie*Y[1]+me*Y[4]+we*Y[7],A[2]=ie*Y[2]+me*Y[5]+we*Y[8],A},e.transformMat4=tl,e.translate=function(A,O,Y){var ie,me,we,ze,Ve,nt,ht,xt,Ut,$t,Wt,fn,An=Y[0],Bn=Y[1],Nn=Y[2];return O===A?(A[12]=O[0]*An+O[4]*Bn+O[8]*Nn+O[12],A[13]=O[1]*An+O[5]*Bn+O[9]*Nn+O[13],A[14]=O[2]*An+O[6]*Bn+O[10]*Nn+O[14],A[15]=O[3]*An+O[7]*Bn+O[11]*Nn+O[15]):(me=O[1],we=O[2],ze=O[3],Ve=O[4],nt=O[5],ht=O[6],xt=O[7],Ut=O[8],$t=O[9],Wt=O[10],fn=O[11],A[0]=ie=O[0],A[1]=me,A[2]=we,A[3]=ze,A[4]=Ve,A[5]=nt,A[6]=ht,A[7]=xt,A[8]=Ut,A[9]=$t,A[10]=Wt,A[11]=fn,A[12]=ie*An+Ve*Bn+Ut*Nn+O[12],A[13]=me*An+nt*Bn+$t*Nn+O[13],A[14]=we*An+ht*Bn+Wt*Nn+O[14],A[15]=ze*An+xt*Bn+fn*Nn+O[15]),A},e.triggerPluginCompletionEvent=ko,e.uniqueId=u,e.validateCustomStyleLayer=function(A){var O=[],Y=A.id;return void 0===Y&&O.push({message:"layers."+Y+': missing required property "id"'}),void 0===A.render&&O.push({message:"layers."+Y+': missing required method "render"'}),A.renderingMode&&"2d"!==A.renderingMode&&"3d"!==A.renderingMode&&O.push({message:"layers."+Y+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=yr,e.validateStyle=er,e.values=function(A){var O=[];for(var Y in A)O.push(A[Y]);return O},e.vectorTile=_l,e.version="1.10.1",e.warnOnce=M,e.webpSupported=ee,e.window=self,e.wrap=l}),x(0,function(e){function r(je){var Ye=typeof je;if("number"===Ye||"boolean"===Ye||"string"===Ye||null==je)return JSON.stringify(je);if(Array.isArray(je)){for(var he="[",be=0,Fe=je;be<Fe.length;be+=1)he+=r(Fe[be])+",";return he+"]"}for(var He=Object.keys(je).sort(),Ke="{",Ze=0;Ze<He.length;Ze++)Ke+=JSON.stringify(He[Ze])+":"+r(je[He[Ze]])+",";return Ke+"}"}function i(je){for(var Ye="",he=0,be=e.refProperties;he<be.length;he+=1)Ye+="/"+r(je[be[he]]);return Ye}var c=function(je){this.keyCache={},je&&this.replace(je)};c.prototype.replace=function(je){this._layerConfigs={},this._layers={},this.update(je,[])},c.prototype.update=function(je,Ye){for(var he=this,be=0,Fe=je;be<Fe.length;be+=1){var He=Fe[be];this._layerConfigs[He.id]=He;var Ke=this._layers[He.id]=e.createStyleLayer(He);Ke._featureFilter=e.featureFilter(Ke.filter),this.keyCache[He.id]&&delete this.keyCache[He.id]}for(var Ze=0,ut=Ye;Ze<ut.length;Ze+=1){var lt=ut[Ze];delete this.keyCache[lt],delete this._layerConfigs[lt],delete this._layers[lt]}this.familiesBySource={};for(var Lt=0,Ot=function(Xe,st){for(var dt={},zt=0;zt<Xe.length;zt++){var Ht=st&&st[Xe[zt].id]||i(Xe[zt]);st&&(st[Xe[zt].id]=Ht);var Kt=dt[Ht];Kt||(Kt=dt[Ht]=[]),Kt.push(Xe[zt])}var Zt=[];for(var vn in dt)Zt.push(dt[vn]);return Zt}(e.values(this._layerConfigs),this.keyCache);Lt<Ot.length;Lt+=1){var ot=Ot[Lt].map(function(Xe){return he._layers[Xe.id]}),pt=ot[0];if("none"!==pt.visibility){var qt=pt.source||"",St=this.familiesBySource[qt];St||(St=this.familiesBySource[qt]={});var Mt=pt.sourceLayer||"_geojsonTileLayer",Ce=St[Mt];Ce||(Ce=St[Mt]=[]),Ce.push(ot)}}};var n=function(je){var Ye={},he=[];for(var be in je){var Fe=je[be],He=Ye[be]={};for(var Ke in Fe){var Ze=Fe[+Ke];if(Ze&&0!==Ze.bitmap.width&&0!==Ze.bitmap.height){var ut={x:0,y:0,w:Ze.bitmap.width+2,h:Ze.bitmap.height+2};he.push(ut),He[Ke]={rect:ut,metrics:Ze.metrics}}}}var lt=e.potpack(he),ot=new e.AlphaImage({width:lt.w||1,height:lt.h||1});for(var pt in je){var qt=je[pt];for(var St in qt){var Mt=qt[+St];if(Mt&&0!==Mt.bitmap.width&&0!==Mt.bitmap.height){var Ce=Ye[pt][St].rect;e.AlphaImage.copy(Mt.bitmap,ot,{x:0,y:0},{x:Ce.x+1,y:Ce.y+1},Mt.bitmap)}}}this.image=ot,this.positions=Ye};e.register("GlyphAtlas",n);var m=function(je){this.tileID=new e.OverscaledTileID(je.tileID.overscaledZ,je.tileID.wrap,je.tileID.canonical.z,je.tileID.canonical.x,je.tileID.canonical.y),this.uid=je.uid,this.zoom=je.zoom,this.pixelRatio=je.pixelRatio,this.tileSize=je.tileSize,this.source=je.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=je.showCollisionBoxes,this.collectResourceTiming=!!je.collectResourceTiming,this.returnDependencies=!!je.returnDependencies,this.promoteId=je.promoteId};function p(je,Ye,he){for(var be=new e.EvaluationParameters(Ye),Fe=0,He=je;Fe<He.length;Fe+=1)He[Fe].recalculate(be,he)}function s(je,Ye){var he=e.getArrayBuffer(je.request,function(be,Fe,He,Ke){be?Ye(be):Fe&&Ye(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Fe)),rawData:Fe,cacheControl:He,expires:Ke})});return function(){he.cancel(),Ye()}}m.prototype.parse=function(je,Ye,he,be,Fe){var He=this;this.status="parsing",this.data=je,this.collisionBoxArray=new e.CollisionBoxArray;var Ke=new e.DictionaryCoder(Object.keys(je.layers).sort()),Ze=new e.FeatureIndex(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];var ut,lt,Lt,Ot,ot={},pt={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},qt=Ye.familiesBySource[this.source];for(var St in qt){var Mt=je.layers[St];if(Mt){1===Mt.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+St+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ce=Ke.encode(St),Xe=[],st=0;st<Mt.length;st++){var dt=Mt.feature(st),zt=Ze.getId(dt,St);Xe.push({feature:dt,id:zt,index:st,sourceLayerIndex:Ce})}for(var Ht=0,Kt=qt[St];Ht<Kt.length;Ht+=1){var Zt=Kt[Ht],vn=Zt[0];vn.minzoom&&this.zoom<Math.floor(vn.minzoom)||vn.maxzoom&&this.zoom>=vn.maxzoom||"none"!==vn.visibility&&(p(Zt,this.zoom,he),(ot[vn.id]=vn.createBucket({index:Ze.bucketLayerIDs.length,layers:Zt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ce,sourceID:this.source})).populate(Xe,pt,this.tileID.canonical),Ze.bucketLayerIDs.push(Zt.map(function(on){return on.id})))}}}var zn=e.mapObject(pt.glyphDependencies,function(on){return Object.keys(on).map(Number)});Object.keys(zn).length?be.send("getGlyphs",{uid:this.uid,stacks:zn},function(on,mn){ut||(ut=on,lt=mn,an.call(He))}):lt={};var gn=Object.keys(pt.iconDependencies);gn.length?be.send("getImages",{icons:gn,source:this.source,tileID:this.tileID,type:"icons"},function(on,mn){ut||(ut=on,Lt=mn,an.call(He))}):Lt={};var nn=Object.keys(pt.patternDependencies);function an(){if(ut)return Fe(ut);if(lt&&Lt&&Ot){var on=new n(lt),mn=new e.ImageAtlas(Lt,Ot);for(var _n in ot){var Pn=ot[_n];Pn instanceof e.SymbolBucket?(p(Pn.layers,this.zoom,he),e.performSymbolLayout(Pn,lt,on.positions,Lt,mn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Pn.hasPattern&&(Pn instanceof e.LineBucket||Pn instanceof e.FillBucket||Pn instanceof e.FillExtrusionBucket)&&(p(Pn.layers,this.zoom,he),Pn.addFeatures(pt,this.tileID.canonical,mn.patternPositions))}this.status="done",Fe(null,{buckets:e.values(ot).filter(function(Rn){return!Rn.isEmpty()}),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:on.image,imageAtlas:mn,glyphMap:this.returnDependencies?lt:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?on.positions:null})}}nn.length?be.send("getImages",{icons:nn,source:this.source,tileID:this.tileID,type:"patterns"},function(on,mn){ut||(ut=on,Ot=mn,an.call(He))}):Ot={},an.call(this)};var f=function(je,Ye,he,be){this.actor=je,this.layerIndex=Ye,this.availableImages=he,this.loadVectorData=be||s,this.loading={},this.loaded={}};f.prototype.loadTile=function(je,Ye){var he=this,be=je.uid;this.loading||(this.loading={});var Fe=!!(je&&je.request&&je.request.collectResourceTiming)&&new e.RequestPerformance(je.request),He=this.loading[be]=new m(je);He.abort=this.loadVectorData(je,function(Ke,Ze){if(delete he.loading[be],Ke||!Ze)return He.status="done",he.loaded[be]=He,Ye(Ke);var ut=Ze.rawData,lt={};Ze.expires&&(lt.expires=Ze.expires),Ze.cacheControl&&(lt.cacheControl=Ze.cacheControl);var Lt={};if(Fe){var Ot=Fe.finish();Ot&&(Lt.resourceTiming=JSON.parse(JSON.stringify(Ot)))}He.vectorTile=Ze.vectorTile,He.parse(Ze.vectorTile,he.layerIndex,he.availableImages,he.actor,function(ot,pt){if(ot||!pt)return Ye(ot);Ye(null,e.extend({rawTileData:ut.slice(0)},pt,lt,Lt))}),he.loaded=he.loaded||{},he.loaded[be]=He})},f.prototype.reloadTile=function(je,Ye){var he=this,be=this.loaded,Fe=je.uid,He=this;if(be&&be[Fe]){var Ke=be[Fe];Ke.showCollisionBoxes=je.showCollisionBoxes;var Ze=function(ut,lt){var Lt=Ke.reloadCallback;Lt&&(delete Ke.reloadCallback,Ke.parse(Ke.vectorTile,He.layerIndex,he.availableImages,He.actor,Lt)),Ye(ut,lt)};"parsing"===Ke.status?Ke.reloadCallback=Ze:"done"===Ke.status&&(Ke.vectorTile?Ke.parse(Ke.vectorTile,this.layerIndex,this.availableImages,this.actor,Ze):Ze())}},f.prototype.abortTile=function(je,Ye){var he=this.loading,be=je.uid;he&&he[be]&&he[be].abort&&(he[be].abort(),delete he[be]),Ye()},f.prototype.removeTile=function(je,Ye){var he=this.loaded,be=je.uid;he&&he[be]&&delete he[be],Ye()};var l=e.window.ImageBitmap,o=function(){this.loaded={}};o.prototype.loadTile=function(je,Ye){var he=je.uid,be=je.encoding,Fe=je.rawImageData,He=l&&Fe instanceof l?this.getImageData(Fe):Fe,Ke=new e.DEMData(he,He,be);this.loaded=this.loaded||{},this.loaded[he]=Ke,Ye(null,Ke)},o.prototype.getImageData=function(je){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(je.width,je.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=je.width,this.offscreenCanvas.height=je.height,this.offscreenCanvasContext.drawImage(je,0,0,je.width,je.height);var Ye=this.offscreenCanvasContext.getImageData(-1,-1,je.width+2,je.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Ye.width,height:Ye.height},Ye.data)},o.prototype.removeTile=function(je){var Ye=this.loaded,he=je.uid;Ye&&Ye[he]&&delete Ye[he]};var d=function je(Ye,he){var be,Fe=Ye&&Ye.type;if("FeatureCollection"===Fe)for(be=0;be<Ye.features.length;be++)je(Ye.features[be],he);else if("GeometryCollection"===Fe)for(be=0;be<Ye.geometries.length;be++)je(Ye.geometries[be],he);else if("Feature"===Fe)je(Ye.geometry,he);else if("Polygon"===Fe)u(Ye.coordinates,he);else if("MultiPolygon"===Fe)for(be=0;be<Ye.coordinates.length;be++)u(Ye.coordinates[be],he);return Ye};function u(je,Ye){if(0!==je.length){a(je[0],Ye);for(var he=1;he<je.length;he++)a(je[he],!Ye)}}function a(je,Ye){for(var he=0,be=0,Fe=je.length,He=Fe-1;be<Fe;He=be++)he+=(je[be][0]-je[He][0])*(je[He][1]+je[be][1]);he>=0!=!!Ye&&je.reverse()}var y=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,h=function(je){this._feature=je,this.extent=e.EXTENT,this.type=je.type,this.properties=je.tags,"id"in je&&!isNaN(je.id)&&(this.id=parseInt(je.id,10))};h.prototype.loadGeometry=function(){if(1===this._feature.type){for(var je=[],Ye=0,he=this._feature.geometry;Ye<he.length;Ye+=1){var be=he[Ye];je.push([new e.Point$1(be[0],be[1])])}return je}for(var Fe=[],He=0,Ke=this._feature.geometry;He<Ke.length;He+=1){for(var Ze=[],ut=0,lt=Ke[He];ut<lt.length;ut+=1){var Lt=lt[ut];Ze.push(new e.Point$1(Lt[0],Lt[1]))}Fe.push(Ze)}return Fe},h.prototype.toGeoJSON=function(je,Ye,he){return y.call(this,je,Ye,he)};var _=function(je){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=je.length,this._features=je};_.prototype.feature=function(je){return new h(this._features[je])};var b=e.vectorTile.VectorTileFeature,w=T;function T(je,Ye){this.options=Ye||{},this.features=je,this.length=je.length}function L(je,Ye){this.id="number"==typeof je.id?je.id:void 0,this.type=je.type,this.rawGeometry=1===je.type?[je.geometry]:je.geometry,this.properties=je.tags,this.extent=Ye||4096}T.prototype.feature=function(je){return new L(this.features[je],this.options.extent)},L.prototype.loadGeometry=function(){var je=this.rawGeometry;this.geometry=[];for(var Ye=0;Ye<je.length;Ye++){for(var he=je[Ye],be=[],Fe=0;Fe<he.length;Fe++)be.push(new e.Point$1(he[Fe][0],he[Fe][1]));this.geometry.push(be)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var je=this.geometry,Ye=1/0,he=-1/0,be=1/0,Fe=-1/0,He=0;He<je.length;He++)for(var Ke=je[He],Ze=0;Ze<Ke.length;Ze++){var ut=Ke[Ze];Ye=Math.min(Ye,ut.x),he=Math.max(he,ut.x),be=Math.min(be,ut.y),Fe=Math.max(Fe,ut.y)}return[Ye,be,he,Fe]},L.prototype.toGeoJSON=b.prototype.toGeoJSON;var M=C,S=w;function C(je){var Ye=new e.pbf;return function(he,be){for(var Fe in he.layers)be.writeMessage(3,R,he.layers[Fe])}(je,Ye),Ye.finish()}function R(je,Ye){var he;Ye.writeVarintField(15,je.version||1),Ye.writeStringField(1,je.name||""),Ye.writeVarintField(5,je.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(he=0;he<je.length;he++)be.feature=je.feature(he),Ye.writeMessage(2,D,be);var Fe=be.keys;for(he=0;he<Fe.length;he++)Ye.writeStringField(3,Fe[he]);var He=be.values;for(he=0;he<He.length;he++)Ye.writeMessage(4,G,He[he])}function D(je,Ye){var he=je.feature;void 0!==he.id&&Ye.writeVarintField(1,he.id),Ye.writeMessage(2,j,je),Ye.writeVarintField(3,he.type),Ye.writeMessage(4,W,he)}function j(je,Ye){var he=je.feature,be=je.keys,Fe=je.values,He=je.keycache,Ke=je.valuecache;for(var Ze in he.properties){var ut=He[Ze];void 0===ut&&(be.push(Ze),He[Ze]=ut=be.length-1),Ye.writeVarint(ut);var lt=he.properties[Ze],Lt=typeof lt;"string"!==Lt&&"boolean"!==Lt&&"number"!==Lt&&(lt=JSON.stringify(lt));var Ot=Lt+":"+lt,ot=Ke[Ot];void 0===ot&&(Fe.push(lt),Ke[Ot]=ot=Fe.length-1),Ye.writeVarint(ot)}}function q(je,Ye){return(Ye<<3)+(7&je)}function Z(je){return je<<1^je>>31}function W(je,Ye){for(var he=je.loadGeometry(),be=je.type,Fe=0,He=0,Ke=he.length,Ze=0;Ze<Ke;Ze++){var ut=he[Ze],lt=1;1===be&&(lt=ut.length),Ye.writeVarint(q(1,lt));for(var Lt=3===be?ut.length-1:ut.length,Ot=0;Ot<Lt;Ot++){1===Ot&&1!==be&&Ye.writeVarint(q(2,Lt-1));var ot=ut[Ot].x-Fe,pt=ut[Ot].y-He;Ye.writeVarint(Z(ot)),Ye.writeVarint(Z(pt)),Fe+=ot,He+=pt}3===be&&Ye.writeVarint(q(7,1))}}function G(je,Ye){var he=typeof je;"string"===he?Ye.writeStringField(1,je):"boolean"===he?Ye.writeBooleanField(7,je):"number"===he&&(je%1!=0?Ye.writeDoubleField(3,je):je<0?Ye.writeSVarintField(6,je):Ye.writeVarintField(5,je))}function X(je,Ye,he,be,Fe,He){if(!(Fe-be<=he)){var Ke=be+Fe>>1;(function Ze(ut,lt,Lt,Ot,ot,pt){for(;ot>Ot;){if(ot-Ot>600){var qt=ot-Ot+1,St=Lt-Ot+1,Mt=Math.log(qt),Ce=.5*Math.exp(2*Mt/3),Xe=.5*Math.sqrt(Mt*Ce*(qt-Ce)/qt)*(St-qt/2<0?-1:1);Ze(ut,lt,Lt,Math.max(Ot,Math.floor(Lt-St*Ce/qt+Xe)),Math.min(ot,Math.floor(Lt+(qt-St)*Ce/qt+Xe)),pt)}var zt=lt[2*Lt+pt],Ht=Ot,Kt=ot;for(ne(ut,lt,Ot,Lt),lt[2*ot+pt]>zt&&ne(ut,lt,Ot,ot);Ht<Kt;){for(ne(ut,lt,Ht,Kt),Ht++,Kt--;lt[2*Ht+pt]<zt;)Ht++;for(;lt[2*Kt+pt]>zt;)Kt--}lt[2*Ot+pt]===zt?ne(ut,lt,Ot,Kt):ne(ut,lt,++Kt,ot),Kt<=Lt&&(Ot=Kt+1),Lt<=Kt&&(ot=Kt-1)}})(je,Ye,Ke,be,Fe,He%2),X(je,Ye,he,be,Ke-1,He+1),X(je,Ye,he,Ke+1,Fe,He+1)}}function ne(je,Ye,he,be){V(je,he,be),V(Ye,2*he,2*be),V(Ye,2*he+1,2*be+1)}function V(je,Ye,he){var be=je[Ye];je[Ye]=je[he],je[he]=be}function N(je,Ye,he,be){var Fe=je-he,He=Ye-be;return Fe*Fe+He*He}M.fromVectorTileJs=C,M.fromGeojsonVt=function(je,Ye){Ye=Ye||{};var he={};for(var be in je)he[be]=new w(je[be].features,Ye),he[be].name=be,he[be].version=Ye.version,he[be].extent=Ye.extent;return C({layers:he})},M.GeoJSONWrapper=S;var U=function(je){return je[0]},ee=function(je){return je[1]},B=function(je,Ye,he,be,Fe){void 0===Ye&&(Ye=U),void 0===he&&(he=ee),void 0===be&&(be=64),void 0===Fe&&(Fe=Float64Array),this.nodeSize=be,this.points=je;for(var He=je.length<65536?Uint16Array:Uint32Array,Ke=this.ids=new He(je.length),Ze=this.coords=new Fe(2*je.length),ut=0;ut<je.length;ut++)Ke[ut]=ut,Ze[2*ut]=Ye(je[ut]),Ze[2*ut+1]=he(je[ut]);X(Ke,Ze,be,0,Ke.length-1,0)};B.prototype.range=function(je,Ye,he,be){return function(Fe,He,Ke,Ze,ut,lt,Lt){for(var Ot,ot,pt=[0,Fe.length-1,0],qt=[];pt.length;){var St=pt.pop(),Mt=pt.pop(),Ce=pt.pop();if(Mt-Ce<=Lt)for(var Xe=Ce;Xe<=Mt;Xe++)ot=He[2*Xe+1],(Ot=He[2*Xe])>=Ke&&Ot<=ut&&ot>=Ze&&ot<=lt&&qt.push(Fe[Xe]);else{var st=Math.floor((Ce+Mt)/2);ot=He[2*st+1],(Ot=He[2*st])>=Ke&&Ot<=ut&&ot>=Ze&&ot<=lt&&qt.push(Fe[st]);var dt=(St+1)%2;(0===St?Ke<=Ot:Ze<=ot)&&(pt.push(Ce),pt.push(st-1),pt.push(dt)),(0===St?ut>=Ot:lt>=ot)&&(pt.push(st+1),pt.push(Mt),pt.push(dt))}}return qt}(this.ids,this.coords,je,Ye,he,be,this.nodeSize)},B.prototype.within=function(je,Ye,he){return function(be,Fe,He,Ke,Ze,ut){for(var lt=[0,be.length-1,0],Lt=[],Ot=Ze*Ze;lt.length;){var ot=lt.pop(),pt=lt.pop(),qt=lt.pop();if(pt-qt<=ut)for(var St=qt;St<=pt;St++)N(Fe[2*St],Fe[2*St+1],He,Ke)<=Ot&&Lt.push(be[St]);else{var Mt=Math.floor((qt+pt)/2),Ce=Fe[2*Mt],Xe=Fe[2*Mt+1];N(Ce,Xe,He,Ke)<=Ot&&Lt.push(be[Mt]);var st=(ot+1)%2;(0===ot?He-Ze<=Ce:Ke-Ze<=Xe)&&(lt.push(qt),lt.push(Mt-1),lt.push(st)),(0===ot?He+Ze>=Ce:Ke+Ze>=Xe)&&(lt.push(Mt+1),lt.push(pt),lt.push(st))}}return Lt}(this.ids,this.coords,je,Ye,he,this.nodeSize)};var K={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(je){return je}},J=function(je){this.options=xe(Object.create(K),je),this.trees=new Array(this.options.maxZoom+1)};function te(je,Ye,he,be,Fe){return{x:je,y:Ye,zoom:1/0,id:he,parentId:-1,numPoints:be,properties:Fe}}function ae(je,Ye){var he=je.geometry.coordinates,Fe=he[1];return{x:ve(he[0]),y:fe(Fe),zoom:1/0,index:Ye,parentId:-1}}function ce(je){return{type:"Feature",id:je.id,properties:oe(je),geometry:{type:"Point",coordinates:[(be=je.x,360*(be-.5)),(Ye=je.y,he=(180-360*Ye)*Math.PI/180,360*Math.atan(Math.exp(he))/Math.PI-90)]}};var Ye,he,be}function oe(je){var Ye=je.numPoints,he=Ye>=1e4?Math.round(Ye/1e3)+"k":Ye>=1e3?Math.round(Ye/100)/10+"k":Ye;return xe(xe({},je.properties),{cluster:!0,cluster_id:je.id,point_count:Ye,point_count_abbreviated:he})}function ve(je){return je/360+.5}function fe(je){var Ye=Math.sin(je*Math.PI/180),he=.5-.25*Math.log((1+Ye)/(1-Ye))/Math.PI;return he<0?0:he>1?1:he}function xe(je,Ye){for(var he in Ye)je[he]=Ye[he];return je}function Se(je){return je.x}function pe(je){return je.y}function ge(je,Ye,he,be,Fe,He){var Ke=Fe-he,Ze=He-be;if(0!==Ke||0!==Ze){var ut=((je-he)*Ke+(Ye-be)*Ze)/(Ke*Ke+Ze*Ze);ut>1?(he=Fe,be=He):ut>0&&(he+=Ke*ut,be+=Ze*ut)}return(Ke=je-he)*Ke+(Ze=Ye-be)*Ze}function Te(je,Ye,he,be){var Fe={id:void 0===je?null:je,type:Ye,geometry:he,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(He){var Ke=He.geometry,Ze=He.type;if("Point"===Ze||"MultiPoint"===Ze||"LineString"===Ze)se(He,Ke);else if("Polygon"===Ze||"MultiLineString"===Ze)for(var ut=0;ut<Ke.length;ut++)se(He,Ke[ut]);else if("MultiPolygon"===Ze)for(ut=0;ut<Ke.length;ut++)for(var lt=0;lt<Ke[ut].length;lt++)se(He,Ke[ut][lt])}(Fe),Fe}function se(je,Ye){for(var he=0;he<Ye.length;he+=3)je.minX=Math.min(je.minX,Ye[he]),je.minY=Math.min(je.minY,Ye[he+1]),je.maxX=Math.max(je.maxX,Ye[he]),je.maxY=Math.max(je.maxY,Ye[he+1])}function de(je,Ye,he,be){if(Ye.geometry){var Fe=Ye.geometry.coordinates,He=Ye.geometry.type,Ke=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2),Ze=[],ut=Ye.id;if(he.promoteId?ut=Ye.properties[he.promoteId]:he.generateId&&(ut=be||0),"Point"===He)Ae(Fe,Ze);else if("MultiPoint"===He)for(var lt=0;lt<Fe.length;lt++)Ae(Fe[lt],Ze);else if("LineString"===He)Le(Fe,Ze,Ke,!1);else if("MultiLineString"===He){if(he.lineMetrics){for(lt=0;lt<Fe.length;lt++)Le(Fe[lt],Ze=[],Ke,!1),je.push(Te(ut,"LineString",Ze,Ye.properties));return}Me(Fe,Ze,Ke,!1)}else if("Polygon"===He)Me(Fe,Ze,Ke,!0);else{if("MultiPolygon"!==He){if("GeometryCollection"===He){for(lt=0;lt<Ye.geometry.geometries.length;lt++)de(je,{id:ut,geometry:Ye.geometry.geometries[lt],properties:Ye.properties},he,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lt=0;lt<Fe.length;lt++){var Lt=[];Me(Fe[lt],Lt,Ke,!0),Ze.push(Lt)}}je.push(Te(ut,He,Ze,Ye.properties))}}function Ae(je,Ye){Ye.push(De(je[0])),Ye.push(Oe(je[1])),Ye.push(0)}function Le(je,Ye,he,be){for(var Fe,He,Ke=0,Ze=0;Ze<je.length;Ze++){var ut=De(je[Ze][0]),lt=Oe(je[Ze][1]);Ye.push(ut),Ye.push(lt),Ye.push(0),Ze>0&&(Ke+=be?(Fe*lt-ut*He)/2:Math.sqrt(Math.pow(ut-Fe,2)+Math.pow(lt-He,2))),Fe=ut,He=lt}var Lt=Ye.length-3;Ye[2]=1,function Ot(ot,pt,qt,St){for(var Mt,Ce=St,Xe=qt-pt>>1,st=qt-pt,dt=ot[pt],zt=ot[pt+1],Ht=ot[qt],Kt=ot[qt+1],Zt=pt+3;Zt<qt;Zt+=3){var vn=ge(ot[Zt],ot[Zt+1],dt,zt,Ht,Kt);if(vn>Ce)Mt=Zt,Ce=vn;else if(vn===Ce){var zn=Math.abs(Zt-Xe);zn<st&&(Mt=Zt,st=zn)}}Ce>St&&(Mt-pt>3&&Ot(ot,pt,Mt,St),ot[Mt+2]=Ce,qt-Mt>3&&Ot(ot,Mt,qt,St))}(Ye,0,Lt,he),Ye[Lt+2]=1,Ye.size=Math.abs(Ke),Ye.start=0,Ye.end=Ye.size}function Me(je,Ye,he,be){for(var Fe=0;Fe<je.length;Fe++){var He=[];Le(je[Fe],He,he,be),Ye.push(He)}}function De(je){return je/360+.5}function Oe(je){var Ye=Math.sin(je*Math.PI/180),he=.5-.25*Math.log((1+Ye)/(1-Ye))/Math.PI;return he<0?0:he>1?1:he}function Ie(je,Ye,he,be,Fe,He,Ke,Ze){if(be/=Ye,He>=(he/=Ye)&&Ke<be)return je;if(Ke<he||He>=be)return null;for(var ut=[],lt=0;lt<je.length;lt++){var Lt=je[lt],Ot=Lt.geometry,ot=Lt.type,pt=0===Fe?Lt.minX:Lt.minY,qt=0===Fe?Lt.maxX:Lt.maxY;if(pt>=he&&qt<be)ut.push(Lt);else if(!(qt<he||pt>=be)){var St=[];if("Point"===ot||"MultiPoint"===ot)Qe(Ot,St,he,be,Fe);else if("LineString"===ot)Ne(Ot,St,he,be,Fe,!1,Ze.lineMetrics);else if("MultiLineString"===ot)Re(Ot,St,he,be,Fe,!1);else if("Polygon"===ot)Re(Ot,St,he,be,Fe,!0);else if("MultiPolygon"===ot)for(var Mt=0;Mt<Ot.length;Mt++){var Ce=[];Re(Ot[Mt],Ce,he,be,Fe,!0),Ce.length&&St.push(Ce)}if(St.length){if(Ze.lineMetrics&&"LineString"===ot){for(Mt=0;Mt<St.length;Mt++)ut.push(Te(Lt.id,ot,St[Mt],Lt.tags));continue}"LineString"!==ot&&"MultiLineString"!==ot||(1===St.length?(ot="LineString",St=St[0]):ot="MultiLineString"),"Point"!==ot&&"MultiPoint"!==ot||(ot=3===St.length?"Point":"MultiPoint"),ut.push(Te(Lt.id,ot,St,Lt.tags))}}}return ut.length?ut:null}function Qe(je,Ye,he,be,Fe){for(var He=0;He<je.length;He+=3){var Ke=je[He+Fe];Ke>=he&&Ke<=be&&(Ye.push(je[He]),Ye.push(je[He+1]),Ye.push(je[He+2]))}}function Ne(je,Ye,he,be,Fe,He,Ke){for(var Ze,ut,lt=Pe(je),Lt=0===Fe?tt:ct,Ot=je.start,ot=0;ot<je.length-3;ot+=3){var pt=je[ot],qt=je[ot+1],St=je[ot+2],Mt=je[ot+3],Ce=je[ot+4],Xe=0===Fe?pt:qt,st=0===Fe?Mt:Ce,dt=!1;Ke&&(Ze=Math.sqrt(Math.pow(pt-Mt,2)+Math.pow(qt-Ce,2))),Xe<he?st>he&&(ut=Lt(lt,pt,qt,Mt,Ce,he),Ke&&(lt.start=Ot+Ze*ut)):Xe>be?st<be&&(ut=Lt(lt,pt,qt,Mt,Ce,be),Ke&&(lt.start=Ot+Ze*ut)):Ge(lt,pt,qt,St),st<he&&Xe>=he&&(ut=Lt(lt,pt,qt,Mt,Ce,he),dt=!0),st>be&&Xe<=be&&(ut=Lt(lt,pt,qt,Mt,Ce,be),dt=!0),!He&&dt&&(Ke&&(lt.end=Ot+Ze*ut),Ye.push(lt),lt=Pe(je)),Ke&&(Ot+=Ze)}var zt=je.length-3;pt=je[zt],qt=je[zt+1],St=je[zt+2],(Xe=0===Fe?pt:qt)>=he&&Xe<=be&&Ge(lt,pt,qt,St),zt=lt.length-3,He&&zt>=3&&(lt[zt]!==lt[0]||lt[zt+1]!==lt[1])&&Ge(lt,lt[0],lt[1],lt[2]),lt.length&&Ye.push(lt)}function Pe(je){var Ye=[];return Ye.size=je.size,Ye.start=je.start,Ye.end=je.end,Ye}function Re(je,Ye,he,be,Fe,He){for(var Ke=0;Ke<je.length;Ke++)Ne(je[Ke],Ye,he,be,Fe,He,!1)}function Ge(je,Ye,he,be){je.push(Ye),je.push(he),je.push(be)}function tt(je,Ye,he,be,Fe,He){var Ke=(He-Ye)/(be-Ye);return je.push(He),je.push(he+(Fe-he)*Ke),je.push(1),Ke}function ct(je,Ye,he,be,Fe,He){var Ke=(He-he)/(Fe-he);return je.push(Ye+(be-Ye)*Ke),je.push(He),je.push(1),Ke}function wt(je,Ye){for(var he=[],be=0;be<je.length;be++){var Fe,He=je[be],Ke=He.type;if("Point"===Ke||"MultiPoint"===Ke||"LineString"===Ke)Fe=kt(He.geometry,Ye);else if("MultiLineString"===Ke||"Polygon"===Ke){Fe=[];for(var Ze=0;Ze<He.geometry.length;Ze++)Fe.push(kt(He.geometry[Ze],Ye))}else if("MultiPolygon"===Ke)for(Fe=[],Ze=0;Ze<He.geometry.length;Ze++){for(var ut=[],lt=0;lt<He.geometry[Ze].length;lt++)ut.push(kt(He.geometry[Ze][lt],Ye));Fe.push(ut)}he.push(Te(He.id,Ke,Fe,He.tags))}return he}function kt(je,Ye){var he=[];he.size=je.size,void 0!==je.start&&(he.start=je.start,he.end=je.end);for(var be=0;be<je.length;be+=3)he.push(je[be]+Ye,je[be+1],je[be+2]);return he}function gt(je,Ye){if(je.transformed)return je;var he,be,Fe,He=1<<je.z,Ke=je.x,Ze=je.y;for(he=0;he<je.features.length;he++){var ut=je.features[he],lt=ut.geometry,Lt=ut.type;if(ut.geometry=[],1===Lt)for(be=0;be<lt.length;be+=2)ut.geometry.push(at(lt[be],lt[be+1],Ye,He,Ke,Ze));else for(be=0;be<lt.length;be++){var Ot=[];for(Fe=0;Fe<lt[be].length;Fe+=2)Ot.push(at(lt[be][Fe],lt[be][Fe+1],Ye,He,Ke,Ze));ut.geometry.push(Ot)}}return je.transformed=!0,je}function at(je,Ye,he,be,Fe,He){return[Math.round(he*(je*be-Fe)),Math.round(he*(Ye*be-He))]}function et(je,Ye,he,be,Fe){for(var He=Ye===Fe.maxZoom?0:Fe.tolerance/((1<<Ye)*Fe.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:he,y:be,z:Ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ze=0;Ze<je.length;Ze++){Ke.numFeatures++,yt(Ke,je[Ze],He,Fe);var ut=je[Ze].minX,lt=je[Ze].minY,Lt=je[Ze].maxX,Ot=je[Ze].maxY;ut<Ke.minX&&(Ke.minX=ut),lt<Ke.minY&&(Ke.minY=lt),Lt>Ke.maxX&&(Ke.maxX=Lt),Ot>Ke.maxY&&(Ke.maxY=Ot)}return Ke}function yt(je,Ye,he,be){var Fe=Ye.geometry,He=Ye.type,Ke=[];if("Point"===He||"MultiPoint"===He)for(var Ze=0;Ze<Fe.length;Ze+=3)Ke.push(Fe[Ze]),Ke.push(Fe[Ze+1]),je.numPoints++,je.numSimplified++;else if("LineString"===He)Vt(Ke,Fe,je,he,!1,!1);else if("MultiLineString"===He||"Polygon"===He)for(Ze=0;Ze<Fe.length;Ze++)Vt(Ke,Fe[Ze],je,he,"Polygon"===He,0===Ze);else if("MultiPolygon"===He)for(var ut=0;ut<Fe.length;ut++){var lt=Fe[ut];for(Ze=0;Ze<lt.length;Ze++)Vt(Ke,lt[Ze],je,he,!0,0===Ze)}if(Ke.length){var Lt=Ye.tags||null;if("LineString"===He&&be.lineMetrics){for(var Ot in Lt={},Ye.tags)Lt[Ot]=Ye.tags[Ot];Lt.mapbox_clip_start=Fe.start/Fe.size,Lt.mapbox_clip_end=Fe.end/Fe.size}var ot={geometry:Ke,type:"Polygon"===He||"MultiPolygon"===He?3:"LineString"===He||"MultiLineString"===He?2:1,tags:Lt};null!==Ye.id&&(ot.id=Ye.id),je.features.push(ot)}}function Vt(je,Ye,he,be,Fe,He){var Ke=be*be;if(be>0&&Ye.size<(Fe?Ke:be))he.numPoints+=Ye.length/3;else{for(var Ze=[],ut=0;ut<Ye.length;ut+=3)(0===be||Ye[ut+2]>Ke)&&(he.numSimplified++,Ze.push(Ye[ut]),Ze.push(Ye[ut+1])),he.numPoints++;Fe&&function(lt,Lt){for(var Ot=0,ot=0,pt=lt.length,qt=pt-2;ot<pt;qt=ot,ot+=2)Ot+=(lt[ot]-lt[qt])*(lt[ot+1]+lt[qt+1]);if(Ot>0===Lt)for(ot=0,pt=lt.length;ot<pt/2;ot+=2){var St=lt[ot],Mt=lt[ot+1];lt[ot]=lt[pt-2-ot],lt[ot+1]=lt[pt-1-ot],lt[pt-2-ot]=St,lt[pt-1-ot]=Mt}}(Ze,He),je.push(Ze)}}function Gt(je,Ye){var he=(Ye=this.options=function(Fe,He){for(var Ke in He)Fe[Ke]=He[Ke];return Fe}(Object.create(this.options),Ye)).debug;if(he&&console.time("preprocess data"),Ye.maxZoom<0||Ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ye.promoteId&&Ye.generateId)throw new Error("promoteId and generateId cannot be used together.");var Fe,He,Ke,Ze,ut,lt,be=function(Fe,He){var Ke=[];if("FeatureCollection"===Fe.type)for(var Ze=0;Ze<Fe.features.length;Ze++)de(Ke,Fe.features[Ze],He,Ze);else de(Ke,"Feature"===Fe.type?Fe:{geometry:Fe},He);return Ke}(je,Ye);this.tiles={},this.tileCoords=[],he&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ye.indexMaxZoom,Ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Fe=be,He=Ye,Ke=He.buffer/He.extent,Ze=Fe,ut=Ie(Fe,1,-1-Ke,Ke,0,-1,2,He),lt=Ie(Fe,1,1-Ke,2+Ke,0,-1,2,He),(ut||lt)&&(Ze=Ie(Fe,1,-Ke,1+Ke,0,-1,2,He)||[],ut&&(Ze=wt(ut,1).concat(Ze)),lt&&(Ze=Ze.concat(wt(lt,-1)))),be=Ze).length&&this.splitTile(be,0,0,0),he&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function en(je,Ye,he){return 32*((1<<je)*he+Ye)+je}function Jt(je,Ye){var he=je.tileID.canonical;if(!this._geoJSONIndex)return Ye(null,null);var be=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!be)return Ye(null,null);var Fe=new _(be.features),He=M(Fe);0===He.byteOffset&&He.byteLength===He.buffer.byteLength||(He=new Uint8Array(He)),Ye(null,{vectorTile:Fe,rawData:He.buffer})}J.prototype.load=function(je){var Ye=this.options,he=Ye.log,be=Ye.minZoom,Fe=Ye.maxZoom,He=Ye.nodeSize;he&&console.time("total time");var Ke="prepare "+je.length+" points";he&&console.time(Ke),this.points=je;for(var Ze=[],ut=0;ut<je.length;ut++)je[ut].geometry&&Ze.push(ae(je[ut],ut));this.trees[Fe+1]=new B(Ze,Se,pe,He,Float32Array),he&&console.timeEnd(Ke);for(var lt=Fe;lt>=be;lt--){var Lt=+Date.now();Ze=this._cluster(Ze,lt),this.trees[lt]=new B(Ze,Se,pe,He,Float32Array),he&&console.log("z%d: %d clusters in %dms",lt,Ze.length,+Date.now()-Lt)}return he&&console.timeEnd("total time"),this},J.prototype.getClusters=function(je,Ye){var he=((je[0]+180)%360+360)%360-180,be=Math.max(-90,Math.min(90,je[1])),Fe=180===je[2]?180:((je[2]+180)%360+360)%360-180,He=Math.max(-90,Math.min(90,je[3]));if(je[2]-je[0]>=360)he=-180,Fe=180;else if(he>Fe){var Ke=this.getClusters([he,be,180,He],Ye),Ze=this.getClusters([-180,be,Fe,He],Ye);return Ke.concat(Ze)}for(var ut=this.trees[this._limitZoom(Ye)],lt=[],Lt=0,Ot=ut.range(ve(he),fe(He),ve(Fe),fe(be));Lt<Ot.length;Lt+=1){var pt=ut.points[Ot[Lt]];lt.push(pt.numPoints?ce(pt):this.points[pt.index])}return lt},J.prototype.getChildren=function(je){var Ye=this._getOriginId(je),he=this._getOriginZoom(je),be="No cluster with the specified id.",Fe=this.trees[he];if(!Fe)throw new Error(be);var He=Fe.points[Ye];if(!He)throw new Error(be);for(var Ke=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Ze=[],ut=0,lt=Fe.within(He.x,He.y,Ke);ut<lt.length;ut+=1){var Ot=Fe.points[lt[ut]];Ot.parentId===je&&Ze.push(Ot.numPoints?ce(Ot):this.points[Ot.index])}if(0===Ze.length)throw new Error(be);return Ze},J.prototype.getLeaves=function(je,Ye,he){var be=[];return this._appendLeaves(be,je,Ye=Ye||10,he=he||0,0),be},J.prototype.getTile=function(je,Ye,he){var be=this.trees[this._limitZoom(je)],Fe=Math.pow(2,je),He=this.options,Ze=He.radius/He.extent,ut=(he-Ze)/Fe,lt=(he+1+Ze)/Fe,Lt={features:[]};return this._addTileFeatures(be.range((Ye-Ze)/Fe,ut,(Ye+1+Ze)/Fe,lt),be.points,Ye,he,Fe,Lt),0===Ye&&this._addTileFeatures(be.range(1-Ze/Fe,ut,1,lt),be.points,Fe,he,Fe,Lt),Ye===Fe-1&&this._addTileFeatures(be.range(0,ut,Ze/Fe,lt),be.points,-1,he,Fe,Lt),Lt.features.length?Lt:null},J.prototype.getClusterExpansionZoom=function(je){for(var Ye=this._getOriginZoom(je)-1;Ye<=this.options.maxZoom;){var he=this.getChildren(je);if(Ye++,1!==he.length)break;je=he[0].properties.cluster_id}return Ye},J.prototype._appendLeaves=function(je,Ye,he,be,Fe){for(var He=0,Ke=this.getChildren(Ye);He<Ke.length;He+=1){var Ze=Ke[He],ut=Ze.properties;if(ut&&ut.cluster?Fe+ut.point_count<=be?Fe+=ut.point_count:Fe=this._appendLeaves(je,ut.cluster_id,he,be,Fe):Fe<be?Fe++:je.push(Ze),je.length===he)break}return Fe},J.prototype._addTileFeatures=function(je,Ye,he,be,Fe,He){for(var Ke=0,Ze=je;Ke<Ze.length;Ke+=1){var ut=Ye[Ze[Ke]],lt=ut.numPoints,Lt={type:1,geometry:[[Math.round(this.options.extent*(ut.x*Fe-he)),Math.round(this.options.extent*(ut.y*Fe-be))]],tags:lt?oe(ut):this.points[ut.index].properties},Ot=void 0;lt?Ot=ut.id:this.options.generateId?Ot=ut.index:this.points[ut.index].id&&(Ot=this.points[ut.index].id),void 0!==Ot&&(Lt.id=Ot),He.features.push(Lt)}},J.prototype._limitZoom=function(je){return Math.max(this.options.minZoom,Math.min(je,this.options.maxZoom+1))},J.prototype._cluster=function(je,Ye){for(var he=[],be=this.options,Ke=be.reduce,Ze=be.radius/(be.extent*Math.pow(2,Ye)),ut=0;ut<je.length;ut++){var lt=je[ut];if(!(lt.zoom<=Ye)){lt.zoom=Ye;for(var Lt=this.trees[Ye+1],Ot=Lt.within(lt.x,lt.y,Ze),ot=lt.numPoints||1,pt=lt.x*ot,qt=lt.y*ot,St=Ke&&ot>1?this._map(lt,!0):null,Mt=(ut<<5)+(Ye+1)+this.points.length,Ce=0,Xe=Ot;Ce<Xe.length;Ce+=1){var dt=Lt.points[Xe[Ce]];if(!(dt.zoom<=Ye)){dt.zoom=Ye;var zt=dt.numPoints||1;pt+=dt.x*zt,qt+=dt.y*zt,ot+=zt,dt.parentId=Mt,Ke&&(St||(St=this._map(lt,!0)),Ke(St,this._map(dt)))}}1===ot?he.push(lt):(lt.parentId=Mt,he.push(te(pt/ot,qt/ot,Mt,ot,St)))}}return he},J.prototype._getOriginId=function(je){return je-this.points.length>>5},J.prototype._getOriginZoom=function(je){return(je-this.points.length)%32},J.prototype._map=function(je,Ye){if(je.numPoints)return Ye?xe({},je.properties):je.properties;var he=this.points[je.index].properties,be=this.options.map(he);return Ye&&be===he?xe({},be):be},Gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gt.prototype.splitTile=function(je,Ye,he,be,Fe,He,Ke){for(var Ze=[je,Ye,he,be],ut=this.options,lt=ut.debug;Ze.length;){be=Ze.pop(),he=Ze.pop(),Ye=Ze.pop(),je=Ze.pop();var Lt=1<<Ye,Ot=en(Ye,he,be),ot=this.tiles[Ot];if(!ot&&(lt>1&&console.time("creation"),ot=this.tiles[Ot]=et(je,Ye,he,be,ut),this.tileCoords.push({z:Ye,x:he,y:be}),lt)){lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ye,he,be,ot.numFeatures,ot.numPoints,ot.numSimplified),console.timeEnd("creation"));var pt="z"+Ye;this.stats[pt]=(this.stats[pt]||0)+1,this.total++}if(ot.source=je,Fe){if(Ye===ut.maxZoom||Ye===Fe)continue;var qt=1<<Fe-Ye;if(he!==Math.floor(He/qt)||be!==Math.floor(Ke/qt))continue}else if(Ye===ut.indexMaxZoom||ot.numPoints<=ut.indexMaxPoints)continue;if(ot.source=null,0!==je.length){lt>1&&console.time("clipping");var St,Mt,Ce,Xe,st,dt,zt=.5*ut.buffer/ut.extent,Ht=.5-zt,Kt=.5+zt,Zt=1+zt;St=Mt=Ce=Xe=null,st=Ie(je,Lt,he-zt,he+Kt,0,ot.minX,ot.maxX,ut),dt=Ie(je,Lt,he+Ht,he+Zt,0,ot.minX,ot.maxX,ut),je=null,st&&(St=Ie(st,Lt,be-zt,be+Kt,1,ot.minY,ot.maxY,ut),Mt=Ie(st,Lt,be+Ht,be+Zt,1,ot.minY,ot.maxY,ut),st=null),dt&&(Ce=Ie(dt,Lt,be-zt,be+Kt,1,ot.minY,ot.maxY,ut),Xe=Ie(dt,Lt,be+Ht,be+Zt,1,ot.minY,ot.maxY,ut),dt=null),lt>1&&console.timeEnd("clipping"),Ze.push(St||[],Ye+1,2*he,2*be),Ze.push(Mt||[],Ye+1,2*he,2*be+1),Ze.push(Ce||[],Ye+1,2*he+1,2*be),Ze.push(Xe||[],Ye+1,2*he+1,2*be+1)}}},Gt.prototype.getTile=function(je,Ye,he){var be=this.options,Fe=be.extent,He=be.debug;if(je<0||je>24)return null;var Ke=1<<je,Ze=en(je,Ye=(Ye%Ke+Ke)%Ke,he);if(this.tiles[Ze])return gt(this.tiles[Ze],Fe);He>1&&console.log("drilling down to z%d-%d-%d",je,Ye,he);for(var ut,lt=je,Lt=Ye,Ot=he;!ut&&lt>0;)lt--,Lt=Math.floor(Lt/2),Ot=Math.floor(Ot/2),ut=this.tiles[en(lt,Lt,Ot)];return ut&&ut.source?(He>1&&console.log("found parent tile z%d-%d-%d",lt,Lt,Ot),He>1&&console.time("drilling down"),this.splitTile(ut.source,lt,Lt,Ot,je,Ye,he),He>1&&console.timeEnd("drilling down"),this.tiles[Ze]?gt(this.tiles[Ze],Fe):null):null};var cn=function(je){function Ye(he,be,Fe,He){je.call(this,he,be,Fe,Jt),He&&(this.loadGeoJSON=He)}return je&&(Ye.__proto__=je),(Ye.prototype=Object.create(je&&je.prototype)).constructor=Ye,Ye.prototype.loadData=function(he,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=be,this._pendingLoadDataParams=he,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ye.prototype._loadData=function(){var he=this;if(this._pendingCallback&&this._pendingLoadDataParams){var be=this._pendingCallback,Fe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var He=!!(Fe&&Fe.request&&Fe.request.collectResourceTiming)&&new e.RequestPerformance(Fe.request);this.loadGeoJSON(Fe,function(Ke,Ze){if(Ke||!Ze)return be(Ke);if("object"!=typeof Ze)return be(new Error("Input data given to '"+Fe.source+"' is not a valid GeoJSON object."));d(Ze,!0);try{he._geoJSONIndex=Fe.cluster?new J(function(Lt){var Ot=Lt.superclusterOptions,ot=Lt.clusterProperties;if(!ot||!Ot)return Ot;for(var pt={},qt={},St={accumulated:null,zoom:0},Mt={properties:null},Ce=Object.keys(ot),Xe=0,st=Ce;Xe<st.length;Xe+=1){var dt=st[Xe],zt=ot[dt],Ht=zt[0],Zt=e.createExpression(zt[1]),vn=e.createExpression("string"==typeof Ht?[Ht,["accumulated"],["get",dt]]:Ht);pt[dt]=Zt.value,qt[dt]=vn.value}return Ot.map=function(zn){Mt.properties=zn;for(var gn={},nn=0,an=Ce;nn<an.length;nn+=1){var on=an[nn];gn[on]=pt[on].evaluate(St,Mt)}return gn},Ot.reduce=function(zn,gn){Mt.properties=gn;for(var nn=0,an=Ce;nn<an.length;nn+=1){var on=an[nn];St.accumulated=zn[on],zn[on]=qt[on].evaluate(St,Mt)}},Ot}(Fe)).load(Ze.features):new Gt(Lt=Ze,Fe.geojsonVtOptions)}catch(Lt){return be(Lt)}var Lt;he.loaded={};var ut={};if(He){var lt=He.finish();lt&&(ut.resourceTiming={},ut.resourceTiming[Fe.source]=JSON.parse(JSON.stringify(lt)))}be(null,ut)})}},Ye.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},Ye.prototype.reloadTile=function(he,be){var Fe=this.loaded;return Fe&&Fe[he.uid]?je.prototype.reloadTile.call(this,he,be):this.loadTile(he,be)},Ye.prototype.loadGeoJSON=function(he,be){if(he.request)e.getJSON(he.request,be);else{if("string"!=typeof he.data)return be(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."));try{return be(null,JSON.parse(he.data))}catch(Fe){return be(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."))}}},Ye.prototype.removeSource=function(he,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),be()},Ye.prototype.getClusterExpansionZoom=function(he,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(Fe){be(Fe)}},Ye.prototype.getClusterChildren=function(he,be){try{be(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(Fe){be(Fe)}},Ye.prototype.getClusterLeaves=function(he,be){try{be(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(Fe){be(Fe)}},Ye}(f),Rt=function(je){var Ye=this;this.self=je,this.actor=new e.Actor(je,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:f,geojson:cn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(he,be){if(Ye.workerSourceTypes[he])throw new Error('Worker source with name "'+he+'" already registered.');Ye.workerSourceTypes[he]=be},this.self.registerRTLTextPlugin=function(he){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=he.applyArabicShaping,e.plugin.processBidirectionalText=he.processBidirectionalText,e.plugin.processStyledBidirectionalText=he.processStyledBidirectionalText}};return Rt.prototype.setReferrer=function(je,Ye){this.referrer=Ye},Rt.prototype.setImages=function(je,Ye,he){for(var be in this.availableImages[je]=Ye,this.workerSources[je]){var Fe=this.workerSources[je][be];for(var He in Fe)Fe[He].availableImages=Ye}he()},Rt.prototype.setLayers=function(je,Ye,he){this.getLayerIndex(je).replace(Ye),he()},Rt.prototype.updateLayers=function(je,Ye,he){this.getLayerIndex(je).update(Ye.layers,Ye.removedIds),he()},Rt.prototype.loadTile=function(je,Ye,he){this.getWorkerSource(je,Ye.type,Ye.source).loadTile(Ye,he)},Rt.prototype.loadDEMTile=function(je,Ye,he){this.getDEMWorkerSource(je,Ye.source).loadTile(Ye,he)},Rt.prototype.reloadTile=function(je,Ye,he){this.getWorkerSource(je,Ye.type,Ye.source).reloadTile(Ye,he)},Rt.prototype.abortTile=function(je,Ye,he){this.getWorkerSource(je,Ye.type,Ye.source).abortTile(Ye,he)},Rt.prototype.removeTile=function(je,Ye,he){this.getWorkerSource(je,Ye.type,Ye.source).removeTile(Ye,he)},Rt.prototype.removeDEMTile=function(je,Ye){this.getDEMWorkerSource(je,Ye.source).removeTile(Ye)},Rt.prototype.removeSource=function(je,Ye,he){if(this.workerSources[je]&&this.workerSources[je][Ye.type]&&this.workerSources[je][Ye.type][Ye.source]){var be=this.workerSources[je][Ye.type][Ye.source];delete this.workerSources[je][Ye.type][Ye.source],void 0!==be.removeSource?be.removeSource(Ye,he):he()}},Rt.prototype.loadWorkerSource=function(je,Ye,he){try{this.self.importScripts(Ye.url),he()}catch(be){he(be.toString())}},Rt.prototype.syncRTLPluginState=function(je,Ye,he){try{e.plugin.setState(Ye);var be=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=be){this.self.importScripts(be);var Fe=e.plugin.isParsed();he(Fe?void 0:new Error("RTL Text Plugin failed to import scripts from "+be),Fe)}}catch(He){he(He.toString())}},Rt.prototype.getAvailableImages=function(je){var Ye=this.availableImages[je];return Ye||(Ye=[]),Ye},Rt.prototype.getLayerIndex=function(je){var Ye=this.layerIndexes[je];return Ye||(Ye=this.layerIndexes[je]=new c),Ye},Rt.prototype.getWorkerSource=function(je,Ye,he){var be=this;return this.workerSources[je]||(this.workerSources[je]={}),this.workerSources[je][Ye]||(this.workerSources[je][Ye]={}),this.workerSources[je][Ye][he]||(this.workerSources[je][Ye][he]=new this.workerSourceTypes[Ye]({send:function(He,Ke,Ze){be.actor.send(He,Ke,Ze,je)}},this.getLayerIndex(je),this.getAvailableImages(je))),this.workerSources[je][Ye][he]},Rt.prototype.getDEMWorkerSource=function(je,Ye){return this.demWorkerSources[je]||(this.demWorkerSources[je]={}),this.demWorkerSources[je][Ye]||(this.demWorkerSources[je][Ye]=new o),this.demWorkerSources[je][Ye]},Rt.prototype.enforceCacheSizeLimit=function(je,Ye){e.enforceCacheSizeLimit(Ye)},"undefined"!=typeof WorkerGlobalScope&&void 0!==e.window&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Rt(e.window)),Rt}),x(0,function(e){var r=e.createCommonjsModule(function(E){function I(re){return!F(re)}function F(re){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var ue,ye,ke=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ke);try{ye=new Worker(Ee),ue=!0}catch(Ue){ue=!1}return ye&&ye.terminate(),URL.revokeObjectURL(Ee),ue}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var ue=document.createElement("canvas");ue.width=ue.height=1;var ye=ue.getContext("2d");if(!ye)return!1;var ke=ye.getImageData(0,0,1,1);return ke&&ke.width===ue.width}()?(void 0===H[ue=re&&re.failIfMajorPerformanceCaveat]&&(H[ue]=function(ye){var Ue,$e,it,ke=(Ue=ye,$e=document.createElement("canvas"),(it=Object.create(I.webGLContextAttributes)).failIfMajorPerformanceCaveat=Ue,$e.probablySupportsContext?$e.probablySupportsContext("webgl",it)||$e.probablySupportsContext("experimental-webgl",it):$e.supportsContext?$e.supportsContext("webgl",it)||$e.supportsContext("experimental-webgl",it):$e.getContext("webgl",it)||$e.getContext("experimental-webgl",it));if(!ke)return!1;var Ee=ke.createShader(ke.VERTEX_SHADER);return!(!Ee||ke.isContextLost())&&(ke.shaderSource(Ee,"void main() {}"),ke.compileShader(Ee),!0===ke.getShaderParameter(Ee,ke.COMPILE_STATUS))}(ue)),H[ue]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var ue}E.exports?E.exports=I:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=I,window.mapboxgl.notSupportedReason=F);var H={};I.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),i={create:function(E,I,F){var H=e.window.document.createElement(E);return void 0!==I&&(H.className=I),F&&F.appendChild(H),H},createNS:function(E,I){return e.window.document.createElementNS(E,I)}},c=e.window.document.documentElement.style;function n(E){if(!c)return E[0];for(var I=0;I<E.length;I++)if(E[I]in c)return E[I];return E[0]}var m,p=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){c&&p&&(m=c[p],c[p]="none")},i.enableDrag=function(){c&&p&&(c[p]=m)};var s=n(["transform","WebkitTransform"]);i.setTransform=function(E,I){E.style[s]=I};var f=!1;try{var l=Object.defineProperty({},"passive",{get:function(){f=!0}});e.window.addEventListener("test",l,l),e.window.removeEventListener("test",l,l)}catch(E){f=!1}i.addEventListener=function(E,I,F,H){void 0===H&&(H={}),E.addEventListener(I,F,"passive"in H&&f?H:H.capture)},i.removeEventListener=function(E,I,F,H){void 0===H&&(H={}),E.removeEventListener(I,F,"passive"in H&&f?H:H.capture)};var o=function(E){E.preventDefault(),E.stopPropagation(),e.window.removeEventListener("click",o,!0)};function d(E){var I=E.userImage;return!!(I&&I.render&&I.render())&&(E.data.replace(new Uint8Array(I.data.buffer)),!0)}i.suppressClick=function(){e.window.addEventListener("click",o,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",o,!0)},0)},i.mousePos=function(E,I){var F=E.getBoundingClientRect();return new e.Point(I.clientX-F.left-E.clientLeft,I.clientY-F.top-E.clientTop)},i.touchPos=function(E,I){for(var F=E.getBoundingClientRect(),H=[],re=0;re<I.length;re++)H.push(new e.Point(I[re].clientX-F.left-E.clientLeft,I[re].clientY-F.top-E.clientTop));return H},i.mouseButton=function(E){return void 0!==e.window.InstallTrigger&&2===E.button&&E.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:E.button},i.remove=function(E){E.parentNode&&E.parentNode.removeChild(E)};var u=function(E){function I(){E.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.isLoaded=function(){return this.loaded},I.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var H=0,re=this.requestors;H<re.length;H+=1){var ue=re[H];this._notify(ue.ids,ue.callback)}this.requestors=[]}},I.prototype.getImage=function(F){return this.images[F]},I.prototype.addImage=function(F,H){this._validate(F,H)&&(this.images[F]=H)},I.prototype._validate=function(F,H){var re=!0;return this._validateStretch(H.stretchX,H.data&&H.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),re=!1),this._validateStretch(H.stretchY,H.data&&H.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),re=!1),this._validateContent(H.content,H)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),re=!1),re},I.prototype._validateStretch=function(F,H){if(!F)return!0;for(var re=0,ue=0,ye=F;ue<ye.length;ue+=1){var ke=ye[ue];if(ke[0]<re||ke[1]<ke[0]||H<ke[1])return!1;re=ke[1]}return!0},I.prototype._validateContent=function(F,H){return!(F&&(4!==F.length||F[0]<0||H.data.width<F[0]||F[1]<0||H.data.height<F[1]||F[2]<0||H.data.width<F[2]||F[3]<0||H.data.height<F[3]||F[2]<F[0]||F[3]<F[1]))},I.prototype.updateImage=function(F,H){H.version=this.images[F].version+1,this.images[F]=H,this.updatedImages[F]=!0},I.prototype.removeImage=function(F){var H=this.images[F];delete this.images[F],delete this.patterns[F],H.userImage&&H.userImage.onRemove&&H.userImage.onRemove()},I.prototype.listImages=function(){return Object.keys(this.images)},I.prototype.getImages=function(F,H){var re=!0;if(!this.isLoaded())for(var ue=0,ye=F;ue<ye.length;ue+=1)this.images[ye[ue]]||(re=!1);this.isLoaded()||re?this._notify(F,H):this.requestors.push({ids:F,callback:H})},I.prototype._notify=function(F,H){for(var re={},ue=0,ye=F;ue<ye.length;ue+=1){var ke=ye[ue];this.images[ke]||this.fire(new e.Event("styleimagemissing",{id:ke}));var Ee=this.images[ke];Ee?re[ke]={data:Ee.data.clone(),pixelRatio:Ee.pixelRatio,sdf:Ee.sdf,version:Ee.version,stretchX:Ee.stretchX,stretchY:Ee.stretchY,content:Ee.content,hasRenderCallback:Boolean(Ee.userImage&&Ee.userImage.render)}:e.warnOnce('Image "'+ke+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}H(null,re)},I.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},I.prototype.getPattern=function(F){var H=this.patterns[F],re=this.getImage(F);if(!re)return null;if(H&&H.position.version===re.version)return H.position;if(H)H.position.version=re.version;else{var ue={w:re.data.width+2,h:re.data.height+2,x:0,y:0},ye=new e.ImagePosition(ue,re);this.patterns[F]={bin:ue,position:ye}}return this._updatePatternAtlas(),this.patterns[F].position},I.prototype.bind=function(F){var H=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,H.RGBA),this.atlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE)},I.prototype._updatePatternAtlas=function(){var F=[];for(var H in this.patterns)F.push(this.patterns[H].bin);var re=e.potpack(F),ue=re.w,ye=re.h,ke=this.atlasImage;for(var Ee in ke.resize({width:ue||1,height:ye||1}),this.patterns){var Ue=this.patterns[Ee].bin,$e=Ue.x+1,it=Ue.y+1,_t=this.images[Ee].data,Ct=_t.width,At=_t.height;e.RGBAImage.copy(_t,ke,{x:0,y:0},{x:$e,y:it},{width:Ct,height:At}),e.RGBAImage.copy(_t,ke,{x:0,y:At-1},{x:$e,y:it-1},{width:Ct,height:1}),e.RGBAImage.copy(_t,ke,{x:0,y:0},{x:$e,y:it+At},{width:Ct,height:1}),e.RGBAImage.copy(_t,ke,{x:Ct-1,y:0},{x:$e-1,y:it},{width:1,height:At}),e.RGBAImage.copy(_t,ke,{x:0,y:0},{x:$e+Ct,y:it},{width:1,height:At})}this.dirty=!0},I.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},I.prototype.dispatchRenderCallbacks=function(F){for(var H=0,re=F;H<re.length;H+=1){var ue=re[H];if(!this.callbackDispatchedThisFrame[ue]){this.callbackDispatchedThisFrame[ue]=!0;var ye=this.images[ue];d(ye)&&this.updateImage(ue,ye)}}},I}(e.Evented),a=_,y=_,h=1e20;function _(E,I,F,H,re,ue){this.fontSize=E||24,this.buffer=void 0===I?3:I,this.cutoff=H||.25,this.fontFamily=re||"sans-serif",this.fontWeight=ue||"normal",this.radius=F||8;var ye=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=ye,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ye*ye),this.gridInner=new Float64Array(ye*ye),this.f=new Float64Array(ye),this.d=new Float64Array(ye),this.z=new Float64Array(ye+1),this.v=new Int16Array(ye),this.middle=Math.round(ye/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function b(E,I,F,H,re,ue,ye){for(var ke=0;ke<I;ke++){for(var Ee=0;Ee<F;Ee++)H[Ee]=E[Ee*I+ke];for(w(H,re,ue,ye,F),Ee=0;Ee<F;Ee++)E[Ee*I+ke]=re[Ee]}for(Ee=0;Ee<F;Ee++){for(ke=0;ke<I;ke++)H[ke]=E[Ee*I+ke];for(w(H,re,ue,ye,I),ke=0;ke<I;ke++)E[Ee*I+ke]=Math.sqrt(re[ke])}}function w(E,I,F,H,re){F[0]=0,H[0]=-h,H[1]=+h;for(var ue=1,ye=0;ue<re;ue++){for(var ke=(E[ue]+ue*ue-(E[F[ye]]+F[ye]*F[ye]))/(2*ue-2*F[ye]);ke<=H[ye];)ye--,ke=(E[ue]+ue*ue-(E[F[ye]]+F[ye]*F[ye]))/(2*ue-2*F[ye]);F[++ye]=ue,H[ye]=ke,H[ye+1]=+h}for(ue=0,ye=0;ue<re;ue++){for(;H[ye+1]<ue;)ye++;I[ue]=(ue-F[ye])*(ue-F[ye])+E[F[ye]]}}_.prototype.draw=function(E){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(E,this.buffer,this.middle);for(var I=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),H=0;H<this.size*this.size;H++){var re=I.data[4*H+3]/255;this.gridOuter[H]=1===re?0:0===re?h:Math.pow(Math.max(0,.5-re),2),this.gridInner[H]=1===re?h:0===re?0:Math.pow(Math.max(0,re-.5),2)}for(b(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),b(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),H=0;H<this.size*this.size;H++)F[H]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[H]-this.gridInner[H])/this.radius+this.cutoff))));return F},a.default=y;var T=function(E,I){this.requestManager=E,this.localIdeographFontFamily=I,this.entries={}};T.prototype.setURL=function(E){this.url=E},T.prototype.getGlyphs=function(E,I){var F=this,H=[];for(var re in E)for(var ue=0,ye=E[re];ue<ye.length;ue+=1)H.push({stack:re,id:ye[ue]});e.asyncAll(H,function(Ee,Ue){var $e=Ee.stack,it=Ee.id,_t=F.entries[$e];_t||(_t=F.entries[$e]={glyphs:{},requests:{},ranges:{}});var Ct=_t.glyphs[it];if(void 0===Ct){if(Ct=F._tinySDF(_t,$e,it))return _t.glyphs[it]=Ct,void Ue(null,{stack:$e,id:it,glyph:Ct});var At=Math.floor(it/256);if(256*At>65535)Ue(new Error("glyphs > 65535 not supported"));else if(_t.ranges[At])Ue(null,{stack:$e,id:it,glyph:Ct});else{var Et=_t.requests[At];Et||(Et=_t.requests[At]=[],T.loadGlyphRange($e,At,F.url,F.requestManager,function(Tt,jt){if(jt){for(var Nt in jt)F._doesCharSupportLocalGlyph(+Nt)||(_t.glyphs[+Nt]=jt[+Nt]);_t.ranges[At]=!0}for(var Yt=0,ln=Et;Yt<ln.length;Yt+=1)(0,ln[Yt])(Tt,jt);delete _t.requests[At]})),Et.push(function(Tt,jt){Tt?Ue(Tt):jt&&Ue(null,{stack:$e,id:it,glyph:jt[it]||null})})}}else Ue(null,{stack:$e,id:it,glyph:Ct})},function(Ee,Ue){if(Ee)I(Ee);else if(Ue){for(var $e={},it=0,_t=Ue;it<_t.length;it+=1){var Ct=_t[it],At=Ct.stack,Et=Ct.id,Tt=Ct.glyph;($e[At]||($e[At]={}))[Et]=Tt&&{id:Tt.id,bitmap:Tt.bitmap.clone(),metrics:Tt.metrics}}I(null,$e)}})},T.prototype._doesCharSupportLocalGlyph=function(E){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](E)||e.isChar["Hangul Syllables"](E)||e.isChar.Hiragana(E)||e.isChar.Katakana(E))},T.prototype._tinySDF=function(E,I,F){var H=this.localIdeographFontFamily;if(H&&this._doesCharSupportLocalGlyph(F)){var re=E.tinySDF;if(!re){var ue="400";/bold/i.test(I)?ue="900":/medium/i.test(I)?ue="500":/light/i.test(I)&&(ue="200"),re=E.tinySDF=new T.TinySDF(24,3,8,.25,H,ue)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},re.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},T.loadGlyphRange=function(E,I,F,H,re){var ue=256*I,ye=ue+255,ke=H.transformRequest(H.normalizeGlyphsURL(F).replace("{fontstack}",E).replace("{range}",ue+"-"+ye),e.ResourceType.Glyphs);e.getArrayBuffer(ke,function(Ee,Ue){if(Ee)re(Ee);else if(Ue){for(var $e={},it=0,_t=e.parseGlyphPBF(Ue);it<_t.length;it+=1){var Ct=_t[it];$e[Ct.id]=Ct}re(null,$e)}})},T.TinySDF=a;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(E,I){return e.sphericalToCartesian(E.expression.evaluate(I))},L.prototype.interpolate=function(E,I,F){return{x:e.number(E.x,I.x,F),y:e.number(E.y,I.y,F),z:e.number(E.z,I.z,F)}};var M=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),P=function(E){function I(F){E.call(this),this._transitionable=new e.Transitionable(M),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getLight=function(){return this._transitionable.serialize()},I.prototype.setLight=function(F,H){if(void 0===H&&(H={}),!this._validate(e.validateLight,F,H))for(var re in F){var ue=F[re];e.endsWith(re,"-transition")?this._transitionable.setTransition(re.slice(0,-11),ue):this._transitionable.setValue(re,ue)}},I.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},I.prototype.hasTransition=function(){return this._transitioning.hasTransition()},I.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},I.prototype._validate=function(F,H,re){return(!re||!1!==re.validate)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:H,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},I}(e.Evented),z=function(E,I){this.width=E,this.height=I,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};z.prototype.getDash=function(E,I){var F=E.join(",")+String(I);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(E,I)),this.dashEntry[F]},z.prototype.getDashRanges=function(E,I,F){var H=[],re=E.length%2==1?-E[E.length-1]*F:0,ue=E[0]*F,ye=!0;H.push({left:re,right:ue,isDash:ye,zeroLength:0===E[0]});for(var ke=E[0],Ee=1;Ee<E.length;Ee++){var Ue=E[Ee];re=ke*F,ue=(ke+=Ue)*F,H.push({left:re,right:ue,isDash:ye=!ye,zeroLength:0===Ue})}return H},z.prototype.addRoundDash=function(E,I,F){for(var H=I/2,re=-F;re<=F;re++)for(var ye=this.width*(this.nextRow+F+re),ke=0,Ee=E[ke],Ue=0;Ue<this.width;Ue++){Ue/Ee.right>1&&(Ee=E[++ke]);var $e=Math.abs(Ue-Ee.left),it=Math.abs(Ue-Ee.right),_t=Math.min($e,it),Ct=void 0,At=re/F*(H+1);if(Ee.isDash){var Et=H-Math.abs(At);Ct=Math.sqrt(_t*_t+Et*Et)}else Ct=H-Math.sqrt(_t*_t+At*At);this.data[ye+Ue]=Math.max(0,Math.min(255,Ct+128))}},z.prototype.addRegularDash=function(E){for(var I=E.length-1;I>=0;--I){var F=E[I],H=E[I+1];F.zeroLength?E.splice(I,1):H&&H.isDash===F.isDash&&(H.left=F.left,E.splice(I,1))}var re=E[0],ue=E[E.length-1];re.isDash===ue.isDash&&(re.left=ue.left-this.width,ue.right=re.right+this.width);for(var ye=this.width*this.nextRow,ke=0,Ee=E[ke],Ue=0;Ue<this.width;Ue++){Ue/Ee.right>1&&(Ee=E[++ke]);var $e=Math.abs(Ue-Ee.left),it=Math.abs(Ue-Ee.right),_t=Math.min($e,it);this.data[ye+Ue]=Math.max(0,Math.min(255,(Ee.isDash?_t:-_t)+128))}},z.prototype.addDash=function(E,I){var F=I?7:0,H=2*F+1;if(this.nextRow+H>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var re=0,ue=0;ue<E.length;ue++)re+=E[ue];if(0!==re){var ye=this.width/re,ke=this.getDashRanges(E,this.width,ye);I?this.addRoundDash(ke,ye,F):this.addRegularDash(ke)}var Ee={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:re};return this.nextRow+=H,this.dirty=!0,Ee},z.prototype.bind=function(E){var I=E.gl;this.texture?(I.bindTexture(I.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,I.texSubImage2D(I.TEXTURE_2D,0,0,0,this.width,this.height,I.ALPHA,I.UNSIGNED_BYTE,this.data))):(this.texture=I.createTexture(),I.bindTexture(I.TEXTURE_2D,this.texture),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,I.REPEAT),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,I.REPEAT),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.LINEAR),I.texImage2D(I.TEXTURE_2D,0,I.ALPHA,this.width,this.height,0,I.ALPHA,I.UNSIGNED_BYTE,this.data))};var S=function E(I,F){this.workerPool=I,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var H=this.workerPool.acquire(this.id),re=0;re<H.length;re++){var ye=new E.Actor(H[re],F,this.id);ye.name="Worker "+re,this.actors.push(ye)}};function C(E,I,F){var H=function(re,ue){if(re)return F(re);if(ue){var ye=e.pick(e.extend(ue,E),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);ue.vector_layers&&(ye.vectorLayers=ue.vector_layers,ye.vectorLayerIds=ye.vectorLayers.map(function(ke){return ke.id})),ye.tiles=I.canonicalizeTileset(ye,E.url),F(null,ye)}};return E.url?e.getJSON(I.transformRequest(I.normalizeSourceURL(E.url),e.ResourceType.Source),H):e.browser.frame(function(){return H(null,E)})}S.prototype.broadcast=function(E,I,F){e.asyncAll(this.actors,function(H,re){H.send(E,I,re)},F=F||function(){})},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(E){E.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=e.Actor;var R=function(E,I,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(E)),this.minzoom=I||0,this.maxzoom=F||24};R.prototype.validateBounds=function(E){return Array.isArray(E)&&4===E.length?[Math.max(-180,E[0]),Math.max(-90,E[1]),Math.min(180,E[2]),Math.min(90,E[3])]:[-180,-90,180,90]},R.prototype.contains=function(E){var I=Math.pow(2,E.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*I),H=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*I),re=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*I),ue=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*I);return E.x>=F&&E.x<re&&E.y>=H&&E.y<ue};var D=function(E){function I(F,H,re,ue){if(E.call(this),this.id=F,this.dispatcher=re,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(H,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},H),this._collectResourceTiming=H.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(ue)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=C(this._options,this.map._requestManager,function(H,re){F._tileJSONRequest=null,F._loaded=!0,H?F.fire(new e.ErrorEvent(H)):re&&(e.extend(F,re),re.bounds&&(F.tileBounds=new R(re.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(re.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(re.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},I.prototype.loaded=function(){return this._loaded},I.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},I.prototype.onAdd=function(F){this.map=F,this.load()},I.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},I.prototype.serialize=function(){return e.extend({},this._options)},I.prototype.loadTile=function(F,H){var re=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),ue={request:this.map._requestManager.transformRequest(re,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function ye(ke,Ee){return delete F.request,F.aborted?H(null):ke&&404!==ke.status?H(ke):(Ee&&Ee.resourceTiming&&(F.resourceTiming=Ee.resourceTiming),this.map._refreshExpiredTiles&&Ee&&F.setExpiryData(Ee),F.loadVectorData(Ee,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),H(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}ue.request.collectResourceTiming=this._collectResourceTiming,F.actor&&"expired"!==F.state?"loading"===F.state?F.reloadCallback=H:F.request=F.actor.send("reloadTile",ue,ye.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",ue,ye.bind(this)))},I.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},I.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},I.prototype.hasTransition=function(){return!1},I}(e.Evented),j=function(E){function I(F,H,re,ue){E.call(this),this.id=F,this.dispatcher=re,this.setEventedParent(ue),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},H),e.extend(this,e.pick(H,["url","scheme","tileSize"]))}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=C(this._options,this.map._requestManager,function(H,re){F._tileJSONRequest=null,F._loaded=!0,H?F.fire(new e.ErrorEvent(H)):re&&(e.extend(F,re),re.bounds&&(F.tileBounds=new R(re.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(re.tiles),e.postMapLoadEvent(re.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},I.prototype.loaded=function(){return this._loaded},I.prototype.onAdd=function(F){this.map=F,this.load()},I.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},I.prototype.serialize=function(){return e.extend({},this._options)},I.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},I.prototype.loadTile=function(F,H){var re=this,ue=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(ue,e.ResourceType.Tile),function(ye,ke){if(delete F.request,F.aborted)F.state="unloaded",H(null);else if(ye)F.state="errored",H(ye);else if(ke){re.map._refreshExpiredTiles&&F.setExpiryData(ke),delete ke.cacheControl,delete ke.expires;var Ee=re.map.painter.context,Ue=Ee.gl;F.texture=re.map.painter.getTileTexture(ke.width),F.texture?F.texture.update(ke,{useMipmap:!0}):(F.texture=new e.Texture(Ee,ke,Ue.RGBA,{useMipmap:!0}),F.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE,Ue.LINEAR_MIPMAP_NEAREST),Ee.extTextureFilterAnisotropic&&Ue.texParameterf(Ue.TEXTURE_2D,Ee.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ee.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(re.dispatcher),H(null)}})},I.prototype.abortTile=function(F,H){F.request&&(F.request.cancel(),delete F.request),H()},I.prototype.unloadTile=function(F,H){F.texture&&this.map.painter.saveTileTexture(F.texture),H()},I.prototype.hasTransition=function(){return!1},I}(e.Evented),q=function(E){function I(F,H,re,ue){E.call(this,F,H,re,ue),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},H),this.encoding=H.encoding||"mapbox"}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},I.prototype.loadTile=function(F,H){var re=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function ue(ye,ke){ye&&(F.state="errored",H(ye)),ke&&(F.dem=ke,F.needsHillshadePrepare=!0,F.state="loaded",H(null))}F.request=e.getImage(this.map._requestManager.transformRequest(re,e.ResourceType.Tile),function(ye,ke){if(delete F.request,F.aborted)F.state="unloaded",H(null);else if(ye)F.state="errored",H(ye);else if(ke){this.map._refreshExpiredTiles&&F.setExpiryData(ke),delete ke.cacheControl,delete ke.expires;var Ee=e.window.ImageBitmap&&ke instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ke:e.browser.getImageData(ke,1),Ue={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Ee,encoding:this.encoding};F.actor&&"expired"!==F.state||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",Ue,ue.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},I.prototype._getNeighboringTiles=function(F){var H=F.canonical,re=Math.pow(2,H.z),ue=(H.x-1+re)%re,ye=0===H.x?F.wrap-1:F.wrap,ke=(H.x+1+re)%re,Ee=H.x+1===re?F.wrap+1:F.wrap,Ue={};return Ue[new e.OverscaledTileID(F.overscaledZ,ye,H.z,ue,H.y).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,Ee,H.z,ke,H.y).key]={backfilled:!1},H.y>0&&(Ue[new e.OverscaledTileID(F.overscaledZ,ye,H.z,ue,H.y-1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,F.wrap,H.z,H.x,H.y-1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,Ee,H.z,ke,H.y-1).key]={backfilled:!1}),H.y+1<re&&(Ue[new e.OverscaledTileID(F.overscaledZ,ye,H.z,ue,H.y+1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,F.wrap,H.z,H.x,H.y+1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,Ee,H.z,ke,H.y+1).key]={backfilled:!1}),Ue},I.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},I}(j),Z=function(E){function I(F,H,re,ue){E.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=re.getActor(),this.setEventedParent(ue),this._data=H.data,this._options=e.extend({},H),this._collectResourceTiming=H.collectResourceTiming,this._resourceTiming=[],void 0!==H.maxzoom&&(this.maxzoom=H.maxzoom),H.type&&(this.type=H.type),H.attribution&&(this.attribution=H.attribution),this.promoteId=H.promoteId;var ye=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:H.cluster||!1,geojsonVtOptions:{buffer:(void 0!==H.buffer?H.buffer:128)*ye,tolerance:(void 0!==H.tolerance?H.tolerance:.375)*ye,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:H.lineMetrics||!1,generateId:H.generateId||!1},superclusterOptions:{maxZoom:void 0!==H.clusterMaxZoom?Math.min(H.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(H.clusterRadius||50)*ye,log:!1,generateId:H.generateId||!1},clusterProperties:H.clusterProperties},H.workerOptions)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(H){if(H)F.fire(new e.ErrorEvent(H));else{var re={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(re.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",re))}})},I.prototype.onAdd=function(F){this.map=F,this.load()},I.prototype.setData=function(F){var H=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(re){if(re)H.fire(new e.ErrorEvent(re));else{var ue={dataType:"source",sourceDataType:"content"};H._collectResourceTiming&&H._resourceTiming&&H._resourceTiming.length>0&&(ue.resourceTiming=H._resourceTiming,H._resourceTiming=[]),H.fire(new e.Event("data",ue))}}),this},I.prototype.getClusterExpansionZoom=function(F,H){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},H),this},I.prototype.getClusterChildren=function(F,H){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},H),this},I.prototype.getClusterLeaves=function(F,H,re,ue){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:H,offset:re},ue),this},I.prototype._updateWorkerData=function(F){var H=this;this._loaded=!1;var re=e.extend({},this.workerOptions),ue=this._data;"string"==typeof ue?(re.request=this.map._requestManager.transformRequest(e.browser.resolveURL(ue),e.ResourceType.Source),re.request.collectResourceTiming=this._collectResourceTiming):re.data=JSON.stringify(ue),this.actor.send(this.type+".loadData",re,function(ye,ke){H._removed||ke&&ke.abandoned||(H._loaded=!0,ke&&ke.resourceTiming&&ke.resourceTiming[H.id]&&(H._resourceTiming=ke.resourceTiming[H.id].slice(0)),H.actor.send(H.type+".coalesce",{source:re.source},null),F(ye))})},I.prototype.loaded=function(){return this._loaded},I.prototype.loadTile=function(F,H){var re=this,ue=F.actor?"reloadTile":"loadTile";F.actor=this.actor,F.request=this.actor.send(ue,{type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(ke,Ee){return delete F.request,F.unloadVectorData(),F.aborted?H(null):ke?H(ke):(F.loadVectorData(Ee,re.map.painter,"reloadTile"===ue),H(null))})},I.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},I.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},I.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},I.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},I.prototype.hasTransition=function(){return!1},I}(e.Evented),W=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),G=function(E){function I(F,H,re,ue){E.call(this),this.id=F,this.dispatcher=re,this.coordinates=H.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(ue),this.options=H}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.load=function(F,H){var re=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(ue,ye){re._loaded=!0,ue?re.fire(new e.ErrorEvent(ue)):ye&&(re.image=ye,F&&(re.coordinates=F),H&&H(),re._finishLoading())})},I.prototype.loaded=function(){return this._loaded},I.prototype.updateImage=function(F){var H=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){H.texture=null}),this):this},I.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},I.prototype.onAdd=function(F){this.map=F,this.load()},I.prototype.setCoordinates=function(F){var H=this;this.coordinates=F;var re=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(ye){for(var ke=1/0,Ee=1/0,Ue=-1/0,$e=-1/0,it=0,_t=ye;it<_t.length;it+=1){var Ct=_t[it];ke=Math.min(ke,Ct.x),Ee=Math.min(Ee,Ct.y),Ue=Math.max(Ue,Ct.x),$e=Math.max($e,Ct.y)}var Tt=Math.max(Ue-ke,$e-Ee),jt=Math.max(0,Math.floor(-Math.log(Tt)/Math.LN2)),Nt=Math.pow(2,jt);return new e.CanonicalTileID(jt,Math.floor((ke+Ue)/2*Nt),Math.floor((Ee+$e)/2*Nt))}(re),this.minzoom=this.maxzoom=this.tileID.z;var ue=re.map(function(ye){return H.tileID.getTilePoint(ye)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(ue[0].x,ue[0].y,0,0),this._boundsArray.emplaceBack(ue[1].x,ue[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(ue[3].x,ue[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(ue[2].x,ue[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},I.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var F=this.map.painter.context,H=F.gl;for(var re in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,W.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,H.RGBA),this.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE)),this.tiles){var ue=this.tiles[re];"loaded"!==ue.state&&(ue.state="loaded",ue.texture=this.texture)}}},I.prototype.loadTile=function(F,H){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},H(null)):(F.state="errored",H(null))},I.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},I.prototype.hasTransition=function(){return!1},I}(e.Evented),X=function(E){function I(F,H,re,ue){E.call(this,F,H,re,ue),this.roundZoom=!0,this.type="video",this.options=H}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.load=function(){var F=this;this._loaded=!1;var H=this.options;this.urls=[];for(var re=0,ue=H.urls;re<ue.length;re+=1)this.urls.push(this.map._requestManager.transformRequest(ue[re],e.ResourceType.Source).url);e.getVideo(this.urls,function(ke,Ee){F._loaded=!0,ke?F.fire(new e.ErrorEvent(ke)):Ee&&(F.video=Ee,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},I.prototype.pause=function(){this.video&&this.video.pause()},I.prototype.play=function(){this.video&&this.video.play()},I.prototype.seek=function(F){if(this.video){var H=this.video.seekable;F<H.start(0)||F>H.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+H.start(0)+" and "+H.end(0)+"-second mark."))):this.video.currentTime=F}},I.prototype.getVideo=function(){return this.video},I.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},I.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var F=this.map.painter.context,H=F.gl;for(var re in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,W.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE),H.texSubImage2D(H.TEXTURE_2D,0,0,0,H.RGBA,H.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,H.RGBA),this.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE)),this.tiles){var ue=this.tiles[re];"loaded"!==ue.state&&(ue.state="loaded",ue.texture=this.texture)}}},I.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},I.prototype.hasTransition=function(){return this.video&&!this.video.paused},I}(G),ne=function(E){function I(F,H,re,ue){E.call(this,F,H,re,ue),H.coordinates?Array.isArray(H.coordinates)&&4===H.coordinates.length&&!H.coordinates.some(function(ye){return!Array.isArray(ye)||2!==ye.length||ye.some(function(ke){return"number"!=typeof ke})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),H.animate&&"boolean"!=typeof H.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),H.canvas?"string"==typeof H.canvas||H.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=H,this.animate=void 0===H.animate||H.animate}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},I.prototype.getCanvas=function(){return this.canvas},I.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},I.prototype.onRemove=function(){this.pause()},I.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var H=this.map.painter.context,re=H.gl;for(var ue in this.boundsBuffer||(this.boundsBuffer=H.createVertexBuffer(this._boundsArray,W.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(H,this.canvas,re.RGBA,{premultiply:!0}),this.tiles){var ye=this.tiles[ue];"loaded"!==ye.state&&(ye.state="loaded",ye.texture=this.texture)}}},I.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},I.prototype.hasTransition=function(){return this._playing},I.prototype._hasInvalidDimensions=function(){for(var F=0,H=[this.canvas.width,this.canvas.height];F<H.length;F+=1){var re=H[F];if(isNaN(re)||re<=0)return!0}return!1},I}(G),V={vector:D,raster:j,"raster-dem":q,geojson:Z,video:X,image:G,canvas:ne};function N(E,I){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*E.width,.5*E.height,1]),e.multiply(F,F,E.calculatePosMatrix(I.toUnwrapped()))}function U(E,I,F,H,re,ue){var ye=function(Et,Tt,jt){if(Et)for(var Nt=0,Yt=Et;Nt<Yt.length;Nt+=1){var ln=Tt[Yt[Nt]];if(ln&&ln.source===jt&&"fill-extrusion"===ln.type)return!0}else for(var bn in Tt){var In=Tt[bn];if(In.source===jt&&"fill-extrusion"===In.type)return!0}return!1}(re&&re.layers,I,E.id),ke=ue.maxPitchScaleFactor(),Ee=E.tilesIn(H,ke,ye);Ee.sort(ee);for(var Ue=[],$e=0,it=Ee;$e<it.length;$e+=1){var _t=it[$e];Ue.push({wrappedTileID:_t.tileID.wrapped().key,queryResults:_t.tile.queryRenderedFeatures(I,F,E._state,_t.queryGeometry,_t.cameraQueryGeometry,_t.scale,re,ue,ke,N(E.transform,_t.tileID))})}var Ct=function(Et){for(var Tt={},jt={},Nt=0,Yt=Et;Nt<Yt.length;Nt+=1){var ln=Yt[Nt],bn=ln.queryResults,In=ln.wrappedTileID,En=jt[In]=jt[In]||{};for(var ir in bn)for(var rr=bn[ir],_r=En[ir]=En[ir]||{},pr=Tt[ir]=Tt[ir]||[],Qr=0,li=rr;Qr<li.length;Qr+=1){var xi=li[Qr];_r[xi.featureIndex]||(_r[xi.featureIndex]=!0,pr.push(xi))}}return Tt}(Ue);for(var At in Ct)Ct[At].forEach(function(Et){var Tt=Et.feature,jt=E.getFeatureState(Tt.layer["source-layer"],Tt.id);Tt.source=Tt.layer.source,Tt.layer["source-layer"]&&(Tt.sourceLayer=Tt.layer["source-layer"]),Tt.state=jt});return Ct}function ee(E,I){var F=E.tileID,H=I.tileID;return F.overscaledZ-H.overscaledZ||F.canonical.y-H.canonical.y||F.wrap-H.wrap||F.canonical.x-H.canonical.x}var B=function(E,I){this.max=E,this.onRemove=I,this.reset()};B.prototype.reset=function(){for(var E in this.data)for(var I=0,F=this.data[E];I<F.length;I+=1){var H=F[I];H.timeout&&clearTimeout(H.timeout),this.onRemove(H.value)}return this.data={},this.order=[],this},B.prototype.add=function(E,I,F){var H=this,re=E.wrapped().key;void 0===this.data[re]&&(this.data[re]=[]);var ue={value:I,timeout:void 0};if(void 0!==F&&(ue.timeout=setTimeout(function(){H.remove(E,ue)},F)),this.data[re].push(ue),this.order.push(re),this.order.length>this.max){var ye=this._getAndRemoveByKey(this.order[0]);ye&&this.onRemove(ye)}return this},B.prototype.has=function(E){return E.wrapped().key in this.data},B.prototype.getAndRemove=function(E){return this.has(E)?this._getAndRemoveByKey(E.wrapped().key):null},B.prototype._getAndRemoveByKey=function(E){var I=this.data[E].shift();return I.timeout&&clearTimeout(I.timeout),0===this.data[E].length&&delete this.data[E],this.order.splice(this.order.indexOf(E),1),I.value},B.prototype.getByKey=function(E){var I=this.data[E];return I?I[0].value:null},B.prototype.get=function(E){return this.has(E)?this.data[E.wrapped().key][0].value:null},B.prototype.remove=function(E,I){if(!this.has(E))return this;var F=E.wrapped().key,H=void 0===I?0:this.data[F].indexOf(I),re=this.data[F][H];return this.data[F].splice(H,1),re.timeout&&clearTimeout(re.timeout),0===this.data[F].length&&delete this.data[F],this.onRemove(re.value),this.order.splice(this.order.indexOf(F),1),this},B.prototype.setMaxSize=function(E){for(this.max=E;this.order.length>this.max;){var I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this},B.prototype.filter=function(E){var I=[];for(var F in this.data)for(var H=0,re=this.data[F];H<re.length;H+=1){var ue=re[H];E(ue.value)||I.push(ue)}for(var ye=0,ke=I;ye<ke.length;ye+=1){var Ee=ke[ye];this.remove(Ee.value.tileID,Ee)}};var K=function(E,I,F){this.context=E;var H=E.gl;this.buffer=H.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),E.bindElementBuffer.set(this.buffer),H.bufferData(H.ELEMENT_ARRAY_BUFFER,I.arrayBuffer,this.dynamicDraw?H.DYNAMIC_DRAW:H.STATIC_DRAW),this.dynamicDraw||delete I.arrayBuffer};K.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},K.prototype.updateData=function(E){var I=this.context.gl;this.context.unbindVAO(),this.bind(),I.bufferSubData(I.ELEMENT_ARRAY_BUFFER,0,E.arrayBuffer)},K.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var J={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},te=function(E,I,F,H){this.length=I.length,this.attributes=F,this.itemSize=I.bytesPerElement,this.dynamicDraw=H,this.context=E;var re=E.gl;this.buffer=re.createBuffer(),E.bindVertexBuffer.set(this.buffer),re.bufferData(re.ARRAY_BUFFER,I.arrayBuffer,this.dynamicDraw?re.DYNAMIC_DRAW:re.STATIC_DRAW),this.dynamicDraw||delete I.arrayBuffer};te.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},te.prototype.updateData=function(E){var I=this.context.gl;this.bind(),I.bufferSubData(I.ARRAY_BUFFER,0,E.arrayBuffer)},te.prototype.enableAttributes=function(E,I){for(var F=0;F<this.attributes.length;F++){var re=I.attributes[this.attributes[F].name];void 0!==re&&E.enableVertexAttribArray(re)}},te.prototype.setVertexAttribPointers=function(E,I,F){for(var H=0;H<this.attributes.length;H++){var re=this.attributes[H],ue=I.attributes[re.name];void 0!==ue&&E.vertexAttribPointer(ue,re.components,E[J[re.type]],!1,this.itemSize,re.offset+this.itemSize*(F||0))}},te.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ae=function(E){this.gl=E.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ae.prototype.get=function(){return this.current},ae.prototype.set=function(E){},ae.prototype.getDefault=function(){return this.default},ae.prototype.setDefault=function(){this.set(this.default)};var ce=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return e.Color.transparent},I.prototype.set=function(F){var H=this.current;(F.r!==H.r||F.g!==H.g||F.b!==H.b||F.a!==H.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},I}(ae),oe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return 1},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},I}(ae),ve=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return 0},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},I}(ae),fe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return[!0,!0,!0,!0]},I.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||F[2]!==H[2]||F[3]!==H[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},I}(ae),xe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!0},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},I}(ae),Se=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return 255},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},I}(ae),pe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},I.prototype.set=function(F){var H=this.current;(F.func!==H.func||F.ref!==H.ref||F.mask!==H.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},I}(ae),ge=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},I.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||F[2]!==H[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},I}(ae),Te=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!1},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.STENCIL_TEST):H.disable(H.STENCIL_TEST),this.current=F,this.dirty=!1}},I}(ae),se=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return[0,1]},I.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},I}(ae),de=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!1},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.DEPTH_TEST):H.disable(H.DEPTH_TEST),this.current=F,this.dirty=!1}},I}(ae),Ae=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return this.gl.LESS},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},I}(ae),Le=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!1},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.BLEND):H.disable(H.BLEND),this.current=F,this.dirty=!1}},I}(ae),Me=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},I.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},I}(ae),De=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return e.Color.transparent},I.prototype.set=function(F){var H=this.current;(F.r!==H.r||F.g!==H.g||F.b!==H.b||F.a!==H.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},I}(ae),Oe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return this.gl.FUNC_ADD},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},I}(ae),Ie=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!1},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.CULL_FACE):H.disable(H.CULL_FACE),this.current=F,this.dirty=!1}},I}(ae),Qe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return this.gl.BACK},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},I}(ae),Ne=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return this.gl.CCW},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},I}(ae),Pe=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},I}(ae),Re=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return this.gl.TEXTURE0},I.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},I}(ae),Ge=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},I.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||F[2]!==H[2]||F[3]!==H[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},I}(ae),tt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindFramebuffer(H.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},I}(ae),ct=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindRenderbuffer(H.RENDERBUFFER,F),this.current=F,this.dirty=!1}},I}(ae),wt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindTexture(H.TEXTURE_2D,F),this.current=F,this.dirty=!1}},I}(ae),kt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindBuffer(H.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},I}(ae),gt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){var H=this.gl;H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},I}(ae),at=function(E){function I(F){E.call(this,F),this.vao=F.extVertexArrayObject}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},I}(ae),et=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return 4},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.pixelStorei(H.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},I}(ae),yt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!1},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},I}(ae),Vt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return!1},I.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},I}(ae),Gt=function(E){function I(F,H){E.call(this,F),this.context=F,this.parent=H}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getDefault=function(){return null},I}(ae),en=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.setDirty=function(){this.dirty=!0},I.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var H=this.gl;H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},I}(Gt),Jt=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var H=this.gl;H.framebufferRenderbuffer(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,H.RENDERBUFFER,F),this.current=F,this.dirty=!1}},I}(Gt),cn=function(E,I,F,H){this.context=E,this.width=I,this.height=F;var ue=this.framebuffer=E.gl.createFramebuffer();this.colorAttachment=new en(E,ue),H&&(this.depthAttachment=new Jt(E,ue))};cn.prototype.destroy=function(){var E=this.context.gl,I=this.colorAttachment.get();if(I&&E.deleteTexture(I),this.depthAttachment){var F=this.depthAttachment.get();F&&E.deleteRenderbuffer(F)}E.deleteFramebuffer(this.framebuffer)};var Rt=function(E,I,F){this.func=E,this.mask=I,this.range=F};Rt.ReadOnly=!1,Rt.ReadWrite=!0,Rt.disabled=new Rt(519,Rt.ReadOnly,[0,1]);var je=function(E,I,F,H,re,ue){this.test=E,this.ref=I,this.mask=F,this.fail=H,this.depthFail=re,this.pass=ue};je.disabled=new je({func:519,mask:0},0,0,7680,7680,7680);var Ye=function(E,I,F){this.blendFunction=E,this.blendColor=I,this.mask=F};Ye.disabled=new Ye(Ye.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Ye.unblended=new Ye(Ye.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ye.alphaBlended=new Ye([1,771],e.Color.transparent,[!0,!0,!0,!0]);var he=function(E,I,F){this.enable=E,this.mode=I,this.frontFace=F};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var be=function(E){this.gl=E,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ce(this),this.clearDepth=new oe(this),this.clearStencil=new ve(this),this.colorMask=new fe(this),this.depthMask=new xe(this),this.stencilMask=new Se(this),this.stencilFunc=new pe(this),this.stencilOp=new ge(this),this.stencilTest=new Te(this),this.depthRange=new se(this),this.depthTest=new de(this),this.depthFunc=new Ae(this),this.blend=new Le(this),this.blendFunc=new Me(this),this.blendColor=new De(this),this.blendEquation=new Oe(this),this.cullFace=new Ie(this),this.cullFaceSide=new Qe(this),this.frontFace=new Ne(this),this.program=new Pe(this),this.activeTexture=new Re(this),this.viewport=new Ge(this),this.bindFramebuffer=new tt(this),this.bindRenderbuffer=new ct(this),this.bindTexture=new wt(this),this.bindVertexBuffer=new kt(this),this.bindElementBuffer=new gt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new at(this),this.pixelStoreUnpack=new et(this),this.pixelStoreUnpackPremultiplyAlpha=new yt(this),this.pixelStoreUnpackFlipY=new Vt(this),this.extTextureFilterAnisotropic=E.getExtension("EXT_texture_filter_anisotropic")||E.getExtension("MOZ_EXT_texture_filter_anisotropic")||E.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=E.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=E.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(E.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=E.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=E.getExtension("EXT_disjoint_timer_query")};be.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},be.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},be.prototype.createIndexBuffer=function(E,I){return new K(this,E,I)},be.prototype.createVertexBuffer=function(E,I,F){return new te(this,E,I,F)},be.prototype.createRenderbuffer=function(E,I,F){var H=this.gl,re=H.createRenderbuffer();return this.bindRenderbuffer.set(re),H.renderbufferStorage(H.RENDERBUFFER,E,I,F),this.bindRenderbuffer.set(null),re},be.prototype.createFramebuffer=function(E,I,F){return new cn(this,E,I,F)},be.prototype.clear=function(E){var I=E.color,F=E.depth,H=this.gl,re=0;I&&(re|=H.COLOR_BUFFER_BIT,this.clearColor.set(I),this.colorMask.set([!0,!0,!0,!0])),void 0!==F&&(re|=H.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),H.clear(re)},be.prototype.setCullFace=function(E){!1===E.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(E.mode),this.frontFace.set(E.frontFace))},be.prototype.setDepthMode=function(E){E.func!==this.gl.ALWAYS||E.mask?(this.depthTest.set(!0),this.depthFunc.set(E.func),this.depthMask.set(E.mask),this.depthRange.set(E.range)):this.depthTest.set(!1)},be.prototype.setStencilMode=function(E){E.test.func!==this.gl.ALWAYS||E.mask?(this.stencilTest.set(!0),this.stencilMask.set(E.mask),this.stencilOp.set([E.fail,E.depthFail,E.pass]),this.stencilFunc.set({func:E.test.func,ref:E.ref,mask:E.test.mask})):this.stencilTest.set(!1)},be.prototype.setColorMode=function(E){e.deepEqual(E.blendFunction,Ye.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(E.blendFunction),this.blendColor.set(E.blendColor)),this.colorMask.set(E.mask)},be.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Fe=function(E){function I(F,H,re){var ue=this;E.call(this),this.id=F,this.dispatcher=re,this.on("data",function(ye){"source"===ye.dataType&&"metadata"===ye.sourceDataType&&(ue._sourceLoaded=!0),ue._sourceLoaded&&!ue._paused&&"source"===ye.dataType&&"content"===ye.sourceDataType&&(ue.reload(),ue.transform&&ue.update(ue.transform))}),this.on("error",function(){ue._sourceErrored=!0}),this._source=function(ye,ke,Ee,Ue){var $e=new V[ke.type](ye,ke,Ee,Ue);if($e.id!==ye)throw new Error("Expected Source id to be "+ye+" instead of "+$e.id);return e.bindAll(["load","abort","unload","serialize","prepare"],$e),$e}(F,H,re,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},I.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},I.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var H=this._tiles[F];if("loaded"!==H.state&&"errored"!==H.state)return!1}return!0},I.prototype.getSource=function(){return this._source},I.prototype.pause=function(){this._paused=!0},I.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},I.prototype._loadTile=function(F,H){return this._source.loadTile(F,H)},I.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},I.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},I.prototype.serialize=function(){return this._source.serialize()},I.prototype.prepare=function(F){for(var H in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var re=this._tiles[H];re.upload(F),re.prepare(this.map.style.imageManager)}},I.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(He).map(function(F){return F.key})},I.prototype.getRenderableIds=function(F){var H=this,re=[];for(var ue in this._tiles)this._isIdRenderable(ue,F)&&re.push(this._tiles[ue]);return F?re.sort(function(ye,ke){var Ee=ye.tileID,Ue=ke.tileID,$e=new e.Point(Ee.canonical.x,Ee.canonical.y)._rotate(H.transform.angle),it=new e.Point(Ue.canonical.x,Ue.canonical.y)._rotate(H.transform.angle);return Ee.overscaledZ-Ue.overscaledZ||it.y-$e.y||it.x-$e.x}).map(function(ye){return ye.tileID.key}):re.map(function(ye){return ye.tileID}).sort(He).map(function(ye){return ye.key})},I.prototype.hasRenderableParent=function(F){var H=this.findLoadedParent(F,0);return!!H&&this._isIdRenderable(H.tileID.key)},I.prototype._isIdRenderable=function(F,H){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(H||!this._tiles[F].holdingForFade())},I.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)"errored"!==this._tiles[F].state&&this._reloadTile(F,"reloading")},I.prototype._reloadTile=function(F,H){var re=this._tiles[F];re&&("loading"!==re.state&&(re.state=H),this._loadTile(re,this._tileLoaded.bind(this,re,F,H)))},I.prototype._tileLoaded=function(F,H,re,ue){if(ue)return F.state="errored",void(404!==ue.status?this._source.fire(new e.ErrorEvent(ue,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),"expired"===re&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(H,F),"raster-dem"===this.getSource().type&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},I.prototype._backfillDEM=function(F){for(var H=this.getRenderableIds(),re=0;re<H.length;re++){var ue=H[re];if(F.neighboringTiles&&F.neighboringTiles[ue]){var ye=this.getTileByID(ue);ke(F,ye),ke(ye,F)}}function ke(Ee,Ue){Ee.needsHillshadePrepare=!0;var $e=Ue.tileID.canonical.x-Ee.tileID.canonical.x,it=Ue.tileID.canonical.y-Ee.tileID.canonical.y,_t=Math.pow(2,Ee.tileID.canonical.z),Ct=Ue.tileID.key;0===$e&&0===it||Math.abs(it)>1||(Math.abs($e)>1&&(1===Math.abs($e+_t)?$e+=_t:1===Math.abs($e-_t)&&($e-=_t)),Ue.dem&&Ee.dem&&(Ee.dem.backfillBorder(Ue.dem,$e,it),Ee.neighboringTiles&&Ee.neighboringTiles[Ct]&&(Ee.neighboringTiles[Ct].backfilled=!0)))}},I.prototype.getTile=function(F){return this.getTileByID(F.key)},I.prototype.getTileByID=function(F){return this._tiles[F]},I.prototype._retainLoadedChildren=function(F,H,re,ue){for(var ye in this._tiles){var ke=this._tiles[ye];if(!(ue[ye]||!ke.hasData()||ke.tileID.overscaledZ<=H||ke.tileID.overscaledZ>re)){for(var Ee=ke.tileID;ke&&ke.tileID.overscaledZ>H+1;){var Ue=ke.tileID.scaledTo(ke.tileID.overscaledZ-1);(ke=this._tiles[Ue.key])&&ke.hasData()&&(Ee=Ue)}for(var $e=Ee;$e.overscaledZ>H;)if(F[($e=$e.scaledTo($e.overscaledZ-1)).key]){ue[Ee.key]=Ee;break}}}},I.prototype.findLoadedParent=function(F,H){if(F.key in this._loadedParentTiles){var re=this._loadedParentTiles[F.key];return re&&re.tileID.overscaledZ>=H?re:null}for(var ue=F.overscaledZ-1;ue>=H;ue--){var ye=F.scaledTo(ue),ke=this._getLoadedTile(ye);if(ke)return ke}},I.prototype._getLoadedTile=function(F){var H=this._tiles[F.key];return H&&H.hasData()?H:this._cache.getByKey(F.wrapped().key)},I.prototype.updateCacheSize=function(F){var H=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),re=Math.floor(5*H),ue="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,re):re;this._cache.setMaxSize(ue)},I.prototype.handleWrapJump=function(F){var re=Math.round((F-(void 0===this._prevLng?F:this._prevLng))/360);if(this._prevLng=F,re){var ue={};for(var ye in this._tiles){var ke=this._tiles[ye];ke.tileID=ke.tileID.unwrapTo(ke.tileID.wrap+re),ue[ke.tileID.key]=ke}for(var Ee in this._tiles=ue,this._timers)clearTimeout(this._timers[Ee]),delete this._timers[Ee];for(var Ue in this._tiles)this._setTileReloadTimer(Ue,this._tiles[Ue])}},I.prototype.update=function(F){var H=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var re;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?re=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(En){return new e.OverscaledTileID(En.canonical.z,En.wrap,En.canonical.z,En.canonical.x,En.canonical.y)}):(re=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(re=re.filter(function(En){return H._source.hasTile(En)}))):re=[];var ue=F.coveringZoomLevel(this._source),ye=Math.max(ue-I.maxOverzooming,this._source.minzoom),ke=Math.max(ue+I.maxUnderzooming,this._source.minzoom),Ee=this._updateRetainedTiles(re,ue);if(Ke(this._source.type)){for(var Ue={},$e={},it=0,_t=Object.keys(Ee);it<_t.length;it+=1){var Ct=_t[it],At=Ee[Ct],Et=this._tiles[Ct];if(Et&&!(Et.fadeEndTime&&Et.fadeEndTime<=e.browser.now())){var Tt=this.findLoadedParent(At,ye);Tt&&(this._addTile(Tt.tileID),Ue[Tt.tileID.key]=Tt.tileID),$e[Ct]=At}}for(var jt in this._retainLoadedChildren($e,ue,ke,Ee),Ue)Ee[jt]||(this._coveredTiles[jt]=!0,Ee[jt]=Ue[jt])}for(var Nt in Ee)this._tiles[Nt].clearFadeHold();for(var Yt=0,ln=e.keysDifference(this._tiles,Ee);Yt<ln.length;Yt+=1){var bn=ln[Yt],In=this._tiles[bn];In.hasSymbolBuckets&&!In.holdingForFade()?In.setHoldDuration(this.map._fadeDuration):In.hasSymbolBuckets&&!In.symbolFadeFinished()||this._removeTile(bn)}this._updateLoadedParentTileCache()}},I.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},I.prototype._updateRetainedTiles=function(F,H){for(var re={},ue={},ye=Math.max(H-I.maxOverzooming,this._source.minzoom),ke=Math.max(H+I.maxUnderzooming,this._source.minzoom),Ee={},Ue=0,$e=F;Ue<$e.length;Ue+=1){var it=$e[Ue],_t=this._addTile(it);re[it.key]=it,_t.hasData()||H<this._source.maxzoom&&(Ee[it.key]=it)}this._retainLoadedChildren(Ee,H,ke,re);for(var Ct=0,At=F;Ct<At.length;Ct+=1){var Et=At[Ct],Tt=this._tiles[Et.key];if(!Tt.hasData()){if(H+1>this._source.maxzoom){var jt=Et.children(this._source.maxzoom)[0],Nt=this.getTile(jt);if(Nt&&Nt.hasData()){re[jt.key]=jt;continue}}else{var Yt=Et.children(this._source.maxzoom);if(re[Yt[0].key]&&re[Yt[1].key]&&re[Yt[2].key]&&re[Yt[3].key])continue}for(var ln=Tt.wasRequested(),bn=Et.overscaledZ-1;bn>=ye;--bn){var In=Et.scaledTo(bn);if(ue[In.key]||(ue[In.key]=!0,!(Tt=this.getTile(In))&&ln&&(Tt=this._addTile(In)),Tt&&(re[In.key]=In,ln=Tt.wasRequested(),Tt.hasData())))break}}}return re},I.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var H=[],re=void 0,ue=this._tiles[F].tileID;ue.overscaledZ>0;){if(ue.key in this._loadedParentTiles){re=this._loadedParentTiles[ue.key];break}H.push(ue.key);var ye=ue.scaledTo(ue.overscaledZ-1);if(re=this._getLoadedTile(ye))break;ue=ye}for(var ke=0,Ee=H;ke<Ee.length;ke+=1)this._loadedParentTiles[Ee[ke]]=re}},I.prototype._addTile=function(F){var H=this._tiles[F.key];if(H)return H;(H=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,H),H.tileID=F,this._state.initializeTileState(H,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,H)));var re=Boolean(H);return re||(H=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(H,this._tileLoaded.bind(this,H,F.key,H.state))),H?(H.uses++,this._tiles[F.key]=H,re||this._source.fire(new e.Event("dataloading",{tile:H,coord:H.tileID,dataType:"source"})),H):null},I.prototype._setTileReloadTimer=function(F,H){var re=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var ue=H.getExpiryTimeout();ue&&(this._timers[F]=setTimeout(function(){re._reloadTile(F,"expired"),delete re._timers[F]},ue))},I.prototype._removeTile=function(F){var H=this._tiles[F];H&&(H.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),H.uses>0||(H.hasData()&&"reloading"!==H.state?this._cache.add(H.tileID,H,H.getExpiryTimeout()):(H.aborted=!0,this._abortTile(H),this._unloadTile(H))))},I.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},I.prototype.tilesIn=function(F,H,re){var ue=this,ye=[],ke=this.transform;if(!ke)return ye;for(var Ee=re?ke.getCameraQueryGeometry(F):F,Ue=F.map(function(bn){return ke.pointCoordinate(bn)}),$e=Ee.map(function(bn){return ke.pointCoordinate(bn)}),it=this.getIds(),_t=1/0,Ct=1/0,At=-1/0,Et=-1/0,Tt=0,jt=$e;Tt<jt.length;Tt+=1){var Nt=jt[Tt];_t=Math.min(_t,Nt.x),Ct=Math.min(Ct,Nt.y),At=Math.max(At,Nt.x),Et=Math.max(Et,Nt.y)}for(var Yt=function(bn){var In=ue._tiles[it[bn]];if(!In.holdingForFade()){var En=In.tileID,ir=Math.pow(2,ke.zoom-In.tileID.overscaledZ),rr=H*In.queryPadding*e.EXTENT/In.tileSize/ir,_r=[En.getTilePoint(new e.MercatorCoordinate(_t,Ct)),En.getTilePoint(new e.MercatorCoordinate(At,Et))];if(_r[0].x-rr<e.EXTENT&&_r[0].y-rr<e.EXTENT&&_r[1].x+rr>=0&&_r[1].y+rr>=0){var pr=Ue.map(function(li){return En.getTilePoint(li)}),Qr=$e.map(function(li){return En.getTilePoint(li)});ye.push({tile:In,tileID:En,queryGeometry:pr,cameraQueryGeometry:Qr,scale:ir})}}},ln=0;ln<it.length;ln++)Yt(ln);return ye},I.prototype.getVisibleCoordinates=function(F){for(var H=this,re=this.getRenderableIds(F).map(function(Ee){return H._tiles[Ee].tileID}),ue=0,ye=re;ue<ye.length;ue+=1){var ke=ye[ue];ke.posMatrix=this.transform.calculatePosMatrix(ke.toUnwrapped())}return re},I.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ke(this._source.type))for(var F in this._tiles){var H=this._tiles[F];if(void 0!==H.fadeEndTime&&H.fadeEndTime>=e.browser.now())return!0}return!1},I.prototype.setFeatureState=function(F,H,re){this._state.updateState(F=F||"_geojsonTileLayer",H,re)},I.prototype.removeFeatureState=function(F,H,re){this._state.removeFeatureState(F=F||"_geojsonTileLayer",H,re)},I.prototype.getFeatureState=function(F,H){return this._state.getState(F=F||"_geojsonTileLayer",H)},I.prototype.setDependencies=function(F,H,re){var ue=this._tiles[F];ue&&ue.setDependencies(H,re)},I.prototype.reloadTilesForDependencies=function(F,H){for(var re in this._tiles)this._tiles[re].hasDependency(F,H)&&this._reloadTile(re,"reloading");this._cache.filter(function(ue){return!ue.hasDependency(F,H)})},I}(e.Evented);function He(E,I){var F=Math.abs(2*E.wrap)-+(E.wrap<0),H=Math.abs(2*I.wrap)-+(I.wrap<0);return E.overscaledZ-I.overscaledZ||H-F||I.canonical.y-E.canonical.y||I.canonical.x-E.canonical.x}function Ke(E){return"raster"===E||"image"===E||"video"===E}function Ze(){return new e.window.Worker(le.workerUrl)}Fe.maxOverzooming=10,Fe.maxUnderzooming=3;var ut="mapboxgl_preloaded_worker_pool",lt=function(){this.active={}};lt.prototype.acquire=function(E){if(!this.workers)for(this.workers=[];this.workers.length<lt.workerCount;)this.workers.push(new Ze);return this.active[E]=!0,this.workers.slice()},lt.prototype.release=function(E){delete this.active[E],0===this.numActive()&&(this.workers.forEach(function(I){I.terminate()}),this.workers=null)},lt.prototype.isPreloaded=function(){return!!this.active[ut]},lt.prototype.numActive=function(){return Object.keys(this.active).length};var Lt,Ot=Math.floor(e.browser.hardwareConcurrency/2);function ot(){return Lt||(Lt=new lt),Lt}function pt(E,I){var F={};for(var H in E)"ref"!==H&&(F[H]=E[H]);return e.refProperties.forEach(function(re){re in I&&(F[re]=I[re])}),F}function qt(E){E=E.slice();for(var I=Object.create(null),F=0;F<E.length;F++)I[E[F].id]=E[F];for(var H=0;H<E.length;H++)"ref"in E[H]&&(E[H]=pt(E[H],I[E[H].ref]));return E}lt.workerCount=Math.max(Math.min(Ot,6),1);var St={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Mt(E,I,F){F.push({command:St.addSource,args:[E,I[E]]})}function Ce(E,I,F){I.push({command:St.removeSource,args:[E]}),F[E]=!0}function Xe(E,I,F,H){Ce(E,F,H),Mt(E,I,F)}function st(E,I,F){var H;for(H in E[F])if(E[F].hasOwnProperty(H)&&"data"!==H&&!e.deepEqual(E[F][H],I[F][H]))return!1;for(H in I[F])if(I[F].hasOwnProperty(H)&&"data"!==H&&!e.deepEqual(E[F][H],I[F][H]))return!1;return!0}function dt(E,I,F,H,re,ue){var ye;for(ye in I=I||{},E=E||{})E.hasOwnProperty(ye)&&(e.deepEqual(E[ye],I[ye])||F.push({command:ue,args:[H,ye,I[ye],re]}));for(ye in I)I.hasOwnProperty(ye)&&!E.hasOwnProperty(ye)&&(e.deepEqual(E[ye],I[ye])||F.push({command:ue,args:[H,ye,I[ye],re]}))}function zt(E){return E.id}function Ht(E,I){return E[I.id]=I,E}var Zt=function(E,I){this.reset(E,I)};Zt.prototype.reset=function(E,I){this.points=E||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(I||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Zt.prototype.lerp=function(E){if(1===this.points.length)return this.points[0];E=e.clamp(E,0,1);for(var I=1,F=this._distances[I],H=E*this.paddedLength+this.padding;F<H&&I<this._distances.length;)F=this._distances[++I];var re=I-1,ue=this._distances[re],ye=F-ue,ke=ye>0?(H-ue)/ye:0;return this.points[re].mult(1-ke).add(this.points[I].mult(ke))};var vn=function(E,I,F){var H=this.boxCells=[],re=this.circleCells=[];this.xCellCount=Math.ceil(E/F),this.yCellCount=Math.ceil(I/F);for(var ue=0;ue<this.xCellCount*this.yCellCount;ue++)H.push([]),re.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=E,this.height=I,this.xScale=this.xCellCount/E,this.yScale=this.yCellCount/I,this.boxUid=0,this.circleUid=0};function zn(E,I,F,H,re){var ue=e.create();return I?(e.scale(ue,ue,[1/re,1/re,1]),F||e.rotateZ(ue,ue,H.angle)):e.multiply(ue,H.labelPlaneMatrix,E),ue}function gn(E,I,F,H,re){if(I){var ue=e.clone(E);return e.scale(ue,ue,[re,re,1]),F||e.rotateZ(ue,ue,-H.angle),ue}return H.glCoordMatrix}function nn(E,I){var F=[E.x,E.y,0,1];Vr(F,F,I);var H=F[3];return{point:new e.Point(F[0]/H,F[1]/H),signedDistanceFromCamera:H}}function an(E,I){return.5+E/I*.5}function on(E,I){var F=E[0]/E[3],H=E[1]/E[3];return F>=-I[0]&&F<=I[0]&&H>=-I[1]&&H<=I[1]}function mn(E,I,F,H,re,ue,ye,ke){var Ee=H?E.textSizeData:E.iconSizeData,Ue=e.evaluateSizeForZoom(Ee,F.transform.zoom),$e=[256/F.width*2+1,256/F.height*2+1],it=H?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;it.clear();for(var _t=E.lineVertexArray,Ct=H?E.text.placedSymbolArray:E.icon.placedSymbolArray,At=F.transform.width/F.transform.height,Et=!1,Tt=0;Tt<Ct.length;Tt++){var jt=Ct.get(Tt);if(jt.hidden||jt.writingMode===e.WritingMode.vertical&&!Et)fr(jt.numGlyphs,it);else{Et=!1;var Nt=[jt.anchorX,jt.anchorY,0,1];if(e.transformMat4(Nt,Nt,I),on(Nt,$e)){var ln=an(F.transform.cameraToCenterDistance,Nt[3]),bn=e.evaluateSizeForFeature(Ee,Ue,jt),In=ye?bn/ln:bn*ln,En=new e.Point(jt.anchorX,jt.anchorY),ir=nn(En,re).point,rr={},_r=Rn(jt,In,!1,ke,I,re,ue,E.glyphOffsetArray,_t,it,ir,En,rr,At);Et=_r.useVertical,(_r.notEnoughRoom||Et||_r.needsFlipping&&Rn(jt,In,!0,ke,I,re,ue,E.glyphOffsetArray,_t,it,ir,En,rr,At).notEnoughRoom)&&fr(jt.numGlyphs,it)}else fr(jt.numGlyphs,it)}}H?E.text.dynamicLayoutVertexBuffer.updateData(it):E.icon.dynamicLayoutVertexBuffer.updateData(it)}function _n(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e){var it=ke.glyphStartIndex+ke.numGlyphs,_t=ke.lineStartIndex,Ct=ke.lineStartIndex+ke.lineLength,At=I.getoffsetX(ke.glyphStartIndex),Et=I.getoffsetX(it-1),Tt=Xn(E*At,F,H,re,ue,ye,ke.segment,_t,Ct,Ee,Ue,$e);if(!Tt)return null;var jt=Xn(E*Et,F,H,re,ue,ye,ke.segment,_t,Ct,Ee,Ue,$e);return jt?{first:Tt,last:jt}:null}function Pn(E,I,F,H){return E===e.WritingMode.horizontal&&Math.abs(F.y-I.y)>Math.abs(F.x-I.x)*H?{useVertical:!0}:(E===e.WritingMode.vertical?I.y<F.y:I.x>F.x)?{needsFlipping:!0}:null}function Rn(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e,it,_t,Ct){var At,Et=I/24,Tt=E.lineOffsetX*Et,jt=E.lineOffsetY*Et;if(E.numGlyphs>1){var Nt=E.glyphStartIndex+E.numGlyphs,Yt=E.lineStartIndex,ln=E.lineStartIndex+E.lineLength,bn=_n(Et,ke,Tt,jt,F,$e,it,E,Ee,ue,_t);if(!bn)return{notEnoughRoom:!0};var In=nn(bn.first.point,ye).point,En=nn(bn.last.point,ye).point;if(H&&!F){var ir=Pn(E.writingMode,In,En,Ct);if(ir)return ir}At=[bn.first];for(var rr=E.glyphStartIndex+1;rr<Nt-1;rr++)At.push(Xn(Et*ke.getoffsetX(rr),Tt,jt,F,$e,it,E.segment,Yt,ln,Ee,ue,_t));At.push(bn.last)}else{if(H&&!F){var _r=nn(it,re).point,pr=E.lineStartIndex+E.segment+1,Qr=new e.Point(Ee.getx(pr),Ee.gety(pr)),li=nn(Qr,re),xi=li.signedDistanceFromCamera>0?li.point:qn(it,Qr,_r,1,re),Wn=Pn(E.writingMode,_r,xi,Ct);if(Wn)return Wn}var Rr=Xn(Et*ke.getoffsetX(E.glyphStartIndex),Tt,jt,F,$e,it,E.segment,E.lineStartIndex,E.lineStartIndex+E.lineLength,Ee,ue,_t);if(!Rr)return{notEnoughRoom:!0};At=[Rr]}for(var oi=0,ti=At;oi<ti.length;oi+=1){var vi=ti[oi];e.addDynamicAttributes(Ue,vi.point,vi.angle)}return{}}function qn(E,I,F,H,re){var ue=nn(E.add(E.sub(I)._unit()),re).point,ye=F.sub(ue);return F.add(ye._mult(H/ye.mag()))}function Xn(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e,it){var _t=H?E-I:E+I,Ct=_t>0?1:-1,At=0;H&&(Ct*=-1,At=Math.PI),Ct<0&&(At+=Math.PI);for(var Et=Ct>0?ke+ye:ke+ye+1,Tt=re,jt=re,Nt=0,Yt=0,ln=Math.abs(_t),bn=[];Nt+Yt<=ln;){if((Et+=Ct)<ke||Et>=Ee)return null;if(jt=Tt,bn.push(Tt),void 0===(Tt=it[Et])){var In=new e.Point(Ue.getx(Et),Ue.gety(Et)),En=nn(In,$e);if(En.signedDistanceFromCamera>0)Tt=it[Et]=En.point;else{var ir=Et-Ct;Tt=qn(0===Nt?ue:new e.Point(Ue.getx(ir),Ue.gety(ir)),In,jt,ln-Nt+1,$e)}}Nt+=Yt,Yt=jt.dist(Tt)}var rr=(ln-Nt)/Yt,_r=Tt.sub(jt),pr=_r.mult(rr)._add(jt);pr._add(_r._unit()._perp()._mult(F*Ct));var Qr=At+Math.atan2(Tt.y-jt.y,Tt.x-jt.x);return bn.push(pr),{point:pr,angle:Qr,path:bn}}vn.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},vn.prototype.insert=function(E,I,F,H,re){this._forEachCell(I,F,H,re,this._insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(I),this.bboxes.push(F),this.bboxes.push(H),this.bboxes.push(re)},vn.prototype.insertCircle=function(E,I,F,H){this._forEachCell(I-H,F-H,I+H,F+H,this._insertCircleCell,this.circleUid++),this.circleKeys.push(E),this.circles.push(I),this.circles.push(F),this.circles.push(H)},vn.prototype._insertBoxCell=function(E,I,F,H,re,ue){this.boxCells[re].push(ue)},vn.prototype._insertCircleCell=function(E,I,F,H,re,ue){this.circleCells[re].push(ue)},vn.prototype._query=function(E,I,F,H,re,ue){if(F<0||E>this.width||H<0||I>this.height)return!re&&[];var ye=[];if(E<=0&&I<=0&&this.width<=F&&this.height<=H){if(re)return!0;for(var ke=0;ke<this.boxKeys.length;ke++)ye.push({key:this.boxKeys[ke],x1:this.bboxes[4*ke],y1:this.bboxes[4*ke+1],x2:this.bboxes[4*ke+2],y2:this.bboxes[4*ke+3]});for(var Ee=0;Ee<this.circleKeys.length;Ee++){var Ue=this.circles[3*Ee],$e=this.circles[3*Ee+1],it=this.circles[3*Ee+2];ye.push({key:this.circleKeys[Ee],x1:Ue-it,y1:$e-it,x2:Ue+it,y2:$e+it})}return ue?ye.filter(ue):ye}return this._forEachCell(E,I,F,H,this._queryCell,ye,{hitTest:re,seenUids:{box:{},circle:{}}},ue),re?ye.length>0:ye},vn.prototype._queryCircle=function(E,I,F,H,re){var ue=E-F,ye=E+F,ke=I-F,Ee=I+F;if(ye<0||ue>this.width||Ee<0||ke>this.height)return!H&&[];var Ue=[];return this._forEachCell(ue,ke,ye,Ee,this._queryCellCircle,Ue,{hitTest:H,circle:{x:E,y:I,radius:F},seenUids:{box:{},circle:{}}},re),H?Ue.length>0:Ue},vn.prototype.query=function(E,I,F,H,re){return this._query(E,I,F,H,!1,re)},vn.prototype.hitTest=function(E,I,F,H,re){return this._query(E,I,F,H,!0,re)},vn.prototype.hitTestCircle=function(E,I,F,H){return this._queryCircle(E,I,F,!0,H)},vn.prototype._queryCell=function(E,I,F,H,re,ue,ye,ke){var Ee=ye.seenUids,Ue=this.boxCells[re];if(null!==Ue)for(var $e=this.bboxes,it=0,_t=Ue;it<_t.length;it+=1){var Ct=_t[it];if(!Ee.box[Ct]){Ee.box[Ct]=!0;var At=4*Ct;if(E<=$e[At+2]&&I<=$e[At+3]&&F>=$e[At+0]&&H>=$e[At+1]&&(!ke||ke(this.boxKeys[Ct]))){if(ye.hitTest)return ue.push(!0),!0;ue.push({key:this.boxKeys[Ct],x1:$e[At],y1:$e[At+1],x2:$e[At+2],y2:$e[At+3]})}}}var Et=this.circleCells[re];if(null!==Et)for(var Tt=this.circles,jt=0,Nt=Et;jt<Nt.length;jt+=1){var Yt=Nt[jt];if(!Ee.circle[Yt]){Ee.circle[Yt]=!0;var ln=3*Yt;if(this._circleAndRectCollide(Tt[ln],Tt[ln+1],Tt[ln+2],E,I,F,H)&&(!ke||ke(this.circleKeys[Yt]))){if(ye.hitTest)return ue.push(!0),!0;var bn=Tt[ln],In=Tt[ln+1],En=Tt[ln+2];ue.push({key:this.circleKeys[Yt],x1:bn-En,y1:In-En,x2:bn+En,y2:In+En})}}}},vn.prototype._queryCellCircle=function(E,I,F,H,re,ue,ye,ke){var Ee=ye.circle,Ue=ye.seenUids,$e=this.boxCells[re];if(null!==$e)for(var it=this.bboxes,_t=0,Ct=$e;_t<Ct.length;_t+=1){var At=Ct[_t];if(!Ue.box[At]){Ue.box[At]=!0;var Et=4*At;if(this._circleAndRectCollide(Ee.x,Ee.y,Ee.radius,it[Et+0],it[Et+1],it[Et+2],it[Et+3])&&(!ke||ke(this.boxKeys[At])))return ue.push(!0),!0}}var Tt=this.circleCells[re];if(null!==Tt)for(var jt=this.circles,Nt=0,Yt=Tt;Nt<Yt.length;Nt+=1){var ln=Yt[Nt];if(!Ue.circle[ln]){Ue.circle[ln]=!0;var bn=3*ln;if(this._circlesCollide(jt[bn],jt[bn+1],jt[bn+2],Ee.x,Ee.y,Ee.radius)&&(!ke||ke(this.circleKeys[ln])))return ue.push(!0),!0}}},vn.prototype._forEachCell=function(E,I,F,H,re,ue,ye,ke){for(var Ee=this._convertToXCellCoord(E),Ue=this._convertToYCellCoord(I),$e=this._convertToXCellCoord(F),it=this._convertToYCellCoord(H),_t=Ee;_t<=$e;_t++)for(var Ct=Ue;Ct<=it;Ct++)if(re.call(this,E,I,F,H,this.xCellCount*Ct+_t,ue,ye,ke))return},vn.prototype._convertToXCellCoord=function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))},vn.prototype._convertToYCellCoord=function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))},vn.prototype._circlesCollide=function(E,I,F,H,re,ue){var ye=H-E,ke=re-I,Ee=F+ue;return Ee*Ee>ye*ye+ke*ke},vn.prototype._circleAndRectCollide=function(E,I,F,H,re,ue,ye){var ke=(ue-H)/2,Ee=Math.abs(E-(H+ke));if(Ee>ke+F)return!1;var Ue=(ye-re)/2,$e=Math.abs(I-(re+Ue));if($e>Ue+F)return!1;if(Ee<=ke||$e<=Ue)return!0;var it=Ee-ke,_t=$e-Ue;return it*it+_t*_t<=F*F};var br=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function fr(E,I){for(var F=0;F<E;F++){var H=I.length;I.resize(H+4),I.float32.set(br,3*H)}}function Vr(E,I,F){var H=I[0],re=I[1];return E[0]=F[0]*H+F[4]*re+F[12],E[1]=F[1]*H+F[5]*re+F[13],E[3]=F[3]*H+F[7]*re+F[15],E}var cr=function(E,I,F){void 0===I&&(I=new vn(E.width+200,E.height+200,25)),void 0===F&&(F=new vn(E.width+200,E.height+200,25)),this.transform=E,this.grid=I,this.ignoredGrid=F,this.pitchfactor=Math.cos(E._pitch)*E.cameraToCenterDistance,this.screenRightBoundary=E.width+100,this.screenBottomBoundary=E.height+100,this.gridRightBoundary=E.width+200,this.gridBottomBoundary=E.height+200};function Sr(E,I,F){return I*(e.EXTENT/(E.tileSize*Math.pow(2,F-E.tileID.overscaledZ)))}cr.prototype.placeCollisionBox=function(E,I,F,H,re){var ue=this.projectAndGetPerspectiveRatio(H,E.anchorPointX,E.anchorPointY),ye=F*ue.perspectiveRatio,ke=E.x1*ye+ue.point.x,Ee=E.y1*ye+ue.point.y,Ue=E.x2*ye+ue.point.x,$e=E.y2*ye+ue.point.y;return!this.isInsideGrid(ke,Ee,Ue,$e)||!I&&this.grid.hitTest(ke,Ee,Ue,$e,re)?{box:[],offscreen:!1}:{box:[ke,Ee,Ue,$e],offscreen:this.isOffscreen(ke,Ee,Ue,$e)}},cr.prototype.placeCollisionCircles=function(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e,it,_t){var Ct=[],At=new e.Point(I.anchorX,I.anchorY),Et=nn(At,ue),Tt=an(this.transform.cameraToCenterDistance,Et.signedDistanceFromCamera),jt=(Ue?re/Tt:re*Tt)/e.ONE_EM,Nt=nn(At,ye).point,Yt=_n(jt,H,I.lineOffsetX*jt,I.lineOffsetY*jt,!1,Nt,At,I,F,ye,{}),ln=!1,bn=!1,In=!0;if(Yt){for(var En=.5*it*Tt+_t,ir=new e.Point(-100,-100),rr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),_r=new Zt,pr=Yt.first,Qr=Yt.last,li=[],xi=pr.path.length-1;xi>=1;xi--)li.push(pr.path[xi]);for(var Wn=1;Wn<Qr.path.length;Wn++)li.push(Qr.path[Wn]);var Rr=2.5*En;if(ke){var oi=li.map(function(Io){return nn(Io,ke)});li=oi.some(function(Io){return Io.signedDistanceFromCamera<=0})?[]:oi.map(function(Io){return Io.point})}var ti=[];if(li.length>0){for(var vi=li[0].clone(),ki=li[0].clone(),ji=1;ji<li.length;ji++)vi.x=Math.min(vi.x,li[ji].x),vi.y=Math.min(vi.y,li[ji].y),ki.x=Math.max(ki.x,li[ji].x),ki.y=Math.max(ki.y,li[ji].y);ti=vi.x>=ir.x&&ki.x<=rr.x&&vi.y>=ir.y&&ki.y<=rr.y?[li]:ki.x<ir.x||vi.x>rr.x||ki.y<ir.y||vi.y>rr.y?[]:e.clipLine([li],ir.x,ir.y,rr.x,rr.y)}for(var ui=0,Oi=ti;ui<Oi.length;ui+=1){_r.reset(Oi[ui],.25*En);var qi;qi=_r.length<=.5*En?1:Math.ceil(_r.paddedLength/Rr)+1;for(var Ii=0;Ii<qi;Ii++){var Hi=Ii/Math.max(qi-1,1),na=_r.lerp(Hi),Ca=na.x+100,Ka=na.y+100;Ct.push(Ca,Ka,En,0);var $a=Ca-En,Aa=Ka-En,Va=Ca+En,Oa=Ka+En;if(In=In&&this.isOffscreen($a,Aa,Va,Oa),bn=bn||this.isInsideGrid($a,Aa,Va,Oa),!E&&this.grid.hitTestCircle(Ca,Ka,En,$e)&&(ln=!0,!Ee))return{circles:[],offscreen:!1,collisionDetected:ln}}}}return{circles:!Ee&&ln||!bn?[]:Ct,offscreen:In,collisionDetected:ln}},cr.prototype.queryRenderedSymbols=function(E){if(0===E.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var I=[],F=1/0,H=1/0,re=-1/0,ue=-1/0,ye=0,ke=E;ye<ke.length;ye+=1){var Ee=ke[ye],Ue=new e.Point(Ee.x+100,Ee.y+100);F=Math.min(F,Ue.x),H=Math.min(H,Ue.y),re=Math.max(re,Ue.x),ue=Math.max(ue,Ue.y),I.push(Ue)}for(var $e={},it={},_t=0,Ct=this.grid.query(F,H,re,ue).concat(this.ignoredGrid.query(F,H,re,ue));_t<Ct.length;_t+=1){var At=Ct[_t],Et=At.key;if(void 0===$e[Et.bucketInstanceId]&&($e[Et.bucketInstanceId]={}),!$e[Et.bucketInstanceId][Et.featureIndex]){var Tt=[new e.Point(At.x1,At.y1),new e.Point(At.x2,At.y1),new e.Point(At.x2,At.y2),new e.Point(At.x1,At.y2)];e.polygonIntersectsPolygon(I,Tt)&&($e[Et.bucketInstanceId][Et.featureIndex]=!0,void 0===it[Et.bucketInstanceId]&&(it[Et.bucketInstanceId]=[]),it[Et.bucketInstanceId].push(Et.featureIndex))}}return it},cr.prototype.insertCollisionBox=function(E,I,F,H,re){(I?this.ignoredGrid:this.grid).insert({bucketInstanceId:F,featureIndex:H,collisionGroupID:re},E[0],E[1],E[2],E[3])},cr.prototype.insertCollisionCircles=function(E,I,F,H,re){for(var ue=I?this.ignoredGrid:this.grid,ye={bucketInstanceId:F,featureIndex:H,collisionGroupID:re},ke=0;ke<E.length;ke+=4)ue.insertCircle(ye,E[ke],E[ke+1],E[ke+2])},cr.prototype.projectAndGetPerspectiveRatio=function(E,I,F){var H=[I,F,0,1];return Vr(H,H,E),{point:new e.Point((H[0]/H[3]+1)/2*this.transform.width+100,(-H[1]/H[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/H[3]*.5}},cr.prototype.isOffscreen=function(E,I,F,H){return F<100||E>=this.screenRightBoundary||H<100||I>this.screenBottomBoundary},cr.prototype.isInsideGrid=function(E,I,F,H){return F>=0&&E<this.gridRightBoundary&&H>=0&&I<this.gridBottomBoundary},cr.prototype.getViewportMatrix=function(){var E=e.identity([]);return e.translate(E,E,[-100,-100,0]),E};var Cr=function(E,I,F,H){this.opacity=E?Math.max(0,Math.min(1,E.opacity+(E.placed?I:-I))):H&&F?1:0,this.placed=F};Cr.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var pi=function(E,I,F,H,re){this.text=new Cr(E?E.text:null,I,F,re),this.icon=new Cr(E?E.icon:null,I,H,re)};pi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Yn=function(E,I,F){this.text=E,this.icon=I,this.skipFade=F},ar=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Ar=function(E,I,F,H,re){this.bucketInstanceId=E,this.featureIndex=I,this.sourceLayerIndex=F,this.bucketIndex=H,this.tileID=re},sr=function(E){this.crossSourceCollisions=E,this.maxGroupID=0,this.collisionGroups={}};function dr(E,I,F,H,re){var ue=e.getAnchorAlignment(E),ye=-(ue.horizontalAlign-.5)*I,ke=-(ue.verticalAlign-.5)*F,Ee=e.evaluateVariableOffset(E,H);return new e.Point(ye+Ee[0]*re,ke+Ee[1]*re)}function $r(E,I,F,H,re,ue){var ye=E.x1,ke=E.x2,Ee=E.y1,Ue=E.y2,$e=E.anchorPointX,it=E.anchorPointY,_t=new e.Point(I,F);return H&&_t._rotate(re?ue:-ue),{x1:ye+_t.x,y1:Ee+_t.y,x2:ke+_t.x,y2:Ue+_t.y,anchorPointX:$e,anchorPointY:it}}sr.prototype.get=function(E){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[E]){var I=++this.maxGroupID;this.collisionGroups[E]={ID:I,predicate:function(F){return F.collisionGroupID===I}}}return this.collisionGroups[E]};var Lr=function(E,I,F,H){this.transform=E.clone(),this.collisionIndex=new cr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=I,this.retainedQueryData={},this.collisionGroups=new sr(F),this.collisionCircleArrays={},this.prevPlacement=H,H&&(H.prevPlacement=void 0),this.placedOrientations={}};function jr(E,I,F,H,re){E.emplaceBack(I?1:0,F?1:0,H||0,re||0),E.emplaceBack(I?1:0,F?1:0,H||0,re||0),E.emplaceBack(I?1:0,F?1:0,H||0,re||0),E.emplaceBack(I?1:0,F?1:0,H||0,re||0)}Lr.prototype.getBucketParts=function(E,I,F,H){var re=F.getBucket(I),ue=F.latestFeatureIndex;if(re&&ue&&I.id===re.layerIds[0]){var ye=F.collisionBoxArray,ke=re.layers[0].layout,Ee=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),Ue=F.tileSize/e.EXTENT,$e=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),it="map"===ke.get("text-pitch-alignment"),_t="map"===ke.get("text-rotation-alignment"),Ct=Sr(F,1,this.transform.zoom),At=zn($e,it,_t,this.transform,Ct),Et=null;if(it){var Tt=gn($e,it,_t,this.transform,Ct);Et=e.multiply([],this.transform.labelPlaneMatrix,Tt)}this.retainedQueryData[re.bucketInstanceId]=new Ar(re.bucketInstanceId,ue,re.sourceLayerIndex,re.index,F.tileID);var jt={bucket:re,layout:ke,posMatrix:$e,textLabelPlaneMatrix:At,labelToScreenMatrix:Et,scale:Ee,textPixelRatio:Ue,holdingForFade:F.holdingForFade(),collisionBoxArray:ye,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(re.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(re.sourceID)};if(H)for(var Nt=0,Yt=re.sortKeyRanges;Nt<Yt.length;Nt+=1){var ln=Yt[Nt];E.push({sortKey:ln.sortKey,symbolInstanceStart:ln.symbolInstanceStart,symbolInstanceEnd:ln.symbolInstanceEnd,parameters:jt})}else E.push({symbolInstanceStart:0,symbolInstanceEnd:re.symbolInstances.length,parameters:jt})}},Lr.prototype.attemptAnchorPlacement=function(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e,it,_t,Ct,At){var Et,Tt=[it.textOffset0,it.textOffset1],jt=dr(E,F,H,Tt,re),Nt=this.collisionIndex.placeCollisionBox($r(I,jt.x,jt.y,ue,ye,this.transform.angle),$e,ke,Ee,Ue.predicate);if((!At||0!==this.collisionIndex.placeCollisionBox($r(At,jt.x,jt.y,ue,ye,this.transform.angle),$e,ke,Ee,Ue.predicate).box.length)&&Nt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[it.crossTileID]&&this.prevPlacement.placements[it.crossTileID]&&this.prevPlacement.placements[it.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[it.crossTileID].anchor),this.variableOffsets[it.crossTileID]={textOffset:Tt,width:F,height:H,anchor:E,textBoxScale:re,prevAnchor:Et},this.markUsedJustification(_t,E,it,Ct),_t.allowVerticalPlacement&&(this.markUsedOrientation(_t,Ct,it),this.placedOrientations[it.crossTileID]=Ct),{shift:jt,placedGlyphBoxes:Nt}},Lr.prototype.placeLayerBucketPart=function(E,I,F){var H=this,re=E.parameters,ue=re.bucket,ye=re.layout,ke=re.posMatrix,Ee=re.textLabelPlaneMatrix,Ue=re.labelToScreenMatrix,$e=re.textPixelRatio,it=re.holdingForFade,_t=re.collisionBoxArray,Ct=re.partiallyEvaluatedTextSize,At=re.collisionGroup,Et=ye.get("text-optional"),Tt=ye.get("icon-optional"),jt=ye.get("text-allow-overlap"),Nt=ye.get("icon-allow-overlap"),Yt="map"===ye.get("text-rotation-alignment"),ln="map"===ye.get("text-pitch-alignment"),bn="none"!==ye.get("icon-text-fit"),In="viewport-y"===ye.get("symbol-z-order"),En=jt&&(Nt||!ue.hasIconData()||Tt),ir=Nt&&(jt||!ue.hasTextData()||Et);!ue.collisionArrays&&_t&&ue.deserializeCollisionBoxes(_t);var rr=function(Wn,Rr){if(!I[Wn.crossTileID])if(it)H.placements[Wn.crossTileID]=new Yn(!1,!1,!1);else{var oi,ti=!1,vi=!1,ki=!0,ji=null,ui={box:null,offscreen:null},Oi={box:null,offscreen:null},zi=null,qi=null,Ii=0,Hi=0,na=0;Rr.textFeatureIndex?Ii=Rr.textFeatureIndex:Wn.useRuntimeCollisionCircles&&(Ii=Wn.featureIndex),Rr.verticalTextFeatureIndex&&(Hi=Rr.verticalTextFeatureIndex);var Ca=Rr.textBox;if(Ca){var Ka=function(qa){var Go=e.WritingMode.horizontal;if(ue.allowVerticalPlacement&&!qa&&H.prevPlacement){var Xo=H.prevPlacement.placedOrientations[Wn.crossTileID];Xo&&(H.placedOrientations[Wn.crossTileID]=Xo,H.markUsedOrientation(ue,Go=Xo,Wn))}return Go},$a=function(qa,Go){if(ue.allowVerticalPlacement&&Wn.numVerticalGlyphVertices>0&&Rr.verticalTextBox)for(var Xo=0,yl=ue.writingModes;Xo<yl.length&&(yl[Xo]===e.WritingMode.vertical?(ui=Go(),Oi=ui):ui=qa(),!(ui&&ui.box&&ui.box.length));Xo+=1);else ui=qa()};if(ye.get("text-variable-anchor")){var Aa=ye.get("text-variable-anchor");if(H.prevPlacement&&H.prevPlacement.variableOffsets[Wn.crossTileID]){var Va=H.prevPlacement.variableOffsets[Wn.crossTileID];Aa.indexOf(Va.anchor)>0&&(Aa=Aa.filter(function(qa){return qa!==Va.anchor})).unshift(Va.anchor)}var Oa=function(qa,Go,Xo){for(var yl=qa.x2-qa.x1,Wc=qa.y2-qa.y1,fs=Wn.textBoxScale,Hl=bn&&!Nt?Go:null,ul={box:[],offscreen:!1},Jc=jt?2*Aa.length:Aa.length,Vs=0;Vs<Jc;++Vs){var tl=H.attemptAnchorPlacement(Aa[Vs%Aa.length],qa,yl,Wc,fs,Yt,ln,$e,ke,At,Vs>=Aa.length,Wn,ue,Xo,Hl);if(tl&&(ul=tl.placedGlyphBoxes)&&ul.box&&ul.box.length){ti=!0,ji=tl.shift;break}}return ul};$a(function(){return Oa(Ca,Rr.iconBox,e.WritingMode.horizontal)},function(){var qa=Rr.verticalTextBox;return ue.allowVerticalPlacement&&!(ui&&ui.box&&ui.box.length)&&Wn.numVerticalGlyphVertices>0&&qa?Oa(qa,Rr.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),ui&&(ti=ui.box,ki=ui.offscreen);var Io=Ka(ui&&ui.box);if(!ti&&H.prevPlacement){var po=H.prevPlacement.variableOffsets[Wn.crossTileID];po&&(H.variableOffsets[Wn.crossTileID]=po,H.markUsedJustification(ue,po.anchor,Wn,Io))}}else{var Qo=function(qa,Go){var Xo=H.collisionIndex.placeCollisionBox(qa,jt,$e,ke,At.predicate);return Xo&&Xo.box&&Xo.box.length&&(H.markUsedOrientation(ue,Go,Wn),H.placedOrientations[Wn.crossTileID]=Go),Xo};$a(function(){return Qo(Ca,e.WritingMode.horizontal)},function(){var qa=Rr.verticalTextBox;return ue.allowVerticalPlacement&&Wn.numVerticalGlyphVertices>0&&qa?Qo(qa,e.WritingMode.vertical):{box:null,offscreen:null}}),Ka(ui&&ui.box&&ui.box.length)}}if(ti=(oi=ui)&&oi.box&&oi.box.length>0,ki=oi&&oi.offscreen,Wn.useRuntimeCollisionCircles){var Os=ue.text.placedSymbolArray.get(Wn.centerJustifiedTextSymbolIndex),Us=e.evaluateSizeForFeature(ue.textSizeData,Ct,Os),sl=ye.get("text-padding");zi=H.collisionIndex.placeCollisionCircles(jt,Os,ue.lineVertexArray,ue.glyphOffsetArray,Us,ke,Ee,Ue,F,ln,At.predicate,Wn.collisionCircleDiameter,sl),ti=jt||zi.circles.length>0&&!zi.collisionDetected,ki=ki&&zi.offscreen}if(Rr.iconFeatureIndex&&(na=Rr.iconFeatureIndex),Rr.iconBox){var el=function(qa){var Go=bn&&ji?$r(qa,ji.x,ji.y,Yt,ln,H.transform.angle):qa;return H.collisionIndex.placeCollisionBox(Go,Nt,$e,ke,At.predicate)};vi=Oi&&Oi.box&&Oi.box.length&&Rr.verticalIconBox?(qi=el(Rr.verticalIconBox)).box.length>0:(qi=el(Rr.iconBox)).box.length>0,ki=ki&&qi.offscreen}var Do=Et||0===Wn.numHorizontalGlyphVertices&&0===Wn.numVerticalGlyphVertices,Gs=Tt||0===Wn.numIconVertices;if(Do||Gs?Gs?Do||(vi=vi&&ti):ti=vi&&ti:vi=ti=vi&&ti,ti&&oi&&oi.box&&H.collisionIndex.insertCollisionBox(oi.box,ye.get("text-ignore-placement"),ue.bucketInstanceId,Oi&&Oi.box&&Hi?Hi:Ii,At.ID),vi&&qi&&H.collisionIndex.insertCollisionBox(qi.box,ye.get("icon-ignore-placement"),ue.bucketInstanceId,na,At.ID),zi&&(ti&&H.collisionIndex.insertCollisionCircles(zi.circles,ye.get("text-ignore-placement"),ue.bucketInstanceId,Ii,At.ID),F)){var ll=ue.bucketInstanceId,vs=H.collisionCircleArrays[ll];void 0===vs&&(vs=H.collisionCircleArrays[ll]=new ar);for(var cl=0;cl<zi.circles.length;cl+=4)vs.circles.push(zi.circles[cl+0]),vs.circles.push(zi.circles[cl+1]),vs.circles.push(zi.circles[cl+2]),vs.circles.push(zi.collisionDetected?1:0)}H.placements[Wn.crossTileID]=new Yn(ti||En,vi||ir,ki||ue.justReloaded),I[Wn.crossTileID]=!0}};if(In)for(var _r=ue.getSortedSymbolIndexes(this.transform.angle),pr=_r.length-1;pr>=0;--pr){var Qr=_r[pr];rr(ue.symbolInstances.get(Qr),ue.collisionArrays[Qr])}else for(var li=E.symbolInstanceStart;li<E.symbolInstanceEnd;li++)rr(ue.symbolInstances.get(li),ue.collisionArrays[li]);if(F&&ue.bucketInstanceId in this.collisionCircleArrays){var xi=this.collisionCircleArrays[ue.bucketInstanceId];e.invert(xi.invProjMatrix,ke),xi.viewportMatrix=this.collisionIndex.getViewportMatrix()}ue.justReloaded=!1},Lr.prototype.markUsedJustification=function(E,I,F,H){var re;re=H===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(I)];for(var ye=0,ke=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];ye<ke.length;ye+=1){var Ee=ke[ye];Ee>=0&&(E.text.placedSymbolArray.get(Ee).crossTileID=re>=0&&Ee!==re?0:F.crossTileID)}},Lr.prototype.markUsedOrientation=function(E,I,F){for(var H=I===e.WritingMode.horizontal||I===e.WritingMode.horizontalOnly?I:0,re=I===e.WritingMode.vertical?I:0,ue=0,ye=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];ue<ye.length;ue+=1)E.text.placedSymbolArray.get(ye[ue]).placedOrientation=H;F.verticalPlacedTextSymbolIndex&&(E.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=re)},Lr.prototype.commit=function(E){this.commitTime=E,this.zoomAtLastRecencyCheck=this.transform.zoom;var I=this.prevPlacement,F=!1;this.prevZoomAdjustment=I?I.zoomAdjustment(this.transform.zoom):0;var H=I?I.symbolFadeChange(E):1,re=I?I.opacities:{},ue=I?I.variableOffsets:{},ye=I?I.placedOrientations:{};for(var ke in this.placements){var Ee=this.placements[ke],Ue=re[ke];Ue?(this.opacities[ke]=new pi(Ue,H,Ee.text,Ee.icon),F=F||Ee.text!==Ue.text.placed||Ee.icon!==Ue.icon.placed):(this.opacities[ke]=new pi(null,H,Ee.text,Ee.icon,Ee.skipFade),F=F||Ee.text||Ee.icon)}for(var $e in re){var it=re[$e];if(!this.opacities[$e]){var _t=new pi(it,H,!1,!1);_t.isHidden()||(this.opacities[$e]=_t,F=F||it.text.placed||it.icon.placed)}}for(var Ct in ue)this.variableOffsets[Ct]||!this.opacities[Ct]||this.opacities[Ct].isHidden()||(this.variableOffsets[Ct]=ue[Ct]);for(var At in ye)this.placedOrientations[At]||!this.opacities[At]||this.opacities[At].isHidden()||(this.placedOrientations[At]=ye[At]);F?this.lastPlacementChangeTime=E:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=I?I.lastPlacementChangeTime:E)},Lr.prototype.updateLayerOpacities=function(E,I){for(var F={},H=0,re=I;H<re.length;H+=1){var ue=re[H],ye=ue.getBucket(E);ye&&ue.latestFeatureIndex&&E.id===ye.layerIds[0]&&this.updateBucketOpacities(ye,F,ue.collisionBoxArray)}},Lr.prototype.updateBucketOpacities=function(E,I,F){var H=this;E.hasTextData()&&E.text.opacityVertexArray.clear(),E.hasIconData()&&E.icon.opacityVertexArray.clear(),E.hasIconCollisionBoxData()&&E.iconCollisionBox.collisionVertexArray.clear(),E.hasTextCollisionBoxData()&&E.textCollisionBox.collisionVertexArray.clear();var re=E.layers[0].layout,ue=new pi(null,0,!1,!1,!0),ye=re.get("text-allow-overlap"),ke=re.get("icon-allow-overlap"),Ee=re.get("text-variable-anchor"),Ue="map"===re.get("text-rotation-alignment"),$e="map"===re.get("text-pitch-alignment"),it="none"!==re.get("icon-text-fit"),_t=new pi(null,0,ye&&(ke||!E.hasIconData()||re.get("icon-optional")),ke&&(ye||!E.hasTextData()||re.get("text-optional")),!0);!E.collisionArrays&&F&&(E.hasIconCollisionBoxData()||E.hasTextCollisionBoxData())&&E.deserializeCollisionBoxes(F);for(var Ct=function(jt,Nt,Yt){for(var ln=0;ln<Nt/4;ln++)jt.opacityVertexArray.emplaceBack(Yt)},At=function(jt){var Nt=E.symbolInstances.get(jt),Yt=Nt.numHorizontalGlyphVertices,ln=Nt.numVerticalGlyphVertices,bn=Nt.crossTileID,En=H.opacities[bn];I[bn]?En=ue:En||(H.opacities[bn]=En=_t),I[bn]=!0;var rr=Nt.numIconVertices>0,_r=H.placedOrientations[Nt.crossTileID],pr=_r===e.WritingMode.vertical,Qr=_r===e.WritingMode.horizontal||_r===e.WritingMode.horizontalOnly;if(Yt>0||ln>0){var li=Un(En.text);Ct(E.text,Yt,pr?jn:li),Ct(E.text,ln,Qr?jn:li);var Rr=En.text.isHidden();[Nt.rightJustifiedTextSymbolIndex,Nt.centerJustifiedTextSymbolIndex,Nt.leftJustifiedTextSymbolIndex].forEach(function(na){na>=0&&(E.text.placedSymbolArray.get(na).hidden=Rr||pr?1:0)}),Nt.verticalPlacedTextSymbolIndex>=0&&(E.text.placedSymbolArray.get(Nt.verticalPlacedTextSymbolIndex).hidden=Rr||Qr?1:0);var oi=H.variableOffsets[Nt.crossTileID];oi&&H.markUsedJustification(E,oi.anchor,Nt,_r);var ti=H.placedOrientations[Nt.crossTileID];ti&&(H.markUsedJustification(E,"left",Nt,ti),H.markUsedOrientation(E,ti,Nt))}if(rr){var vi=Un(En.icon),ki=!(it&&Nt.verticalPlacedIconSymbolIndex&&pr);Nt.placedIconSymbolIndex>=0&&(Ct(E.icon,Nt.numIconVertices,ki?vi:jn),E.icon.placedSymbolArray.get(Nt.placedIconSymbolIndex).hidden=En.icon.isHidden()),Nt.verticalPlacedIconSymbolIndex>=0&&(Ct(E.icon,Nt.numVerticalIconVertices,ki?jn:vi),E.icon.placedSymbolArray.get(Nt.verticalPlacedIconSymbolIndex).hidden=En.icon.isHidden())}if(E.hasIconCollisionBoxData()||E.hasTextCollisionBoxData()){var Oi=E.collisionArrays[jt];if(Oi){var zi=new e.Point(0,0);if(Oi.textBox||Oi.verticalTextBox){var qi=!0;if(Ee){var Ii=H.variableOffsets[bn];Ii?(zi=dr(Ii.anchor,Ii.width,Ii.height,Ii.textOffset,Ii.textBoxScale),Ue&&zi._rotate($e?H.transform.angle:-H.transform.angle)):qi=!1}Oi.textBox&&jr(E.textCollisionBox.collisionVertexArray,En.text.placed,!qi||pr,zi.x,zi.y),Oi.verticalTextBox&&jr(E.textCollisionBox.collisionVertexArray,En.text.placed,!qi||Qr,zi.x,zi.y)}var Hi=Boolean(!Qr&&Oi.verticalIconBox);Oi.iconBox&&jr(E.iconCollisionBox.collisionVertexArray,En.icon.placed,Hi,it?zi.x:0,it?zi.y:0),Oi.verticalIconBox&&jr(E.iconCollisionBox.collisionVertexArray,En.icon.placed,!Hi,it?zi.x:0,it?zi.y:0)}}},Et=0;Et<E.symbolInstances.length;Et++)At(Et);if(E.sortFeatures(this.transform.angle),this.retainedQueryData[E.bucketInstanceId]&&(this.retainedQueryData[E.bucketInstanceId].featureSortOrder=E.featureSortOrder),E.hasTextData()&&E.text.opacityVertexBuffer&&E.text.opacityVertexBuffer.updateData(E.text.opacityVertexArray),E.hasIconData()&&E.icon.opacityVertexBuffer&&E.icon.opacityVertexBuffer.updateData(E.icon.opacityVertexArray),E.hasIconCollisionBoxData()&&E.iconCollisionBox.collisionVertexBuffer&&E.iconCollisionBox.collisionVertexBuffer.updateData(E.iconCollisionBox.collisionVertexArray),E.hasTextCollisionBoxData()&&E.textCollisionBox.collisionVertexBuffer&&E.textCollisionBox.collisionVertexBuffer.updateData(E.textCollisionBox.collisionVertexArray),E.bucketInstanceId in this.collisionCircleArrays){var Tt=this.collisionCircleArrays[E.bucketInstanceId];E.placementInvProjMatrix=Tt.invProjMatrix,E.placementViewportMatrix=Tt.viewportMatrix,E.collisionCircleArray=Tt.circles,delete this.collisionCircleArrays[E.bucketInstanceId]}},Lr.prototype.symbolFadeChange=function(E){return 0===this.fadeDuration?1:(E-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Lr.prototype.zoomAdjustment=function(E){return Math.max(0,(this.transform.zoom-E)/1.5)},Lr.prototype.hasTransitions=function(E){return this.stale||E-this.lastPlacementChangeTime<this.fadeDuration},Lr.prototype.stillRecent=function(E,I){var F=this.zoomAtLastRecencyCheck===I?1-this.zoomAdjustment(I):1;return this.zoomAtLastRecencyCheck=I,this.commitTime+this.fadeDuration*F>E},Lr.prototype.setStale=function(){this.stale=!0};var ri=Math.pow(2,25),sn=Math.pow(2,24),wn=Math.pow(2,17),It=Math.pow(2,16),hn=Math.pow(2,9),yn=Math.pow(2,8),Hn=Math.pow(2,1);function Un(E){if(0===E.opacity&&!E.placed)return 0;if(1===E.opacity&&E.placed)return 4294967295;var I=E.placed?1:0,F=Math.floor(127*E.opacity);return F*ri+I*sn+F*wn+I*It+F*hn+I*yn+F*Hn+I}var jn=0,On=function(E){this._sortAcrossTiles="viewport-y"!==E.layout.get("symbol-z-order")&&void 0!==E.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};On.prototype.continuePlacement=function(E,I,F,H,re){for(var ue=this._bucketParts;this._currentTileIndex<E.length;)if(I.getBucketParts(ue,H,E[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,re())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,ue.sort(function(Ee,Ue){return Ee.sortKey-Ue.sortKey}));this._currentPartIndex<ue.length;)if(I.placeLayerBucketPart(ue[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,re())return!0;return!1};var kn=function(E,I,F,H,re,ue,ye){this.placement=new Lr(E,re,ue,ye),this._currentPlacementIndex=I.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=H,this._done=!1};kn.prototype.isDone=function(){return this._done},kn.prototype.continuePlacement=function(E,I,F){for(var H=this,re=e.browser.now(),ue=function(){var Ee=e.browser.now()-re;return!H._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var ye=I[E[this._currentPlacementIndex]],ke=this.placement.collisionIndex.transform.zoom;if("symbol"===ye.type&&(!ye.minzoom||ye.minzoom<=ke)&&(!ye.maxzoom||ye.maxzoom>ke)){if(this._inProgressLayer||(this._inProgressLayer=new On(ye)),this._inProgressLayer.continuePlacement(F[ye.source],this.placement,this._showCollisionBoxes,ye,ue))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},kn.prototype.commit=function(E){return this.placement.commit(E),this.placement};var Mn=512/e.EXTENT/2,Ln=function(E,I,F){this.tileID=E,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var H=0;H<I.length;H++){var re=I.get(H),ue=re.key;this.indexedSymbolInstances[ue]||(this.indexedSymbolInstances[ue]=[]),this.indexedSymbolInstances[ue].push({crossTileID:re.crossTileID,coord:this.getScaledCoordinates(re,E)})}};Ln.prototype.getScaledCoordinates=function(E,I){var H=Mn/Math.pow(2,I.canonical.z-this.tileID.canonical.z);return{x:Math.floor((I.canonical.x*e.EXTENT+E.anchorX)*H),y:Math.floor((I.canonical.y*e.EXTENT+E.anchorY)*H)}},Ln.prototype.findMatches=function(E,I,F){for(var H=this.tileID.canonical.z<I.canonical.z?1:Math.pow(2,this.tileID.canonical.z-I.canonical.z),re=0;re<E.length;re++){var ue=E.get(re);if(!ue.crossTileID){var ye=this.indexedSymbolInstances[ue.key];if(ye)for(var ke=this.getScaledCoordinates(ue,I),Ee=0,Ue=ye;Ee<Ue.length;Ee+=1){var $e=Ue[Ee];if(Math.abs($e.coord.x-ke.x)<=H&&Math.abs($e.coord.y-ke.y)<=H&&!F[$e.crossTileID]){F[$e.crossTileID]=!0,ue.crossTileID=$e.crossTileID;break}}}}};var Dn=function(){this.maxCrossTileID=0};Dn.prototype.generate=function(){return++this.maxCrossTileID};var Kn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Kn.prototype.handleWrapJump=function(E){var I=Math.round((E-this.lng)/360);if(0!==I)for(var F in this.indexes){var H=this.indexes[F],re={};for(var ue in H){var ye=H[ue];ye.tileID=ye.tileID.unwrapTo(ye.tileID.wrap+I),re[ye.tileID.key]=ye}this.indexes[F]=re}this.lng=E},Kn.prototype.addBucket=function(E,I,F){if(this.indexes[E.overscaledZ]&&this.indexes[E.overscaledZ][E.key]){if(this.indexes[E.overscaledZ][E.key].bucketInstanceId===I.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(E.overscaledZ,this.indexes[E.overscaledZ][E.key])}for(var H=0;H<I.symbolInstances.length;H++)I.symbolInstances.get(H).crossTileID=0;this.usedCrossTileIDs[E.overscaledZ]||(this.usedCrossTileIDs[E.overscaledZ]={});var re=this.usedCrossTileIDs[E.overscaledZ];for(var ue in this.indexes){var ye=this.indexes[ue];if(Number(ue)>E.overscaledZ)for(var ke in ye){var Ee=ye[ke];Ee.tileID.isChildOf(E)&&Ee.findMatches(I.symbolInstances,E,re)}else{var Ue=ye[E.scaledTo(Number(ue)).key];Ue&&Ue.findMatches(I.symbolInstances,E,re)}}for(var $e=0;$e<I.symbolInstances.length;$e++){var it=I.symbolInstances.get($e);it.crossTileID||(it.crossTileID=F.generate(),re[it.crossTileID]=!0)}return void 0===this.indexes[E.overscaledZ]&&(this.indexes[E.overscaledZ]={}),this.indexes[E.overscaledZ][E.key]=new Ln(E,I.symbolInstances,I.bucketInstanceId),!0},Kn.prototype.removeBucketCrossTileIDs=function(E,I){for(var F in I.indexedSymbolInstances)for(var H=0,re=I.indexedSymbolInstances[F];H<re.length;H+=1)delete this.usedCrossTileIDs[E][re[H].crossTileID]},Kn.prototype.removeStaleBuckets=function(E){var I=!1;for(var F in this.indexes){var H=this.indexes[F];for(var re in H)E[H[re].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,H[re]),delete H[re],I=!0)}return I};var Qn=function(){this.layerIndexes={},this.crossTileIDs=new Dn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Qn.prototype.addLayer=function(E,I,F){var H=this.layerIndexes[E.id];void 0===H&&(H=this.layerIndexes[E.id]=new Kn);var re=!1,ue={};H.handleWrapJump(F);for(var ye=0,ke=I;ye<ke.length;ye+=1){var Ee=ke[ye],Ue=Ee.getBucket(E);Ue&&E.id===Ue.layerIds[0]&&(Ue.bucketInstanceId||(Ue.bucketInstanceId=++this.maxBucketInstanceId),H.addBucket(Ee.tileID,Ue,this.crossTileIDs)&&(re=!0),ue[Ue.bucketInstanceId]=!0)}return H.removeStaleBuckets(ue)&&(re=!0),re},Qn.prototype.pruneUnusedLayers=function(E){var I={};for(var F in E.forEach(function(H){I[H]=!0}),this.layerIndexes)I[F]||delete this.layerIndexes[F]};var lr=function(E,I){return e.emitValidationErrors(E,I&&I.filter(function(F){return"source.canvas"!==F.identifier}))},hr=e.pick(St,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Mr=e.pick(St,["setCenter","setZoom","setBearing","setPitch"]),Er=function(){var E={},I=e.styleSpec.$version;for(var F in e.styleSpec.$root){var H=e.styleSpec.$root[F];if(H.required){var re;null!=(re="version"===F?I:"array"===H.type?[]:{})&&(E[F]=re)}}return E}(),Pr=function(E){function I(F,H){var re=this;void 0===H&&(H={}),E.call(this),this.map=F,this.dispatcher=new S(ot(),this),this.imageManager=new u,this.imageManager.setEventedParent(this),this.glyphManager=new T(F._requestManager,H.localIdeographFontFamily),this.lineAtlas=new z(256,512),this.crossTileSymbolIndex=new Qn,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var ue=this;this._rtlTextPluginCallback=I.registerForPluginStateChange(function(ye){ue.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:ye.pluginStatus,pluginURL:ye.pluginURL},function(Ee,Ue){if(e.triggerPluginCompletionEvent(Ee),Ue&&Ue.every(function(it){return it}))for(var $e in ue.sourceCaches)ue.sourceCaches[$e].reload()})}),this.on("data",function(ye){if("source"===ye.dataType&&"metadata"===ye.sourceDataType){var ke=re.sourceCaches[ye.sourceId];if(ke){var Ee=ke.getSource();if(Ee&&Ee.vectorLayerIds)for(var Ue in re._layers){var $e=re._layers[Ue];$e.source===Ee.id&&re._validateLayer($e)}}}})}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.loadURL=function(F,H){var re=this;void 0===H&&(H={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var ue="boolean"==typeof H.validate?H.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,H.accessToken);var ye=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(ye,function(ke,Ee){re._request=null,ke?re.fire(new e.ErrorEvent(ke)):Ee&&re._load(Ee,ue)})},I.prototype.loadJSON=function(F,H){var re=this;void 0===H&&(H={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){re._request=null,re._load(F,!1!==H.validate)})},I.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Er,!1)},I.prototype._load=function(F,H){if(!H||!lr(this,e.validateStyle(F))){for(var re in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(re,F.sources[re],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var ue=qt(this.stylesheet.layers);this._order=ue.map(function(Ue){return Ue.id}),this._layers={},this._serializedLayers={};for(var ye=0,ke=ue;ye<ke.length;ye+=1){var Ee=ke[ye];(Ee=e.createStyleLayer(Ee)).setEventedParent(this,{layer:{id:Ee.id}}),this._layers[Ee.id]=Ee,this._serializedLayers[Ee.id]=Ee.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new P(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},I.prototype._loadSprite=function(F){var H=this;this._spriteRequest=function(re,ue,ye){var ke,Ee,Ue,$e=e.browser.devicePixelRatio>1?"@2x":"",it=e.getJSON(ue.transformRequest(ue.normalizeSpriteURL(re,$e,".json"),e.ResourceType.SpriteJSON),function(At,Et){it=null,Ue||(Ue=At,ke=Et,Ct())}),_t=e.getImage(ue.transformRequest(ue.normalizeSpriteURL(re,$e,".png"),e.ResourceType.SpriteImage),function(At,Et){_t=null,Ue||(Ue=At,Ee=Et,Ct())});function Ct(){if(Ue)ye(Ue);else if(ke&&Ee){var At=e.browser.getImageData(Ee),Et={};for(var Tt in ke){var jt=ke[Tt],Nt=jt.width,Yt=jt.height,ln=jt.x,bn=jt.y,In=jt.sdf,En=jt.pixelRatio,ir=jt.stretchX,rr=jt.stretchY,_r=jt.content,pr=new e.RGBAImage({width:Nt,height:Yt});e.RGBAImage.copy(At,pr,{x:ln,y:bn},{x:0,y:0},{width:Nt,height:Yt}),Et[Tt]={data:pr,pixelRatio:En,sdf:In,stretchX:ir,stretchY:rr,content:_r}}ye(null,Et)}}return{cancel:function(){it&&(it.cancel(),it=null),_t&&(_t.cancel(),_t=null)}}}(F,this.map._requestManager,function(re,ue){if(H._spriteRequest=null,re)H.fire(new e.ErrorEvent(re));else if(ue)for(var ye in ue)H.imageManager.addImage(ye,ue[ye]);H.imageManager.setLoaded(!0),H._availableImages=H.imageManager.listImages(),H.dispatcher.broadcast("setImages",H._availableImages),H.fire(new e.Event("data",{dataType:"style"}))})},I.prototype._validateLayer=function(F){var H=this.sourceCaches[F.source];if(H){var re=F.sourceLayer;if(re){var ue=H.getSource();("geojson"===ue.type||ue.vectorLayerIds&&-1===ue.vectorLayerIds.indexOf(re))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+re+'" does not exist on source "'+ue.id+'" as specified by style layer "'+F.id+'"')))}}},I.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},I.prototype._serializeLayers=function(F){for(var H=[],re=0,ue=F;re<ue.length;re+=1){var ke=this._layers[ue[re]];"custom"!==ke.type&&H.push(ke.serialize())}return H},I.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var H in this._layers)if(this._layers[H].hasTransition())return!0;return!1},I.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},I.prototype.update=function(F){if(this._loaded){var H=this._changed;if(this._changed){var re=Object.keys(this._updatedLayers),ue=Object.keys(this._removedLayers);for(var ye in(re.length||ue.length)&&this._updateWorkerLayers(re,ue),this._updatedSources){var ke=this._updatedSources[ye];"reload"===ke?this._reloadSource(ye):"clear"===ke&&this._clearSource(ye)}for(var Ee in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Ee].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var Ue in this.sourceCaches)this.sourceCaches[Ue].used=!1;for(var $e=0,it=this._order;$e<it.length;$e+=1){var Ct=this._layers[it[$e]];Ct.recalculate(F,this._availableImages),!Ct.isHidden(F.zoom)&&Ct.source&&(this.sourceCaches[Ct.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,H&&this.fire(new e.Event("data",{dataType:"style"}))}},I.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var H in this.sourceCaches)this.sourceCaches[H].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},I.prototype._updateWorkerLayers=function(F,H){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:H})},I.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},I.prototype.setState=function(F){var H=this;if(this._checkLoaded(),lr(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=qt(F.layers);var re=function Kt(E,I){if(!E)return[{command:St.setStyle,args:[I]}];var F=[];try{if(!e.deepEqual(E.version,I.version))return[{command:St.setStyle,args:[I]}];e.deepEqual(E.center,I.center)||F.push({command:St.setCenter,args:[I.center]}),e.deepEqual(E.zoom,I.zoom)||F.push({command:St.setZoom,args:[I.zoom]}),e.deepEqual(E.bearing,I.bearing)||F.push({command:St.setBearing,args:[I.bearing]}),e.deepEqual(E.pitch,I.pitch)||F.push({command:St.setPitch,args:[I.pitch]}),e.deepEqual(E.sprite,I.sprite)||F.push({command:St.setSprite,args:[I.sprite]}),e.deepEqual(E.glyphs,I.glyphs)||F.push({command:St.setGlyphs,args:[I.glyphs]}),e.deepEqual(E.transition,I.transition)||F.push({command:St.setTransition,args:[I.transition]}),e.deepEqual(E.light,I.light)||F.push({command:St.setLight,args:[I.light]});var H={},re=[];!function(ye,ke,Ee,Ue){var $e;for($e in ke=ke||{},ye=ye||{})ye.hasOwnProperty($e)&&(ke.hasOwnProperty($e)||Ce($e,Ee,Ue));for($e in ke)ke.hasOwnProperty($e)&&(ye.hasOwnProperty($e)?e.deepEqual(ye[$e],ke[$e])||("geojson"===ye[$e].type&&"geojson"===ke[$e].type&&st(ye,ke,$e)?Ee.push({command:St.setGeoJSONSourceData,args:[$e,ke[$e].data]}):Xe($e,ke,Ee,Ue)):Mt($e,ke,Ee))}(E.sources,I.sources,re,H);var ue=[];E.layers&&E.layers.forEach(function(ye){H[ye.source]?F.push({command:St.removeLayer,args:[ye.id]}):ue.push(ye)}),F=F.concat(re),function(ye,ke,Ee){ke=ke||[];var Ue,$e,it,_t,Ct,At,Et,Tt=(ye=ye||[]).map(zt),jt=ke.map(zt),Nt=ye.reduce(Ht,{}),Yt=ke.reduce(Ht,{}),ln=Tt.slice(),bn=Object.create(null);for(Ue=0,$e=0;Ue<Tt.length;Ue++)Yt.hasOwnProperty(it=Tt[Ue])?$e++:(Ee.push({command:St.removeLayer,args:[it]}),ln.splice(ln.indexOf(it,$e),1));for(Ue=0,$e=0;Ue<jt.length;Ue++)ln[ln.length-1-Ue]!==(it=jt[jt.length-1-Ue])&&(Nt.hasOwnProperty(it)?(Ee.push({command:St.removeLayer,args:[it]}),ln.splice(ln.lastIndexOf(it,ln.length-$e),1)):$e++,Ee.push({command:St.addLayer,args:[Yt[it],At=ln[ln.length-Ue]]}),ln.splice(ln.length-Ue,0,it),bn[it]=!0);for(Ue=0;Ue<jt.length;Ue++)if(_t=Nt[it=jt[Ue]],Ct=Yt[it],!bn[it]&&!e.deepEqual(_t,Ct))if(e.deepEqual(_t.source,Ct.source)&&e.deepEqual(_t["source-layer"],Ct["source-layer"])&&e.deepEqual(_t.type,Ct.type)){for(Et in dt(_t.layout,Ct.layout,Ee,it,null,St.setLayoutProperty),dt(_t.paint,Ct.paint,Ee,it,null,St.setPaintProperty),e.deepEqual(_t.filter,Ct.filter)||Ee.push({command:St.setFilter,args:[it,Ct.filter]}),e.deepEqual(_t.minzoom,Ct.minzoom)&&e.deepEqual(_t.maxzoom,Ct.maxzoom)||Ee.push({command:St.setLayerZoomRange,args:[it,Ct.minzoom,Ct.maxzoom]}),_t)_t.hasOwnProperty(Et)&&"layout"!==Et&&"paint"!==Et&&"filter"!==Et&&"metadata"!==Et&&"minzoom"!==Et&&"maxzoom"!==Et&&(0===Et.indexOf("paint.")?dt(_t[Et],Ct[Et],Ee,it,Et.slice(6),St.setPaintProperty):e.deepEqual(_t[Et],Ct[Et])||Ee.push({command:St.setLayerProperty,args:[it,Et,Ct[Et]]}));for(Et in Ct)Ct.hasOwnProperty(Et)&&!_t.hasOwnProperty(Et)&&"layout"!==Et&&"paint"!==Et&&"filter"!==Et&&"metadata"!==Et&&"minzoom"!==Et&&"maxzoom"!==Et&&(0===Et.indexOf("paint.")?dt(_t[Et],Ct[Et],Ee,it,Et.slice(6),St.setPaintProperty):e.deepEqual(_t[Et],Ct[Et])||Ee.push({command:St.setLayerProperty,args:[it,Et,Ct[Et]]}))}else Ee.push({command:St.removeLayer,args:[it]}),At=ln[ln.lastIndexOf(it)+1],Ee.push({command:St.addLayer,args:[Ct,At]})}(ue,I.layers,F)}catch(ye){console.warn("Unable to compute style diff:",ye),F=[{command:St.setStyle,args:[I]}]}return F}(this.serialize(),F).filter(function(ye){return!(ye.command in Mr)});if(0===re.length)return!1;var ue=re.filter(function(ye){return!(ye.command in hr)});if(ue.length>0)throw new Error("Unimplemented: "+ue.map(function(ye){return ye.command}).join(", ")+".");return re.forEach(function(ye){"setTransition"!==ye.command&&H[ye.command].apply(H,ye.args)}),this.stylesheet=F,!0},I.prototype.addImage=function(F,H){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,H),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},I.prototype.updateImage=function(F,H){this.imageManager.updateImage(F,H)},I.prototype.getImage=function(F){return this.imageManager.getImage(F)},I.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},I.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},I.prototype.addSource=function(F,H,re){var ue=this;if(void 0===re&&(re={}),this._checkLoaded(),void 0!==this.sourceCaches[F])throw new Error("There is already a source with this ID");if(!H.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(H).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(H.type)>=0&&this._validate(e.validateStyle.source,"sources."+F,H,null,re))){this.map&&this.map._collectResourceTiming&&(H.collectResourceTiming=!0);var ye=this.sourceCaches[F]=new Fe(F,H,this.dispatcher);ye.style=this,ye.setEventedParent(this,function(){return{isSourceLoaded:ue.loaded(),source:ye.serialize(),sourceId:F}}),ye.onAdd(this.map),this._changed=!0}},I.prototype.removeSource=function(F){if(this._checkLoaded(),void 0===this.sourceCaches[F])throw new Error("There is no source with this ID");for(var H in this._layers)if(this._layers[H].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+H+'" is using it.')));var re=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],re.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),re.setEventedParent(null),re.clearTiles(),re.onRemove&&re.onRemove(this.map),this._changed=!0},I.prototype.setGeoJSONSourceData=function(F,H){this._checkLoaded(),this.sourceCaches[F].getSource().setData(H),this._changed=!0},I.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},I.prototype.addLayer=function(F,H,re){void 0===re&&(re={}),this._checkLoaded();var ue=F.id;if(this.getLayer(ue))this.fire(new e.ErrorEvent(new Error('Layer with id "'+ue+'" already exists on this map')));else{var ye;if("custom"===F.type){if(lr(this,e.validateCustomStyleLayer(F)))return;ye=e.createStyleLayer(F)}else{if("object"==typeof F.source&&(this.addSource(ue,F.source),F=e.clone$1(F),F=e.extend(F,{source:ue})),this._validate(e.validateStyle.layer,"layers."+ue,F,{arrayIndex:-1},re))return;ye=e.createStyleLayer(F),this._validateLayer(ye),ye.setEventedParent(this,{layer:{id:ue}}),this._serializedLayers[ye.id]=ye.serialize()}var ke=H?this._order.indexOf(H):this._order.length;if(H&&-1===ke)this.fire(new e.ErrorEvent(new Error('Layer with id "'+H+'" does not exist on this map.')));else{if(this._order.splice(ke,0,ue),this._layerOrderChanged=!0,this._layers[ue]=ye,this._removedLayers[ue]&&ye.source&&"custom"!==ye.type){var Ee=this._removedLayers[ue];delete this._removedLayers[ue],Ee.type!==ye.type?this._updatedSources[ye.source]="clear":(this._updatedSources[ye.source]="reload",this.sourceCaches[ye.source].pause())}this._updateLayer(ye),ye.onAdd&&ye.onAdd(this.map)}}},I.prototype.moveLayer=function(F,H){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==H){var re=this._order.indexOf(F);this._order.splice(re,1);var ue=H?this._order.indexOf(H):this._order.length;H&&-1===ue?this.fire(new e.ErrorEvent(new Error('Layer with id "'+H+'" does not exist on this map.'))):(this._order.splice(ue,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},I.prototype.removeLayer=function(F){this._checkLoaded();var H=this._layers[F];if(H){H.setEventedParent(null);var re=this._order.indexOf(F);this._order.splice(re,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=H,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],H.onRemove&&H.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},I.prototype.getLayer=function(F){return this._layers[F]},I.prototype.hasLayer=function(F){return F in this._layers},I.prototype.setLayerZoomRange=function(F,H,re){this._checkLoaded();var ue=this.getLayer(F);ue?ue.minzoom===H&&ue.maxzoom===re||(null!=H&&(ue.minzoom=H),null!=re&&(ue.maxzoom=re),this._updateLayer(ue)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},I.prototype.setFilter=function(F,H,re){void 0===re&&(re={}),this._checkLoaded();var ue=this.getLayer(F);if(ue){if(!e.deepEqual(ue.filter,H))return null==H?(ue.filter=void 0,void this._updateLayer(ue)):void(this._validate(e.validateStyle.filter,"layers."+ue.id+".filter",H,null,re)||(ue.filter=e.clone$1(H),this._updateLayer(ue)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},I.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},I.prototype.setLayoutProperty=function(F,H,re,ue){void 0===ue&&(ue={}),this._checkLoaded();var ye=this.getLayer(F);ye?e.deepEqual(ye.getLayoutProperty(H),re)||(ye.setLayoutProperty(H,re,ue),this._updateLayer(ye)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},I.prototype.getLayoutProperty=function(F,H){var re=this.getLayer(F);if(re)return re.getLayoutProperty(H);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},I.prototype.setPaintProperty=function(F,H,re,ue){void 0===ue&&(ue={}),this._checkLoaded();var ye=this.getLayer(F);ye?e.deepEqual(ye.getPaintProperty(H),re)||(ye.setPaintProperty(H,re,ue)&&this._updateLayer(ye),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},I.prototype.getPaintProperty=function(F,H){return this.getLayer(F).getPaintProperty(H)},I.prototype.setFeatureState=function(F,H){this._checkLoaded();var re=F.source,ue=F.sourceLayer,ye=this.sourceCaches[re];if(void 0!==ye){var ke=ye.getSource().type;"geojson"===ke&&ue?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==ke||ue?(void 0===F.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),ye.setFeatureState(ue,F.id,H)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+re+"' does not exist in the map's style.")))},I.prototype.removeFeatureState=function(F,H){this._checkLoaded();var re=F.source,ue=this.sourceCaches[re];if(void 0!==ue){var ye=ue.getSource().type,ke="vector"===ye?F.sourceLayer:void 0;"vector"!==ye||ke?H&&"string"!=typeof F.id&&"number"!=typeof F.id?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):ue.removeFeatureState(ke,F.id,H):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+re+"' does not exist in the map's style.")))},I.prototype.getFeatureState=function(F){this._checkLoaded();var H=F.source,re=F.sourceLayer,ue=this.sourceCaches[H];if(void 0!==ue){if("vector"!==ue.getSource().type||re)return void 0===F.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),ue.getFeatureState(re,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+H+"' does not exist in the map's style.")))},I.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},I.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return void 0!==F})},I.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&"raster"!==this.sourceCaches[F.source].getSource().type&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},I.prototype._flattenAndSortRenderedFeatures=function(F){for(var H=this,re=function(_r){return"fill-extrusion"===H._layers[_r].type},ue={},ye=[],ke=this._order.length-1;ke>=0;ke--){var Ee=this._order[ke];if(re(Ee)){ue[Ee]=ke;for(var Ue=0,$e=F;Ue<$e.length;Ue+=1){var it=$e[Ue][Ee];if(it)for(var _t=0,Ct=it;_t<Ct.length;_t+=1)ye.push(Ct[_t])}}}ye.sort(function(_r,pr){return pr.intersectionZ-_r.intersectionZ});for(var Et=[],Tt=this._order.length-1;Tt>=0;Tt--){var jt=this._order[Tt];if(re(jt))for(var Nt=ye.length-1;Nt>=0;Nt--){var Yt=ye[Nt].feature;if(ue[Yt.layer.id]<Tt)break;Et.push(Yt),ye.pop()}else for(var ln=0,bn=F;ln<bn.length;ln+=1){var In=bn[ln][jt];if(In)for(var En=0,ir=In;En<ir.length;En+=1)Et.push(ir[En].feature)}}return Et},I.prototype.queryRenderedFeatures=function(F,H,re){H&&H.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",H.filter,null,H);var ue={};if(H&&H.layers){if(!Array.isArray(H.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var ye=0,ke=H.layers;ye<ke.length;ye+=1){var Ee=ke[ye],Ue=this._layers[Ee];if(!Ue)return this.fire(new e.ErrorEvent(new Error("The layer '"+Ee+"' does not exist in the map's style and cannot be queried for features."))),[];ue[Ue.source]=!0}}var $e=[];for(var it in H.availableImages=this._availableImages,this.sourceCaches)H.layers&&!ue[it]||$e.push(U(this.sourceCaches[it],this._layers,this._serializedLayers,F,H,re));return this.placement&&$e.push(function(_t,Ct,At,Et,Tt,jt,Nt){for(var Yt={},ln=jt.queryRenderedSymbols(Et),bn=[],In=0,En=Object.keys(ln).map(Number);In<En.length;In+=1)bn.push(Nt[En[In]]);bn.sort(ee);for(var rr=function(){var xi=pr[_r],Wn=xi.featureIndex.lookupSymbolFeatures(ln[xi.bucketInstanceId],Ct,xi.bucketIndex,xi.sourceLayerIndex,Tt.filter,Tt.layers,Tt.availableImages,_t);for(var Rr in Wn){var oi=Yt[Rr]=Yt[Rr]||[],ti=Wn[Rr];ti.sort(function(ui,Oi){var zi=xi.featureSortOrder;if(zi){var qi=zi.indexOf(ui.featureIndex);return zi.indexOf(Oi.featureIndex)-qi}return Oi.featureIndex-ui.featureIndex});for(var vi=0,ki=ti;vi<ki.length;vi+=1)oi.push(ki[vi])}},_r=0,pr=bn;_r<pr.length;_r+=1)rr();var Qr=function(xi){Yt[xi].forEach(function(Wn){var Rr=Wn.feature,ti=At[_t[xi].source].getFeatureState(Rr.layer["source-layer"],Rr.id);Rr.source=Rr.layer.source,Rr.layer["source-layer"]&&(Rr.sourceLayer=Rr.layer["source-layer"]),Rr.state=ti})};for(var li in Yt)Qr(li);return Yt}(this._layers,this._serializedLayers,this.sourceCaches,F,H,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($e)},I.prototype.querySourceFeatures=function(F,H){H&&H.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",H.filter,null,H);var re=this.sourceCaches[F];return re?function(ue,ye){for(var ke=ue.getRenderableIds().map(function(Ct){return ue.getTileByID(Ct)}),Ee=[],Ue={},$e=0;$e<ke.length;$e++){var it=ke[$e],_t=it.tileID.canonical.key;Ue[_t]||(Ue[_t]=!0,it.querySourceFeatures(Ee,ye))}return Ee}(re,H):[]},I.prototype.addSourceType=function(F,H,re){return I.getSourceType(F)?re(new Error('A source type called "'+F+'" already exists.')):(I.setSourceType(F,H),H.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:H.workerSourceURL},re):re(null,null))},I.prototype.getLight=function(){return this.light.getLight()},I.prototype.setLight=function(F,H){void 0===H&&(H={}),this._checkLoaded();var re=this.light.getLight(),ue=!1;for(var ye in F)if(!e.deepEqual(F[ye],re[ye])){ue=!0;break}if(ue){var ke={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,H),this.light.updateTransitions(ke)}},I.prototype._validate=function(F,H,re,ue,ye){return void 0===ye&&(ye={}),(!ye||!1!==ye.validate)&&lr(this,F.call(e.validateStyle,e.extend({key:H,style:this.serialize(),value:re,styleSpec:e.styleSpec},ue)))},I.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var H in this.sourceCaches)this.sourceCaches[H].clearTiles(),this.sourceCaches[H].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},I.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},I.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},I.prototype._updateSources=function(F){for(var H in this.sourceCaches)this.sourceCaches[H].update(F)},I.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},I.prototype._updatePlacement=function(F,H,re,ue,ye){void 0===ye&&(ye=!1);for(var ke=!1,Ee=!1,Ue={},$e=0,it=this._order;$e<it.length;$e+=1){var Ct=this._layers[it[$e]];if("symbol"===Ct.type){if(!Ue[Ct.source]){var At=this.sourceCaches[Ct.source];Ue[Ct.source]=At.getRenderableIds(!0).map(function(ln){return At.getTileByID(ln)}).sort(function(ln,bn){return bn.tileID.overscaledZ-ln.tileID.overscaledZ||(ln.tileID.isLessThan(bn.tileID)?-1:1)})}var Et=this.crossTileSymbolIndex.addLayer(Ct,Ue[Ct.source],F.center.lng);ke=ke||Et}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((ye=ye||this._layerOrderChanged||0===re)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new kn(F,this._order,ye,H,re,ue,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ue),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Ee=!0),ke&&this.pauseablePlacement.placement.setStale()),Ee||ke)for(var Tt=0,jt=this._order;Tt<jt.length;Tt+=1){var Yt=this._layers[jt[Tt]];"symbol"===Yt.type&&this.placement.updateLayerOpacities(Yt,Ue[Yt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},I.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},I.prototype.getImages=function(F,H,re){this.imageManager.getImages(H.icons,re),this._updateTilesForChangedImages();var ue=this.sourceCaches[H.source];ue&&ue.setDependencies(H.tileID.key,H.type,H.icons)},I.prototype.getGlyphs=function(F,H,re){this.glyphManager.getGlyphs(H.stacks,re)},I.prototype.getResource=function(F,H,re){return e.makeRequest(H,re)},I}(e.Evented);Pr.getSourceType=function(E){return V[E]},Pr.setSourceType=function(E,I){V[E]=I},Pr.registerForPluginStateChange=e.registerForPluginStateChange;var Ur=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Yr=ta("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),si=ta("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Fi=ta("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ri=ta("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Fr=ta("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),fi=ta("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),ci=ta("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Yi=ta("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ta=ta("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ba=ta("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),go=ta("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),ra=ta("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ia=ta("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),so=ta("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Zi=ta("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Ra=ta("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Fa=ta("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),_a=ta("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Xa=ta("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),no=ta("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),_o=ta("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Wa=ta("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),xa=ta("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ro=ta("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),ds=ta("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),bs=ta("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function ta(E,I){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,H={};return{fragmentSource:E=E.replace(F,function(re,ue,ye,ke,Ee){return H[Ee]=!0,"define"===ue?"\n#ifndef HAS_UNIFORM_u_"+Ee+"\nvarying "+ye+" "+ke+" "+Ee+";\n#else\nuniform "+ye+" "+ke+" u_"+Ee+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+Ee+"\n    "+ye+" "+ke+" "+Ee+" = u_"+Ee+";\n#endif\n"}),vertexSource:I=I.replace(F,function(re,ue,ye,ke,Ee){var Ue="float"===ke?"vec2":"vec4",$e=Ee.match(/color/)?"color":Ue;return H[Ee]?"define"===ue?"\n#ifndef HAS_UNIFORM_u_"+Ee+"\nuniform lowp float u_"+Ee+"_t;\nattribute "+ye+" "+Ue+" a_"+Ee+";\nvarying "+ye+" "+ke+" "+Ee+";\n#else\nuniform "+ye+" "+ke+" u_"+Ee+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+Ee+"\n    "+Ee+" = a_"+Ee+";\n#else\n    "+ye+" "+ke+" "+Ee+" = u_"+Ee+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Ee+"\n    "+Ee+" = unpack_mix_"+$e+"(a_"+Ee+", u_"+Ee+"_t);\n#else\n    "+ye+" "+ke+" "+Ee+" = u_"+Ee+";\n#endif\n":"define"===ue?"\n#ifndef HAS_UNIFORM_u_"+Ee+"\nuniform lowp float u_"+Ee+"_t;\nattribute "+ye+" "+Ue+" a_"+Ee+";\n#else\nuniform "+ye+" "+ke+" u_"+Ee+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+Ee+"\n    "+ye+" "+ke+" "+Ee+" = a_"+Ee+";\n#else\n    "+ye+" "+ke+" "+Ee+" = u_"+Ee+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Ee+"\n    "+ye+" "+ke+" "+Ee+" = unpack_mix_"+$e+"(a_"+Ee+", u_"+Ee+"_t);\n#else\n    "+ye+" "+ke+" "+Ee+" = u_"+Ee+";\n#endif\n"})}}var ls=Object.freeze({__proto__:null,prelude:Yr,background:si,backgroundPattern:Fi,circle:Ri,clippingMask:Fr,heatmap:fi,heatmapTexture:ci,collisionBox:Yi,collisionCircle:Ta,debug:Ba,fill:go,fillOutline:ra,fillOutlinePattern:ia,fillPattern:so,fillExtrusion:Zi,fillExtrusionPattern:Ra,hillshadePrepare:Fa,hillshade:_a,line:Xa,lineGradient:no,linePattern:_o,lineSDF:Wa,raster:xa,symbolIcon:ro,symbolSDF:ds,symbolTextAndIcon:bs}),ts=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ts.prototype.bind=function(E,I,F,H,re,ue,ye,ke){this.context=E;for(var Ee=this.boundPaintVertexBuffers.length!==H.length,Ue=0;!Ee&&Ue<H.length;Ue++)this.boundPaintVertexBuffers[Ue]!==H[Ue]&&(Ee=!0);E.extVertexArrayObject&&this.vao&&this.boundProgram===I&&this.boundLayoutVertexBuffer===F&&!Ee&&this.boundIndexBuffer===re&&this.boundVertexOffset===ue&&this.boundDynamicVertexBuffer===ye&&this.boundDynamicVertexBuffer2===ke?(E.bindVertexArrayOES.set(this.vao),ye&&ye.bind(),re&&re.dynamicDraw&&re.bind(),ke&&ke.bind()):this.freshBind(I,F,H,re,ue,ye,ke)},ts.prototype.freshBind=function(E,I,F,H,re,ue,ye){var ke,Ee=E.numAttributes,Ue=this.context,$e=Ue.gl;if(Ue.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ue.extVertexArrayObject.createVertexArrayOES(),Ue.bindVertexArrayOES.set(this.vao),ke=0,this.boundProgram=E,this.boundLayoutVertexBuffer=I,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=H,this.boundVertexOffset=re,this.boundDynamicVertexBuffer=ue,this.boundDynamicVertexBuffer2=ye;else{ke=Ue.currentNumAttributes||0;for(var it=Ee;it<ke;it++)$e.disableVertexAttribArray(it)}I.enableAttributes($e,E);for(var _t=0,Ct=F;_t<Ct.length;_t+=1)Ct[_t].enableAttributes($e,E);ue&&ue.enableAttributes($e,E),ye&&ye.enableAttributes($e,E),I.bind(),I.setVertexAttribPointers($e,E,re);for(var At=0,Et=F;At<Et.length;At+=1){var Tt=Et[At];Tt.bind(),Tt.setVertexAttribPointers($e,E,re)}ue&&(ue.bind(),ue.setVertexAttribPointers($e,E,re)),H&&H.bind(),ye&&(ye.bind(),ye.setVertexAttribPointers($e,E,re)),Ue.currentNumAttributes=Ee},ts.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var As=function(E,I,F,H,re){var ue=E.gl;this.program=ue.createProgram();var ye=F?F.defines():[];re&&ye.push("#define OVERDRAW_INSPECTOR;");var ke=ye.concat(Yr.fragmentSource,I.fragmentSource).join("\n"),Ee=ye.concat(Yr.vertexSource,I.vertexSource).join("\n"),Ue=ue.createShader(ue.FRAGMENT_SHADER);if(ue.isContextLost())this.failedToCreate=!0;else{ue.shaderSource(Ue,ke),ue.compileShader(Ue),ue.attachShader(this.program,Ue);var $e=ue.createShader(ue.VERTEX_SHADER);if(ue.isContextLost())this.failedToCreate=!0;else{ue.shaderSource($e,Ee),ue.compileShader($e),ue.attachShader(this.program,$e);for(var it=F?F.layoutAttributes:[],_t=0;_t<it.length;_t++)ue.bindAttribLocation(this.program,_t,it[_t].name);ue.linkProgram(this.program),ue.deleteShader($e),ue.deleteShader(Ue),this.numAttributes=ue.getProgramParameter(this.program,ue.ACTIVE_ATTRIBUTES),this.attributes={};for(var Ct={},At=0;At<this.numAttributes;At++){var Et=ue.getActiveAttrib(this.program,At);Et&&(this.attributes[Et.name]=ue.getAttribLocation(this.program,Et.name))}for(var Tt=ue.getProgramParameter(this.program,ue.ACTIVE_UNIFORMS),jt=0;jt<Tt;jt++){var Nt=ue.getActiveUniform(this.program,jt);Nt&&(Ct[Nt.name]=ue.getUniformLocation(this.program,Nt.name))}this.fixedUniforms=H(E,Ct),this.binderUniforms=F?F.getUniforms(E,Ct):[]}}};function Ms(E,I,F){var H=1/Sr(F,1,I.transform.tileZoom),re=Math.pow(2,F.tileID.overscaledZ),ue=F.tileSize*Math.pow(2,I.transform.tileZoom)/re,ye=ue*(F.tileID.canonical.x+F.tileID.wrap*re),ke=ue*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[H,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[ye>>16,ke>>16],u_pixel_coord_lower:[65535&ye,65535&ke]}}As.prototype.draw=function(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e,it,_t,Ct,At,Et){var Tt,jt=E.gl;if(!this.failedToCreate){for(var Nt in E.program.set(this.program),E.setDepthMode(F),E.setStencilMode(H),E.setColorMode(re),E.setCullFace(ue),this.fixedUniforms)this.fixedUniforms[Nt].set(ye[Nt]);Ct&&Ct.setUniforms(E,this.binderUniforms,it,{zoom:_t});for(var Yt=(Tt={},Tt[jt.LINES]=2,Tt[jt.TRIANGLES]=3,Tt[jt.LINE_STRIP]=1,Tt)[I],ln=0,bn=$e.get();ln<bn.length;ln+=1){var In=bn[ln],En=In.vaos||(In.vaos={});(En[ke]||(En[ke]=new ts)).bind(E,this,Ee,Ct?Ct.getPaintVertexBuffers():[],Ue,In.vertexOffset,At,Et),jt.drawElements(I,In.primitiveLength*Yt,jt.UNSIGNED_SHORT,In.primitiveOffset*Yt*2)}}};var _s=function(E,I,F,H){var re=I.style.light,ue=re.properties.get("position"),ye=[ue.x,ue.y,ue.z],ke=e.create$1();"viewport"===re.properties.get("anchor")&&e.fromRotation(ke,-I.transform.angle),e.transformMat3(ye,ye,ke);var Ee=re.properties.get("color");return{u_matrix:E,u_lightpos:ye,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+F,u_opacity:H}},Ss=function(E,I,F,H,re,ue,ye){return e.extend(_s(E,I,F,H),Ms(ue,I,ye),{u_height_factor:-Math.pow(2,re.overscaledZ)/ye.tileSize/8})},vo=function(E){return{u_matrix:E}},Lo=function(E,I,F,H){return e.extend(vo(E),Ms(F,I,H))},Bo=function(E,I){return{u_matrix:E,u_world:I}},qo=function(E,I,F,H,re){return e.extend(Lo(E,I,F,H),{u_world:re})},Ho=function(E,I,F,H){var re,ue,ye=E.transform;if("map"===H.paint.get("circle-pitch-alignment")){var ke=Sr(F,1,ye.zoom);re=!0,ue=[ke,ke]}else re=!1,ue=ye.pixelsToGLUnits;return{u_camera_to_center_distance:ye.cameraToCenterDistance,u_scale_with_map:+("map"===H.paint.get("circle-pitch-scale")),u_matrix:E.translatePosMatrix(I.posMatrix,F,H.paint.get("circle-translate"),H.paint.get("circle-translate-anchor")),u_pitch_with_map:+re,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:ue}},ns=function(E,I,F){var H=Sr(F,1,I.zoom),re=Math.pow(2,I.zoom-F.tileID.overscaledZ),ue=F.tileID.overscaleFactor();return{u_matrix:E,u_camera_to_center_distance:I.cameraToCenterDistance,u_pixels_to_tile_units:H,u_extrude_scale:[I.pixelsToGLUnits[0]/(H*re),I.pixelsToGLUnits[1]/(H*re)],u_overscale_factor:ue}},wo=function(E,I,F){return{u_matrix:E,u_inv_matrix:I,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},ws=function(E,I,F){return void 0===F&&(F=1),{u_matrix:E,u_color:I,u_overlay:0,u_overlay_scale:F}},yo=function(E){return{u_matrix:E}},Yo=function(E,I,F,H){return{u_matrix:E,u_extrude_scale:Sr(I,1,F),u_intensity:H}};function ms(E,I){var F=Math.pow(2,I.canonical.z),H=I.canonical.y;return[new e.MercatorCoordinate(0,H/F).toLngLat().lat,new e.MercatorCoordinate(0,(H+1)/F).toLngLat().lat]}var zo=function(E,I,F){var H=E.transform;return{u_matrix:ft(E,I,F),u_ratio:1/Sr(I,1,H.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/H.pixelsToGLUnits[0],1/H.pixelsToGLUnits[1]]}},Gi=function(E,I,F){return e.extend(zo(E,I,F),{u_image:0})},qe=function(E,I,F,H){var re=E.transform,ue=rt(I,re);return{u_matrix:ft(E,I,F),u_texsize:I.imageAtlasTexture.size,u_ratio:1/Sr(I,1,re.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[ue,H.fromScale,H.toScale],u_fade:H.t,u_units_to_pixels:[1/re.pixelsToGLUnits[0],1/re.pixelsToGLUnits[1]]}},We=function(E,I,F,H,re){var ye=E.lineAtlas,ke=rt(I,E.transform),Ee="round"===F.layout.get("line-cap"),Ue=ye.getDash(H.from,Ee),$e=ye.getDash(H.to,Ee),it=Ue.width*re.fromScale,_t=$e.width*re.toScale;return e.extend(zo(E,I,F),{u_patternscale_a:[ke/it,-Ue.height/2],u_patternscale_b:[ke/_t,-$e.height/2],u_sdfgamma:ye.width/(256*Math.min(it,_t)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ue.y,u_tex_y_b:$e.y,u_mix:re.t})};function rt(E,I){return 1/Sr(E,1,I.tileZoom)}function ft(E,I,F){return E.translatePosMatrix(I.tileID.posMatrix,I,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var bt=function(E,I,F,H,re){return{u_matrix:E,u_tl_parent:I,u_scale_parent:F,u_buffer_scale:1,u_fade_t:H.mix,u_opacity:H.opacity*re.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:re.paint.get("raster-brightness-min"),u_brightness_high:re.paint.get("raster-brightness-max"),u_saturation_factor:(ye=re.paint.get("raster-saturation"),ye>0?1-1/(1.001-ye):-ye),u_contrast_factor:(ue=re.paint.get("raster-contrast"),ue>0?1/(1-ue):1+ue),u_spin_weights:vt(re.paint.get("raster-hue-rotate"))};var ue,ye};function vt(E){E*=Math.PI/180;var I=Math.sin(E),F=Math.cos(E);return[(2*F+1)/3,(-Math.sqrt(3)*I-F+1)/3,(Math.sqrt(3)*I-F+1)/3]}var Pt,tn=function(E,I,F,H,re,ue,ye,ke,Ee,Ue){var $e=re.transform;return{u_is_size_zoom_constant:+("constant"===E||"source"===E),u_is_size_feature_constant:+("constant"===E||"camera"===E),u_size_t:I?I.uSizeT:0,u_size:I?I.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_pitch:$e.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:$e.width/$e.height,u_fade_change:re.options.fadeDuration?re.symbolFadeChange:1,u_matrix:ue,u_label_plane_matrix:ye,u_coord_matrix:ke,u_is_text:+Ee,u_pitch_with_map:+H,u_texsize:Ue,u_texture:0}},rn=function(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e){var it=re.transform;return e.extend(tn(E,I,F,H,re,ue,ye,ke,Ee,Ue),{u_gamma_scale:H?Math.cos(it._pitch)*it.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+$e})},Qt=function(E,I,F,H,re,ue,ye,ke,Ee,Ue){return e.extend(rn(E,I,F,H,re,ue,ye,ke,!0,Ee,!0),{u_texsize_icon:Ue,u_texture_icon:1})},un=function(E,I,F){return{u_matrix:E,u_opacity:I,u_color:F}},xn=function(E,I,F,H,re,ue){return e.extend((ke=ue,Ue=re,$e=(Ee=F).imageManager.getPattern((ye=H).from.toString()),it=Ee.imageManager.getPattern(ye.to.toString()),Ct=(_t=Ee.imageManager.getPixelSize()).width,At=_t.height,Et=Math.pow(2,Ue.tileID.overscaledZ),jt=(Tt=Ue.tileSize*Math.pow(2,Ee.transform.tileZoom)/Et)*(Ue.tileID.canonical.x+Ue.tileID.wrap*Et),Nt=Tt*Ue.tileID.canonical.y,{u_image:0,u_pattern_tl_a:$e.tl,u_pattern_br_a:$e.br,u_pattern_tl_b:it.tl,u_pattern_br_b:it.br,u_texsize:[Ct,At],u_mix:ke.t,u_pattern_size_a:$e.displaySize,u_pattern_size_b:it.displaySize,u_scale_a:ke.fromScale,u_scale_b:ke.toScale,u_tile_units_to_pixels:1/Sr(Ue,1,Ee.transform.tileZoom),u_pixel_coord_upper:[jt>>16,Nt>>16],u_pixel_coord_lower:[65535&jt,65535&Nt]}),{u_matrix:E,u_opacity:I});var ye,ke,Ee,Ue,$e,it,_t,Ct,At,Et,Tt,jt,Nt},Sn={fillExtrusion:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_lightpos:new e.Uniform3f(E,I.u_lightpos),u_lightintensity:new e.Uniform1f(E,I.u_lightintensity),u_lightcolor:new e.Uniform3f(E,I.u_lightcolor),u_vertical_gradient:new e.Uniform1f(E,I.u_vertical_gradient),u_opacity:new e.Uniform1f(E,I.u_opacity)}},fillExtrusionPattern:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_lightpos:new e.Uniform3f(E,I.u_lightpos),u_lightintensity:new e.Uniform1f(E,I.u_lightintensity),u_lightcolor:new e.Uniform3f(E,I.u_lightcolor),u_vertical_gradient:new e.Uniform1f(E,I.u_vertical_gradient),u_height_factor:new e.Uniform1f(E,I.u_height_factor),u_image:new e.Uniform1i(E,I.u_image),u_texsize:new e.Uniform2f(E,I.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,I.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,I.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,I.u_scale),u_fade:new e.Uniform1f(E,I.u_fade),u_opacity:new e.Uniform1f(E,I.u_opacity)}},fill:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix)}},fillPattern:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_image:new e.Uniform1i(E,I.u_image),u_texsize:new e.Uniform2f(E,I.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,I.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,I.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,I.u_scale),u_fade:new e.Uniform1f(E,I.u_fade)}},fillOutline:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_world:new e.Uniform2f(E,I.u_world)}},fillOutlinePattern:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_world:new e.Uniform2f(E,I.u_world),u_image:new e.Uniform1i(E,I.u_image),u_texsize:new e.Uniform2f(E,I.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,I.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,I.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,I.u_scale),u_fade:new e.Uniform1f(E,I.u_fade)}},circle:function(E,I){return{u_camera_to_center_distance:new e.Uniform1f(E,I.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(E,I.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(E,I.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(E,I.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(E,I.u_matrix)}},collisionBox:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_camera_to_center_distance:new e.Uniform1f(E,I.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(E,I.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(E,I.u_extrude_scale),u_overscale_factor:new e.Uniform1f(E,I.u_overscale_factor)}},collisionCircle:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_inv_matrix:new e.UniformMatrix4f(E,I.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(E,I.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(E,I.u_viewport_size)}},debug:function(E,I){return{u_color:new e.UniformColor(E,I.u_color),u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_overlay:new e.Uniform1i(E,I.u_overlay),u_overlay_scale:new e.Uniform1f(E,I.u_overlay_scale)}},clippingMask:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix)}},heatmap:function(E,I){return{u_extrude_scale:new e.Uniform1f(E,I.u_extrude_scale),u_intensity:new e.Uniform1f(E,I.u_intensity),u_matrix:new e.UniformMatrix4f(E,I.u_matrix)}},heatmapTexture:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_world:new e.Uniform2f(E,I.u_world),u_image:new e.Uniform1i(E,I.u_image),u_color_ramp:new e.Uniform1i(E,I.u_color_ramp),u_opacity:new e.Uniform1f(E,I.u_opacity)}},hillshade:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_image:new e.Uniform1i(E,I.u_image),u_latrange:new e.Uniform2f(E,I.u_latrange),u_light:new e.Uniform2f(E,I.u_light),u_shadow:new e.UniformColor(E,I.u_shadow),u_highlight:new e.UniformColor(E,I.u_highlight),u_accent:new e.UniformColor(E,I.u_accent)}},hillshadePrepare:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_image:new e.Uniform1i(E,I.u_image),u_dimension:new e.Uniform2f(E,I.u_dimension),u_zoom:new e.Uniform1f(E,I.u_zoom),u_maxzoom:new e.Uniform1f(E,I.u_maxzoom),u_unpack:new e.Uniform4f(E,I.u_unpack)}},line:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_ratio:new e.Uniform1f(E,I.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,I.u_units_to_pixels)}},lineGradient:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_ratio:new e.Uniform1f(E,I.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,I.u_units_to_pixels),u_image:new e.Uniform1i(E,I.u_image)}},linePattern:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_texsize:new e.Uniform2f(E,I.u_texsize),u_ratio:new e.Uniform1f(E,I.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_image:new e.Uniform1i(E,I.u_image),u_units_to_pixels:new e.Uniform2f(E,I.u_units_to_pixels),u_scale:new e.Uniform3f(E,I.u_scale),u_fade:new e.Uniform1f(E,I.u_fade)}},lineSDF:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_ratio:new e.Uniform1f(E,I.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,I.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(E,I.u_patternscale_a),u_patternscale_b:new e.Uniform2f(E,I.u_patternscale_b),u_sdfgamma:new e.Uniform1f(E,I.u_sdfgamma),u_image:new e.Uniform1i(E,I.u_image),u_tex_y_a:new e.Uniform1f(E,I.u_tex_y_a),u_tex_y_b:new e.Uniform1f(E,I.u_tex_y_b),u_mix:new e.Uniform1f(E,I.u_mix)}},raster:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_tl_parent:new e.Uniform2f(E,I.u_tl_parent),u_scale_parent:new e.Uniform1f(E,I.u_scale_parent),u_buffer_scale:new e.Uniform1f(E,I.u_buffer_scale),u_fade_t:new e.Uniform1f(E,I.u_fade_t),u_opacity:new e.Uniform1f(E,I.u_opacity),u_image0:new e.Uniform1i(E,I.u_image0),u_image1:new e.Uniform1i(E,I.u_image1),u_brightness_low:new e.Uniform1f(E,I.u_brightness_low),u_brightness_high:new e.Uniform1f(E,I.u_brightness_high),u_saturation_factor:new e.Uniform1f(E,I.u_saturation_factor),u_contrast_factor:new e.Uniform1f(E,I.u_contrast_factor),u_spin_weights:new e.Uniform3f(E,I.u_spin_weights)}},symbolIcon:function(E,I){return{u_is_size_zoom_constant:new e.Uniform1i(E,I.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,I.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,I.u_size_t),u_size:new e.Uniform1f(E,I.u_size),u_camera_to_center_distance:new e.Uniform1f(E,I.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,I.u_pitch),u_rotate_symbol:new e.Uniform1i(E,I.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,I.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,I.u_fade_change),u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,I.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,I.u_coord_matrix),u_is_text:new e.Uniform1i(E,I.u_is_text),u_pitch_with_map:new e.Uniform1i(E,I.u_pitch_with_map),u_texsize:new e.Uniform2f(E,I.u_texsize),u_texture:new e.Uniform1i(E,I.u_texture)}},symbolSDF:function(E,I){return{u_is_size_zoom_constant:new e.Uniform1i(E,I.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,I.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,I.u_size_t),u_size:new e.Uniform1f(E,I.u_size),u_camera_to_center_distance:new e.Uniform1f(E,I.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,I.u_pitch),u_rotate_symbol:new e.Uniform1i(E,I.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,I.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,I.u_fade_change),u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,I.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,I.u_coord_matrix),u_is_text:new e.Uniform1i(E,I.u_is_text),u_pitch_with_map:new e.Uniform1i(E,I.u_pitch_with_map),u_texsize:new e.Uniform2f(E,I.u_texsize),u_texture:new e.Uniform1i(E,I.u_texture),u_gamma_scale:new e.Uniform1f(E,I.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(E,I.u_is_halo)}},symbolTextAndIcon:function(E,I){return{u_is_size_zoom_constant:new e.Uniform1i(E,I.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,I.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,I.u_size_t),u_size:new e.Uniform1f(E,I.u_size),u_camera_to_center_distance:new e.Uniform1f(E,I.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,I.u_pitch),u_rotate_symbol:new e.Uniform1i(E,I.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,I.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,I.u_fade_change),u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,I.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,I.u_coord_matrix),u_is_text:new e.Uniform1i(E,I.u_is_text),u_pitch_with_map:new e.Uniform1i(E,I.u_pitch_with_map),u_texsize:new e.Uniform2f(E,I.u_texsize),u_texsize_icon:new e.Uniform2f(E,I.u_texsize_icon),u_texture:new e.Uniform1i(E,I.u_texture),u_texture_icon:new e.Uniform1i(E,I.u_texture_icon),u_gamma_scale:new e.Uniform1f(E,I.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(E,I.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(E,I.u_is_halo)}},background:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_opacity:new e.Uniform1f(E,I.u_opacity),u_color:new e.UniformColor(E,I.u_color)}},backgroundPattern:function(E,I){return{u_matrix:new e.UniformMatrix4f(E,I.u_matrix),u_opacity:new e.Uniform1f(E,I.u_opacity),u_image:new e.Uniform1i(E,I.u_image),u_pattern_tl_a:new e.Uniform2f(E,I.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(E,I.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(E,I.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(E,I.u_pattern_br_b),u_texsize:new e.Uniform2f(E,I.u_texsize),u_mix:new e.Uniform1f(E,I.u_mix),u_pattern_size_a:new e.Uniform2f(E,I.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(E,I.u_pattern_size_b),u_scale_a:new e.Uniform1f(E,I.u_scale_a),u_scale_b:new e.Uniform1f(E,I.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(E,I.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,I.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(E,I.u_tile_units_to_pixels)}}};function Cn(E,I,F,H,re,ue,ye){for(var ke=E.context,Ee=ke.gl,Ue=E.useProgram("collisionBox"),$e=[],it=0,_t=0,Ct=0;Ct<H.length;Ct++){var At=H[Ct],Et=I.getTile(At),Tt=Et.getBucket(F);if(Tt){var jt=At.posMatrix;0===re[0]&&0===re[1]||(jt=E.translatePosMatrix(At.posMatrix,Et,re,ue));var Nt=ye?Tt.textCollisionBox:Tt.iconCollisionBox,Yt=Tt.collisionCircleArray;if(Yt.length>0){var ln=e.create(),bn=jt;e.mul(ln,Tt.placementInvProjMatrix,E.transform.glCoordMatrix),e.mul(ln,ln,Tt.placementViewportMatrix),$e.push({circleArray:Yt,circleOffset:_t,transform:bn,invTransform:ln}),_t=it+=Yt.length/4}Nt&&Ue.draw(ke,Ee.LINES,Rt.disabled,je.disabled,E.colorModeForRenderPass(),he.disabled,ns(jt,E.transform,Et),F.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nt.segments,null,E.transform.zoom,null,null,Nt.collisionVertexBuffer)}}if(ye&&$e.length){var In=E.useProgram("collisionCircle"),En=new e.StructArrayLayout2f1f2i16;En.resize(4*it),En._trim();for(var ir=0,rr=0,_r=$e;rr<_r.length;rr+=1)for(var pr=_r[rr],Qr=0;Qr<pr.circleArray.length/4;Qr++){var li=4*Qr,xi=pr.circleArray[li+0],Wn=pr.circleArray[li+1],Rr=pr.circleArray[li+2],oi=pr.circleArray[li+3];En.emplace(ir++,xi,Wn,Rr,oi,0),En.emplace(ir++,xi,Wn,Rr,oi,1),En.emplace(ir++,xi,Wn,Rr,oi,2),En.emplace(ir++,xi,Wn,Rr,oi,3)}(!Pt||Pt.length<2*it)&&(Pt=function(zi){var qi=2*zi,Ii=new e.StructArrayLayout3ui6;Ii.resize(qi),Ii._trim();for(var Hi=0;Hi<qi;Hi++){var na=6*Hi;Ii.uint16[na+0]=4*Hi+0,Ii.uint16[na+1]=4*Hi+1,Ii.uint16[na+2]=4*Hi+2,Ii.uint16[na+3]=4*Hi+2,Ii.uint16[na+4]=4*Hi+3,Ii.uint16[na+5]=4*Hi+0}return Ii}(it));for(var ti=ke.createIndexBuffer(Pt,!0),vi=ke.createVertexBuffer(En,e.collisionCircleLayout.members,!0),ki=0,ji=$e;ki<ji.length;ki+=1){var ui=ji[ki],Oi=wo(ui.transform,ui.invTransform,E.transform);In.draw(ke,Ee.TRIANGLES,Rt.disabled,je.disabled,E.colorModeForRenderPass(),he.disabled,Oi,F.id,vi,ti,e.SegmentVector.simpleSegment(0,2*ui.circleOffset,ui.circleArray.length,ui.circleArray.length/2),null,E.transform.zoom,null,null,null)}vi.destroy(),ti.destroy()}}var Vn=e.identity(new Float32Array(16));function mr(E,I,F,H,re,ue){var ye=e.getAnchorAlignment(E),ke=-(ye.horizontalAlign-.5)*I,Ee=-(ye.verticalAlign-.5)*F,Ue=e.evaluateVariableOffset(E,H);return new e.Point((ke/re+Ue[0])*ue,(Ee/re+Ue[1])*ue)}function wr(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e){var it=E.text.placedSymbolArray,_t=E.text.dynamicLayoutVertexArray,Ct=E.icon.dynamicLayoutVertexArray,At={};_t.clear();for(var Et=0;Et<it.length;Et++){var Tt=it.get(Et),Nt=Tt.hidden||!Tt.crossTileID||E.allowVerticalPlacement&&!Tt.placedOrientation?null:H[Tt.crossTileID];if(Nt){var Yt=new e.Point(Tt.anchorX,Tt.anchorY),ln=nn(Yt,F?ke:ye),bn=an(ue.cameraToCenterDistance,ln.signedDistanceFromCamera),In=re.evaluateSizeForFeature(E.textSizeData,Ue,Tt)*bn/e.ONE_EM;F&&(In*=E.tilePixelRatio/Ee);for(var rr=mr(Nt.anchor,Nt.width,Nt.height,Nt.textOffset,Nt.textBoxScale,In),_r=F?nn(Yt.add(rr),ye).point:ln.point.add(I?rr.rotate(-ue.angle):rr),pr=E.allowVerticalPlacement&&Tt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Qr=0;Qr<Tt.numGlyphs;Qr++)e.addDynamicAttributes(_t,_r,pr);$e&&Tt.associatedIconIndex>=0&&(At[Tt.associatedIconIndex]={shiftedAnchor:_r,angle:pr})}else fr(Tt.numGlyphs,_t)}if($e){Ct.clear();for(var li=E.icon.placedSymbolArray,xi=0;xi<li.length;xi++){var Wn=li.get(xi);if(Wn.hidden)fr(Wn.numGlyphs,Ct);else{var Rr=At[xi];if(Rr)for(var oi=0;oi<Wn.numGlyphs;oi++)e.addDynamicAttributes(Ct,Rr.shiftedAnchor,Rr.angle);else fr(Wn.numGlyphs,Ct)}}E.icon.dynamicLayoutVertexBuffer.updateData(Ct)}E.text.dynamicLayoutVertexBuffer.updateData(_t)}function qr(E,I,F){return F.iconsInText&&I?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function Gr(E,I,F,H,re,ue,ye,ke,Ee,Ue,$e,it){for(var _t=E.context,Ct=_t.gl,At=E.transform,Et="map"===ke,Tt="map"===Ee,jt=Et&&"point"!==F.layout.get("symbol-placement"),Nt=Et&&!Tt&&!jt,Yt=void 0!==F.layout.get("symbol-sort-key").constantOr(1),ln=E.depthModeForSublayer(0,Rt.ReadOnly),bn=F.layout.get("text-variable-anchor"),In=[],En=0,ir=H;En<ir.length;En+=1){var rr=ir[En],_r=I.getTile(rr),pr=_r.getBucket(F);if(pr){var Qr=re?pr.text:pr.icon;if(Qr&&Qr.segments.get().length){var li=Qr.programConfigurations.get(F.id),xi=re||pr.sdfIcons,Wn=re?pr.textSizeData:pr.iconSizeData,Rr=Tt||0!==At.pitch,oi=E.useProgram(qr(xi,re,pr),li),ti=e.evaluateSizeForZoom(Wn,At.zoom),vi=void 0,ki=[0,0],ji=void 0,ui=void 0,Oi=null,zi=void 0;if(re)ji=_r.glyphAtlasTexture,ui=Ct.LINEAR,vi=_r.glyphAtlasTexture.size,pr.iconsInText&&(ki=_r.imageAtlasTexture.size,Oi=_r.imageAtlasTexture,zi=Rr||E.options.rotating||E.options.zooming||"composite"===Wn.kind||"camera"===Wn.kind?Ct.LINEAR:Ct.NEAREST);else{var Ii=1!==F.layout.get("icon-size").constantOr(0)||pr.iconsNeedLinear;ji=_r.imageAtlasTexture,ui=xi||E.options.rotating||E.options.zooming||Ii||Rr?Ct.LINEAR:Ct.NEAREST,vi=_r.imageAtlasTexture.size}var Hi=Sr(_r,1,E.transform.zoom),na=zn(rr.posMatrix,Tt,Et,E.transform,Hi),Ca=gn(rr.posMatrix,Tt,Et,E.transform,Hi),Ka=bn&&pr.hasTextData(),$a="none"!==F.layout.get("icon-text-fit")&&Ka&&pr.hasIconData();jt&&mn(pr,rr.posMatrix,E,re,na,Ca,Tt,Ue);var Aa=E.translatePosMatrix(rr.posMatrix,_r,ue,ye),Va=jt||re&&bn||$a?Vn:na,Oa=E.translatePosMatrix(Ca,_r,ue,ye,!0),Io=xi&&0!==F.paint.get(re?"text-halo-width":"icon-halo-width").constantOr(1),po={program:oi,buffers:Qr,uniformValues:xi?pr.iconsInText?Qt(Wn.kind,ti,Nt,Tt,E,Aa,Va,Oa,vi,ki):rn(Wn.kind,ti,Nt,Tt,E,Aa,Va,Oa,re,vi,!0):tn(Wn.kind,ti,Nt,Tt,E,Aa,Va,Oa,re,vi),atlasTexture:ji,atlasTextureIcon:Oi,atlasInterpolation:ui,atlasInterpolationIcon:zi,isSDF:xi,hasHalo:Io};if(Yt)for(var Qo=0,Os=Qr.segments.get();Qo<Os.length;Qo+=1){var Us=Os[Qo];In.push({segments:new e.SegmentVector([Us]),sortKey:Us.sortKey,state:po})}else In.push({segments:Qr.segments,sortKey:0,state:po})}}}Yt&&In.sort(function(ll,vs){return ll.sortKey-vs.sortKey});for(var sl=0,$s=In;sl<$s.length;sl+=1){var el=$s[sl],Do=el.state;if(_t.activeTexture.set(Ct.TEXTURE0),Do.atlasTexture.bind(Do.atlasInterpolation,Ct.CLAMP_TO_EDGE),Do.atlasTextureIcon&&(_t.activeTexture.set(Ct.TEXTURE1),Do.atlasTextureIcon&&Do.atlasTextureIcon.bind(Do.atlasInterpolationIcon,Ct.CLAMP_TO_EDGE)),Do.isSDF){var Gs=Do.uniformValues;Do.hasHalo&&(Gs.u_is_halo=1,ni(Do.buffers,el.segments,F,E,Do.program,ln,$e,it,Gs)),Gs.u_is_halo=0}ni(Do.buffers,el.segments,F,E,Do.program,ln,$e,it,Do.uniformValues)}}function ni(E,I,F,H,re,ue,ye,ke,Ee){var Ue=H.context;re.draw(Ue,Ue.gl.TRIANGLES,ue,ye,ke,he.disabled,Ee,F.id,E.layoutVertexBuffer,E.indexBuffer,I,F.paint,H.transform.zoom,E.programConfigurations.get(F.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function Xr(E,I,F,H,re,ue,ye){var ke,Ee,Ue,$e,it,_t=E.context.gl,Ct=F.paint.get("fill-pattern"),At=Ct&&Ct.constantOr(1),Et=F.getCrossfadeParameters();ye?(Ee=At&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ke=_t.LINES):(Ee=At?"fillPattern":"fill",ke=_t.TRIANGLES);for(var Tt=0,jt=H;Tt<jt.length;Tt+=1){var Nt=jt[Tt],Yt=I.getTile(Nt);if(!At||Yt.patternsLoaded()){var ln=Yt.getBucket(F);if(ln){var bn=ln.programConfigurations.get(F.id),In=E.useProgram(Ee,bn);At&&(E.context.activeTexture.set(_t.TEXTURE0),Yt.imageAtlasTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE),bn.updatePaintBuffers(Et));var En=Ct.constantOr(null);if(En&&Yt.imageAtlas){var ir=Yt.imageAtlas,rr=ir.patternPositions[En.to.toString()],_r=ir.patternPositions[En.from.toString()];rr&&_r&&bn.setConstantPatternPositions(rr,_r)}var pr=E.translatePosMatrix(Nt.posMatrix,Yt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(ye){$e=ln.indexBuffer2,it=ln.segments2;var Qr=[_t.drawingBufferWidth,_t.drawingBufferHeight];Ue="fillOutlinePattern"===Ee&&At?qo(pr,E,Et,Yt,Qr):Bo(pr,Qr)}else $e=ln.indexBuffer,it=ln.segments,Ue=At?Lo(pr,E,Et,Yt):vo(pr);In.draw(E.context,ke,re,E.stencilModeForClipping(Nt),ue,he.disabled,Ue,F.id,ln.layoutVertexBuffer,$e,it,F.paint,E.transform.zoom,bn)}}}}function Si(E,I,F,H,re,ue,ye){for(var ke=E.context,Ee=ke.gl,Ue=F.paint.get("fill-extrusion-pattern"),$e=Ue.constantOr(1),it=F.getCrossfadeParameters(),_t=F.paint.get("fill-extrusion-opacity"),Ct=0,At=H;Ct<At.length;Ct+=1){var Et=At[Ct],Tt=I.getTile(Et),jt=Tt.getBucket(F);if(jt){var Nt=jt.programConfigurations.get(F.id),Yt=E.useProgram($e?"fillExtrusionPattern":"fillExtrusion",Nt);$e&&(E.context.activeTexture.set(Ee.TEXTURE0),Tt.imageAtlasTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE),Nt.updatePaintBuffers(it));var ln=Ue.constantOr(null);if(ln&&Tt.imageAtlas){var bn=Tt.imageAtlas,In=bn.patternPositions[ln.to.toString()],En=bn.patternPositions[ln.from.toString()];In&&En&&Nt.setConstantPatternPositions(In,En)}var ir=E.translatePosMatrix(Et.posMatrix,Tt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),rr=F.paint.get("fill-extrusion-vertical-gradient"),_r=$e?Ss(ir,E,rr,_t,Et,it,Tt):_s(ir,E,rr,_t);Yt.draw(ke,ke.gl.TRIANGLES,re,ue,ye,he.backCCW,_r,F.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,F.paint,E.transform.zoom,Nt)}}}function Ni(E,I,F,H,re,ue){var ye=E.context,ke=ye.gl,Ee=I.fbo;if(Ee){var Ue=E.useProgram("hillshade");ye.activeTexture.set(ke.TEXTURE0),ke.bindTexture(ke.TEXTURE_2D,Ee.colorAttachment.get());var $e=function(it,_t,Ct){var At=Ct.paint.get("hillshade-shadow-color"),Et=Ct.paint.get("hillshade-highlight-color"),Tt=Ct.paint.get("hillshade-accent-color"),jt=Ct.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ct.paint.get("hillshade-illumination-anchor")&&(jt-=it.transform.angle);var Nt=!it.options.moving;return{u_matrix:it.transform.calculatePosMatrix(_t.tileID.toUnwrapped(),Nt),u_image:0,u_latrange:ms(0,_t.tileID),u_light:[Ct.paint.get("hillshade-exaggeration"),jt],u_shadow:At,u_highlight:Et,u_accent:Tt}}(E,I,F);Ue.draw(ye,ke.TRIANGLES,H,re,ue,he.disabled,$e,F.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}}function $i(E,I,F,H,re,ue,ye){var Tt,jt,Nt,Yt,ln,ke=E.context,Ee=ke.gl,Ue=I.dem;if(Ue&&Ue.data){var $e=Ue.dim,it=Ue.stride,_t=Ue.getPixels();if(ke.activeTexture.set(Ee.TEXTURE1),ke.pixelStoreUnpackPremultiplyAlpha.set(!1),I.demTexture=I.demTexture||E.getTileTexture(it),I.demTexture){var Ct=I.demTexture;Ct.update(_t,{premultiply:!1}),Ct.bind(Ee.NEAREST,Ee.CLAMP_TO_EDGE)}else I.demTexture=new e.Texture(ke,_t,Ee.RGBA,{premultiply:!1}),I.demTexture.bind(Ee.NEAREST,Ee.CLAMP_TO_EDGE);ke.activeTexture.set(Ee.TEXTURE0);var At=I.fbo;if(!At){var Et=new e.Texture(ke,{width:$e,height:$e,data:null},Ee.RGBA);Et.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE),(At=I.fbo=ke.createFramebuffer($e,$e,!0)).colorAttachment.set(Et.texture)}ke.bindFramebuffer.set(At.framebuffer),ke.viewport.set([0,0,$e,$e]),E.useProgram("hillshadePrepare").draw(ke,Ee.TRIANGLES,re,ue,ye,he.disabled,(Tt=I.tileID,Nt=H,Yt=(jt=Ue).stride,ln=e.create(),e.ortho(ln,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(ln,ln,[0,-e.EXTENT,0]),{u_matrix:ln,u_image:1,u_dimension:[Yt,Yt],u_zoom:Tt.overscaledZ,u_maxzoom:Nt,u_unpack:jt.getUnpackVector()}),F.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments),I.needsHillshadePrepare=!1}}function Qi(E,I,F,H,re){var ue=H.paint.get("raster-fade-duration");if(ue>0){var ye=e.browser.now(),ke=(ye-E.timeAdded)/ue,Ee=I?(ye-I.timeAdded)/ue:-1,Ue=F.getSource(),$e=re.coveringZoomLevel({tileSize:Ue.tileSize,roundZoom:Ue.roundZoom}),it=!I||Math.abs(I.tileID.overscaledZ-$e)>Math.abs(E.tileID.overscaledZ-$e),_t=it&&E.refreshedUponExpiration?1:e.clamp(it?ke:1-Ee,0,1);return E.refreshedUponExpiration&&ke>=1&&(E.refreshedUponExpiration=!1),I?{opacity:1,mix:1-_t}:{opacity:_t,mix:0}}return{opacity:1,mix:0}}var ea=new e.Color(1,0,0,1),za=new e.Color(0,1,0,1),Ma=new e.Color(0,0,1,1),ga=new e.Color(1,0,1,1),va=new e.Color(0,1,1,1);function Ja(E,I,F,H){co(E,0,I+F/2,E.transform.width,F,H)}function lo(E,I,F,H){co(E,I-F/2,0,F,E.transform.height,H)}function co(E,I,F,H,re,ue){var ye=E.context,ke=ye.gl;ke.enable(ke.SCISSOR_TEST),ke.scissor(I*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,H*e.browser.devicePixelRatio,re*e.browser.devicePixelRatio),ye.clear({color:ue}),ke.disable(ke.SCISSOR_TEST)}function uo(E,I,F){var H=E.context,re=H.gl,ue=F.posMatrix,ye=E.useProgram("debug"),ke=Rt.disabled,Ee=je.disabled,Ue=E.colorModeForRenderPass();H.activeTexture.set(re.TEXTURE0),E.emptyTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),ye.draw(H,re.LINE_STRIP,ke,Ee,Ue,he.disabled,ws(ue,e.Color.red),"$debug",E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments);var $e=I.getTileByID(F.key).latestRawTileData,_t=Math.floor(($e&&$e.byteLength||0)/1024),Ct=I.getTile(F).tileSize,At=512/Math.min(Ct,512)*(F.overscaledZ/E.transform.zoom)*.5,Et=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(Et+=" => "+F.overscaledZ),function(Tt,jt){Tt.initDebugOverlayCanvas();var Nt=Tt.debugOverlayCanvas,Yt=Tt.context.gl,ln=Tt.debugOverlayCanvas.getContext("2d");ln.clearRect(0,0,Nt.width,Nt.height),ln.shadowColor="white",ln.shadowBlur=2,ln.lineWidth=1.5,ln.strokeStyle="white",ln.textBaseline="top",ln.font="bold 36px Open Sans, sans-serif",ln.fillText(jt,5,5),ln.strokeText(jt,5,5),Tt.debugOverlayTexture.update(Nt),Tt.debugOverlayTexture.bind(Yt.LINEAR,Yt.CLAMP_TO_EDGE)}(E,Et+" "+_t+"kb"),ye.draw(H,re.TRIANGLES,ke,Ee,Ye.alphaBlended,he.disabled,ws(ue,e.Color.transparent,At),"$debug",E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments)}var fo={symbol:function(E,I,F,H,re){if("translucent"===E.renderPass){var ue=je.disabled,ye=E.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(ke,Ee,Ue,$e,it,_t,Ct){for(var At=Ee.transform,Et="map"===it,Tt="map"===_t,jt=0,Nt=ke;jt<Nt.length;jt+=1){var Yt=Nt[jt],ln=$e.getTile(Yt),bn=ln.getBucket(Ue);if(bn&&bn.text&&bn.text.segments.get().length){var En=e.evaluateSizeForZoom(bn.textSizeData,At.zoom),ir=Sr(ln,1,Ee.transform.zoom),rr=zn(Yt.posMatrix,Tt,Et,Ee.transform,ir),_r="none"!==Ue.layout.get("icon-text-fit")&&bn.hasIconData();if(En){var pr=Math.pow(2,At.zoom-ln.tileID.overscaledZ);wr(bn,Et,Tt,Ct,e.symbolSize,At,rr,Yt.posMatrix,pr,En,_r)}}}}(H,E,F,I,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),re),0!==F.paint.get("icon-opacity").constantOr(1)&&Gr(E,I,F,H,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),ue,ye),0!==F.paint.get("text-opacity").constantOr(1)&&Gr(E,I,F,H,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),ue,ye),I.map.showCollisionBoxes&&(Cn(E,I,F,H,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),Cn(E,I,F,H,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(E,I,F,H){if("translucent"===E.renderPass){var re=F.paint.get("circle-opacity"),ue=F.paint.get("circle-stroke-width"),ye=F.paint.get("circle-stroke-opacity"),ke=void 0!==F.layout.get("circle-sort-key").constantOr(1);if(0!==re.constantOr(1)||0!==ue.constantOr(1)&&0!==ye.constantOr(1)){for(var Ee=E.context,Ue=Ee.gl,$e=E.depthModeForSublayer(0,Rt.ReadOnly),it=je.disabled,_t=E.colorModeForRenderPass(),Ct=[],At=0;At<H.length;At++){var Et=H[At],Tt=I.getTile(Et),jt=Tt.getBucket(F);if(jt){var Nt=jt.programConfigurations.get(F.id),Yt={programConfiguration:Nt,program:E.useProgram("circle",Nt),layoutVertexBuffer:jt.layoutVertexBuffer,indexBuffer:jt.indexBuffer,uniformValues:Ho(E,Et,Tt,F)};if(ke)for(var ln=0,bn=jt.segments.get();ln<bn.length;ln+=1){var In=bn[ln];Ct.push({segments:new e.SegmentVector([In]),sortKey:In.sortKey,state:Yt})}else Ct.push({segments:jt.segments,sortKey:0,state:Yt})}}ke&&Ct.sort(function(oi,ti){return oi.sortKey-ti.sortKey});for(var En=0,ir=Ct;En<ir.length;En+=1){var rr=ir[En],_r=rr.state;_r.program.draw(Ee,Ue.TRIANGLES,$e,it,_t,he.disabled,_r.uniformValues,F.id,_r.layoutVertexBuffer,_r.indexBuffer,rr.segments,F.paint,E.transform.zoom,_r.programConfiguration)}}}},heatmap:function(E,I,F,H){if(0!==F.paint.get("heatmap-opacity"))if("offscreen"===E.renderPass){var re=E.context,ue=re.gl,ye=je.disabled,ke=new Ye([ue.ONE,ue.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(Et,Tt,jt){var Nt=Et.gl;Et.activeTexture.set(Nt.TEXTURE1),Et.viewport.set([0,0,Tt.width/4,Tt.height/4]);var bn,In,En,ir,rr,Yt=jt.heatmapFbo;if(Yt)Nt.bindTexture(Nt.TEXTURE_2D,Yt.colorAttachment.get()),Et.bindFramebuffer.set(Yt.framebuffer);else{var ln=Nt.createTexture();Nt.bindTexture(Nt.TEXTURE_2D,ln),Nt.texParameteri(Nt.TEXTURE_2D,Nt.TEXTURE_WRAP_S,Nt.CLAMP_TO_EDGE),Nt.texParameteri(Nt.TEXTURE_2D,Nt.TEXTURE_WRAP_T,Nt.CLAMP_TO_EDGE),Nt.texParameteri(Nt.TEXTURE_2D,Nt.TEXTURE_MIN_FILTER,Nt.LINEAR),Nt.texParameteri(Nt.TEXTURE_2D,Nt.TEXTURE_MAG_FILTER,Nt.LINEAR),En=ln,ir=Yt=jt.heatmapFbo=Et.createFramebuffer(Tt.width/4,Tt.height/4,!1),(rr=(bn=Et).gl).texImage2D(rr.TEXTURE_2D,0,rr.RGBA,(In=Tt).width/4,In.height/4,0,rr.RGBA,bn.extRenderToTextureHalfFloat?bn.extTextureHalfFloat.HALF_FLOAT_OES:rr.UNSIGNED_BYTE,null),ir.colorAttachment.set(En)}})(re,E,F),re.clear({color:e.Color.transparent});for(var Ee=0;Ee<H.length;Ee++){var Ue=H[Ee];if(!I.hasRenderableParent(Ue)){var $e=I.getTile(Ue),it=$e.getBucket(F);if(it){var _t=it.programConfigurations.get(F.id);E.useProgram("heatmap",_t).draw(re,ue.TRIANGLES,Rt.disabled,ye,ke,he.disabled,Yo(Ue.posMatrix,$e,E.transform.zoom,F.paint.get("heatmap-intensity")),F.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,F.paint,E.transform.zoom,_t)}}}re.viewport.set([0,0,E.width,E.height])}else"translucent"===E.renderPass&&(E.context.setColorMode(E.colorModeForRenderPass()),function(Et,Tt){var jt=Et.context,Nt=jt.gl,Yt=Tt.heatmapFbo;if(Yt){jt.activeTexture.set(Nt.TEXTURE0),Nt.bindTexture(Nt.TEXTURE_2D,Yt.colorAttachment.get()),jt.activeTexture.set(Nt.TEXTURE1);var ln=Tt.colorRampTexture;ln||(ln=Tt.colorRampTexture=new e.Texture(jt,Tt.colorRamp,Nt.RGBA)),ln.bind(Nt.LINEAR,Nt.CLAMP_TO_EDGE),Et.useProgram("heatmapTexture").draw(jt,Nt.TRIANGLES,Rt.disabled,je.disabled,Et.colorModeForRenderPass(),he.disabled,function(bn,In,En,ir){var rr=e.create();e.ortho(rr,0,bn.width,bn.height,0,0,1);var _r=bn.context.gl;return{u_matrix:rr,u_world:[_r.drawingBufferWidth,_r.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:In.paint.get("heatmap-opacity")}}(Et,Tt),Tt.id,Et.viewportBuffer,Et.quadTriangleIndexBuffer,Et.viewportSegments,Tt.paint,Et.transform.zoom)}}(E,F))},line:function(E,I,F,H){if("translucent"===E.renderPass){var re=F.paint.get("line-opacity"),ue=F.paint.get("line-width");if(0!==re.constantOr(1)&&0!==ue.constantOr(1)){var ye=E.depthModeForSublayer(0,Rt.ReadOnly),ke=E.colorModeForRenderPass(),Ee=F.paint.get("line-dasharray"),Ue=F.paint.get("line-pattern"),$e=Ue.constantOr(1),it=F.paint.get("line-gradient"),_t=F.getCrossfadeParameters(),Ct=$e?"linePattern":Ee?"lineSDF":it?"lineGradient":"line",At=E.context,Et=At.gl,Tt=!0;if(it){At.activeTexture.set(Et.TEXTURE0);var jt=F.gradientTexture;if(!F.gradient)return;jt||(jt=F.gradientTexture=new e.Texture(At,F.gradient,Et.RGBA)),jt.bind(Et.LINEAR,Et.CLAMP_TO_EDGE)}for(var Nt=0,Yt=H;Nt<Yt.length;Nt+=1){var ln=Yt[Nt],bn=I.getTile(ln);if(!$e||bn.patternsLoaded()){var In=bn.getBucket(F);if(In){var En=In.programConfigurations.get(F.id),ir=E.context.program.get(),rr=E.useProgram(Ct,En),_r=Tt||rr.program!==ir,pr=Ue.constantOr(null);if(pr&&bn.imageAtlas){var Qr=bn.imageAtlas,li=Qr.patternPositions[pr.to.toString()],xi=Qr.patternPositions[pr.from.toString()];li&&xi&&En.setConstantPatternPositions(li,xi)}var Wn=$e?qe(E,bn,F,_t):Ee?We(E,bn,F,Ee,_t):it?Gi(E,bn,F):zo(E,bn,F);$e?(At.activeTexture.set(Et.TEXTURE0),bn.imageAtlasTexture.bind(Et.LINEAR,Et.CLAMP_TO_EDGE),En.updatePaintBuffers(_t)):Ee&&(_r||E.lineAtlas.dirty)&&(At.activeTexture.set(Et.TEXTURE0),E.lineAtlas.bind(At)),rr.draw(At,Et.TRIANGLES,ye,E.stencilModeForClipping(ln),ke,he.disabled,Wn,F.id,In.layoutVertexBuffer,In.indexBuffer,In.segments,F.paint,E.transform.zoom,En),Tt=!1}}}}}},fill:function(E,I,F,H){var re=F.paint.get("fill-color"),ue=F.paint.get("fill-opacity");if(0!==ue.constantOr(1)){var ye=E.colorModeForRenderPass(),ke=F.paint.get("fill-pattern"),Ee=E.opaquePassEnabledForLayer()&&!ke.constantOr(1)&&1===re.constantOr(e.Color.transparent).a&&1===ue.constantOr(0)?"opaque":"translucent";if(E.renderPass===Ee){var Ue=E.depthModeForSublayer(1,"opaque"===E.renderPass?Rt.ReadWrite:Rt.ReadOnly);Xr(E,I,F,H,Ue,ye,!1)}if("translucent"===E.renderPass&&F.paint.get("fill-antialias")){var $e=E.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Rt.ReadOnly);Xr(E,I,F,H,$e,ye,!0)}}},"fill-extrusion":function(E,I,F,H){var re=F.paint.get("fill-extrusion-opacity");if(0!==re&&"translucent"===E.renderPass){var ue=new Rt(E.context.gl.LEQUAL,Rt.ReadWrite,E.depthRangeFor3D);if(1!==re||F.paint.get("fill-extrusion-pattern").constantOr(1))Si(E,I,F,H,ue,je.disabled,Ye.disabled),Si(E,I,F,H,ue,E.stencilModeFor3D(),E.colorModeForRenderPass());else{var ye=E.colorModeForRenderPass();Si(E,I,F,H,ue,je.disabled,ye)}}},hillshade:function(E,I,F,H){if("offscreen"===E.renderPass||"translucent"===E.renderPass){for(var re=E.context,ue=I.getSource().maxzoom,ye=E.depthModeForSublayer(0,Rt.ReadOnly),ke=E.colorModeForRenderPass(),Ee="translucent"===E.renderPass?E.stencilConfigForOverlap(H):[{},H],Ue=Ee[0],$e=0,it=Ee[1];$e<it.length;$e+=1){var _t=it[$e],Ct=I.getTile(_t);Ct.needsHillshadePrepare&&"offscreen"===E.renderPass?$i(E,Ct,F,ue,ye,je.disabled,ke):"translucent"===E.renderPass&&Ni(E,Ct,F,ye,Ue[_t.overscaledZ],ke)}re.viewport.set([0,0,E.width,E.height])}},raster:function(E,I,F,H){if("translucent"===E.renderPass&&0!==F.paint.get("raster-opacity")&&H.length)for(var re=E.context,ue=re.gl,ye=I.getSource(),ke=E.useProgram("raster"),Ee=E.colorModeForRenderPass(),Ue=ye instanceof G?[{},H]:E.stencilConfigForOverlap(H),$e=Ue[0],it=Ue[1],_t=it[it.length-1].overscaledZ,Ct=!E.options.moving,At=0,Et=it;At<Et.length;At+=1){var Tt=Et[At],jt=E.depthModeForSublayer(Tt.overscaledZ-_t,1===F.paint.get("raster-opacity")?Rt.ReadWrite:Rt.ReadOnly,ue.LESS),Nt=I.getTile(Tt),Yt=E.transform.calculatePosMatrix(Tt.toUnwrapped(),Ct);Nt.registerFadeDuration(F.paint.get("raster-fade-duration"));var ln=I.findLoadedParent(Tt,0),bn=Qi(Nt,ln,I,F,E.transform),In=void 0,En=void 0,ir="nearest"===F.paint.get("raster-resampling")?ue.NEAREST:ue.LINEAR;re.activeTexture.set(ue.TEXTURE0),Nt.texture.bind(ir,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST),re.activeTexture.set(ue.TEXTURE1),ln?(ln.texture.bind(ir,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST),In=Math.pow(2,ln.tileID.overscaledZ-Nt.tileID.overscaledZ),En=[Nt.tileID.canonical.x*In%1,Nt.tileID.canonical.y*In%1]):Nt.texture.bind(ir,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST);var rr=bt(Yt,En||[0,0],In||1,bn,F);ye instanceof G?ke.draw(re,ue.TRIANGLES,jt,je.disabled,Ee,he.disabled,rr,F.id,ye.boundsBuffer,E.quadTriangleIndexBuffer,ye.boundsSegments):ke.draw(re,ue.TRIANGLES,jt,$e[Tt.overscaledZ],Ee,he.disabled,rr,F.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}},background:function(E,I,F){var H=F.paint.get("background-color"),re=F.paint.get("background-opacity");if(0!==re){var ue=E.context,ye=ue.gl,ke=E.transform,Ee=ke.tileSize,Ue=F.paint.get("background-pattern");if(!E.isPatternMissing(Ue)){var $e=!Ue&&1===H.a&&1===re&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass===$e){var it=je.disabled,_t=E.depthModeForSublayer(0,"opaque"===$e?Rt.ReadWrite:Rt.ReadOnly),Ct=E.colorModeForRenderPass(),At=E.useProgram(Ue?"backgroundPattern":"background"),Et=ke.coveringTiles({tileSize:Ee});Ue&&(ue.activeTexture.set(ye.TEXTURE0),E.imageManager.bind(E.context));for(var Tt=F.getCrossfadeParameters(),jt=0,Nt=Et;jt<Nt.length;jt+=1){var Yt=Nt[jt],ln=E.transform.calculatePosMatrix(Yt.toUnwrapped()),bn=Ue?xn(ln,re,E,Ue,{tileID:Yt,tileSize:Ee},Tt):un(ln,re,H);At.draw(ue,ye.TRIANGLES,_t,it,Ct,he.disabled,bn,F.id,E.tileExtentBuffer,E.quadTriangleIndexBuffer,E.tileExtentSegments)}}}}},debug:function(E,I,F){for(var H=0;H<F.length;H++)uo(E,I,F[H])},custom:function(E,I,F){var H=E.context,re=F.implementation;if("offscreen"===E.renderPass){var ue=re.prerender;ue&&(E.setCustomLayerDefaults(),H.setColorMode(E.colorModeForRenderPass()),ue.call(re,H.gl,E.transform.customLayerMatrix()),H.setDirty(),E.setBaseState())}else if("translucent"===E.renderPass){E.setCustomLayerDefaults(),H.setColorMode(E.colorModeForRenderPass()),H.setStencilMode(je.disabled);var ye="3d"===re.renderingMode?new Rt(E.context.gl.LEQUAL,Rt.ReadWrite,E.depthRangeFor3D):E.depthModeForSublayer(0,Rt.ReadOnly);H.setDepthMode(ye),re.render(H.gl,E.transform.customLayerMatrix()),H.setDirty(),E.setBaseState(),H.bindFramebuffer.set(null)}}},Xi=function(E,I){this.context=new be(E),this.transform=I,this._tileTextures={},this.setup(),this.numSublayers=Fe.maxUnderzooming+Fe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qn,this.gpuTimers={}};Xi.prototype.resize=function(E,I){if(this.width=E*e.browser.devicePixelRatio,this.height=I*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,H=this.style._order;F<H.length;F+=1)this.style._layers[H[F]].resize()},Xi.prototype.setup=function(){var E=this.context,I=new e.StructArrayLayout2i4;I.emplaceBack(0,0),I.emplaceBack(e.EXTENT,0),I.emplaceBack(0,e.EXTENT),I.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=E.createVertexBuffer(I,Ur.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=E.createVertexBuffer(F,Ur.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var H=new e.StructArrayLayout4i8;H.emplaceBack(0,0,0,0),H.emplaceBack(e.EXTENT,0,e.EXTENT,0),H.emplaceBack(0,e.EXTENT,0,e.EXTENT),H.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=E.createVertexBuffer(H,W.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var re=new e.StructArrayLayout2i4;re.emplaceBack(0,0),re.emplaceBack(1,0),re.emplaceBack(0,1),re.emplaceBack(1,1),this.viewportBuffer=E.createVertexBuffer(re,Ur.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ue=new e.StructArrayLayout1ui2;ue.emplaceBack(0),ue.emplaceBack(1),ue.emplaceBack(3),ue.emplaceBack(2),ue.emplaceBack(0),this.tileBorderIndexBuffer=E.createIndexBuffer(ue);var ye=new e.StructArrayLayout3ui6;ye.emplaceBack(0,1,2),ye.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=E.createIndexBuffer(ye),this.emptyTexture=new e.Texture(E,{width:1,height:1,data:new Uint8Array([0,0,0,0])},E.gl.RGBA);var ke=this.context.gl;this.stencilClearMode=new je({func:ke.ALWAYS,mask:0},0,255,ke.ZERO,ke.ZERO,ke.ZERO)},Xi.prototype.clearStencil=function(){var E=this.context,I=E.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[I.drawingBufferWidth,I.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(E,I.TRIANGLES,Rt.disabled,this.stencilClearMode,Ye.disabled,he.disabled,yo(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Xi.prototype._renderTileClippingMasks=function(E,I){if(this.currentStencilSource!==E.source&&E.isTileClipped()&&I&&I.length){this.currentStencilSource=E.source;var F=this.context,H=F.gl;this.nextStencilID+I.length>256&&this.clearStencil(),F.setColorMode(Ye.disabled),F.setDepthMode(Rt.disabled);var re=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var ue=0,ye=I;ue<ye.length;ue+=1){var ke=ye[ue],Ee=this._tileClippingMaskIDs[ke.key]=this.nextStencilID++;re.draw(F,H.TRIANGLES,Rt.disabled,new je({func:H.ALWAYS,mask:0},Ee,255,H.KEEP,H.KEEP,H.REPLACE),Ye.disabled,he.disabled,yo(ke.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Xi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var E=this.nextStencilID++,I=this.context.gl;return new je({func:I.NOTEQUAL,mask:255},E,255,I.KEEP,I.KEEP,I.REPLACE)},Xi.prototype.stencilModeForClipping=function(E){var I=this.context.gl;return new je({func:I.EQUAL,mask:255},this._tileClippingMaskIDs[E.key],0,I.KEEP,I.KEEP,I.REPLACE)},Xi.prototype.stencilConfigForOverlap=function(E){var I,F=this.context.gl,H=E.sort(function(Ee,Ue){return Ue.overscaledZ-Ee.overscaledZ}),re=H[H.length-1].overscaledZ,ue=H[0].overscaledZ-re+1;if(ue>1){this.currentStencilSource=void 0,this.nextStencilID+ue>256&&this.clearStencil();for(var ye={},ke=0;ke<ue;ke++)ye[ke+re]=new je({func:F.GEQUAL,mask:255},ke+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=ue,[ye,H]}return[(I={},I[re]=je.disabled,I),H]},Xi.prototype.colorModeForRenderPass=function(){var E=this.context.gl;return this._showOverdrawInspector?new Ye([E.CONSTANT_COLOR,E.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ye.unblended:Ye.alphaBlended},Xi.prototype.depthModeForSublayer=function(E,I,F){if(!this.opaquePassEnabledForLayer())return Rt.disabled;var H=1-((1+this.currentLayer)*this.numSublayers+E)*this.depthEpsilon;return new Rt(F||this.context.gl.LEQUAL,I,[H,H])},Xi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Xi.prototype.render=function(E,I){var F=this;this.style=E,this.options=I,this.lineAtlas=E.lineAtlas,this.imageManager=E.imageManager,this.glyphManager=E.glyphManager,this.symbolFadeChange=E.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var H=this.style._order,re=this.style.sourceCaches;for(var ue in re){var ye=re[ue];ye.used&&ye.prepare(this.context)}var ke,Ee,Ue={},$e={},it={};for(var _t in re){var Ct=re[_t];Ue[_t]=Ct.getVisibleCoordinates(),$e[_t]=Ue[_t].slice().reverse(),it[_t]=Ct.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var At=0;At<H.length;At++)if(this.style._layers[H[At]].is3D()){this.opaquePassCutoff=At;break}this.renderPass="offscreen";for(var Tt=0,jt=H;Tt<jt.length;Tt+=1){var Yt=this.style._layers[jt[Tt]];if(Yt.hasOffscreenPass()&&!Yt.isHidden(this.transform.zoom)){var ln=$e[Yt.source];("custom"===Yt.type||ln.length)&&this.renderLayer(this,re[Yt.source],Yt,ln)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:I.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=I.showOverdrawInspector,this.depthRangeFor3D=[0,1-(E._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=H.length-1;this.currentLayer>=0;this.currentLayer--){var bn=this.style._layers[H[this.currentLayer]],In=re[bn.source],En=Ue[bn.source];this._renderTileClippingMasks(bn,En),this.renderLayer(this,In,bn,En)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<H.length;this.currentLayer++){var ir=this.style._layers[H[this.currentLayer]],rr=re[ir.source],_r=("symbol"===ir.type?it:$e)[ir.source];this._renderTileClippingMasks(ir,Ue[ir.source]),this.renderLayer(this,rr,ir,_r)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(pr){pr.source&&!pr.isHidden(F.transform.zoom)&&(pr.source!==(Ee&&Ee.id)&&(Ee=F.style.sourceCaches[pr.source]),(!ke||ke.getSource().maxzoom<Ee.getSource().maxzoom)&&(ke=Ee))}),ke&&fo.debug(this,ke,ke.getVisibleCoordinates())),this.options.showPadding&&function Sa(E){var I=E.transform.padding;Ja(E,E.transform.height-(I.top||0),3,ea),Ja(E,I.bottom||0,3,za),lo(E,I.left||0,3,Ma),lo(E,E.transform.width-(I.right||0),3,ga);var H,re,ue,ye,F=E.transform.centerPoint;co(H=E,(re=F.x)-1,(ue=E.transform.height-F.y)-10,2,20,ye=va),co(H,re-10,ue-1,20,2,ye)}(this),this.context.setDefault()},Xi.prototype.renderLayer=function(E,I,F,H){F.isHidden(this.transform.zoom)||("background"===F.type||"custom"===F.type||H.length)&&(this.id=F.id,this.gpuTimingStart(F),fo[F.type](E,I,F,H,this.style.placement.variableOffsets),this.gpuTimingEnd())},Xi.prototype.gpuTimingStart=function(E){if(this.options.gpuTiming){var I=this.context.extTimerQuery,F=this.gpuTimers[E.id];F||(F=this.gpuTimers[E.id]={calls:0,cpuTime:0,query:I.createQueryEXT()}),F.calls++,I.beginQueryEXT(I.TIME_ELAPSED_EXT,F.query)}},Xi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var E=this.context.extTimerQuery;E.endQueryEXT(E.TIME_ELAPSED_EXT)}},Xi.prototype.collectGpuTimers=function(){var E=this.gpuTimers;return this.gpuTimers={},E},Xi.prototype.queryGpuTimers=function(E){var I={};for(var F in E){var H=E[F],re=this.context.extTimerQuery,ue=re.getQueryObjectEXT(H.query,re.QUERY_RESULT_EXT)/1e6;re.deleteQueryEXT(H.query),I[F]=ue}return I},Xi.prototype.translatePosMatrix=function(E,I,F,H,re){if(!F[0]&&!F[1])return E;var ue=re?"map"===H?this.transform.angle:0:"viewport"===H?-this.transform.angle:0;if(ue){var ye=Math.sin(ue),ke=Math.cos(ue);F=[F[0]*ke-F[1]*ye,F[0]*ye+F[1]*ke]}var Ee=[re?F[0]:Sr(I,F[0],this.transform.zoom),re?F[1]:Sr(I,F[1],this.transform.zoom),0],Ue=new Float32Array(16);return e.translate(Ue,E,Ee),Ue},Xi.prototype.saveTileTexture=function(E){var I=this._tileTextures[E.size[0]];I?I.push(E):this._tileTextures[E.size[0]]=[E]},Xi.prototype.getTileTexture=function(E){var I=this._tileTextures[E];return I&&I.length>0?I.pop():null},Xi.prototype.isPatternMissing=function(E){if(!E)return!1;if(!E.from||!E.to)return!0;var I=this.imageManager.getPattern(E.from.toString()),F=this.imageManager.getPattern(E.to.toString());return!I||!F},Xi.prototype.useProgram=function(E,I){this.cache=this.cache||{};var F=""+E+(I?I.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new As(this.context,ls[E],I,Sn[E],this._showOverdrawInspector)),this.cache[F]},Xi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Xi.prototype.setBaseState=function(){var E=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(E.FUNC_ADD)},Xi.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Xi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var mt=function(E,I){this.points=E,this.planes=I};mt.fromInvProjectionMatrix=function(E,I,F){var H=Math.pow(2,F),re=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(ye){return e.transformMat4([],ye,E)}).map(function(ye){return e.scale$1([],ye,1/ye[3]/I*H)}),ue=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(ye){var ke=e.sub([],re[ye[0]],re[ye[1]]),Ee=e.sub([],re[ye[2]],re[ye[1]]),Ue=e.normalize([],e.cross([],ke,Ee)),$e=-e.dot(Ue,re[ye[1]]);return Ue.concat($e)});return new mt(re,ue)};var Bt=function(E,I){this.min=E,this.max=I,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Bt.prototype.quadrant=function(E){for(var I=[E%2==0,E<2],F=e.clone$2(this.min),H=e.clone$2(this.max),re=0;re<I.length;re++)F[re]=I[re]?this.min[re]:this.center[re],H[re]=I[re]?this.center[re]:this.max[re];return H[2]=this.max[2],new Bt(F,H)},Bt.prototype.distanceX=function(E){return Math.max(Math.min(this.max[0],E[0]),this.min[0])-E[0]},Bt.prototype.distanceY=function(E){return Math.max(Math.min(this.max[1],E[1]),this.min[1])-E[1]},Bt.prototype.intersects=function(E){for(var I=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,H=0;H<E.planes.length;H++){for(var re=E.planes[H],ue=0,ye=0;ye<I.length;ye++)ue+=e.dot$1(re,I[ye])>=0;if(0===ue)return 0;ue!==I.length&&(F=!1)}if(F)return 2;for(var ke=0;ke<3;ke++){for(var Ee=Number.MAX_VALUE,Ue=-Number.MAX_VALUE,$e=0;$e<E.points.length;$e++){var it=E.points[$e][ke]-this.min[ke];Ee=Math.min(Ee,it),Ue=Math.max(Ue,it)}if(Ue<0||Ee>this.max[ke]-this.min[ke])return 0}return 1};var pn=function(E,I,F,H){if(void 0===E&&(E=0),void 0===I&&(I=0),void 0===F&&(F=0),void 0===H&&(H=0),isNaN(E)||E<0||isNaN(I)||I<0||isNaN(F)||F<0||isNaN(H)||H<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=E,this.bottom=I,this.left=F,this.right=H};pn.prototype.interpolate=function(E,I,F){return null!=I.top&&null!=E.top&&(this.top=e.number(E.top,I.top,F)),null!=I.bottom&&null!=E.bottom&&(this.bottom=e.number(E.bottom,I.bottom,F)),null!=I.left&&null!=E.left&&(this.left=e.number(E.left,I.left,F)),null!=I.right&&null!=E.right&&(this.right=e.number(E.right,I.right,F)),this},pn.prototype.getCenter=function(E,I){var F=e.clamp((this.left+E-this.right)/2,0,E),H=e.clamp((this.top+I-this.bottom)/2,0,I);return new e.Point(F,H)},pn.prototype.equals=function(E){return this.top===E.top&&this.bottom===E.bottom&&this.left===E.left&&this.right===E.right},pn.prototype.clone=function(){return new pn(this.top,this.bottom,this.left,this.right)},pn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Xt=function(E,I,F,H,re){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===re||re,this._minZoom=E||0,this._maxZoom=I||22,this._minPitch=null==F?0:F,this._maxPitch=null==H?60:H,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pn,this._posMatrixCache={},this._alignedPosMatrixCache={}},dn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Xt.prototype.clone=function(){var E=new Xt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return E.tileSize=this.tileSize,E.latRange=this.latRange,E.width=this.width,E.height=this.height,E._center=this._center,E.zoom=this.zoom,E.angle=this.angle,E._fov=this._fov,E._pitch=this._pitch,E._unmodified=this._unmodified,E._edgeInsets=this._edgeInsets.clone(),E._calcMatrices(),E},dn.minZoom.get=function(){return this._minZoom},dn.minZoom.set=function(E){this._minZoom!==E&&(this._minZoom=E,this.zoom=Math.max(this.zoom,E))},dn.maxZoom.get=function(){return this._maxZoom},dn.maxZoom.set=function(E){this._maxZoom!==E&&(this._maxZoom=E,this.zoom=Math.min(this.zoom,E))},dn.minPitch.get=function(){return this._minPitch},dn.minPitch.set=function(E){this._minPitch!==E&&(this._minPitch=E,this.pitch=Math.max(this.pitch,E))},dn.maxPitch.get=function(){return this._maxPitch},dn.maxPitch.set=function(E){this._maxPitch!==E&&(this._maxPitch=E,this.pitch=Math.min(this.pitch,E))},dn.renderWorldCopies.get=function(){return this._renderWorldCopies},dn.renderWorldCopies.set=function(E){void 0===E?E=!0:null===E&&(E=!1),this._renderWorldCopies=E},dn.worldSize.get=function(){return this.tileSize*this.scale},dn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},dn.size.get=function(){return new e.Point(this.width,this.height)},dn.bearing.get=function(){return-this.angle/Math.PI*180},dn.bearing.set=function(E){var I=-e.wrap(E,-180,180)*Math.PI/180;this.angle!==I&&(this._unmodified=!1,this.angle=I,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},dn.pitch.get=function(){return this._pitch/Math.PI*180},dn.pitch.set=function(E){var I=e.clamp(E,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==I&&(this._unmodified=!1,this._pitch=I,this._calcMatrices())},dn.fov.get=function(){return this._fov/Math.PI*180},dn.fov.set=function(E){E=Math.max(.01,Math.min(60,E)),this._fov!==E&&(this._unmodified=!1,this._fov=E/180*Math.PI,this._calcMatrices())},dn.zoom.get=function(){return this._zoom},dn.zoom.set=function(E){var I=Math.min(Math.max(E,this.minZoom),this.maxZoom);this._zoom!==I&&(this._unmodified=!1,this._zoom=I,this.scale=this.zoomScale(I),this.tileZoom=Math.floor(I),this.zoomFraction=I-this.tileZoom,this._constrain(),this._calcMatrices())},dn.center.get=function(){return this._center},dn.center.set=function(E){E.lat===this._center.lat&&E.lng===this._center.lng||(this._unmodified=!1,this._center=E,this._constrain(),this._calcMatrices())},dn.padding.get=function(){return this._edgeInsets.toJSON()},dn.padding.set=function(E){this._edgeInsets.equals(E)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,E,1),this._calcMatrices())},dn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Xt.prototype.isPaddingEqual=function(E){return this._edgeInsets.equals(E)},Xt.prototype.interpolatePadding=function(E,I,F){this._unmodified=!1,this._edgeInsets.interpolate(E,I,F),this._constrain(),this._calcMatrices()},Xt.prototype.coveringZoomLevel=function(E){var I=(E.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/E.tileSize));return Math.max(0,I)},Xt.prototype.getVisibleUnwrappedCoordinates=function(E){var I=[new e.UnwrappedTileID(0,E)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),H=this.pointCoordinate(new e.Point(this.width,0)),re=this.pointCoordinate(new e.Point(this.width,this.height)),ue=this.pointCoordinate(new e.Point(0,this.height)),ye=Math.floor(Math.min(F.x,H.x,re.x,ue.x)),ke=Math.floor(Math.max(F.x,H.x,re.x,ue.x)),Ee=ye-1;Ee<=ke+1;Ee++)0!==Ee&&I.push(new e.UnwrappedTileID(Ee,E));return I},Xt.prototype.coveringTiles=function(E){var I=this.coveringZoomLevel(E),F=I;if(void 0!==E.minzoom&&I<E.minzoom)return[];void 0!==E.maxzoom&&I>E.maxzoom&&(I=E.maxzoom);var H=e.MercatorCoordinate.fromLngLat(this.center),re=Math.pow(2,I),ue=[re*H.x,re*H.y,0],ye=mt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,I),ke=E.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ke=I);var Ee=function(_r){return{aabb:new Bt([_r*re,0,0],[(_r+1)*re,re,0]),zoom:0,x:0,y:0,wrap:_r,fullyVisible:!1}},Ue=[],$e=[],it=I,_t=E.reparseOverscaled?F:I;if(this._renderWorldCopies)for(var Ct=1;Ct<=3;Ct++)Ue.push(Ee(-Ct)),Ue.push(Ee(Ct));for(Ue.push(Ee(0));Ue.length>0;){var At=Ue.pop(),Et=At.x,Tt=At.y,jt=At.fullyVisible;if(!jt){var Nt=At.aabb.intersects(ye);if(0===Nt)continue;jt=2===Nt}var Yt=At.aabb.distanceX(ue),ln=At.aabb.distanceY(ue),bn=Math.max(Math.abs(Yt),Math.abs(ln));if(At.zoom===it||bn>3+(1<<it-At.zoom)-2&&At.zoom>=ke)$e.push({tileID:new e.OverscaledTileID(At.zoom===it?_t:At.zoom,At.wrap,At.zoom,Et,Tt),distanceSq:e.sqrLen([ue[0]-.5-Et,ue[1]-.5-Tt])});else for(var En=0;En<4;En++){var ir=(Et<<1)+En%2,rr=(Tt<<1)+(En>>1);Ue.push({aabb:At.aabb.quadrant(En),zoom:At.zoom+1,x:ir,y:rr,wrap:At.wrap,fullyVisible:jt})}}return $e.sort(function(_r,pr){return _r.distanceSq-pr.distanceSq}).map(function(_r){return _r.tileID})},Xt.prototype.resize=function(E,I){this.width=E,this.height=I,this.pixelsToGLUnits=[2/E,-2/I],this._constrain(),this._calcMatrices()},dn.unmodified.get=function(){return this._unmodified},Xt.prototype.zoomScale=function(E){return Math.pow(2,E)},Xt.prototype.scaleZoom=function(E){return Math.log(E)/Math.LN2},Xt.prototype.project=function(E){var I=e.clamp(E.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(E.lng)*this.worldSize,e.mercatorYfromLat(I)*this.worldSize)},Xt.prototype.unproject=function(E){return new e.MercatorCoordinate(E.x/this.worldSize,E.y/this.worldSize).toLngLat()},dn.point.get=function(){return this.project(this.center)},Xt.prototype.setLocationAtPoint=function(E,I){var F=this.pointCoordinate(I),H=this.pointCoordinate(this.centerPoint),re=this.locationCoordinate(E),ue=new e.MercatorCoordinate(re.x-(F.x-H.x),re.y-(F.y-H.y));this.center=this.coordinateLocation(ue),this._renderWorldCopies&&(this.center=this.center.wrap())},Xt.prototype.locationPoint=function(E){return this.coordinatePoint(this.locationCoordinate(E))},Xt.prototype.pointLocation=function(E){return this.coordinateLocation(this.pointCoordinate(E))},Xt.prototype.locationCoordinate=function(E){return e.MercatorCoordinate.fromLngLat(E)},Xt.prototype.coordinateLocation=function(E){return E.toLngLat()},Xt.prototype.pointCoordinate=function(E){var I=[E.x,E.y,0,1],F=[E.x,E.y,1,1];e.transformMat4(I,I,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var H=I[3],re=F[3],ke=I[1]/H,Ee=F[1]/re,Ue=I[2]/H,$e=F[2]/re,it=Ue===$e?0:(0-Ue)/($e-Ue);return new e.MercatorCoordinate(e.number(I[0]/H,F[0]/re,it)/this.worldSize,e.number(ke,Ee,it)/this.worldSize)},Xt.prototype.coordinatePoint=function(E){var I=[E.x*this.worldSize,E.y*this.worldSize,0,1];return e.transformMat4(I,I,this.pixelMatrix),new e.Point(I[0]/I[3],I[1]/I[3])},Xt.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Xt.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Xt.prototype.setMaxBounds=function(E){E?(this.lngRange=[E.getWest(),E.getEast()],this.latRange=[E.getSouth(),E.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Xt.prototype.calculatePosMatrix=function(E,I){void 0===I&&(I=!1);var F=E.key,H=I?this._alignedPosMatrixCache:this._posMatrixCache;if(H[F])return H[F];var re=E.canonical,ue=this.worldSize/this.zoomScale(re.z),ye=re.x+Math.pow(2,re.z)*E.wrap,ke=e.identity(new Float64Array(16));return e.translate(ke,ke,[ye*ue,re.y*ue,0]),e.scale(ke,ke,[ue/e.EXTENT,ue/e.EXTENT,1]),e.multiply(ke,I?this.alignedProjMatrix:this.projMatrix,ke),H[F]=new Float32Array(ke),H[F]},Xt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Xt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var E,I,F,H,re=-90,ue=90,ye=-180,ke=180,Ee=this.size,Ue=this._unmodified;if(this.latRange){var $e=this.latRange;re=e.mercatorYfromLat($e[1])*this.worldSize,E=(ue=e.mercatorYfromLat($e[0])*this.worldSize)-re<Ee.y?Ee.y/(ue-re):0}if(this.lngRange){var it=this.lngRange;ye=e.mercatorXfromLng(it[0])*this.worldSize,I=(ke=e.mercatorXfromLng(it[1])*this.worldSize)-ye<Ee.x?Ee.x/(ke-ye):0}var _t=this.point,Ct=Math.max(I||0,E||0);if(Ct)return this.center=this.unproject(new e.Point(I?(ke+ye)/2:_t.x,E?(ue+re)/2:_t.y)),this.zoom+=this.scaleZoom(Ct),this._unmodified=Ue,void(this._constraining=!1);if(this.latRange){var At=_t.y,Et=Ee.y/2;At-Et<re&&(H=re+Et),At+Et>ue&&(H=ue-Et)}if(this.lngRange){var Tt=_t.x,jt=Ee.x/2;Tt-jt<ye&&(F=ye+jt),Tt+jt>ke&&(F=ke-jt)}void 0===F&&void 0===H||(this.center=this.unproject(new e.Point(void 0!==F?F:_t.x,void 0!==H?H:_t.y))),this._unmodified=Ue,this._constraining=!1}},Xt.prototype._calcMatrices=function(){if(this.height){var I=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var F=Math.PI/2+this._pitch,H=this._fov*(.5+I.y/this.height),re=Math.sin(H)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-H,.01,Math.PI-.01)),ue=this.point,ye=ue.x,ke=ue.y,Ee=1.01*(Math.cos(Math.PI/2-this._pitch)*re+this.cameraToCenterDistance),Ue=this.height/50,$e=new Float64Array(16);e.perspective($e,this._fov,this.width/this.height,Ue,Ee),$e[8]=2*-I.x/this.width,$e[9]=2*I.y/this.height,e.scale($e,$e,[1,-1,1]),e.translate($e,$e,[0,0,-this.cameraToCenterDistance]),e.rotateX($e,$e,this._pitch),e.rotateZ($e,$e,this.angle),e.translate($e,$e,[-ye,-ke,0]),this.mercatorMatrix=e.scale([],$e,[this.worldSize,this.worldSize,this.worldSize]),e.scale($e,$e,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=$e,this.invProjMatrix=e.invert([],this.projMatrix);var it=this.width%2/2,_t=this.height%2/2,Ct=Math.cos(this.angle),At=Math.sin(this.angle),Et=ye-Math.round(ye)+Ct*it+At*_t,Tt=ke-Math.round(ke)+Ct*_t+At*it,jt=new Float64Array($e);if(e.translate(jt,jt,[Et>.5?Et-1:Et,Tt>.5?Tt-1:Tt,0]),this.alignedProjMatrix=jt,$e=e.create(),e.scale($e,$e,[this.width/2,-this.height/2,1]),e.translate($e,$e,[1,-1,0]),this.labelPlaneMatrix=$e,$e=e.create(),e.scale($e,$e,[1,-1,1]),e.translate($e,$e,[-1,-1,0]),e.scale($e,$e,[2/this.width,2/this.height,1]),this.glCoordMatrix=$e,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!($e=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=$e,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Xt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var E=this.pointCoordinate(new e.Point(0,0)),I=[E.x*this.worldSize,E.y*this.worldSize,0,1];return e.transformMat4(I,I,this.pixelMatrix)[3]/this.cameraToCenterDistance},Xt.prototype.getCameraPoint=function(){var I=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,I))},Xt.prototype.getCameraQueryGeometry=function(E){var I=this.getCameraPoint();if(1===E.length)return[E[0],I];for(var F=I.x,H=I.y,re=I.x,ue=I.y,ye=0,ke=E;ye<ke.length;ye+=1){var Ee=ke[ye];F=Math.min(F,Ee.x),H=Math.min(H,Ee.y),re=Math.max(re,Ee.x),ue=Math.max(ue,Ee.y)}return[new e.Point(F,H),new e.Point(re,H),new e.Point(re,ue),new e.Point(F,ue),new e.Point(F,H)]},Object.defineProperties(Xt.prototype,dn);var Fn=function(E){var I,H,re,ue;this._hashName=E&&encodeURIComponent(E),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(I=this._updateHashUnthrottled.bind(this),300,H=!1,re=null,ue=function(){re=null,H&&(I(),re=setTimeout(ue,300),H=!1)},function(){return H=!0,re||ue(),re})};Fn.prototype.addTo=function(E){return this._map=E,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Fn.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Fn.prototype.getHashString=function(E){var I=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,H=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),re=Math.pow(10,H),ue=Math.round(I.lng*re)/re,ye=Math.round(I.lat*re)/re,ke=this._map.getBearing(),Ee=this._map.getPitch(),Ue="";if(Ue+=E?"/"+ue+"/"+ye+"/"+F:F+"/"+ye+"/"+ue,(ke||Ee)&&(Ue+="/"+Math.round(10*ke)/10),Ee&&(Ue+="/"+Math.round(Ee)),this._hashName){var $e=this._hashName,it=!1,_t=e.window.location.hash.slice(1).split("&").map(function(Ct){var At=Ct.split("=")[0];return At===$e?(it=!0,At+"="+Ue):Ct}).filter(function(Ct){return Ct});return it||_t.push($e+"="+Ue),"#"+_t.join("&")}return"#"+Ue},Fn.prototype._getCurrentHash=function(){var E,I=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(H){return H.split("=")}).forEach(function(H){H[0]===I._hashName&&(E=H)}),(E&&E[1]||"").split("/")):F.split("/")},Fn.prototype._onHashChange=function(){var E=this._getCurrentHash();if(E.length>=3&&!E.some(function(F){return isNaN(F)})){var I=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(E[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+E[2],+E[1]],zoom:+E[0],bearing:I,pitch:+(E[4]||0)}),!0}return!1},Fn.prototype._updateHashUnthrottled=function(){var E=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",E)}catch(I){}};var Zn={linearity:.3,easing:e.bezier(0,0,.3,1)},er=e.extend({deceleration:2500,maxSpeed:1400},Zn),yr=e.extend({deceleration:20,maxSpeed:1400},Zn),gr=e.extend({deceleration:1e3,maxSpeed:360},Zn),Tr=e.extend({deceleration:1e3,maxSpeed:90},Zn),Ir=function(E){this._map=E,this.clear()};function xr(E,I){(!E.duration||E.duration<I.duration)&&(E.duration=I.duration,E.easing=I.easing)}function Dr(E,I,F){var H=F.maxSpeed,re=F.linearity,ue=F.deceleration,ye=e.clamp(E*re/(I/1e3),-H,H),ke=Math.abs(ye)/(ue*re);return{easing:F.easing,duration:1e3*ke,amount:ye*(ke/2)}}Ir.prototype.clear=function(){this._inertiaBuffer=[]},Ir.prototype.record=function(E){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:E})},Ir.prototype._drainInertiaBuffer=function(){for(var E=this._inertiaBuffer,I=e.browser.now();E.length>0&&I-E[0].time>160;)E.shift()},Ir.prototype._onMoveEnd=function(E){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var I={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,H=this._inertiaBuffer;F<H.length;F+=1){var re=H[F].settings;I.zoom+=re.zoomDelta||0,I.bearing+=re.bearingDelta||0,I.pitch+=re.pitchDelta||0,re.panDelta&&I.pan._add(re.panDelta),re.around&&(I.around=re.around),re.pinchAround&&(I.pinchAround=re.pinchAround)}var ue=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,ye={};if(I.pan.mag()){var ke=Dr(I.pan.mag(),ue,e.extend({},er,E||{}));ye.offset=I.pan.mult(ke.amount/I.pan.mag()),ye.center=this._map.transform.center,xr(ye,ke)}if(I.zoom){var Ee=Dr(I.zoom,ue,yr);ye.zoom=this._map.transform.zoom+Ee.amount,xr(ye,Ee)}if(I.bearing){var Ue=Dr(I.bearing,ue,gr);ye.bearing=this._map.transform.bearing+e.clamp(Ue.amount,-179,179),xr(ye,Ue)}if(I.pitch){var $e=Dr(I.pitch,ue,Tr);ye.pitch=this._map.transform.pitch+$e.amount,xr(ye,$e)}if(ye.zoom||ye.bearing){var it=void 0===I.pinchAround?I.around:I.pinchAround;ye.around=it?this._map.unproject(it):this._map.getCenter()}return this.clear(),e.extend(ye,{noMoveStart:!0})}};var Zr=function(E){function I(H,re,ue,ye){void 0===ye&&(ye={});var ke=i.mousePos(re.getCanvasContainer(),ue),Ee=re.unproject(ke);E.call(this,H,e.extend({point:ke,lngLat:Ee,originalEvent:ue},ye)),this._defaultPrevented=!1,this.target=re}E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I;var F={defaultPrevented:{configurable:!0}};return I.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(I.prototype,F),I}(e.Event),ei=function(E){function I(H,re,ue){var ye="touchend"===H?ue.changedTouches:ue.touches,ke=i.touchPos(re.getCanvasContainer(),ye),Ee=ke.map(function(it){return re.unproject(it)}),Ue=ke.reduce(function(it,_t,Ct,At){return it.add(_t.div(At.length))},new e.Point(0,0)),$e=re.unproject(Ue);E.call(this,H,{points:ke,point:Ue,lngLats:Ee,lngLat:$e,originalEvent:ue}),this._defaultPrevented=!1}E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I;var F={defaultPrevented:{configurable:!0}};return I.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(I.prototype,F),I}(e.Event),yi=function(E){function I(H,re,ue){E.call(this,H,{originalEvent:ue}),this._defaultPrevented=!1}E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I;var F={defaultPrevented:{configurable:!0}};return I.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(I.prototype,F),I}(e.Event),nr=function(E,I){this._map=E,this._clickTolerance=I.clickTolerance};nr.prototype.reset=function(){delete this._mousedownPos},nr.prototype.wheel=function(E){return this._firePreventable(new yi(E.type,this._map,E))},nr.prototype.mousedown=function(E,I){return this._mousedownPos=I,this._firePreventable(new Zr(E.type,this._map,E))},nr.prototype.mouseup=function(E){this._map.fire(new Zr(E.type,this._map,E))},nr.prototype.click=function(E,I){this._mousedownPos&&this._mousedownPos.dist(I)>=this._clickTolerance||this._map.fire(new Zr(E.type,this._map,E))},nr.prototype.dblclick=function(E){return this._firePreventable(new Zr(E.type,this._map,E))},nr.prototype.mouseover=function(E){this._map.fire(new Zr(E.type,this._map,E))},nr.prototype.mouseout=function(E){this._map.fire(new Zr(E.type,this._map,E))},nr.prototype.touchstart=function(E){return this._firePreventable(new ei(E.type,this._map,E))},nr.prototype.touchmove=function(E){this._map.fire(new ei(E.type,this._map,E))},nr.prototype.touchend=function(E){this._map.fire(new ei(E.type,this._map,E))},nr.prototype.touchcancel=function(E){this._map.fire(new ei(E.type,this._map,E))},nr.prototype._firePreventable=function(E){if(this._map.fire(E),E.defaultPrevented)return{}},nr.prototype.isEnabled=function(){return!0},nr.prototype.isActive=function(){return!1},nr.prototype.enable=function(){},nr.prototype.disable=function(){};var mi=function(E){this._map=E};mi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},mi.prototype.mousemove=function(E){this._map.fire(new Zr(E.type,this._map,E))},mi.prototype.mousedown=function(){this._delayContextMenu=!0},mi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Zr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},mi.prototype.contextmenu=function(E){this._delayContextMenu?this._contextMenuEvent=E:this._map.fire(new Zr(E.type,this._map,E)),this._map.listens("contextmenu")&&E.preventDefault()},mi.prototype.isEnabled=function(){return!0},mi.prototype.isActive=function(){return!1},mi.prototype.enable=function(){},mi.prototype.disable=function(){};var Hr=function(E,I){this._map=E,this._el=E.getCanvasContainer(),this._container=E.getContainer(),this._clickTolerance=I.clickTolerance||1};function Jr(E,I){for(var F={},H=0;H<E.length;H++)F[E[H].identifier]=I[H];return F}Hr.prototype.isEnabled=function(){return!!this._enabled},Hr.prototype.isActive=function(){return!!this._active},Hr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Hr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Hr.prototype.mousedown=function(E,I){this.isEnabled()&&E.shiftKey&&0===E.button&&(i.disableDrag(),this._startPos=this._lastPos=I,this._active=!0)},Hr.prototype.mousemoveWindow=function(E,I){if(this._active){var F=I;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var H=this._startPos;this._lastPos=F,this._box||(this._box=i.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",E));var re=Math.min(H.x,F.x),ue=Math.max(H.x,F.x),ye=Math.min(H.y,F.y),ke=Math.max(H.y,F.y);i.setTransform(this._box,"translate("+re+"px,"+ye+"px)"),this._box.style.width=ue-re+"px",this._box.style.height=ke-ye+"px"}}},Hr.prototype.mouseupWindow=function(E,I){var F=this;if(this._active&&0===E.button){var H=this._startPos,re=I;if(this.reset(),i.suppressClick(),H.x!==re.x||H.y!==re.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:E})),{cameraAnimation:function(ue){return ue.fitScreenCoordinates(H,re,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",E)}},Hr.prototype.keydown=function(E){this._active&&27===E.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",E))},Hr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(i.remove(this._box),this._box=null),i.enableDrag(),delete this._startPos,delete this._lastPos},Hr.prototype._fireEvent=function(E,I){return this._map.fire(new e.Event(E,{originalEvent:I}))};var di=function(E){this.reset(),this.numTouches=E.numTouches};di.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},di.prototype.touchstart=function(E,I,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=E.timeStamp),F.length===this.numTouches&&(this.centroid=function(H){for(var re=new e.Point(0,0),ue=0,ye=H;ue<ye.length;ue+=1)re._add(ye[ue]);return re.div(H.length)}(I),this.touches=Jr(F,I)))},di.prototype.touchmove=function(E,I,F){if(!this.aborted&&this.centroid){var H=Jr(F,I);for(var re in this.touches){var ye=H[re];(!ye||ye.dist(this.touches[re])>30)&&(this.aborted=!0)}}},di.prototype.touchend=function(E,I,F){if((!this.centroid||E.timeStamp-this.startTime>500)&&(this.aborted=!0),0===F.length){var H=!this.aborted&&this.centroid;if(this.reset(),H)return H}};var Pi=function(E){this.singleTap=new di(E),this.numTaps=E.numTaps,this.reset()};Pi.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Pi.prototype.touchstart=function(E,I,F){this.singleTap.touchstart(E,I,F)},Pi.prototype.touchmove=function(E,I,F){this.singleTap.touchmove(E,I,F)},Pi.prototype.touchend=function(E,I,F){var H=this.singleTap.touchend(E,I,F);if(H){var re=E.timeStamp-this.lastTime<500,ue=!this.lastTap||this.lastTap.dist(H)<30;if(re&&ue||this.reset(),this.count++,this.lastTime=E.timeStamp,this.lastTap=H,this.count===this.numTaps)return this.reset(),H}};var Vi=function(){this._zoomIn=new Pi({numTouches:1,numTaps:2}),this._zoomOut=new Pi({numTouches:2,numTaps:1}),this.reset()};Vi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Vi.prototype.touchstart=function(E,I,F){this._zoomIn.touchstart(E,I,F),this._zoomOut.touchstart(E,I,F)},Vi.prototype.touchmove=function(E,I,F){this._zoomIn.touchmove(E,I,F),this._zoomOut.touchmove(E,I,F)},Vi.prototype.touchend=function(E,I,F){var H=this,re=this._zoomIn.touchend(E,I,F),ue=this._zoomOut.touchend(E,I,F);return re?(this._active=!0,E.preventDefault(),setTimeout(function(){return H.reset()},0),{cameraAnimation:function(ye){return ye.easeTo({duration:300,zoom:ye.getZoom()+1,around:ye.unproject(re)},{originalEvent:E})}}):ue?(this._active=!0,E.preventDefault(),setTimeout(function(){return H.reset()},0),{cameraAnimation:function(ye){return ye.easeTo({duration:300,zoom:ye.getZoom()-1,around:ye.unproject(ue)},{originalEvent:E})}}):void 0},Vi.prototype.touchcancel=function(){this.reset()},Vi.prototype.enable=function(){this._enabled=!0},Vi.prototype.disable=function(){this._enabled=!1,this.reset()},Vi.prototype.isEnabled=function(){return this._enabled},Vi.prototype.isActive=function(){return this._active};var Br=function(E){this.reset(),this._clickTolerance=E.clickTolerance||1};Br.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Br.prototype._correctButton=function(E,I){return!1},Br.prototype._move=function(E,I){return{}},Br.prototype.mousedown=function(E,I){if(!this._lastPoint){var F=i.mouseButton(E);this._correctButton(E,F)&&(this._lastPoint=I,this._eventButton=F)}},Br.prototype.mousemoveWindow=function(E,I){var F=this._lastPoint;if(F&&(E.preventDefault(),this._moved||!(I.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=I,this._move(F,I)},Br.prototype.mouseupWindow=function(E){i.mouseButton(E)===this._eventButton&&(this._moved&&i.suppressClick(),this.reset())},Br.prototype.enable=function(){this._enabled=!0},Br.prototype.disable=function(){this._enabled=!1,this.reset()},Br.prototype.isEnabled=function(){return this._enabled},Br.prototype.isActive=function(){return this._active};var Wi=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.mousedown=function(F,H){E.prototype.mousedown.call(this,F,H),this._lastPoint&&(this._active=!0)},I.prototype._correctButton=function(F,H){return 0===H&&!F.ctrlKey},I.prototype._move=function(F,H){return{around:H,panDelta:H.sub(F)}},I}(Br),Ui=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype._correctButton=function(F,H){return 0===H&&F.ctrlKey||2===H},I.prototype._move=function(F,H){var re=.8*(H.x-F.x);if(re)return this._active=!0,{bearingDelta:re}},I.prototype.contextmenu=function(F){F.preventDefault()},I}(Br),Mi=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype._correctButton=function(F,H){return 0===H&&F.ctrlKey||2===H},I.prototype._move=function(F,H){var re=-.5*(H.y-F.y);if(re)return this._active=!0,{pitchDelta:re}},I.prototype.contextmenu=function(F){F.preventDefault()},I}(Br),Ji=function(E){this._minTouches=1,this._clickTolerance=E.clickTolerance||1,this.reset()};Ji.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Ji.prototype.touchstart=function(E,I,F){return this._calculateTransform(E,I,F)},Ji.prototype.touchmove=function(E,I,F){if(this._active)return E.preventDefault(),this._calculateTransform(E,I,F)},Ji.prototype.touchend=function(E,I,F){this._calculateTransform(E,I,F),this._active&&F.length<this._minTouches&&this.reset()},Ji.prototype.touchcancel=function(){this.reset()},Ji.prototype._calculateTransform=function(E,I,F){F.length>0&&(this._active=!0);var H=Jr(F,I),re=new e.Point(0,0),ue=new e.Point(0,0),ye=0;for(var ke in H){var Ee=H[ke],Ue=this._touches[ke];Ue&&(re._add(Ee),ue._add(Ee.sub(Ue)),ye++,H[ke]=Ee)}if(this._touches=H,!(ye<this._minTouches)&&ue.mag()){var $e=ue.div(ye);if(this._sum._add($e),!(this._sum.mag()<this._clickTolerance))return{around:re.div(ye),panDelta:$e}}},Ji.prototype.enable=function(){this._enabled=!0},Ji.prototype.disable=function(){this._enabled=!1,this.reset()},Ji.prototype.isEnabled=function(){return this._enabled},Ji.prototype.isActive=function(){return this._active};var Bi=function(){this.reset()};function ua(E,I,F){for(var H=0;H<E.length;H++)if(E[H].identifier===F)return I[H]}function gi(E,I){return Math.log(E/I)/Math.LN2}Bi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Bi.prototype._start=function(E){},Bi.prototype._move=function(E,I,F){return{}},Bi.prototype.touchstart=function(E,I,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([I[0],I[1]]))},Bi.prototype.touchmove=function(E,I,F){if(this._firstTwoTouches){E.preventDefault();var H=this._firstTwoTouches,ue=H[1],ye=ua(F,I,H[0]),ke=ua(F,I,ue);if(ye&&ke){var Ee=this._aroundCenter?null:ye.add(ke).div(2);return this._move([ye,ke],Ee,E)}}},Bi.prototype.touchend=function(E,I,F){if(this._firstTwoTouches){var H=this._firstTwoTouches,ue=H[1],ye=ua(F,I,H[0]),ke=ua(F,I,ue);ye&&ke||(this._active&&i.suppressClick(),this.reset())}},Bi.prototype.touchcancel=function(){this.reset()},Bi.prototype.enable=function(E){this._enabled=!0,this._aroundCenter=!!E&&"center"===E.around},Bi.prototype.disable=function(){this._enabled=!1,this.reset()},Bi.prototype.isEnabled=function(){return this._enabled},Bi.prototype.isActive=function(){return this._active};var aa=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.reset=function(){E.prototype.reset.call(this),delete this._distance,delete this._startDistance},I.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},I.prototype._move=function(F,H){var re=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(gi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gi(this._distance,re),pinchAround:H}},I}(Bi);function Qa(E,I){return 180*E.angleWith(I)/Math.PI}var Jo=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.reset=function(){E.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},I.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},I.prototype._move=function(F,H){var re=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qa(this._vector,re),pinchAround:H}},I.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var H=25/(Math.PI*this._minDiameter)*360,re=Qa(F,this._startVector);return Math.abs(re)<H},I}(Bi);function jo(E){return Math.abs(E.y)>Math.abs(E.x)}var To=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.reset=function(){E.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},I.prototype._start=function(F){this._lastPoints=F,jo(F[0].sub(F[1]))&&(this._valid=!1)},I.prototype._move=function(F,H,re){var ue=F[0].sub(this._lastPoints[0]),ye=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(ue,ye,re.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:(ue.y+ye.y)/2*-.5}},I.prototype.gestureBeginsVertically=function(F,H,re){if(void 0!==this._valid)return this._valid;var ue=F.mag()>=2,ye=H.mag()>=2;if(ue||ye){if(!ue||!ye)return void 0===this._firstMove&&(this._firstMove=re),re-this._firstMove<100&&void 0;var ke=F.y>0==H.y>0;return jo(F)&&jo(H)&&ke}},I}(Bi),Ei={panStep:100,bearingStep:15,pitchStep:10},ka=function(){var E=Ei;this._panStep=E.panStep,this._bearingStep=E.bearingStep,this._pitchStep=E.pitchStep};function ko(E){return E*(2-E)}ka.prototype.reset=function(){this._active=!1},ka.prototype.keydown=function(E){var I=this;if(!(E.altKey||E.ctrlKey||E.metaKey)){var F=0,H=0,re=0,ue=0,ye=0;switch(E.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:E.shiftKey?H=-1:(E.preventDefault(),ue=-1);break;case 39:E.shiftKey?H=1:(E.preventDefault(),ue=1);break;case 38:E.shiftKey?re=1:(E.preventDefault(),ye=-1);break;case 40:E.shiftKey?re=-1:(E.preventDefault(),ye=1);break;default:return}return{cameraAnimation:function(ke){var Ee=ke.getZoom();ke.easeTo({duration:300,easeId:"keyboardHandler",easing:ko,zoom:F?Math.round(Ee)+F*(E.shiftKey?2:1):Ee,bearing:ke.getBearing()+H*I._bearingStep,pitch:ke.getPitch()+re*I._pitchStep,offset:[-ue*I._panStep,-ye*I._panStep],center:ke.getCenter()},{originalEvent:E})}}}},ka.prototype.enable=function(){this._enabled=!0},ka.prototype.disable=function(){this._enabled=!1,this.reset()},ka.prototype.isEnabled=function(){return this._enabled},ka.prototype.isActive=function(){return this._active};var oa=function(E,I){this._map=E,this._el=E.getCanvasContainer(),this._handler=I,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};oa.prototype.setZoomRate=function(E){this._defaultZoomRate=E},oa.prototype.setWheelZoomRate=function(E){this._wheelZoomRate=E},oa.prototype.isEnabled=function(){return!!this._enabled},oa.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},oa.prototype.isZooming=function(){return!!this._zooming},oa.prototype.enable=function(E){this.isEnabled()||(this._enabled=!0,this._aroundCenter=E&&"center"===E.around)},oa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},oa.prototype.wheel=function(E){if(this.isEnabled()){var I=E.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*E.deltaY:E.deltaY,F=e.browser.now(),H=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,0!==I&&I%4.000244140625==0?this._type="wheel":0!==I&&Math.abs(I)<4?this._type="trackpad":H>400?(this._type=null,this._lastValue=I,this._timeout=setTimeout(this._onTimeout,40,E)):this._type||(this._type=Math.abs(H*I)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,I+=this._lastValue)),E.shiftKey&&I&&(I/=4),this._type&&(this._lastWheelEvent=E,this._delta-=I,this._active||this._start(E)),E.preventDefault()}},oa.prototype._onTimeout=function(E){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(E)},oa.prototype._start=function(E){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var I=i.mousePos(this._el,E);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(I)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},oa.prototype.renderFrame=function(){return this._onScrollFrame()},oa.prototype._onScrollFrame=function(){var E=this;if(this._frameId&&(this._frameId=null,this.isActive())){var I=this._map.transform;if(0!==this._delta){var F="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,H=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&0!==H&&(H=1/H);var re="number"==typeof this._targetZoom?I.zoomScale(this._targetZoom):I.scale;this._targetZoom=Math.min(I.maxZoom,Math.max(I.minZoom,I.scaleZoom(re*H))),"wheel"===this._type&&(this._startZoom=I.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var ue,ye="number"==typeof this._targetZoom?this._targetZoom:I.zoom,ke=this._startZoom,Ee=this._easing,Ue=!1;if("wheel"===this._type&&ke&&Ee){var $e=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),it=Ee($e);ue=e.number(ke,ye,it),$e<1?this._frameId||(this._frameId=!0):Ue=!0}else ue=ye,Ue=!0;return this._active=!0,Ue&&(this._active=!1,this._finishTimeout=setTimeout(function(){E._zooming=!1,E._handler._triggerRenderFrame(),delete E._targetZoom,delete E._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ue,zoomDelta:ue-I.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},oa.prototype._smoothOutEasing=function(E){var I=e.ease;if(this._prevEase){var F=this._prevEase,H=(e.browser.now()-F.start)/F.duration,re=F.easing(H+.01)-F.easing(H),ue=.27/Math.sqrt(re*re+1e-4)*.01,ye=Math.sqrt(.0729-ue*ue);I=e.bezier(ue,ye,.25,1)}return this._prevEase={start:e.browser.now(),duration:E,easing:I},I},oa.prototype.reset=function(){this._active=!1};var Pa=function(E,I){this._clickZoom=E,this._tapZoom=I};Pa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Pa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Pa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Pa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var eo=function(){this.reset()};eo.prototype.reset=function(){this._active=!1},eo.prototype.dblclick=function(E,I){return E.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(E.shiftKey?-1:1),around:F.unproject(I)},{originalEvent:E})}}},eo.prototype.enable=function(){this._enabled=!0},eo.prototype.disable=function(){this._enabled=!1,this.reset()},eo.prototype.isEnabled=function(){return this._enabled},eo.prototype.isActive=function(){return this._active};var pa=function(){this._tap=new Pi({numTouches:1,numTaps:1}),this.reset()};pa.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},pa.prototype.touchstart=function(E,I,F){this._swipePoint||(this._tapTime&&E.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=I[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(E,I,F))},pa.prototype.touchmove=function(E,I,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var H=I[0],re=H.y-this._swipePoint.y;return this._swipePoint=H,E.preventDefault(),this._active=!0,{zoomDelta:re/128}}}else this._tap.touchmove(E,I,F)},pa.prototype.touchend=function(E,I,F){this._tapTime?this._swipePoint&&0===F.length&&this.reset():this._tap.touchend(E,I,F)&&(this._tapTime=E.timeStamp)},pa.prototype.touchcancel=function(){this.reset()},pa.prototype.enable=function(){this._enabled=!0},pa.prototype.disable=function(){this._enabled=!1,this.reset()},pa.prototype.isEnabled=function(){return this._enabled},pa.prototype.isActive=function(){return this._active};var xo=function(E,I,F){this._el=E,this._mousePan=I,this._touchPan=F};xo.prototype.enable=function(E){this._inertiaOptions=E||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},xo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},xo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},xo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var fa=function(E,I,F){this._pitchWithRotate=E.pitchWithRotate,this._mouseRotate=I,this._mousePitch=F};fa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},fa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},fa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},fa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ho=function(E,I,F,H){this._el=E,this._touchZoom=I,this._touchRotate=F,this._tapDragZoom=H,this._rotationDisabled=!1,this._enabled=!0};ho.prototype.enable=function(E){this._touchZoom.enable(E),this._rotationDisabled||this._touchRotate.enable(E),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ho.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ho.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ho.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ho.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ho.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var cs=function(E){return E.zoom||E.drag||E.pitch||E.rotate},rs=function(E){function I(){E.apply(this,arguments)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I}(e.Event);function Es(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta}var ja=function(E,I){this._map=E,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ir(E),this._bearingSnap=I.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(I),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var H=0,re=this._listeners;H<re.length;H+=1){var ue=re[H],ye=ue[0];i.addEventListener(ye,ue[1],ye===e.window.document?this.handleWindowEvent:this.handleEvent,ue[2])}};ja.prototype.destroy=function(){for(var E=0,I=this._listeners;E<I.length;E+=1){var F=I[E],H=F[0];i.removeEventListener(H,F[1],H===e.window.document?this.handleWindowEvent:this.handleEvent,F[2])}},ja.prototype._addDefaultHandlers=function(E){var I=this._map,F=I.getCanvasContainer();this._add("mapEvent",new nr(I,E));var H=I.boxZoom=new Hr(I,E);this._add("boxZoom",H);var re=new Vi,ue=new eo;I.doubleClickZoom=new Pa(ue,re),this._add("tapZoom",re),this._add("clickZoom",ue);var ye=new pa;this._add("tapDragZoom",ye);var ke=I.touchPitch=new To;this._add("touchPitch",ke);var Ee=new Ui(E),Ue=new Mi(E);I.dragRotate=new fa(E,Ee,Ue),this._add("mouseRotate",Ee,["mousePitch"]),this._add("mousePitch",Ue,["mouseRotate"]);var $e=new Wi(E),it=new Ji(E);I.dragPan=new xo(F,$e,it),this._add("mousePan",$e),this._add("touchPan",it,["touchZoom","touchRotate"]);var _t=new Jo,Ct=new aa;I.touchZoomRotate=new ho(F,Ct,_t,ye),this._add("touchRotate",_t,["touchPan","touchZoom"]),this._add("touchZoom",Ct,["touchPan","touchRotate"]);var At=I.scrollZoom=new oa(I,this);this._add("scrollZoom",At,["mousePan"]);var Et=I.keyboard=new ka;this._add("keyboard",Et),this._add("blockableMapEvent",new mi(I));for(var Tt=0,jt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Tt<jt.length;Tt+=1){var Nt=jt[Tt];E.interactive&&E[Nt]&&I[Nt].enable(E[Nt])}},ja.prototype._add=function(E,I,F){this._handlers.push({handlerName:E,handler:I,allowed:F}),this._handlersById[E]=I},ja.prototype.stop=function(){if(!this._updatingCamera){for(var E=0,I=this._handlers;E<I.length;E+=1)I[E].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},ja.prototype.isActive=function(){for(var E=0,I=this._handlers;E<I.length;E+=1)if(I[E].handler.isActive())return!0;return!1},ja.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ja.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ja.prototype.isMoving=function(){return Boolean(cs(this._eventsInProgress))||this.isZooming()},ja.prototype._blockedByActive=function(E,I,F){for(var H in E)if(H!==F&&(!I||I.indexOf(H)<0))return!0;return!1},ja.prototype.handleWindowEvent=function(E){this.handleEvent(E,E.type+"Window")},ja.prototype._getMapTouches=function(E){for(var I=[],F=0,H=E;F<H.length;F+=1){var re=H[F];this._el.contains(re.target)&&I.push(re)}return I},ja.prototype.handleEvent=function(E,I){if("blur"!==E.type){this._updatingCamera=!0;for(var F="renderFrame"===E.type?void 0:E,H={needsRenderFrame:!1},re={},ue={},ye=E.touches?this._getMapTouches(E.touches):void 0,ke=ye?i.touchPos(this._el,ye):i.mousePos(this._el,E),Ee=0,Ue=this._handlers;Ee<Ue.length;Ee+=1){var $e=Ue[Ee],it=$e.handlerName,_t=$e.handler,Ct=$e.allowed;if(_t.isEnabled()){var At=void 0;this._blockedByActive(ue,Ct,it)?_t.reset():_t[I||E.type]&&(At=_t[I||E.type](E,ke,ye),this.mergeHandlerResult(H,re,At,it,F),At&&At.needsRenderFrame&&this._triggerRenderFrame()),(At||_t.isActive())&&(ue[it]=_t)}}var Et={};for(var Tt in this._previousActiveHandlers)ue[Tt]||(Et[Tt]=F);this._previousActiveHandlers=ue,(Object.keys(Et).length||Es(H))&&(this._changes.push([H,re,Et]),this._triggerRenderFrame()),(Object.keys(ue).length||Es(H))&&this._map._stop(!0),this._updatingCamera=!1;var jt=H.cameraAnimation;jt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],jt(this._map))}else this.stop()},ja.prototype.mergeHandlerResult=function(E,I,F,H,re){if(F){e.extend(E,F);var ue={handlerName:H,originalEvent:F.originalEvent||re};void 0!==F.zoomDelta&&(I.zoom=ue),void 0!==F.panDelta&&(I.drag=ue),void 0!==F.pitchDelta&&(I.pitch=ue),void 0!==F.bearingDelta&&(I.rotate=ue)}},ja.prototype._applyChanges=function(){for(var E={},I={},F={},H=0,re=this._changes;H<re.length;H+=1){var ue=re[H],ye=ue[0],ke=ue[1],Ee=ue[2];ye.panDelta&&(E.panDelta=(E.panDelta||new e.Point(0,0))._add(ye.panDelta)),ye.zoomDelta&&(E.zoomDelta=(E.zoomDelta||0)+ye.zoomDelta),ye.bearingDelta&&(E.bearingDelta=(E.bearingDelta||0)+ye.bearingDelta),ye.pitchDelta&&(E.pitchDelta=(E.pitchDelta||0)+ye.pitchDelta),void 0!==ye.around&&(E.around=ye.around),void 0!==ye.pinchAround&&(E.pinchAround=ye.pinchAround),ye.noInertia&&(E.noInertia=ye.noInertia),e.extend(I,ke),e.extend(F,Ee)}this._updateMapTransform(E,I,F),this._changes=[]},ja.prototype._updateMapTransform=function(E,I,F){var H=this._map,re=H.transform;if(!Es(E))return this._fireEvents(I,F);var ue=E.panDelta,ye=E.zoomDelta,ke=E.bearingDelta,Ee=E.pitchDelta,Ue=E.around,$e=E.pinchAround;void 0!==$e&&(Ue=$e),H._stop(!0),Ue=Ue||H.transform.centerPoint;var it=re.pointLocation(ue?Ue.sub(ue):Ue);ke&&(re.bearing+=ke),Ee&&(re.pitch+=Ee),ye&&(re.zoom+=ye),re.setLocationAtPoint(it,Ue),this._map._update(),E.noInertia||this._inertia.record(E),this._fireEvents(I,F)},ja.prototype._fireEvents=function(E,I){var F=this,H=cs(this._eventsInProgress),re=cs(E),ue={};for(var ye in E)this._eventsInProgress[ye]||(ue[ye+"start"]=E[ye].originalEvent),this._eventsInProgress[ye]=E[ye];for(var Ee in!H&&re&&this._fireEvent("movestart",re.originalEvent),ue)this._fireEvent(Ee,ue[Ee]);for(var Ue in E.rotate&&(this._bearingChanged=!0),re&&this._fireEvent("move",re.originalEvent),E)this._fireEvent(Ue,E[Ue].originalEvent);var it,_t={};for(var Ct in this._eventsInProgress){var At=this._eventsInProgress[Ct],Et=At.handlerName,Tt=At.originalEvent;this._handlersById[Et].isActive()||(delete this._eventsInProgress[Ct],_t[Ct+"end"]=it=I[Et]||Tt)}for(var jt in _t)this._fireEvent(jt,_t[jt]);var Nt=cs(this._eventsInProgress);if((H||re)&&!Nt){this._updatingCamera=!0;var Yt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ln=function(bn){return 0!==bn&&-F._bearingSnap<bn&&bn<F._bearingSnap};Yt?(ln(Yt.bearing||this._map.getBearing())&&(Yt.bearing=0),this._map.easeTo(Yt,{originalEvent:it})):(this._map.fire(new e.Event("moveend",{originalEvent:it})),ln(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},ja.prototype._fireEvent=function(E,I){this._map.fire(new e.Event(E,I?{originalEvent:I}:{}))},ja.prototype._triggerRenderFrame=function(){var E=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(I){delete E._frameId,E.handleEvent(new rs("renderFrame",{timeStamp:I})),E._applyChanges()}))};var Ls=function(E){function I(F,H){E.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=H.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},I.prototype.setCenter=function(F,H){return this.jumpTo({center:F},H)},I.prototype.panBy=function(F,H,re){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},H),re)},I.prototype.panTo=function(F,H,re){return this.easeTo(e.extend({center:F},H),re)},I.prototype.getZoom=function(){return this.transform.zoom},I.prototype.setZoom=function(F,H){return this.jumpTo({zoom:F},H),this},I.prototype.zoomTo=function(F,H,re){return this.easeTo(e.extend({zoom:F},H),re)},I.prototype.zoomIn=function(F,H){return this.zoomTo(this.getZoom()+1,F,H),this},I.prototype.zoomOut=function(F,H){return this.zoomTo(this.getZoom()-1,F,H),this},I.prototype.getBearing=function(){return this.transform.bearing},I.prototype.setBearing=function(F,H){return this.jumpTo({bearing:F},H),this},I.prototype.getPadding=function(){return this.transform.padding},I.prototype.setPadding=function(F,H){return this.jumpTo({padding:F},H),this},I.prototype.rotateTo=function(F,H,re){return this.easeTo(e.extend({bearing:F},H),re)},I.prototype.resetNorth=function(F,H){return this.rotateTo(0,e.extend({duration:1e3},F),H),this},I.prototype.resetNorthPitch=function(F,H){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),H),this},I.prototype.snapToNorth=function(F,H){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,H):this},I.prototype.getPitch=function(){return this.transform.pitch},I.prototype.setPitch=function(F,H){return this.jumpTo({pitch:F},H),this},I.prototype.cameraForBounds=function(F,H){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,H)},I.prototype._cameraForBoxAndBearing=function(F,H,re,ue){var ye={top:0,bottom:0,right:0,left:0};if("number"==typeof(ue=e.extend({padding:ye,offset:[0,0],maxZoom:this.transform.maxZoom},ue)).padding){var ke=ue.padding;ue.padding={top:ke,bottom:ke,right:ke,left:ke}}ue.padding=e.extend(ye,ue.padding);var Ee=this.transform,Ue=Ee.padding,$e=Ee.project(e.LngLat.convert(F)),it=Ee.project(e.LngLat.convert(H)),_t=$e.rotate(-re*Math.PI/180),Ct=it.rotate(-re*Math.PI/180),At=new e.Point(Math.max(_t.x,Ct.x),Math.max(_t.y,Ct.y)),Et=new e.Point(Math.min(_t.x,Ct.x),Math.min(_t.y,Ct.y)),Tt=At.sub(Et),jt=(Ee.width-(Ue.left+Ue.right+ue.padding.left+ue.padding.right))/Tt.x,Nt=(Ee.height-(Ue.top+Ue.bottom+ue.padding.top+ue.padding.bottom))/Tt.y;if(!(Nt<0||jt<0)){var Yt=Math.min(Ee.scaleZoom(Ee.scale*Math.min(jt,Nt)),ue.maxZoom),ln=e.Point.convert(ue.offset),En=new e.Point(ln.x+(ue.padding.left-ue.padding.right)/2,ln.y+(ue.padding.top-ue.padding.bottom)/2).mult(Ee.scale/Ee.zoomScale(Yt));return{center:Ee.unproject($e.add(it).div(2).sub(En)),zoom:Yt,bearing:re}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},I.prototype.fitBounds=function(F,H,re){return this._fitInternal(this.cameraForBounds(F,H),H,re)},I.prototype.fitScreenCoordinates=function(F,H,re,ue,ye){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(H)),re,ue),ue,ye)},I.prototype._fitInternal=function(F,H,re){return F?(delete(H=e.extend(F,H)).padding,H.linear?this.easeTo(H,re):this.flyTo(H,re)):this},I.prototype.jumpTo=function(F,H){this.stop();var re=this.transform,ue=!1,ye=!1,ke=!1;return"zoom"in F&&re.zoom!==+F.zoom&&(ue=!0,re.zoom=+F.zoom),void 0!==F.center&&(re.center=e.LngLat.convert(F.center)),"bearing"in F&&re.bearing!==+F.bearing&&(ye=!0,re.bearing=+F.bearing),"pitch"in F&&re.pitch!==+F.pitch&&(ke=!0,re.pitch=+F.pitch),null==F.padding||re.isPaddingEqual(F.padding)||(re.padding=F.padding),this.fire(new e.Event("movestart",H)).fire(new e.Event("move",H)),ue&&this.fire(new e.Event("zoomstart",H)).fire(new e.Event("zoom",H)).fire(new e.Event("zoomend",H)),ye&&this.fire(new e.Event("rotatestart",H)).fire(new e.Event("rotate",H)).fire(new e.Event("rotateend",H)),ke&&this.fire(new e.Event("pitchstart",H)).fire(new e.Event("pitch",H)).fire(new e.Event("pitchend",H)),this.fire(new e.Event("moveend",H))},I.prototype.easeTo=function(F,H){var re=this;this._stop(!1,F.easeId),(!1===(F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var ue=this.transform,ye=this.getZoom(),ke=this.getBearing(),Ee=this.getPitch(),Ue=this.getPadding(),$e="zoom"in F?+F.zoom:ye,it="bearing"in F?this._normalizeBearing(F.bearing,ke):ke,_t="pitch"in F?+F.pitch:Ee,Ct="padding"in F?F.padding:ue.padding,At=e.Point.convert(F.offset),Et=ue.centerPoint.add(At),Tt=ue.pointLocation(Et),jt=e.LngLat.convert(F.center||Tt);this._normalizeCenter(jt);var Nt,Yt,ln=ue.project(Tt),bn=ue.project(jt).sub(ln),In=ue.zoomScale($e-ye);F.around&&(Nt=e.LngLat.convert(F.around),Yt=ue.locationPoint(Nt));var En={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$e!==ye,this._rotating=this._rotating||ke!==it,this._pitching=this._pitching||_t!==Ee,this._padding=!ue.isPaddingEqual(Ct),this._easeId=F.easeId,this._prepareEase(H,F.noMoveStart,En),clearTimeout(this._easeEndTimeoutID),this._ease(function(ir){if(re._zooming&&(ue.zoom=e.number(ye,$e,ir)),re._rotating&&(ue.bearing=e.number(ke,it,ir)),re._pitching&&(ue.pitch=e.number(Ee,_t,ir)),re._padding&&(ue.interpolatePadding(Ue,Ct,ir),Et=ue.centerPoint.add(At)),Nt)ue.setLocationAtPoint(Nt,Yt);else{var rr=ue.zoomScale(ue.zoom-ye),_r=$e>ye?Math.min(2,In):Math.max(.5,In),pr=Math.pow(_r,1-ir),Qr=ue.unproject(ln.add(bn.mult(ir*pr)).mult(rr));ue.setLocationAtPoint(ue.renderWorldCopies?Qr.wrap():Qr,Et)}re._fireMoveEvents(H)},function(ir){re._afterEase(H,ir)},F),this},I.prototype._prepareEase=function(F,H,re){void 0===re&&(re={}),this._moving=!0,H||re.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!re.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!re.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!re.pitching&&this.fire(new e.Event("pitchstart",F))},I.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},I.prototype._afterEase=function(F,H){if(!this._easeId||!H||this._easeId!==H){delete this._easeId;var re=this._zooming,ue=this._rotating,ye=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,re&&this.fire(new e.Event("zoomend",F)),ue&&this.fire(new e.Event("rotateend",F)),ye&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},I.prototype.flyTo=function(F,H){var re=this;if(!F.essential&&e.browser.prefersReducedMotion){var ue=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ue,H)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var ye=this.transform,ke=this.getZoom(),Ee=this.getBearing(),Ue=this.getPitch(),$e=this.getPadding(),it="zoom"in F?e.clamp(+F.zoom,ye.minZoom,ye.maxZoom):ke,_t="bearing"in F?this._normalizeBearing(F.bearing,Ee):Ee,Ct="pitch"in F?+F.pitch:Ue,At="padding"in F?F.padding:ye.padding,Et=ye.zoomScale(it-ke),Tt=e.Point.convert(F.offset),jt=ye.centerPoint.add(Tt),Nt=ye.pointLocation(jt),Yt=e.LngLat.convert(F.center||Nt);this._normalizeCenter(Yt);var ln=ye.project(Nt),bn=ye.project(Yt).sub(ln),In=F.curve,En=Math.max(ye.width,ye.height),ir=En/Et,rr=bn.mag();if("minZoom"in F){var _r=e.clamp(Math.min(F.minZoom,ke,it),ye.minZoom,ye.maxZoom),pr=En/ye.zoomScale(_r-ke);In=Math.sqrt(pr/rr*2)}var Qr=In*In;function li(ui){var Oi=(ir*ir-En*En+(ui?-1:1)*Qr*Qr*rr*rr)/(2*(ui?ir:En)*Qr*rr);return Math.log(Math.sqrt(Oi*Oi+1)-Oi)}function xi(ui){return(Math.exp(ui)-Math.exp(-ui))/2}function Wn(ui){return(Math.exp(ui)+Math.exp(-ui))/2}var Rr=li(0),oi=function(ui){return Wn(Rr)/Wn(Rr+In*ui)},ti=function(ui){return En*((Wn(Rr)*(xi(Oi=Rr+In*ui)/Wn(Oi))-xi(Rr))/Qr)/rr;var Oi},vi=(li(1)-Rr)/In;if(Math.abs(rr)<1e-6||!isFinite(vi)){if(Math.abs(En-ir)<1e-6)return this.easeTo(F,H);var ki=ir<En?-1:1;vi=Math.abs(Math.log(ir/En))/In,ti=function(){return 0},oi=function(ui){return Math.exp(ki*In*ui)}}return F.duration="duration"in F?+F.duration:1e3*vi/("screenSpeed"in F?+F.screenSpeed/In:+F.speed),F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Ee!==_t,this._pitching=Ct!==Ue,this._padding=!ye.isPaddingEqual(At),this._prepareEase(H,!1),this._ease(function(ui){var Oi=ui*vi,zi=1/oi(Oi);ye.zoom=1===ui?it:ke+ye.scaleZoom(zi),re._rotating&&(ye.bearing=e.number(Ee,_t,ui)),re._pitching&&(ye.pitch=e.number(Ue,Ct,ui)),re._padding&&(ye.interpolatePadding($e,At,ui),jt=ye.centerPoint.add(Tt));var qi=1===ui?Yt:ye.unproject(ln.add(bn.mult(ti(Oi))).mult(zi));ye.setLocationAtPoint(ye.renderWorldCopies?qi.wrap():qi,jt),re._fireMoveEvents(H)},function(){return re._afterEase(H)},F),this},I.prototype.isEasing=function(){return!!this._easeFrameId},I.prototype.stop=function(){return this._stop()},I.prototype._stop=function(F,H){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var re=this._onEaseEnd;delete this._onEaseEnd,re.call(this,H)}if(!F){var ue=this.handlers;ue&&ue.stop()}return this},I.prototype._ease=function(F,H,re){!1===re.animate||0===re.duration?(F(1),H()):(this._easeStart=e.browser.now(),this._easeOptions=re,this._onEaseFrame=F,this._onEaseEnd=H,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},I.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},I.prototype._normalizeBearing=function(F,H){F=e.wrap(F,-180,180);var re=Math.abs(F-H);return Math.abs(F-360-H)<re&&(F-=360),Math.abs(F+360-H)<re&&(F+=360),F},I.prototype._normalizeCenter=function(F){var H=this.transform;if(H.renderWorldCopies&&!H.lngRange){var re=F.lng-H.center.lng;F.lng+=re>180?-360:re<-180?360:0}},I}(e.Evented),Ua=function(E){void 0===E&&(E={}),this.options=E,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ua.prototype.getDefaultPosition=function(){return"bottom-right"},Ua.prototype.onAdd=function(E){var I=this.options&&this.options.compact;return this._map=E,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=i.create("div","mapboxgl-ctrl-attrib-inner",this._container),I&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===I&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ua.prototype.onRemove=function(){i.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ua.prototype._updateEditLink=function(){var E=this._editLink;E||(E=this._editLink=this._container.querySelector(".mapbox-improve-map"));var I=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(E){var F=I.reduce(function(H,re,ue){return re.value&&(H+=re.key+"="+re.value+(ue<I.length-1?"&":"")),H},"?");E.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),E.rel="noopener nofollow"}},Ua.prototype._updateData=function(E){!E||"metadata"!==E.sourceDataType&&"style"!==E.dataType||(this._updateAttributions(),this._updateEditLink())},Ua.prototype._updateAttributions=function(){if(this._map.style){var E=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?E=E.concat(this.options.customAttribution.map(function(ke){return"string"!=typeof ke?"":ke})):"string"==typeof this.options.customAttribution&&E.push(this.options.customAttribution)),this._map.style.stylesheet){var I=this._map.style.stylesheet;this.styleOwner=I.owner,this.styleId=I.id}var F=this._map.style.sourceCaches;for(var H in F){var re=F[H];if(re.used){var ue=re.getSource();ue.attribution&&E.indexOf(ue.attribution)<0&&E.push(ue.attribution)}}E.sort(function(ke,Ee){return ke.length-Ee.length});var ye=(E=E.filter(function(ke,Ee){for(var Ue=Ee+1;Ue<E.length;Ue++)if(E[Ue].indexOf(ke)>=0)return!1;return!0})).join(" | ");ye!==this._attribHTML&&(this._attribHTML=ye,E.length?(this._innerContainer.innerHTML=ye,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ua.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var is=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};is.prototype.onAdd=function(E){this._map=E,this._container=i.create("div","mapboxgl-ctrl");var I=i.create("a","mapboxgl-ctrl-logo");return I.target="_blank",I.rel="noopener nofollow",I.href="https://www.mapbox.com/",I.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),I.setAttribute("rel","noopener nofollow"),this._container.appendChild(I),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},is.prototype.onRemove=function(){i.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},is.prototype.getDefaultPosition=function(){return"bottom-left"},is.prototype._updateLogo=function(E){E&&"metadata"!==E.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},is.prototype._logoRequired=function(){if(this._map.style){var E=this._map.style.sourceCaches;for(var I in E)if(E[I].getSource().mapbox_logo)return!0;return!1}},is.prototype._updateCompact=function(){var E=this._container.children;if(E.length){var I=E[0];this._map.getCanvasContainer().offsetWidth<250?I.classList.add("mapboxgl-compact"):I.classList.remove("mapboxgl-compact")}};var Ti=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ti.prototype.add=function(E){var I=++this._id;return this._queue.push({callback:E,id:I,cancelled:!1}),I},Ti.prototype.remove=function(E){for(var I=this._currentlyRunning,F=0,H=I?this._queue.concat(I):this._queue;F<H.length;F+=1){var re=H[F];if(re.id===E)return void(re.cancelled=!0)}},Ti.prototype.run=function(E){void 0===E&&(E=0);var I=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,H=I;F<H.length;F+=1){var re=H[F];if(!re.cancelled&&(re.callback(E),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ti.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Li={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},zs=e.window.HTMLImageElement,Ps=e.window.HTMLElement,as=e.window.ImageBitmap,Oo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Zo=function(E){function I(H){var re=this;if(null!=(H=e.extend({},Oo,H)).minZoom&&null!=H.maxZoom&&H.minZoom>H.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=H.minPitch&&null!=H.maxPitch&&H.minPitch>H.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=H.minPitch&&H.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=H.maxPitch&&H.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var ue=new Xt(H.minZoom,H.maxZoom,H.minPitch,H.maxPitch,H.renderWorldCopies);if(E.call(this,ue,H),this._interactive=H.interactive,this._maxTileCacheSize=H.maxTileCacheSize,this._failIfMajorPerformanceCaveat=H.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=H.preserveDrawingBuffer,this._antialias=H.antialias,this._trackResize=H.trackResize,this._bearingSnap=H.bearingSnap,this._refreshExpiredTiles=H.refreshExpiredTiles,this._fadeDuration=H.fadeDuration,this._crossSourceCollisions=H.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=H.collectResourceTiming,this._renderTaskQueue=new Ti,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Li,H.locale),this._requestManager=new e.RequestManager(H.transformRequest,H.accessToken),"string"==typeof H.container){if(this._container=e.window.document.getElementById(H.container),!this._container)throw new Error("Container '"+H.container+"' not found.")}else{if(!(H.container instanceof Ps))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=H.container}if(H.maxBounds&&this.setMaxBounds(H.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return re._update(!1)}),this.on("moveend",function(){return re._update(!1)}),this.on("zoom",function(){return re._update(!0)}),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new ja(this,H),this._hash=H.hash&&new Fn("string"==typeof H.hash&&H.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:H.center,zoom:H.zoom,bearing:H.bearing,pitch:H.pitch}),H.bounds&&(this.resize(),this.fitBounds(H.bounds,e.extend({},H.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=H.localIdeographFontFamily,H.style&&this.setStyle(H.style,{localIdeographFontFamily:H.localIdeographFontFamily}),H.attributionControl&&this.addControl(new Ua({customAttribution:H.customAttribution})),this.addControl(new is,H.logoPosition),this.on("style.load",function(){re.transform.unmodified&&re.jumpTo(re.style.stylesheet)}),this.on("data",function(ke){re._update("style"===ke.dataType),re.fire(new e.Event(ke.dataType+"data",ke))}),this.on("dataloading",function(ke){re.fire(new e.Event(ke.dataType+"dataloading",ke))})}E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return I.prototype._getMapId=function(){return this._mapId},I.prototype.addControl=function(H,re){if(void 0===re&&H.getDefaultPosition&&(re=H.getDefaultPosition()),void 0===re&&(re="top-right"),!H||!H.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var ue=H.onAdd(this);this._controls.push(H);var ye=this._controlPositions[re];return-1!==re.indexOf("bottom")?ye.insertBefore(ue,ye.firstChild):ye.appendChild(ue),this},I.prototype.removeControl=function(H){if(!H||!H.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var re=this._controls.indexOf(H);return re>-1&&this._controls.splice(re,1),H.onRemove(this),this},I.prototype.resize=function(H){var re=this._containerDimensions(),ue=re[0],ye=re[1];this._resizeCanvas(ue,ye),this.transform.resize(ue,ye),this.painter.resize(ue,ye);var ke=!this._moving;return ke&&(this.stop(),this.fire(new e.Event("movestart",H)).fire(new e.Event("move",H))),this.fire(new e.Event("resize",H)),ke&&this.fire(new e.Event("moveend",H)),this},I.prototype.getBounds=function(){return this.transform.getBounds()},I.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},I.prototype.setMaxBounds=function(H){return this.transform.setMaxBounds(e.LngLatBounds.convert(H)),this._update()},I.prototype.setMinZoom=function(H){if((H=null==H?-2:H)>=-2&&H<=this.transform.maxZoom)return this.transform.minZoom=H,this._update(),this.getZoom()<H&&this.setZoom(H),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},I.prototype.getMinZoom=function(){return this.transform.minZoom},I.prototype.setMaxZoom=function(H){if((H=null==H?22:H)>=this.transform.minZoom)return this.transform.maxZoom=H,this._update(),this.getZoom()>H&&this.setZoom(H),this;throw new Error("maxZoom must be greater than the current minZoom")},I.prototype.getMaxZoom=function(){return this.transform.maxZoom},I.prototype.setMinPitch=function(H){if((H=null==H?0:H)<0)throw new Error("minPitch must be greater than or equal to 0");if(H>=0&&H<=this.transform.maxPitch)return this.transform.minPitch=H,this._update(),this.getPitch()<H&&this.setPitch(H),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},I.prototype.getMinPitch=function(){return this.transform.minPitch},I.prototype.setMaxPitch=function(H){if((H=null==H?60:H)>60)throw new Error("maxPitch must be less than or equal to 60");if(H>=this.transform.minPitch)return this.transform.maxPitch=H,this._update(),this.getPitch()>H&&this.setPitch(H),this;throw new Error("maxPitch must be greater than the current minPitch")},I.prototype.getMaxPitch=function(){return this.transform.maxPitch},I.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},I.prototype.setRenderWorldCopies=function(H){return this.transform.renderWorldCopies=H,this._update()},I.prototype.project=function(H){return this.transform.locationPoint(e.LngLat.convert(H))},I.prototype.unproject=function(H){return this.transform.pointLocation(e.Point.convert(H))},I.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},I.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},I.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},I.prototype._createDelegatedListener=function(H,re,ue){var ye,ke=this;if("mouseenter"===H||"mouseover"===H){var Ee=!1;return{layer:re,listener:ue,delegates:{mousemove:function($e){var it=ke.getLayer(re)?ke.queryRenderedFeatures($e.point,{layers:[re]}):[];it.length?Ee||(Ee=!0,ue.call(ke,new Zr(H,ke,$e.originalEvent,{features:it}))):Ee=!1},mouseout:function(){Ee=!1}}}}if("mouseleave"===H||"mouseout"===H){var Ue=!1;return{layer:re,listener:ue,delegates:{mousemove:function($e){(ke.getLayer(re)?ke.queryRenderedFeatures($e.point,{layers:[re]}):[]).length?Ue=!0:Ue&&(Ue=!1,ue.call(ke,new Zr(H,ke,$e.originalEvent)))},mouseout:function($e){Ue&&(Ue=!1,ue.call(ke,new Zr(H,ke,$e.originalEvent)))}}}}return{layer:re,listener:ue,delegates:(ye={},ye[H]=function($e){var it=ke.getLayer(re)?ke.queryRenderedFeatures($e.point,{layers:[re]}):[];it.length&&($e.features=it,ue.call(ke,$e),delete $e.features)},ye)}},I.prototype.on=function(H,re,ue){if(void 0===ue)return E.prototype.on.call(this,H,re);var ye=this._createDelegatedListener(H,re,ue);for(var ke in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[H]=this._delegatedListeners[H]||[],this._delegatedListeners[H].push(ye),ye.delegates)this.on(ke,ye.delegates[ke]);return this},I.prototype.once=function(H,re,ue){if(void 0===ue)return E.prototype.once.call(this,H,re);var ye=this._createDelegatedListener(H,re,ue);for(var ke in ye.delegates)this.once(ke,ye.delegates[ke]);return this},I.prototype.off=function(H,re,ue){var ye=this;return void 0===ue?E.prototype.off.call(this,H,re):(this._delegatedListeners&&this._delegatedListeners[H]&&function(ke){for(var Ee=ke[H],Ue=0;Ue<Ee.length;Ue++){var $e=Ee[Ue];if($e.layer===re&&$e.listener===ue){for(var it in $e.delegates)ye.off(it,$e.delegates[it]);return Ee.splice(Ue,1),ye}}}(this._delegatedListeners),this)},I.prototype.queryRenderedFeatures=function(H,re){if(!this.style)return[];var ue;if(void 0!==re||void 0===H||H instanceof e.Point||Array.isArray(H)||(re=H,H=void 0),re=re||{},(H=H||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof H[0])ue=[e.Point.convert(H)];else{var ye=e.Point.convert(H[0]),ke=e.Point.convert(H[1]);ue=[ye,new e.Point(ke.x,ye.y),ke,new e.Point(ye.x,ke.y),ye]}return this.style.queryRenderedFeatures(ue,re,this.transform)},I.prototype.querySourceFeatures=function(H,re){return this.style.querySourceFeatures(H,re)},I.prototype.setStyle=function(H,re){return!1!==(re=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},re)).diff&&re.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&H?(this._diffStyle(H,re),this):(this._localIdeographFontFamily=re.localIdeographFontFamily,this._updateStyle(H,re))},I.prototype._getUIString=function(H){var re=this._locale[H];if(null==re)throw new Error("Missing UI string '"+H+"'");return re},I.prototype._updateStyle=function(H,re){return this.style&&(this.style.setEventedParent(null),this.style._remove()),H?(this.style=new Pr(this,re||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof H?this.style.loadURL(H):this.style.loadJSON(H),this):(delete this.style,this)},I.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Pr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},I.prototype._diffStyle=function(H,re){var ue=this;if("string"==typeof H){var ye=this._requestManager.normalizeStyleURL(H),ke=this._requestManager.transformRequest(ye,e.ResourceType.Style);e.getJSON(ke,function(Ee,Ue){Ee?ue.fire(new e.ErrorEvent(Ee)):Ue&&ue._updateDiff(Ue,re)})}else"object"==typeof H&&this._updateDiff(H,re)},I.prototype._updateDiff=function(H,re){try{this.style.setState(H)&&this._update(!0)}catch(ue){e.warnOnce("Unable to perform style diff: "+(ue.message||ue.error||ue)+".  Rebuilding the style from scratch."),this._updateStyle(H,re)}},I.prototype.getStyle=function(){if(this.style)return this.style.serialize()},I.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},I.prototype.addSource=function(H,re){return this._lazyInitEmptyStyle(),this.style.addSource(H,re),this._update(!0)},I.prototype.isSourceLoaded=function(H){var re=this.style&&this.style.sourceCaches[H];if(void 0!==re)return re.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+H+"'")))},I.prototype.areTilesLoaded=function(){var H=this.style&&this.style.sourceCaches;for(var re in H){var ue=H[re]._tiles;for(var ye in ue){var ke=ue[ye];if("loaded"!==ke.state&&"errored"!==ke.state)return!1}}return!0},I.prototype.addSourceType=function(H,re,ue){return this._lazyInitEmptyStyle(),this.style.addSourceType(H,re,ue)},I.prototype.removeSource=function(H){return this.style.removeSource(H),this._update(!0)},I.prototype.getSource=function(H){return this.style.getSource(H)},I.prototype.addImage=function(H,re,ue){void 0===ue&&(ue={});var ye=ue.pixelRatio;void 0===ye&&(ye=1);var ke=ue.sdf;void 0===ke&&(ke=!1);var Ee=ue.stretchX,Ue=ue.stretchY,$e=ue.content;if(this._lazyInitEmptyStyle(),re instanceof zs||as&&re instanceof as){var it=e.browser.getImageData(re);this.style.addImage(H,{data:new e.RGBAImage({width:it.width,height:it.height},it.data),pixelRatio:ye,stretchX:Ee,stretchY:Ue,content:$e,sdf:ke,version:0})}else{if(void 0===re.width||void 0===re.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Nt=re;this.style.addImage(H,{data:new e.RGBAImage({width:re.width,height:re.height},new Uint8Array(re.data)),pixelRatio:ye,stretchX:Ee,stretchY:Ue,content:$e,sdf:ke,version:0,userImage:Nt}),Nt.onAdd&&Nt.onAdd(this,H)}},I.prototype.updateImage=function(H,re){var ue=this.style.getImage(H);if(!ue)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var ye=re instanceof zs||as&&re instanceof as?e.browser.getImageData(re):re,ke=ye.width,Ee=ye.height,Ue=ye.data;return void 0===ke||void 0===Ee?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ke!==ue.data.width||Ee!==ue.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(ue.data.replace(Ue,!(re instanceof zs||as&&re instanceof as)),void this.style.updateImage(H,ue))},I.prototype.hasImage=function(H){return H?!!this.style.getImage(H):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},I.prototype.removeImage=function(H){this.style.removeImage(H)},I.prototype.loadImage=function(H,re){e.getImage(this._requestManager.transformRequest(H,e.ResourceType.Image),re)},I.prototype.listImages=function(){return this.style.listImages()},I.prototype.addLayer=function(H,re){return this._lazyInitEmptyStyle(),this.style.addLayer(H,re),this._update(!0)},I.prototype.moveLayer=function(H,re){return this.style.moveLayer(H,re),this._update(!0)},I.prototype.removeLayer=function(H){return this.style.removeLayer(H),this._update(!0)},I.prototype.getLayer=function(H){return this.style.getLayer(H)},I.prototype.setLayerZoomRange=function(H,re,ue){return this.style.setLayerZoomRange(H,re,ue),this._update(!0)},I.prototype.setFilter=function(H,re,ue){return void 0===ue&&(ue={}),this.style.setFilter(H,re,ue),this._update(!0)},I.prototype.getFilter=function(H){return this.style.getFilter(H)},I.prototype.setPaintProperty=function(H,re,ue,ye){return void 0===ye&&(ye={}),this.style.setPaintProperty(H,re,ue,ye),this._update(!0)},I.prototype.getPaintProperty=function(H,re){return this.style.getPaintProperty(H,re)},I.prototype.setLayoutProperty=function(H,re,ue,ye){return void 0===ye&&(ye={}),this.style.setLayoutProperty(H,re,ue,ye),this._update(!0)},I.prototype.getLayoutProperty=function(H,re){return this.style.getLayoutProperty(H,re)},I.prototype.setLight=function(H,re){return void 0===re&&(re={}),this._lazyInitEmptyStyle(),this.style.setLight(H,re),this._update(!0)},I.prototype.getLight=function(){return this.style.getLight()},I.prototype.setFeatureState=function(H,re){return this.style.setFeatureState(H,re),this._update()},I.prototype.removeFeatureState=function(H,re){return this.style.removeFeatureState(H,re),this._update()},I.prototype.getFeatureState=function(H){return this.style.getFeatureState(H)},I.prototype.getContainer=function(){return this._container},I.prototype.getCanvasContainer=function(){return this._canvasContainer},I.prototype.getCanvas=function(){return this._canvas},I.prototype._containerDimensions=function(){var H=0,re=0;return this._container&&(H=this._container.clientWidth||400,re=this._container.clientHeight||300),[H,re]},I.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},I.prototype._setupContainer=function(){var H=this._container;H.classList.add("mapboxgl-map"),(this._missingCSSCanary=i.create("div","mapboxgl-canary",H)).style.visibility="hidden",this._detectMissingCSS();var re=this._canvasContainer=i.create("div","mapboxgl-canvas-container",H);this._interactive&&re.classList.add("mapboxgl-interactive"),this._canvas=i.create("canvas","mapboxgl-canvas",re),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var ue=this._containerDimensions();this._resizeCanvas(ue[0],ue[1]);var ye=this._controlContainer=i.create("div","mapboxgl-control-container",H),ke=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ee){ke[Ee]=i.create("div","mapboxgl-ctrl-"+Ee,ye)})},I.prototype._resizeCanvas=function(H,re){var ue=e.browser.devicePixelRatio||1;this._canvas.width=ue*H,this._canvas.height=ue*re,this._canvas.style.width=H+"px",this._canvas.style.height=re+"px"},I.prototype._setupPainter=function(){var H=e.extend({},r.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),re=this._canvas.getContext("webgl",H)||this._canvas.getContext("experimental-webgl",H);re?(this.painter=new Xi(re,this.transform),e.webpSupported.testSupport(re)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},I.prototype._contextLost=function(H){H.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:H}))},I.prototype._contextRestored=function(H){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:H}))},I.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},I.prototype._update=function(H){return this.style?(this._styleDirty=this._styleDirty||H,this._sourcesDirty=!0,this.triggerRepaint(),this):this},I.prototype._requestRenderFrame=function(H){return this._update(),this._renderTaskQueue.add(H)},I.prototype._cancelRenderFrame=function(H){this._renderTaskQueue.remove(H)},I.prototype._render=function(H){var re,ue=this,ye=0,ke=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(re=ke.createQueryEXT(),ke.beginQueryEXT(ke.TIME_ELAPSED_EXT,re),ye=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(H),!this._removed){var Ee=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ue=this.transform.zoom,$e=e.browser.now();this.style.zoomHistory.update(Ue,$e);var it=new e.EvaluationParameters(Ue,{now:$e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_t=it.crossFadingFactor();1===_t&&_t===this._crossFadingFactor||(Ee=!0,this._crossFadingFactor=_t),this.style.update(it)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Ee)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ct=e.browser.now()-ye;ke.endQueryEXT(ke.TIME_ELAPSED_EXT,re),setTimeout(function(){var Et=ke.getQueryObjectEXT(re,ke.QUERY_RESULT_EXT)/1e6;ke.deleteQueryEXT(re),ue.fire(new e.Event("gpu-timing-frame",{cpuTime:Ct,gpuTime:Et}))},50)}if(this.listens("gpu-timing-layer")){var At=this.painter.collectGpuTimers();setTimeout(function(){var Et=ue.painter.queryGpuTimers(At);ue.fire(new e.Event("gpu-timing-layer",{layerTimes:Et}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},I.prototype.remove=function(){this._hash&&this._hash.remove();for(var H=0,re=this._controls;H<re.length;H+=1)re[H].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var ue=this.painter.context.gl.getExtension("WEBGL_lose_context");ue&&ue.loseContext(),Zs(this._canvasContainer),Zs(this._controlContainer),Zs(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},I.prototype.triggerRepaint=function(){var H=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(re){H._frame=null,H._render(re)}))},I.prototype._onWindowOnline=function(){this._update()},I.prototype._onWindowResize=function(H){this._trackResize&&this.resize({originalEvent:H})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(H){this._showTileBoundaries!==H&&(this._showTileBoundaries=H,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(H){this._showPadding!==H&&(this._showPadding=H,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(H){this._showCollisionBoxes!==H&&(this._showCollisionBoxes=H,H?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(H){this._showOverdrawInspector!==H&&(this._showOverdrawInspector=H,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(H){this._repaint!==H&&(this._repaint=H,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(H){this._vertices=H,this._update()},I.prototype._setCacheLimits=function(H,re){e.setCacheLimits(H,re)},F.version.get=function(){return e.version},Object.defineProperties(I.prototype,F),I}(Ls);function Zs(E){E.parentNode&&E.parentNode.removeChild(E)}var Cs={showCompass:!0,showZoom:!0,visualizePitch:!1},sa=function(E){var I=this;this.options=e.extend({},Cs,E),this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return I._map.zoomIn({},{originalEvent:F})}),i.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return I._map.zoomOut({},{originalEvent:F})}),i.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){I.options.visualizePitch?I._map.resetNorthPitch({},{originalEvent:F}):I._map.resetNorth({},{originalEvent:F})}),this._compassIcon=i.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};sa.prototype._updateZoomButtons=function(){var E=this._map.getZoom();this._zoomInButton.disabled=E===this._map.getMaxZoom(),this._zoomOutButton.disabled=E===this._map.getMinZoom()},sa.prototype._rotateCompassArrow=function(){var E=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=E},sa.prototype.onAdd=function(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new da(this._map,this._compass,this.options.visualizePitch)),this._container},sa.prototype.onRemove=function(){i.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},sa.prototype._createButton=function(E,I){var F=i.create("button",E,this._container);return F.type="button",F.addEventListener("click",I),F},sa.prototype._setButtonTitle=function(E,I){var F=this._map._getUIString("NavigationControl."+I);E.title=F,E.setAttribute("aria-label",F)};var da=function(E,I,F){void 0===F&&(F=!1),this._clickTolerance=10,this.element=I,this.mouseRotate=new Ui({clickTolerance:E.dragRotate._mouseRotate._clickTolerance}),this.map=E,F&&(this.mousePitch=new Mi({clickTolerance:E.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener(I,"mousedown",this.mousedown),i.addEventListener(I,"touchstart",this.touchstart,{passive:!1}),i.addEventListener(I,"touchmove",this.touchmove),i.addEventListener(I,"touchend",this.touchend),i.addEventListener(I,"touchcancel",this.reset)};function gs(E,I,F){if(E=new e.LngLat(E.lng,E.lat),I){var H=new e.LngLat(E.lng-360,E.lat),re=new e.LngLat(E.lng+360,E.lat),ue=F.locationPoint(E).distSqr(I);F.locationPoint(H).distSqr(I)<ue?E=H:F.locationPoint(re).distSqr(I)<ue&&(E=re)}for(;Math.abs(E.lng-F.center.lng)>180;){var ye=F.locationPoint(E);if(ye.x>=0&&ye.y>=0&&ye.x<=F.width&&ye.y<=F.height)break;E.lng>F.center.lng?E.lng-=360:E.lng+=360}return E}da.prototype.down=function(E,I){this.mouseRotate.mousedown(E,I),this.mousePitch&&this.mousePitch.mousedown(E,I),i.disableDrag()},da.prototype.move=function(E,I){var F=this.map,H=this.mouseRotate.mousemoveWindow(E,I);if(H&&H.bearingDelta&&F.setBearing(F.getBearing()+H.bearingDelta),this.mousePitch){var re=this.mousePitch.mousemoveWindow(E,I);re&&re.pitchDelta&&F.setPitch(F.getPitch()+re.pitchDelta)}},da.prototype.off=function(){var E=this.element;i.removeEventListener(E,"mousedown",this.mousedown),i.removeEventListener(E,"touchstart",this.touchstart,{passive:!1}),i.removeEventListener(E,"touchmove",this.touchmove),i.removeEventListener(E,"touchend",this.touchend),i.removeEventListener(E,"touchcancel",this.reset),this.offTemp()},da.prototype.offTemp=function(){i.enableDrag(),i.removeEventListener(e.window,"mousemove",this.mousemove),i.removeEventListener(e.window,"mouseup",this.mouseup)},da.prototype.mousedown=function(E){this.down(e.extend({},E,{ctrlKey:!0,preventDefault:function(){return E.preventDefault()}}),i.mousePos(this.element,E)),i.addEventListener(e.window,"mousemove",this.mousemove),i.addEventListener(e.window,"mouseup",this.mouseup)},da.prototype.mousemove=function(E){this.move(E,i.mousePos(this.element,E))},da.prototype.mouseup=function(E){this.mouseRotate.mouseupWindow(E),this.mousePitch&&this.mousePitch.mouseupWindow(E),this.offTemp()},da.prototype.touchstart=function(E){1!==E.targetTouches.length?this.reset():(this._startPos=this._lastPos=i.touchPos(this.element,E.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return E.preventDefault()}},this._startPos))},da.prototype.touchmove=function(E){1!==E.targetTouches.length?this.reset():(this._lastPos=i.touchPos(this.element,E.targetTouches)[0],this.move({preventDefault:function(){return E.preventDefault()}},this._lastPos))},da.prototype.touchend=function(E){0===E.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},da.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var us={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Na(E,I,F){var H=E.classList;for(var re in us)H.remove("mapboxgl-"+F+"-anchor-"+re);H.add("mapboxgl-"+F+"-anchor-"+I)}var Je,Dt=function(E){function I(F,H){var re=this;if(E.call(this),(F instanceof e.window.HTMLElement||H)&&(F=e.extend({element:F},H)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&"auto"!==F.pitchAlignment?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=i.create("div"),this._element.setAttribute("aria-label","Map marker");var ue=i.createNS("http://www.w3.org/2000/svg","svg");ue.setAttributeNS(null,"display","block"),ue.setAttributeNS(null,"height","41px"),ue.setAttributeNS(null,"width","27px"),ue.setAttributeNS(null,"viewBox","0 0 27 41");var ye=i.createNS("http://www.w3.org/2000/svg","g");ye.setAttributeNS(null,"stroke","none"),ye.setAttributeNS(null,"stroke-width","1"),ye.setAttributeNS(null,"fill","none"),ye.setAttributeNS(null,"fill-rule","evenodd");var ke=i.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill-rule","nonzero");var Ee=i.createNS("http://www.w3.org/2000/svg","g");Ee.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Ee.setAttributeNS(null,"fill","#000000");for(var Ue=0,$e=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ue<$e.length;Ue+=1){var it=$e[Ue],_t=i.createNS("http://www.w3.org/2000/svg","ellipse");_t.setAttributeNS(null,"opacity","0.04"),_t.setAttributeNS(null,"cx","10.5"),_t.setAttributeNS(null,"cy","5.80029008"),_t.setAttributeNS(null,"rx",it.rx),_t.setAttributeNS(null,"ry",it.ry),Ee.appendChild(_t)}var Ct=i.createNS("http://www.w3.org/2000/svg","g");Ct.setAttributeNS(null,"fill",this._color);var At=i.createNS("http://www.w3.org/2000/svg","path");At.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ct.appendChild(At);var Et=i.createNS("http://www.w3.org/2000/svg","g");Et.setAttributeNS(null,"opacity","0.25"),Et.setAttributeNS(null,"fill","#000000");var Tt=i.createNS("http://www.w3.org/2000/svg","path");Tt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Et.appendChild(Tt);var jt=i.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var Nt=i.createNS("http://www.w3.org/2000/svg","g");Nt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Yt=i.createNS("http://www.w3.org/2000/svg","circle");Yt.setAttributeNS(null,"fill","#000000"),Yt.setAttributeNS(null,"opacity","0.25"),Yt.setAttributeNS(null,"cx","5.5"),Yt.setAttributeNS(null,"cy","5.5"),Yt.setAttributeNS(null,"r","5.4999962");var ln=i.createNS("http://www.w3.org/2000/svg","circle");ln.setAttributeNS(null,"fill","#FFFFFF"),ln.setAttributeNS(null,"cx","5.5"),ln.setAttributeNS(null,"cy","5.5"),ln.setAttributeNS(null,"r","5.4999962"),Nt.appendChild(Yt),Nt.appendChild(ln),ke.appendChild(Ee),ke.appendChild(Ct),ke.appendChild(Et),ke.appendChild(jt),ke.appendChild(Nt),ue.appendChild(ke),this._element.appendChild(ue),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(bn){bn.preventDefault()}),this._element.addEventListener("mousedown",function(bn){bn.preventDefault()}),this._element.addEventListener("focus",function(){var bn=re._map.getContainer();bn.scrollTop=0,bn.scrollLeft=0}),Na(this._element,this._anchor,"marker"),this._popup=null}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},I.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),i.remove(this._element),this._popup&&this._popup.remove(),this},I.prototype.getLngLat=function(){return this._lngLat},I.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},I.prototype.getElement=function(){return this._element},I.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var H=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[H,-1*(24.6+H)],"bottom-right":[-H,-1*(24.6+H)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},I.prototype._onKeyPress=function(F){var H=F.code,re=F.charCode||F.keyCode;"Space"!==H&&"Enter"!==H&&32!==re&&13!==re||this.togglePopup()},I.prototype._onMapClick=function(F){var H=F.originalEvent.target,re=this._element;this._popup&&(H===re||re.contains(H))&&this.togglePopup()},I.prototype.getPopup=function(){return this._popup},I.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},I.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=gs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var H="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?H="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(H="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var re="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?re="rotateX(0deg)":"map"===this._pitchAlignment&&(re="rotateX("+this._map.getPitch()+"deg)"),F&&"moveend"!==F.type||(this._pos=this._pos.round()),i.setTransform(this._element,us[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+re+" "+H)}},I.prototype.getOffset=function(){return this._offset},I.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},I.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},I.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},I.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},I.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},I.prototype.isDraggable=function(){return this._draggable},I.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},I.prototype.getRotation=function(){return this._rotation},I.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},I.prototype.getRotationAlignment=function(){return this._rotationAlignment},I.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&"auto"!==F?F:this._rotationAlignment,this._update(),this},I.prototype.getPitchAlignment=function(){return this._pitchAlignment},I}(e.Evented),_e={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Be=0,Ft=!1,Tn=function(E){function I(F){E.call(this),this.options=e.extend({},_e,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.onAdd=function(F){var H;return this._map=F,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),H=this._setupUI,void 0!==Je?H(Je):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then(function(re){H(Je="denied"!==re.state)}):H(Je=!!e.window.navigator.geolocation),this._container},I.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),i.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Be=0,Ft=!1},I.prototype._isOutOfMapMaxBounds=function(F){var H=this._map.getMaxBounds(),re=F.coords;return H&&(re.longitude<H.getWest()||re.longitude>H.getEast()||re.latitude<H.getSouth()||re.latitude>H.getNorth())},I.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},I.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(F),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},I.prototype._updateCamera=function(F){var H=new e.LngLat(F.coords.longitude,F.coords.latitude),re=F.coords.accuracy,ue=this._map.getBearing(),ye=e.extend({bearing:ue},this.options.fitBoundsOptions);this._map.fitBounds(H.toBounds(re),ye,{geolocateSource:!0})},I.prototype._updateMarker=function(F){if(F){var H=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(H).addTo(this._map),this._userLocationDotMarker.setLngLat(H).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},I.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,H=this._map.unproject([0,F]),re=this._map.unproject([1,F]),ue=H.distanceTo(re),ye=Math.ceil(2*this._accuracy/ue);this._circleElement.style.width=ye+"px",this._circleElement.style.height=ye+"px"},I.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},I.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(1===F.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var H=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=H,this._geolocateButton.setAttribute("aria-label",H),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===F.code&&Ft)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},I.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},I.prototype._setupUI=function(F){var H=this;if(this._container.addEventListener("contextmenu",function(ye){return ye.preventDefault()}),this._geolocateButton=i.create("button","mapboxgl-ctrl-geolocate",this._container),i.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===F){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var re=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=re,this._geolocateButton.setAttribute("aria-label",re)}else{var ue=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=ue,this._geolocateButton.setAttribute("aria-label",ue)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Dt(this._dotElement),this._circleElement=i.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Dt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(ye){ye.geolocateSource||"ACTIVE_LOCK"!==H._watchState||ye.originalEvent&&"resize"===ye.originalEvent.type||(H._watchState="BACKGROUND",H._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),H._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),H.fire(new e.Event("trackuserlocationend")))})},I.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Be--,Ft=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Be>1?(F={maximumAge:6e5,timeout:0},Ft=!0):(F=this.options.positionOptions,Ft=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},I.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},I}(e.Evented),$n={maxWidth:100,unit:"metric"},or=function(E){this.options=e.extend({},$n,E),e.bindAll(["_onMove","setUnit"],this)};function vr(E,I,F){var H=F&&F.maxWidth||100,re=E._container.clientHeight/2,ue=E.unproject([0,re]),ye=E.unproject([H,re]),ke=ue.distanceTo(ye);if(F&&"imperial"===F.unit){var Ee=3.2808*ke;Ee>5280?ur(I,H,Ee/5280,E._getUIString("ScaleControl.Miles")):ur(I,H,Ee,E._getUIString("ScaleControl.Feet"))}else F&&"nautical"===F.unit?ur(I,H,ke/1852,E._getUIString("ScaleControl.NauticalMiles")):ke>=1e3?ur(I,H,ke/1e3,E._getUIString("ScaleControl.Kilometers")):ur(I,H,ke,E._getUIString("ScaleControl.Meters"))}function ur(E,I,F,H){var re,ue,ye,Ue,$e,ke=(re=F,(ue=Math.pow(10,(""+Math.floor(re)).length-1))*(ye=(ye=re/ue)>=10?10:ye>=5?5:ye>=3?3:ye>=2?2:ye>=1?1:(Ue=ye,$e=Math.pow(10,Math.ceil(-Math.log(Ue)/Math.LN10)),Math.round(Ue*$e)/$e)));E.style.width=I*(ke/F)+"px",E.innerHTML=ke+"&nbsp;"+H}or.prototype.getDefaultPosition=function(){return"bottom-left"},or.prototype._onMove=function(){vr(this._map,this._container,this.options)},or.prototype.onAdd=function(E){return this._map=E,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},or.prototype.onRemove=function(){i.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},or.prototype.setUnit=function(E){this.options.unit=E,vr(this._map,this._container,this.options)};var Or=function(E){this._fullscreen=!1,E&&E.container&&(E.container instanceof e.window.HTMLElement?this._container=E.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Or.prototype.onAdd=function(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Or.prototype.onRemove=function(){i.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Or.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Or.prototype._setupUI=function(){var E=this._fullscreenButton=i.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);i.create("span","mapboxgl-ctrl-icon",E).setAttribute("aria-hidden",!0),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Or.prototype._updateTitle=function(){var E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E},Or.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Or.prototype._isFullscreen=function(){return this._fullscreen},Or.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Or.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Nr={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ii=function(E){function I(F){E.call(this),this.options=e.extend(Object.create(Nr),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return E&&(I.__proto__=E),(I.prototype=Object.create(E&&E.prototype)).constructor=I,I.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},I.prototype.isOpen=function(){return!!this._map},I.prototype.remove=function(){return this._content&&i.remove(this._content),this._container&&(i.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},I.prototype.getLngLat=function(){return this._lngLat},I.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},I.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},I.prototype.getElement=function(){return this._container},I.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},I.prototype.setHTML=function(F){var H,re=e.window.document.createDocumentFragment(),ue=e.window.document.createElement("body");for(ue.innerHTML=F;H=ue.firstChild;)re.appendChild(H);return this.setDOMContent(re)},I.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},I.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},I.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},I.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},I.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},I.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},I.prototype._createContent=function(){this._content&&i.remove(this._content),this._content=i.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=i.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},I.prototype._onMouseUp=function(F){this._update(F.point)},I.prototype._onMouseMove=function(F){this._update(F.point)},I.prototype._onDrag=function(F){this._update(F.point)},I.prototype._update=function(F){var H=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=i.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=i.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(_t){return H._container.classList.add(_t)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var ue=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),ye=this.options.anchor,ke=function _t(Ct){if(Ct){if("number"==typeof Ct){var At=Math.round(Math.sqrt(.5*Math.pow(Ct,2)));return{center:new e.Point(0,0),top:new e.Point(0,Ct),"top-left":new e.Point(At,At),"top-right":new e.Point(-At,At),bottom:new e.Point(0,-Ct),"bottom-left":new e.Point(At,-At),"bottom-right":new e.Point(-At,-At),left:new e.Point(Ct,0),right:new e.Point(-Ct,0)}}if(Ct instanceof e.Point||Array.isArray(Ct)){var Et=e.Point.convert(Ct);return{center:Et,top:Et,"top-left":Et,"top-right":Et,bottom:Et,"bottom-left":Et,"bottom-right":Et,left:Et,right:Et}}return{center:e.Point.convert(Ct.center||[0,0]),top:e.Point.convert(Ct.top||[0,0]),"top-left":e.Point.convert(Ct["top-left"]||[0,0]),"top-right":e.Point.convert(Ct["top-right"]||[0,0]),bottom:e.Point.convert(Ct.bottom||[0,0]),"bottom-left":e.Point.convert(Ct["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Ct["bottom-right"]||[0,0]),left:e.Point.convert(Ct.left||[0,0]),right:e.Point.convert(Ct.right||[0,0])}}return _t(new e.Point(0,0))}(this.options.offset);if(!ye){var Ee,Ue=this._container.offsetWidth,$e=this._container.offsetHeight;Ee=ue.y+ke.bottom.y<$e?["top"]:ue.y>this._map.transform.height-$e?["bottom"]:[],ue.x<Ue/2?Ee.push("left"):ue.x>this._map.transform.width-Ue/2&&Ee.push("right"),ye=0===Ee.length?"bottom":Ee.join("-")}var it=ue.add(ke[ye]).round();i.setTransform(this._container,us[ye]+" translate("+it.x+"px,"+it.y+"px)"),Na(this._container,ye,"popup")}},I.prototype._onClose=function(){this.remove()},I}(e.Evented),le={version:e.version,supported:r,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Zo,NavigationControl:sa,GeolocateControl:Tn,AttributionControl:Ua,ScaleControl:or,FullscreenControl:Or,Popup:ii,Marker:Dt,Style:Pr,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){ot().acquire(ut)},clearPrewarmedResources:function(){var E=Lt;E&&(E.isPreloaded()&&1===E.numActive()?(E.release(ut),Lt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(E){e.config.ACCESS_TOKEN=E},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(E){e.config.API_URL=E},get workerCount(){return lt.workerCount},set workerCount(E){lt.workerCount=E},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(E){e.config.MAX_PARALLEL_IMAGE_REQUESTS=E},clearStorage:function(E){e.clearTileCache(E)},workerUrl:""};return le}),k},"object"==typeof $&&void 0!==Q?Q.exports=t():(g=g||self).mapboxgl=t()},{}],240:[function(v,Q,$){"use strict";Q.exports=Math.log2||function(g){return Math.log(g)*Math.LOG2E}},{}],241:[function(v,Q,$){"use strict";Q.exports=function(t,k){k||(k=t,t=window);var x=0,e=0,r=0,i={shift:!1,alt:!1,control:!1,meta:!1},c=!1;function n(y){var h=!1;return"altKey"in y&&(h=h||y.altKey!==i.alt,i.alt=!!y.altKey),"shiftKey"in y&&(h=h||y.shiftKey!==i.shift,i.shift=!!y.shiftKey),"ctrlKey"in y&&(h=h||y.ctrlKey!==i.control,i.control=!!y.ctrlKey),"metaKey"in y&&(h=h||y.metaKey!==i.meta,i.meta=!!y.metaKey),h}function m(y,h){var _=g.x(h),b=g.y(h);"buttons"in h&&(y=0|h.buttons),(y!==x||_!==e||b!==r||n(h))&&(x=0|y,e=_||0,r=b||0,k&&k(x,e,r,i))}function p(y){m(0,y)}function s(){(x||e||r||i.shift||i.alt||i.meta||i.control)&&(e=r=0,x=0,i.shift=i.alt=i.control=i.meta=!1,k&&k(0,0,0,i))}function f(y){n(y)&&k&&k(x,e,r,i)}function l(y){0===g.buttons(y)?m(0,y):m(x,y)}function o(y){m(x|g.buttons(y),y)}function d(y){m(x&~g.buttons(y),y)}function u(){c||(c=!0,t.addEventListener("mousemove",l),t.addEventListener("mousedown",o),t.addEventListener("mouseup",d),t.addEventListener("mouseleave",p),t.addEventListener("mouseenter",p),t.addEventListener("mouseout",p),t.addEventListener("mouseover",p),t.addEventListener("blur",s),t.addEventListener("keyup",f),t.addEventListener("keydown",f),t.addEventListener("keypress",f),t!==window&&(window.addEventListener("blur",s),window.addEventListener("keyup",f),window.addEventListener("keydown",f),window.addEventListener("keypress",f)))}u();var a={element:t};return Object.defineProperties(a,{enabled:{get:function(){return c},set:function(y){y?u():!c||(c=!1,t.removeEventListener("mousemove",l),t.removeEventListener("mousedown",o),t.removeEventListener("mouseup",d),t.removeEventListener("mouseleave",p),t.removeEventListener("mouseenter",p),t.removeEventListener("mouseout",p),t.removeEventListener("mouseover",p),t.removeEventListener("blur",s),t.removeEventListener("keyup",f),t.removeEventListener("keydown",f),t.removeEventListener("keypress",f),t!==window&&(window.removeEventListener("blur",s),window.removeEventListener("keyup",f),window.removeEventListener("keydown",f),window.removeEventListener("keypress",f)))},enumerable:!0},buttons:{get:function(){return x},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return r},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),a};var g=v("mouse-event")},{"mouse-event":243}],242:[function(v,Q,$){var g={left:0,top:0};Q.exports=function(t,k,x){k=k||t.currentTarget||t.srcElement,Array.isArray(x)||(x=[0,0]);var c,e=t.clientX||0,r=t.clientY||0,i=(c=k)===window||c===document||c===document.body?g:c.getBoundingClientRect();return x[0]=e-i.left,x[1]=r-i.top,x}},{}],243:[function(v,Q,$){"use strict";function g(t){return t.target||t.srcElement||window}$.buttons=function(t){if("object"==typeof t){if("buttons"in t)return t.buttons;if("which"in t){if(2===(k=t.which))return 4;if(3===k)return 2;if(k>0)return 1<<k-1}else if("button"in t){var k;if(1===(k=t.button))return 4;if(2===k)return 2;if(k>=0)return 1<<k}}return 0},$.element=g,$.x=function(t){if("object"==typeof t){if("offsetX"in t)return t.offsetX;var k=g(t).getBoundingClientRect();return t.clientX-k.left}return 0},$.y=function(t){if("object"==typeof t){if("offsetY"in t)return t.offsetY;var k=g(t).getBoundingClientRect();return t.clientY-k.top}return 0}},{}],244:[function(v,Q,$){"use strict";var g=v("to-px");Q.exports=function(t,k,x){"function"==typeof t&&(x=!!k,k=t,t=window);var e=g("ex",t),r=function(i){x&&i.preventDefault();var c=i.deltaX||0,n=i.deltaY||0,m=i.deltaZ||0,p=1;switch(i.deltaMode){case 1:p=e;break;case 2:p=window.innerHeight}if(n*=p,m*=p,(c*=p)||n||m)return k(c,n,m,i)};return t.addEventListener("wheel",r),r}},{"to-px":315}],245:[function(v,Q,$){(function(g,t){(function(){var k,x,e;e=function(){"use strict";var k,x,e,r=Object.prototype.toString,i=void 0!==t?function(y){return t(y)}:setTimeout;try{Object.defineProperty({},"x",{}),k=function(y,h,_,b){return Object.defineProperty(y,h,{value:_,writable:!0,configurable:!1!==b})}}catch(y){k=function(h,_,b){return h[_]=b,h}}function c(y,h){e.add(y,h),x||(x=i(e.drain))}function n(y){var h,_=typeof y;return null==y||"object"!=_&&"function"!=_||(h=y.then),"function"==typeof h&&h}function m(){for(var y=0;y<this.chain.length;y++)p(this,1===this.state?this.chain[y].success:this.chain[y].failure,this.chain[y]);this.chain.length=0}function p(y,h,_){var b,w;try{!1===h?_.reject(y.msg):(b=!0===h?y.msg:h.call(void 0,y.msg))===_.promise?_.reject(TypeError("Promise-chain cycle")):(w=n(b))?w.call(b,_.resolve,_.reject):_.resolve(b)}catch(T){_.reject(T)}}function s(y){var h,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(h=n(y))?c(function(){var b=new o(_);try{h.call(y,function(){s.apply(b,arguments)},function(){f.apply(b,arguments)})}catch(w){f.call(b,w)}}):(_.msg=y,_.state=1,_.chain.length>0&&c(m,_))}catch(b){f.call(new o(_),b)}}}function f(y){var h=this;h.triggered||(h.triggered=!0,h.def&&(h=h.def),h.msg=y,h.state=2,h.chain.length>0&&c(m,h))}function l(y,h,_,b){for(var w=0;w<h.length;w++)!function(T){y.resolve(h[T]).then(function(L){_(T,L)},b)}(w)}function o(y){this.def=y,this.triggered=!1}function d(y){this.promise=y,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(y){if("function"!=typeof y)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var h=new d(this);this.then=function(_,b){var w={success:"function"!=typeof _||_,failure:"function"==typeof b&&b};return w.promise=new this.constructor(function(T,L){if("function"!=typeof T||"function"!=typeof L)throw TypeError("Not a function");w.resolve=T,w.reject=L}),h.chain.push(w),0!==h.state&&c(m,h),w.promise},this.catch=function(_){return this.then(void 0,_)};try{y.call(void 0,function(_){s.call(h,_)},function(_){f.call(h,_)})}catch(_){f.call(h,_)}}e=function(){var y,h,_;function b(w,T){this.fn=w,this.self=T,this.next=void 0}return{add:function(w,T){_=new b(w,T),h?h.next=_:y=_,h=_,_=void 0},drain:function(){var w=y;for(y=h=x=void 0;w;)w.fn.call(w.self),w=w.next}}}();var a=k({},"constructor",u,!1);return u.prototype=a,k(a,"__NPO__",0,!1),k(u,"resolve",function(y){return y&&"object"==typeof y&&1===y.__NPO__?y:new this(function(h,_){if("function"!=typeof h||"function"!=typeof _)throw TypeError("Not a function");h(y)})}),k(u,"reject",function(y){return new this(function(h,_){if("function"!=typeof h||"function"!=typeof _)throw TypeError("Not a function");_(y)})}),k(u,"all",function(y){var h=this;return"[object Array]"!=r.call(y)?h.reject(TypeError("Not an array")):0===y.length?h.resolve([]):new h(function(_,b){if("function"!=typeof _||"function"!=typeof b)throw TypeError("Not a function");var w=y.length,T=Array(w),L=0;l(h,y,function(M,P){T[M]=P,++L===w&&_(T)},b)})}),k(u,"race",function(y){var h=this;return"[object Array]"!=r.call(y)?h.reject(TypeError("Not an array")):new h(function(_,b){if("function"!=typeof _||"function"!=typeof b)throw TypeError("Not a function");l(h,y,function(w,T){_(T)},b)})}),u},(x=void 0!==g?g:this)[k="Promise"]=x[k]||e(),void 0!==Q&&Q.exports&&(Q.exports=x[k])}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},v("timers").setImmediate)},{timers:312}],246:[function(v,Q,$){var g=Math.PI,t=i(120);function k(c,n,m,p){return["C",c,n,m,p,m,p]}function x(c,n,m,p,s,f){return["C",c/3+2/3*m,n/3+2/3*p,s/3+2/3*m,f/3+2/3*p,s,f]}function e(c,n,m,p,s,f,l,o,d,u){if(u)P=u[0],z=u[1],L=u[2],M=u[3];else{var a=r(c,n,-s);n=a.y;var y=((c=a.x)-(o=(a=r(o,d,-s)).x))/2,h=(n-(d=a.y))/2,_=y*y/(m*m)+h*h/(p*p);_>1&&(m*=_=Math.sqrt(_),p*=_);var b=m*m,w=p*p,T=(f==l?-1:1)*Math.sqrt(Math.abs((b*w-b*h*h-w*y*y)/(b*h*h+w*y*y)));T==1/0&&(T=1);var L=T*m*h/p+(c+o)/2,M=T*-p*y/m+(n+d)/2,P=Math.asin(((n-M)/p).toFixed(9)),z=Math.asin(((d-M)/p).toFixed(9));(P=c<L?g-P:P)<0&&(P=2*g+P),(z=o<L?g-z:z)<0&&(z=2*g+z),l&&P>z&&(P-=2*g),!l&&z>P&&(z-=2*g)}if(Math.abs(z-P)>t){var S=z,C=o,R=d;z=P+t*(l&&z>P?1:-1);var D=e(o=L+m*Math.cos(z),d=M+p*Math.sin(z),m,p,s,0,l,C,R,[z,S,L,M])}var j=Math.tan((z-P)/4),q=4/3*m*j,Z=4/3*p*j,W=[2*c-(c+q*Math.sin(P)),2*n-(n-Z*Math.cos(P)),o+q*Math.sin(z),d-Z*Math.cos(z),o,d];if(u)return W;D&&(W=W.concat(D));for(var G=0;G<W.length;){var X=r(W[G],W[G+1],s);W[G++]=X.x,W[G++]=X.y}return W}function r(c,n,m){return{x:c*Math.cos(m)-n*Math.sin(m),y:c*Math.sin(m)+n*Math.cos(m)}}function i(c){return c*(g/180)}Q.exports=function(c){for(var n,m=[],p=0,s=0,f=0,l=0,o=null,d=null,u=0,a=0,y=0,h=c.length;y<h;y++){var _=c[y],b=_[0];switch(b){case"M":f=_[1],l=_[2];break;case"A":(_=e(u,a,_[1],_[2],i(_[3]),_[4],_[5],_[6],_[7])).unshift("C"),_.length>7&&(m.push(_.splice(0,7)),_.unshift("C"));break;case"S":var w=u,T=a;"C"!=n&&"S"!=n||(w+=w-p,T+=T-s),_=["C",w,T,_[1],_[2],_[3],_[4]];break;case"T":"Q"==n||"T"==n?(o=2*u-o,d=2*a-d):(o=u,d=a),_=x(u,a,o,d,_[1],_[2]);break;case"Q":o=_[1],d=_[2],_=x(u,a,_[1],_[2],_[3],_[4]);break;case"L":_=k(u,a,_[1],_[2]);break;case"H":_=k(u,a,_[1],a);break;case"V":_=k(u,a,u,_[1]);break;case"Z":_=k(u,a,f,l)}n=b,u=_[_.length-2],a=_[_.length-1],_.length>4?(p=_[_.length-4],s=_[_.length-3]):(p=u,s=a),m.push(_)}return m}},{}],247:[function(v,Q,$){"use strict";var g=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;function x(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}Q.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},i=0;i<10;i++)r["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(r).map(function(n){return r[n]}).join(""))return!1;var c={};return"abcdefghijklmnopqrst".split("").forEach(function(n){c[n]=n}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},c)).join("")}catch(n){return!1}}()?Object.assign:function(e,r){for(var i,c,n=x(e),m=1;m<arguments.length;m++){for(var p in i=Object(arguments[m]))t.call(i,p)&&(n[p]=i[p]);if(g){c=g(i);for(var s=0;s<c.length;s++)k.call(i,c[s])&&(n[c[s]]=i[c[s]])}}return n}},{}],248:[function(v,Q,$){"use strict";function g(x,e){if("string"!=typeof x)return[x];var r=[x];"string"==typeof e||Array.isArray(e)?e={brackets:e}:e||(e={});var i=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],c=e.escape||"___",n=!!e.flat;i.forEach(function(p){var s=new RegExp(["\\",p[0],"[^\\",p[0],"\\",p[1],"]*\\",p[1]].join("")),f=[];function l(o,d,u){var a=r.push(o.slice(p[0].length,-p[1].length))-1;return f.push(a),c+a+c}r.forEach(function(o,d){for(var u,a=0;o!=u;)if(u=o,o=o.replace(s,l),a++>1e4)throw Error("References have circular dependency. Please, check them.");r[d]=o}),f=f.reverse(),r=r.map(function(o){return f.forEach(function(d){o=o.replace(new RegExp("(\\"+c+d+"\\"+c+")","g"),p[0]+"$1"+p[1])}),o})});var m=new RegExp("\\"+c+"([0-9]+)\\"+c);return n?r:function p(s,f,l){for(var o,d=[],u=0;o=m.exec(s);){if(u++>1e4)throw Error("Circular references in parenthesis");d.push(s.slice(0,o.index)),d.push(p(f[o[1]],f)),s=s.slice(o.index+o[0].length)}return d.push(s),d}(r[0],r)}function t(x,e){if(e&&e.flat){var r,i=e&&e.escape||"___",c=x[0];if(!c)return"";for(var n=new RegExp("\\"+i+"([0-9]+)\\"+i),m=0;c!=r;){if(m++>1e4)throw Error("Circular references in "+x);r=c,c=c.replace(n,p)}return c}return x.reduce(function s(f,l){return Array.isArray(l)&&(l=l.reduce(s,"")),f+l},"");function p(s,f){if(null==x[f])throw Error("Reference "+f+"is undefined");return x[f]}}function k(x,e){return Array.isArray(x)?t(x,e):g(x,e)}k.parse=g,k.stringify=t,Q.exports=k},{}],249:[function(v,Q,$){"use strict";var g=v("pick-by-alias");Q.exports=function(t){var k;return arguments.length>1&&(t=arguments),"string"==typeof t?t=t.split(/\s/).map(parseFloat):"number"==typeof t&&(t=[t]),t.length&&"number"==typeof t[0]?k=1===t.length?{width:t[0],height:t[0],x:0,y:0}:2===t.length?{width:t[0],height:t[1],x:0,y:0}:{x:t[0],y:t[1],width:t[2]-t[0]||0,height:t[3]-t[1]||0}:t&&((k={x:(t=g(t,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:t.top||0}).width=null==t.width?t.right?t.right-k.x:0:t.width,k.height=null==t.height?t.bottom?t.bottom-k.y:0:t.height),k}},{"pick-by-alias":253}],250:[function(v,Q,$){Q.exports=function(x){var e=[];return x.replace(t,function(r,i,c){var p,n=i.toLowerCase();for(p=void 0,c=(p=c.match(k))?p.map(Number):[],"m"==n&&c.length>2&&(e.push([i].concat(c.splice(0,2))),n="l",i="m"==i?"l":"L");;){if(c.length==g[n])return c.unshift(i),e.push(c);if(c.length<g[n])throw new Error("malformed path data");e.push([i].concat(c.splice(0,g[n])))}}),e};var g={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/gi,k=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(v,Q,$){Q.exports=function(g,t){t||(t=[0,""]),g=String(g);var k=parseFloat(g,10);return t[0]=k,t[1]=g.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],252:[function(v,Q,$){(function(g){(function(){(function(){var t,k,x,e,r,i;"undefined"!=typeof performance&&null!==performance&&performance.now?Q.exports=function(){return performance.now()}:null!=g&&g.hrtime?(Q.exports=function(){return(t()-r)/1e6},k=g.hrtime,e=(t=function(){var c;return 1e9*(c=k())[0]+c[1]})(),i=1e9*g.uptime(),r=e-i):Date.now?(Q.exports=function(){return Date.now()-x},x=Date.now()):(Q.exports=function(){return(new Date).getTime()-x},x=(new Date).getTime())}).call(this)}).call(this)}).call(this,v("_process"))},{_process:278}],253:[function(v,Q,$){"use strict";Q.exports=function(k,x,e){var r,i,c={};if("string"==typeof x&&(x=t(x)),Array.isArray(x)){var n={};for(i=0;i<x.length;i++)n[x[i]]=!0;x=n}for(r in x)x[r]=t(x[r]);var m={};for(r in x){var p=x[r];if(Array.isArray(p))for(i=0;i<p.length;i++){var s=p[i];if(e&&(m[s]=!0),s in k){if(c[r]=k[s],e)for(var f=i;f<p.length;f++)m[p[f]]=!0;break}}else r in k&&(x[r]&&(c[r]=k[r]),e&&(m[r]=!0))}if(e)for(r in k)m[r]||(c[r]=k[r]);return c};var g={};function t(k){return g[k]?g[k]:("string"==typeof k&&(k=g[k]=k.split(/\s*,\s*|\s+/)),k)}},{}],254:[function(v,Q,$){Q.exports=function(g,t,k,x){var e=g[0],r=g[1],i=!1;void 0===k&&(k=0),void 0===x&&(x=t.length);for(var c=x-k,n=0,m=c-1;n<c;m=n++){var p=t[n+k][0],s=t[n+k][1],l=t[m+k][1];s>r!=l>r&&e<(t[m+k][0]-p)*(r-s)/(l-s)+p&&(i=!i)}return i}},{}],255:[function(v,Q,$){var g,t=v("./lib/build-log"),k=v("./lib/epsilon"),x=v("./lib/intersecter"),e=v("./lib/segment-chainer"),r=v("./lib/segment-selector"),i=v("./lib/geojson"),c=!1,n=k();function m(p,s,f){var l=g.segments(p),o=g.segments(s),d=f(g.combine(l,o));return g.polygon(d)}g={buildLog:function(p){return!0===p?c=t():!1===p&&(c=!1),!1!==c&&c.list},epsilon:function(p){return n.epsilon(p)},segments:function(p){var s=x(!0,n,c);return p.regions.forEach(s.addRegion),{segments:s.calculate(p.inverted),inverted:p.inverted}},combine:function(p,s){return{combined:x(!1,n,c).calculate(p.segments,p.inverted,s.segments,s.inverted),inverted1:p.inverted,inverted2:s.inverted}},selectUnion:function(p){return{segments:r.union(p.combined,c),inverted:p.inverted1||p.inverted2}},selectIntersect:function(p){return{segments:r.intersect(p.combined,c),inverted:p.inverted1&&p.inverted2}},selectDifference:function(p){return{segments:r.difference(p.combined,c),inverted:p.inverted1&&!p.inverted2}},selectDifferenceRev:function(p){return{segments:r.differenceRev(p.combined,c),inverted:!p.inverted1&&p.inverted2}},selectXor:function(p){return{segments:r.xor(p.combined,c),inverted:p.inverted1!==p.inverted2}},polygon:function(p){return{regions:e(p.segments,n,c),inverted:p.inverted}},polygonFromGeoJSON:function(p){return i.toPolygon(g,p)},polygonToGeoJSON:function(p){return i.fromPolygon(g,n,p)},union:function(p,s){return m(p,s,g.selectUnion)},intersect:function(p,s){return m(p,s,g.selectIntersect)},difference:function(p,s){return m(p,s,g.selectDifference)},differenceRev:function(p,s){return m(p,s,g.selectDifferenceRev)},xor:function(p,s){return m(p,s,g.selectXor)}},"object"==typeof window&&(window.PolyBool=g),Q.exports=g},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(v,Q,$){Q.exports=function(){var g,t=0,k=!1;function x(e,r){return g.list.push({type:e,data:r?JSON.parse(JSON.stringify(r)):void 0}),g}return g={list:[],segmentId:function(){return t++},checkIntersection:function(e,r){return x("check",{seg1:e,seg2:r})},segmentChop:function(e,r){return x("div_seg",{seg:e,pt:r}),x("chop",{seg:e,pt:r})},statusRemove:function(e){return x("pop_seg",{seg:e})},segmentUpdate:function(e){return x("seg_update",{seg:e})},segmentNew:function(e,r){return x("new_seg",{seg:e,primary:r})},segmentRemove:function(e){return x("rem_seg",{seg:e})},tempStatus:function(e,r,i){return x("temp_status",{seg:e,above:r,below:i})},rewind:function(e){return x("rewind",{seg:e})},status:function(e,r,i){return x("status",{seg:e,above:r,below:i})},vert:function(e){return e===k?g:(k=e,x("vert",{x:e}))},log:function(e){return"string"!=typeof e&&(e=JSON.stringify(e,!1,"  ")),x("log",{txt:e})},reset:function(){return x("reset")},selected:function(e){return x("selected",{segs:e})},chainStart:function(e){return x("chain_start",{seg:e})},chainRemoveHead:function(e,r){return x("chain_rem_head",{index:e,pt:r})},chainRemoveTail:function(e,r){return x("chain_rem_tail",{index:e,pt:r})},chainNew:function(e,r){return x("chain_new",{pt1:e,pt2:r})},chainMatch:function(e){return x("chain_match",{index:e})},chainClose:function(e){return x("chain_close",{index:e})},chainAddHead:function(e,r){return x("chain_add_head",{index:e,pt:r})},chainAddTail:function(e,r){return x("chain_add_tail",{index:e,pt:r})},chainConnect:function(e,r){return x("chain_con",{index1:e,index2:r})},chainReverse:function(e){return x("chain_rev",{index:e})},chainJoin:function(e,r){return x("chain_join",{index1:e,index2:r})},done:function(){return x("done")}}}},{}],257:[function(v,Q,$){Q.exports=function(g){"number"!=typeof g&&(g=1e-10);var t={epsilon:function(k){return"number"==typeof k&&(g=k),g},pointAboveOrOnLine:function(k,x,e){var r=x[0],i=x[1];return(e[0]-r)*(k[1]-i)-(e[1]-i)*(k[0]-r)>=-g},pointBetween:function(k,x,e){var i=e[0]-x[0],n=e[1]-x[1],m=(k[0]-x[0])*i+(k[1]-x[1])*n;return!(m<g||m-(i*i+n*n)>-g)},pointsSameX:function(k,x){return Math.abs(k[0]-x[0])<g},pointsSameY:function(k,x){return Math.abs(k[1]-x[1])<g},pointsSame:function(k,x){return t.pointsSameX(k,x)&&t.pointsSameY(k,x)},pointsCompare:function(k,x){return t.pointsSameX(k,x)?t.pointsSameY(k,x)?0:k[1]<x[1]?-1:1:k[0]<x[0]?-1:1},pointsCollinear:function(k,x,e){return Math.abs((k[0]-x[0])*(x[1]-e[1])-(x[0]-e[0])*(k[1]-x[1]))<g},linesIntersect:function(k,x,e,r){var i=x[0]-k[0],c=x[1]-k[1],n=r[0]-e[0],m=r[1]-e[1],p=i*m-c*n;if(Math.abs(p)<g)return!1;var s=k[0]-e[0],f=k[1]-e[1],l=(n*f-m*s)/p,o=(i*f-c*s)/p,d={alongA:0,alongB:0,pt:[k[0]+l*i,k[1]+l*c]};return d.alongA=l<=-g?-2:l<g?-1:l-1<=-g?0:l-1<g?1:2,d.alongB=o<=-g?-2:o<g?-1:o-1<=-g?0:o-1<g?1:2,d},pointInsideRegion:function(k,x){for(var e=k[0],r=k[1],i=x[x.length-1][0],c=x[x.length-1][1],n=!1,m=0;m<x.length;m++){var p=x[m][0],s=x[m][1];s-r>g!=c-r>g&&(i-p)*(r-s)/(c-s)+p-e>g&&(n=!n),i=p,c=s}return n}};return t}},{}],258:[function(v,Q,$){Q.exports={toPolygon:function(t,k){function x(i){if(i.length<=0)return t.segments({inverted:!1,regions:[]});function c(p){var s=p.slice(0,p.length-1);return t.segments({inverted:!1,regions:[s]})}for(var n=c(i[0]),m=1;m<i.length;m++)n=t.selectDifference(t.combine(n,c(i[m])));return n}if("Polygon"===k.type)return t.polygon(x(k.coordinates));if("MultiPolygon"===k.type){for(var e=t.segments({inverted:!1,regions:[]}),r=0;r<k.coordinates.length;r++)e=t.selectUnion(t.combine(e,x(k.coordinates[r])));return t.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(t,k,x){function e(o,d){return k.pointInsideRegion([.5*(o[0][0]+o[1][0]),.5*(o[0][1]+o[1][1])],d)}function r(o){return{region:o,children:[]}}x=t.polygon(t.segments(x));var i=r(null);function c(o,d){for(var u=0;u<o.children.length;u++)if(e(d,(y=o.children[u]).region))return void c(y,d);var a=r(d);for(u=0;u<o.children.length;u++){var y;e((y=o.children[u]).region,d)&&(a.children.push(y),o.children.splice(u,1),u--)}o.children.push(a)}for(var n=0;n<x.regions.length;n++){var m=x.regions[n];m.length<3||c(i,m)}function p(o,d){for(var u=0,a=o[o.length-1][0],y=o[o.length-1][1],h=[],_=0;_<o.length;_++){var b=o[_][0],w=o[_][1];h.push([b,w]),u+=w*a-b*y,a=b,y=w}return u<0!==d&&h.reverse(),h.push([h[0][0],h[0][1]]),h}var s=[];function f(o){var d=[p(o.region,!1)];s.push(d);for(var u=0;u<o.children.length;u++)d.push(l(o.children[u]))}function l(o){for(var d=0;d<o.children.length;d++)f(o.children[d]);return p(o.region,!0)}for(n=0;n<i.children.length;n++)f(i.children[n]);return s.length<=0?{type:"Polygon",coordinates:[]}:1==s.length?{type:"Polygon",coordinates:s[0]}:{type:"MultiPolygon",coordinates:s}}}},{}],259:[function(v,Q,$){var g=v("./linked-list");Q.exports=function(t,k,x){function e(p,s,f){return{id:x?x.segmentId():-1,start:p,end:s,myFill:{above:f.myFill.above,below:f.myFill.below},otherFill:null}}var r=g.create();function i(p,s){r.insertBefore(p,function(f){return l=p.isStart,d=s,u=f.isStart,y=f.other.pt,(0!==(h=k.pointsCompare(p.pt,a=f.pt))?h:k.pointsSame(d,y)?0:l!==u?l?1:-1:k.pointAboveOrOnLine(d,u?a:y,u?y:a)?1:-1)<0;var l,d,u,a,y,h})}function c(p,s){var l,d,f=(i(d=g.node({isStart:!0,pt:(l=p).start,seg:l,primary:s,other:null,status:null}),l.end),d);return function(l,o,d){var u=g.node({isStart:!1,pt:o.end,seg:o,primary:d,other:l,status:null});l.other=u,i(u,l.pt)}(f,p,s),f}function n(p,s){var l,o,f=e(s,p.seg.end,p.seg);return l=p,o=s,x&&x.segmentChop(l.seg,o),l.other.remove(),l.seg.end=o,l.other.pt=o,i(l.other,l.pt),c(f,p.primary)}function m(p,s){var f=g.create();function l(P){return f.findTransition(function(z){var S,C,R,D,j,q;return D=(S=P).seg.end,(k.pointsCollinear(R=S.seg.start,j=(C=z.ev).seg.start,q=C.seg.end)?k.pointsCollinear(D,j,q)||k.pointAboveOrOnLine(D,j,q)?1:-1:k.pointAboveOrOnLine(R,j,q)?1:-1)>0})}function o(P,z){var S=P.seg,C=z.seg,R=S.start,D=S.end,j=C.start,q=C.end;x&&x.checkIntersection(S,C);var Z=k.linesIntersect(R,D,j,q);if(!1===Z){if(!k.pointsCollinear(R,D,j)||k.pointsSame(R,q)||k.pointsSame(D,j))return!1;var W=k.pointsSame(R,j),G=k.pointsSame(D,q);if(W&&G)return z;var X=!W&&k.pointBetween(R,j,q),ne=!G&&k.pointBetween(D,j,q);if(W)return ne?n(z,D):n(P,q),z;X&&(G||(ne?n(z,D):n(P,q)),n(z,R))}else 0===Z.alongA&&(-1===Z.alongB?n(P,j):0===Z.alongB?n(P,Z.pt):1===Z.alongB&&n(P,q)),0===Z.alongB&&(-1===Z.alongA?n(z,R):0===Z.alongA?n(z,Z.pt):1===Z.alongA&&n(z,D));return!1}for(var d=[];!r.isEmpty();){var u=r.getHead();if(x&&x.vert(u.pt[0]),u.isStart){let P=function(){if(y){var z=o(u,y);if(z)return z}return!!h&&o(u,h)};x&&x.segmentNew(u.seg,u.primary);var a=l(u),y=a.before?a.before.ev:null,h=a.after?a.after.ev:null;x&&x.tempStatus(u.seg,!!y&&y.seg,!!h&&h.seg);var _,w,b=P();if(b&&(t?(w=null===u.seg.myFill.below||u.seg.myFill.above!==u.seg.myFill.below)&&(b.seg.myFill.above=!b.seg.myFill.above):b.seg.otherFill=u.seg.myFill,x&&x.segmentUpdate(b.seg),u.other.remove(),u.remove()),r.getHead()!==u){x&&x.rewind(u.seg);continue}t?(w=null===u.seg.myFill.below||u.seg.myFill.above!==u.seg.myFill.below,u.seg.myFill.below=h?h.seg.myFill.above:p,u.seg.myFill.above=w?!u.seg.myFill.below:u.seg.myFill.below):null===u.seg.otherFill&&(u.seg.otherFill={above:_=h?u.primary===h.primary?h.seg.otherFill.above:h.seg.myFill.above:u.primary?s:p,below:_}),x&&x.status(u.seg,!!y&&y.seg,!!h&&h.seg),u.other.status=a.insert(g.node({ev:u}))}else{var T=u.status;if(null===T)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(f.exists(T.prev)&&f.exists(T.next)&&o(T.prev.ev,T.next.ev),x&&x.statusRemove(T.ev.seg),T.remove(),!u.primary){var L=u.seg.myFill;u.seg.myFill=u.seg.otherFill,u.seg.otherFill=L}d.push(u.seg)}r.getHead().remove()}return x&&x.done(),d}return t?{addRegion:function(p){for(var s,f,l,o=p[p.length-1],d=0;d<p.length;d++){var u=k.pointsCompare(s=o,o=p[d]);0!==u&&c((f=u<0?s:o,l=u<0?o:s,{id:x?x.segmentId():-1,start:f,end:l,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(p){return m(p,!1)}}:{calculate:function(p,s,f,l){return p.forEach(function(o){c(e(o.start,o.end,o),!0)}),f.forEach(function(o){c(e(o.start,o.end,o),!1)}),m(s,l)}}}},{"./linked-list":260}],260:[function(v,Q,$){Q.exports={create:function(){var g={root:{root:!0,next:null},exists:function(t){return null!==t&&t!==g.root},isEmpty:function(){return null===g.root.next},getHead:function(){return g.root.next},insertBefore:function(t,k){for(var x=g.root,e=g.root.next;null!==e;){if(k(e))return t.prev=e.prev,t.next=e,e.prev.next=t,void(e.prev=t);x=e,e=e.next}x.next=t,t.prev=x,t.next=null},findTransition:function(t){for(var k=g.root,x=g.root.next;null!==x&&!t(x);)k=x,x=x.next;return{before:k===g.root?null:k,after:x,insert:function(e){return e.prev=k,e.next=x,k.next=e,null!==x&&(x.prev=e),e}}}};return g},node:function(g){return g.prev=null,g.next=null,g.remove=function(){g.prev.next=g.next,g.next&&(g.next.prev=g.prev),g.prev=null,g.next=null},g}}},{}],261:[function(v,Q,$){Q.exports=function(g,t,k){var x=[],e=[];return g.forEach(function(r){var i=r.start,c=r.end;if(t.pointsSame(i,c))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{k&&k.chainStart(r);for(var n={index:0,matches_head:!1,matches_pt1:!1},m={index:0,matches_head:!1,matches_pt1:!1},p=n,s=0;s<x.length;s++){var f=(a=x[s])[0],l=a[a.length-1];if(t.pointsSame(f,i)){if(M(s,!0,!0))break}else if(t.pointsSame(f,c)){if(M(s,!0,!1))break}else if(t.pointsSame(l,i)){if(M(s,!1,!0))break}else if(t.pointsSame(l,c)&&M(s,!1,!1))break}if(p===n)return x.push([i,c]),void(k&&k.chainNew(i,c));if(p===m){k&&k.chainMatch(n.index);var o=n.index,d=n.matches_pt1?c:i,u=n.matches_head,a=x[o],y=u?a[0]:a[a.length-1],h=u?a[1]:a[a.length-2],_=u?a[a.length-1]:a[0],b=u?a[a.length-2]:a[1];return t.pointsCollinear(h,y,d)&&(u?(k&&k.chainRemoveHead(n.index,d),a.shift()):(k&&k.chainRemoveTail(n.index,d),a.pop()),y=h),t.pointsSame(_,d)?(x.splice(o,1),t.pointsCollinear(b,_,y)&&(u?(k&&k.chainRemoveTail(n.index,y),a.pop()):(k&&k.chainRemoveHead(n.index,y),a.shift())),k&&k.chainClose(n.index),void e.push(a)):void(u?(k&&k.chainAddHead(n.index,d),a.unshift(d)):(k&&k.chainAddTail(n.index,d),a.push(d)))}var w=n.index,T=m.index;k&&k.chainConnect(w,T);var L=x[w].length<x[T].length;n.matches_head?m.matches_head?L?(P(w),z(w,T)):(P(T),z(T,w)):z(T,w):m.matches_head?z(w,T):L?(P(w),z(T,w)):(P(T),z(w,T))}function M(S,C,R){return p.index=S,p.matches_head=C,p.matches_pt1=R,p===n?(p=m,!1):(p=null,!0)}function P(S){k&&k.chainReverse(S),x[S].reverse()}function z(S,C){var R=x[S],D=x[C],j=R[R.length-1],q=R[R.length-2],Z=D[0],W=D[1];t.pointsCollinear(q,j,Z)&&(k&&k.chainRemoveTail(S,j),R.pop(),j=q),t.pointsCollinear(j,Z,W)&&(k&&k.chainRemoveHead(C,Z),D.shift()),k&&k.chainJoin(S,C),x[S]=R.concat(D),x.splice(C,1)}}),e}},{}],262:[function(v,Q,$){function g(k,x,e){var r=[];return k.forEach(function(i){var c=(i.myFill.above?8:0)+(i.myFill.below?4:0)+(i.otherFill&&i.otherFill.above?2:0)+(i.otherFill&&i.otherFill.below?1:0);0!==x[c]&&r.push({id:e?e.segmentId():-1,start:i.start,end:i.end,myFill:{above:1===x[c],below:2===x[c]},otherFill:null})}),e&&e.selected(r),r}Q.exports={union:function(k,x){return g(k,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],x)},intersect:function(k,x){return g(k,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],x)},difference:function(k,x){return g(k,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],x)},differenceRev:function(k,x){return g(k,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],x)},xor:function(k,x){return g(k,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],x)}}},{}],263:[function(v,Q,$){"use strict";var g=v("stream").Transform,t=v("stream-parser");function k(){g.call(this,{readableObjectMode:!0})}function x(e,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name=this.constructor.name,this.message=e,r&&(this.code=r),i&&(this.statusCode=i)}(k.prototype=Object.create(g.prototype)).constructor=k,t(k.prototype),$.ParserStream=k,$.sliceEq=function(e,r,i){for(var c=r,n=0;n<i.length;)if(e[c++]!==i[n++])return!1;return!0},$.str2arr=function(e,r){var i=[],c=0;if(r&&"hex"===r)for(;c<e.length;)i.push(parseInt(e.slice(c,c+2),16)),c+=2;else for(;c<e.length;c++)i.push(255&e.charCodeAt(c));return i},$.readUInt16LE=function(e,r){return e[r]|e[r+1]<<8},$.readUInt16BE=function(e,r){return e[r+1]|e[r]<<8},$.readUInt32LE=function(e,r){return e[r]|e[r+1]<<8|e[r+2]<<16|16777216*e[r+3]},$.readUInt32BE=function(e,r){return e[r+3]|e[r+2]<<8|e[r+1]<<16|16777216*e[r]},(x.prototype=Object.create(Error.prototype)).constructor=x,$.ProbeError=x},{stream:286,"stream-parser":302}],264:[function(v,Q,$){"use strict";function g(x,e){var r=new Error(x);return r.code=e,r}function t(x){try{return decodeURIComponent(escape(x))}catch(e){return x}}function k(x,e,r){this.input=x.subarray(e,r),this.start=e;var i=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\0"!==i&&"MM\0*"!==i)throw g("invalid TIFF signature","EBADDATA");this.big_endian="M"===i[0]}k.prototype.each=function(x){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var r=this.ifds_to_read.shift();r.offset&&this.scan_ifd(r.id,r.offset,x)}},k.prototype.read_uint16=function(x){var e=this.input;if(x+2>e.length)throw g("unexpected EOF","EBADDATA");return this.big_endian?256*e[x]+e[x+1]:e[x]+256*e[x+1]},k.prototype.read_uint32=function(x){var e=this.input;if(x+4>e.length)throw g("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[x]+65536*e[x+1]+256*e[x+2]+e[x+3]:e[x]+256*e[x+1]+65536*e[x+2]+16777216*e[x+3]},k.prototype.is_subifd_link=function(x,e){return 0===x&&34665===e||0===x&&34853===e||34665===x&&40965===e},k.prototype.exif_format_length=function(x){switch(x){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},k.prototype.exif_format_read=function(x,e){var r;switch(x){case 1:case 2:return this.input[e];case 6:return(r=this.input[e])|33554430*(128&r);case 3:return this.read_uint16(e);case 8:return(r=this.read_uint16(e))|131070*(32768&r);case 4:return this.read_uint32(e);case 9:return 0|this.read_uint32(e);default:return null}},k.prototype.scan_ifd=function(x,e,r){var i=this.read_uint16(e);e+=2;for(var c=0;c<i;c++){var n=this.read_uint16(e),m=this.read_uint16(e+2),p=this.read_uint32(e+4),s=this.exif_format_length(m),f=p*s,l=f<=4?e+8:this.read_uint32(e+8),o=!1;if(l+f>this.input.length)throw g("unexpected EOF","EBADDATA");for(var d=[],u=l,a=0;a<p;a++,u+=s){var y=this.exif_format_read(m,u);if(null===y){d=null;break}d.push(y)}if(Array.isArray(d)&&2===m&&(d=t(String.fromCharCode.apply(null,d)))&&"\0"===d[d.length-1]&&(d=d.slice(0,-1)),this.is_subifd_link(x,n)&&Array.isArray(d)&&Number.isInteger(d[0])&&d[0]>0&&(this.ifds_to_read.push({id:n,offset:d[0]}),o=!0),!1===r({is_big_endian:this.big_endian,ifd:x,tag:n,format:m,count:p,entry_offset:e+this.start,data_length:f,data_offset:l+this.start,value:d,is_subifd_link:o}))return void(this.aborted=!0);e+=12}0===x&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},Q.exports.ExifParser=k,Q.exports.get_orientation=function(x){var e=0;try{return new k(x,0,x.length).each(function(r){if(0===r.ifd&&274===r.tag&&Array.isArray(r.value))return e=r.value[0],!1}),e}catch(r){return-1}}},{}],265:[function(v,Q,$){"use strict";var g=v("./common").readUInt16BE,t=v("./common").readUInt32BE;function k(n,m){if(n.length<4+m)return null;var p=t(n,m);return n.length<p+m||p<8?null:{boxtype:String.fromCharCode.apply(null,n.slice(m+4,m+8)),data:n.slice(m+8,m+p),end:m+p}}function x(n,m){for(var p=0;;){var s=k(n,p);if(!s)break;switch(s.boxtype){case"ispe":m.sizes.push({width:t(s.data,4),height:t(s.data,8)});break;case"irot":m.transforms.push({type:"irot",value:3&s.data[0]});break;case"imir":m.transforms.push({type:"imir",value:1&s.data[0]})}p=s.end}}function e(n,m,p){for(var s=0,f=0;f<p;f++)s=256*s+(n[m+f]||0);return s}function r(n,m){for(var p=n[4]>>4&15,s=15&n[4],f=n[5]>>4&15,l=g(n,6),o=8,d=0;d<l;d++){var u=g(n,o),a=g(n,o+=2),y=e(n,o+=2,f),h=g(n,o+=f);if(o+=2,0===a&&1===h){var _=e(n,o,p),b=e(n,o+p,s);m.item_loc[u]={length:b,offset:_+y}}o+=h*(p+s)}}function i(n,m){for(var p=g(n,4),s=6,f=0;f<p;f++){var l=k(n,s);if(!l)break;if("infe"===l.boxtype){for(var o=g(l.data,4),d="",u=8;u<l.data.length&&l.data[u];u++)d+=String.fromCharCode(l.data[u]);m.item_inf[d]=o}s=l.end}}function c(n,m){for(var p=0;;){var s=k(n,p);if(!s)break;"ipco"===s.boxtype&&x(s.data,m),p=s.end}}Q.exports.unbox=k,Q.exports.readSizeFromMeta=function(n){var m={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(u,a){for(var y=4;;){var h=k(u,y);if(!h)break;"iprp"===h.boxtype&&c(h.data,a),"iloc"===h.boxtype&&r(h.data,a),"iinf"===h.boxtype&&i(h.data,a),y=h.end}}(n,m),m.sizes.length){var p,s,f,l=(s=(p=m.sizes).reduce(function(u,a){return u.width>a.width||u.width===a.width&&u.height>a.height?u:a}),f=p.reduce(function(u,a){return u.height>a.height||u.height===a.height&&u.width>a.width?u:a}),s.width>f.height||s.width===f.height&&s.height>f.width?s:f),o=1;m.transforms.forEach(function(u){var a={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},y={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if("imir"===u.type&&(o=0===u.value?y[o]:a[o=a[o=y[o]]]),"irot"===u.type)for(var h=0;h<u.value;h++)o=a[o]});var d=null;return m.item_inf.Exif&&(d=m.item_loc[m.item_inf.Exif]),{width:l.width,height:l.height,orientation:m.transforms.length?o:null,variants:m.sizes,exif_location:d}}},Q.exports.getMimeType=function(n){var m=String.fromCharCode.apply(null,n.slice(0,4)),p={};p[m]=!0;for(var s=8;s<n.length;s+=4)p[String.fromCharCode.apply(null,n.slice(s,s+4))]=!0;if(p.mif1||p.msf1||p.miaf)return"avif"===m||"avis"===m||"avio"===m?{type:"avif",mime:"image/avif"}:"heic"===m||"heix"===m?{type:"heic",mime:"image/heic"}:"hevc"===m||"hevx"===m?{type:"heic",mime:"image/heic-sequence"}:p.avif||p.avis?{type:"avif",mime:"image/avif"}:p.heic||p.heix||p.hevc||p.hevx||p.heis?p.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt32BE,x=v("../miaf_utils"),e=v("../exif_utils"),r=g("ftyp");Q.exports=function(i){if(t(i,4,r)){var c=x.unbox(i,0);if(c){var n=x.getMimeType(c.data);if(n){for(var m,p=c.end;;){var s=x.unbox(i,p);if(!s)break;if(p=s.end,"mdat"===s.boxtype)return;if("meta"===s.boxtype){m=s.data;break}}if(m){var f=x.readSizeFromMeta(m);if(f){var l={width:f.width,height:f.height,type:n.type,mime:n.mime,wUnits:"px",hUnits:"px"};if(f.variants.length>1&&(l.variants=f.variants),f.orientation&&(l.orientation=f.orientation),f.exif_location&&f.exif_location.offset+f.exif_location.length<=i.length){var o=k(i,f.exif_location.offset),d=i.slice(f.exif_location.offset+o+4,f.exif_location.offset+f.exif_location.length),u=e.get_orientation(d);u>0&&(l.orientation=u)}return l}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt16LE,x=g("BM");Q.exports=function(e){if(!(e.length<26)&&t(e,0,x))return{width:k(e,18),height:k(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt16LE,x=g("GIF87a"),e=g("GIF89a");Q.exports=function(r){if(!(r.length<10)&&(t(r,0,x)||t(r,0,e)))return{width:k(r,6),height:k(r,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(v,Q,$){"use strict";var g=v("../common").readUInt16LE;Q.exports=function(t){var k=g(t,0),x=g(t,2),e=g(t,4);if(0===k&&1===x&&e){for(var r=[],i={width:0,height:0},c=0;c<e;c++){var n=t[6+16*c]||256,m=t[6+16*c+1]||256,p={width:n,height:m};r.push(p),(n>i.width||m>i.height)&&(i=p)}return{width:i.width,height:i.height,variants:r,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(v,Q,$){"use strict";var g=v("../common").readUInt16BE,t=v("../common").str2arr,k=v("../common").sliceEq,x=v("../exif_utils"),e=t("Exif\0\0");Q.exports=function(r){if(!(r.length<2)&&255===r[0]&&216===r[1]&&255===r[2])for(var i=2;;){for(;;){if(r.length-i<2)return;if(255===r[i++])break}for(var c,n,m=r[i++];255===m;)m=r[i++];if(208<=m&&m<=217||1===m)c=0;else{if(!(192<=m&&m<=254)||r.length-i<2)return;c=g(r,i)-2,i+=2}if(217===m||218===m)return;if(225===m&&c>=10&&k(r,i,e)&&(n=x.get_orientation(r.slice(i+6,i+c))),c>=5&&192<=m&&m<=207&&196!==m&&200!==m&&204!==m){if(r.length-i<c)return;var p={width:g(r,i+3),height:g(r,i+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return n>0&&(p.orientation=n),p}i+=c}}},{"../common":263,"../exif_utils":264}],271:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt32BE,x=g("\x89PNG\r\n\x1a\n"),e=g("IHDR");Q.exports=function(r){if(!(r.length<24)&&t(r,0,x)&&t(r,12,e))return{width:k(r,16),height:k(r,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt32BE,x=g("8BPS\0\x01");Q.exports=function(e){if(!(e.length<22)&&t(e,0,x))return{width:k(e,18),height:k(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(v,Q,$){"use strict";function g(n){return"number"==typeof n&&isFinite(n)&&n>0}var t=/<[-_.:a-zA-Z0-9][^>]*>/,k=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,x=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,r=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,i=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function c(n){return i.test(n)?n.match(i)[0]:"px"}Q.exports=function(n){if(function(_){var b,w=0,T=_.length;for(239===_[0]&&187===_[1]&&191===_[2]&&(w=3);w<T&&(32===(b=_[w])||9===b||13===b||10===b);)w++;return w!==T&&60===_[w]}(n)){for(var m="",p=0;p<n.length;p++)m+=String.fromCharCode(n[p]);var s=(m.match(t)||[""])[0];if(k.test(s)){var f=(b=(_=s).match(x),w=_.match(e),T=_.match(r),{width:b&&(b[1]||b[2]),height:w&&(w[1]||w[2]),viewbox:T&&(T[1]||T[2])}),l=parseFloat(f.width),o=parseFloat(f.height);if(f.width&&f.height)return g(l)&&g(o)?{width:l,height:o,type:"svg",mime:"image/svg+xml",wUnits:c(f.width),hUnits:c(f.height)}:void 0;var d=(f.viewbox||"").split(" "),u={width:d[2],height:d[3]},a=parseFloat(u.width),y=parseFloat(u.height);if(g(a)&&g(y)&&c(u.width)===c(u.height)){var h=a/y;return f.width?g(l)?{width:l,height:l/h,type:"svg",mime:"image/svg+xml",wUnits:c(f.width),hUnits:c(f.width)}:void 0:f.height?g(o)?{width:o*h,height:o,type:"svg",mime:"image/svg+xml",wUnits:c(f.height),hUnits:c(f.height)}:void 0:{width:a,height:y,type:"svg",mime:"image/svg+xml",wUnits:c(u.width),hUnits:c(u.height)}}}}var _,b,w,T}},{}],274:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt16LE,x=v("../common").readUInt16BE,e=v("../common").readUInt32LE,r=v("../common").readUInt32BE,i=g("II*\0"),c=g("MM\0*");function n(s,f,l){return l?x(s,f):k(s,f)}function m(s,f,l){return l?r(s,f):e(s,f)}function p(s,f,l){var o=n(s,f+2,l);return 1!==m(s,f+4,l)||3!==o&&4!==o?null:3===o?n(s,f+8,l):m(s,f+8,l)}Q.exports=function(s){if(!(s.length<8)&&(t(s,0,i)||t(s,0,c))){var f=77===s[0],l=m(s,4,f)-8;if(!(l<0)){var o=l+8;if(!(s.length-o<2)){var d=12*n(s,o+0,f);if(!(d<=0||(o+=2,s.length-o<d))){var u,a,y,h;for(u=0;u<d;u+=12)256===(h=n(s,o+u,f))?a=p(s,o+u,f):257===h&&(y=p(s,o+u,f));return a&&y?{width:a,height:y,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":263}],275:[function(v,Q,$){"use strict";var g=v("../common").str2arr,t=v("../common").sliceEq,k=v("../common").readUInt16LE,x=v("../common").readUInt32LE,e=v("../exif_utils"),r=g("RIFF"),i=g("WEBP");function c(p,s){if(157===p[s+3]&&1===p[s+4]&&42===p[s+5])return{width:16383&k(p,s+6),height:16383&k(p,s+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function n(p,s){if(47===p[s]){var f=x(p,s+1);return{width:1+(16383&f),height:1+(f>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function m(p,s){return{width:1+(p[s+6]<<16|p[s+5]<<8|p[s+4]),height:1+(p[s+9]<<s|p[s+8]<<8|p[s+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}Q.exports=function(p){if(!(p.length<16)&&(t(p,0,r)||t(p,8,i))){var s=12,f=null,l=0,o=x(p,4)+8;if(!(o>p.length)){for(;s+8<o;)if(0!==p[s]){var d=String.fromCharCode.apply(null,p.slice(s,s+4)),u=x(p,s+4);"VP8 "===d&&u>=10?f=f||c(p,s+8):"VP8L"===d&&u>=9?f=f||n(p,s+8):"VP8X"===d&&u>=10?f=f||m(p,s+8):"EXIF"===d&&(l=e.get_orientation(p.slice(s+8,s+8+u)),s=1/0),s+=8+u}else s++;if(f)return l>0&&(f.orientation=l),f}}}},{"../common":263,"../exif_utils":264}],276:[function(v,Q,$){"use strict";Q.exports={avif:v("./parse_sync/avif"),bmp:v("./parse_sync/bmp"),gif:v("./parse_sync/gif"),ico:v("./parse_sync/ico"),jpeg:v("./parse_sync/jpeg"),png:v("./parse_sync/png"),psd:v("./parse_sync/psd"),svg:v("./parse_sync/svg"),tiff:v("./parse_sync/tiff"),webp:v("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(v,Q,$){"use strict";var g=v("./lib/parsers_sync");Q.exports=function(t){return function(k){for(var x=Object.keys(g),e=0;e<x.length;e++){var r=g[x[e]](k);if(r)return r}return null}(t)},Q.exports.parsers=g},{"./lib/parsers_sync":276}],278:[function(v,Q,$){var g,t,k=Q.exports={};function x(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function r(o){if(g===setTimeout)return setTimeout(o,0);if((g===x||!g)&&setTimeout)return g=setTimeout,setTimeout(o,0);try{return g(o,0)}catch(d){try{return g.call(null,o,0)}catch(u){return g.call(this,o,0)}}}!function(){try{g="function"==typeof setTimeout?setTimeout:x}catch(o){g=x}try{t="function"==typeof clearTimeout?clearTimeout:e}catch(o){t=e}}();var i,c=[],n=!1,m=-1;function p(){n&&i&&(n=!1,i.length?c=i.concat(c):m=-1,c.length&&s())}function s(){if(!n){var o=r(p);n=!0;for(var d=c.length;d;){for(i=c,c=[];++m<d;)i&&i[m].run();m=-1,d=c.length}i=null,n=!1,function(u){if(t===clearTimeout)return clearTimeout(u);if((t===e||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(u);try{t(u)}catch(a){try{return t.call(null,u)}catch(y){return t.call(this,u)}}}(o)}}function f(o,d){this.fun=o,this.array=d}function l(){}k.nextTick=function(o){var d=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)d[u-1]=arguments[u];c.push(new f(o,d)),1!==c.length||n||r(s)},f.prototype.run=function(){this.fun.apply(null,this.array)},k.title="browser",k.browser=!0,k.env={},k.argv=[],k.version="",k.versions={},k.on=l,k.addListener=l,k.once=l,k.off=l,k.removeListener=l,k.removeAllListeners=l,k.emit=l,k.prependListener=l,k.prependOnceListener=l,k.listeners=function(o){return[]},k.binding=function(o){throw new Error("process.binding is not supported")},k.cwd=function(){return"/"},k.chdir=function(o){throw new Error("process.chdir is not supported")},k.umask=function(){return 0}},{}],279:[function(v,Q,$){(function(g){(function(){for(var t=v("performance-now"),k="undefined"==typeof window?g:window,x=["moz","webkit"],e="AnimationFrame",r=k["request"+e],i=k["cancel"+e]||k["cancelRequest"+e],c=0;!r&&c<x.length;c++)r=k[x[c]+"Request"+e],i=k[x[c]+"Cancel"+e]||k[x[c]+"CancelRequest"+e];if(!r||!i){var n=0,m=0,p=[];r=function(s){if(0===p.length){var f=t(),l=Math.max(0,1e3/60-(f-n));n=l+f,setTimeout(function(){var o=p.slice(0);p.length=0;for(var d=0;d<o.length;d++)if(!o[d].cancelled)try{o[d].callback(n)}catch(u){setTimeout(function(){throw u},0)}},Math.round(l))}return p.push({handle:++m,callback:s,cancelled:!1}),m},i=function(s){for(var f=0;f<p.length;f++)p[f].handle===s&&(p[f].cancelled=!0)}}Q.exports=function(s){return r.call(k,s)},Q.exports.cancel=function(){i.apply(k,arguments)},Q.exports.polyfill=function(s){s||(s=k),s.requestAnimationFrame=r,s.cancelAnimationFrame=i}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":252}],280:[function(v,Q,$){"use strict";var g=v("array-bounds"),t=v("color-normalize"),k=v("update-diff"),x=v("pick-by-alias"),e=v("object-assign"),r=v("flatten-vertex-data"),i=v("to-float32"),c=i.float32,n=i.fract32;Q.exports=function(p,s){if("function"==typeof p?(s||(s={}),s.regl=p):s=p,s.length&&(s.positions=s),!(p=s.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var f,l,o,d,u,a,y=p._gl,h={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return d=p.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),l=p.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),o=p.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),u=p.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),a=p.buffer({usage:"static",type:"float",data:m}),L(s),f=p({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:p.prop("range"),lineWidth:p.prop("lineWidth"),capSize:p.prop("capSize"),opacity:p.prop("opacity"),scale:p.prop("scale"),translate:p.prop("translate"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),viewport:function(P,z){return[z.viewport.x,z.viewport.y,P.viewportWidth,P.viewportHeight]}},attributes:{color:{buffer:d,offset:function(P,z){return 4*z.offset},divisor:1},position:{buffer:l,offset:function(P,z){return 8*z.offset},divisor:1},positionFract:{buffer:o,offset:function(P,z){return 8*z.offset},divisor:1},error:{buffer:u,offset:function(P,z){return 16*z.offset},divisor:1},direction:{buffer:a,stride:24,offset:0},lineOffset:{buffer:a,stride:24,offset:8},capOffset:{buffer:a,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:p.prop("viewport")},viewport:p.prop("viewport"),stencil:!1,instances:p.prop("count"),count:m.length}),e(b,{update:L,draw:w,destroy:M,regl:p,gl:y,canvas:y.canvas,groups:_}),b;function b(P){P?L(P):null===P&&M(),w()}function w(P){if("number"==typeof P)return T(P);P&&!Array.isArray(P)&&(P=[P]),p._refresh(),_.forEach(function(z,S){z&&(P&&(z.draw=!!P[S]),z.draw?T(S):z.draw=!0)})}function T(P){"number"==typeof P&&(P=_[P]),null!=P&&P&&P.count&&P.color&&P.opacity&&P.positions&&P.positions.length>1&&(P.scaleRatio=[P.scale[0]*P.viewport.width,P.scale[1]*P.viewport.height],f(P),P.after&&P.after(P))}function L(P){if(P){null!=P.length?"number"==typeof P[0]&&(P=[{positions:P}]):Array.isArray(P)||(P=[P]);var z=0,S=0;if(b.groups=_=P.map(function(W,G){var X=_[G];return W&&("function"==typeof W?W={after:W}:"number"==typeof W[0]&&(W={positions:W}),W=x(W,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),X||(_[G]=X={id:G,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},W=e({},h,W)),k(X,W,[{lineWidth:function(ne){return.5*+ne},capSize:function(ne){return.5*+ne},opacity:parseFloat,errors:function(ne){return ne=r(ne),S+=ne.length,ne},positions:function(ne,V){return ne=r(ne,"float64"),V.count=Math.floor(ne.length/2),V.bounds=g(ne,2),V.offset=z,z+=V.count,ne}},{color:function(ne,V){var N=V.count;if(ne||(ne="transparent"),!Array.isArray(ne)||"number"==typeof ne[0]){var U=ne;ne=Array(N);for(var ee=0;ee<N;ee++)ne[ee]=U}if(ne.length<N)throw Error("Not enough colors");for(var B=new Uint8Array(4*N),K=0;K<N;K++){var J=t(ne[K],"uint8");B.set(J,4*K)}return B},range:function(ne,V,N){return ne||(ne=V.bounds),V.scale=[1/(ne[2]-ne[0]),1/(ne[3]-ne[1])],V.translate=[-ne[0],-ne[1]],V.scaleFract=n(V.scale),V.translateFract=n(V.translate),ne},viewport:function(ne){var V;return Array.isArray(ne)?V={x:ne[0],y:ne[1],width:ne[2]-ne[0],height:ne[3]-ne[1]}:ne?((V={x:ne.x||ne.left||0,y:ne.y||ne.top||0}).width=ne.right?ne.right-V.x:ne.w||ne.width||0,V.height=ne.bottom?ne.bottom-V.y:ne.h||ne.height||0):V={x:0,y:0,width:y.drawingBufferWidth,height:y.drawingBufferHeight},V}}])),X}),z||S){var C=_.reduce(function(W,G,X){return W+(G?G.count:0)},0),R=new Float64Array(2*C),D=new Uint8Array(4*C),j=new Float32Array(4*C);_.forEach(function(W,G){if(W){var X=W.positions,V=W.offset,U=W.errors;W.count&&(D.set(W.color,4*V),j.set(U,4*V),R.set(X,2*V))}});var q=c(R);l(q);var Z=n(R,q);o(Z),d(D),u(j)}}}function M(){l.destroy(),o.destroy(),d.destroy(),u.destroy(),a.destroy()}};var m=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(v,Q,$){"use strict";var g=v("color-normalize"),t=v("array-bounds"),k=v("object-assign"),x=v("glslify"),e=v("pick-by-alias"),r=v("flatten-vertex-data"),i=v("earcut"),c=v("array-normalize"),n=v("to-float32"),m=n.float32,p=n.fract32,s=v("es6-weak-map"),f=v("parse-rect"),l=v("array-find-index");function o(d,u){if(!(this instanceof o))return new o(d,u);if("function"==typeof d?(u||(u={}),u.regl=d):u=d,u.length&&(u.positions=u),!(d=u.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=d._gl,this.regl=d,this.passes=[],this.shaders=o.shaders.has(d)?o.shaders.get(d):o.shaders.set(d,o.createShaders(d)).get(d),this.update(u)}Q.exports=o,o.dashMult=2,o.maxPatternLength=256,o.precisionThreshold=3e6,o.maxPoints=1e4,o.maxLines=2048,o.shaders=new s,o.createShaders=function(d){var u,a=d.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),y={primitive:"triangle strip",instances:d.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,b){return"round"===b.join?2:1},miterLimit:d.prop("miterLimit"),scale:d.prop("scale"),scaleFract:d.prop("scaleFract"),translateFract:d.prop("translateFract"),translate:d.prop("translate"),thickness:d.prop("thickness"),dashTexture:d.prop("dashTexture"),opacity:d.prop("opacity"),pixelRatio:d.context("pixelRatio"),id:d.prop("id"),dashLength:d.prop("dashLength"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]},depth:d.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,b){return!b.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:d.prop("viewport")},viewport:d.prop("viewport")},h=d(k({vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:a,divisor:0,stride:8,offset:0},lineTop:{buffer:a,divisor:0,stride:8,offset:4},aCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:d.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:d.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:d.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},y));try{u=d(k({cull:{enable:!0,face:"back"},vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:a,divisor:0,stride:8,offset:0},lineTop:{buffer:a,divisor:0,stride:8,offset:4},aColor:{buffer:d.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:d.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},y))}catch(_){u=h}return{fill:d({primitive:"triangle",elements:function(_,b){return b.triangles},offset:0,vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:d.prop("scale"),color:d.prop("fill"),scaleFract:d.prop("scaleFract"),translateFract:d.prop("translateFract"),translate:d.prop("translate"),opacity:d.prop("opacity"),pixelRatio:d.context("pixelRatio"),id:d.prop("id"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:d.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:d.prop("positionFractBuffer"),stride:8,offset:8}},blend:y.blend,depth:{enable:!1},scissor:y.scissor,stencil:y.stencil,viewport:y.viewport}),rect:h,miter:u}},o.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},o.prototype.render=function(){for(var d,u=[],a=arguments.length;a--;)u[a]=arguments[a];u.length&&(d=this).update.apply(d,u),this.draw()},o.prototype.draw=function(){for(var d=this,u=[],a=arguments.length;a--;)u[a]=arguments[a];return(u.length?u:this.passes).forEach(function(y,h){var _;if(y&&Array.isArray(y))return(_=d).draw.apply(_,y);"number"==typeof y&&(y=d.passes[y]),y&&y.count>1&&y.opacity&&(d.regl._refresh(),y.fill&&y.triangles&&y.triangles.length>2&&d.shaders.fill(y),y.thickness&&(y.scale[0]*y.viewport.width>o.precisionThreshold||y.scale[1]*y.viewport.height>o.precisionThreshold||"rect"===y.join||!y.join&&(y.thickness<=2||y.count>=o.maxPoints)?d.shaders.rect(y):d.shaders.miter(y)))}),this},o.prototype.update=function(d){var u=this;if(d){null!=d.length?"number"==typeof d[0]&&(d=[{positions:d}]):Array.isArray(d)||(d=[d]);var a=this.regl,y=this.gl;if(d.forEach(function(T,L){var M=u.passes[L];if(void 0!==T)if(null!==T){if("number"==typeof T[0]&&(T={positions:T}),T=e(T,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),M||(u.passes[L]=M={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:a.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:a.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:a.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:a.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},T=k({},o.defaults,T)),null!=T.thickness&&(M.thickness=parseFloat(T.thickness)),null!=T.opacity&&(M.opacity=parseFloat(T.opacity)),null!=T.miterLimit&&(M.miterLimit=parseFloat(T.miterLimit)),null!=T.overlay&&(M.overlay=!!T.overlay,L<o.maxLines&&(M.depth=2*(o.maxLines-1-L%o.maxLines)/o.maxLines-1)),null!=T.join&&(M.join=T.join),null!=T.hole&&(M.hole=T.hole),null!=T.fill&&(M.fill=T.fill?g(T.fill,"uint8"):null),null!=T.viewport&&(M.viewport=f(T.viewport)),M.viewport||(M.viewport=f([y.drawingBufferWidth,y.drawingBufferHeight])),null!=T.close&&(M.close=T.close),null===T.positions&&(T.positions=[]),T.positions){var P,z;if(T.positions.x&&T.positions.y){var S=T.positions.x,C=T.positions.y;z=M.count=Math.max(S.length,C.length),P=new Float64Array(2*z);for(var R=0;R<z;R++)P[2*R]=S[R],P[2*R+1]=C[R]}else P=r(T.positions,"float64"),z=M.count=Math.floor(P.length/2);var D=M.bounds=t(P,2);if(M.fill){for(var j=[],q={},Z=0,W=0,G=0,X=M.count;W<X;W++){var ne=P[2*W],V=P[2*W+1];isNaN(ne)||isNaN(V)||null==ne||null==V?(ne=P[2*Z],V=P[2*Z+1],q[W]=Z):Z=W,j[G++]=ne,j[G++]=V}if(T.splitNull){M.count-1 in q||(q[M.count]=M.count-1);var N=Object.keys(q).map(Number).sort(function(yt,Vt){return yt-Vt}),U=[],ee=0,B=null!=M.hole?M.hole[0]:null;if(null!=B){var K=l(N,function(yt){return yt>=B});(N=N.slice(0,K)).push(B)}for(var J=function(yt){var Vt=j.slice(2*ee,2*N[yt]).concat(B?j.slice(2*B):[]),Gt=(M.hole||[]).map(function(Jt){return Jt-B+(N[yt]-ee)}),en=i(Vt,Gt);en=en.map(function(Jt){return Jt+ee+(Jt+ee<N[yt]?0:B-N[yt])}),U.push.apply(U,en),ee=N[yt]+1},te=0;te<N.length;te++)J(te);for(var ae=0,ce=U.length;ae<ce;ae++)null!=q[U[ae]]&&(U[ae]=q[U[ae]]);M.triangles=U}else{for(var oe=i(j,M.hole||[]),ve=0,fe=oe.length;ve<fe;ve++)null!=q[oe[ve]]&&(oe[ve]=q[oe[ve]]);M.triangles=oe}}var xe=new Float64Array(P);c(xe,2,D);var Se=new Float64Array(2*z+6);M.close?P[0]===P[2*z-2]&&P[1]===P[2*z-1]?(Se[0]=xe[2*z-4],Se[1]=xe[2*z-3]):(Se[0]=xe[2*z-2],Se[1]=xe[2*z-1]):(Se[0]=xe[0],Se[1]=xe[1]),Se.set(xe,2),M.close?P[0]===P[2*z-2]&&P[1]===P[2*z-1]?(Se[2*z+2]=xe[2],Se[2*z+3]=xe[3],M.count-=1):(Se[2*z+2]=xe[0],Se[2*z+3]=xe[1],Se[2*z+4]=xe[2],Se[2*z+5]=xe[3]):(Se[2*z+2]=xe[2*z-2],Se[2*z+3]=xe[2*z-1],Se[2*z+4]=xe[2*z-2],Se[2*z+5]=xe[2*z-1]);var pe=m(Se);M.positionBuffer(pe);var ge=p(Se,pe);M.positionFractBuffer(ge)}if(T.range?M.range=T.range:M.range||(M.range=M.bounds),(T.range||T.positions)&&M.count){var Te=M.bounds,Ae=M.range[2]-M.range[0],Le=M.range[3]-M.range[1];M.scale=[(Te[2]-Te[0])/Ae,(Te[3]-Te[1])/Le],M.translate=[-M.range[0]/Ae+Te[0]/Ae||0,-M.range[1]/Le+Te[1]/Le||0],M.scaleFract=p(M.scale),M.translateFract=p(M.translate)}if(T.dashes){var Me,De=0;if(!T.dashes||T.dashes.length<2)De=1,Me=new Uint8Array([255,255,255,255,255,255,255,255]);else{De=0;for(var Oe=0;Oe<T.dashes.length;++Oe)De+=T.dashes[Oe];Me=new Uint8Array(De*o.dashMult);for(var Ie=0,Qe=255,Ne=0;Ne<2;Ne++)for(var Pe=0;Pe<T.dashes.length;++Pe){for(var Re=0,Ge=T.dashes[Pe]*o.dashMult*.5;Re<Ge;++Re)Me[Ie++]=Qe;Qe^=255}}M.dashLength=De,M.dashTexture({channels:1,data:Me,width:Me.length,height:1,mag:"linear",min:"linear"},0,0)}if(T.color){var tt=M.count,ct=T.color;ct||(ct="transparent");var wt=new Uint8Array(4*tt+4);if(Array.isArray(ct)&&"number"!=typeof ct[0]){for(var kt=0;kt<tt;kt++){var gt=g(ct[kt],"uint8");wt.set(gt,4*kt)}wt.set(g(ct[0],"uint8"),4*tt)}else for(var at=g(ct,"uint8"),et=0;et<tt+1;et++)wt.set(at,4*et);M.colorBuffer({usage:"dynamic",type:"uint8",data:wt})}}else u.passes[L]=null}),d.length<this.passes.length){for(var h=d.length;h<this.passes.length;h++){var _=this.passes[h];_&&(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=d.length}for(var b=[],w=0;w<this.passes.length;w++)null!==this.passes[w]&&b.push(this.passes[w]);return this.passes=b,this}},o.prototype.destroy=function(){return this.passes.forEach(function(d){d.colorBuffer.destroy(),d.positionBuffer.destroy(),d.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(v,Q,$){"use strict";function g(h,_){return function(b){if(Array.isArray(b))return b}(h)||function(b,w){var T=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=T){var L,M,P=[],z=!0,S=!1;try{for(T=T.call(b);!(z=(L=T.next()).done)&&(P.push(L.value),!w||P.length!==w);z=!0);}catch(C){S=!0,M=C}finally{try{z||null==T.return||T.return()}finally{if(S)throw M}}return P}}(h,_)||k(h,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(h){return function(_){if(Array.isArray(_))return x(_)}(h)||function(_){if("undefined"!=typeof Symbol&&null!=_[Symbol.iterator]||null!=_["@@iterator"])return Array.from(_)}(h)||k(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(h,_){if(h){if("string"==typeof h)return x(h,_);var b=Object.prototype.toString.call(h).slice(8,-1);return"Object"===b&&h.constructor&&(b=h.constructor.name),"Map"===b||"Set"===b?Array.from(h):"Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?x(h,_):void 0}}function x(h,_){(null==_||_>h.length)&&(_=h.length);for(var b=0,w=new Array(_);b<_;b++)w[b]=h[b];return w}var e=v("color-normalize"),r=v("array-bounds"),i=v("color-id"),c=v("@plotly/point-cluster"),n=v("object-assign"),m=v("glslify"),p=v("pick-by-alias"),s=v("update-diff"),f=v("flatten-vertex-data"),l=v("is-iexplorer"),o=v("to-float32"),d=v("parse-rect"),u=a;function a(h,_){var b=this;if(!(this instanceof a))return new a(h,_);"function"==typeof h?(_||(_={}),_.regl=h):(_=h,h=null),_&&_.length&&(_.positions=_);var w,T=(h=_.regl)._gl,L=[];this.tooManyColors=l,w=h.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),n(this,{regl:h,gl:T,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:w,maxColors:255,maxSize:100,canvas:T.canvas}),this.update(_);var M={uniforms:{constPointSize:!!_.constPointSize,opacity:h.prop("opacity"),paletteSize:function(S,C){return[b.tooManyColors?0:255,w.height]},pixelRatio:h.context("pixelRatio"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translate:h.prop("translate"),translateFract:h.prop("translateFract"),markerTexture:h.prop("markerTexture"),paletteTexture:w},attributes:{x:function(S,C){return C.xAttr||{buffer:C.positionBuffer,stride:8,offset:0}},y:function(S,C){return C.yAttr||{buffer:C.positionBuffer,stride:8,offset:4}},xFract:function(S,C){return C.xAttr?{constant:[0,0]}:{buffer:C.positionFractBuffer,stride:8,offset:0}},yFract:function(S,C){return C.yAttr?{constant:[0,0]}:{buffer:C.positionFractBuffer,stride:8,offset:4}},size:function(S,C){return C.size.length?{buffer:C.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*C.size/b.maxSize)]}},borderSize:function(S,C){return C.borderSize.length?{buffer:C.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*C.borderSize/b.maxSize)]}},colorId:function(S,C){return C.color.length?{buffer:C.colorBuffer,stride:b.tooManyColors?8:4,offset:0}:{constant:b.tooManyColors?L.slice(4*C.color,4*C.color+4):[C.color]}},borderColorId:function(S,C){return C.borderColor.length?{buffer:C.colorBuffer,stride:b.tooManyColors?8:4,offset:b.tooManyColors?4:2}:{constant:b.tooManyColors?L.slice(4*C.borderColor,4*C.borderColor+4):[C.borderColor]}},isActive:function(S,C){return!0===C.activation?{constant:[1]}:C.activation?C.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:h.prop("elements"),count:h.prop("count"),offset:h.prop("offset"),primitive:"points"},P=n({},M);P.frag=m(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\nuniform sampler2D markerTexture;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),P.vert=m(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=h(P);var z=n({},M);z.frag=m(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nuniform float opacity;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),z.vert=m(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 paletteSize, scale, scaleFract, translate, translateFract;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),l&&(z.frag=z.frag.replace("smoothstep","smoothStep"),P.frag=P.frag.replace("smoothstep","smoothStep")),this.drawCircle=h(z)}a.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},a.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},a.prototype.draw=function(){for(var h=this,_=arguments.length,b=new Array(_),w=0;w<_;w++)b[w]=arguments[w];var T=this.groups;if(1===b.length&&Array.isArray(b[0])&&(null===b[0][0]||Array.isArray(b[0][0]))&&(b=b[0]),this.regl._refresh(),b.length)for(var L=0;L<b.length;L++)this.drawItem(L,b[L]);else T.forEach(function(M,P){h.drawItem(P)});return this},a.prototype.drawItem=function(h,_){var b=this.groups,w=b[h];if("number"==typeof _&&(h=_,w=b[_],_=null),w&&w.count&&w.opacity){w.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,w,_));for(var T=[],L=1;L<w.activation.length;L++)w.activation[L]&&(!0===w.activation[L]||w.activation[L].data.length)&&T.push.apply(T,t(this.getMarkerDrawOptions(L,w,_)));T.length&&this.drawMarker(T)}},a.prototype.getMarkerDrawOptions=function(h,_,b){var w=_.range,T=_.tree,L=_.viewport,M=_.activation,P=_.selectionBuffer,z=_.count;if(!T)return b?[n({},_,{markerTexture:this.markerTextures[h],activation:M[h],count:b.length,elements:b,offset:0})]:[n({},_,{markerTexture:this.markerTextures[h],activation:M[h],offset:0})];var S=[],C=T.range(w,{lod:!0,px:[(w[2]-w[0])/L.width,(w[3]-w[1])/L.height]});if(b){for(var R=M[h].data,D=new Uint8Array(z),j=0;j<b.length;j++){var q=b[j];D[q]=R?R[q]:1}P.subdata(D)}for(var Z=C.length;Z--;){var W=g(C[Z],2),G=W[0];S.push(n({},_,{markerTexture:this.markerTextures[h],activation:b?P:M[h],offset:G,count:W[1]-G}))}return S},a.prototype.update=function(){for(var h=this,_=arguments.length,b=new Array(_),w=0;w<_;w++)b[w]=arguments[w];if(b.length){1===b.length&&Array.isArray(b[0])&&(b=b[0]);var T=this.groups,L=this.gl,M=this.regl,P=this.maxSize,z=this.maxColors,S=this.palette;this.groups=T=b.map(function(C,R){var D=T[R];if(void 0===C)return D;null===C?C={positions:null}:"function"==typeof C?C={ondraw:C}:"number"==typeof C[0]&&(C={positions:C}),null===(C=p(C,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(C.positions=[]),null!=C.tooManyColors&&(h.tooManyColors=C.tooManyColors),D||(T[R]=D={id:R,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:M.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},C=n({},a.defaults,C)),C.positions&&!("marker"in C)&&(C.marker=D.marker,delete D.marker),C.marker&&!("positions"in C)&&(C.positions=D.positions,delete D.positions);var j=0,q=0;if(s(D,C,[{snap:!0,size:function(fe,xe){return null==fe&&(fe=a.defaults.size),j+=fe&&fe.length?1:0,fe},borderSize:function(fe,xe){return null==fe&&(fe=a.defaults.borderSize),j+=fe&&fe.length?1:0,fe},opacity:parseFloat,color:function(fe,xe){return null==fe&&(fe=a.defaults.color),fe=h.updateColor(fe),q++,fe},borderColor:function(fe,xe){return null==fe&&(fe=a.defaults.borderColor),fe=h.updateColor(fe),q++,fe},bounds:function(fe,xe,Se){return"range"in Se||(Se.range=null),fe},positions:function(fe,xe,Se){var pe=xe.snap,ge=xe.positionBuffer,Te=xe.positionFractBuffer,se=xe.selectionBuffer;if(fe.x||fe.y)return xe.xAttr=fe.x.length?{buffer:M.buffer(fe.x),offset:0,stride:4,count:fe.x.length}:{buffer:fe.x.buffer,offset:4*fe.x.offset||0,stride:4*(fe.x.stride||1),count:fe.x.count},xe.yAttr=fe.y.length?{buffer:M.buffer(fe.y),offset:0,stride:4,count:fe.y.length}:{buffer:fe.y.buffer,offset:4*fe.y.offset||0,stride:4*(fe.y.stride||1),count:fe.y.count},xe.count=Math.max(xe.xAttr.count,xe.yAttr.count),fe;fe=f(fe,"float64");var de=xe.count=Math.floor(fe.length/2),Ae=xe.bounds=de?r(fe,2):null;if(Se.range||xe.range||(delete xe.range,Se.range=Ae),Se.marker||xe.marker||(delete xe.marker,Se.marker=null),pe&&(!0===pe||de>pe)?xe.tree=c(fe,{bounds:Ae}):pe&&pe.length&&(xe.tree=pe),xe.tree){var Le={primitive:"points",usage:"static",data:xe.tree,type:"uint32"};xe.elements?xe.elements(Le):xe.elements=M.elements(Le)}var Me=o.float32(fe);return ge({data:Me,usage:"dynamic"}),Te({data:o.fract32(fe,Me),usage:"dynamic"}),se({data:new Uint8Array(de),type:"uint8",usage:"stream"}),fe}},{marker:function(fe,xe,Se){var pe=xe.activation;if(pe.forEach(function(Me){return Me&&Me.destroy&&Me.destroy()}),pe.length=0,fe&&"number"!=typeof fe[0]){for(var ge=[],Te=0,se=Math.min(fe.length,xe.count);Te<se;Te++){var de=h.addMarker(fe[Te]);ge[de]||(ge[de]=new Uint8Array(xe.count)),ge[de][Te]=1}for(var Ae=0;Ae<ge.length;Ae++)if(ge[Ae]){var Le={data:ge[Ae],type:"uint8",usage:"static"};pe[Ae]?pe[Ae](Le):pe[Ae]=M.buffer(Le),pe[Ae].data=ge[Ae]}}else pe[h.addMarker(fe)]=!0;return fe},range:function(fe,xe,Se){var pe=xe.bounds;if(pe)return fe||(fe=pe),xe.scale=[1/(fe[2]-fe[0]),1/(fe[3]-fe[1])],xe.translate=[-fe[0],-fe[1]],xe.scaleFract=o.fract(xe.scale),xe.translateFract=o.fract(xe.translate),fe},viewport:function(fe){return d(fe||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),j){var W=D.count,G=D.size,X=D.borderSize,ne=D.sizeBuffer,V=new Uint8Array(2*W);if(G.length||X.length)for(var N=0;N<W;N++)V[2*N]=Math.round(255*(null==G[N]?G:G[N])/P),V[2*N+1]=Math.round(255*(null==X[N]?X:X[N])/P);ne({data:V,usage:"dynamic"})}if(q){var U,B=D.count,K=D.color,J=D.borderColor,te=D.colorBuffer;if(h.tooManyColors){if(K.length||J.length){U=new Uint8Array(8*B);for(var ae=0;ae<B;ae++){var ce=K[ae];U[8*ae]=S[4*ce],U[8*ae+1]=S[4*ce+1],U[8*ae+2]=S[4*ce+2],U[8*ae+3]=S[4*ce+3];var oe=J[ae];U[8*ae+4]=S[4*oe],U[8*ae+5]=S[4*oe+1],U[8*ae+6]=S[4*oe+2],U[8*ae+7]=S[4*oe+3]}}}else if(K.length||J.length){U=new Uint8Array(4*B+2);for(var ve=0;ve<B;ve++)null!=K[ve]&&(U[4*ve]=K[ve]%z,U[4*ve+1]=Math.floor(K[ve]/z)),null!=J[ve]&&(U[4*ve+2]=J[ve]%z,U[4*ve+3]=Math.floor(J[ve]/z))}te({data:U||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return D})}},a.prototype.addMarker=function(h){var _,b=this.markerTextures,w=this.regl,T=this.markerCache,L=null==h?0:T.indexOf(h);if(L>=0)return L;if(h instanceof Uint8Array||h instanceof Uint8ClampedArray)_=h;else{_=new Uint8Array(h.length);for(var M=0,P=h.length;M<P;M++)_[M]=255*h[M]}var z=Math.floor(Math.sqrt(_.length));return L=b.length,T.push(h),b.push(w.texture({channels:1,data:_,radius:z,mag:"linear",min:"linear"})),L},a.prototype.updateColor=function(h){var _=this.paletteIds,b=this.palette,w=this.maxColors;Array.isArray(h)||(h=[h]);var T=[];if("number"==typeof h[0]){var L=[];if(Array.isArray(h))for(var M=0;M<h.length;M+=4)L.push(h.slice(M,M+4));else for(var P=0;P<h.length;P+=4)L.push(h.subarray(P,P+4));h=L}for(var z=0;z<h.length;z++){var S=h[z];S=e(S,"uint8");var C=i(S,!1);if(null==_[C]){var R=b.length;_[C]=Math.floor(R/4),b[R]=S[0],b[R+1]=S[1],b[R+2]=S[2],b[R+3]=S[3]}T[z]=_[C]}return!this.tooManyColors&&b.length>4*w&&(this.tooManyColors=!0),this.updatePalette(b),1===T.length?T[0]:T},a.prototype.updatePalette=function(h){if(!this.tooManyColors){var _=this.maxColors,b=this.paletteTexture,w=Math.ceil(.25*h.length/_);if(w>1)for(var T=.25*(h=h.slice()).length%_;T<w*_;T++)h.push(0,0,0,0);b.height<w&&b.resize(_,w),b.subimage({width:Math.min(.25*h.length,_),height:w,data:h},0,0)}},a.prototype.destroy=function(){return this.groups.forEach(function(h){h.sizeBuffer.destroy(),h.positionBuffer.destroy(),h.positionFractBuffer.destroy(),h.colorBuffer.destroy(),h.activation.forEach(function(_){return _&&_.destroy&&_.destroy()}),h.selectionBuffer.destroy(),h.elements&&h.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(h){return h&&h.destroy&&h.destroy()}),this};var y=v("object-assign");Q.exports=function(h,_){var b=new u(h,_),w=b.render.bind(b);return y(w,{render:w,update:b.update.bind(b),draw:b.draw.bind(b),destroy:b.destroy.bind(b),regl:b.regl,gl:b.gl,canvas:b.gl.canvas,groups:b.groups,markers:b.markerCache,palette:b.palette}),w}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(v,Q,$){"use strict";var g=v("regl-scatter2d"),t=v("pick-by-alias"),k=v("array-bounds"),x=v("raf"),e=v("array-range"),r=v("parse-rect"),i=v("flatten-vertex-data");function c(s,f){if(!(this instanceof c))return new c(s,f);this.traces=[],this.passes={},this.regl=s,this.scatter=g(s),this.canvas=this.scatter.canvas}function n(s,f,l){return(null!=s.id?s.id:s)<<16|(255&f)<<8|255&l}function m(s,f,l){var o,d,u,a,y=s[f],h=s[l];return y.length>2?(o=y[1],d=y[3]):y.length?(o=y[0],d=y[1]):(o=y.y,d=y.y+y.height),h.length>2?(u=h[0],a=h[2]):h.length?(u=h[0],a=h[1]):(u=h.x,a=h.x+h.width),[u,o,a,d]}function p(s){if("number"==typeof s)return[s,s,s,s];if(2===s.length)return[s[0],s[1],s[0],s[1]];var f=r(s);return[f.x,f.y,f.x+f.width,f.y+f.height]}Q.exports=c,c.prototype.render=function(){for(var s,f=this,l=[],o=arguments.length;o--;)l[o]=arguments[o];return l.length&&(s=this).update.apply(s,l),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?null==this.planned&&(this.planned=x(function(){f.draw(),f.dirty=!0,f.planned=null})):(this.draw(),this.dirty=!0,x(function(){f.dirty=!1})),this)},c.prototype.update=function(){for(var s,f=[],l=arguments.length;l--;)f[l]=arguments[l];if(f.length){for(var o=0;o<f.length;o++)this.updateItem(o,f[o]);this.traces=this.traces.filter(Boolean);for(var d=[],u=0,a=0;a<this.traces.length;a++){for(var y=this.traces[a],h=this.traces[a].passes,_=0;_<h.length;_++)d.push(this.passes[h[_]]);y.passOffset=u,u+=y.passes.length}return(s=this.scatter).update.apply(s,d),this}},c.prototype.updateItem=function(s,f){var l=this.regl;if(null===f)return this.traces[s]=null,this;if(!f)return this;var o,d=t(f,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),u=this.traces[s]||(this.traces[s]={id:s,buffer:l.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:r([l._gl.drawingBufferWidth,l._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=d.color&&(u.color=d.color),null!=d.size&&(u.size=d.size),null!=d.marker&&(u.marker=d.marker),null!=d.borderColor&&(u.borderColor=d.borderColor),null!=d.borderSize&&(u.borderSize=d.borderSize),null!=d.opacity&&(u.opacity=d.opacity),d.viewport&&(u.viewport=r(d.viewport)),null!=d.diagonal&&(u.diagonal=d.diagonal),null!=d.upper&&(u.upper=d.upper),null!=d.lower&&(u.lower=d.lower),d.data){u.buffer(i(d.data)),u.columns=d.data.length,u.count=d.data[0].length,u.bounds=[];for(var a=0;a<u.columns;a++)u.bounds[a]=k(d.data[a],1)}d.range&&(u.range=d.range,o=u.range&&"number"!=typeof u.range[0]),d.domain&&(u.domain=d.domain);var y=!1;null!=d.padding&&(Array.isArray(d.padding)&&d.padding.length===u.columns&&"number"==typeof d.padding[d.padding.length-1]?(u.padding=d.padding.map(p),y=!0):u.padding=p(d.padding));var h=u.columns,_=u.count,b=u.viewport.width,w=u.viewport.height,T=u.viewport.x,L=u.viewport.y,M=b/h,P=w/h;u.passes=[];for(var z=0;z<h;z++)for(var S=0;S<h;S++)if((u.diagonal||S!==z)&&(u.upper||!(z>S))&&(u.lower||!(z<S))){var C=n(u.id,z,S),R=this.passes[C]||(this.passes[C]={});if(d.data&&(R.positions=d.transpose?{x:{buffer:u.buffer,offset:S,count:_,stride:h},y:{buffer:u.buffer,offset:z,count:_,stride:h}}:{x:{buffer:u.buffer,offset:S*_,count:_},y:{buffer:u.buffer,offset:z*_,count:_}},R.bounds=m(u.bounds,z,S)),d.domain||d.viewport||d.data){var D=y?m(u.padding,z,S):u.padding;if(u.domain){var j=m(u.domain,z,S);R.viewport=[T+j[0]*b+D[0],L+j[1]*w+D[1],T+j[2]*b-D[2],L+j[3]*w-D[3]]}else R.viewport=[T+S*M+M*D[0],L+z*P+P*D[1],T+(S+1)*M-M*D[2],L+(z+1)*P-P*D[3]]}d.color&&(R.color=u.color),d.size&&(R.size=u.size),d.marker&&(R.marker=u.marker),d.borderSize&&(R.borderSize=u.borderSize),d.borderColor&&(R.borderColor=u.borderColor),d.opacity&&(R.opacity=u.opacity),d.range&&(R.range=o?m(u.range,z,S):u.range||R.bounds),u.passes.push(C)}return this},c.prototype.draw=function(){for(var s,f=[],l=arguments.length;l--;)f[l]=arguments[l];if(f.length){for(var o=[],d=0;d<f.length;d++)if("number"==typeof f[d]){var u=this.traces[f[d]],y=u.passOffset;o.push.apply(o,e(y,y+u.passes.length))}else if(f[d].length){var h=f[d],_=this.traces[d],b=_.passes,w=_.passOffset;b=b.map(function(T,L){o[w+L]=h})}(s=this.scatter).draw.apply(s,o)}else this.scatter.draw();return this},c.prototype.destroy=function(){return this.traces.forEach(function(s){s.buffer&&s.buffer.destroy&&s.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(v,Q,$){var t;t=function(){function g(he,be){this.id=K++,this.type=he,this.data=be}function t(he){return"["+function be(Fe){if(0===Fe.length)return[];var He=Fe.charAt(0),Ke=Fe.charAt(Fe.length-1);if(1<Fe.length&&He===Ke&&('"'===He||"'"===He))return['"'+Fe.substr(1,Fe.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(He=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Fe))return be(Fe.substr(0,He.index)).concat(be(He[1])).concat(be(Fe.substr(He.index+He[0].length)));if(1===(He=Fe.split(".")).length)return['"'+Fe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Fe=[],Ke=0;Ke<He.length;++Ke)Fe=Fe.concat(be(He[Ke]));return Fe}(he).join("][")+"]"}function k(he){return"string"==typeof he?he.split():he}function x(he){return"string"==typeof he?document.querySelector(he):he}function r(he,be){for(var Fe=Array(he),He=0;He<he;++He)Fe[He]=be(He);return Fe}function i(he){var be,Fe;return be=(65535<he)<<4,be|=Fe=(255<(he>>>=be))<<3,(be|=Fe=(15<(he>>>=Fe))<<2)|(Fe=(3<(he>>>=Fe))<<1)|he>>>Fe>>1}function c(){function he(He){e:{for(var Ke=16;268435456>=Ke;Ke*=16)if(He<=Ke){He=Ke;break e}He=0}return 0<(Ke=Fe[i(He)>>2]).length?Ke.pop():new ArrayBuffer(He)}function be(He){Fe[i(He.byteLength)>>2].push(He)}var Fe=r(8,function(){return[]});return{alloc:he,free:be,allocType:function(He,Ke){var Ze=null;switch(He){case 5120:Ze=new Int8Array(he(Ke),0,Ke);break;case 5121:Ze=new Uint8Array(he(Ke),0,Ke);break;case 5122:Ze=new Int16Array(he(2*Ke),0,Ke);break;case 5123:Ze=new Uint16Array(he(2*Ke),0,Ke);break;case 5124:Ze=new Int32Array(he(4*Ke),0,Ke);break;case 5125:Ze=new Uint32Array(he(4*Ke),0,Ke);break;case 5126:Ze=new Float32Array(he(4*Ke),0,Ke);break;default:return null}return Ze.length!==Ke?Ze.subarray(0,Ke):Ze},freeType:function(He){be(He.buffer)}}}function n(he){return!!he&&"object"==typeof he&&Array.isArray(he.shape)&&Array.isArray(he.stride)&&"number"==typeof he.offset&&he.shape.length===he.stride.length&&(Array.isArray(he.data)||ve(he.data))}function m(he,be,Fe,He,Ke,Ze){for(var ut=0;ut<be;++ut)for(var lt=he[ut],Lt=0;Lt<Fe;++Lt)for(var Ot=lt[Lt],ot=0;ot<He;++ot)Ke[Ze++]=Ot[ot]}function p(he){return 0|Se[Object.prototype.toString.call(he)]}function s(he,be){for(var Fe=0;Fe<be.length;++Fe)he[Fe]=be[Fe]}function f(he,be,Fe,He,Ke,Ze,ut){for(var lt=0,Lt=0;Lt<Fe;++Lt)for(var Ot=0;Ot<He;++Ot)he[lt++]=be[Ke*Lt+Ze*Ot+ut]}function d(he){for(var be=ce.allocType(5123,he.length),Fe=0;Fe<he.length;++Fe)if(isNaN(he[Fe]))be[Fe]=65535;else if(1/0===he[Fe])be[Fe]=31744;else if(-1/0===he[Fe])be[Fe]=64512;else{Le[0]=he[Fe];var He=(Ze=Me[0])>>>31<<15,Ke=(Ze<<1>>>24)-127,Ze=Ze>>13&1023;be[Fe]=-24>Ke?He:-14>Ke?He+(Ze+1024>>-14-Ke):15<Ke?He+31744:He+(Ke+15<<10)+Ze}return be}function u(he){return Array.isArray(he)||ve(he)}function a(he){return"[object "+he+"]"}function y(he){return Array.isArray(he)&&(0===he.length||"number"==typeof he[0])}function h(he){return!(!Array.isArray(he)||0===he.length||!u(he[0]))}function _(he){return Object.prototype.toString.call(he)}function b(he){if(!he)return!1;var be=_(he);return 0<=ct.indexOf(be)||y(he)||h(he)||n(he)}function w(he,be){36193===he.type?(he.data=d(be),ce.freeType(be)):he.data=be}function T(he,be,Fe,He,Ke,Ze){if(he=void 0!==kt[he]?kt[he]:Ie[he]*wt[be],Ze&&(he*=6),Ke){for(He=0;1<=Fe;)He+=he*Fe*Fe,Fe/=2;return He}return he*Fe*He}function P(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function R(he,be){return he>>>be|he<<32-be}function D(he,be){var Fe=(65535&he)+(65535&be);return(he>>16)+(be>>16)+(Fe>>16)<<16|65535&Fe}function j(he){return Array.prototype.slice.call(he)}function q(he){return j(he).join("")}function W(he){return Array.isArray(he)||ve(he)||n(he)}function G(he){return he.sort(function(be,Fe){return"viewport"===be?-1:"viewport"===Fe?1:be<Fe?-1:1})}function X(he,be,Fe,He){this.thisDep=he,this.contextDep=be,this.propDep=Fe,this.append=He}function ne(he){return he&&!(he.thisDep||he.contextDep||he.propDep)}function V(he){return new X(!1,!1,!1,he)}function N(he,be){var Fe=he.type;if(0===Fe)return new X(!0,1<=(Fe=he.data.length),2<=Fe,be);if(4===Fe)return new X((Fe=he.data).thisDep,Fe.contextDep,Fe.propDep,be);if(5===Fe)return new X(!1,!1,!1,be);if(6===Fe){for(var He=Fe=!1,Ke=!1,Ze=0;Ze<he.data.length;++Ze){var ut=he.data[Ze];1===ut.type?Ke=!0:2===ut.type?He=!0:3===ut.type?Fe=!0:0===ut.type?(Fe=!0,1<=(ut=ut.data)&&(He=!0),2<=ut&&(Ke=!0)):4===ut.type&&(Fe=Fe||ut.data.thisDep,He=He||ut.data.contextDep,Ke=Ke||ut.data.propDep)}return new X(Fe,He,Ke,be)}return new X(3===Fe,2===Fe,1===Fe,be)}function U(he,be,Fe,He,Ke,Ze,ut,lt,Lt,Ot,ot,pt,qt,St,Mt,Ce){function Xe(It){return It.replace(".","_")}function st(It,hn,yn){var Hn=Xe(It);$r.push(It),dr[Hn]=sr[Hn]=!!yn,Lr[Hn]=hn}function dt(It,hn,yn){var Hn=Xe(It);$r.push(It),Array.isArray(yn)?(sr[Hn]=yn.slice(),dr[Hn]=yn.slice()):sr[Hn]=dr[Hn]=yn,jr[Hn]=hn}function zt(){var It=function Z(he){function be(){var ot=[],pt=[];return B(function(){ot.push.apply(ot,j(arguments))},{def:function(){var qt="v"+Ke++;return pt.push(qt),0<arguments.length&&(ot.push(qt,"="),ot.push.apply(ot,j(arguments)),ot.push(";")),qt},toString:function(){return q([0<pt.length?"var "+pt.join(",")+";":"",q(ot)])}})}function Fe(){function ot(Ce,Xe){qt(Ce,Xe,"=",pt.def(Ce,Xe),";")}var pt=be(),qt=be(),St=pt.toString,Mt=qt.toString;return B(function(){pt.apply(pt,j(arguments))},{def:pt.def,entry:pt,exit:qt,save:ot,set:function(Ce,Xe,st){ot(Ce,Xe),pt(Ce,Xe,"=",st,";")},toString:function(){return St()+Mt()}})}var He=he&&he.cache,Ke=0,Ze=[],ut=[],lt=[],Lt=be(),Ot={};return{global:Lt,link:function(ot,pt){var qt=pt&&pt.stable;if(!qt)for(var St=0;St<ut.length;++St)if(ut[St]===ot&&!lt[St])return Ze[St];return St="g"+Ke++,Ze.push(St),ut.push(ot),lt.push(qt),St},block:be,proc:function(ot,pt){function qt(){var Xe="a"+St.length;return St.push(Xe),Xe}var St=[];pt=pt||0;for(var Mt=0;Mt<pt;++Mt)qt();var Ce=(Mt=Fe()).toString;return Ot[ot]=B(Mt,{arg:qt,toString:function(){return q(["function(",St.join(),"){",Ce(),"}"])}})},scope:Fe,cond:function(){var ot=q(arguments),pt=Fe(),qt=Fe(),St=pt.toString,Mt=qt.toString;return B(pt,{then:function(){return pt.apply(pt,j(arguments)),this},else:function(){return qt.apply(qt,j(arguments)),this},toString:function(){var Ce=Mt();return Ce&&(Ce="else{"+Ce+"}"),q(["if(",ot,"){",St(),"}",Ce])}})},compile:function(){var ot=['"use strict";',Lt,"return {"];Object.keys(Ot).forEach(function(St){ot.push('"',St,'":',Ot[St].toString(),",")}),ot.push("}");var pt,qt=q(ot).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return He&&(pt=function(St){for(var Mt,Ce="",Xe=0;Xe<St.length;Xe++)Mt=St.charCodeAt(Xe),Ce+="0123456789abcdef".charAt(Mt>>>4&15)+"0123456789abcdef".charAt(15&Mt);return Ce}(function(St){for(var Mt=Array(St.length>>2),Ce=0;Ce<Mt.length;Ce++)Mt[Ce]=0;for(Ce=0;Ce<8*St.length;Ce+=8)Mt[Ce>>5]|=(255&St.charCodeAt(Ce/8))<<24-Ce%32;var Xe,st,dt,zt,Ht,Kt,Zt,vn,zn,gn,nn,an=8*St.length;for(St=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ce=Array(64),Mt[an>>5]|=128<<24-an%32,Mt[15+(an+64>>9<<4)]=an,vn=0;vn<Mt.length;vn+=16){for(an=St[0],Xe=St[1],st=St[2],dt=St[3],zt=St[4],Ht=St[5],Kt=St[6],Zt=St[7],zn=0;64>zn;zn++){var on;16>zn?Ce[zn]=Mt[zn+vn]:(gn=zn,nn=D(nn=R(nn=Ce[zn-2],17)^R(nn,19)^nn>>>10,Ce[zn-7]),on=R(on=Ce[zn-15],7)^R(on,18)^on>>>3,Ce[gn]=D(D(nn,on),Ce[zn-16])),gn=D(D(D(D(Zt,gn=R(gn=zt,6)^R(gn,11)^R(gn,25)),zt&Ht^~zt&Kt),Vt[zn]),Ce[zn]),nn=D(Zt=R(Zt=an,2)^R(Zt,13)^R(Zt,22),an&Xe^an&st^Xe&st),Zt=Kt,Kt=Ht,Ht=zt,zt=D(dt,gn),dt=st,st=Xe,Xe=an,an=D(gn,nn)}St[0]=D(an,St[0]),St[1]=D(Xe,St[1]),St[2]=D(st,St[2]),St[3]=D(dt,St[3]),St[4]=D(zt,St[4]),St[5]=D(Ht,St[5]),St[6]=D(Kt,St[6]),St[7]=D(Zt,St[7])}for(Mt="",Ce=0;Ce<32*St.length;Ce+=8)Mt+=String.fromCharCode(St[Ce>>5]>>>24-Ce%32&255);return Mt}(function(St){for(var Mt,Ce,Xe="",st=-1;++st<St.length;)Mt=St.charCodeAt(st),Ce=st+1<St.length?St.charCodeAt(st+1):0,55296<=Mt&&56319>=Mt&&56320<=Ce&&57343>=Ce&&(Mt=65536+((1023&Mt)<<10)+(1023&Ce),st++),127>=Mt?Xe+=String.fromCharCode(Mt):2047>=Mt?Xe+=String.fromCharCode(192|Mt>>>6&31,128|63&Mt):65535>=Mt?Xe+=String.fromCharCode(224|Mt>>>12&15,128|Mt>>>6&63,128|63&Mt):2097151>=Mt&&(Xe+=String.fromCharCode(240|Mt>>>18&7,128|Mt>>>12&63,128|Mt>>>6&63,128|63&Mt));return Xe}(qt))),He[pt])?He[pt].apply(null,ut):(qt=Function.apply(null,Ze.concat(qt)),He&&(He[pt]=qt),qt.apply(null,ut))}}}({cache:Mt}),hn=It.link,yn=It.global;It.id=wn++,It.batchId="0";var Hn=hn(ri),Un=It.shared={props:"a0"};Object.keys(ri).forEach(function(Ln){Un[Ln]=yn.def(Hn,".",Ln)});var jn=It.next={},On=It.current={};Object.keys(jr).forEach(function(Ln){Array.isArray(sr[Ln])&&(jn[Ln]=yn.def(Un.next,".",Ln),On[Ln]=yn.def(Un.current,".",Ln))});var kn=It.constants={};Object.keys(sn).forEach(function(Ln){kn[Ln]=yn.def(JSON.stringify(sn[Ln]))}),It.invoke=function(Ln,Dn){switch(Dn.type){case 0:var Kn=["this",Un.context,Un.props,It.batchId];return Ln.def(hn(Dn.data),".call(",Kn.slice(0,Math.max(Dn.data.length+1,4)),")");case 1:return Ln.def(Un.props,Dn.data);case 2:return Ln.def(Un.context,Dn.data);case 3:return Ln.def("this",Dn.data);case 4:return Dn.data.append(It,Ln),Dn.data.ref;case 5:return Dn.data.toString();case 6:return Dn.data.map(function(Qn){return It.invoke(Ln,Qn)})}},It.attribCache={};var Mn={};return It.scopeAttrib=function(Ln){if((Ln=be.id(Ln))in Mn)return Mn[Ln];var Dn=Ot.scope[Ln];return Dn||(Dn=Ot.scope[Ln]=new Cr),Mn[Ln]=hn(Dn)},It}function zn(It,hn,yn,Hn,Un){function jn(Mr){var Er=kn[Mr];Er&&(Ln[Mr]=Er)}var Mr,Pr,Ur,Yr,On=function(Mr,Er){if("string"==typeof(Pr=Mr.static).frag&&"string"==typeof Pr.vert){if(0<Object.keys(Er.dynamic).length)return null;var Pr=Er.static,Ur=Object.keys(Pr);if(0<Ur.length&&"number"==typeof Pr[Ur[0]]){for(var Yr=[],si=0;si<Ur.length;++si)Yr.push([0|Pr[Ur[si]],Ur[si]]);return Yr}}return null}(It,hn),kn=function(Mr,Er,Pr){function Ur(Ri){if(Ri in Yr){var Fr=Yr[Ri];Ri=!0;var fi,ci,Yi=0|Fr.x,Ta=0|Fr.y;return"width"in Fr?fi=0|Fr.width:Ri=!1,"height"in Fr?ci=0|Fr.height:Ri=!1,new X(!Ri&&Er&&Er.thisDep,!Ri&&Er&&Er.contextDep,!Ri&&Er&&Er.propDep,function(go,ra){var ia=go.shared.context,so=fi;"width"in Fr||(so=ra.def(ia,".","framebufferWidth","-",Yi));var Zi=ci;return"height"in Fr||(Zi=ra.def(ia,".","framebufferHeight","-",Ta)),[Yi,Ta,so,Zi]})}if(Ri in si){var Ba=si[Ri];return Ri=N(Ba,function(go,ra){var ia=go.invoke(ra,Ba),so=go.shared.context,Zi=ra.def(ia,".x|0"),Ra=ra.def(ia,".y|0");return[Zi,Ra,ra.def('"width" in ',ia,"?",ia,".width|0:","(",so,".","framebufferWidth","-",Zi,")"),ia=ra.def('"height" in ',ia,"?",ia,".height|0:","(",so,".","framebufferHeight","-",Ra,")")]}),Er&&(Ri.thisDep=Ri.thisDep||Er.thisDep,Ri.contextDep=Ri.contextDep||Er.contextDep,Ri.propDep=Ri.propDep||Er.propDep),Ri}return Er?new X(Er.thisDep,Er.contextDep,Er.propDep,function(go,ra){var ia=go.shared.context;return[0,0,ra.def(ia,".","framebufferWidth"),ra.def(ia,".","framebufferHeight")]}):null}var Yr=Mr.static,si=Mr.dynamic;if(Mr=Ur("viewport")){var Fi=Mr;Mr=new X(Mr.thisDep,Mr.contextDep,Mr.propDep,function(Ri,Fr){var fi=Fi.append(Ri,Fr),ci=Ri.shared.context;return Fr.set(ci,".viewportWidth",fi[2]),Fr.set(ci,".viewportHeight",fi[3]),fi})}return{viewport:Mr,scissor_box:Ur("scissor.box")}}(It,Kn=function Ht(It,hn){var yn=It.static,Hn=It.dynamic;if("framebuffer"in yn){var Un=yn.framebuffer;return Un?(Un=lt.getFramebuffer(Un),V(function(On,kn){var Mn=On.link(Un),Ln=On.shared;return kn.set(Ln.framebuffer,".next",Mn),kn.set(Ln=Ln.context,".framebufferWidth",Mn+".width"),kn.set(Ln,".framebufferHeight",Mn+".height"),Mn})):V(function(On,kn){var Mn=On.shared;return kn.set(Mn.framebuffer,".next","null"),kn.set(Mn=Mn.context,".framebufferWidth",Mn+".drawingBufferWidth"),kn.set(Mn,".framebufferHeight",Mn+".drawingBufferHeight"),"null"})}if("framebuffer"in Hn){var jn=Hn.framebuffer;return N(jn,function(On,kn){var Mn=On.invoke(kn,jn),Ln=On.shared,Dn=Ln.framebuffer;return Mn=kn.def(Dn,".getFramebuffer(",Mn,")"),kn.set(Dn,".next",Mn),kn.set(Ln=Ln.context,".framebufferWidth",Mn+"?"+Mn+".width:"+Ln+".drawingBufferWidth"),kn.set(Ln,".framebufferHeight",Mn+"?"+Mn+".height:"+Ln+".drawingBufferHeight"),Mn})}return null}(It)),Mn=function Zt(It,hn){function yn(hr,Mr){if(hr in Hn){var Er=0|Hn[hr];return Mr?jn.offset=Er:jn.instances=Er,V(function(Ur,Yr){return Mr&&(Ur.OFFSET=Er),Er})}if(hr in Un){var Pr=Un[hr];return N(Pr,function(Ur,Yr){var si=Ur.invoke(Yr,Pr);return Mr&&(Ur.OFFSET=si),si})}if(Mr){if(Mn)return V(function(Ur,Yr){return Ur.OFFSET=0});if(On)return new X(kn.thisDep,kn.contextDep,kn.propDep,function(Ur,Yr){return Yr.def(Ur.shared.vao+".currentVAO?"+Ur.shared.vao+".currentVAO.offset:0")})}else if(On)return new X(kn.thisDep,kn.contextDep,kn.propDep,function(Ur,Yr){return Yr.def(Ur.shared.vao+".currentVAO?"+Ur.shared.vao+".currentVAO.instances:-1")});return null}var Hn=It.static,Un=It.dynamic,jn={},On=!1,kn=function(){if("vao"in Hn){var hr=Hn.vao;return null!==hr&&null===Ot.getVAO(hr)&&(hr=Ot.createVAO(hr)),On=!0,jn.vao=hr,V(function(Er){var Pr=Ot.getVAO(hr);return Pr?Er.link(Pr):"null"})}if("vao"in Un){On=!0;var Mr=Un.vao;return N(Mr,function(Er,Pr){var Ur=Er.invoke(Pr,Mr);return Pr.def(Er.shared.vao+".getVAO("+Ur+")")})}return null}(),Mn=!1,Ln=function(){if("elements"in Hn){var hr=Hn.elements;if(jn.elements=hr,W(hr)){var Mr=jn.elements=Ze.create(hr,!0);hr=Ze.getElements(Mr),Mn=!0}else hr&&(hr=Ze.getElements(hr),Mn=!0);return(Mr=V(function(Pr,Ur){if(hr){var Yr=Pr.link(hr);return Pr.ELEMENTS=Yr}return Pr.ELEMENTS=null})).value=hr,Mr}if("elements"in Un){Mn=!0;var Er=Un.elements;return N(Er,function(Pr,Ur){var Yr=(si=Pr.shared).isBufferArgs,si=si.elements,Fi=Pr.invoke(Ur,Er),Ri=Ur.def("null");return Yr=Ur.def(Yr,"(",Fi,")"),Fi=Pr.cond(Yr).then(Ri,"=",si,".createStream(",Fi,");").else(Ri,"=",si,".getElements(",Fi,");"),Ur.entry(Fi),Ur.exit(Pr.cond(Yr).then(si,".destroyStream(",Ri,");")),Pr.ELEMENTS=Ri})}return On?new X(kn.thisDep,kn.contextDep,kn.propDep,function(Pr,Ur){return Ur.def(Pr.shared.vao+".currentVAO?"+Pr.shared.elements+".getElements("+Pr.shared.vao+".currentVAO.elements):null")}):null}(),Dn=yn("offset",!0),Kn=function(){if("primitive"in Hn){var hr=Hn.primitive;return jn.primitive=hr,V(function(Er,Pr){return Ae[hr]})}if("primitive"in Un){var Mr=Un.primitive;return N(Mr,function(Er,Pr){var Ur=Er.constants.primTypes,Yr=Er.invoke(Pr,Mr);return Pr.def(Ur,"[",Yr,"]")})}return Mn?ne(Ln)?V(Ln.value?function(Er,Pr){return Pr.def(Er.ELEMENTS,".primType")}:function(){return 4}):new X(Ln.thisDep,Ln.contextDep,Ln.propDep,function(Er,Pr){var Ur=Er.ELEMENTS;return Pr.def(Ur,"?",Ur,".primType:",4)}):On?new X(kn.thisDep,kn.contextDep,kn.propDep,function(Er,Pr){return Pr.def(Er.shared.vao+".currentVAO?"+Er.shared.vao+".currentVAO.primitive:4")}):null}(),Qn=function(){if("count"in Hn){var hr=0|Hn.count;return jn.count=hr,V(function(){return hr})}if("count"in Un){var Mr=Un.count;return N(Mr,function(Er,Pr){return Er.invoke(Pr,Mr)})}return Mn?ne(Ln)?Ln?Dn?new X(Dn.thisDep,Dn.contextDep,Dn.propDep,function(Er,Pr){return Pr.def(Er.ELEMENTS,".vertCount-",Er.OFFSET)}):V(function(Er,Pr){return Pr.def(Er.ELEMENTS,".vertCount")}):V(function(){return-1}):new X(Ln.thisDep||Dn.thisDep,Ln.contextDep||Dn.contextDep,Ln.propDep||Dn.propDep,function(Er,Pr){var Ur=Er.ELEMENTS;return Er.OFFSET?Pr.def(Ur,"?",Ur,".vertCount-",Er.OFFSET,":-1"):Pr.def(Ur,"?",Ur,".vertCount:-1")}):On?new X(kn.thisDep,kn.contextDep,kn.propDep,function(Er,Pr){return Pr.def(Er.shared.vao,".currentVAO?",Er.shared.vao,".currentVAO.count:-1")}):null}(),lr=yn("instances",!1);return{elements:Ln,primitive:Kn,count:Qn,instances:lr,offset:Dn,vao:kn,vaoActive:On,elementsActive:Mn,static:jn}}(It),Ln=(Pr=(Mr=It).static,Ur=Mr.dynamic,Yr={},$r.forEach(function(si){function Fi(Fr,fi){if(si in Pr){var ci=Fr(Pr[si]);Yr[Ri]=V(function(){return ci})}else if(si in Ur){var Yi=Ur[si];Yr[Ri]=N(Yi,function(Ta,Ba){return fi(Ta,Ba,Ta.invoke(Ba,Yi))})}}var Ri=Xe(si);switch(si){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":case"lineWidth":return Fi(function(Fr){return Fr},function(Fr,fi,ci){return ci});case"depth.func":return Fi(function(Fr){return cn[Fr]},function(Fr,fi,ci){return fi.def(Fr.constants.compareFuncs,"[",ci,"]")});case"depth.range":return Fi(function(Fr){return Fr},function(Fr,fi,ci){return[fi.def("+",ci,"[0]"),fi=fi.def("+",ci,"[1]")]});case"blend.func":return Fi(function(Fr){return[Jt["srcRGB"in Fr?Fr.srcRGB:Fr.src],Jt["dstRGB"in Fr?Fr.dstRGB:Fr.dst],Jt["srcAlpha"in Fr?Fr.srcAlpha:Fr.src],Jt["dstAlpha"in Fr?Fr.dstAlpha:Fr.dst]]},function(Fr,fi,ci){function Yi(ra,ia){return fi.def('"',ra,ia,'" in ',ci,"?",ci,".",ra,ia,":",ci,".",ra)}Fr=Fr.constants.blendFuncs;var Ta=Yi("src","RGB"),Ba=Yi("dst","RGB"),go=(Ta=fi.def(Fr,"[",Ta,"]"),fi.def(Fr,"[",Yi("src","Alpha"),"]"));return[Ta,Ba=fi.def(Fr,"[",Ba,"]"),go,Fr=fi.def(Fr,"[",Yi("dst","Alpha"),"]")]});case"blend.equation":return Fi(function(Fr){return"string"==typeof Fr?[pi[Fr],pi[Fr]]:"object"==typeof Fr?[pi[Fr.rgb],pi[Fr.alpha]]:void 0},function(Fr,fi,ci){var Yi=Fr.constants.blendEquations,Ta=fi.def(),Ba=fi.def();return(Fr=Fr.cond("typeof ",ci,'==="string"')).then(Ta,"=",Ba,"=",Yi,"[",ci,"];"),Fr.else(Ta,"=",Yi,"[",ci,".rgb];",Ba,"=",Yi,"[",ci,".alpha];"),fi(Fr),[Ta,Ba]});case"blend.color":return Fi(function(Fr){return r(4,function(fi){return+Fr[fi]})},function(Fr,fi,ci){return r(4,function(Yi){return fi.def("+",ci,"[",Yi,"]")})});case"stencil.mask":return Fi(function(Fr){return 0|Fr},function(Fr,fi,ci){return fi.def(ci,"|0")});case"stencil.func":return Fi(function(Fr){return[cn[Fr.cmp||"keep"],Fr.ref||0,"mask"in Fr?Fr.mask:-1]},function(Fr,fi,ci){return[Fr=fi.def('"cmp" in ',ci,"?",Fr.constants.compareFuncs,"[",ci,".cmp]",":",7680),fi.def(ci,".ref|0"),fi=fi.def('"mask" in ',ci,"?",ci,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return Fi(function(Fr){return["stencil.opBack"===si?1029:1028,Rt[Fr.fail||"keep"],Rt[Fr.zfail||"keep"],Rt[Fr.zpass||"keep"]]},function(Fr,fi,ci){function Yi(Ba){return fi.def('"',Ba,'" in ',ci,"?",Ta,"[",ci,".",Ba,"]:",7680)}var Ta=Fr.constants.stencilOps;return["stencil.opBack"===si?1029:1028,Yi("fail"),Yi("zfail"),Yi("zpass")]});case"polygonOffset.offset":return Fi(function(Fr){return[0|Fr.factor,0|Fr.units]},function(Fr,fi,ci){return[fi.def(ci,".factor|0"),fi=fi.def(ci,".units|0")]});case"cull.face":return Fi(function(Fr){var fi=0;return"front"===Fr?fi=1028:"back"===Fr&&(fi=1029),fi},function(Fr,fi,ci){return fi.def(ci,'==="front"?',1028,":",1029)});case"frontFace":return Fi(function(Fr){return je[Fr]},function(Fr,fi,ci){return fi.def(ci+'==="cw"?2304:2305')});case"colorMask":return Fi(function(Fr){return Fr.map(function(fi){return!!fi})},function(Fr,fi,ci){return r(4,function(Yi){return"!!"+ci+"["+Yi+"]"})});case"sample.coverage":return Fi(function(Fr){return["value"in Fr?Fr.value:1,!!Fr.invert]},function(Fr,fi,ci){return[fi.def('"value" in ',ci,"?+",ci,".value:1"),fi=fi.def("!!",ci,".invert")]})}}),Yr),Dn=function Kt(It,hn,yn){function Hn(Ln){if(Ln in Un){var Dn=be.id(Un[Ln]);return(Ln=V(function(){return Dn})).id=Dn,Ln}if(Ln in jn){var Kn=jn[Ln];return N(Kn,function(Qn,lr){var hr=Qn.invoke(lr,Kn);return lr.def(Qn.shared.strings,".id(",hr,")")})}return null}var Un=It.static,jn=It.dynamic,On=Hn("frag"),kn=Hn("vert"),Mn=null;return ne(On)&&ne(kn)?(Mn=ot.program(kn.id,On.id,null,yn),It=V(function(Ln,Dn){return Ln.link(Mn)})):It=new X(On&&On.thisDep||kn&&kn.thisDep,On&&On.contextDep||kn&&kn.contextDep,On&&On.propDep||kn&&kn.propDep,function(Ln,Dn){var Kn,Qn,lr=Ln.shared.shader;return Kn=On?On.append(Ln,Dn):Dn.def(lr,".","frag"),Qn=kn?kn.append(Ln,Dn):Dn.def(lr,".","vert"),Dn.def(lr+".program("+Qn+","+Kn+")")}),{frag:On,vert:kn,progVar:It,program:Mn}}(It,0,On);jn("viewport"),jn(Xe("scissor.box"));var Kn,Qn=0<Object.keys(Ln).length;if((Kn={framebuffer:Kn,draw:Mn,shader:Dn,state:Ln,dirty:Qn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(Mr){var Er,Pr=Mr.static;if(Mr=Mr.dynamic,"profile"in Pr){var Ur=!!Pr.profile;(Er=V(function(si,Fi){return Ur})).enable=Ur}else if("profile"in Mr){var Yr=Mr.profile;Er=N(Yr,function(si,Fi){return si.invoke(Fi,Yr)})}return Er}(It),Kn.uniforms=function(Mr,Er){var Pr=Mr.static,Ur=Mr.dynamic,Yr={};return Object.keys(Pr).forEach(function(si){var Fi,Ri=Pr[si];if("number"==typeof Ri||"boolean"==typeof Ri)Fi=V(function(){return Ri});else if("function"==typeof Ri){var Fr=Ri._reglType;"texture2d"===Fr||"textureCube"===Fr?Fi=V(function(fi){return fi.link(Ri)}):"framebuffer"!==Fr&&"framebufferCube"!==Fr||(Fi=V(function(fi){return fi.link(Ri.color[0])}))}else u(Ri)&&(Fi=V(function(fi){return fi.global.def("[",r(Ri.length,function(ci){return Ri[ci]}),"]")}));Fi.value=Ri,Yr[si]=Fi}),Object.keys(Ur).forEach(function(si){var Fi=Ur[si];Yr[si]=N(Fi,function(Ri,Fr){return Ri.invoke(Fr,Fi)})}),Yr}(yn),Kn.drawVAO=Kn.scopeVAO=Mn.vao,!Kn.drawVAO&&Dn.program&&!On&&Fe.angle_instanced_arrays&&Mn.static.elements){var lr=!0;if(It=Dn.program.attributes.map(function(Mr){return Mr=hn.static[Mr],lr=lr&&!!Mr,Mr}),lr&&0<It.length){var hr=Ot.getVAO(Ot.createVAO({attributes:It,elements:Mn.static.elements}));Kn.drawVAO=new X(null,null,null,function(Mr,Er){return Mr.link(hr)}),Kn.useVAO=!0}}return On?Kn.useVAO=!0:Kn.attributes=function vn(It,hn){var yn=It.static,Hn=It.dynamic,Un={};return Object.keys(yn).forEach(function(jn){var On=yn[jn],kn=be.id(jn),Mn=new Cr;if(W(On))Mn.state=1,Mn.buffer=Ke.getBuffer(Ke.create(On,34962,!1,!0)),Mn.type=0;else if(Dn=Ke.getBuffer(On))Mn.state=1,Mn.buffer=Dn,Mn.type=0;else if("constant"in On){var Ln=On.constant;Mn.buffer="null",Mn.state=2,"number"==typeof Ln?Mn.x=Ln:Gt.forEach(function(Er,Pr){Pr<Ln.length&&(Mn[Er]=Ln[Pr])})}else{var Dn=W(On.buffer)?Ke.getBuffer(Ke.create(On.buffer,34962,!1,!0)):Ke.getBuffer(On.buffer),Kn=0|On.offset,Qn=0|On.stride,lr=0|On.size,hr=!!On.normalized,Mr=0;"type"in On&&(Mr=pe[On.type]),On=0|On.divisor,Mn.buffer=Dn,Mn.state=1,Mn.size=lr,Mn.normalized=hr,Mn.type=Mr||Dn.dtype,Mn.offset=Kn,Mn.stride=Qn,Mn.divisor=On}Un[jn]=V(function(Er,Pr){var Ur=Er.attribCache;if(kn in Ur)return Ur[kn];var Yr={isStream:!1};return Object.keys(Mn).forEach(function(si){Yr[si]=Mn[si]}),Mn.buffer&&(Yr.buffer=Er.link(Mn.buffer),Yr.type=Yr.type||Yr.buffer+".dtype"),Ur[kn]=Yr})}),Object.keys(Hn).forEach(function(jn){var On=Hn[jn];Un[jn]=N(On,function(kn,Mn){function Ln(Ur){Mn(hr[Ur],"=",Dn,".",Ur,"|0;")}var Dn=kn.invoke(Mn,On),Kn=kn.shared,Qn=kn.constants,lr=Kn.isBufferArgs,hr=(Kn=Kn.buffer,{isStream:Mn.def(!1)}),Mr=new Cr;Mr.state=1,Object.keys(Mr).forEach(function(Ur){hr[Ur]=Mn.def(""+Mr[Ur])});var Er=hr.buffer,Pr=hr.type;return Mn("if(",lr,"(",Dn,")){",hr.isStream,"=true;",Er,"=",Kn,".createStream(",34962,",",Dn,");",Pr,"=",Er,".dtype;","}else{",Er,"=",Kn,".getBuffer(",Dn,");","if(",Er,"){",Pr,"=",Er,".dtype;",'}else if("constant" in ',Dn,"){",hr.state,"=",2,";","if(typeof "+Dn+'.constant === "number"){',hr[Gt[0]],"=",Dn,".constant;",Gt.slice(1).map(function(Ur){return hr[Ur]}).join("="),"=0;","}else{",Gt.map(function(Ur,Yr){return hr[Ur]+"="+Dn+".constant.length>"+Yr+"?"+Dn+".constant["+Yr+"]:0;"}).join(""),"}}else{","if(",lr,"(",Dn,".buffer)){",Er,"=",Kn,".createStream(",34962,",",Dn,".buffer);","}else{",Er,"=",Kn,".getBuffer(",Dn,".buffer);","}",Pr,'="type" in ',Dn,"?",Qn.glTypes,"[",Dn,".type]:",Er,".dtype;",hr.normalized,"=!!",Dn,".normalized;"),Ln("size"),Ln("offset"),Ln("stride"),Ln("divisor"),Mn("}}"),Mn.exit("if(",hr.isStream,"){",Kn,".destroyStream(",Er,");","}"),hr})}),Un}(hn),Kn.context=function(Mr){var Er=Mr.static,Pr=Mr.dynamic,Ur={};return Object.keys(Er).forEach(function(Yr){var si=Er[Yr];Ur[Yr]=V(function(Fi,Ri){return"number"==typeof si||"boolean"==typeof si?""+si:Fi.link(si)})}),Object.keys(Pr).forEach(function(Yr){var si=Pr[Yr];Ur[Yr]=N(si,function(Fi,Ri){return Fi.invoke(Ri,si)})}),Ur}(Hn),Kn}function gn(It,hn,yn){var Hn=It.shared.context,Un=It.scope();Object.keys(yn).forEach(function(jn){hn.save(Hn,"."+jn);var On=yn[jn].append(It,hn);Array.isArray(On)?Un(Hn,".",jn,"=[",On.join(),"];"):Un(Hn,".",jn,"=",On,";")}),hn(Un)}function nn(It,hn,yn,Hn){var Un,jn=(kn=It.shared).gl,On=kn.framebuffer;ar&&(Un=hn.def(kn.extensions,".webgl_draw_buffers"));var kn=(Mn=It.constants).drawBuffer,Mn=Mn.backBuffer;It=yn?yn.append(It,hn):hn.def(On,".next"),Hn||hn("if(",It,"!==",On,".cur){"),hn("if(",It,"){",jn,".bindFramebuffer(",36160,",",It,".framebuffer);"),ar&&hn(Un,".drawBuffersWEBGL(",kn,"[",It,".colorAttachments.length]);"),hn("}else{",jn,".bindFramebuffer(",36160,",null);"),ar&&hn(Un,".drawBuffersWEBGL(",Mn,");"),hn("}",On,".cur=",It,";"),Hn||hn("}")}function an(It,hn,yn){var Hn=It.shared,Un=Hn.gl,jn=It.current,On=It.next,kn=Hn.current,Mn=Hn.next,Ln=It.cond(kn,".dirty");$r.forEach(function(Dn){var Kn,Qn;if(!((Dn=Xe(Dn))in yn.state))if(Dn in On){Kn=On[Dn],Qn=jn[Dn];var lr=r(sr[Dn].length,function(hr){return Ln.def(Kn,"[",hr,"]")});Ln(It.cond(lr.map(function(hr,Mr){return hr+"!=="+Qn+"["+Mr+"]"}).join("||")).then(Un,".",jr[Dn],"(",lr,");",lr.map(function(hr,Mr){return Qn+"["+Mr+"]="+hr}).join(";"),";"))}else Kn=Ln.def(Mn,".",Dn),lr=It.cond(Kn,"!==",kn,".",Dn),Ln(lr),Dn in Lr?lr(It.cond(Kn).then(Un,".enable(",Lr[Dn],");").else(Un,".disable(",Lr[Dn],");"),kn,".",Dn,"=",Kn,";"):lr(Un,".",jr[Dn],"(",Kn,");",kn,".",Dn,"=",Kn,";")}),0===Object.keys(yn.state).length&&Ln(kn,".dirty=false;"),hn(Ln)}function on(It,hn,yn,Hn){var Un,jn=It.shared,On=It.current,kn=jn.current,Mn=jn.gl;G(Object.keys(yn)).forEach(function(Ln){var Dn=yn[Ln];if(!Hn||Hn(Dn)){var Kn=Dn.append(It,hn);if(Lr[Ln]){var Qn=Lr[Ln];ne(Dn)?(Un=It.link(Kn,{stable:!0}),hn(It.cond(Un).then(Mn,".enable(",Qn,");").else(Mn,".disable(",Qn,");")),hn(kn,".",Ln,"=",Un,";")):(hn(It.cond(Kn).then(Mn,".enable(",Qn,");").else(Mn,".disable(",Qn,");")),hn(kn,".",Ln,"=",Kn,";"))}else if(u(Kn)){var lr=On[Ln];hn(Mn,".",jr[Ln],"(",Kn,");",Kn.map(function(hr,Mr){return lr+"["+Mr+"]="+hr}).join(";"),";")}else ne(Dn)?(Un=It.link(Kn,{stable:!0}),hn(Mn,".",jr[Ln],"(",Un,");",kn,".",Ln,"=",Un,";")):hn(Mn,".",jr[Ln],"(",Kn,");",kn,".",Ln,"=",Kn,";")}})}function mn(It,hn){Yn&&(It.instancing=hn.def(It.shared.extensions,".angle_instanced_arrays"))}function _n(It,hn,yn,Hn,Un){function jn(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function On(Mr){Mr(Ln=hn.def(),"=",jn(),";"),"string"==typeof Un?Mr(Qn,".count+=",Un,";"):Mr(Qn,".count++;"),St&&(Hn?Mr(Dn=hn.def(),"=",hr,".getNumPendingQueries();"):Mr(hr,".beginQuery(",Qn,");"))}function kn(Mr){Mr(Qn,".cpuTime+=",jn(),"-",Ln,";"),St&&(Hn?Mr(hr,".pushScopeStats(",Dn,",",hr,".getNumPendingQueries(),",Qn,");"):Mr(hr,".endQuery();"))}function Mn(Mr){var Er=hn.def(lr,".profile");hn(lr,".profile=",Mr,";"),hn.exit(lr,".profile=",Er,";")}var Ln,Dn,Kn=It.shared,Qn=It.stats,lr=Kn.current,hr=Kn.timer;if(yn=yn.profile){if(ne(yn))return void(yn.enable?(On(hn),kn(hn.exit),Mn("true")):Mn("false"));Mn(yn=yn.append(It,hn))}else yn=hn.def(lr,".profile");On(Kn=It.block()),hn("if(",yn,"){",Kn,"}"),kn(It=It.block()),hn.exit("if(",yn,"){",It,"}")}function Pn(It,hn,yn,Hn,Un){var On=It.shared;Hn.forEach(function(kn){var Mn,Ln=kn.name,Dn=yn.attributes[Ln];if(Dn){if(!Un(Dn))return;Mn=Dn.append(It,hn)}else{if(!Un(Ye))return;var Kn=It.scopeAttrib(Ln);Mn={},Object.keys(new Cr).forEach(function(Qn){Mn[Qn]=hn.def(Kn,".",Qn)})}!function jn(kn,Mn,Ln){function Dn(){hn("if(!",hr,".buffer){",Qn,".enableVertexAttribArray(",lr,");}");var Ur,Yr=Ln.type;Ur=Ln.size?hn.def(Ln.size,"||",Mn):Mn,hn("if(",hr,".type!==",Yr,"||",hr,".size!==",Ur,"||",Pr.map(function(si){return hr+"."+si+"!=="+Ln[si]}).join("||"),"){",Qn,".bindBuffer(",34962,",",Mr,".buffer);",Qn,".vertexAttribPointer(",[lr,Ur,Yr,Ln.normalized,Ln.stride,Ln.offset],");",hr,".type=",Yr,";",hr,".size=",Ur,";",Pr.map(function(si){return hr+"."+si+"="+Ln[si]+";"}).join(""),"}"),Yn&&hn("if(",hr,".divisor!==",Yr=Ln.divisor,"){",It.instancing,".vertexAttribDivisorANGLE(",[lr,Yr],");",hr,".divisor=",Yr,";}")}function Kn(){hn("if(",hr,".buffer){",Qn,".disableVertexAttribArray(",lr,");",hr,".buffer=null;","}if(",Gt.map(function(Ur,Yr){return hr+"."+Ur+"!=="+Er[Yr]}).join("||"),"){",Qn,".vertexAttrib4f(",lr,",",Er,");",Gt.map(function(Ur,Yr){return hr+"."+Ur+"="+Er[Yr]+";"}).join(""),"}")}var Qn=On.gl,lr=hn.def(kn,".location"),hr=hn.def(On.attributes,"[",lr,"]"),Mr=Ln.buffer,Er=[Ln.x,Ln.y,Ln.z,Ln.w],Pr=["buffer","normalized","offset","stride"];1===(kn=Ln.state)?Dn():2===kn?Kn():(hn("if(",kn,"===",1,"){"),Dn(),hn("}else{"),Kn(),hn("}"))}(It.link(kn),function(Qn){switch(Qn){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(kn.info.type),Mn)})}function Rn(It,hn,yn,Hn,Un,jn){for(var On,kn=It.shared,Mn=kn.gl,Ln=0;Ln<Hn.length;++Ln){var Dn,Kn=(hr=Hn[Ln]).name,Qn=hr.info.type,lr=yn.uniforms[Kn],hr=It.link(hr)+".location";if(lr){if(!Un(lr))continue;if(ne(lr)){if(Kn=lr.value,35678===Qn||35680===Qn)hn(Mn,".uniform1i(",hr,",",(Qn=It.link(Kn._texture||Kn.color[0]._texture))+".bind());"),hn.exit(Qn,".unbind();");else if(35674===Qn||35675===Qn||35676===Qn)lr=2,35675===Qn?lr=3:35676===Qn&&(lr=4),hn(Mn,".uniformMatrix",lr,"fv(",hr,",false,",Kn=It.global.def("new Float32Array(["+Array.prototype.slice.call(Kn)+"])"),");");else{switch(Qn){case 5126:On="1f";break;case 35664:On="2f";break;case 35665:On="3f";break;case 35666:On="4f";break;case 35670:case 5124:On="1i";break;case 35671:case 35667:On="2i";break;case 35672:case 35668:On="3i";break;case 35673:case 35669:On="4i"}hn(Mn,".uniform",On,"(",hr,",",u(Kn)?Array.prototype.slice.call(Kn):Kn,");")}continue}Dn=lr.append(It,hn)}else{if(!Un(Ye))continue;Dn=hn.def(kn.uniforms,"[",be.id(Kn),"]")}switch(35678===Qn?hn("if(",Dn,"&&",Dn,'._reglType==="framebuffer"){',Dn,"=",Dn,".color[0];","}"):35680===Qn&&hn("if(",Dn,"&&",Dn,'._reglType==="framebufferCube"){',Dn,"=",Dn,".color[0];","}"),Kn=1,Qn){case 35678:case 35680:Qn=hn.def(Dn,"._texture"),hn(Mn,".uniform1i(",hr,",",Qn,".bind());"),hn.exit(Qn,".unbind();");continue;case 5124:case 35670:On="1i";break;case 35667:case 35671:On="2i",Kn=2;break;case 35668:case 35672:On="3i",Kn=3;break;case 35669:case 35673:On="4i",Kn=4;break;case 5126:On="1f";break;case 35664:On="2f",Kn=2;break;case 35665:On="3f",Kn=3;break;case 35666:On="4f",Kn=4;break;case 35674:On="Matrix2fv";break;case 35675:On="Matrix3fv";break;case 35676:On="Matrix4fv"}if("M"===On.charAt(0)){hn(Mn,".uniform",On,"(",hr,","),hr=Math.pow(Qn-35674+2,2);var Mr=It.global.def("new Float32Array(",hr,")");Array.isArray(Dn)?hn("false,(",r(hr,function(Pr){return Mr+"["+Pr+"]="+Dn[Pr]}),",",Mr,")"):hn("false,(Array.isArray(",Dn,")||",Dn," instanceof Float32Array)?",Dn,":(",r(hr,function(Pr){return Mr+"["+Pr+"]="+Dn+"["+Pr+"]"}),",",Mr,")"),hn(");")}else{if(1<Kn){Qn=[];var Er=[];for(lr=0;lr<Kn;++lr)Array.isArray(Dn)?Er.push(Dn[lr]):Er.push(hn.def(Dn+"["+lr+"]")),jn&&Qn.push(hn.def());jn&&hn("if(!",It.batchId,"||",Qn.map(function(Pr,Ur){return Pr+"!=="+Er[Ur]}).join("||"),"){",Qn.map(function(Pr,Ur){return Pr+"="+Er[Ur]+";"}).join("")),hn(Mn,".uniform",On,"(",hr,",",Er.join(","),");")}else jn&&(Qn=hn.def(),hn("if(!",It.batchId,"||",Qn,"!==",Dn,"){",Qn,"=",Dn,";")),hn(Mn,".uniform",On,"(",hr,",",Dn,");");jn&&hn("}")}}}function qn(It,hn,yn,Hn){function Un(Yr){var si=Qn[Yr];return si?si.append(It,si.contextDep&&Hn.contextDynamic||si.propDep?yn:hn):hn.def(Kn,".",Yr)}function jn(){function Yr(){yn(Mn,".drawElementsInstancedANGLE(",[hr,Er,Pr,Mr+"<<(("+Pr+"-5121)>>1)",kn],");")}function si(){yn(Mn,".drawArraysInstancedANGLE(",[hr,Mr,Er,kn],");")}lr&&"null"!==lr?Ur?Yr():(yn("if(",lr,"){"),Yr(),yn("}else{"),si(),yn("}")):si()}function On(){function Yr(){yn(Dn+".drawElements("+[hr,Er,Pr,Mr+"<<(("+Pr+"-5121)>>1)"]+");")}function si(){yn(Dn+".drawArrays("+[hr,Mr,Er]+");")}lr&&"null"!==lr?Ur?Yr():(yn("if(",lr,"){"),Yr(),yn("}else{"),si(),yn("}")):si()}var kn,Mn,Yr,si,Ln=It.shared,Dn=Ln.gl,Kn=Ln.draw,Qn=Hn.draw,lr=(si=hn,(Yr=Qn.elements)?((Yr.contextDep&&Hn.contextDynamic||Yr.propDep)&&(si=yn),Yr=Yr.append(It,si),Qn.elementsActive&&si("if("+Yr+")"+Dn+".bindBuffer(34963,"+Yr+".buffer.buffer);")):(Yr=si.def(),si(Yr,"=",Kn,".","elements",";","if(",Yr,"){",Dn,".bindBuffer(",34963,",",Yr,".buffer.buffer);}","else if(",Ln.vao,".currentVAO){",Yr,"=",It.shared.elements+".getElements("+Ln.vao,".currentVAO.elements);",Ar?"":"if("+Yr+")"+Dn+".bindBuffer(34963,"+Yr+".buffer.buffer);","}")),Yr),hr=Un("primitive"),Mr=Un("offset"),Er=function(){var Yr=Qn.count,si=hn;return Yr?((Yr.contextDep&&Hn.contextDynamic||Yr.propDep)&&(si=yn),Yr=Yr.append(It,si)):Yr=si.def(Kn,".","count"),Yr}();if("number"==typeof Er){if(0===Er)return}else yn("if(",Er,"){"),yn.exit("}");Yn&&(kn=Un("instances"),Mn=It.instancing);var Pr=lr+".type",Ur=Qn.elements&&ne(Qn.elements)&&!Qn.vaoActive;Yn&&("number"!=typeof kn||0<=kn)?"string"==typeof kn?(yn("if(",kn,">0){"),jn(),yn("}else if(",kn,"<0){"),On(),yn("}")):jn():On()}function Xn(It,hn,yn,Hn,Un){return Un=(hn=zt()).proc("body",Un),Yn&&(hn.instancing=Un.def(hn.shared.extensions,".angle_instanced_arrays")),It(hn,Un,yn,Hn),hn.compile().body}function br(It,hn,yn,Hn){mn(It,hn),yn.useVAO?yn.drawVAO?hn(It.shared.vao,".setVAO(",yn.drawVAO.append(It,hn),");"):hn(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(hn(It.shared.vao,".setVAO(null);"),Pn(It,hn,yn,Hn.attributes,function(){return!0})),Rn(It,hn,yn,Hn.uniforms,function(){return!0},!1),qn(It,hn,hn,yn)}function fr(It,hn,yn,Hn){function Un(){return!0}It.batchId="a1",mn(It,hn),Pn(It,hn,yn,Hn.attributes,Un),Rn(It,hn,yn,Hn.uniforms,Un,!1),qn(It,hn,hn,yn)}function Vr(It,hn,yn,Hn){function Un(Kn){return Kn.contextDep&&On||Kn.propDep}function jn(Kn){return!Un(Kn)}mn(It,hn);var On=yn.contextDep,kn=hn.def(),Mn=hn.def();It.shared.props=Mn,It.batchId=kn;var Ln=It.scope(),Dn=It.scope();hn(Ln.entry,"for(",kn,"=0;",kn,"<","a1",";++",kn,"){",Mn,"=","a0","[",kn,"];",Dn,"}",Ln.exit),yn.needsContext&&gn(It,Dn,yn.context),yn.needsFramebuffer&&nn(It,Dn,yn.framebuffer),on(It,Dn,yn.state,Un),yn.profile&&Un(yn.profile)&&_n(It,Dn,yn,!1,!0),Hn?(yn.useVAO?yn.drawVAO?Un(yn.drawVAO)?Dn(It.shared.vao,".setVAO(",yn.drawVAO.append(It,Dn),");"):Ln(It.shared.vao,".setVAO(",yn.drawVAO.append(It,Ln),");"):Ln(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(Ln(It.shared.vao,".setVAO(null);"),Pn(It,Ln,yn,Hn.attributes,jn),Pn(It,Dn,yn,Hn.attributes,Un)),Rn(It,Ln,yn,Hn.uniforms,jn,!1),Rn(It,Dn,yn,Hn.uniforms,Un,!0),qn(It,Ln,Dn,yn)):(hn=It.global.def("{}"),Hn=yn.shader.progVar.append(It,Dn),Mn=Dn.def(Hn,".id"),Ln=Dn.def(hn,"[",Mn,"]"),Dn(It.shared.gl,".useProgram(",Hn,".program);","if(!",Ln,"){",Ln,"=",hn,"[",Mn,"]=",It.link(function(Kn){return Xn(fr,It,yn,Kn,2)}),"(",Hn,");}",Ln,".call(this,a0[",kn,"],",kn,");"))}function Sr(It,hn,yn){var Hn=hn.static[yn];if(Hn&&function(Dn){if("object"==typeof Dn&&!u(Dn)){for(var Kn=Object.keys(Dn),Qn=0;Qn<Kn.length;++Qn)if(J.isDynamic(Dn[Kn[Qn]]))return!0;return!1}}(Hn)){var Un=It.global,jn=Object.keys(Hn),On=!1,kn=!1,Mn=!1,Ln=It.global.def("{}");jn.forEach(function(Dn){var Kn=Hn[Dn];if(J.isDynamic(Kn))"function"==typeof Kn&&(Kn=Hn[Dn]=J.unbox(Kn)),Dn=N(Kn,null),On=On||Dn.thisDep,Mn=Mn||Dn.propDep,kn=kn||Dn.contextDep;else{switch(Un(Ln,".",Dn,"="),typeof Kn){case"number":Un(Kn);break;case"string":Un('"',Kn,'"');break;case"object":Array.isArray(Kn)&&Un("[",Kn.join(),"]");break;default:Un(It.link(Kn))}Un(";")}}),hn.dynamic[yn]=new J.DynamicVariable(4,{thisDep:On,contextDep:kn,propDep:Mn,ref:Ln,append:function(Dn,Kn){jn.forEach(function(Qn){var lr=Hn[Qn];J.isDynamic(lr)&&(lr=Dn.invoke(Kn,lr),Kn(Ln,".",Qn,"=",lr,";"))})}}),delete hn.static[yn]}}var Cr=Ot.Record,pi={add:32774,subtract:32778,"reverse subtract":32779};Fe.ext_blend_minmax&&(pi.min=32775,pi.max=32776);var Yn=Fe.angle_instanced_arrays,ar=Fe.webgl_draw_buffers,Ar=Fe.oes_vertex_array_object,sr={dirty:!0,profile:Ce.profile},dr={},$r=[],Lr={},jr={};st("dither",3024),st("blend.enable",3042),dt("blend.color","blendColor",[0,0,0,0]),dt("blend.equation","blendEquationSeparate",[32774,32774]),dt("blend.func","blendFuncSeparate",[1,0,1,0]),st("depth.enable",2929,!0),dt("depth.func","depthFunc",513),dt("depth.range","depthRange",[0,1]),dt("depth.mask","depthMask",!0),dt("colorMask","colorMask",[!0,!0,!0,!0]),st("cull.enable",2884),dt("cull.face","cullFace",1029),dt("frontFace","frontFace",2305),dt("lineWidth","lineWidth",1),st("polygonOffset.enable",32823),dt("polygonOffset.offset","polygonOffset",[0,0]),st("sample.alpha",32926),st("sample.enable",32928),dt("sample.coverage","sampleCoverage",[1,!1]),st("stencil.enable",2960),dt("stencil.mask","stencilMask",-1),dt("stencil.func","stencilFunc",[519,0,-1]),dt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),dt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),st("scissor.enable",3089),dt("scissor.box","scissor",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]),dt("viewport","viewport",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]);var ri={gl:he,context:qt,strings:be,next:dr,current:sr,draw:pt,elements:Ze,buffer:Ke,shader:ot,attributes:Ot.state,vao:Ot,uniforms:Lt,framebuffer:lt,extensions:Fe,timer:St,isBufferArgs:W},sn={primTypes:Ae,compareFuncs:cn,blendFuncs:Jt,blendEquations:pi,stencilOps:Rt,glTypes:pe,orientationType:je};ar&&(sn.backBuffer=[1029],sn.drawBuffer=r(He.maxDrawbuffers,function(It){return 0===It?[0]:r(It,function(hn){return 36064+hn})}));var wn=0;return{next:dr,current:sr,procs:function(){var It=zt(),hn=It.proc("poll"),yn=It.proc("refresh"),Hn=It.block();hn(Hn),yn(Hn);var Un,jn=(Mn=It.shared).gl,On=Mn.next,kn=Mn.current;Hn(kn,".dirty=false;"),nn(It,hn),nn(It,yn,null,!0),Yn&&(Un=It.link(Yn)),Fe.oes_vertex_array_object&&yn(It.link(Fe.oes_vertex_array_object),".bindVertexArrayOES(null);");var Mn=yn.def(Mn.attributes),Ln=yn.def(0),Dn=It.cond(Ln,".buffer");Dn.then(jn,".enableVertexAttribArray(i);",jn,".bindBuffer(",34962,",",Ln,".buffer.buffer);",jn,".vertexAttribPointer(i,",Ln,".size,",Ln,".type,",Ln,".normalized,",Ln,".stride,",Ln,".offset);").else(jn,".disableVertexAttribArray(i);",jn,".vertexAttrib4f(i,",Ln,".x,",Ln,".y,",Ln,".z,",Ln,".w);",Ln,".buffer=null;");var Kn=It.link(He.maxAttributes,{stable:!0});return yn("for(var i=0;i<",Kn,";++i){",Ln,"=",Mn,"[i];",Dn,"}"),Yn&&yn("for(var i=0;i<",Kn,";++i){",Un,".vertexAttribDivisorANGLE(i,",Mn,"[i].divisor);","}"),yn(It.shared.vao,".currentVAO=null;",It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"),Object.keys(Lr).forEach(function(Qn){var lr=Lr[Qn],hr=Hn.def(On,".",Qn),Mr=It.block();Mr("if(",hr,"){",jn,".enable(",lr,")}else{",jn,".disable(",lr,")}",kn,".",Qn,"=",hr,";"),yn(Mr),hn("if(",hr,"!==",kn,".",Qn,"){",Mr,"}")}),Object.keys(jr).forEach(function(Qn){var lr,hr,Mr=jr[Qn],Er=sr[Qn],Pr=It.block();Pr(jn,".",Mr,"("),u(Er)?(Mr=Er.length,lr=It.global.def(On,".",Qn),hr=It.global.def(kn,".",Qn),Pr(r(Mr,function(Ur){return lr+"["+Ur+"]"}),");",r(Mr,function(Ur){return hr+"["+Ur+"]="+lr+"["+Ur+"];"}).join("")),hn("if(",r(Mr,function(Ur){return lr+"["+Ur+"]!=="+hr+"["+Ur+"]"}).join("||"),"){",Pr,"}")):(lr=Hn.def(On,".",Qn),hr=Hn.def(kn,".",Qn),Pr(lr,");",kn,".",Qn,"=",lr,";"),hn("if(",lr,"!==",hr,"){",Pr,"}")),yn(Pr)}),It.compile()}(),compile:function(It,hn,yn,Hn,Un){var jn=zt();jn.stats=jn.link(Un),Object.keys(hn.static).forEach(function(kn){Sr(jn,hn,kn)}),en.forEach(function(kn){Sr(jn,It,kn)});var On=zn(It,hn,yn,Hn);return On.shader.program&&(On.shader.program.attributes.sort(function(kn,Mn){return kn.name<Mn.name?-1:1}),On.shader.program.uniforms.sort(function(kn,Mn){return kn.name<Mn.name?-1:1})),function(kn,Mn){var Ln=kn.proc("draw",1);mn(kn,Ln),gn(kn,Ln,Mn.context),nn(kn,Ln,Mn.framebuffer),an(kn,Ln,Mn),on(kn,Ln,Mn.state),_n(kn,Ln,Mn,!1,!0);var Dn=Mn.shader.progVar.append(kn,Ln);if(Ln(kn.shared.gl,".useProgram(",Dn,".program);"),Mn.shader.program)br(kn,Ln,Mn,Mn.shader.program);else{Ln(kn.shared.vao,".setVAO(null);");var Kn=kn.global.def("{}"),Qn=Ln.def(Dn,".id"),lr=Ln.def(Kn,"[",Qn,"]");Ln(kn.cond(lr).then(lr,".call(this,a0);").else(lr,"=",Kn,"[",Qn,"]=",kn.link(function(hr){return Xn(br,kn,Mn,hr,1)}),"(",Dn,");",lr,".call(this,a0);"))}0<Object.keys(Mn.state).length&&Ln(kn.shared.current,".dirty=true;"),kn.shared.vao&&Ln(kn.shared.vao,".setVAO(null);")}(jn,On),function cr(It,hn){function yn(kn){var Mn=hn.shader[kn];Mn&&(Mn=Mn.append(It,Hn),isNaN(Mn)?Hn.set(Un.shader,"."+kn,Mn):Hn.set(Un.shader,"."+kn,It.link(Mn,{stable:!0})))}var Hn=It.proc("scope",3);It.batchId="a2";var Un=It.shared,jn=Un.current;if(gn(It,Hn,hn.context),hn.framebuffer&&hn.framebuffer.append(It,Hn),G(Object.keys(hn.state)).forEach(function(kn){var Mn=hn.state[kn],Ln=Mn.append(It,Hn);u(Ln)?Ln.forEach(function(Dn,Kn){isNaN(Dn)?Hn.set(It.next[kn],"["+Kn+"]",Dn):Hn.set(It.next[kn],"["+Kn+"]",It.link(Dn,{stable:!0}))}):ne(Mn)?Hn.set(Un.next,"."+kn,It.link(Ln,{stable:!0})):Hn.set(Un.next,"."+kn,Ln)}),_n(It,Hn,hn,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(kn){var Mn=hn.draw[kn];Mn&&(Mn=Mn.append(It,Hn),isNaN(Mn)?Hn.set(Un.draw,"."+kn,Mn):Hn.set(Un.draw,"."+kn,It.link(Mn),{stable:!0}))}),Object.keys(hn.uniforms).forEach(function(kn){var Mn=hn.uniforms[kn].append(It,Hn);Array.isArray(Mn)&&(Mn="["+Mn.map(function(Ln){return isNaN(Ln)?Ln:It.link(Ln,{stable:!0})})+"]"),Hn.set(Un.uniforms,"["+It.link(be.id(kn),{stable:!0})+"]",Mn)}),Object.keys(hn.attributes).forEach(function(kn){var Mn=hn.attributes[kn].append(It,Hn),Ln=It.scopeAttrib(kn);Object.keys(new Cr).forEach(function(Dn){Hn.set(Ln,"."+Dn,Mn[Dn])})}),hn.scopeVAO){var On=hn.scopeVAO.append(It,Hn);isNaN(On)?Hn.set(Un.vao,".targetVAO",On):Hn.set(Un.vao,".targetVAO",It.link(On,{stable:!0}))}yn("vert"),yn("frag"),0<Object.keys(hn.state).length&&(Hn(jn,".dirty=true;"),Hn.exit(jn,".dirty=true;")),Hn("a1(",It.shared.context,",a0,",It.batchId,");")}(jn,On),function(kn,Mn){function Ln(Er){return Er.contextDep&&Kn||Er.propDep}var Dn=kn.proc("batch",2);kn.batchId="0",mn(kn,Dn);var Kn=!1,Qn=!0;Object.keys(Mn.context).forEach(function(Er){Kn=Kn||Mn.context[Er].propDep}),Kn||(gn(kn,Dn,Mn.context),Qn=!1);var lr=!1;if((hr=Mn.framebuffer)?(hr.propDep?Kn=lr=!0:hr.contextDep&&Kn&&(lr=!0),lr||nn(kn,Dn,hr)):nn(kn,Dn,null),Mn.state.viewport&&Mn.state.viewport.propDep&&(Kn=!0),an(kn,Dn,Mn),on(kn,Dn,Mn.state,function(Er){return!Ln(Er)}),Mn.profile&&Ln(Mn.profile)||_n(kn,Dn,Mn,!1,"a1"),Mn.contextDep=Kn,Mn.needsContext=Qn,Mn.needsFramebuffer=lr,(Qn=Mn.shader.progVar).contextDep&&Kn||Qn.propDep)Vr(kn,Dn,Mn,null);else if(Qn=Qn.append(kn,Dn),Dn(kn.shared.gl,".useProgram(",Qn,".program);"),Mn.shader.program)Vr(kn,Dn,Mn,Mn.shader.program);else{Dn(kn.shared.vao,".setVAO(null);");var hr=kn.global.def("{}"),Mr=(lr=Dn.def(Qn,".id"),Dn.def(hr,"[",lr,"]"));Dn(kn.cond(Mr).then(Mr,".call(this,a0,a1);").else(Mr,"=",hr,"[",lr,"]=",kn.link(function(Er){return Xn(Vr,kn,Mn,Er,2)}),"(",Qn,");",Mr,".call(this,a0,a1);"))}0<Object.keys(Mn.state).length&&Dn(kn.shared.current,".dirty=true;"),kn.shared.vao&&Dn(kn.shared.vao,".setVAO(null);")}(jn,On),B(jn.compile(),{destroy:function(){On.shader.program.destroy()}})}}}function ee(he,be){for(var Fe=0;Fe<he.length;++Fe)if(he[Fe]===be)return Fe;return-1}var B=function(he,be){for(var Fe=Object.keys(be),He=0;He<Fe.length;++He)he[Fe[He]]=be[Fe[He]];return he},K=0,J={DynamicVariable:g,define:function(he,be){return new g(he,t(be+""))},isDynamic:function(he){return"function"==typeof he&&!he._reglType||he instanceof g},unbox:function he(be,Fe){return"function"==typeof be?new g(0,be):"number"==typeof be||"boolean"==typeof be?new g(5,be):Array.isArray(be)?new g(6,be.map(function(He,Ke){return he(He,Fe+"["+Ke+"]")})):be instanceof g?be:void 0},accessor:t},te={next:"function"==typeof requestAnimationFrame?function(he){return requestAnimationFrame(he)}:function(he){return setTimeout(he,16)},cancel:"function"==typeof cancelAnimationFrame?function(he){return cancelAnimationFrame(he)}:clearTimeout},ae="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},ce=c();ce.zero=c();var ve=function(he){return he instanceof Uint8Array||he instanceof Uint16Array||he instanceof Uint32Array||he instanceof Int8Array||he instanceof Int16Array||he instanceof Int32Array||he instanceof Float32Array||he instanceof Float64Array||he instanceof Uint8ClampedArray},fe=function(he){return Object.keys(he).map(function(be){return he[be]})},xe={shape:function(he){for(var be=[];he.length;he=he[0])be.push(he.length);return be},flatten:function(he,be,Fe,He){var Ke=1;if(be.length)for(var Ze=0;Ze<be.length;++Ze)Ke*=be[Ze];else Ke=0;switch(Fe=He||ce.allocType(Fe,Ke),be.length){case 0:break;case 1:for(He=be[0],be=0;be<He;++be)Fe[be]=he[be];break;case 2:for(He=be[0],be=be[1],Ze=Ke=0;Ze<He;++Ze)for(var ut=he[Ze],lt=0;lt<be;++lt)Fe[Ke++]=ut[lt];break;case 3:m(he,be[0],be[1],be[2],Fe,0);break;default:!function Lt(Ot,ot,pt,qt,St){for(var Mt=1,Ce=pt+1;Ce<ot.length;++Ce)Mt*=ot[Ce];var Xe=ot[pt];if(ot.length-pt==4){var st=ot[pt+1],dt=ot[pt+2];for(ot=ot[pt+3],Ce=0;Ce<Xe;++Ce)m(Ot[Ce],st,dt,ot,qt,St),St+=Mt}else for(Ce=0;Ce<Xe;++Ce)Lt(Ot[Ce],ot,pt+1,qt,St),St+=Mt}(he,be,0,Fe,0)}return Fe}},Se={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},pe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ge={dynamic:35048,stream:35040,static:35044},Te=xe.flatten,se=xe.shape,de=[];de[5120]=1,de[5122]=2,de[5124]=4,de[5121]=1,de[5123]=2,de[5125]=4,de[5126]=4;var Ae={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Le=new Float32Array(1),Me=new Uint32Array(Le.buffer),De=[9984,9986,9985,9987],Oe=[0,6409,6410,6407,6408],Ie={};Ie[6409]=Ie[6406]=Ie[6402]=1,Ie[34041]=Ie[6410]=2,Ie[6407]=Ie[35904]=3,Ie[6408]=Ie[35906]=4;var Qe=a("HTMLCanvasElement"),Ne=a("OffscreenCanvas"),Pe=a("CanvasRenderingContext2D"),Re=a("ImageBitmap"),Ge=a("HTMLImageElement"),tt=a("HTMLVideoElement"),ct=Object.keys(Se).concat([Qe,Ne,Pe,Re,Ge,tt]),wt=[];wt[5121]=1,wt[5126]=4,wt[36193]=2,wt[5123]=2,wt[5125]=4;var kt=[];kt[32854]=2,kt[32855]=2,kt[36194]=2,kt[34041]=4,kt[33776]=.5,kt[33777]=.5,kt[33778]=1,kt[33779]=1,kt[35986]=.5,kt[35987]=1,kt[34798]=1,kt[35840]=.5,kt[35841]=.25,kt[35842]=.5,kt[35843]=.25,kt[36196]=.5;var gt=[];gt[32854]=2,gt[32855]=2,gt[36194]=2,gt[33189]=2,gt[36168]=1,gt[34041]=4,gt[35907]=4,gt[34836]=16,gt[34842]=8,gt[34843]=6;var et=[];et[6408]=4,et[6407]=3;var yt=[];yt[5121]=1,yt[5126]=4,yt[36193]=2;var Vt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Gt=["x","y","z","w"],en="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Jt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},cn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Rt={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},je={cw:2304,ccw:2305},Ye=new X(!1,!1,!1,function(){});return function(he){function be(){if(0===fr.length)Ht&&Ht.update(),Cr=null;else{Cr=te.next(be),ot();for(var Yn=fr.length-1;0<=Yn;--Yn){var ar=fr[Yn];ar&&ar(zn,null,0)}St.flush(),Ht&&Ht.update()}}function Fe(){!Cr&&0<fr.length&&(Cr=te.next(be))}function He(){Cr&&(te.cancel(be),Cr=null)}function Ke(Yn){Yn.preventDefault(),He(),Vr.forEach(function(ar){ar()})}function Ze(Yn){St.getError(),Ce.restore(),mn.restore(),nn.restore(),_n.restore(),Pn.restore(),Rn.restore(),on.restore(),Ht&&Ht.restore(),qn.procs.refresh(),Fe(),cr.forEach(function(ar){ar()})}function ut(Yn){function ar(It,hn){var yn={},Hn={};return Object.keys(It).forEach(function(Un){var jn=It[Un];if(J.isDynamic(jn))Hn[Un]=J.unbox(jn,Un);else{if(hn&&Array.isArray(jn))for(var On=0;On<jn.length;++On)if(J.isDynamic(jn[On]))return void(Hn[Un]=J.unbox(jn,Un));yn[Un]=jn}}),{dynamic:Hn,static:yn}}var Ar=ar(Yn.context||{},!0),sr=ar(Yn.uniforms||{},!0),dr=ar(Yn.attributes||{},!1);Yn=ar(function(It){function hn(Hn){if(Hn in yn){var Un=yn[Hn];delete yn[Hn],Object.keys(Un).forEach(function(jn){yn[Hn+"."+jn]=Un[jn]})}}var yn=B({},It);return delete yn.uniforms,delete yn.attributes,delete yn.context,delete yn.vao,"stencil"in yn&&yn.stencil.op&&(yn.stencil.opBack=yn.stencil.opFront=yn.stencil.op,delete yn.stencil.op),hn("blend"),hn("depth"),hn("cull"),hn("stencil"),hn("polygonOffset"),hn("scissor"),hn("sample"),"vao"in It&&(yn.vao=It.vao),yn}(Yn),!1);var $r={gpuTime:0,cpuTime:0,count:0},Lr=qn.compile(Yn,dr,sr,Ar,$r),jr=Lr.draw,ri=Lr.batch,sn=Lr.scope,wn=[];return B(function(It,hn){var yn;if("function"==typeof It)return sn.call(this,null,It,0);if("function"==typeof hn)if("number"==typeof It)for(yn=0;yn<It;++yn)sn.call(this,null,hn,yn);else{if(!Array.isArray(It))return sn.call(this,It,hn,0);for(yn=0;yn<It.length;++yn)sn.call(this,It[yn],hn,yn)}else if("number"==typeof It){if(0<It)return ri.call(this,function(Hn){for(;wn.length<Hn;)wn.push(null);return wn}(0|It),0|It)}else{if(!Array.isArray(It))return jr.call(this,It);if(It.length)return ri.call(this,It,It.length)}},{stats:$r,destroy:function(){Lr.destroy()}})}function lt(Yn,ar){var Ar=0;qn.procs.poll();var sr=ar.color;sr&&(St.clearColor(+sr[0]||0,+sr[1]||0,+sr[2]||0,+sr[3]||0),Ar|=16384),"depth"in ar&&(St.clearDepth(+ar.depth),Ar|=256),"stencil"in ar&&(St.clearStencil(0|ar.stencil),Ar|=1024),St.clear(Ar)}function Lt(Yn){return fr.push(Yn),Fe(),{cancel:function(){var ar=ee(fr,Yn);fr[ar]=function Ar(){var sr=ee(fr,Ar);fr[sr]=fr[fr.length-1],--fr.length,0>=fr.length&&He()}}}}function Ot(){var Yn=Xn.viewport,ar=Xn.scissor_box;Yn[0]=Yn[1]=ar[0]=ar[1]=0,zn.viewportWidth=zn.framebufferWidth=zn.drawingBufferWidth=Yn[2]=ar[2]=St.drawingBufferWidth,zn.viewportHeight=zn.framebufferHeight=zn.drawingBufferHeight=Yn[3]=ar[3]=St.drawingBufferHeight}function ot(){zn.tick+=1,zn.time=qt(),Ot(),qn.procs.poll()}function pt(){_n.refresh(),Ot(),qn.procs.refresh(),Ht&&Ht.update()}function qt(){return(ae()-Kt)/1e3}if(!(he=function e(he){var be,Fe,He,Ke,Ze=he||{};he={};var ut=[],lt=[],Lt="undefined"==typeof window?1:window.devicePixelRatio,Ot=!1,ot={},pt=function(St){},qt=function(){};if("string"==typeof Ze?be=document.querySelector(Ze):"object"==typeof Ze&&("string"==typeof Ze.nodeName&&"function"==typeof Ze.appendChild&&"function"==typeof Ze.getBoundingClientRect?be=Ze:"function"==typeof Ze.drawArrays||"function"==typeof Ze.drawElements?He=(Ke=Ze).canvas:("gl"in Ze?Ke=Ze.gl:"canvas"in Ze?He=x(Ze.canvas):"container"in Ze&&(Fe=x(Ze.container)),"attributes"in Ze&&(he=Ze.attributes),"extensions"in Ze&&(ut=k(Ze.extensions)),"optionalExtensions"in Ze&&(lt=k(Ze.optionalExtensions)),"onDone"in Ze&&(pt=Ze.onDone),"profile"in Ze&&(Ot=!!Ze.profile),"pixelRatio"in Ze&&(Lt=+Ze.pixelRatio),"cachedCode"in Ze&&(ot=Ze.cachedCode))),be&&("canvas"===be.nodeName.toLowerCase()?He=be:Fe=be),!Ke){if(!He){if(!(be=function(St,Mt,Ce){function Xe(){var zt=window.innerWidth,Ht=window.innerHeight;St!==document.body&&(zt=(Ht=dt.getBoundingClientRect()).right-Ht.left,Ht=Ht.bottom-Ht.top),dt.width=Ce*zt,dt.height=Ce*Ht}var st,dt=document.createElement("canvas");return B(dt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),St.appendChild(dt),St===document.body&&(dt.style.position="absolute",B(St.style,{margin:0,padding:0})),St!==document.body&&"function"==typeof ResizeObserver?(st=new ResizeObserver(function(){setTimeout(Xe)})).observe(St):window.addEventListener("resize",Xe,!1),Xe(),{canvas:dt,onDestroy:function(){st?st.disconnect():window.removeEventListener("resize",Xe),St.removeChild(dt)}}}(Fe||document.body,0,Lt)))return null;He=be.canvas,qt=be.onDestroy}void 0===he.premultipliedAlpha&&(he.premultipliedAlpha=!0),Ke=function(St,Mt){function Ce(Xe){try{return St.getContext(Xe,Mt)}catch(st){return null}}return Ce("webgl")||Ce("experimental-webgl")||Ce("webgl-experimental")}(He,he)}return Ke?{gl:Ke,canvas:He,container:Fe,extensions:ut,optionalExtensions:lt,pixelRatio:Lt,profile:Ot,cachedCode:ot,onDone:pt,onDestroy:qt}:(qt(),pt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(he)))return null;var St=he.gl,Mt=St.getContextAttributes();St.isContextLost();var Ce=function(Yn,ar){function Ar(Lr){var jr;Lr=Lr.toLowerCase();try{jr=sr[Lr]=Yn.getExtension(Lr)}catch(ri){}return!!jr}for(var sr={},dr=0;dr<ar.extensions.length;++dr){var $r=ar.extensions[dr];if(!Ar($r))return ar.onDestroy(),ar.onDone('"'+$r+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ar.optionalExtensions.forEach(Ar),{extensions:sr,restore:function(){Object.keys(sr).forEach(function(Lr){if(sr[Lr]&&!Ar(Lr))throw Error("(regl): error restoring extension "+Lr)})}}}(St,he);if(!Ce)return null;var Yn,ar,Xe=(Yn={"":0},ar=[""],{id:function(Ar){var sr=Yn[Ar];return sr||(sr=Yn[Ar]=ar.length,ar.push(Ar),sr)},str:function(Ar){return ar[Ar]}}),st={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},dt=he.cachedCode||{},zt=Ce.extensions,Ht=function(Yn,ar){function Ar(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function sr(wn,It,hn){var yn=Lr.pop()||new Ar;yn.startQueryIndex=wn,yn.endQueryIndex=It,yn.sum=0,yn.stats=hn,jr.push(yn)}if(!ar.ext_disjoint_timer_query)return null;var dr=[],$r=[],Lr=[],jr=[],ri=[],sn=[];return{beginQuery:function(wn){var It=dr.pop()||ar.ext_disjoint_timer_query.createQueryEXT();ar.ext_disjoint_timer_query.beginQueryEXT(35007,It),$r.push(It),sr($r.length-1,$r.length,wn)},endQuery:function(){ar.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:sr,update:function(){var wn,It;if(0!==(wn=$r.length)){sn.length=Math.max(sn.length,wn+1),ri.length=Math.max(ri.length,wn+1),ri[0]=0;var hn=sn[0]=0;for(It=wn=0;It<$r.length;++It){var yn=$r[It];ar.ext_disjoint_timer_query.getQueryObjectEXT(yn,34919)?(hn+=ar.ext_disjoint_timer_query.getQueryObjectEXT(yn,34918),dr.push(yn)):$r[wn++]=yn,ri[It+1]=hn,sn[It+1]=wn}for($r.length=wn,It=wn=0;It<jr.length;++It){var Hn=(hn=jr[It]).startQueryIndex;hn.sum+=ri[yn=hn.endQueryIndex]-ri[Hn],(yn=sn[yn])===(Hn=sn[Hn])?(hn.stats.gpuTime+=hn.sum/1e6,Lr.push(hn)):(hn.startQueryIndex=Hn,hn.endQueryIndex=yn,jr[wn++]=hn)}jr.length=wn}},getNumPendingQueries:function(){return $r.length},clear:function(){dr.push.apply(dr,$r);for(var wn=0;wn<dr.length;wn++)ar.ext_disjoint_timer_query.deleteQueryEXT(dr[wn]);$r.length=0,dr.length=0},restore:function(){$r.length=0,dr.length=0}}}(0,zt),Kt=ae(),Zt=St.drawingBufferWidth,vn=St.drawingBufferHeight,zn={tick:0,time:0,viewportWidth:Zt,viewportHeight:vn,framebufferWidth:Zt,framebufferHeight:vn,drawingBufferWidth:Zt,drawingBufferHeight:vn,pixelRatio:he.pixelRatio},gn=(Zt={elements:null,primitive:4,count:-1,offset:0,instances:-1},function(he,be){var Fe=1;be.ext_texture_filter_anisotropic&&(Fe=he.getParameter(34047));var He=1,Ke=1;be.webgl_draw_buffers&&(He=he.getParameter(34852),Ke=he.getParameter(36063));var Ze=!!be.oes_texture_float;if(Ze){Ze=he.createTexture(),he.bindTexture(3553,Ze),he.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var ut=he.createFramebuffer();if(he.bindFramebuffer(36160,ut),he.framebufferTexture2D(36160,36064,3553,Ze,0),he.bindTexture(3553,null),36053!==he.checkFramebufferStatus(36160))Ze=!1;else{he.viewport(0,0,1,1),he.clearColor(1,0,0,1),he.clear(16384);var lt=ce.allocType(5126,4);he.readPixels(0,0,1,1,6408,5126,lt),he.getError()?Ze=!1:(he.deleteFramebuffer(ut),he.deleteTexture(Ze),Ze=1===lt[0]),ce.freeType(lt)}}return lt=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(lt=he.createTexture(),ut=ce.allocType(5121,36),he.activeTexture(33984),he.bindTexture(34067,lt),he.texImage2D(34069,0,6408,3,3,0,6408,5121,ut),ce.freeType(ut),he.bindTexture(34067,null),he.deleteTexture(lt),lt=!he.getError()),{colorBits:[he.getParameter(3410),he.getParameter(3411),he.getParameter(3412),he.getParameter(3413)],depthBits:he.getParameter(3414),stencilBits:he.getParameter(3415),subpixelBits:he.getParameter(3408),extensions:Object.keys(be).filter(function(Lt){return!!be[Lt]}),maxAnisotropic:Fe,maxDrawbuffers:He,maxColorAttachments:Ke,pointSizeDims:he.getParameter(33901),lineWidthDims:he.getParameter(33902),maxViewportDims:he.getParameter(3386),maxCombinedTextureUnits:he.getParameter(35661),maxCubeMapSize:he.getParameter(34076),maxRenderbufferSize:he.getParameter(34024),maxTextureUnits:he.getParameter(34930),maxTextureSize:he.getParameter(3379),maxAttributes:he.getParameter(34921),maxVertexUniforms:he.getParameter(36347),maxVertexTextureUnits:he.getParameter(35660),maxVaryingVectors:he.getParameter(36348),maxFragmentUniforms:he.getParameter(36349),glsl:he.getParameter(35724),renderer:he.getParameter(7937),vendor:he.getParameter(7936),version:he.getParameter(7938),readFloat:Ze,npotTextureCube:lt}}(St,zt)),nn=function l(he,be,Fe,He){function Ke(pt){this.id=Lt++,this.buffer=he.createBuffer(),this.type=pt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Fe.profile&&(this.stats={size:0})}function Ze(pt,qt,St){pt.byteLength=qt.byteLength,he.bufferData(pt.type,qt,St)}function ut(pt,qt,St,Mt,Ce,Xe){if(pt.usage=St,Array.isArray(qt)){if(pt.dtype=Mt||5126,0<qt.length)if(Array.isArray(qt[0])){Ce=se(qt);for(var st=Mt=1;st<Ce.length;++st)Mt*=Ce[st];pt.dimension=Mt,Ze(pt,qt=Te(qt,Ce,pt.dtype),St),Xe?pt.persistentData=qt:ce.freeType(qt)}else"number"==typeof qt[0]?(pt.dimension=Ce,s(Ce=ce.allocType(pt.dtype,qt.length),qt),Ze(pt,Ce,St),Xe?pt.persistentData=Ce:ce.freeType(Ce)):ve(qt[0])&&(pt.dimension=qt[0].length,pt.dtype=Mt||p(qt[0])||5126,Ze(pt,qt=Te(qt,[qt.length,qt[0].length],pt.dtype),St),Xe?pt.persistentData=qt:ce.freeType(qt))}else if(ve(qt))pt.dtype=Mt||p(qt),pt.dimension=Ce,Ze(pt,qt,St),Xe&&(pt.persistentData=new Uint8Array(new Uint8Array(qt.buffer)));else if(n(qt)){var dt=qt.stride,zt=(st=qt.offset,0),Ht=0,Kt=0,Zt=0;1===(Ce=qt.shape).length?(zt=Ce[0],Ht=1,Kt=dt[0],Zt=0):2===Ce.length&&(zt=Ce[0],Ht=Ce[1],Kt=dt[0],Zt=dt[1]),pt.dtype=Mt||p(qt.data)||5126,pt.dimension=Ht,f(Ce=ce.allocType(pt.dtype,zt*Ht),qt.data,zt,Ht,Kt,Zt,st),Ze(pt,Ce,St),Xe?pt.persistentData=Ce:ce.freeType(Ce)}else qt instanceof ArrayBuffer&&(pt.dtype=5121,pt.dimension=Ce,Ze(pt,qt,St),Xe&&(pt.persistentData=new Uint8Array(new Uint8Array(qt))))}function lt(pt){be.bufferCount--,He(pt),he.deleteBuffer(pt.buffer),pt.buffer=null,delete Ot[pt.id]}var Lt=0,Ot={};Ke.prototype.bind=function(){he.bindBuffer(this.type,this.buffer)},Ke.prototype.destroy=function(){lt(this)};var ot=[];return Fe.profile&&(be.getTotalBufferSize=function(){var pt=0;return Object.keys(Ot).forEach(function(qt){pt+=Ot[qt].stats.size}),pt}),{create:function(pt,qt,St,Mt){function Ce(st){var dt=35044,zt=null,Ht=0,Kt=0,Zt=1;return Array.isArray(st)||ve(st)||n(st)||st instanceof ArrayBuffer?zt=st:"number"==typeof st?Ht=0|st:st&&("data"in st&&(zt=st.data),"usage"in st&&(dt=ge[st.usage]),"type"in st&&(Kt=pe[st.type]),"dimension"in st&&(Zt=0|st.dimension),"length"in st&&(Ht=0|st.length)),Xe.bind(),zt?ut(Xe,zt,dt,Kt,Zt,Mt):(Ht&&he.bufferData(Xe.type,Ht,dt),Xe.dtype=Kt||5121,Xe.usage=dt,Xe.dimension=Zt,Xe.byteLength=Ht),Fe.profile&&(Xe.stats.size=Xe.byteLength*de[Xe.dtype]),Ce}be.bufferCount++;var Xe=new Ke(qt);return Ot[Xe.id]=Xe,St||Ce(pt),Ce._reglType="buffer",Ce._buffer=Xe,Ce.subdata=function(st,dt){var zt,Ht=0|(dt||0);if(Xe.bind(),ve(st)||st instanceof ArrayBuffer)he.bufferSubData(Xe.type,Ht,st);else if(Array.isArray(st)){if(0<st.length)if("number"==typeof st[0]){var Kt=ce.allocType(Xe.dtype,st.length);s(Kt,st),he.bufferSubData(Xe.type,Ht,Kt),ce.freeType(Kt)}else(Array.isArray(st[0])||ve(st[0]))&&(zt=se(st),Kt=Te(st,zt,Xe.dtype),he.bufferSubData(Xe.type,Ht,Kt),ce.freeType(Kt))}else if(n(st)){var Zt=st.stride,vn=Kt=0,zn=0,gn=0;1===(zt=st.shape).length?(Kt=zt[0],vn=1,zn=Zt[0],gn=0):2===zt.length&&(Kt=zt[0],vn=zt[1],zn=Zt[0],gn=Zt[1]),zt=Array.isArray(st.data)?Xe.dtype:p(st.data),f(zt=ce.allocType(zt,Kt*vn),st.data,Kt,vn,zn,gn,st.offset),he.bufferSubData(Xe.type,Ht,zt),ce.freeType(zt)}return Ce},Fe.profile&&(Ce.stats=Xe.stats),Ce.destroy=function(){lt(Xe)},Ce},createStream:function(pt,qt){var St=ot.pop();return St||(St=new Ke(pt)),St.bind(),ut(St,qt,35040,0,1,!1),St},destroyStream:function(pt){ot.push(pt)},clear:function(){fe(Ot).forEach(lt),ot.forEach(lt)},getBuffer:function(pt){return pt&&pt._buffer instanceof Ke?pt._buffer:null},restore:function(){fe(Ot).forEach(function(pt){pt.buffer=he.createBuffer(),he.bindBuffer(pt.type,pt.buffer),he.bufferData(pt.type,pt.persistentData||pt.byteLength,pt.usage)})},_initBuffer:ut}}(St,st,he,function(Yn){return on.destroyBuffer(Yn)}),an=function o(he,be,Fe,He){function Ke(pt){this.id=Lt++,lt[this.id]=this,this.buffer=pt,this.primType=4,this.type=this.vertCount=0}function Ze(pt,qt,St,Mt,Ce,Xe,st){var dt;if(pt.buffer.bind(),qt?((dt=st)||ve(qt)&&(!n(qt)||ve(qt.data))||(dt=be.oes_element_index_uint?5125:5123),Fe._initBuffer(pt.buffer,qt,St,dt,3)):(he.bufferData(34963,Xe,St),pt.buffer.dtype=dt||5121,pt.buffer.usage=St,pt.buffer.dimension=3,pt.buffer.byteLength=Xe),dt=st,!st){switch(pt.buffer.dtype){case 5121:case 5120:dt=5121;break;case 5123:case 5122:dt=5123;break;case 5125:case 5124:dt=5125}pt.buffer.dtype=dt}pt.type=dt,0>(qt=Ce)&&(qt=pt.buffer.byteLength,5123===dt?qt>>=1:5125===dt&&(qt>>=2)),pt.vertCount=qt,qt=Mt,0>Mt&&(qt=4,1===(Mt=pt.buffer.dimension)&&(qt=0),2===Mt&&(qt=1),3===Mt&&(qt=4)),pt.primType=qt}function ut(pt){He.elementsCount--,delete lt[pt.id],pt.buffer.destroy(),pt.buffer=null}var lt={},Lt=0,Ot={uint8:5121,uint16:5123};be.oes_element_index_uint&&(Ot.uint32=5125),Ke.prototype.bind=function(){this.buffer.bind()};var ot=[];return{create:function(pt,qt){function St(Xe){if(Xe)if("number"==typeof Xe)Mt(Xe),Ce.primType=4,Ce.vertCount=0|Xe,Ce.type=5121;else{var st=null,dt=35044,zt=-1,Ht=-1,Kt=0,Zt=0;Array.isArray(Xe)||ve(Xe)||n(Xe)?st=Xe:("data"in Xe&&(st=Xe.data),"usage"in Xe&&(dt=ge[Xe.usage]),"primitive"in Xe&&(zt=Ae[Xe.primitive]),"count"in Xe&&(Ht=0|Xe.count),"type"in Xe&&(Zt=Ot[Xe.type]),"length"in Xe?Kt=0|Xe.length:(Kt=Ht,5123===Zt||5122===Zt?Kt*=2:5125!==Zt&&5124!==Zt||(Kt*=4))),Ze(Ce,st,dt,zt,Ht,Kt,Zt)}else Mt(),Ce.primType=4,Ce.vertCount=0,Ce.type=5121;return St}var Mt=Fe.create(null,34963,!0),Ce=new Ke(Mt._buffer);return He.elementsCount++,St(pt),St._reglType="elements",St._elements=Ce,St.subdata=function(Xe,st){return Mt.subdata(Xe,st),St},St.destroy=function(){ut(Ce)},St},createStream:function(pt){var qt=ot.pop();return qt||(qt=new Ke(Fe.create(null,34963,!0,!1)._buffer)),Ze(qt,pt,35040,-1,-1,0,0),qt},destroyStream:function(pt){ot.push(pt)},getElements:function(pt){return"function"==typeof pt&&pt._elements instanceof Ke?pt._elements:null},clear:function(){fe(lt).forEach(ut)}}}(St,zt,nn,st),on=function z(he,be,Fe,He,Ke,Ze,ut){function lt(){this.id=++ot,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var St=be.oes_vertex_array_object;this.vao=St?St.createVertexArrayOES():null,pt[this.id]=this,this.buffers=[]}var Lt=Fe.maxAttributes,Ot=Array(Lt);for(Fe=0;Fe<Lt;++Fe)Ot[Fe]=new P;var ot=0,pt={},qt={Record:P,scope:{},state:Ot,currentVAO:null,targetVAO:null,restore:be.oes_vertex_array_object?function(){be.oes_vertex_array_object&&fe(pt).forEach(function(St){St.refresh()})}:function(){},createVAO:function(St){function Mt(Xe){var st;Array.isArray(Xe)?(st=Xe,Ce.elements&&Ce.ownsElements&&Ce.elements.destroy(),Ce.elements=null,Ce.ownsElements=!1,Ce.offset=0,Ce.count=0,Ce.instances=-1,Ce.primitive=4):(Xe.elements?(st=Xe.elements,Ce.ownsElements?("function"==typeof st&&"elements"===st._reglType?Ce.elements.destroy():Ce.elements(st),Ce.ownsElements=!1):Ze.getElements(Xe.elements)?(Ce.elements=Xe.elements,Ce.ownsElements=!1):(Ce.elements=Ze.create(Xe.elements),Ce.ownsElements=!0)):(Ce.elements=null,Ce.ownsElements=!1),st=Xe.attributes,Ce.offset=0,Ce.count=-1,Ce.instances=-1,Ce.primitive=4,Ce.elements&&(Ce.count=Ce.elements._elements.vertCount,Ce.primitive=Ce.elements._elements.primType),"offset"in Xe&&(Ce.offset=0|Xe.offset),"count"in Xe&&(Ce.count=0|Xe.count),"instances"in Xe&&(Ce.instances=0|Xe.instances),"primitive"in Xe&&(Ce.primitive=Ae[Xe.primitive])),Xe={};var dt=Ce.attributes;dt.length=st.length;for(var zt=0;zt<st.length;++zt){var Ht,Kt=st[zt],Zt=dt[zt]=new P,vn=Kt.data||Kt;Array.isArray(vn)||ve(vn)||n(vn)?(Ce.buffers[zt]&&(Ht=Ce.buffers[zt],ve(vn)&&Ht._buffer.byteLength>=vn.byteLength?Ht.subdata(vn):(Ht.destroy(),Ce.buffers[zt]=null)),Ce.buffers[zt]||(Ht=Ce.buffers[zt]=Ke.create(Kt,34962,!1,!0)),Zt.buffer=Ke.getBuffer(Ht),Zt.size=0|Zt.buffer.dimension,Zt.normalized=!1,Zt.type=Zt.buffer.dtype,Zt.offset=0,Zt.stride=0,Zt.divisor=0,Zt.state=1,Xe[zt]=1):Ke.getBuffer(Kt)?(Zt.buffer=Ke.getBuffer(Kt),Zt.size=0|Zt.buffer.dimension,Zt.normalized=!1,Zt.type=Zt.buffer.dtype,Zt.offset=0,Zt.stride=0,Zt.divisor=0,Zt.state=1):Ke.getBuffer(Kt.buffer)?(Zt.buffer=Ke.getBuffer(Kt.buffer),Zt.size=0|(+Kt.size||Zt.buffer.dimension),Zt.normalized=!!Kt.normalized||!1,Zt.type="type"in Kt?pe[Kt.type]:Zt.buffer.dtype,Zt.offset=0|(Kt.offset||0),Zt.stride=0|(Kt.stride||0),Zt.divisor=0|(Kt.divisor||0),Zt.state=1):"x"in Kt&&(Zt.x=+Kt.x||0,Zt.y=+Kt.y||0,Zt.z=+Kt.z||0,Zt.w=+Kt.w||0,Zt.state=2)}for(Ht=0;Ht<Ce.buffers.length;++Ht)!Xe[Ht]&&Ce.buffers[Ht]&&(Ce.buffers[Ht].destroy(),Ce.buffers[Ht]=null);return Ce.refresh(),Mt}var Ce=new lt;return He.vaoCount+=1,Mt.destroy=function(){for(var Xe=0;Xe<Ce.buffers.length;++Xe)Ce.buffers[Xe]&&Ce.buffers[Xe].destroy();Ce.buffers.length=0,Ce.ownsElements&&(Ce.elements.destroy(),Ce.elements=null,Ce.ownsElements=!1),Ce.destroy()},Mt._vao=Ce,Mt._reglType="vao",Mt(St)},getVAO:function(St){return"function"==typeof St&&St._vao?St._vao:null},destroyBuffer:function(St){for(var Mt=0;Mt<Ot.length;++Mt){var Ce=Ot[Mt];Ce.buffer===St&&(he.disableVertexAttribArray(Mt),Ce.buffer=null)}},setVAO:be.oes_vertex_array_object?function(St){St!==qt.currentVAO&&(be.oes_vertex_array_object.bindVertexArrayOES(St?St.vao:null),qt.currentVAO=St)}:function(St){if(St!==qt.currentVAO){if(St)St.bindAttrs();else{for(var Mt=be.angle_instanced_arrays,Ce=0;Ce<Ot.length;++Ce){var Xe=Ot[Ce];Xe.buffer?(he.enableVertexAttribArray(Ce),Xe.buffer.bind(),he.vertexAttribPointer(Ce,Xe.size,Xe.type,Xe.normalized,Xe.stride,Xe.offfset),Mt&&Xe.divisor&&Mt.vertexAttribDivisorANGLE(Ce,Xe.divisor)):(he.disableVertexAttribArray(Ce),he.vertexAttrib4f(Ce,Xe.x,Xe.y,Xe.z,Xe.w))}he.bindBuffer(34963,ut.elements?ut.elements.buffer.buffer:null)}qt.currentVAO=St}},clear:be.oes_vertex_array_object?function(){fe(pt).forEach(function(St){St.destroy()})}:function(){}};return lt.prototype.bindAttrs=function(){for(var St=be.angle_instanced_arrays,Mt=this.attributes,Ce=0;Ce<Mt.length;++Ce){var Xe=Mt[Ce];Xe.buffer?(he.enableVertexAttribArray(Ce),he.bindBuffer(34962,Xe.buffer.buffer),he.vertexAttribPointer(Ce,Xe.size,Xe.type,Xe.normalized,Xe.stride,Xe.offset),St&&Xe.divisor&&St.vertexAttribDivisorANGLE(Ce,Xe.divisor)):(he.disableVertexAttribArray(Ce),he.vertexAttrib4f(Ce,Xe.x,Xe.y,Xe.z,Xe.w))}for(St=Mt.length;St<Lt;++St)he.disableVertexAttribArray(St);(St=Ze.getElements(this.elements))?he.bindBuffer(34963,St.buffer.buffer):he.bindBuffer(34963,null)},lt.prototype.refresh=function(){var St=be.oes_vertex_array_object;St&&(St.bindVertexArrayOES(this.vao),this.bindAttrs(),qt.currentVAO=null,St.bindVertexArrayOES(null))},lt.prototype.destroy=function(){if(this.vao){var St=be.oes_vertex_array_object;this===qt.currentVAO&&(qt.currentVAO=null,St.bindVertexArrayOES(null)),St.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),pt[this.id]&&(delete pt[this.id],--He.vaoCount)},qt}(St,zt,gn,st,nn,an,Zt),mn=function S(he,be,Fe,He){function Ke(Mt,Ce,Xe,st){this.name=Mt,this.id=Ce,this.location=Xe,this.info=st}function Ze(Mt,Ce){for(var Xe=0;Xe<Mt.length;++Xe)if(Mt[Xe].id===Ce.id)return void(Mt[Xe].location=Ce.location);Mt.push(Ce)}function ut(Mt,Ce,Xe){if(!(dt=(Xe=35632===Mt?Ot:ot)[Ce])){var st=be.str(Ce),dt=he.createShader(Mt);he.shaderSource(dt,st),he.compileShader(dt),Xe[Ce]=dt}return dt}function lt(Mt,Ce){this.id=St++,this.fragId=Mt,this.vertId=Ce,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,He.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Lt(Mt,Ce,Xe){var st;st=ut(35632,Mt.fragId);var dt=ut(35633,Mt.vertId);if(Ce=Mt.program=he.createProgram(),he.attachShader(Ce,st),he.attachShader(Ce,dt),Xe)for(st=0;st<Xe.length;++st)he.bindAttribLocation(Ce,(dt=Xe[st])[0],dt[1]);he.linkProgram(Ce),dt=he.getProgramParameter(Ce,35718),He.profile&&(Mt.stats.uniformsCount=dt);var zt=Mt.uniforms;for(st=0;st<dt;++st)if(Xe=he.getActiveUniform(Ce,st))if(1<Xe.size)for(var Ht=0;Ht<Xe.size;++Ht){var Kt=Xe.name.replace("[0]","["+Ht+"]");Ze(zt,new Ke(Kt,be.id(Kt),he.getUniformLocation(Ce,Kt),Xe))}else Ze(zt,new Ke(Xe.name,be.id(Xe.name),he.getUniformLocation(Ce,Xe.name),Xe));for(dt=he.getProgramParameter(Ce,35721),He.profile&&(Mt.stats.attributesCount=dt),Mt=Mt.attributes,st=0;st<dt;++st)(Xe=he.getActiveAttrib(Ce,st))&&Ze(Mt,new Ke(Xe.name,be.id(Xe.name),he.getAttribLocation(Ce,Xe.name),Xe))}var Ot={},ot={},pt={},qt=[],St=0;return He.profile&&(Fe.getMaxUniformsCount=function(){var Mt=0;return qt.forEach(function(Ce){Ce.stats.uniformsCount>Mt&&(Mt=Ce.stats.uniformsCount)}),Mt},Fe.getMaxAttributesCount=function(){var Mt=0;return qt.forEach(function(Ce){Ce.stats.attributesCount>Mt&&(Mt=Ce.stats.attributesCount)}),Mt}),{clear:function(){var Mt=he.deleteShader.bind(he);fe(Ot).forEach(Mt),Ot={},fe(ot).forEach(Mt),ot={},qt.forEach(function(Ce){he.deleteProgram(Ce.program)}),qt.length=0,pt={},Fe.shaderCount=0},program:function(Mt,Ce,Xe,st){var dt=pt[Ce];dt||(dt=pt[Ce]={});var zt=dt[Mt];if(zt&&(zt.refCount++,!st))return zt;var Ht=new lt(Ce,Mt);return Fe.shaderCount++,Lt(Ht,Xe,st),zt||(dt[Mt]=Ht),qt.push(Ht),B(Ht,{destroy:function(){if(Ht.refCount--,0>=Ht.refCount){he.deleteProgram(Ht.program);var Kt=qt.indexOf(Ht);qt.splice(Kt,1),Fe.shaderCount--}0>=dt[Ht.vertId].refCount&&(he.deleteShader(ot[Ht.vertId]),delete ot[Ht.vertId],delete pt[Ht.fragId][Ht.vertId]),Object.keys(pt[Ht.fragId]).length||(he.deleteShader(Ot[Ht.fragId]),delete Ot[Ht.fragId],delete pt[Ht.fragId])}})},restore:function(){Ot={},ot={};for(var Mt=0;Mt<qt.length;++Mt)Lt(qt[Mt],null,qt[Mt].attributes.map(function(Ce){return[Ce.location,Ce.name]}))},shader:ut,frag:-1,vert:-1}}(St,Xe,st,he),_n=function L(he,be,Fe,He,Ke,Ze,ut){function lt(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Lt(sn,wn){sn.internalformat=wn.internalformat,sn.format=wn.format,sn.type=wn.type,sn.compressed=wn.compressed,sn.premultiplyAlpha=wn.premultiplyAlpha,sn.flipY=wn.flipY,sn.unpackAlignment=wn.unpackAlignment,sn.colorSpace=wn.colorSpace,sn.width=wn.width,sn.height=wn.height,sn.channels=wn.channels}function Ot(sn,wn){if("object"==typeof wn&&wn){"premultiplyAlpha"in wn&&(sn.premultiplyAlpha=wn.premultiplyAlpha),"flipY"in wn&&(sn.flipY=wn.flipY),"alignment"in wn&&(sn.unpackAlignment=wn.alignment),"colorSpace"in wn&&(sn.colorSpace=qn[wn.colorSpace]),"type"in wn&&(sn.type=Xn[wn.type]);var It=sn.width,hn=sn.height,yn=sn.channels,Hn=!1;"shape"in wn?(It=wn.shape[0],hn=wn.shape[1],3===wn.shape.length&&(yn=wn.shape[2],Hn=!0)):("radius"in wn&&(It=hn=wn.radius),"width"in wn&&(It=wn.width),"height"in wn&&(hn=wn.height),"channels"in wn&&(yn=wn.channels,Hn=!0)),sn.width=0|It,sn.height=0|hn,sn.channels=0|yn,It=!1,"format"in wn&&(hn=sn.internalformat=br[It=wn.format],sn.format=Ar[hn],It in Xn&&!("type"in wn)&&(sn.type=Xn[It]),It in fr&&(sn.compressed=!0),It=!0),!Hn&&It?sn.channels=Ie[sn.format]:Hn&&!It&&sn.channels!==Oe[sn.format]&&(sn.format=sn.internalformat=Oe[sn.channels])}}function ot(sn){he.pixelStorei(37440,sn.flipY),he.pixelStorei(37441,sn.premultiplyAlpha),he.pixelStorei(37443,sn.colorSpace),he.pixelStorei(3317,sn.unpackAlignment)}function pt(){lt.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function qt(sn,wn){var It=null;if(b(wn)?It=wn:wn&&(Ot(sn,wn),"x"in wn&&(sn.xOffset=0|wn.x),"y"in wn&&(sn.yOffset=0|wn.y),b(wn.data)&&(It=wn.data)),wn.copy){var hn=Ke.viewportWidth,yn=Ke.viewportHeight;sn.width=sn.width||hn-sn.xOffset,sn.height=sn.height||yn-sn.yOffset,sn.needsCopy=!0}else if(It){if(ve(It))sn.channels=sn.channels||4,sn.data=It,"type"in wn||5121!==sn.type||(sn.type=0|Se[Object.prototype.toString.call(It)]);else if(y(It)){switch(sn.channels=sn.channels||4,yn=(hn=It).length,sn.type){case 5121:case 5123:case 5125:case 5126:(yn=ce.allocType(sn.type,yn)).set(hn),sn.data=yn;break;case 36193:sn.data=d(hn)}sn.alignment=1,sn.needsFree=!0}else if(n(It)){hn=It.data,Array.isArray(hn)||5121!==sn.type||(sn.type=0|Se[Object.prototype.toString.call(hn)]);var Hn,Un,jn,On,kn=It.stride;3===(yn=It.shape).length?(jn=yn[2],On=kn[2]):On=jn=1,Hn=yn[0],Un=yn[1],yn=kn[0],kn=kn[1],sn.alignment=1,sn.width=Hn,sn.height=Un,sn.channels=jn,sn.format=sn.internalformat=Oe[jn],sn.needsFree=!0,Hn=On,It=It.offset;for(var Mn=ce.allocType(36193===sn.type?5126:sn.type,(jn=sn.width)*(On=sn.height)*(Un=sn.channels)),Ln=0,Dn=0;Dn<On;++Dn)for(var Kn=0;Kn<jn;++Kn)for(var Qn=0;Qn<Un;++Qn)Mn[Ln++]=hn[yn*Kn+kn*Dn+Hn*Qn+It];w(sn,Mn)}else if(_(It)===Qe||_(It)===Ne||_(It)===Pe)sn.element=_(It)===Qe||_(It)===Ne?It:It.canvas,sn.width=sn.element.width,sn.height=sn.element.height,sn.channels=4;else if(_(It)===Re)sn.element=It,sn.width=It.width,sn.height=It.height,sn.channels=4;else if(_(It)===Ge)sn.element=It,sn.width=It.naturalWidth,sn.height=It.naturalHeight,sn.channels=4;else if(_(It)===tt)sn.element=It,sn.width=It.videoWidth,sn.height=It.videoHeight,sn.channels=4;else if(h(It)){for(hn=sn.width||It[0].length,yn=sn.height||It.length,kn=sn.channels,kn=u(It[0][0])?kn||It[0][0].length:kn||1,Hn=xe.shape(It),jn=1,On=0;On<Hn.length;++On)jn*=Hn[On];jn=ce.allocType(36193===sn.type?5126:sn.type,jn),xe.flatten(It,Hn,"",jn),w(sn,jn),sn.alignment=1,sn.width=hn,sn.height=yn,sn.channels=kn,sn.format=sn.internalformat=Oe[kn],sn.needsFree=!0}}else sn.width=sn.width||1,sn.height=sn.height||1,sn.channels=sn.channels||4}function St(sn,wn,It,hn,yn){var Hn=sn.element,Un=sn.data,jn=sn.internalformat,On=sn.format,kn=sn.type,Mn=sn.width,Ln=sn.height;ot(sn),Hn?he.texSubImage2D(wn,yn,It,hn,On,kn,Hn):sn.compressed?he.compressedTexSubImage2D(wn,yn,It,hn,jn,Mn,Ln,Un):sn.needsCopy?(He(),he.copyTexSubImage2D(wn,yn,It,hn,sn.xOffset,sn.yOffset,Mn,Ln)):he.texSubImage2D(wn,yn,It,hn,Mn,Ln,On,kn,Un)}function Mt(){return sr.pop()||new pt}function Ce(sn){sn.needsFree&&ce.freeType(sn.data),pt.call(sn),sr.push(sn)}function Xe(){lt.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function st(sn,wn,It){var hn=sn.images[0]=Mt();sn.mipmask=1,hn.width=sn.width=wn,hn.height=sn.height=It,hn.channels=sn.channels=4}function dt(sn,wn){var It=null;if(b(wn))Lt(It=sn.images[0]=Mt(),sn),qt(It,wn),sn.mipmask=1;else if(Ot(sn,wn),Array.isArray(wn.mipmap))for(var hn=wn.mipmap,yn=0;yn<hn.length;++yn)Lt(It=sn.images[yn]=Mt(),sn),It.width>>=yn,It.height>>=yn,qt(It,hn[yn]),sn.mipmask|=1<<yn;else Lt(It=sn.images[0]=Mt(),sn),qt(It,wn),sn.mipmask=1;Lt(sn,sn.images[0])}function zt(sn,wn){for(var It=sn.images,hn=0;hn<It.length&&It[hn];++hn){var yn=It[hn],Hn=wn,Un=hn,jn=yn.element,On=yn.data,kn=yn.internalformat,Mn=yn.format,Ln=yn.type,Dn=yn.width,Kn=yn.height;ot(yn),jn?he.texImage2D(Hn,Un,Mn,Mn,Ln,jn):yn.compressed?he.compressedTexImage2D(Hn,Un,kn,Dn,Kn,0,On):yn.needsCopy?(He(),he.copyTexImage2D(Hn,Un,Mn,yn.xOffset,yn.yOffset,Dn,Kn,0)):he.texImage2D(Hn,Un,Mn,Dn,Kn,0,Mn,Ln,On||null)}}function Ht(){var sn=dr.pop()||new Xe;lt.call(sn);for(var wn=sn.mipmask=0;16>wn;++wn)sn.images[wn]=null;return sn}function Kt(sn){for(var wn=sn.images,It=0;It<wn.length;++It)wn[It]&&Ce(wn[It]),wn[It]=null;dr.push(sn)}function Zt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function vn(sn,wn){"min"in wn&&(sn.minFilter=Rn[wn.min],0<=De.indexOf(sn.minFilter)&&!("faces"in wn)&&(sn.genMipmaps=!0)),"mag"in wn&&(sn.magFilter=Pn[wn.mag]);var It=sn.wrapS,hn=sn.wrapT;if("wrap"in wn){var yn=wn.wrap;"string"==typeof yn?It=hn=_n[yn]:Array.isArray(yn)&&(It=_n[yn[0]],hn=_n[yn[1]])}else"wrapS"in wn&&(It=_n[wn.wrapS]),"wrapT"in wn&&(hn=_n[wn.wrapT]);if(sn.wrapS=It,sn.wrapT=hn,"anisotropic"in wn&&(sn.anisotropic=wn.anisotropic),"mipmap"in wn){switch(It=!1,typeof wn.mipmap){case"string":sn.mipmapHint=mn[wn.mipmap],It=sn.genMipmaps=!0;break;case"boolean":It=sn.genMipmaps=wn.mipmap;break;case"object":sn.genMipmaps=!1,It=!0}!It||"min"in wn||(sn.minFilter=9984)}}function zn(sn,wn){he.texParameteri(wn,10241,sn.minFilter),he.texParameteri(wn,10240,sn.magFilter),he.texParameteri(wn,10242,sn.wrapS),he.texParameteri(wn,10243,sn.wrapT),be.ext_texture_filter_anisotropic&&he.texParameteri(wn,34046,sn.anisotropic),sn.genMipmaps&&(he.hint(33170,sn.mipmapHint),he.generateMipmap(wn))}function gn(sn){lt.call(this),this.mipmask=0,this.internalformat=6408,this.id=$r++,this.refCount=1,this.target=sn,this.texture=he.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Zt,ut.profile&&(this.stats={size:0})}function nn(sn){he.activeTexture(33984),he.bindTexture(sn.target,sn.texture)}function an(){var sn=ri[0];sn?he.bindTexture(sn.target,sn.texture):he.bindTexture(3553,null)}function on(sn){var wn=sn.texture,It=sn.unit,hn=sn.target;0<=It&&(he.activeTexture(33984+It),he.bindTexture(hn,null),ri[It]=null),he.deleteTexture(wn),sn.texture=null,sn.params=null,sn.pixels=null,sn.refCount=0,delete Lr[sn.id],Ze.textureCount--}var mn={"don't care":4352,"dont care":4352,nice:4354,fast:4353},_n={repeat:10497,clamp:33071,mirror:33648},Pn={nearest:9728,linear:9729},Rn=B({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Pn),qn={none:0,browser:37444},Xn={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},br={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},fr={};be.ext_srgb&&(br.srgb=35904,br.srgba=35906),be.oes_texture_float&&(Xn.float32=Xn.float=5126),be.oes_texture_half_float&&(Xn.float16=Xn["half float"]=36193),be.webgl_depth_texture&&(B(br,{depth:6402,"depth stencil":34041}),B(Xn,{uint16:5123,uint32:5125,"depth stencil":34042})),be.webgl_compressed_texture_s3tc&&B(fr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),be.webgl_compressed_texture_atc&&B(fr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),be.webgl_compressed_texture_pvrtc&&B(fr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),be.webgl_compressed_texture_etc1&&(fr["rgb etc1"]=36196);var Vr=Array.prototype.slice.call(he.getParameter(34467));Object.keys(fr).forEach(function(sn){var wn=fr[sn];0<=Vr.indexOf(wn)&&(br[sn]=wn)});var cr=Object.keys(br);Fe.textureFormats=cr;var Sr=[];Object.keys(br).forEach(function(sn){Sr[br[sn]]=sn});var Cr=[];Object.keys(Xn).forEach(function(sn){Cr[Xn[sn]]=sn});var pi=[];Object.keys(Pn).forEach(function(sn){pi[Pn[sn]]=sn});var Yn=[];Object.keys(Rn).forEach(function(sn){Yn[Rn[sn]]=sn});var ar=[];Object.keys(_n).forEach(function(sn){ar[_n[sn]]=sn});var Ar=cr.reduce(function(sn,wn){var It=br[wn];return sn[It]=6409===It||6406===It||6409===It||6410===It||6402===It||34041===It||be.ext_srgb&&(35904===It||35906===It)?It:32855===It||0<=wn.indexOf("rgba")?6408:6407,sn},{}),sr=[],dr=[],$r=0,Lr={},jr=Fe.maxTextureUnits,ri=Array(jr).map(function(){return null});return B(gn.prototype,{bind:function(){this.bindCount+=1;var sn=this.unit;if(0>sn){for(var wn=0;wn<jr;++wn){var It=ri[wn];if(It){if(0<It.bindCount)continue;It.unit=-1}ri[wn]=this,sn=wn;break}ut.profile&&Ze.maxTextureUnits<sn+1&&(Ze.maxTextureUnits=sn+1),this.unit=sn,he.activeTexture(33984+sn),he.bindTexture(this.target,this.texture)}return sn},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&on(this)}}),ut.profile&&(Ze.getTotalTextureSize=function(){var sn=0;return Object.keys(Lr).forEach(function(wn){sn+=Lr[wn].stats.size}),sn}),{create2D:function(sn,wn){function It(yn,Hn){var Un=hn.texInfo;Zt.call(Un);var jn=Ht();return"number"==typeof yn?st(jn,0|yn,"number"==typeof Hn?0|Hn:0|yn):yn?(vn(Un,yn),dt(jn,yn)):st(jn,1,1),Un.genMipmaps&&(jn.mipmask=(jn.width<<1)-1),hn.mipmask=jn.mipmask,Lt(hn,jn),hn.internalformat=jn.internalformat,It.width=jn.width,It.height=jn.height,nn(hn),zt(jn,3553),zn(Un,3553),an(),Kt(jn),ut.profile&&(hn.stats.size=T(hn.internalformat,hn.type,jn.width,jn.height,Un.genMipmaps,!1)),It.format=Sr[hn.internalformat],It.type=Cr[hn.type],It.mag=pi[Un.magFilter],It.min=Yn[Un.minFilter],It.wrapS=ar[Un.wrapS],It.wrapT=ar[Un.wrapT],It}var hn=new gn(3553);return Lr[hn.id]=hn,Ze.textureCount++,It(sn,wn),It.subimage=function(yn,Hn,Un,jn){Hn|=0,Un|=0,jn|=0;var On=Mt();return Lt(On,hn),On.width=0,On.height=0,qt(On,yn),On.width=On.width||(hn.width>>jn)-Hn,On.height=On.height||(hn.height>>jn)-Un,nn(hn),St(On,3553,Hn,Un,jn),an(),Ce(On),It},It.resize=function(yn,Hn){var Un=0|yn,jn=0|Hn||Un;if(Un===hn.width&&jn===hn.height)return It;It.width=hn.width=Un,It.height=hn.height=jn,nn(hn);for(var On=0;hn.mipmask>>On;++On){var kn=Un>>On,Mn=jn>>On;if(!kn||!Mn)break;he.texImage2D(3553,On,hn.format,kn,Mn,0,hn.format,hn.type,null)}return an(),ut.profile&&(hn.stats.size=T(hn.internalformat,hn.type,Un,jn,!1,!1)),It},It._reglType="texture2d",It._texture=hn,ut.profile&&(It.stats=hn.stats),It.destroy=function(){hn.decRef()},It},createCube:function(sn,wn,It,hn,yn,Hn){function Un(kn,Mn,Ln,Dn,Kn,Qn){var lr,hr=jn.texInfo;for(Zt.call(hr),lr=0;6>lr;++lr)On[lr]=Ht();if("number"!=typeof kn&&kn){if("object"==typeof kn)if(Mn)dt(On[0],kn),dt(On[1],Mn),dt(On[2],Ln),dt(On[3],Dn),dt(On[4],Kn),dt(On[5],Qn);else if(vn(hr,kn),Ot(jn,kn),"faces"in kn)for(kn=kn.faces,lr=0;6>lr;++lr)Lt(On[lr],jn),dt(On[lr],kn[lr]);else for(lr=0;6>lr;++lr)dt(On[lr],kn)}else for(kn=0|kn||1,lr=0;6>lr;++lr)st(On[lr],kn,kn);for(Lt(jn,On[0]),jn.mipmask=hr.genMipmaps?(On[0].width<<1)-1:On[0].mipmask,jn.internalformat=On[0].internalformat,Un.width=On[0].width,Un.height=On[0].height,nn(jn),lr=0;6>lr;++lr)zt(On[lr],34069+lr);for(zn(hr,34067),an(),ut.profile&&(jn.stats.size=T(jn.internalformat,jn.type,Un.width,Un.height,hr.genMipmaps,!0)),Un.format=Sr[jn.internalformat],Un.type=Cr[jn.type],Un.mag=pi[hr.magFilter],Un.min=Yn[hr.minFilter],Un.wrapS=ar[hr.wrapS],Un.wrapT=ar[hr.wrapT],lr=0;6>lr;++lr)Kt(On[lr]);return Un}var jn=new gn(34067);Lr[jn.id]=jn,Ze.cubeCount++;var On=Array(6);return Un(sn,wn,It,hn,yn,Hn),Un.subimage=function(kn,Mn,Ln,Dn,Kn){Ln|=0,Dn|=0,Kn|=0;var Qn=Mt();return Lt(Qn,jn),Qn.width=0,Qn.height=0,qt(Qn,Mn),Qn.width=Qn.width||(jn.width>>Kn)-Ln,Qn.height=Qn.height||(jn.height>>Kn)-Dn,nn(jn),St(Qn,34069+kn,Ln,Dn,Kn),an(),Ce(Qn),Un},Un.resize=function(kn){if((kn|=0)!==jn.width){Un.width=jn.width=kn,Un.height=jn.height=kn,nn(jn);for(var Mn=0;6>Mn;++Mn)for(var Ln=0;jn.mipmask>>Ln;++Ln)he.texImage2D(34069+Mn,Ln,jn.format,kn>>Ln,kn>>Ln,0,jn.format,jn.type,null);return an(),ut.profile&&(jn.stats.size=T(jn.internalformat,jn.type,Un.width,Un.height,!1,!0)),Un}},Un._reglType="textureCube",Un._texture=jn,ut.profile&&(Un.stats=jn.stats),Un.destroy=function(){jn.decRef()},Un},clear:function(){for(var sn=0;sn<jr;++sn)he.activeTexture(33984+sn),he.bindTexture(3553,null),ri[sn]=null;fe(Lr).forEach(on),Ze.cubeCount=0,Ze.textureCount=0},getTexture:function(sn){return null},restore:function(){for(var sn=0;sn<jr;++sn){var wn=ri[sn];wn&&(wn.bindCount=0,wn.unit=-1,ri[sn]=null)}fe(Lr).forEach(function(It){It.texture=he.createTexture(),he.bindTexture(It.target,It.texture);for(var hn=0;32>hn;++hn)if(0!=(It.mipmask&1<<hn))if(3553===It.target)he.texImage2D(3553,hn,It.internalformat,It.width>>hn,It.height>>hn,0,It.internalformat,It.type,null);else for(var yn=0;6>yn;++yn)he.texImage2D(34069+yn,hn,It.internalformat,It.width>>hn,It.height>>hn,0,It.internalformat,It.type,null);zn(It.texInfo,It.target)})},refresh:function(){for(var sn=0;sn<jr;++sn){var wn=ri[sn];wn&&(wn.bindCount=0,wn.unit=-1,ri[sn]=null),he.activeTexture(33984+sn),he.bindTexture(3553,null),he.bindTexture(34067,null)}}}}(St,zt,gn,function(){qn.procs.poll()},zn,st,he),Pn=function(he,be,Fe,He,Ke){function Ze(pt){this.id=Ot++,this.refCount=1,this.renderbuffer=pt,this.format=32854,this.height=this.width=0,Ke.profile&&(this.stats={size:0})}function ut(pt){var qt=pt.renderbuffer;he.bindRenderbuffer(36161,null),he.deleteRenderbuffer(qt),pt.renderbuffer=null,pt.refCount=0,delete ot[pt.id],He.renderbufferCount--}var lt={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};be.ext_srgb&&(lt.srgba=35907),be.ext_color_buffer_half_float&&(lt.rgba16f=34842,lt.rgb16f=34843),be.webgl_color_buffer_float&&(lt.rgba32f=34836);var Lt=[];Object.keys(lt).forEach(function(pt){Lt[lt[pt]]=pt});var Ot=0,ot={};return Ze.prototype.decRef=function(){0>=--this.refCount&&ut(this)},Ke.profile&&(He.getTotalRenderbufferSize=function(){var pt=0;return Object.keys(ot).forEach(function(qt){pt+=ot[qt].stats.size}),pt}),{create:function(pt,qt){function St(Ce,Xe){var st=0,dt=0,zt=32854;if("object"==typeof Ce&&Ce?("shape"in Ce?(st=0|(dt=Ce.shape)[0],dt=0|dt[1]):("radius"in Ce&&(st=dt=0|Ce.radius),"width"in Ce&&(st=0|Ce.width),"height"in Ce&&(dt=0|Ce.height)),"format"in Ce&&(zt=lt[Ce.format])):"number"==typeof Ce?(st=0|Ce,dt="number"==typeof Xe?0|Xe:st):Ce||(st=dt=1),st!==Mt.width||dt!==Mt.height||zt!==Mt.format)return St.width=Mt.width=st,St.height=Mt.height=dt,Mt.format=zt,he.bindRenderbuffer(36161,Mt.renderbuffer),he.renderbufferStorage(36161,zt,st,dt),Ke.profile&&(Mt.stats.size=gt[Mt.format]*Mt.width*Mt.height),St.format=Lt[Mt.format],St}var Mt=new Ze(he.createRenderbuffer());return ot[Mt.id]=Mt,He.renderbufferCount++,St(pt,qt),St.resize=function(Ce,Xe){var st=0|Ce,dt=0|Xe||st;return st===Mt.width&&dt===Mt.height||(St.width=Mt.width=st,St.height=Mt.height=dt,he.bindRenderbuffer(36161,Mt.renderbuffer),he.renderbufferStorage(36161,Mt.format,st,dt),Ke.profile&&(Mt.stats.size=gt[Mt.format]*Mt.width*Mt.height)),St},St._reglType="renderbuffer",St._renderbuffer=Mt,Ke.profile&&(St.stats=Mt.stats),St.destroy=function(){Mt.decRef()},St},clear:function(){fe(ot).forEach(ut)},restore:function(){fe(ot).forEach(function(pt){pt.renderbuffer=he.createRenderbuffer(),he.bindRenderbuffer(36161,pt.renderbuffer),he.renderbufferStorage(36161,pt.format,pt.width,pt.height)}),he.bindRenderbuffer(36161,null)}}}(St,zt,0,st,he),Rn=function M(he,be,Fe,He,Ke,Ze){function ut(gn,nn,an){this.target=gn,this.texture=nn,this.renderbuffer=an;var on=gn=0;nn?(gn=nn.width,on=nn.height):an&&(gn=an.width,on=an.height),this.width=gn,this.height=on}function lt(gn){gn&&(gn.texture&&gn.texture._texture.decRef(),gn.renderbuffer&&gn.renderbuffer._renderbuffer.decRef())}function Lt(gn,nn,an){gn&&(gn.texture?gn.texture._texture.refCount+=1:gn.renderbuffer._renderbuffer.refCount+=1)}function Ot(gn,nn){nn&&(nn.texture?he.framebufferTexture2D(36160,gn,nn.target,nn.texture._texture.texture,0):he.framebufferRenderbuffer(36160,gn,36161,nn.renderbuffer._renderbuffer.renderbuffer))}function ot(gn){var nn=3553,an=null,on=null,mn=gn;return"object"==typeof gn&&(mn=gn.data,"target"in gn&&(nn=0|gn.target)),"texture2d"===(gn=mn._reglType)||"textureCube"===gn?an=mn:"renderbuffer"===gn&&(on=mn,nn=36161),new ut(nn,an,on)}function pt(gn,nn,an,on,mn){return an?((gn=He.create2D({width:gn,height:nn,format:on,type:mn}))._texture.refCount=0,new ut(3553,gn,null)):((gn=Ke.create({width:gn,height:nn,format:on}))._renderbuffer.refCount=0,new ut(36161,null,gn))}function qt(gn){return gn&&(gn.texture||gn.renderbuffer)}function St(gn,nn,an){gn&&(gn.texture?gn.texture.resize(nn,an):gn.renderbuffer&&gn.renderbuffer.resize(nn,an),gn.width=nn,gn.height=an)}function Mt(){this.id=vn++,zn[this.id]=this,this.framebuffer=he.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Ce(gn){gn.colorAttachments.forEach(lt),lt(gn.depthAttachment),lt(gn.stencilAttachment),lt(gn.depthStencilAttachment)}function Xe(gn){he.deleteFramebuffer(gn.framebuffer),gn.framebuffer=null,Ze.framebufferCount--,delete zn[gn.id]}function st(gn){var nn;he.bindFramebuffer(36160,gn.framebuffer);var an=gn.colorAttachments;for(nn=0;nn<an.length;++nn)Ot(36064+nn,an[nn]);for(nn=an.length;nn<Fe.maxColorAttachments;++nn)he.framebufferTexture2D(36160,36064+nn,3553,null,0);he.framebufferTexture2D(36160,33306,3553,null,0),he.framebufferTexture2D(36160,36096,3553,null,0),he.framebufferTexture2D(36160,36128,3553,null,0),Ot(36096,gn.depthAttachment),Ot(36128,gn.stencilAttachment),Ot(33306,gn.depthStencilAttachment),he.checkFramebufferStatus(36160),he.isContextLost(),he.bindFramebuffer(36160,zt.next?zt.next.framebuffer:null),zt.cur=zt.next,he.getError()}function dt(gn,nn){function an(mn,_n){var Pn,Rn=0,qn=0,Xn=!0,br=!0;Pn=null;var fr=!0,Vr="rgba",cr="uint8",Sr=1,Cr=null,pi=null,Yn=null,ar=!1;"number"==typeof mn?(Rn=0|mn,qn=0|_n||Rn):mn?("shape"in mn?(Rn=(qn=mn.shape)[0],qn=qn[1]):("radius"in mn&&(Rn=qn=mn.radius),"width"in mn&&(Rn=mn.width),"height"in mn&&(qn=mn.height)),("color"in mn||"colors"in mn)&&(Pn=mn.color||mn.colors,Array.isArray(Pn)),Pn||("colorCount"in mn&&(Sr=0|mn.colorCount),"colorTexture"in mn&&(fr=!!mn.colorTexture,Vr="rgba4"),"colorType"in mn&&(cr=mn.colorType,!fr)&&("half float"===cr||"float16"===cr?Vr="rgba16f":"float"!==cr&&"float32"!==cr||(Vr="rgba32f")),"colorFormat"in mn&&(0<=Ht.indexOf(Vr=mn.colorFormat)?fr=!0:0<=Kt.indexOf(Vr)&&(fr=!1))),("depthTexture"in mn||"depthStencilTexture"in mn)&&(ar=!(!mn.depthTexture&&!mn.depthStencilTexture)),"depth"in mn&&("boolean"==typeof mn.depth?Xn=mn.depth:(Cr=mn.depth,br=!1)),"stencil"in mn&&("boolean"==typeof mn.stencil?br=mn.stencil:(pi=mn.stencil,Xn=!1)),"depthStencil"in mn&&("boolean"==typeof mn.depthStencil?Xn=br=mn.depthStencil:(Yn=mn.depthStencil,br=Xn=!1))):Rn=qn=1;var Ar=null,sr=null,dr=null,$r=null;if(Array.isArray(Pn))Ar=Pn.map(ot);else if(Pn)Ar=[ot(Pn)];else for(Ar=Array(Sr),Pn=0;Pn<Sr;++Pn)Ar[Pn]=pt(Rn,qn,fr,Vr,cr);for(Rn=Rn||Ar[0].width,qn=qn||Ar[0].height,Cr?sr=ot(Cr):Xn&&!br&&(sr=pt(Rn,qn,ar,"depth","uint32")),pi?dr=ot(pi):br&&!Xn&&(dr=pt(Rn,qn,!1,"stencil","uint8")),Yn?$r=ot(Yn):!Cr&&!pi&&br&&Xn&&($r=pt(Rn,qn,ar,"depth stencil","depth stencil")),Xn=null,Pn=0;Pn<Ar.length;++Pn)Lt(Ar[Pn]),Ar[Pn]&&Ar[Pn].texture&&(br=et[Ar[Pn].texture._texture.format]*yt[Ar[Pn].texture._texture.type],null===Xn&&(Xn=br));return Lt(sr),Lt(dr),Lt($r),Ce(on),on.width=Rn,on.height=qn,on.colorAttachments=Ar,on.depthAttachment=sr,on.stencilAttachment=dr,on.depthStencilAttachment=$r,an.color=Ar.map(qt),an.depth=qt(sr),an.stencil=qt(dr),an.depthStencil=qt($r),an.width=on.width,an.height=on.height,st(on),an}var on=new Mt;return Ze.framebufferCount++,an(gn,nn),B(an,{resize:function(mn,_n){var Pn=Math.max(0|mn,1),Rn=Math.max(0|_n||Pn,1);if(Pn===on.width&&Rn===on.height)return an;for(var qn=on.colorAttachments,Xn=0;Xn<qn.length;++Xn)St(qn[Xn],Pn,Rn);return St(on.depthAttachment,Pn,Rn),St(on.stencilAttachment,Pn,Rn),St(on.depthStencilAttachment,Pn,Rn),on.width=an.width=Pn,on.height=an.height=Rn,st(on),an},_reglType:"framebuffer",_framebuffer:on,destroy:function(){Xe(on),Ce(on)},use:function(mn){zt.setFBO({framebuffer:an},mn)}})}var zt={cur:null,next:null,dirty:!1,setFBO:null},Ht=["rgba"],Kt=["rgba4","rgb565","rgb5 a1"];be.ext_srgb&&Kt.push("srgba"),be.ext_color_buffer_half_float&&Kt.push("rgba16f","rgb16f"),be.webgl_color_buffer_float&&Kt.push("rgba32f");var Zt=["uint8"];be.oes_texture_half_float&&Zt.push("half float","float16"),be.oes_texture_float&&Zt.push("float","float32");var vn=0,zn={};return B(zt,{getFramebuffer:function(gn){return"function"==typeof gn&&"framebuffer"===gn._reglType&&(gn=gn._framebuffer)instanceof Mt?gn:null},create:dt,createCube:function(gn){function nn(on){var mn,_n={color:null},Pn=0,Rn=null;mn="rgba";var qn="uint8",Xn=1;if("number"==typeof on?Pn=0|on:on?("shape"in on?Pn=on.shape[0]:("radius"in on&&(Pn=0|on.radius),"width"in on?Pn=0|on.width:"height"in on&&(Pn=0|on.height)),("color"in on||"colors"in on)&&(Rn=on.color||on.colors,Array.isArray(Rn)),Rn||("colorCount"in on&&(Xn=0|on.colorCount),"colorType"in on&&(qn=on.colorType),"colorFormat"in on&&(mn=on.colorFormat)),"depth"in on&&(_n.depth=on.depth),"stencil"in on&&(_n.stencil=on.stencil),"depthStencil"in on&&(_n.depthStencil=on.depthStencil)):Pn=1,Rn)if(Array.isArray(Rn))for(on=[],mn=0;mn<Rn.length;++mn)on[mn]=Rn[mn];else on=[Rn];else for(on=Array(Xn),Rn={radius:Pn,format:mn,type:qn},mn=0;mn<Xn;++mn)on[mn]=He.createCube(Rn);for(_n.color=Array(on.length),mn=0;mn<on.length;++mn)Xn=on[mn],Pn=Pn||Xn.width,_n.color[mn]={target:34069,data:on[mn]};for(mn=0;6>mn;++mn){for(Xn=0;Xn<on.length;++Xn)_n.color[Xn].target=34069+mn;0<mn&&(_n.depth=an[0].depth,_n.stencil=an[0].stencil,_n.depthStencil=an[0].depthStencil),an[mn]?an[mn](_n):an[mn]=dt(_n)}return B(nn,{width:Pn,height:Pn,color:on})}var an=Array(6);return nn(gn),B(nn,{faces:an,resize:function(on){var mn=0|on;if(mn===nn.width)return nn;var _n=nn.color;for(on=0;on<_n.length;++on)_n[on].resize(mn);for(on=0;6>on;++on)an[on].resize(mn);return nn.width=nn.height=mn,nn},_reglType:"framebufferCube",destroy:function(){an.forEach(function(on){on.destroy()})}})},clear:function(){fe(zn).forEach(Xe)},restore:function(){zt.cur=null,zt.next=null,zt.dirty=!0,fe(zn).forEach(function(gn){gn.framebuffer=he.createFramebuffer(),st(gn)})}})}(St,zt,gn,_n,Pn,st),qn=U(St,Xe,zt,gn,nn,an,0,Rn,{},on,mn,Zt,zn,Ht,dt,he),Xn=(Xe=function C(he,be,Fe,He,Ke,Ze,ut){function lt(Lt){var Ot;Ot=null===be.next?5121:be.next.colorAttachments[0].texture._texture.type;var ot=0,pt=0,qt=He.framebufferWidth,St=He.framebufferHeight,Mt=null;return ve(Lt)?Mt=Lt:Lt&&(ot=0|Lt.x,pt=0|Lt.y,qt=0|(Lt.width||He.framebufferWidth-ot),St=0|(Lt.height||He.framebufferHeight-pt),Mt=Lt.data||null),Fe(),Lt=qt*St*4,Mt||(5121===Ot?Mt=new Uint8Array(Lt):5126===Ot&&(Mt=Mt||new Float32Array(Lt))),he.pixelStorei(3333,4),he.readPixels(ot,pt,qt,St,6408,Ot,Mt),Mt}return function(Lt){return Lt&&"framebuffer"in Lt?(be.setFBO({framebuffer:(Ot=Lt).framebuffer},function(){ot=lt(Ot)}),ot):lt(Lt);var Ot,ot}}(St,Rn,qn.procs.poll,zn),qn.next),br=St.canvas,fr=[],Vr=[],cr=[],Sr=[he.onDestroy],Cr=null;br&&(br.addEventListener("webglcontextlost",Ke,!1),br.addEventListener("webglcontextrestored",Ze,!1));var pi=Rn.setFBO=ut({framebuffer:J.define.call(null,1,"framebuffer")});return pt(),Mt=B(ut,{clear:function(Yn){if("framebuffer"in Yn)if(Yn.framebuffer&&"framebufferCube"===Yn.framebuffer_reglType)for(var ar=0;6>ar;++ar)pi(B({framebuffer:Yn.framebuffer.faces[ar]},Yn),lt);else pi(Yn,lt);else lt(0,Yn)},prop:J.define.bind(null,1),context:J.define.bind(null,2),this:J.define.bind(null,3),draw:ut({}),buffer:function(Yn){return nn.create(Yn,34962,!1,!1)},elements:function(Yn){return an.create(Yn,!1)},texture:_n.create2D,cube:_n.createCube,renderbuffer:Pn.create,framebuffer:Rn.create,framebufferCube:Rn.createCube,vao:on.createVAO,attributes:Mt,frame:Lt,on:function(Yn,ar){var Ar;switch(Yn){case"frame":return Lt(ar);case"lost":Ar=Vr;break;case"restore":Ar=cr;break;case"destroy":Ar=Sr}return Ar.push(ar),{cancel:function(){for(var sr=0;sr<Ar.length;++sr)if(Ar[sr]===ar){Ar[sr]=Ar[Ar.length-1],Ar.pop();break}}}},limits:gn,hasExtension:function(Yn){return 0<=gn.extensions.indexOf(Yn.toLowerCase())},read:Xe,destroy:function(){fr.length=0,He(),br&&(br.removeEventListener("webglcontextlost",Ke),br.removeEventListener("webglcontextrestored",Ze)),mn.clear(),Rn.clear(),Pn.clear(),on.clear(),_n.clear(),an.clear(),nn.clear(),Ht&&Ht.clear(),Sr.forEach(function(Yn){Yn()})},_gl:St,_refresh:pt,poll:function(){ot(),Ht&&Ht.update()},now:qt,stats:st,getCachedCode:function(){return dt},preloadCachedCode:function(Yn){Object.entries(Yn).forEach(function(ar){dt[ar[0]]=ar[1]})}}),he.onDone(null,Mt),Mt}},"object"==typeof $&&void 0!==Q?Q.exports=t():this.createREGL=t()},{}],285:[function(v,Q,$){var g=v("buffer"),t=g.Buffer;function k(e,r){for(var i in e)r[i]=e[i]}function x(e,r,i){return t(e,r,i)}t.from&&t.alloc&&t.allocUnsafe&&t.allocUnsafeSlow?Q.exports=g:(k(g,$),$.Buffer=x),x.prototype=Object.create(t.prototype),k(t,x),x.from=function(e,r,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return t(e,r,i)},x.alloc=function(e,r,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var c=t(e);return void 0!==r?"string"==typeof i?c.fill(r,i):c.fill(r):c.fill(0),c},x.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return t(e)},x.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return g.SlowBuffer(e)}},{buffer:85}],286:[function(v,Q,$){Q.exports=t;var g=v("events").EventEmitter;function t(){g.call(this)}v("inherits")(t,g),t.Readable=v("readable-stream/lib/_stream_readable.js"),t.Writable=v("readable-stream/lib/_stream_writable.js"),t.Duplex=v("readable-stream/lib/_stream_duplex.js"),t.Transform=v("readable-stream/lib/_stream_transform.js"),t.PassThrough=v("readable-stream/lib/_stream_passthrough.js"),t.finished=v("readable-stream/lib/internal/streams/end-of-stream.js"),t.pipeline=v("readable-stream/lib/internal/streams/pipeline.js"),t.Stream=t,t.prototype.pipe=function(k,x){var e=this;function r(f){k.writable&&!1===k.write(f)&&e.pause&&e.pause()}function i(){e.readable&&e.resume&&e.resume()}e.on("data",r),k.on("drain",i),k._isStdio||x&&!1===x.end||(e.on("end",n),e.on("close",m));var c=!1;function n(){c||(c=!0,k.end())}function m(){c||(c=!0,"function"==typeof k.destroy&&k.destroy())}function p(f){if(s(),0===g.listenerCount(this,"error"))throw f}function s(){e.removeListener("data",r),k.removeListener("drain",i),e.removeListener("end",n),e.removeListener("close",m),e.removeListener("error",p),k.removeListener("error",p),e.removeListener("end",s),e.removeListener("close",s),k.removeListener("close",s)}return e.on("error",p),k.on("error",p),e.on("end",s),e.on("close",s),k.on("close",s),k.emit("pipe",e),k}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(v,Q,$){"use strict";var g={};function t(x,e,r){r||(r=Error);var i=function(c){var n,m;function p(s,f,l){return c.call(this,"string"==typeof e?e:e(s,f,l))||this}return m=c,(n=p).prototype=Object.create(m.prototype),n.prototype.constructor=n,n.__proto__=m,p}(r);i.prototype.name=r.name,i.prototype.code=x,g[x]=i}function k(x,e){if(Array.isArray(x)){var r=x.length;return x=x.map(function(i){return String(i)}),r>2?"one of ".concat(e," ").concat(x.slice(0,r-1).join(", "),", or ")+x[r-1]:2===r?"one of ".concat(e," ").concat(x[0]," or ").concat(x[1]):"of ".concat(e," ").concat(x[0])}return"of ".concat(e," ").concat(String(x))}t("ERR_INVALID_OPT_VALUE",function(x,e){return'The value "'+e+'" is invalid for option "'+x+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(x,e,r){var i,m,s,l;if("string"==typeof e&&"not "===e.substr(0,"not ".length)?(i="must not be",e=e.replace(/^not /,"")):i="must be",s=x,(void 0===l||l>s.length)&&(l=s.length)," argument"===s.substring(l-" argument".length,l))m="The ".concat(x," ").concat(i," ").concat(k(e,"type"));else{var p=function(s,f,l){return"number"!=typeof l&&(l=0),!(l+".".length>s.length)&&-1!==s.indexOf(".",l)}(x)?"property":"argument";m='The "'.concat(x,'" ').concat(p," ").concat(i," ").concat(k(e,"type"))}return m+". Received type ".concat(typeof r)},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(x){return"The "+x+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(x){return"Cannot call "+x+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(x){return"Unknown encoding: "+x},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Q.exports.codes=g},{}],288:[function(v,Q,$){(function(g){(function(){"use strict";var t=Object.keys||function(p){var s=[];for(var f in p)s.push(f);return s};Q.exports=c;var k=v("./_stream_readable"),x=v("./_stream_writable");v("inherits")(c,k);for(var e=t(x.prototype),r=0;r<e.length;r++){var i=e[r];c.prototype[i]||(c.prototype[i]=x.prototype[i])}function c(p){if(!(this instanceof c))return new c(p);k.call(this,p),x.call(this,p),this.allowHalfOpen=!0,p&&(!1===p.readable&&(this.readable=!1),!1===p.writable&&(this.writable=!1),!1===p.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",n)))}function n(){this._writableState.ended||g.nextTick(m,this)}function m(p){p.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(p){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}})}).call(this)}).call(this,v("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(v,Q,$){"use strict";Q.exports=t;var g=v("./_stream_transform");function t(k){if(!(this instanceof t))return new t(k);g.call(this,k)}v("inherits")(t,g),t.prototype._transform=function(k,x,e){e(null,k)}},{"./_stream_transform":291,inherits:231}],290:[function(v,Q,$){(function(g,t){(function(){"use strict";var k;Q.exports=T,T.ReadableState=w,v("events");var c,x=function(V,N){return V.listeners(N).length},e=v("./internal/streams/stream"),r=v("buffer").Buffer,i=t.Uint8Array||function(){},n=v("util");c=n&&n.debuglog?n.debuglog("stream"):function(){};var m,p,s,f=v("./internal/streams/buffer_list"),l=v("./internal/streams/destroy"),o=v("./internal/streams/state").getHighWaterMark,d=v("../errors").codes,u=d.ERR_INVALID_ARG_TYPE,a=d.ERR_STREAM_PUSH_AFTER_EOF,y=d.ERR_METHOD_NOT_IMPLEMENTED,h=d.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;v("inherits")(T,e);var _=l.errorOrDestroy,b=["error","close","destroy","pause","resume"];function w(V,N,U){k=k||v("./_stream_duplex"),"boolean"!=typeof U&&(U=N instanceof k),this.objectMode=!!(V=V||{}).objectMode,U&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=o(this,V,"readableHighWaterMark",U),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==V.emitClose,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(m||(m=v("string_decoder/").StringDecoder),this.decoder=new m(V.encoding),this.encoding=V.encoding)}function T(V){if(k=k||v("./_stream_duplex"),!(this instanceof T))return new T(V);this._readableState=new w(V,this,this instanceof k),this.readable=!0,V&&("function"==typeof V.read&&(this._read=V.read),"function"==typeof V.destroy&&(this._destroy=V.destroy)),e.call(this)}function L(V,N,U,ee,B){c("readableAddChunk",N);var K,te,ae,ce,oe,J=V._readableState;if(null===N)J.reading=!1,function(te,ae){if(c("onEofChunk"),!ae.ended){if(ae.decoder){var ce=ae.decoder.end();ce&&ce.length&&(ae.buffer.push(ce),ae.length+=ae.objectMode?1:ce.length)}ae.ended=!0,ae.sync?z(te):(ae.needReadable=!1,ae.emittedReadable||(ae.emittedReadable=!0,S(te)))}}(V,J);else if(B||(te=J,r.isBuffer(oe=ae=N)||oe instanceof i||"string"==typeof ae||void 0===ae||te.objectMode||(ce=new u("chunk",["string","Buffer","Uint8Array"],ae)),K=ce),K)_(V,K);else if(J.objectMode||N&&N.length>0)if("string"==typeof N||J.objectMode||Object.getPrototypeOf(N)===r.prototype||(N=function(te){return r.from(te)}(N)),ee)J.endEmitted?_(V,new h):M(V,J,N,!0);else if(J.ended)_(V,new a);else{if(J.destroyed)return!1;J.reading=!1,J.decoder&&!U?(N=J.decoder.write(N),J.objectMode||0!==N.length?M(V,J,N,!1):C(V,J)):M(V,J,N,!1)}else ee||(J.reading=!1,C(V,J));return!J.ended&&(J.length<J.highWaterMark||0===J.length)}function M(V,N,U,ee){N.flowing&&0===N.length&&!N.sync?(N.awaitDrain=0,V.emit("data",U)):(N.length+=N.objectMode?1:U.length,ee?N.buffer.unshift(U):N.buffer.push(U),N.needReadable&&z(V)),C(V,N)}function P(V,N){return V<=0||0===N.length&&N.ended?0:N.objectMode?1:V!=V?N.flowing&&N.length?N.buffer.head.data.length:N.length:(V>N.highWaterMark&&(N.highWaterMark=((U=V)>=1073741824?U=1073741824:(U--,U|=U>>>1,U|=U>>>2,U|=U>>>4,U|=U>>>8,U|=U>>>16,U++),U)),V<=N.length?V:N.ended?N.length:(N.needReadable=!0,0));var U}function z(V){var N=V._readableState;c("emitReadable",N.needReadable,N.emittedReadable),N.needReadable=!1,N.emittedReadable||(c("emitReadable",N.flowing),N.emittedReadable=!0,g.nextTick(S,V))}function S(V){var N=V._readableState;c("emitReadable_",N.destroyed,N.length,N.ended),N.destroyed||!N.length&&!N.ended||(V.emit("readable"),N.emittedReadable=!1),N.needReadable=!N.flowing&&!N.ended&&N.length<=N.highWaterMark,Z(V)}function C(V,N){N.readingMore||(N.readingMore=!0,g.nextTick(R,V,N))}function R(V,N){for(;!N.reading&&!N.ended&&(N.length<N.highWaterMark||N.flowing&&0===N.length);){var U=N.length;if(c("maybeReadMore read 0"),V.read(0),U===N.length)break}N.readingMore=!1}function D(V){var N=V._readableState;N.readableListening=V.listenerCount("readable")>0,N.resumeScheduled&&!N.paused?N.flowing=!0:V.listenerCount("data")>0&&V.resume()}function j(V){c("readable nexttick read 0"),V.read(0)}function q(V,N){c("resume",N.reading),N.reading||V.read(0),N.resumeScheduled=!1,V.emit("resume"),Z(V),N.flowing&&!N.reading&&V.read(0)}function Z(V){var N=V._readableState;for(c("flow",N.flowing);N.flowing&&null!==V.read(););}function W(V,N){return 0===N.length?null:(N.objectMode?U=N.buffer.shift():!V||V>=N.length?(U=N.decoder?N.buffer.join(""):1===N.buffer.length?N.buffer.first():N.buffer.concat(N.length),N.buffer.clear()):U=N.buffer.consume(V,N.decoder),U);var U}function G(V){var N=V._readableState;c("endReadable",N.endEmitted),N.endEmitted||(N.ended=!0,g.nextTick(X,N,V))}function X(V,N){if(c("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&0===V.length&&(V.endEmitted=!0,N.readable=!1,N.emit("end"),V.autoDestroy)){var U=N._writableState;(!U||U.autoDestroy&&U.finished)&&N.destroy()}}function ne(V,N){for(var U=0,ee=V.length;U<ee;U++)if(V[U]===N)return U;return-1}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),T.prototype.destroy=l.destroy,T.prototype._undestroy=l.undestroy,T.prototype._destroy=function(V,N){N(V)},T.prototype.push=function(V,N){var U,ee=this._readableState;return ee.objectMode?U=!0:"string"==typeof V&&((N=N||ee.defaultEncoding)!==ee.encoding&&(V=r.from(V,N),N=""),U=!0),L(this,V,N,!1,U)},T.prototype.unshift=function(V){return L(this,V,null,!0,!1)},T.prototype.isPaused=function(){return!1===this._readableState.flowing},T.prototype.setEncoding=function(V){m||(m=v("string_decoder/").StringDecoder);var N=new m(V);this._readableState.decoder=N,this._readableState.encoding=this._readableState.decoder.encoding;for(var U=this._readableState.buffer.head,ee="";null!==U;)ee+=N.write(U.data),U=U.next;return this._readableState.buffer.clear(),""!==ee&&this._readableState.buffer.push(ee),this._readableState.length=ee.length,this},T.prototype.read=function(V){c("read",V),V=parseInt(V,10);var N=this._readableState,U=V;if(0!==V&&(N.emittedReadable=!1),0===V&&N.needReadable&&((0!==N.highWaterMark?N.length>=N.highWaterMark:N.length>0)||N.ended))return c("read: emitReadable",N.length,N.ended),0===N.length&&N.ended?G(this):z(this),null;if(0===(V=P(V,N))&&N.ended)return 0===N.length&&G(this),null;var ee,B=N.needReadable;return c("need readable",B),(0===N.length||N.length-V<N.highWaterMark)&&c("length less than watermark",B=!0),N.ended||N.reading?c("reading or ended",B=!1):B&&(c("do read"),N.reading=!0,N.sync=!0,0===N.length&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(V=P(U,N))),null===(ee=V>0?W(V,N):null)?(N.needReadable=N.length<=N.highWaterMark,V=0):(N.length-=V,N.awaitDrain=0),0===N.length&&(N.ended||(N.needReadable=!0),U!==V&&N.ended&&G(this)),null!==ee&&this.emit("data",ee),ee},T.prototype._read=function(V){_(this,new y("_read()"))},T.prototype.pipe=function(V,N){var U=this,ee=this._readableState;switch(ee.pipesCount){case 0:ee.pipes=V;break;case 1:ee.pipes=[ee.pipes,V];break;default:ee.pipes.push(V)}ee.pipesCount+=1,c("pipe count=%d opts=%j",ee.pipesCount,N);var B=N&&!1===N.end||V===g.stdout||V===g.stderr?xe:J;function J(){c("onend"),V.end()}ee.endEmitted?g.nextTick(B):U.once("end",B),V.on("unpipe",function K(Se,pe){c("onunpipe"),Se===U&&pe&&!1===pe.hasUnpiped&&(pe.hasUnpiped=!0,c("cleanup"),V.removeListener("close",ve),V.removeListener("finish",fe),V.removeListener("drain",te),V.removeListener("error",oe),V.removeListener("unpipe",K),U.removeListener("end",J),U.removeListener("end",xe),U.removeListener("data",ce),ae=!0,!ee.awaitDrain||V._writableState&&!V._writableState.needDrain||te())});var Se,te=(Se=U,function(){var pe=Se._readableState;c("pipeOnDrain",pe.awaitDrain),pe.awaitDrain&&pe.awaitDrain--,0===pe.awaitDrain&&x(Se,"data")&&(pe.flowing=!0,Z(Se))});V.on("drain",te);var ae=!1;function ce(Se){c("ondata");var pe=V.write(Se);c("dest.write",pe),!1===pe&&((1===ee.pipesCount&&ee.pipes===V||ee.pipesCount>1&&-1!==ne(ee.pipes,V))&&!ae&&(c("false write response, pause",ee.awaitDrain),ee.awaitDrain++),U.pause())}function oe(Se){c("onerror",Se),xe(),V.removeListener("error",oe),0===x(V,"error")&&_(V,Se)}function ve(){V.removeListener("finish",fe),xe()}function fe(){c("onfinish"),V.removeListener("close",ve),xe()}function xe(){c("unpipe"),U.unpipe(V)}return U.on("data",ce),function(Se,pe,ge){if("function"==typeof Se.prependListener)return Se.prependListener(pe,ge);Se._events&&Se._events[pe]?Array.isArray(Se._events[pe])?Se._events[pe].unshift(ge):Se._events[pe]=[ge,Se._events[pe]]:Se.on(pe,ge)}(V,"error",oe),V.once("close",ve),V.once("finish",fe),V.emit("pipe",U),ee.flowing||(c("pipe resume"),U.resume()),V},T.prototype.unpipe=function(V){var N=this._readableState,U={hasUnpiped:!1};if(0===N.pipesCount)return this;if(1===N.pipesCount)return V&&V!==N.pipes||(V||(V=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,V&&V.emit("unpipe",this,U)),this;if(!V){var ee=N.pipes,B=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var K=0;K<B;K++)ee[K].emit("unpipe",this,{hasUnpiped:!1});return this}var J=ne(N.pipes,V);return-1===J||(N.pipes.splice(J,1),N.pipesCount-=1,1===N.pipesCount&&(N.pipes=N.pipes[0]),V.emit("unpipe",this,U)),this},T.prototype.addListener=T.prototype.on=function(V,N){var U=e.prototype.on.call(this,V,N),ee=this._readableState;return"data"===V?(ee.readableListening=this.listenerCount("readable")>0,!1!==ee.flowing&&this.resume()):"readable"===V&&(ee.endEmitted||ee.readableListening||(ee.readableListening=ee.needReadable=!0,ee.flowing=!1,ee.emittedReadable=!1,c("on readable",ee.length,ee.reading),ee.length?z(this):ee.reading||g.nextTick(j,this))),U},T.prototype.removeListener=function(V,N){var U=e.prototype.removeListener.call(this,V,N);return"readable"===V&&g.nextTick(D,this),U},T.prototype.removeAllListeners=function(V){var N=e.prototype.removeAllListeners.apply(this,arguments);return"readable"!==V&&void 0!==V||g.nextTick(D,this),N},T.prototype.resume=function(){var U,V=this._readableState;return V.flowing||(c("resume"),V.flowing=!V.readableListening,this,(U=V).resumeScheduled||(U.resumeScheduled=!0,g.nextTick(q,this,U))),V.paused=!1,this},T.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},T.prototype.wrap=function(V){var N=this,U=this._readableState,ee=!1;for(var B in V.on("end",function(){if(c("wrapped end"),U.decoder&&!U.ended){var J=U.decoder.end();J&&J.length&&N.push(J)}N.push(null)}),V.on("data",function(J){c("wrapped data"),U.decoder&&(J=U.decoder.write(J)),U.objectMode&&null==J||(U.objectMode||J&&J.length)&&(N.push(J)||(ee=!0,V.pause()))}),V)void 0===this[B]&&"function"==typeof V[B]&&(this[B]=function(J){return function(){return V[J].apply(V,arguments)}}(B));for(var K=0;K<b.length;K++)V.on(b[K],this.emit.bind(this,b[K]));return this._read=function(J){c("wrapped _read",J),ee&&(ee=!1,V.resume())},this},"function"==typeof Symbol&&(T.prototype[Symbol.asyncIterator]=function(){return void 0===p&&(p=v("./internal/streams/async_iterator")),p(this)}),Object.defineProperty(T.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(T.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(T.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),T._fromList=W,Object.defineProperty(T.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(T.from=function(V,N){return void 0===s&&(s=v("./internal/streams/from")),s(T,V,N)})}).call(this)}).call(this,v("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(v,Q,$){"use strict";Q.exports=c;var g=v("../errors").codes,t=g.ERR_METHOD_NOT_IMPLEMENTED,k=g.ERR_MULTIPLE_CALLBACK,x=g.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=g.ERR_TRANSFORM_WITH_LENGTH_0,r=v("./_stream_duplex");function i(p,s){var f=this._transformState;f.transforming=!1;var l=f.writecb;if(null===l)return this.emit("error",new k);f.writechunk=null,f.writecb=null,null!=s&&this.push(s),l(p);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function c(p){if(!(this instanceof c))return new c(p);r.call(this,p),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&("function"==typeof p.transform&&(this._transform=p.transform),"function"==typeof p.flush&&(this._flush=p.flush)),this.on("prefinish",n)}function n(){var p=this;"function"!=typeof this._flush||this._readableState.destroyed?m(this,null,null):this._flush(function(s,f){m(p,s,f)})}function m(p,s,f){if(s)return p.emit("error",s);if(null!=f&&p.push(f),p._writableState.length)throw new e;if(p._transformState.transforming)throw new x;return p.push(null)}v("inherits")(c,r),c.prototype.push=function(p,s){return this._transformState.needTransform=!1,r.prototype.push.call(this,p,s)},c.prototype._transform=function(p,s,f){f(new t("_transform()"))},c.prototype._write=function(p,s,f){var l=this._transformState;if(l.writecb=f,l.writechunk=p,l.writeencoding=s,!l.transforming){var o=this._readableState;(l.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},c.prototype._read=function(p){var s=this._transformState;null===s.writechunk||s.transforming?s.needTransform=!0:(s.transforming=!0,this._transform(s.writechunk,s.writeencoding,s.afterTransform))},c.prototype._destroy=function(p,s){r.prototype._destroy.call(this,p,function(f){s(f)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(v,Q,$){(function(g,t){(function(){"use strict";function k(R){var D=this;this.next=null,this.entry=null,this.finish=function(){!function(j,q,Z){var W=j.entry;for(j.entry=null;W;){var G=W.callback;q.pendingcb--,G(undefined),W=W.next}q.corkedRequestsFree.next=j}(D,R)}}var x;Q.exports=T,T.WritableState=w;var n,e={deprecate:v("util-deprecate")},r=v("./internal/streams/stream"),i=v("buffer").Buffer,c=t.Uint8Array||function(){},m=v("./internal/streams/destroy"),p=v("./internal/streams/state").getHighWaterMark,s=v("../errors").codes,f=s.ERR_INVALID_ARG_TYPE,l=s.ERR_METHOD_NOT_IMPLEMENTED,o=s.ERR_MULTIPLE_CALLBACK,d=s.ERR_STREAM_CANNOT_PIPE,u=s.ERR_STREAM_DESTROYED,a=s.ERR_STREAM_NULL_VALUES,y=s.ERR_STREAM_WRITE_AFTER_END,h=s.ERR_UNKNOWN_ENCODING,_=m.errorOrDestroy;function b(){}function w(R,D,j){x=x||v("./_stream_duplex"),"boolean"!=typeof j&&(j=D instanceof x),this.objectMode=!!(R=R||{}).objectMode,j&&(this.objectMode=this.objectMode||!!R.writableObjectMode),this.highWaterMark=p(this,R,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===R.decodeStrings),this.defaultEncoding=R.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Z){!function(W,G){var U,X=W._writableState,ne=X.sync,V=X.writecb;if("function"!=typeof V)throw new o;if((U=X).writing=!1,U.writecb=null,U.length-=U.writelen,U.writelen=0,G)!function(U,ee,B,K,J){--ee.pendingcb,B?(g.nextTick(J,K),g.nextTick(C,U,ee),U._writableState.errorEmitted=!0,_(U,K)):(J(K),U._writableState.errorEmitted=!0,_(U,K),C(U,ee))}(W,X,ne,G,V);else{var N=z(X)||W.destroyed;N||X.corked||X.bufferProcessing||!X.bufferedRequest||P(W,X),ne?g.nextTick(M,W,X,N,V):M(W,X,N,V)}}(D,Z)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==R.emitClose,this.autoDestroy=!!R.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new k(this)}function T(R){var D=this instanceof(x=x||v("./_stream_duplex"));if(!D&&!n.call(T,this))return new T(R);this._writableState=new w(R,this,D),this.writable=!0,R&&("function"==typeof R.write&&(this._write=R.write),"function"==typeof R.writev&&(this._writev=R.writev),"function"==typeof R.destroy&&(this._destroy=R.destroy),"function"==typeof R.final&&(this._final=R.final)),r.call(this)}function L(R,D,j,q,Z,W,G){D.writelen=q,D.writecb=G,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new u("write")):j?R._writev(Z,D.onwrite):R._write(Z,W,D.onwrite),D.sync=!1}function M(R,D,j,q){var Z,W;j||(Z=R,0===(W=D).length&&W.needDrain&&(W.needDrain=!1,Z.emit("drain"))),D.pendingcb--,q(),C(R,D)}function P(R,D){D.bufferProcessing=!0;var j=D.bufferedRequest;if(R._writev&&j&&j.next){var Z=new Array(D.bufferedRequestCount),W=D.corkedRequestsFree;W.entry=j;for(var G=0,X=!0;j;)Z[G]=j,j.isBuf||(X=!1),j=j.next,G+=1;Z.allBuffers=X,L(R,D,!0,D.length,Z,"",W.finish),D.pendingcb++,D.lastBufferedRequest=null,W.next?(D.corkedRequestsFree=W.next,W.next=null):D.corkedRequestsFree=new k(D),D.bufferedRequestCount=0}else{for(;j;){var ne=j.chunk;if(L(R,D,!1,D.objectMode?1:ne.length,ne,j.encoding,j.callback),j=j.next,D.bufferedRequestCount--,D.writing)break}null===j&&(D.lastBufferedRequest=null)}D.bufferedRequest=j,D.bufferProcessing=!1}function z(R){return R.ending&&0===R.length&&null===R.bufferedRequest&&!R.finished&&!R.writing}function S(R,D){R._final(function(j){D.pendingcb--,j&&_(R,j),D.prefinished=!0,R.emit("prefinish"),C(R,D)})}function C(R,D){var Z,W,j=z(D);if(j&&(Z=R,(W=D).prefinished||W.finalCalled||("function"!=typeof Z._final||W.destroyed?(W.prefinished=!0,Z.emit("prefinish")):(W.pendingcb++,W.finalCalled=!0,g.nextTick(S,Z,W))),0===D.pendingcb&&(D.finished=!0,R.emit("finish"),D.autoDestroy))){var q=R._readableState;(!q||q.autoDestroy&&q.endEmitted)&&R.destroy()}return j}v("inherits")(T,r),w.prototype.getBuffer=function(){for(var R=this.bufferedRequest,D=[];R;)D.push(R),R=R.next;return D},function(){try{Object.defineProperty(w.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(R){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(n=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(R){return!!n.call(this,R)||this===T&&R&&R._writableState instanceof w}})):n=function(R){return R instanceof this},T.prototype.pipe=function(){_(this,new d)},T.prototype.write=function(R,D,j){var q,X,ne,V,Z=this._writableState,W=!1,G=!Z.objectMode&&(i.isBuffer(q=R)||q instanceof c);return G&&!i.isBuffer(R)&&(R=i.from(R)),"function"==typeof D&&(j=D,D=null),G?D="buffer":D||(D=Z.defaultEncoding),"function"!=typeof j&&(j=b),Z.ending?(X=this,ne=j,V=new y,_(X,V),g.nextTick(ne,V)):(G||function(X,ne,V,N){var U;return null===V?U=new a:"string"==typeof V||ne.objectMode||(U=new f("chunk",["string","Buffer"],V)),!U||(_(X,U),g.nextTick(N,U),!1)}(this,Z,R,j))&&(Z.pendingcb++,W=function(X,ne,V,N,U,ee){if(!V){var B=(ce=N,(ae=ne).objectMode||!1===ae.decodeStrings||"string"!=typeof ce||(ce=i.from(ce,U)),ce);N!==B&&(V=!0,U="buffer",N=B)}var ae,ce,K=ne.objectMode?1:N.length;ne.length+=K;var J=ne.length<ne.highWaterMark;if(J||(ne.needDrain=!0),ne.writing||ne.corked){var te=ne.lastBufferedRequest;ne.lastBufferedRequest={chunk:N,encoding:U,isBuf:V,callback:ee,next:null},te?te.next=ne.lastBufferedRequest:ne.bufferedRequest=ne.lastBufferedRequest,ne.bufferedRequestCount+=1}else L(X,ne,!1,K,N,U,ee);return J}(this,Z,G,R,D,j)),W},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,R.writing||R.corked||R.bufferProcessing||!R.bufferedRequest||P(this,R))},T.prototype.setDefaultEncoding=function(R){if("string"==typeof R&&(R=R.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((R+"").toLowerCase())>-1))throw new h(R);return this._writableState.defaultEncoding=R,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),T.prototype._write=function(R,D,j){j(new l("_write()"))},T.prototype._writev=null,T.prototype.end=function(R,D,j){var Z,W,G,q=this._writableState;return"function"==typeof R?(j=R,R=null,D=null):"function"==typeof D&&(j=D,D=null),null!=R&&this.write(R,D),q.corked&&(q.corked=1,this.uncork()),q.ending||(Z=this,G=j,(W=q).ending=!0,C(Z,W),G&&(W.finished?g.nextTick(G):Z.once("finish",G)),W.ended=!0,Z.writable=!1),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(R){this._writableState&&(this._writableState.destroyed=R)}}),T.prototype.destroy=m.destroy,T.prototype._undestroy=m.undestroy,T.prototype._destroy=function(R,D){D(R)}}).call(this)}).call(this,v("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(v,Q,$){(function(g){(function(){"use strict";var t;function k(u,a,y){return a in u?Object.defineProperty(u,a,{value:y,enumerable:!0,configurable:!0,writable:!0}):u[a]=y,u}var x=v("./end-of-stream"),e=Symbol("lastResolve"),r=Symbol("lastReject"),i=Symbol("error"),c=Symbol("ended"),n=Symbol("lastPromise"),m=Symbol("handlePromise"),p=Symbol("stream");function s(u,a){return{value:u,done:a}}function f(u){var a=u[e];if(null!==a){var y=u[p].read();null!==y&&(u[n]=null,u[e]=null,u[r]=null,a(s(y,!1)))}}function l(u){g.nextTick(f,u)}var o=Object.getPrototypeOf(function(){}),d=Object.setPrototypeOf((k(t={get stream(){return this[p]},next:function(){var u=this,a=this[i];if(null!==a)return Promise.reject(a);if(this[c])return Promise.resolve(s(void 0,!0));if(this[p].destroyed)return new Promise(function(b,w){g.nextTick(function(){u[i]?w(u[i]):b(s(void 0,!0))})});var y,b,w,h=this[n];if(h)y=new Promise((b=h,w=this,function(T,L){b.then(function(){w[c]?T(s(void 0,!0)):w[m](T,L)},L)}));else{var _=this[p].read();if(null!==_)return Promise.resolve(s(_,!1));y=new Promise(this[m])}return this[n]=y,y}},Symbol.asyncIterator,function(){return this}),k(t,"return",function(){var u=this;return new Promise(function(a,y){u[p].destroy(null,function(h){h?y(h):a(s(void 0,!0))})})}),t),o);Q.exports=function(u){var a,y=Object.create(d,(k(a={},p,{value:u,writable:!0}),k(a,e,{value:null,writable:!0}),k(a,r,{value:null,writable:!0}),k(a,i,{value:null,writable:!0}),k(a,c,{value:u._readableState.endEmitted,writable:!0}),k(a,m,{value:function(h,_){var b=y[p].read();b?(y[n]=null,y[e]=null,y[r]=null,h(s(b,!1))):(y[e]=h,y[r]=_)},writable:!0}),a));return y[n]=null,x(u,function(h){if(h&&"ERR_STREAM_PREMATURE_CLOSE"!==h.code){var _=y[r];return null!==_&&(y[n]=null,y[e]=null,y[r]=null,_(h)),void(y[i]=h)}var b=y[e];null!==b&&(y[n]=null,y[e]=null,y[r]=null,b(s(void 0,!0))),y[c]=!0}),u.on("readable",l.bind(null,y)),y}}).call(this)}).call(this,v("_process"))},{"./end-of-stream":296,_process:278}],294:[function(v,Q,$){"use strict";function g(i,c){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);c&&(m=m.filter(function(p){return Object.getOwnPropertyDescriptor(i,p).enumerable})),n.push.apply(n,m)}return n}function t(i,c,n){return c in i?Object.defineProperty(i,c,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[c]=n,i}function k(i,c){for(var n=0;n<c.length;n++){var m=c[n];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}var x=v("buffer").Buffer,e=v("util").inspect,r=e&&e.custom||"inspect";Q.exports=function(){function i(){(function(p,s){if(!(p instanceof s))throw new TypeError("Cannot call a class as a function")})(this,i),this.head=null,this.tail=null,this.length=0}var c,n;return c=i,(n=[{key:"push",value:function(p){var s={data:p,next:null};this.length>0?this.tail.next=s:this.head=s,this.tail=s,++this.length}},{key:"unshift",value:function(p){var s={data:p,next:this.head};0===this.length&&(this.tail=s),this.head=s,++this.length}},{key:"shift",value:function(){if(0!==this.length){var p=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,p}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(p){if(0===this.length)return"";for(var s=this.head,f=""+s.data;s=s.next;)f+=p+s.data;return f}},{key:"concat",value:function(p){if(0===this.length)return x.alloc(0);for(var o=x.allocUnsafe(p>>>0),d=this.head,u=0;d;)x.prototype.copy.call(d.data,o,u),u+=d.data.length,d=d.next;return o}},{key:"consume",value:function(p,s){var f;return p<this.head.data.length?(f=this.head.data.slice(0,p),this.head.data=this.head.data.slice(p)):f=p===this.head.data.length?this.shift():s?this._getString(p):this._getBuffer(p),f}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(p){var s=this.head,f=1,l=s.data;for(p-=l.length;s=s.next;){var o=s.data,d=p>o.length?o.length:p;if(l+=d===o.length?o:o.slice(0,p),0==(p-=d)){d===o.length?(++f,this.head=s.next?s.next:this.tail=null):(this.head=s,s.data=o.slice(d));break}++f}return this.length-=f,l}},{key:"_getBuffer",value:function(p){var s=x.allocUnsafe(p),f=this.head,l=1;for(f.data.copy(s),p-=f.data.length;f=f.next;){var o=f.data,d=p>o.length?o.length:p;if(o.copy(s,s.length-p,0,d),0==(p-=d)){d===o.length?(++l,this.head=f.next?f.next:this.tail=null):(this.head=f,f.data=o.slice(d));break}++l}return this.length-=l,s}},{key:r,value:function(p,s){return e(this,function(f){for(var l=1;l<arguments.length;l++){var o=null!=arguments[l]?arguments[l]:{};l%2?g(Object(o),!0).forEach(function(d){t(f,d,o[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach(function(d){Object.defineProperty(f,d,Object.getOwnPropertyDescriptor(o,d))})}return f}({},s,{depth:0,customInspect:!1}))}}])&&k(c.prototype,n),i}()},{buffer:85,util:83}],295:[function(v,Q,$){(function(g){(function(){"use strict";function t(e,r){x(e,r),k(e)}function k(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function x(e,r){e.emit("error",r)}Q.exports={destroy:function(e,r){var i=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(r?r(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,g.nextTick(x,this,e)):g.nextTick(x,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(m){!r&&m?i._writableState?i._writableState.errorEmitted?g.nextTick(k,i):(i._writableState.errorEmitted=!0,g.nextTick(t,i,m)):g.nextTick(t,i,m):r?(g.nextTick(k,i),r(m)):g.nextTick(k,i)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,r){var i=e._readableState,c=e._writableState;i&&i.autoDestroy||c&&c.autoDestroy?e.destroy(r):e.emit("error",r)}}}).call(this)}).call(this,v("_process"))},{_process:278}],296:[function(v,Q,$){"use strict";var g=v("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function t(){}Q.exports=function k(x,e,r){if("function"==typeof e)return k(x,null,e);var u,a;e||(e={}),u=r||t,a=!1,r=function(){if(!a){a=!0;for(var y=arguments.length,h=new Array(y),_=0;_<y;_++)h[_]=arguments[_];u.apply(this,h)}};var i=e.readable||!1!==e.readable&&x.readable,c=e.writable||!1!==e.writable&&x.writable,n=function(){x.writable||p()},m=x._writableState&&x._writableState.finished,p=function(){c=!1,m=!0,i||r.call(x)},s=x._readableState&&x._readableState.endEmitted,f=function(){i=!1,s=!0,c||r.call(x)},l=function(u){r.call(x,u)},o=function(){var u;return i&&!s?(x._readableState&&x._readableState.ended||(u=new g),r.call(x,u)):c&&!m?(x._writableState&&x._writableState.ended||(u=new g),r.call(x,u)):void 0},d=function(){x.req.on("finish",p)};return function(u){return u.setHeader&&"function"==typeof u.abort}(x)?(x.on("complete",p),x.on("abort",o),x.req?d():x.on("request",d)):c&&!x._writableState&&(x.on("end",n),x.on("close",n)),x.on("end",f),x.on("finish",p),!1!==e.error&&x.on("error",l),x.on("close",o),function(){x.removeListener("complete",p),x.removeListener("abort",o),x.removeListener("request",d),x.req&&x.req.removeListener("finish",p),x.removeListener("end",n),x.removeListener("close",n),x.removeListener("finish",p),x.removeListener("end",f),x.removeListener("error",l),x.removeListener("close",o)}}},{"../../../errors":287}],297:[function(v,Q,$){Q.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(v,Q,$){"use strict";var g,t=v("../../../errors").codes,k=t.ERR_MISSING_ARGS,x=t.ERR_STREAM_DESTROYED;function e(m){if(m)throw m}function r(m,p,s,f){var d,u;d=f,u=!1,f=function(){u||(u=!0,d.apply(void 0,arguments))};var l=!1;m.on("close",function(){l=!0}),void 0===g&&(g=v("./end-of-stream")),g(m,{readable:p,writable:s},function(d){if(d)return f(d);l=!0,f()});var o=!1;return function(d){if(!l&&!o)return o=!0,function(u){return u.setHeader&&"function"==typeof u.abort}(m)?m.abort():"function"==typeof m.destroy?m.destroy():void f(d||new x("pipe"))}}function i(m){m()}function c(m,p){return m.pipe(p)}function n(m){return m.length?"function"!=typeof m[m.length-1]?e:m.pop():e}Q.exports=function(){for(var m=arguments.length,p=new Array(m),s=0;s<m;s++)p[s]=arguments[s];var f,l=n(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new k("streams");var o=p.map(function(d,u){var a=u<p.length-1;return r(d,a,u>0,function(y){f||(f=y),y&&o.forEach(i),a||(o.forEach(i),l(f))})});return p.reduce(c)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(v,Q,$){"use strict";var g=v("../../../errors").codes.ERR_INVALID_OPT_VALUE;Q.exports={getHighWaterMark:function(t,k,x,e){var i,r=null!=(i=k).highWaterMark?i.highWaterMark:e?i[x]:null;if(null!=r){if(!isFinite(r)||Math.floor(r)!==r||r<0)throw new g(e?x:"highWaterMark",r);return Math.floor(r)}return t.objectMode?16:16384}}},{"../../../errors":287}],300:[function(v,Q,$){Q.exports=v("events").EventEmitter},{events:84}],301:[function(v,Q,$){"use strict";var g=v("safe-buffer").Buffer,t=g.isEncoding||function(s){switch((s=""+s)&&s.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function k(s){var f;switch(this.encoding=function(l){var o=function(d){if(!d)return"utf8";for(var u;;)switch(d){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return d;default:if(u)return;d=(""+d).toLowerCase(),u=!0}}(l);if("string"!=typeof o&&(g.isEncoding===t||!t(l)))throw new Error("Unknown encoding: "+l);return o||l}(s),this.encoding){case"utf16le":this.text=r,this.end=i,f=4;break;case"utf8":this.fillLast=e,f=4;break;case"base64":this.text=c,this.end=n,f=3;break;default:return this.write=m,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(f)}function x(s){return s<=127?0:s>>5==6?2:s>>4==14?3:s>>3==30?4:s>>6==2?-1:-2}function e(s){var f=this.lastTotal-this.lastNeed,l=function(o,d,u){if(128!=(192&d[0]))return o.lastNeed=0,"\ufffd";if(o.lastNeed>1&&d.length>1){if(128!=(192&d[1]))return o.lastNeed=1,"\ufffd";if(o.lastNeed>2&&d.length>2&&128!=(192&d[2]))return o.lastNeed=2,"\ufffd"}}(this,s);return void 0!==l?l:this.lastNeed<=s.length?(s.copy(this.lastChar,f,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(s.copy(this.lastChar,f,0,s.length),void(this.lastNeed-=s.length))}function r(s,f){if((s.length-f)%2==0){var l=s.toString("utf16le",f);if(l){var o=l.charCodeAt(l.length-1);if(o>=55296&&o<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=s[s.length-2],this.lastChar[1]=s[s.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=s[s.length-1],s.toString("utf16le",f,s.length-1)}function i(s){var f=s&&s.length?this.write(s):"";return this.lastNeed?f+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):f}function c(s,f){var l=(s.length-f)%3;return 0===l?s.toString("base64",f):(this.lastNeed=3-l,this.lastTotal=3,1===l?this.lastChar[0]=s[s.length-1]:(this.lastChar[0]=s[s.length-2],this.lastChar[1]=s[s.length-1]),s.toString("base64",f,s.length-l))}function n(s){var f=s&&s.length?this.write(s):"";return this.lastNeed?f+this.lastChar.toString("base64",0,3-this.lastNeed):f}function m(s){return s.toString(this.encoding)}function p(s){return s&&s.length?this.write(s):""}$.StringDecoder=k,k.prototype.write=function(s){if(0===s.length)return"";var f,l;if(this.lastNeed){if(void 0===(f=this.fillLast(s)))return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<s.length?f?f+this.text(s,l):this.text(s,l):f||""},k.prototype.end=function(s){var f=s&&s.length?this.write(s):"";return this.lastNeed?f+"\ufffd":f},k.prototype.text=function(s,f){var l=function(d,u,a){var y=u.length-1;if(y<a)return 0;var h=x(u[y]);return h>=0?(h>0&&(d.lastNeed=h-1),h):--y<a||-2===h?0:(h=x(u[y]))>=0?(h>0&&(d.lastNeed=h-2),h):--y<a||-2===h?0:(h=x(u[y]))>=0?(h>0&&(2===h?h=0:d.lastNeed=h-3),h):0}(this,s,f);if(!this.lastNeed)return s.toString("utf8",f);this.lastTotal=l;var o=s.length-(l-this.lastNeed);return s.copy(this.lastChar,0,o),s.toString("utf8",f,o)},k.prototype.fillLast=function(s){if(this.lastNeed<=s.length)return s.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);s.copy(this.lastChar,this.lastTotal-this.lastNeed,0,s.length),this.lastNeed-=s.length}},{"safe-buffer":285}],302:[function(v,Q,$){(function(g,t){(function(){var k=v("assert"),x=v("debug")("stream-parser");function e(l){x("initializing parser stream"),l._parserBytesLeft=0,l._parserBuffers=[],l._parserBuffered=0,l._parserState=-1,l._parserCallback=null,"function"==typeof l.push&&(l._parserOutput=l.push.bind(l)),l._parserInit=!0}function r(l,o){k(!this._parserCallback,'there is already a "callback" set!'),k(isFinite(l)&&l>0,'can only buffer a finite number of bytes > 0, got "'+l+'"'),this._parserInit||e(this),x("buffering %o bytes",l),this._parserBytesLeft=l,this._parserCallback=o,this._parserState=0}function i(l,o){k(!this._parserCallback,'there is already a "callback" set!'),k(l>0,'can only skip > 0 bytes, got "'+l+'"'),this._parserInit||e(this),x("skipping %o bytes",l),this._parserBytesLeft=l,this._parserCallback=o,this._parserState=1}function c(l,o){k(!this._parserCallback,'There is already a "callback" set!'),k(l>0,'can only pass through > 0 bytes, got "'+l+'"'),this._parserInit||e(this),x("passing through %o bytes",l),this._parserBytesLeft=l,this._parserCallback=o,this._parserState=2}function n(l,o,d){this._parserInit||e(this),x("write(%o bytes)",l.length),"function"==typeof o&&(d=o),s(this,l,null,d)}function m(l,o,d){this._parserInit||e(this),x("transform(%o bytes)",l.length),"function"!=typeof o&&(o=this._parserOutput),s(this,l,o,d)}function p(l,o,d,u){if(l._parserBytesLeft-=o.length,x("%o bytes left for stream piece",l._parserBytesLeft),0===l._parserState?(l._parserBuffers.push(o),l._parserBuffered+=o.length):2===l._parserState&&d(o),0!==l._parserBytesLeft)return u;var a=l._parserCallback;if(a&&0===l._parserState&&l._parserBuffers.length>1&&(o=t.concat(l._parserBuffers,l._parserBuffered)),0!==l._parserState&&(o=null),l._parserCallback=null,l._parserBuffered=0,l._parserState=-1,l._parserBuffers.splice(0),a){var y=[];o&&y.push(o),d&&y.push(d);var h=a.length>y.length;h&&y.push(f(u));var _=a.apply(l,y);if(!h||u===_)return u}}Q.exports=function(l){var o=l&&"function"==typeof l._transform;if(!(o||l&&"function"==typeof l._write))throw new Error("must pass a Writable or Transform stream in");x("extending Parser into stream"),l._bytes=r,l._skipBytes=i,o&&(l._passthrough=c),o?l._transform=m:l._write=n};var s=f(function l(o,d,u,a){return o._parserBytesLeft<=0?a(new Error("got data but not currently parsing anything")):d.length<=o._parserBytesLeft?function(){return p(o,d,u,a)}:function(){var y=d.slice(0,o._parserBytesLeft);return p(o,y,u,function(h){return h?a(h):d.length>y.length?function(){return l(o,d.slice(y.length),u,a)}:void 0})}});function f(l){return function(){for(var o=l.apply(this,arguments);"function"==typeof o;)o=o();return o}}}).call(this)}).call(this,v("_process"),v("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(v,Q,$){(function(g){(function(){function t(){var k;try{k=$.storage.debug}catch(x){}return!k&&void 0!==g&&"env"in g&&(k=g.env.DEBUG),k}($=Q.exports=v("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},$.formatArgs=function(k){var x=this.useColors;if(k[0]=(x?"%c":"")+this.namespace+(x?" %c":" ")+k[0]+(x?"%c ":" ")+"+"+$.humanize(this.diff),x){var e="color: "+this.color;k.splice(1,0,e,"color: inherit");var r=0,i=0;k[0].replace(/%[a-zA-Z%]/g,function(c){"%%"!==c&&(r++,"%c"===c&&(i=r))}),k.splice(i,0,e)}},$.save=function(k){try{null==k?$.storage.removeItem("debug"):$.storage.debug=k}catch(x){}},$.load=t,$.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},$.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(k){}}(),$.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],$.formatters.j=function(k){try{return JSON.stringify(k)}catch(x){return"[UnexpectedJSONParseError]: "+x.message}},$.enable(t())}).call(this)}).call(this,v("_process"))},{"./debug":304,_process:278}],304:[function(v,Q,$){var g;function t(k){function x(){if(x.enabled){var e=x,r=+new Date;e.diff=r-(g||r),e.prev=g,e.curr=r,g=r;for(var c=new Array(arguments.length),n=0;n<c.length;n++)c[n]=arguments[n];c[0]=$.coerce(c[0]),"string"!=typeof c[0]&&c.unshift("%O");var m=0;c[0]=c[0].replace(/%([a-zA-Z%])/g,function(s,f){if("%%"===s)return s;m++;var l=$.formatters[f];return"function"==typeof l&&(s=l.call(e,c[m]),c.splice(m,1),m--),s}),$.formatArgs.call(e,c),(x.log||$.log||console.log.bind(console)).apply(e,c)}}return x.namespace=k,x.enabled=$.enabled(k),x.useColors=$.useColors(),x.color=function(e){var r,i=0;for(r in e)i=(i<<5)-i+e.charCodeAt(r),i|=0;return $.colors[Math.abs(i)%$.colors.length]}(k),"function"==typeof $.init&&$.init(x),x}($=Q.exports=t.debug=t.default=t).coerce=function(k){return k instanceof Error?k.stack||k.message:k},$.disable=function(){$.enable("")},$.enable=function(k){$.save(k),$.names=[],$.skips=[];for(var x=("string"==typeof k?k:"").split(/[\s,]+/),e=x.length,r=0;r<e;r++)x[r]&&("-"===(k=x[r].replace(/\*/g,".*?"))[0]?$.skips.push(new RegExp("^"+k.substr(1)+"$")):$.names.push(new RegExp("^"+k+"$")))},$.enabled=function(k){var x,e;for(x=0,e=$.skips.length;x<e;x++)if($.skips[x].test(k))return!1;for(x=0,e=$.names.length;x<e;x++)if($.names[x].test(k))return!0;return!1},$.humanize=v("ms"),$.names=[],$.skips=[],$.formatters={}},{ms:305}],305:[function(v,Q,$){var g=1e3,t=6e4,k=60*t,x=24*k;function e(r,i,c){if(!(r<i))return r<1.5*i?Math.floor(r/i)+" "+c:Math.ceil(r/i)+" "+c+"s"}Q.exports=function(r,i){i=i||{};var c,m,n=typeof r;if("string"===n&&r.length>0)return function(m){if(!((m=String(m)).length>100)){var p=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(m);if(p){var s=parseFloat(p[1]);switch((p[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*x;case"hours":case"hour":case"hrs":case"hr":case"h":return s*k;case"minutes":case"minute":case"mins":case"min":case"m":return s*t;case"seconds":case"second":case"secs":case"sec":case"s":return s*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(r);if("number"===n&&!1===isNaN(r))return i.long?e(c=r,x,"day")||e(c,k,"hour")||e(c,t,"minute")||e(c,g,"second")||c+" ms":(m=r)>=x?Math.round(m/x)+"d":m>=k?Math.round(m/k)+"h":m>=t?Math.round(m/t)+"m":m>=g?Math.round(m/g)+"s":m+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))}},{}],306:[function(v,Q,$){"use strict";var g=v("parenthesis");Q.exports=function(t,k,x){if(null==t)throw Error("First argument should be a string");if(null==k)throw Error("Separator should be a string or a RegExp");x?("string"==typeof x||Array.isArray(x))&&(x={ignore:x}):x={},null==x.escape&&(x.escape=!0),null==x.ignore?x.ignore=["[]","()","{}","<>",'""',"''","``","\u201c\u201d","\xab\xbb"]:("string"==typeof x.ignore&&(x.ignore=[x.ignore]),x.ignore=x.ignore.map(function(p){return 1===p.length&&(p+=p),p}));var e=g.parse(t,{flat:!0,brackets:x.ignore}),r=e[0].split(k);if(x.escape){for(var i=[],c=0;c<r.length;c++){var n=r[c];"\\"===n[n.length-1]&&"\\"!==n[n.length-2]?(i.push(n+k+r[c+1]),c++):i.push(n)}r=i}for(c=0;c<r.length;c++)e[0]=r[c],r[c]=g.stringify(e,{flat:!0});return r}},{parenthesis:248}],307:[function(v,Q,$){"use strict";Q.exports=function(g){for(var t=g.length,k=new Array(t),x=new Array(t),e=new Array(t),r=new Array(t),i=new Array(t),c=new Array(t),n=0;n<t;++n)k[n]=-1,x[n]=0,e[n]=!1,r[n]=0,i[n]=-1,c[n]=[];var m,p=0,s=[],f=[];function l(u){var a=[u],y=[u];for(k[u]=x[u]=p,e[u]=!0,p+=1;y.length>0;){var h=g[u=y[y.length-1]];if(r[u]<h.length){for(var _=r[u];_<h.length;++_){var b=h[_];if(k[b]<0){k[b]=x[b]=p,e[b]=!0,p+=1,a.push(b),y.push(b);break}e[b]&&(x[u]=0|Math.min(x[u],x[b])),i[b]>=0&&c[u].push(i[b])}r[u]=_}else{if(x[u]===k[u]){var w=[],T=[],L=0;for(_=a.length-1;_>=0;--_){var M=a[_];if(e[M]=!1,w.push(M),T.push(c[M]),L+=c[M].length,i[M]=s.length,M===u){a.length=_;break}}s.push(w);var P=new Array(L);for(_=0;_<T.length;_++)for(var z=0;z<T[_].length;z++)P[--L]=T[_][z];f.push(P)}y.pop()}}}for(n=0;n<t;++n)k[n]<0&&l(n);for(n=0;n<f.length;n++){var o=f[n];if(0!==o.length){o.sort(function(u,a){return u-a}),m=[o[0]];for(var d=1;d<o.length;d++)o[d]!==o[d-1]&&m.push(o[d]);f[n]=m}}return{components:s,adjacencyList:f}}},{}],308:[function(v,Q,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var t=2*Math.PI,k=function(r,i,c,n,m,p,s){var f=r.x,l=r.y;return{x:n*(f*=i)-m*(l*=c)+p,y:m*f+n*l+s}},x=function(r,i){var c=1.5707963267948966===i?.551915024494:-1.5707963267948966===i?-.551915024494:1.3333333333333333*Math.tan(i/4),n=Math.cos(r),m=Math.sin(r),p=Math.cos(r+i),s=Math.sin(r+i);return[{x:n-m*c,y:m+n*c},{x:p+s*c,y:s-p*c},{x:p,y:s}]},e=function(r,i,c,n){var m=r*c+i*n;return m>1&&(m=1),m<-1&&(m=-1),(r*n-i*c<0?-1:1)*Math.acos(m)};$.default=function(r){var i=r.px,c=r.py,n=r.cx,m=r.cy,p=r.rx,s=r.ry,f=r.xAxisRotation,l=void 0===f?0:f,o=r.largeArcFlag,d=void 0===o?0:o,u=r.sweepFlag,a=void 0===u?0:u,y=[];if(0===p||0===s)return[];var h=Math.sin(l*t/360),_=Math.cos(l*t/360),b=_*(i-n)/2+h*(c-m)/2,w=-h*(i-n)/2+_*(c-m)/2;if(0===b&&0===w)return[];p=Math.abs(p),s=Math.abs(s);var T=Math.pow(b,2)/Math.pow(p,2)+Math.pow(w,2)/Math.pow(s,2);T>1&&(p*=Math.sqrt(T),s*=Math.sqrt(T));var M=function(r,i){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(c,n){var m=[],p=!0,s=!1,f=void 0;try{for(var l,o=c[Symbol.iterator]();!(p=(l=o.next()).done)&&(m.push(l.value),!n||m.length!==n);p=!0);}catch(d){s=!0,f=d}finally{try{!p&&o.return&&o.return()}finally{if(s)throw f}}return m}(r,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(function(q,Z,W,G,X,ne,V,N,U,ee,B,K){var J=Math.pow(X,2),te=Math.pow(ne,2),ae=Math.pow(B,2),ce=Math.pow(K,2),oe=J*te-J*ce-te*ae;oe<0&&(oe=0),oe/=J*ce+te*ae;var ve=(oe=Math.sqrt(oe)*(V===N?-1:1))*X/ne*K,fe=oe*-ne/X*B,xe=ee*ve-U*fe+(q+W)/2,Se=U*ve+ee*fe+(Z+G)/2,pe=(B-ve)/X,ge=(K-fe)/ne,Te=(-B-ve)/X,se=(-K-fe)/ne,de=e(1,0,pe,ge),Ae=e(pe,ge,Te,se);return 0===N&&Ae>0&&(Ae-=t),1===N&&Ae<0&&(Ae+=t),[xe,Se,de,Ae]}(i,c,n,m,p,s,d,a,h,_,b,w),4),P=M[0],z=M[1],S=M[2],C=M[3],R=Math.abs(C)/(t/4);Math.abs(1-R)<1e-7&&(R=1);var D=Math.max(Math.ceil(R),1);C/=D;for(var j=0;j<D;j++)y.push(x(S,C)),S+=C;return y.map(function(q){var Z=k(q[0],p,s,_,h,P,z),W=Z.x,G=Z.y,X=k(q[1],p,s,_,h,P,z),ne=X.x,V=X.y,N=k(q[2],p,s,_,h,P,z);return{x1:W,y1:G,x2:ne,y2:V,x:N.x,y:N.y}})},Q.exports=$.default},{}],309:[function(v,Q,$){"use strict";var g=v("parse-svg-path"),t=v("abs-svg-path"),k=v("normalize-svg-path"),x=v("is-svg-path"),e=v("assert");Q.exports=function(r){if(Array.isArray(r)&&1===r.length&&"string"==typeof r[0]&&(r=r[0]),"string"==typeof r&&(e(x(r),"String is not an SVG path."),r=g(r)),e(Array.isArray(r),"Argument should be a string or an array of path segments."),r=t(r),!(r=k(r)).length)return[0,0,0,0];for(var i=[1/0,1/0,-1/0,-1/0],c=0,n=r.length;c<n;c++)for(var m=r[c].slice(1),p=0;p<m.length;p+=2)m[p+0]<i[0]&&(i[0]=m[p+0]),m[p+1]<i[1]&&(i[1]=m[p+1]),m[p+0]>i[2]&&(i[2]=m[p+0]),m[p+1]>i[3]&&(i[3]=m[p+1]);return i}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(v,Q,$){"use strict";Q.exports=function(x){for(var e,r=[],i=0,c=0,n=0,m=0,p=null,s=null,f=0,l=0,o=0,d=x.length;o<d;o++){var u=x[o],a=u[0];switch(a){case"M":n=u[1],m=u[2];break;case"A":var y=g({px:f,py:l,cx:u[6],cy:u[7],rx:u[1],ry:u[2],xAxisRotation:u[3],largeArcFlag:u[4],sweepFlag:u[5]});if(!y.length)continue;for(var h,_=0;_<y.length;_++)u=["C",(h=y[_]).x1,h.y1,h.x2,h.y2,h.x,h.y],_<y.length-1&&r.push(u);break;case"S":var b=f,w=l;"C"!=e&&"S"!=e||(b+=b-i,w+=w-c),u=["C",b,w,u[1],u[2],u[3],u[4]];break;case"T":"Q"==e||"T"==e?(p=2*f-p,s=2*l-s):(p=f,s=l),u=k(f,l,p,s,u[1],u[2]);break;case"Q":p=u[1],s=u[2],u=k(f,l,u[1],u[2],u[3],u[4]);break;case"L":u=t(f,l,u[1],u[2]);break;case"H":u=t(f,l,u[1],l);break;case"V":u=t(f,l,f,u[1]);break;case"Z":u=t(f,l,n,m)}e=a,f=u[u.length-2],l=u[u.length-1],u.length>4?(i=u[u.length-4],c=u[u.length-3]):(i=f,c=l),r.push(u)}return r};var g=v("svg-arc-to-cubic-bezier");function t(x,e,r,i){return["C",x,e,r,i,r,i]}function k(x,e,r,i,c,n){return["C",x/3+2/3*r,e/3+2/3*i,c/3+2/3*r,n/3+2/3*i,c,n]}},{"svg-arc-to-cubic-bezier":308}],311:[function(v,Q,$){"use strict";var g,t=v("svg-path-bounds"),k=v("parse-svg-path"),x=v("draw-svg-path"),e=v("is-svg-path"),r=v("bitmap-sdf"),i=document.createElement("canvas"),c=i.getContext("2d");Q.exports=function(n,m){if(!e(n))throw Error("Argument should be valid svg path string");var p,s;m||(m={}),m.shape?(p=m.shape[0],s=m.shape[1]):(p=i.width=m.w||m.width||200,s=i.height=m.h||m.height||200);var f=Math.min(p,s),l=m.stroke||0,o=m.viewbox||m.viewBox||t(n),d=[p/(o[2]-o[0]),s/(o[3]-o[1])],u=Math.min(d[0]||0,d[1]||0)/2;if(c.fillStyle="black",c.fillRect(0,0,p,s),c.fillStyle="white",l&&("number"!=typeof l&&(l=1),c.strokeStyle=l>0?"white":"black",c.lineWidth=Math.abs(l)),c.translate(.5*p,.5*s),c.scale(u,u),function(){if(null!=g)return g;var h=document.createElement("canvas").getContext("2d");if(h.canvas.width=h.canvas.height=1,!window.Path2D)return g=!1;var _=new Path2D("M0,0h1v1h-1v-1Z");h.fillStyle="black",h.fill(_);var b=h.getImageData(0,0,1,1);return g=b&&b.data&&255===b.data[3]}()){var a=new Path2D(n);c.fill(a),l&&c.stroke(a)}else{var y=k(n);x(c,y),c.fill(),l&&c.stroke()}return c.setTransform(1,0,0,1,0,0),r(c,{cutoff:null!=m.cutoff?m.cutoff:.5,radius:null!=m.radius?m.radius:.5*f})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(v,Q,$){(function(g,t){(function(){var k=v("process/browser.js").nextTick,x=Function.prototype.apply,e=Array.prototype.slice,r={},i=0;function c(n,m){this._id=n,this._clearFn=m}$.setTimeout=function(){return new c(x.call(setTimeout,window,arguments),clearTimeout)},$.setInterval=function(){return new c(x.call(setInterval,window,arguments),clearInterval)},$.clearTimeout=$.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},$.enroll=function(n,m){clearTimeout(n._idleTimeoutId),n._idleTimeout=m},$.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},$._unrefActive=$.active=function(n){clearTimeout(n._idleTimeoutId);var m=n._idleTimeout;m>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},m))},$.setImmediate="function"==typeof g?g:function(n){var m=i++,p=!(arguments.length<2)&&e.call(arguments,1);return r[m]=!0,k(function(){r[m]&&(p?n.apply(null,p):n.call(null),$.clearImmediate(m))}),m},$.clearImmediate="function"==typeof t?t:function(n){delete r[n]}}).call(this)}).call(this,v("timers").setImmediate,v("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(v,Q,$){!function(g){var t=/^\s+/,k=/\s+$/,x=0,e=g.round,r=g.min,i=g.max,c=g.random;function n(U,ee){if(ee=ee||{},(U=U||"")instanceof n)return U;if(!(this instanceof n))return new n(U,ee);var K,Se,pe,J,te,ae,ce,oe,ve,fe,B=(J={r:0,g:0,b:0},te=1,ae=null,ce=null,oe=null,ve=!1,fe=!1,"string"==typeof(K=U)&&(K=function(ge){ge=ge.replace(t,"").replace(k,"").toLowerCase();var Te,se=!1;if(P[ge])ge=P[ge],se=!0;else if("transparent"==ge)return{r:0,g:0,b:0,a:0,format:"name"};return(Te=V.rgb.exec(ge))?{r:Te[1],g:Te[2],b:Te[3]}:(Te=V.rgba.exec(ge))?{r:Te[1],g:Te[2],b:Te[3],a:Te[4]}:(Te=V.hsl.exec(ge))?{h:Te[1],s:Te[2],l:Te[3]}:(Te=V.hsla.exec(ge))?{h:Te[1],s:Te[2],l:Te[3],a:Te[4]}:(Te=V.hsv.exec(ge))?{h:Te[1],s:Te[2],v:Te[3]}:(Te=V.hsva.exec(ge))?{h:Te[1],s:Te[2],v:Te[3],a:Te[4]}:(Te=V.hex8.exec(ge))?{r:D(Te[1]),g:D(Te[2]),b:D(Te[3]),a:W(Te[4]),format:se?"name":"hex8"}:(Te=V.hex6.exec(ge))?{r:D(Te[1]),g:D(Te[2]),b:D(Te[3]),format:se?"name":"hex"}:(Te=V.hex4.exec(ge))?{r:D(Te[1]+""+Te[1]),g:D(Te[2]+""+Te[2]),b:D(Te[3]+""+Te[3]),a:W(Te[4]+""+Te[4]),format:se?"name":"hex8"}:!!(Te=V.hex3.exec(ge))&&{r:D(Te[1]+""+Te[1]),g:D(Te[2]+""+Te[2]),b:D(Te[3]+""+Te[3]),format:se?"name":"hex"}}(K)),"object"==typeof K&&(N(K.r)&&N(K.g)&&N(K.b)?(Se=K.g,pe=K.b,J={r:255*C(K.r,255),g:255*C(Se,255),b:255*C(pe,255)},ve=!0,fe="%"===String(K.r).substr(-1)?"prgb":"rgb"):N(K.h)&&N(K.s)&&N(K.v)?(ae=q(K.s),ce=q(K.v),J=function(ge,Te,se){ge=6*C(ge,360),Te=C(Te,100),se=C(se,100);var de=g.floor(ge),Ae=ge-de,Le=se*(1-Te),Me=se*(1-Ae*Te),De=se*(1-(1-Ae)*Te),Oe=de%6;return{r:255*[se,Me,Le,Le,De,se][Oe],g:255*[De,se,se,Me,Le,Le][Oe],b:255*[Le,Le,De,se,se,Me][Oe]}}(K.h,ae,ce),ve=!0,fe="hsv"):N(K.h)&&N(K.s)&&N(K.l)&&(ae=q(K.s),oe=q(K.l),J=function(ge,Te,se){var de,Ae,Le;function Me(Ie,Qe,Ne){return Ne<0&&(Ne+=1),Ne>1&&(Ne-=1),Ne<1/6?Ie+6*(Qe-Ie)*Ne:Ne<.5?Qe:Ne<2/3?Ie+(Qe-Ie)*(2/3-Ne)*6:Ie}if(ge=C(ge,360),Te=C(Te,100),se=C(se,100),0===Te)de=Ae=Le=se;else{var De=se<.5?se*(1+Te):se+Te-se*Te,Oe=2*se-De;de=Me(Oe,De,ge+1/3),Ae=Me(Oe,De,ge),Le=Me(Oe,De,ge-1/3)}return{r:255*de,g:255*Ae,b:255*Le}}(K.h,ae,oe),ve=!0,fe="hsl"),K.hasOwnProperty("a")&&(te=K.a)),te=S(te),{ok:ve,format:K.format||fe,r:r(255,i(J.r,0)),g:r(255,i(J.g,0)),b:r(255,i(J.b,0)),a:te});this._originalInput=U,this._r=B.r,this._g=B.g,this._b=B.b,this._a=B.a,this._roundA=e(100*this._a)/100,this._format=ee.format||B.format,this._gradientType=ee.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=B.ok,this._tc_id=x++}function m(U,ee,B){U=C(U,255),ee=C(ee,255),B=C(B,255);var K,J,te=i(U,ee,B),ae=r(U,ee,B),ce=(te+ae)/2;if(te==ae)K=J=0;else{var oe=te-ae;switch(J=ce>.5?oe/(2-te-ae):oe/(te+ae),te){case U:K=(ee-B)/oe+(ee<B?6:0);break;case ee:K=(B-U)/oe+2;break;case B:K=(U-ee)/oe+4}K/=6}return{h:K,s:J,l:ce}}function p(U,ee,B){U=C(U,255),ee=C(ee,255),B=C(B,255);var K,J,te=i(U,ee,B),ae=r(U,ee,B),ce=te,oe=te-ae;if(J=0===te?0:oe/te,te==ae)K=0;else{switch(te){case U:K=(ee-B)/oe+(ee<B?6:0);break;case ee:K=(B-U)/oe+2;break;case B:K=(U-ee)/oe+4}K/=6}return{h:K,s:J,v:ce}}function s(U,ee,B,K){var J=[j(e(U).toString(16)),j(e(ee).toString(16)),j(e(B).toString(16))];return K&&J[0].charAt(0)==J[0].charAt(1)&&J[1].charAt(0)==J[1].charAt(1)&&J[2].charAt(0)==J[2].charAt(1)?J[0].charAt(0)+J[1].charAt(0)+J[2].charAt(0):J.join("")}function f(U,ee,B,K){return[j(Z(K)),j(e(U).toString(16)),j(e(ee).toString(16)),j(e(B).toString(16))].join("")}function l(U,ee){ee=0===ee?0:ee||10;var B=n(U).toHsl();return B.s-=ee/100,B.s=R(B.s),n(B)}function o(U,ee){ee=0===ee?0:ee||10;var B=n(U).toHsl();return B.s+=ee/100,B.s=R(B.s),n(B)}function d(U){return n(U).desaturate(100)}function u(U,ee){ee=0===ee?0:ee||10;var B=n(U).toHsl();return B.l+=ee/100,B.l=R(B.l),n(B)}function a(U,ee){ee=0===ee?0:ee||10;var B=n(U).toRgb();return B.r=i(0,r(255,B.r-e(-ee/100*255))),B.g=i(0,r(255,B.g-e(-ee/100*255))),B.b=i(0,r(255,B.b-e(-ee/100*255))),n(B)}function y(U,ee){ee=0===ee?0:ee||10;var B=n(U).toHsl();return B.l-=ee/100,B.l=R(B.l),n(B)}function h(U,ee){var B=n(U).toHsl(),K=(B.h+ee)%360;return B.h=K<0?360+K:K,n(B)}function _(U){var ee=n(U).toHsl();return ee.h=(ee.h+180)%360,n(ee)}function b(U){var ee=n(U).toHsl(),B=ee.h;return[n(U),n({h:(B+120)%360,s:ee.s,l:ee.l}),n({h:(B+240)%360,s:ee.s,l:ee.l})]}function w(U){var ee=n(U).toHsl(),B=ee.h;return[n(U),n({h:(B+90)%360,s:ee.s,l:ee.l}),n({h:(B+180)%360,s:ee.s,l:ee.l}),n({h:(B+270)%360,s:ee.s,l:ee.l})]}function T(U){var ee=n(U).toHsl(),B=ee.h;return[n(U),n({h:(B+72)%360,s:ee.s,l:ee.l}),n({h:(B+216)%360,s:ee.s,l:ee.l})]}function L(U,ee,B){ee=ee||6,B=B||30;var K=n(U).toHsl(),J=360/B,te=[n(U)];for(K.h=(K.h-(J*ee>>1)+720)%360;--ee;)K.h=(K.h+J)%360,te.push(n(K));return te}function M(U,ee){ee=ee||6;for(var B=n(U).toHsv(),K=B.h,J=B.s,te=B.v,ae=[],ce=1/ee;ee--;)ae.push(n({h:K,s:J,v:te})),te=(te+ce)%1;return ae}n.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var U=this.toRgb();return(299*U.r+587*U.g+114*U.b)/1e3},getLuminance:function(){var U,ee,B,K=this.toRgb();return ee=K.g/255,B=K.b/255,.2126*((U=K.r/255)<=.03928?U/12.92:g.pow((U+.055)/1.055,2.4))+.7152*(ee<=.03928?ee/12.92:g.pow((ee+.055)/1.055,2.4))+.0722*(B<=.03928?B/12.92:g.pow((B+.055)/1.055,2.4))},setAlpha:function(U){return this._a=S(U),this._roundA=e(100*this._a)/100,this},toHsv:function(){var U=p(this._r,this._g,this._b);return{h:360*U.h,s:U.s,v:U.v,a:this._a}},toHsvString:function(){var U=p(this._r,this._g,this._b),ee=e(360*U.h),B=e(100*U.s),K=e(100*U.v);return 1==this._a?"hsv("+ee+", "+B+"%, "+K+"%)":"hsva("+ee+", "+B+"%, "+K+"%, "+this._roundA+")"},toHsl:function(){var U=m(this._r,this._g,this._b);return{h:360*U.h,s:U.s,l:U.l,a:this._a}},toHslString:function(){var U=m(this._r,this._g,this._b),ee=e(360*U.h),B=e(100*U.s),K=e(100*U.l);return 1==this._a?"hsl("+ee+", "+B+"%, "+K+"%)":"hsla("+ee+", "+B+"%, "+K+"%, "+this._roundA+")"},toHex:function(U){return s(this._r,this._g,this._b,U)},toHexString:function(U){return"#"+this.toHex(U)},toHex8:function(U){return B=this._g,K=this._b,J=this._a,te=U,ae=[j(e(this._r).toString(16)),j(e(B).toString(16)),j(e(K).toString(16)),j(Z(J))],te&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)&&ae[3].charAt(0)==ae[3].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0)+ae[3].charAt(0):ae.join("");var B,K,J,te,ae},toHex8String:function(U){return"#"+this.toHex8(U)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*C(this._r,255))+"%",g:e(100*C(this._g,255))+"%",b:e(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+e(100*C(this._r,255))+"%, "+e(100*C(this._g,255))+"%, "+e(100*C(this._b,255))+"%)":"rgba("+e(100*C(this._r,255))+"%, "+e(100*C(this._g,255))+"%, "+e(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(z[s(this._r,this._g,this._b,!0)]||!1)},toFilter:function(U){var ee="#"+f(this._r,this._g,this._b,this._a),B=ee,K=this._gradientType?"GradientType = 1, ":"";if(U){var J=n(U);B="#"+f(J._r,J._g,J._b,J._a)}return"progid:DXImageTransform.Microsoft.gradient("+K+"startColorstr="+ee+",endColorstr="+B+")"},toString:function(U){var ee=!!U;U=U||this._format;var B=!1;return ee||!(this._a<1&&this._a>=0)||"hex"!==U&&"hex6"!==U&&"hex3"!==U&&"hex4"!==U&&"hex8"!==U&&"name"!==U?("rgb"===U&&(B=this.toRgbString()),"prgb"===U&&(B=this.toPercentageRgbString()),"hex"!==U&&"hex6"!==U||(B=this.toHexString()),"hex3"===U&&(B=this.toHexString(!0)),"hex4"===U&&(B=this.toHex8String(!0)),"hex8"===U&&(B=this.toHex8String()),"name"===U&&(B=this.toName()),"hsl"===U&&(B=this.toHslString()),"hsv"===U&&(B=this.toHsvString()),B||this.toHexString()):"name"===U&&0===this._a?this.toName():this.toRgbString()},clone:function(){return n(this.toString())},_applyModification:function(U,ee){var B=U.apply(null,[this].concat([].slice.call(ee)));return this._r=B._r,this._g=B._g,this._b=B._b,this.setAlpha(B._a),this},lighten:function(){return this._applyModification(u,arguments)},brighten:function(){return this._applyModification(a,arguments)},darken:function(){return this._applyModification(y,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(o,arguments)},greyscale:function(){return this._applyModification(d,arguments)},spin:function(){return this._applyModification(h,arguments)},_applyCombination:function(U,ee){return U.apply(null,[this].concat([].slice.call(ee)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(M,arguments)},splitcomplement:function(){return this._applyCombination(T,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},n.fromRatio=function(U,ee){if("object"==typeof U){var B={};for(var K in U)U.hasOwnProperty(K)&&(B[K]="a"===K?U[K]:q(U[K]));U=B}return n(U,ee)},n.equals=function(U,ee){return!(!U||!ee)&&n(U).toRgbString()==n(ee).toRgbString()},n.random=function(){return n.fromRatio({r:c(),g:c(),b:c()})},n.mix=function(U,ee,B){B=0===B?0:B||50;var K=n(U).toRgb(),J=n(ee).toRgb(),te=B/100;return n({r:(J.r-K.r)*te+K.r,g:(J.g-K.g)*te+K.g,b:(J.b-K.b)*te+K.b,a:(J.a-K.a)*te+K.a})},n.readability=function(U,ee){var B=n(U),K=n(ee);return(g.max(B.getLuminance(),K.getLuminance())+.05)/(g.min(B.getLuminance(),K.getLuminance())+.05)},n.isReadable=function(U,ee,B){var K,J,ae,ce,oe,te=n.readability(U,ee);switch(J=!1,(ae=B,"AA"!==(ce=((ae=ae||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==ce&&(ce="AA"),"small"!==(oe=(ae.size||"small").toLowerCase())&&"large"!==oe&&(oe="small"),K={level:ce,size:oe}).level+K.size){case"AAsmall":case"AAAlarge":J=te>=4.5;break;case"AAlarge":J=te>=3;break;case"AAAsmall":J=te>=7}return J},n.mostReadable=function(U,ee,B){var K,J,te,ae,ce=null,oe=0;J=(B=B||{}).includeFallbackColors,te=B.level,ae=B.size;for(var ve=0;ve<ee.length;ve++)(K=n.readability(U,ee[ve]))>oe&&(oe=K,ce=n(ee[ve]));return n.isReadable(U,ce,{level:te,size:ae})||!J?ce:(B.includeFallbackColors=!1,n.mostReadable(U,["#fff","#000"],B))};var P=n.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},z=n.hexNames=function(U){var ee={};for(var B in U)U.hasOwnProperty(B)&&(ee[U[B]]=B);return ee}(P);function S(U){return U=parseFloat(U),(isNaN(U)||U<0||U>1)&&(U=1),U}function C(U,ee){var K;"string"==typeof(K=U)&&-1!=K.indexOf(".")&&1===parseFloat(K)&&(U="100%");var B=function(K){return"string"==typeof K&&-1!=K.indexOf("%")}(U);return U=r(ee,i(0,parseFloat(U))),B&&(U=parseInt(U*ee,10)/100),g.abs(U-ee)<1e-6?1:U%ee/parseFloat(ee)}function R(U){return r(1,i(0,U))}function D(U){return parseInt(U,16)}function j(U){return 1==U.length?"0"+U:""+U}function q(U){return U<=1&&(U=100*U+"%"),U}function Z(U){return g.round(255*parseFloat(U)).toString(16)}function W(U){return D(U)/255}var G,X,ne,V=(X="[\\s|\\(]+("+(G="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",ne="[\\s|\\(]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",{CSS_UNIT:new RegExp(G),rgb:new RegExp("rgb"+X),rgba:new RegExp("rgba"+ne),hsl:new RegExp("hsl"+X),hsla:new RegExp("hsla"+ne),hsv:new RegExp("hsv"+X),hsva:new RegExp("hsva"+ne),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function N(U){return!!V.CSS_UNIT.exec(U)}void 0!==Q&&Q.exports?Q.exports=n:window.tinycolor=n}(Math)},{}],314:[function(v,Q,$){"use strict";Q.exports=t,Q.exports.float32=Q.exports.float=t,Q.exports.fract32=Q.exports.fract=function(k,x){if(k.length){if(k instanceof Float32Array)return new Float32Array(k.length);x instanceof Float32Array||(x=t(k));for(var e=0,r=x.length;e<r;e++)x[e]=k[e]-x[e];return x}return t(k-t(k))};var g=new Float32Array(1);function t(k){return k.length?k instanceof Float32Array?k:new Float32Array(k):(g[0]=k,g[0])}},{}],315:[function(v,Q,$){"use strict";var g=v("parse-unit");function t(x,e){var r=g(getComputedStyle(x).getPropertyValue(e));return r[0]*k(r[1],x)}function k(x,e){switch(e=e||document.body,x=(x||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),x){case"%":return e.clientHeight/100;case"ch":case"ex":return function(r,i){var c=document.createElement("div");c.style["font-size"]="128"+r,i.appendChild(c);var n=t(c,"font-size")/128;return i.removeChild(c),n}(x,e);case"em":return t(e,"font-size");case"rem":return t(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}Q.exports=k},{"parse-unit":251}],316:[function(v,Q,$){var g,t;g=this,t=function(g){"use strict";function t(f){return f}function k(f){if(null==f)return t;var l,o,d=f.scale[0],u=f.scale[1],a=f.translate[0],y=f.translate[1];return function(h,_){_||(l=o=0);var b=2,w=h.length,T=new Array(w);for(T[0]=(l+=h[0])*d+a,T[1]=(o+=h[1])*u+y;b<w;)T[b]=h[b],++b;return T}}function x(f){var l,o=k(f.transform),d=1/0,u=d,a=-d,y=-d;function h(b){(b=o(b))[0]<d&&(d=b[0]),b[0]>a&&(a=b[0]),b[1]<u&&(u=b[1]),b[1]>y&&(y=b[1])}function _(b){switch(b.type){case"GeometryCollection":b.geometries.forEach(_);break;case"Point":h(b.coordinates);break;case"MultiPoint":b.coordinates.forEach(h)}}for(l in f.arcs.forEach(function(b){for(var w,T=-1,L=b.length;++T<L;)(w=o(b[T],T))[0]<d&&(d=w[0]),w[0]>a&&(a=w[0]),w[1]<u&&(u=w[1]),w[1]>y&&(y=w[1])}),f.objects)_(f.objects[l]);return[d,u,a,y]}function e(f,l){var o=l.id,d=l.bbox,u=null==l.properties?{}:l.properties,a=r(f,l);return null==o&&null==d?{type:"Feature",properties:u,geometry:a}:null==d?{type:"Feature",id:o,properties:u,geometry:a}:{type:"Feature",id:o,bbox:d,properties:u,geometry:a}}function r(f,l){var o=k(f.transform),d=f.arcs;function u(b,w){w.length&&w.pop();for(var T=d[b<0?~b:b],L=0,M=T.length;L<M;++L)w.push(o(T[L],L));b<0&&function(P,z){for(var S,C=P.length,R=C-z;R<--C;)S=P[R],P[R++]=P[C],P[C]=S}(w,M)}function a(b){return o(b)}function y(b){for(var w=[],T=0,L=b.length;T<L;++T)u(b[T],w);return w.length<2&&w.push(w[0]),w}function h(b){for(var w=y(b);w.length<4;)w.push(w[0]);return w}function _(b){return b.map(h)}return function b(w){var T,L=w.type;switch(L){case"GeometryCollection":return{type:L,geometries:w.geometries.map(b)};case"Point":T=a(w.coordinates);break;case"MultiPoint":T=w.coordinates.map(a);break;case"LineString":T=y(w.arcs);break;case"MultiLineString":T=w.arcs.map(y);break;case"Polygon":T=_(w.arcs);break;case"MultiPolygon":T=w.arcs.map(_);break;default:return null}return{type:L,coordinates:T}}(l)}function i(f,l){var o={},d={},u={},a=[],y=-1;function h(_,b){for(var w in _){var T=_[w];delete b[T.start],delete T.start,delete T.end,T.forEach(function(L){o[L<0?~L:L]=1}),a.push(T)}}return l.forEach(function(_,b){var w,T=f.arcs[_<0?~_:_];T.length<3&&!T[1][0]&&!T[1][1]&&(w=l[++y],l[y]=_,l[b]=w)}),l.forEach(function(_){var b,w,S,C,R,D,T=(D=(R=f.arcs[(S=_)<0?~S:S])[0],f.transform?(C=[0,0],R.forEach(function(j){C[0]+=j[0],C[1]+=j[1]})):C=R[R.length-1],S<0?[C,D]:[D,C]),L=T[0],M=T[1];if(b=u[L])if(delete u[b.end],b.push(_),b.end=M,w=d[M]){delete d[w.start];var P=w===b?b:b.concat(w);d[P.start=b.start]=u[P.end=w.end]=P}else d[b.start]=u[b.end]=b;else if(b=d[M])if(delete d[b.start],b.unshift(_),b.start=L,w=u[L]){delete u[w.end];var z=w===b?b:w.concat(b);d[z.start=w.start]=u[z.end=b.end]=z}else d[b.start]=u[b.end]=b;else d[(b=[_]).start=L]=u[b.end=M]=b}),h(u,d),h(d,u),l.forEach(function(_){o[_<0?~_:_]||a.push([_])}),a}function c(f,l,o){var d,u,a;if(arguments.length>1)d=n(0,l,o);else for(u=0,d=new Array(a=f.arcs.length);u<a;++u)d[u]=u;return{type:"MultiLineString",arcs:i(f,d)}}function n(f,l,o){var d,u=[],a=[];function y(b){var w=b<0?~b:b;(a[w]||(a[w]=[])).push({i:b,g:d})}function h(b){b.forEach(y)}function _(b){b.forEach(h)}return function b(w){switch(d=w,w.type){case"GeometryCollection":w.geometries.forEach(b);break;case"LineString":h(w.arcs);break;case"MultiLineString":case"Polygon":_(w.arcs);break;case"MultiPolygon":w.arcs.forEach(_)}}(l),a.forEach(null==o?function(b){u.push(b[0].i)}:function(b){o(b[0].g,b[b.length-1].g)&&u.push(b[0].i)}),u}function m(f,l){var o={},d=[],u=[];function a(h){h.forEach(function(_){_.forEach(function(b){(o[b=b<0?~b:b]||(o[b]=[])).push(h)})}),d.push(h)}function y(h){return function(_){for(var b,w=-1,T=_.length,L=_[T-1],M=0;++w<T;)M+=(b=L)[0]*(L=_[w])[1]-b[1]*L[0];return Math.abs(M)}(r(f,{type:"Polygon",arcs:[h]}).coordinates[0])}return l.forEach(function h(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(h);break;case"Polygon":a(_.arcs);break;case"MultiPolygon":_.arcs.forEach(a)}}),d.forEach(function(h){if(!h._){var _=[],b=[h];for(h._=1,u.push(_);h=b.pop();)_.push(h),h.forEach(function(w){w.forEach(function(T){o[T<0?~T:T].forEach(function(L){L._||(L._=1,b.push(L))})})})}}),d.forEach(function(h){delete h._}),{type:"MultiPolygon",arcs:u.map(function(h){var _,b=[];if(h.forEach(function(P){P.forEach(function(z){z.forEach(function(S){o[S<0?~S:S].length<2&&b.push(S)})})}),(_=(b=i(f,b)).length)>1)for(var w,T,L=1,M=y(b[0]);L<_;++L)(w=y(b[L]))>M&&(T=b[0],b[0]=b[L],b[L]=T,M=w);return b}).filter(function(h){return h.length>0})}}function p(f,l){for(var o=0,d=f.length;o<d;){var u=o+d>>>1;f[u]<l?o=u+1:d=u}return o}function s(f){if(null==f)return t;var l,o,d=f.scale[0],u=f.scale[1],a=f.translate[0],y=f.translate[1];return function(h,_){_||(l=o=0);var b=2,w=h.length,T=new Array(w),L=Math.round((h[0]-a)/d),M=Math.round((h[1]-y)/u);for(T[0]=L-l,l=L,T[1]=M-o,o=M;b<w;)T[b]=h[b],++b;return T}}g.bbox=x,g.feature=function(f,l){return"string"==typeof l&&(l=f.objects[l]),"GeometryCollection"===l.type?{type:"FeatureCollection",features:l.geometries.map(function(o){return e(f,o)})}:e(f,l)},g.merge=function(f){return r(f,m.apply(this,arguments))},g.mergeArcs=m,g.mesh=function(f){return r(f,c.apply(this,arguments))},g.meshArcs=c,g.neighbors=function(f){var l={},o=f.map(function(){return[]});function d(P,z){P.forEach(function(S){S<0&&(S=~S);var C=l[S];C?C.push(z):l[S]=[z]})}function u(P,z){P.forEach(function(S){d(S,z)})}var a={LineString:d,MultiLineString:u,Polygon:u,MultiPolygon:function(P,z){P.forEach(function(S){u(S,z)})}};for(var y in f.forEach(function P(z,S){"GeometryCollection"===z.type?z.geometries.forEach(function(C){P(C,S)}):z.type in a&&a[z.type](z.arcs,S)}),l)for(var h=l[y],_=h.length,b=0;b<_;++b)for(var w=b+1;w<_;++w){var T,L=h[b],M=h[w];(T=o[L])[y=p(T,M)]!==M&&T.splice(y,0,M),(T=o[M])[y=p(T,L)]!==L&&T.splice(y,0,L)}return o},g.quantize=function(f,l){if(f.transform)throw new Error("already quantized");if(l&&l.scale)h=f.bbox;else{if(!((o=Math.floor(l))>=2))throw new Error("n must be \u22652");var o,d=(h=f.bbox||x(f))[0],u=h[1],a=h[2],y=h[3];l={scale:[a-d?(a-d)/(o-1):1,y-u?(y-u)/(o-1):1],translate:[d,u]}}var h,_,b=s(l),w=f.objects,T={};function L(P){return b(P)}function M(P){var z;switch(P.type){case"GeometryCollection":z={type:"GeometryCollection",geometries:P.geometries.map(M)};break;case"Point":z={type:"Point",coordinates:L(P.coordinates)};break;case"MultiPoint":z={type:"MultiPoint",coordinates:P.coordinates.map(L)};break;default:return P}return null!=P.id&&(z.id=P.id),null!=P.bbox&&(z.bbox=P.bbox),null!=P.properties&&(z.properties=P.properties),z}for(_ in w)T[_]=M(w[_]);return{type:"Topology",bbox:h,transform:l,objects:T,arcs:f.arcs.map(function(P){var z,S=0,C=1,R=P.length,D=new Array(R);for(D[0]=b(P[0],0);++S<R;)((z=b(P[S],S))[0]||z[1])&&(D[C++]=z);return 1===C&&(D[C++]=[0,0]),D.length=C,D})}},g.transform=k,g.untransform=s,Object.defineProperty(g,"__esModule",{value:!0})},t("object"==typeof $&&void 0!==Q?$:(g=g||self).topojson=g.topojson||{})},{}],317:[function(v,Q,$){"use strict";var g=v("../prototype/is");Q.exports=function(t){if("function"!=typeof t||!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length||"function"!=typeof t.call||"function"!=typeof t.apply)return!1}catch(k){return!1}return!g(t)}},{"../prototype/is":324}],318:[function(v,Q,$){"use strict";var g=v("../value/is"),t=v("../object/is"),k=v("../string/coerce"),x=v("./to-short-string"),e=function(r,i){return r.replace("%v",x(i))};Q.exports=function(r,i,c){if(!t(c))throw new TypeError(e(i,r));if(!g(r)){if("default"in c)return c.default;if(c.isOptional)return null}var n=k(c.errorMessage);throw g(n)||(n=i),new TypeError(e(n,r))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(v,Q,$){"use strict";Q.exports=function(g){try{return g.toString()}catch(t){try{return String(g)}catch(k){return null}}}},{}],320:[function(v,Q,$){"use strict";var g=v("./safe-to-string"),t=/[\n\r\u2028\u2029]/g;Q.exports=function(k){var x=g(k);return null===x?"<Non-coercible to string value>":(x.length>100&&(x=x.slice(0,99)+"\u2026"),x=x.replace(t,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(v,Q,$){"use strict";var g=v("../value/is"),t={object:!0,function:!0,undefined:!0};Q.exports=function(k){return!!g(k)&&hasOwnProperty.call(t,typeof k)}},{"../value/is":327}],322:[function(v,Q,$){"use strict";var g=v("../lib/resolve-exception"),t=v("./is");Q.exports=function(k){return t(k)?k:g(k,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(v,Q,$){"use strict";var g=v("../function/is"),t=/^\s*class[\s{/}]/,k=Function.prototype.toString;Q.exports=function(x){return!!g(x)&&!t.test(k.call(x))}},{"../function/is":317}],324:[function(v,Q,$){"use strict";var g=v("../object/is");Q.exports=function(t){if(!g(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(k){return!1}}},{"../object/is":321}],325:[function(v,Q,$){"use strict";var g=v("../value/is"),t=v("../object/is"),k=Object.prototype.toString;Q.exports=function(x){if(!g(x))return null;if(t(x)){var e=x.toString;if("function"!=typeof e||e===k)return null}try{return""+x}catch(r){return null}}},{"../object/is":321,"../value/is":327}],326:[function(v,Q,$){"use strict";var g=v("../lib/resolve-exception"),t=v("./is");Q.exports=function(k){return t(k)?k:g(k,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(v,Q,$){"use strict";Q.exports=function(g){return null!=g}},{}],328:[function(v,Q,$){(function(g){(function(){"use strict";var t=v("bit-twiddle"),k=v("dup"),x=v("buffer").Buffer;g.__TYPEDARRAY_POOL||(g.__TYPEDARRAY_POOL={UINT8:k([32,0]),UINT16:k([32,0]),UINT32:k([32,0]),BIGUINT64:k([32,0]),INT8:k([32,0]),INT16:k([32,0]),INT32:k([32,0]),BIGINT64:k([32,0]),FLOAT:k([32,0]),DOUBLE:k([32,0]),DATA:k([32,0]),UINT8C:k([32,0]),BUFFER:k([32,0])});var e="undefined"!=typeof Uint8ClampedArray,r="undefined"!=typeof BigUint64Array,i="undefined"!=typeof BigInt64Array,c=g.__TYPEDARRAY_POOL;c.UINT8C||(c.UINT8C=k([32,0])),c.BIGUINT64||(c.BIGUINT64=k([32,0])),c.BIGINT64||(c.BIGINT64=k([32,0])),c.BUFFER||(c.BUFFER=k([32,0]));var n=c.DATA,m=c.BUFFER;function p(M){if(M){var z=t.log2(M.length||M.byteLength);n[z].push(M)}}function s(M){M=t.nextPow2(M);var P=t.log2(M),z=n[P];return z.length>0?z.pop():new ArrayBuffer(M)}function f(M){return new Uint8Array(s(M),0,M)}function l(M){return new Uint16Array(s(2*M),0,M)}function o(M){return new Uint32Array(s(4*M),0,M)}function d(M){return new Int8Array(s(M),0,M)}function u(M){return new Int16Array(s(2*M),0,M)}function a(M){return new Int32Array(s(4*M),0,M)}function y(M){return new Float32Array(s(4*M),0,M)}function h(M){return new Float64Array(s(8*M),0,M)}function _(M){return e?new Uint8ClampedArray(s(M),0,M):f(M)}function b(M){return r?new BigUint64Array(s(8*M),0,M):null}function w(M){return i?new BigInt64Array(s(8*M),0,M):null}function T(M){return new DataView(s(M),0,M)}function L(M){M=t.nextPow2(M);var P=t.log2(M),z=m[P];return z.length>0?z.pop():new x(M)}$.free=function(M){if(x.isBuffer(M))m[t.log2(M.length)].push(M);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(M)&&(M=M.buffer),!M)return;var z=0|t.log2(M.length||M.byteLength);n[z].push(M)}},$.freeUint8=$.freeUint16=$.freeUint32=$.freeBigUint64=$.freeInt8=$.freeInt16=$.freeInt32=$.freeBigInt64=$.freeFloat32=$.freeFloat=$.freeFloat64=$.freeDouble=$.freeUint8Clamped=$.freeDataView=function(M){p(M.buffer)},$.freeArrayBuffer=p,$.freeBuffer=function(M){m[t.log2(M.length)].push(M)},$.malloc=function(M,P){if(void 0===P||"arraybuffer"===P)return s(M);switch(P){case"uint8":return f(M);case"uint16":return l(M);case"uint32":return o(M);case"int8":return d(M);case"int16":return u(M);case"int32":return a(M);case"float":case"float32":return y(M);case"double":case"float64":return h(M);case"uint8_clamped":return _(M);case"bigint64":return w(M);case"biguint64":return b(M);case"buffer":return L(M);case"data":case"dataview":return T(M);default:return null}return null},$.mallocArrayBuffer=s,$.mallocUint8=f,$.mallocUint16=l,$.mallocUint32=o,$.mallocInt8=d,$.mallocInt16=u,$.mallocInt32=a,$.mallocFloat32=$.mallocFloat=y,$.mallocFloat64=$.mallocDouble=h,$.mallocUint8Clamped=_,$.mallocBigUint64=b,$.mallocBigInt64=w,$.mallocDataView=T,$.mallocBuffer=L,$.clearCache=function(){for(var M=0;M<32;++M)c.UINT8[M].length=0,c.UINT16[M].length=0,c.UINT32[M].length=0,c.INT8[M].length=0,c.INT16[M].length=0,c.INT32[M].length=0,c.FLOAT[M].length=0,c.DOUBLE[M].length=0,c.BIGUINT64[M].length=0,c.BIGINT64[M].length=0,c.UINT8C[M].length=0,n[M].length=0,m[M].length=0}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(v,Q,$){var g=/[\'\"]/;Q.exports=function(t){return t?(g.test(t.charAt(0))&&(t=t.substr(1)),g.test(t.charAt(t.length-1))&&(t=t.substr(0,t.length-1)),t):""}},{}],330:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){Array.isArray(k)||(k=[].slice.call(arguments,2));for(var x=0,e=k.length;x<e;x++){var r=k[x];for(var i in r)if((void 0===t[i]||Array.isArray(t[i])||g[i]!==t[i])&&i in t){var c;if(!0===r[i])c=t[i];else if(!1===r[i]||"function"==typeof r[i]&&void 0===(c=r[i](t[i],g,t)))continue;g[i]=c}}return g}},{}],331:[function(v,Q,$){(function(g){(function(){function t(k){try{if(!g.localStorage)return!1}catch(e){return!1}var x=g.localStorage[k];return null!=x&&"true"===String(x).toLowerCase()}Q.exports=function(k,x){if(t("noDeprecation"))return k;var e=!1;return function(){if(!e){if(t("throwDeprecation"))throw new Error(x);t("traceDeprecation")?console.trace(x):console.warn(x),e=!0}return k.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],332:[function(v,Q,$){var g=v("get-canvas-context");Q.exports=function(t){return g("webgl",t)}},{"get-canvas-context":194}],333:[function(v,Q,$){var g=v("../main"),t=v("object-assign"),k=g.instance();function x(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}t(x.prototype=new g.baseCalendar,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(p,s){if("string"==typeof p){var f=p.match(r);return f?f[0]:""}var l=this._validateYear(p),o=p.month(),d=""+this.toChineseMonth(l,o);return s&&d.length<2&&(d="0"+d),this.isIntercalaryMonth(l,o)&&(d+="i"),d},monthNames:function(p){if("string"==typeof p){var s=p.match(i);return s?s[0]:""}var f=this._validateYear(p),l=p.month(),o=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"][this.toChineseMonth(f,l)-1];return this.isIntercalaryMonth(f,l)&&(o="\u95f0"+o),o},monthNamesShort:function(p){if("string"==typeof p){var s=p.match(c);return s?s[0]:""}var f=this._validateYear(p),l=p.month(),o=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"][this.toChineseMonth(f,l)-1];return this.isIntercalaryMonth(f,l)&&(o="\u95f0"+o),o},parseMonth:function(p,s){p=this._validateYear(p);var f,l=parseInt(s);if(isNaN(l))"\u95f0"===s[0]&&(f=!0,s=s.substring(1)),"\u6708"===s[s.length-1]&&(s=s.substring(0,s.length-1)),l=1+["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"].indexOf(s);else{var o=s[s.length-1];f="i"===o||"I"===o}return this.toMonthIndex(p,l,f)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(p,s){if(p.year&&(p=p.year()),"number"!=typeof p||p<1888||p>2111)throw s.replace(/\{0\}/,this.local.name);return p},toMonthIndex:function(p,s,f){var l=this.intercalaryMonth(p);if(f&&s!==l||s<1||s>12)throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return l?!f&&s<=l?s-1:s:s-1},toChineseMonth:function(p,s){p.year&&(s=(p=p.year()).month());var f=this.intercalaryMonth(p);if(s<0||s>(f?12:11))throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return f?s<f?s+1:s:s+1},intercalaryMonth:function(p){return p=this._validateYear(p),n[p-n[0]]>>13},isIntercalaryMonth:function(p,s){p.year&&(s=(p=p.year()).month());var f=this.intercalaryMonth(p);return!!f&&f===s},leapYear:function(p){return 0!==this.intercalaryMonth(p)},weekOfYear:function(p,s,f){var l,o=this._validateYear(p,g.local.invalidyear),d=m[o-m[0]];(l=k.newDate(d>>9&4095,d>>5&15,31&d)).add(4-(l.dayOfWeek()||7),"d");var h=this.toJD(p,s,f)-l.toJD();return 1+Math.floor(h/7)},monthsInYear:function(p){return this.leapYear(p)?13:12},daysInMonth:function(p,s){p.year&&(s=p.month(),p=p.year()),p=this._validateYear(p);var f=n[p-n[0]];if(s>(f>>13?12:11))throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return f&1<<12-s?30:29},weekDay:function(p,s,f){return(this.dayOfWeek(p,s,f)||7)<6},toJD:function(p,s,f){var l=this._validate(p,d,f,g.local.invalidDate);p=this._validateYear(l.year()),s=l.month(),f=l.day();var o=this.isIntercalaryMonth(p,s),d=this.toChineseMonth(p,s),u=function(a,y,h,_,b){var w,T,L;if("object"==typeof a)T=a,w=y||{};else{var M;if(!("number"==typeof a&&a>=1888&&a<=2111))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof y&&y>=1&&y<=12))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof h&&h>=1&&h<=30))throw new Error("Lunar day outside range 1 - 30");"object"==typeof _?(M=!1,w=_):(M=!!_,w={}),T={year:a,month:y,day:h,isIntercalary:M}}L=T.day-1;var P,z=n[T.year-n[0]],S=z>>13;P=S&&(T.month>S||T.isIntercalary)?T.month:T.month-1;for(var C=0;C<P;C++)L+=z&1<<12-C?30:29;var R=m[T.year-m[0]],D=new Date(R>>9&4095,(R>>5&15)-1,(31&R)+L);return w.year=D.getFullYear(),w.month=1+D.getMonth(),w.day=D.getDate(),w}(p,d,f,o);return k.toJD(u.year,u.month,u.day)},fromJD:function(p){var s=k.fromJD(p),f=function(o,d,u,a){var y,h;if("object"==typeof o)y=o,h=d||{};else{if(!("number"==typeof o&&o>=1888&&o<=2111))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof d&&d>=1&&d<=12))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof u&&u>=1&&u<=31))throw new Error("Solar day outside range 1 - 31");y={year:o,month:d,day:u},h={}}var _=m[y.year-m[0]];h.year=(y.year<<9|y.month<<5|y.day)>=_?y.year:y.year-1,_=m[h.year-m[0]];var w,T=new Date(_>>9&4095,(_>>5&15)-1,31&_),L=new Date(y.year,y.month-1,y.day);w=Math.round((L-T)/864e5);var M,P=n[h.year-n[0]];for(M=0;M<13;M++){var z=P&1<<12-M?30:29;if(w<z)break;w-=z}var S=P>>13;return!S||M<S?(h.isIntercalary=!1,h.month=1+M):M===S?(h.isIntercalary=!0,h.month=M):(h.isIntercalary=!1,h.month=M),h.day=1+w,h}(s.year(),s.month(),s.day()),l=this.toMonthIndex(f.year,f.month,f.isIntercalary);return this.newDate(f.year,l,f.day)},fromString:function(p){var s=p.match(e),f=this._validateYear(+s[1]),d=this.toMonthIndex(f,+s[2],!!s[3]);return this.newDate(f,d,+s[4])},add:function(p,s,f){var l=p.year(),o=p.month(),d=this.isIntercalaryMonth(l,o),u=this.toChineseMonth(l,o),a=Object.getPrototypeOf(x.prototype).add.call(this,p,s,f);if("y"===f){var y=a.year(),h=a.month(),_=this.isIntercalaryMonth(y,u),b=this.toMonthIndex(y,u,!(!d||!_));b!==h&&a.month(b)}return a}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,r=/^\d?\d[iI]?/m,i=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,c=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;g.calendars.chinese=x;var n=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],m=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":347,"object-assign":247}],334:[function(v,Q,$){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()+(e.year()<0?1:0))%4==3||x%4==-1},monthsInYear:function(x){return this._validate(x,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),13},weekOfYear:function(x,e,r){var i=this.newDate(x,e,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(13===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return(this.dayOfWeek(x,e,r)||7)<6},toJD:function(x,e,r){var i=this._validate(x,e,r,g.local.invalidDate);return(x=i.year())<0&&x++,i.day()+30*(i.month()-1)+365*(x-1)+Math.floor(x/4)+this.jdEpoch-1},fromJD:function(x){var e=Math.floor(x)+.5-this.jdEpoch,r=Math.floor((e-Math.floor((e+366)/1461))/365)+1;r<=0&&r--,e=Math.floor(x)+.5-this.newDate(r,1,1).toJD();var i=Math.floor(e/30)+1;return this.newDate(r,i,e-30*(i-1)+1)}}),g.calendars.coptic=k},{"../main":347,"object-assign":247}],335:[function(v,Q,$){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),400},weekOfYear:function(e,r,i){var c=this.newDate(e,r,i);return c.add(-c.dayOfWeek(),"d"),Math.floor((c.dayOfYear()-1)/8)+1},daysInMonth:function(e,r){var i=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[i.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,r,i){return(this._validate(e,r,i,g.local.invalidDate).day()+1)%8},weekDay:function(e,r,i){var c=this.dayOfWeek(e,r,i);return c>=2&&c<=6},extraInfo:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);return{century:x[Math.floor((c.year()-1)/100)+1]||""}},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);return e=c.year()+(c.year()<0?1:0),r=c.month(),(i=c.day())+(r>1?16:0)+(r>2?32*(r-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var r=Math.floor(e/400)+1;e-=400*(r-1),e+=e>15?16:0;var i=Math.floor(e/32)+1;return this.newDate(r<=0?r-1:r,i,e-32*(i-1)+1)}});var x={20:"Fruitbat",21:"Anchovy"};g.calendars.discworld=k},{"../main":347,"object-assign":247}],336:[function(v,Q,$){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()+(e.year()<0?1:0))%4==3||x%4==-1},monthsInYear:function(x){return this._validate(x,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),13},weekOfYear:function(x,e,r){var i=this.newDate(x,e,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(13===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return(this.dayOfWeek(x,e,r)||7)<6},toJD:function(x,e,r){var i=this._validate(x,e,r,g.local.invalidDate);return(x=i.year())<0&&x++,i.day()+30*(i.month()-1)+365*(x-1)+Math.floor(x/4)+this.jdEpoch-1},fromJD:function(x){var e=Math.floor(x)+.5-this.jdEpoch,r=Math.floor((e-Math.floor((e+366)/1461))/365)+1;r<=0&&r--,e=Math.floor(x)+.5-this.newDate(r,1,1).toJD();var i=Math.floor(e/30)+1;return this.newDate(r,i,e-30*(i-1)+1)}}),g.calendars.ethiopian=k},{"../main":347,"object-assign":247}],337:[function(v,Q,$){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function x(e,r){return e-r*Math.floor(e/r)}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return this._leapYear(r.year())},_leapYear:function(e){return x(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,r,i){var c=this.newDate(e,r,i);return c.add(-c.dayOfWeek(),"d"),Math.floor((c.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear).year(),this.toJD(-1===e?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,r){return e.year&&(r=e.month(),e=e.year()),this._validate(e,r,this.minDay,g.local.invalidMonth),12===r&&this.leapYear(e)||8===r&&5===x(this.daysInYear(e),10)?30:9===r&&3===x(this.daysInYear(e),10)?29:this.daysPerMonth[r-1]},weekDay:function(e,r,i){return 6!==this.dayOfWeek(e,r,i)},extraInfo:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);return{yearType:(this.leapYear(c)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(c)%10-3]}},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);e=c.year(),r=c.month(),i=c.day();var n=e<=0?e+1:e,m=this.jdEpoch+this._delay1(n)+this._delay2(n)+i+1;if(r<7){for(var p=7;p<=this.monthsInYear(e);p++)m+=this.daysInMonth(e,p);for(p=1;p<r;p++)m+=this.daysInMonth(e,p)}else for(p=7;p<r;p++)m+=this.daysInMonth(e,p);return m},_delay1:function(e){var r=Math.floor((235*e-234)/19),c=29*r+Math.floor((12084+13753*r)/25920);return x(3*(c+1),7)<3&&c++,c},_delay2:function(e){var r=this._delay1(e-1),i=this._delay1(e);return this._delay1(e+1)-i==356?2:i-r==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var r=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(-1===r?1:r+1,7,1);)r++;for(var i=e<this.toJD(r,1,1)?7:1;e>this.toJD(r,i,this.daysInMonth(r,i));)i++;var c=e-this.toJD(r,i,1)+1;return this.newDate(r,i,c)}}),g.calendars.hebrew=k},{"../main":347,"object-assign":247}],338:[function(v,Q,$){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(x){return(11*this._validate(x,this.minMonth,this.minDay,g.local.invalidYear).year()+14)%30<11},weekOfYear:function(x,e,r){var i=this.newDate(x,e,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInYear:function(x){return this.leapYear(x)?355:354},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(12===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return 5!==this.dayOfWeek(x,e,r)},toJD:function(x,e,r){var i=this._validate(x,e,r,g.local.invalidDate);return x=i.year(),e=i.month(),x=x<=0?x+1:x,(r=i.day())+Math.ceil(29.5*(e-1))+354*(x-1)+Math.floor((3+11*x)/30)+this.jdEpoch-1},fromJD:function(x){x=Math.floor(x)+.5;var e=Math.floor((30*(x-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var r=Math.min(12,Math.ceil((x-29-this.toJD(e,1,1))/29.5)+1),i=x-this.toJD(e,r,1)+1;return this.newDate(e,r,i)}}),g.calendars.islamic=k},{"../main":347,"object-assign":247}],339:[function(v,Q,$){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(x,e,r){var i=this.newDate(x,e,r);return i.add(4-(i.dayOfWeek()||7),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(2===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return(this.dayOfWeek(x,e,r)||7)<6},toJD:function(x,e,r){var i=this._validate(x,e,r,g.local.invalidDate);return x=i.year(),e=i.month(),r=i.day(),x<0&&x++,e<=2&&(x--,e+=12),Math.floor(365.25*(x+4716))+Math.floor(30.6001*(e+1))+r-1524.5},fromJD:function(x){var e=Math.floor(x+.5)+1524,r=Math.floor((e-122.1)/365.25),i=Math.floor(365.25*r),c=Math.floor((e-i)/30.6001),n=c-Math.floor(c<14?1:13),m=r-Math.floor(n>2?4716:4715),p=e-i-Math.floor(30.6001*c);return m<=0&&m--,this.newDate(m,n,p)}}),g.calendars.julian=k},{"../main":347,"object-assign":247}],340:[function(v,Q,$){var g=v("../main");function k(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}function x(r,i){return r-i*Math.floor(r/i)}function e(r,i){return x(r-1,i)+1}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(r){return this._validate(r,this.minMonth,this.minDay,g.local.invalidYear),!1},formatYear:function(r){r=this._validate(r,this.minMonth,this.minDay,g.local.invalidYear).year();var i=Math.floor(r/400);return r%=400,r+=r<0?400:0,i+"."+Math.floor(r/20)+"."+r%20},forYear:function(r){if((r=r.split(".")).length<3)throw"Invalid Mayan year";for(var i=0,c=0;c<r.length;c++){var n=parseInt(r[c],10);if(Math.abs(n)>19||c>0&&n<0)throw"Invalid Mayan year";i=20*i+n}return i},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,g.local.invalidYear),18},weekOfYear:function(r,i,c){return this._validate(r,i,c,g.local.invalidDate),0},daysInYear:function(r){return this._validate(r,this.minMonth,this.minDay,g.local.invalidYear),360},daysInMonth:function(r,i){return this._validate(r,i,this.minDay,g.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(r,i,c){return this._validate(r,i,c,g.local.invalidDate).day()},weekDay:function(r,i,c){return this._validate(r,i,c,g.local.invalidDate),!0},extraInfo:function(r,i,c){var n=this._validate(r,i,c,g.local.invalidDate).toJD(),m=this._toHaab(n),p=this._toTzolkin(n);return{haabMonthName:this.local.haabMonths[m[0]-1],haabMonth:m[0],haabDay:m[1],tzolkinDayName:this.local.tzolkinMonths[p[0]-1],tzolkinDay:p[0],tzolkinTrecena:p[1]}},_toHaab:function(r){var i=x(8+(r-=this.jdEpoch)+340,365);return[Math.floor(i/20)+1,x(i,20)]},_toTzolkin:function(r){return[e(20+(r-=this.jdEpoch),20),e(r+4,13)]},toJD:function(r,i,c){var n=this._validate(r,i,c,g.local.invalidDate);return n.day()+20*n.month()+360*n.year()+this.jdEpoch},fromJD:function(r){r=Math.floor(r)+.5-this.jdEpoch;var i=Math.floor(r/360);r%=360,r+=r<0?360:0;var c=Math.floor(r/20);return this.newDate(i,c,r%20)}}),g.calendars.mayan=k},{"../main":347,"object-assign":247}],341:[function(v,Q,$){var g=v("../main"),t=v("object-assign");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}k.prototype=new g.baseCalendar;var x=g.instance("gregorian");t(k.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return x.leapYear(r.year()+(r.year()<1?1:0)+1469)},weekOfYear:function(e,r,i){var c=this.newDate(e,r,i);return c.add(1-(c.dayOfWeek()||7),"d"),Math.floor((c.dayOfYear()-1)/7)+1},daysInMonth:function(e,r){var i=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(12===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(e,r,i){return(this.dayOfWeek(e,r,i)||7)<6},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidMonth);(e=c.year())<0&&e++;for(var n=c.day(),m=1;m<c.month();m++)n+=this.daysPerMonth[m-1];return n+x.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var r=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(r+1,1,1);)r++;for(var i=e-Math.floor(this.toJD(r,1,1)+.5)+1,c=1;i>this.daysInMonth(r,c);)i-=this.daysInMonth(r,c),c++;return this.newDate(r,c,i)}}),g.calendars.nanakshahi=k},{"../main":347,"object-assign":247}],342:[function(v,Q,$){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(x){return this.daysInYear(x)!==this.daysPerYear},weekOfYear:function(x,e,r){var i=this.newDate(x,e,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInYear:function(x){if(x=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[x])return this.daysPerYear;for(var e=0,r=this.minMonth;r<=12;r++)e+=this.NEPALI_CALENDAR_DATA[x][r];return e},daysInMonth:function(x,e){return x.year&&(e=x.month(),x=x.year()),this._validate(x,e,this.minDay,g.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[x]?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[x][e]},weekDay:function(x,e,r){return 6!==this.dayOfWeek(x,e,r)},toJD:function(x,e,r){var i=this._validate(x,e,r,g.local.invalidDate);x=i.year(),e=i.month(),r=i.day();var c=g.instance(),n=0,m=e,p=x;this._createMissingCalendarData(x);var s=x-(m>9||9===m&&r>=this.NEPALI_CALENDAR_DATA[p][0]?56:57);for(9!==e&&(n=r,m--);9!==m;)m<=0&&(m=12,p--),n+=this.NEPALI_CALENDAR_DATA[p][m],m--;return 9===e?(n+=r-this.NEPALI_CALENDAR_DATA[p][0])<0&&(n+=c.daysInYear(s)):n+=this.NEPALI_CALENDAR_DATA[p][9]-this.NEPALI_CALENDAR_DATA[p][0],c.newDate(s,1,1).add(n,"d").toJD()},fromJD:function(x){var e=g.instance().fromJD(x),r=e.year(),i=e.dayOfYear(),c=r+56;this._createMissingCalendarData(c);for(var n=9,p=this.NEPALI_CALENDAR_DATA[c][n]-this.NEPALI_CALENDAR_DATA[c][0]+1;i>p;)++n>12&&(n=1,c++),p+=this.NEPALI_CALENDAR_DATA[c][n];return this.newDate(c,n,this.NEPALI_CALENDAR_DATA[c][n]-(p-i))},_createMissingCalendarData:function(x){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var r=x-1;r<x+2;r++)void 0===this.NEPALI_CALENDAR_DATA[r]&&(this.NEPALI_CALENDAR_DATA[r]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),g.calendars.nepali=k},{"../main":347,"object-assign":247}],343:[function(v,Q,$){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function x(e,r){return e-r*Math.floor(e/r)}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xe6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xe6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return 682*((r.year()-(r.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,r,i){var c=this.newDate(e,r,i);return c.add(-(c.dayOfWeek()+1)%7,"d"),Math.floor((c.dayOfYear()-1)/7)+1},daysInMonth:function(e,r){var i=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(12===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(e,r,i){return 5!==this.dayOfWeek(e,r,i)},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);e=c.year(),r=c.month(),i=c.day();var n=e-(e>=0?474:473),m=474+x(n,2820);return i+(r<=7?31*(r-1):30*(r-1)+6)+Math.floor((682*m-110)/2816)+365*(m-1)+1029983*Math.floor(n/2820)+this.jdEpoch-1},fromJD:function(e){var r=(e=Math.floor(e)+.5)-this.toJD(475,1,1),i=Math.floor(r/1029983),c=x(r,1029983),n=2820;if(1029982!==c){var m=Math.floor(c/366),p=x(c,366);n=Math.floor((2134*m+2816*p+2815)/1028522)+m+1}var s=n+2820*i+474,f=e-this.toJD(s=s<=0?s-1:s,1,1)+1,l=f<=186?Math.ceil(f/31):Math.ceil((f-6)/30),o=e-this.toJD(s,l,1)+1;return this.newDate(s,l,o)}}),g.calendars.persian=k,g.calendars.jalali=k},{"../main":347,"object-assign":247}],344:[function(v,Q,$){var g=v("../main"),t=v("object-assign"),k=g.instance();function x(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}t(x.prototype=new g.baseCalendar,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(r.year()),k.leapYear(e)},weekOfYear:function(e,r,i){var c=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(c.year()),k.weekOfYear(e,c.month(),c.day())},daysInMonth:function(e,r){var i=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(2===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(e,r,i){return(this.dayOfWeek(e,r,i)||7)<6},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);return e=this._t2gYear(c.year()),k.toJD(e,c.month(),c.day())},fromJD:function(e){var r=k.fromJD(e),i=this._g2tYear(r.year());return this.newDate(i,r.month(),r.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),g.calendars.taiwan=x},{"../main":347,"object-assign":247}],345:[function(v,Q,$){var g=v("../main"),t=v("object-assign"),k=g.instance();function x(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}t(x.prototype=new g.baseCalendar,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(r.year()),k.leapYear(e)},weekOfYear:function(e,r,i){var c=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(c.year()),k.weekOfYear(e,c.month(),c.day())},daysInMonth:function(e,r){var i=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(2===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(e,r,i){return(this.dayOfWeek(e,r,i)||7)<6},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate);return e=this._t2gYear(c.year()),k.toJD(e,c.month(),c.day())},fromJD:function(e){var r=k.fromJD(e),i=this._g2tYear(r.year());return this.newDate(i,r.month(),r.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),g.calendars.thai=x},{"../main":347,"object-assign":247}],346:[function(v,Q,$){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return 355===this.daysInYear(r.year())},weekOfYear:function(e,r,i){var c=this.newDate(e,r,i);return c.add(-c.dayOfWeek(),"d"),Math.floor((c.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var r=0,i=1;i<=12;i++)r+=this.daysInMonth(e,i);return r},daysInMonth:function(e,r){for(var i=this._validate(e,r,this.minDay,g.local.invalidMonth).toJD()-24e5+.5,c=0,n=0;n<x.length;n++){if(x[n]>i)return x[c]-x[c-1];c++}return 30},weekDay:function(e,r,i){return 5!==this.dayOfWeek(e,r,i)},toJD:function(e,r,i){var c=this._validate(e,r,i,g.local.invalidDate),n=12*(c.year()-1)+c.month()-15292;return c.day()+x[n-1]-1+24e5-.5},fromJD:function(e){for(var r=e-24e5+.5,i=0,c=0;c<x.length&&!(x[c]>r);c++)i++;var n=i+15292,m=Math.floor((n-1)/12);return this.newDate(m+1,n-12*m,r-x[i-1]+1)},isValid:function(e,r,i){var c=g.baseCalendar.prototype.isValid.apply(this,arguments);return c&&(c=(e=null!=e.year?e.year:e)>=1276&&e<=1500),c},_validate:function(e,r,i,c){var n=g.baseCalendar.prototype._validate.apply(this,arguments);if(n.year<1276||n.year>1500)throw c.replace(/\{0\}/,this.local.name);return n}}),g.calendars.ummalqura=k;var x=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(v,Q,$){var g=v("object-assign");function t(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function k(c,n,m,p){if(this._calendar=c,this._year=n,this._month=m,this._day=p,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(i.local.invalidDate||i.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function x(c,n){return"000000".substring(0,n-(c=""+c).length)+c}function e(){this.shortYearCutoff="+10"}function r(c){this.local=this.regionalOptions[c]||this.regionalOptions[""]}g(t.prototype,{instance:function(c,n){c=(c||"gregorian").toLowerCase();var m=this._localCals[c+"-"+(n=n||"")];if(!m&&this.calendars[c]&&(m=new this.calendars[c](n),this._localCals[c+"-"+n]=m),!m)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,c);return m},newDate:function(c,n,m,p,s){return(p=(null!=c&&c.year?c.calendar():"string"==typeof p?this.instance(p,s):p)||this.instance()).newDate(c,n,m)},substituteDigits:function(c){return function(n){return(n+"").replace(/[0-9]/g,function(m){return c[m]})}},substituteChineseDigits:function(c,n){return function(m){for(var p="",s=0;m>0;){var f=m%10;p=(0===f?"":c[f]+n[s])+p,s++,m=Math.floor(m/10)}return 0===p.indexOf(c[1]+n[1])&&(p=p.substr(1)),p||c[0]}}}),g(k.prototype,{newDate:function(c,n,m){return this._calendar.newDate(null==c?this:c,n,m)},year:function(c){return 0===arguments.length?this._year:this.set(c,"y")},month:function(c){return 0===arguments.length?this._month:this.set(c,"m")},day:function(c){return 0===arguments.length?this._day:this.set(c,"d")},date:function(c,n,m){if(!this._calendar.isValid(c,n,m))throw(i.local.invalidDate||i.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=c,this._month=n,this._day=m,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(c,n){return this._calendar.add(this,c,n)},set:function(c,n){return this._calendar.set(this,c,n)},compareTo:function(c){if(this._calendar.name!==c._calendar.name)throw(i.local.differentCalendars||i.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,c._calendar.local.name);var n=this._year!==c._year?this._year-c._year:this._month!==c._month?this.monthOfYear()-c.monthOfYear():this._day-c._day;return 0===n?0:n<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(c){return this._calendar.fromJD(c)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(c){return this._calendar.fromJSDate(c)},toString:function(){return(this.year()<0?"-":"")+x(Math.abs(this.year()),4)+"-"+x(this.month(),2)+"-"+x(this.day(),2)}}),g(e.prototype,{_validateLevel:0,newDate:function(c,n,m){return null==c?this.today():(c.year&&(this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate),m=c.day(),n=c.month(),c=c.year()),new k(this,c,n,m))},today:function(){return this.fromJSDate(new Date)},epoch:function(c){return this._validate(c,this.minMonth,this.minDay,i.local.invalidYear||i.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(c){var n=this._validate(c,this.minMonth,this.minDay,i.local.invalidYear||i.regionalOptions[""].invalidYear);return(n.year()<0?"-":"")+x(Math.abs(n.year()),4)},monthsInYear:function(c){return this._validate(c,this.minMonth,this.minDay,i.local.invalidYear||i.regionalOptions[""].invalidYear),12},monthOfYear:function(c,n){var m=this._validate(c,n,this.minDay,i.local.invalidMonth||i.regionalOptions[""].invalidMonth);return(m.month()+this.monthsInYear(m)-this.firstMonth)%this.monthsInYear(m)+this.minMonth},fromMonthOfYear:function(c,n){var m=(n+this.firstMonth-2*this.minMonth)%this.monthsInYear(c)+this.minMonth;return this._validate(c,m,this.minDay,i.local.invalidMonth||i.regionalOptions[""].invalidMonth),m},daysInYear:function(c){var n=this._validate(c,this.minMonth,this.minDay,i.local.invalidYear||i.regionalOptions[""].invalidYear);return this.leapYear(n)?366:365},dayOfYear:function(c,n,m){var p=this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate);return p.toJD()-this.newDate(p.year(),this.fromMonthOfYear(p.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(c,n,m){var p=this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(p))+2)%this.daysInWeek()},extraInfo:function(c,n,m){return this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate),{}},add:function(c,n,m){return this._validate(c,this.minMonth,this.minDay,i.local.invalidDate||i.regionalOptions[""].invalidDate),this._correctAdd(c,this._add(c,n,m),n,m)},_add:function(c,n,m){if(this._validateLevel++,"d"===m||"w"===m){var p=c.toJD()+n*("w"===m?this.daysInWeek():1),s=c.calendar().fromJD(p);return this._validateLevel--,[s.year(),s.month(),s.day()]}try{var f=c.year()+("y"===m?n:0),l=c.monthOfYear()+("m"===m?n:0);s=c.day(),"y"===m?(c.month()!==this.fromMonthOfYear(f,l)&&(l=this.newDate(f,c.month(),this.minDay).monthOfYear()),l=Math.min(l,this.monthsInYear(f)),s=Math.min(s,this.daysInMonth(f,this.fromMonthOfYear(f,l)))):"m"===m&&(function(d){for(;l<d.minMonth;)f--,l+=d.monthsInYear(f);for(var u=d.monthsInYear(f);l>u-1+d.minMonth;)f++,l-=u,u=d.monthsInYear(f)}(this),s=Math.min(s,this.daysInMonth(f,this.fromMonthOfYear(f,l))));var o=[f,this.fromMonthOfYear(f,l),s];return this._validateLevel--,o}catch(d){throw this._validateLevel--,d}},_correctAdd:function(c,n,m,p){if(!(this.hasYearZero||"y"!==p&&"m"!==p||0!==n[0]&&c.year()>0==n[0]>0)){var s={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[p];n=this._add(c,m*s[0]+(m<0?-1:1)*s[1],s[2])}return c.date(n[0],n[1],n[2])},set:function(c,n,m){this._validate(c,this.minMonth,this.minDay,i.local.invalidDate||i.regionalOptions[""].invalidDate);var p="y"===m?n:c.year(),s="m"===m?n:c.month(),f="d"===m?n:c.day();return"y"!==m&&"m"!==m||(f=Math.min(f,this.daysInMonth(p,s))),c.date(p,s,f)},isValid:function(c,n,m){this._validateLevel++;var p=this.hasYearZero||0!==c;if(p){var s=this.newDate(c,n,this.minDay);p=n>=this.minMonth&&n-this.minMonth<this.monthsInYear(s)&&m>=this.minDay&&m-this.minDay<this.daysInMonth(s)}return this._validateLevel--,p},toJSDate:function(c,n,m){var p=this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate);return i.instance().fromJD(this.toJD(p)).toJSDate()},fromJSDate:function(c){return this.fromJD(i.instance().fromJSDate(c).toJD())},_validate:function(c,n,m,p){if(c.year){if(0===this._validateLevel&&this.name!==c.calendar().name)throw(i.local.differentCalendars||i.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,c.calendar().local.name);return c}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(c,n,m))throw p.replace(/\{0\}/,this.local.name);var s=this.newDate(c,n,m);return this._validateLevel--,s}catch(f){throw this._validateLevel--,f}}}),g(r.prototype=new e,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(c){var n=this._validate(c,this.minMonth,this.minDay,i.local.invalidYear||i.regionalOptions[""].invalidYear);return(c=n.year()+(n.year()<0?1:0))%4==0&&(c%100!=0||c%400==0)},weekOfYear:function(c,n,m){var p=this.newDate(c,n,m);return p.add(4-(p.dayOfWeek()||7),"d"),Math.floor((p.dayOfYear()-1)/7)+1},daysInMonth:function(c,n){var m=this._validate(c,n,this.minDay,i.local.invalidMonth||i.regionalOptions[""].invalidMonth);return this.daysPerMonth[m.month()-1]+(2===m.month()&&this.leapYear(m.year())?1:0)},weekDay:function(c,n,m){return(this.dayOfWeek(c,n,m)||7)<6},toJD:function(c,n,m){var p=this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate);c=p.year(),n=p.month(),m=p.day(),c<0&&c++,n<3&&(n+=12,c--);var s=Math.floor(c/100),f=2-s+Math.floor(s/4);return Math.floor(365.25*(c+4716))+Math.floor(30.6001*(n+1))+m+f-1524.5},fromJD:function(c){var n=Math.floor(c+.5),m=Math.floor((n-1867216.25)/36524.25),p=1524+(m=n+1+m-Math.floor(m/4)),s=Math.floor((p-122.1)/365.25),f=Math.floor(365.25*s),l=Math.floor((p-f)/30.6001),o=p-f-Math.floor(30.6001*l),d=l-(l>13.5?13:1),u=s-(d>2.5?4716:4715);return u<=0&&u--,this.newDate(u,d,o)},toJSDate:function(c,n,m){var p=this._validate(c,n,m,i.local.invalidDate||i.regionalOptions[""].invalidDate),s=new Date(p.year(),p.month()-1,p.day());return s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0),s.setHours(s.getHours()>12?s.getHours()+2:0),s},fromJSDate:function(c){return this.newDate(c.getFullYear(),c.getMonth()+1,c.getDate())}});var i=Q.exports=new t;i.cdate=k,i.baseCalendar=e,i.calendars.gregorian=r},{"object-assign":247}],348:[function(v,Q,$){var g=v("object-assign"),t=v("./main");g(t.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),t.local=t.regionalOptions[""],g(t.cdate.prototype,{formatDate:function(k,x){return"string"!=typeof k&&(x=k,k=""),this._calendar.formatDate(k||"",this,x)}}),g(t.baseCalendar.prototype,{UNIX_EPOCH:t.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:t.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(k,x,e){if("string"!=typeof k&&(e=x,x=k,k=""),!x)return"";if(x.calendar()!==this)throw t.local.invalidFormat||t.regionalOptions[""].invalidFormat;k=k||this.local.dateFormat;for(var i,c,n,m=(e=e||{}).dayNamesShort||this.local.dayNamesShort,p=e.dayNames||this.local.dayNames,s=e.monthNumbers||this.local.monthNumbers,f=e.monthNamesShort||this.local.monthNamesShort,l=e.monthNames||this.local.monthNames,o=function(L,M){for(var P=1;T+P<k.length&&k.charAt(T+P)===L;)P++;return T+=P-1,Math.floor(P/(M||1))>1},d=function(L,M,P,z){var S=""+M;if(o(L,z))for(;S.length<P;)S="0"+S;return S},u=this,y=function(L,M){return M?"function"==typeof l?l.call(u,L):l[L.month()-u.minMonth]:"function"==typeof f?f.call(u,L):f[L.month()-u.minMonth]},h=this.local.digits,_=function(L){return e.localNumbers&&h?h(L):L},b="",w=!1,T=0;T<k.length;T++)if(w)"'"!==k.charAt(T)||o("'")?b+=k.charAt(T):w=!1;else switch(k.charAt(T)){case"d":b+=_(d("d",x.day(),2));break;case"D":b+=("D",i=x.dayOfWeek(),c=m,n=p,o("D")?n[i]:c[i]);break;case"o":b+=d("o",x.dayOfYear(),3);break;case"w":b+=d("w",x.weekOfYear(),2);break;case"m":b+=(L=x,"function"==typeof s?s.call(u,L,o("m")):_(d("m",L.month(),2)));break;case"M":b+=y(x,o("M"));break;case"y":b+=o("y",2)?x.year():(x.year()%100<10?"0":"")+x.year()%100;break;case"Y":o("Y",2),b+=x.formatYear();break;case"J":b+=x.toJD();break;case"@":b+=(x.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":b+=(x.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":o("'")?b+="'":w=!0;break;default:b+=k.charAt(T)}var L;return b},parseDate:function(k,x,e){if(null==x)throw t.local.invalidArguments||t.regionalOptions[""].invalidArguments;if(""===(x="object"==typeof x?x.toString():x+""))return null;k=k||this.local.dateFormat;var r=(e=e||{}).shortYearCutoff||this.shortYearCutoff;r="string"!=typeof r?r:this.today().year()%100+parseInt(r,10);for(var i=e.dayNamesShort||this.local.dayNamesShort,c=e.dayNames||this.local.dayNames,n=e.parseMonth||this.local.parseMonth,m=e.monthNumbers||this.local.monthNumbers,p=e.monthNamesShort||this.local.monthNamesShort,s=e.monthNames||this.local.monthNames,f=-1,l=-1,o=-1,d=-1,u=-1,a=!1,y=!1,h=function(R,D){for(var j=1;z+j<k.length&&k.charAt(z+j)===R;)j++;return z+=j-1,Math.floor(j/(D||1))>1},_=function(R,D){var j=h(R,D),q=[2,3,j?4:2,j?4:2,10,11,20]["oyYJ@!".indexOf(R)+1],Z=new RegExp("^-?\\d{1,"+q+"}"),W=x.substring(P).match(Z);if(!W)throw(t.local.missingNumberAt||t.regionalOptions[""].missingNumberAt).replace(/\{0\}/,P);return P+=W[0].length,parseInt(W[0],10)},b=this,w=function(){if("function"==typeof m){h("m");var R=m.call(b,x.substring(P));return P+=R.length,R}return _("m")},T=function(R,D,j,q){for(var Z=h(R,q)?j:D,W=0;W<Z.length;W++)if(x.substr(P,Z[W].length).toLowerCase()===Z[W].toLowerCase())return P+=Z[W].length,W+b.minMonth;throw(t.local.unknownNameAt||t.regionalOptions[""].unknownNameAt).replace(/\{0\}/,P)},L=function(){if("function"==typeof s){var R=h("M")?s.call(b,x.substring(P)):p.call(b,x.substring(P));return P+=R.length,R}return T("M",p,s)},M=function(){if(x.charAt(P)!==k.charAt(z))throw(t.local.unexpectedLiteralAt||t.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,P);P++},P=0,z=0;z<k.length;z++)if(y)"'"!==k.charAt(z)||h("'")?M():y=!1;else switch(k.charAt(z)){case"d":d=_("d");break;case"D":T("D",i,c);break;case"o":u=_("o");break;case"w":_("w");break;case"m":o=w();break;case"M":o=L();break;case"y":var S=z;a=!h("y",2),z=S,l=_("y",2);break;case"Y":l=_("Y",2);break;case"J":f=_("J")+.5,"."===x.charAt(P)&&(P++,_("J"));break;case"@":f=_("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":f=_("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":P=x.length;break;case"'":h("'")?M():y=!0;break;default:M()}if(P<x.length)throw t.local.unexpectedText||t.regionalOptions[""].unexpectedText;if(-1===l?l=this.today().year():l<100&&a&&(l+=-1===r?1900:this.today().year()-this.today().year()%100-(l<=r?0:100)),"string"==typeof o&&(o=n.call(this,l,o)),u>-1){d=u;for(var C=this.daysInMonth(l,o=1);d>C;C=this.daysInMonth(l,o))o++,d-=C}return f>-1?this.fromJD(f):this.newDate(l,o,d)},determineDate:function(k,x,e,r,i){e&&"object"!=typeof e&&(i=r,r=e,e=null),"string"!=typeof r&&(i=r,r="");var c=this;return x=x?x.newDate():null,null==k?x:"string"==typeof k?function(n){try{return c.parseDate(r,n,i)}catch(f){}for(var m=((n=n.toLowerCase()).match(/^c/)&&e?e.newDate():null)||c.today(),p=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,s=p.exec(n);s;)m.add(parseInt(s[1],10),s[2]||"d"),s=p.exec(n);return m}(k):"number"==typeof k?isNaN(k)||k===1/0||k===-1/0?x:c.today().add(k,"d"):c.newDate(k)}})},{"./main":347,"object-assign":247}],349:[function(v,Q,$){"use strict";Q.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(v,Q,$){"use strict";var g=v("./arrow_paths"),t=v("../../plots/font_attributes"),k=v("../../plots/cartesian/constants"),x=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),Q.exports=x("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:t({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:g.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:g.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",k.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",k.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",k.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",k.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:t({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("./draw").draw;function x(r){g.filterVisible(r._fullLayout.annotations).forEach(function(c){var n=t.getFromId(r,c.xref),m=t.getFromId(r,c.yref),p=t.getRefType(c.xref),s=t.getRefType(c.yref);c._extremes={},"range"===p&&e(c,n),"range"===s&&e(c,m)})}function e(r,i){var c,n=i._id,m=n.charAt(0),p=r[m],s=r["a"+m],o=r["_"+m+"padplus"],d=r["_"+m+"padminus"],u={x:1,y:-1}[m]*r[m+"shift"],a=3*r.arrowsize*r.arrowwidth||0,y=a+u,h=a-u,_=3*r.startarrowsize*r.arrowwidth||0,b=_+u,w=_-u;if(r["a"+m+"ref"]===r[m+"ref"]){var T=t.findExtremes(i,[i.r2c(p)],{ppadplus:y,ppadminus:h}),L=t.findExtremes(i,[i.r2c(s)],{ppadplus:Math.max(o,b),ppadminus:Math.max(d,w)});c={min:[T.min[0],L.min[0]],max:[T.max[0],L.max[0]]}}else b=s?b+s:b,w=s?w-s:w,c=t.findExtremes(i,[i.r2c(p)],{ppadplus:Math.max(o,y,b),ppadminus:Math.max(d,h,w)});r._extremes[n]=c}Q.exports=function(r){if(g.filterVisible(r._fullLayout.annotations).length&&r._fullData.length)return g.syncOrAsync([k,x],r)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry"),k=v("../../plot_api/plot_template").arrayEditor;function x(r,i){var c,n,m,p,s,f,l,o=r._fullLayout.annotations,d=[],u=[],a=[],y=(i||[]).length;for(c=0;c<o.length;c++)if(p=(m=o[c]).clicktoshow){for(n=0;n<y;n++)if(f=(s=i[n]).xaxis,l=s.yaxis,f._id===m.xref&&l._id===m.yref&&f.d2r(s.x)===e(m._xclick,f)&&l.d2r(s.y)===e(m._yclick,l)){(m.visible?"onout"===p?u:a:d).push(c);break}n===y&&m.visible&&"onout"===p&&u.push(c)}return{on:d,off:u,explicitOff:a}}function e(r,i){return"log"===i.type?i.l2r(r):i.d2r(r)}Q.exports={hasClickToShow:function(r,i){var c=x(r,i);return c.on.length>0||c.explicitOff.length>0},onClick:function(r,i){var c,n,m=x(r,i),p=m.on,s=m.off.concat(m.explicitOff),f={},l=r._fullLayout.annotations;if(p.length||s.length){for(c=0;c<p.length;c++)(n=k(r.layout,"annotations",l[p[c]])).modifyItem("visible",!0),g.extendFlat(f,n.getUpdateObj());for(c=0;c<s.length;c++)(n=k(r.layout,"annotations",l[s[c]])).modifyItem("visible",!1),g.extendFlat(f,n.getUpdateObj());return t.call("update",r,{},f)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../color");Q.exports=function(k,x,e,r){r("opacity");var i=r("bgcolor"),c=r("bordercolor"),n=t.opacity(c);r("borderpad");var m=r("borderwidth"),p=r("showarrow");if(r("text",p?" ":e._dfltTitle.annotation),r("textangle"),g.coerceFont(r,"font",e.font),r("width"),r("align"),r("height")&&r("valign"),p){var s,f,l=r("arrowside");-1!==l.indexOf("end")&&(s=r("arrowhead"),f=r("arrowsize")),-1!==l.indexOf("start")&&(r("startarrowhead",s),r("startarrowsize",f)),r("arrowcolor",n?x.bordercolor:t.defaultLine),r("arrowwidth",2*(n&&m||1)),r("standoff"),r("startstandoff")}var o=r("hovertext"),d=e.hoverlabel||{};if(o){var u=r("hoverlabel.bgcolor",d.bgcolor||(t.opacity(i)?t.rgb(i):t.defaultLine)),a=r("hoverlabel.bordercolor",d.bordercolor||t.contrast(u));g.coerceFont(r,"hoverlabel.font",{family:d.font.family,size:d.font.size,color:d.font.color||a})}r("captureevents",!!o)}},{"../../lib":515,"../color":367}],354:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib/to_log_range");Q.exports=function(k,x,e,r){x=x||{};var i="log"===e&&"linear"===x.type;if(i||"linear"===e&&"log"===x.type)for(var n,m,p=k._fullLayout.annotations,s=x._id.charAt(0),f=0;f<p.length;f++)m="annotations["+f+"].",(n=p[f])[s+"ref"]===x._id&&l(s),n["a"+s+"ref"]===x._id&&l("a"+s);function l(o){var d=n[o],u=null;u=i?t(d,x.range):Math.pow(10,d),g(u)||(u=null),r(m+o,u)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./common_defaults"),e=v("./attributes");function r(i,c,n){function m(L,M){return g.coerce(i,c,e,L,M)}var p=m("visible"),s=m("clicktoshow");if(p||s){x(i,c,n,m);for(var f=c.showarrow,l=["x","y"],o=[-10,-30],d={_fullLayout:n},u=0;u<2;u++){var a=l[u],y=t.coerceRef(i,c,d,a,"","paper");if("paper"!==y&&t.getFromId(d,y)._annIndices.push(c._index),t.coercePosition(c,d,m,y,a,.5),f){var h="a"+a,_=t.coerceRef(i,c,d,h,"pixel",["pixel","paper"]);"pixel"!==_&&_!==y&&(_=c[h]="pixel"),t.coercePosition(c,d,m,_,h,"pixel"===_?o[u]:.4)}m(a+"anchor"),m(a+"shift")}if(g.noneOrAll(i,c,["x","y"]),f&&g.noneOrAll(i,c,["ax","ay"]),s){var w=m("xclick"),T=m("yclick");c._xclick=void 0===w?c.x:t.cleanPosition(w,d,c.xref),c._yclick=void 0===T?c.y:t.cleanPosition(T,d,c.yref)}}}Q.exports=function(i,c){k(i,c,{name:"annotations",handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../plots/plots"),x=v("../../lib"),e=x.strTranslate,r=v("../../plots/cartesian/axes"),i=v("../color"),c=v("../drawing"),n=v("../fx"),m=v("../../lib/svg_text_utils"),p=v("../../lib/setcursor"),s=v("../dragelement"),f=v("../../plot_api/plot_template").arrayEditor,l=v("./draw_arrow_head");function o(a,y){var h=a._fullLayout.annotations[y]||{},_=r.getFromId(a,h.xref),b=r.getFromId(a,h.yref);_&&_.setScale(),b&&b.setScale(),u(a,h,y,!1,_,b)}function d(a,y,h,_,b){var w=b[h],T=b[h+"ref"],L=-1!==h.indexOf("y"),M="domain"===r.getRefType(T),P=L?_.h:_.w;return a?M?w+(L?-y:y)/a._length:a.p2r(a.r2p(w)+y):w+(L?-y:y)/P}function u(a,y,h,_,b,w){var T,L,M=a._fullLayout,P=a._fullLayout._size,z=a._context.edits;_?(T="annotation-"+_,L=_+".annotations"):(T="annotation",L="annotations");var S=f(a.layout,L,y),C=S.modifyBase,R=S.modifyItem,D=S.getUpdateObj;M._infolayer.selectAll("."+T+'[data-index="'+h+'"]').remove();var j="clip"+M._uid+"_ann"+h;if(y._input&&!1!==y.visible){var q={x:{},y:{}},Z=+y.textangle||0,W=M._infolayer.append("g").classed(T,!0).attr("data-index",String(h)).style("opacity",y.opacity),G=W.append("g").classed("annotation-text-g",!0),X=z[y.showarrow?"annotationTail":"annotationPosition"],ne=y.captureevents||z.annotationText||X,V=G.append("g").style("pointer-events",ne?"all":null).call(p,"pointer").on("click",function(){a._dragging=!1,a.emit("plotly_clickannotation",oe(g.event))});y.hovertext&&V.on("mouseover",function(){var xe=y.hoverlabel,Se=xe.font,pe=this.getBoundingClientRect(),ge=a.getBoundingClientRect();n.loneHover({x0:pe.left-ge.left,x1:pe.right-ge.left,y:(pe.top+pe.bottom)/2-ge.top,text:y.hovertext,color:xe.bgcolor,borderColor:xe.bordercolor,fontFamily:Se.family,fontSize:Se.size,fontColor:Se.color},{container:M._hoverlayer.node(),outerContainer:M._paper.node(),gd:a})}).on("mouseout",function(){n.loneUnhover(M._hoverlayer.node())});var N=y.borderwidth,ee=N+y.borderpad,B=V.append("rect").attr("class","bg").style("stroke-width",N+"px").call(i.stroke,y.bordercolor).call(i.fill,y.bgcolor),K=y.width||y.height,J=M._topclips.selectAll("#"+j).data(K?[0]:[]);J.enter().append("clipPath").classed("annclip",!0).attr("id",j).append("rect"),J.exit().remove();var te=y.font,ae=M._meta?x.templateString(y.text,M._meta):y.text,ce=V.append("text").classed("annotation-text",!0).text(ae);z.annotationText?ce.call(m.makeEditable,{delegate:V,gd:a}).call(ve).on("edit",function(xe){y.text=xe,this.call(ve),R("text",xe),b&&b.autorange&&C(b._name+".autorange",!0),w&&w.autorange&&C(w._name+".autorange",!0),t.call("_guiRelayout",a,D())}):ce.call(ve)}else g.selectAll("#"+j).remove();function oe(xe){var Se={index:h,annotation:y._input,fullAnnotation:y,event:xe};return _&&(Se.subplotId=_),Se}function ve(xe){return xe.call(c.font,te).attr({"text-anchor":{left:"start",right:"end"}[y.align]||"middle"}),m.convertToTspans(xe,a,fe),xe}function fe(){var xe=ce.selectAll("a");1===xe.size()&&xe.text()===ce.text()&&V.insert("a",":first-child").attr({"xlink:xlink:href":xe.attr("xlink:href"),"xlink:xlink:show":xe.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(B.node());var Se=V.select(".annotation-text-math-group"),pe=!Se.empty(),ge=c.bBox((pe?Se:ce).node()),Te=ge.width,se=ge.height,de=y.width||Te,Ae=y.height||se,Le=Math.round(de+2*ee),Me=Math.round(Ae+2*ee);function De(ot,pt){return"auto"===pt&&(pt=ot<1/3?"left":ot>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[pt]}for(var Oe=!1,Ie=["x","y"],Qe=0;Qe<Ie.length;Qe++){var Ne,Pe,Re,Ge,tt,ct=Ie[Qe],wt=y[ct+"ref"]||ct,kt=y["a"+ct+"ref"],gt={x:b,y:w}[ct],at=(Z+("x"===ct?0:-90))*Math.PI/180,et=Le*Math.cos(at),yt=Me*Math.sin(at),Vt=Math.abs(et)+Math.abs(yt),Gt=y[ct+"anchor"],en=y[ct+"shift"]*("x"===ct?1:-1),Jt=q[ct],cn=r.getRefType(wt);if(gt&&"domain"!==cn){var Rt=gt.r2fraction(y[ct]);(Rt<0||Rt>1)&&(kt===wt?((Rt=gt.r2fraction(y["a"+ct]))<0||Rt>1)&&(Oe=!0):Oe=!0),Ne=gt._offset+gt.r2p(y[ct]),Ge=.5}else{var je="domain"===cn;"x"===ct?(Re=y[ct],Ne=je?gt._offset+gt._length*Re:Ne=P.l+P.w*Re):(Re=1-y[ct],Ne=je?gt._offset+gt._length*Re:Ne=P.t+P.h*Re),Ge=y.showarrow?.5:Re}if(y.showarrow){Jt.head=Ne;var Ye=y["a"+ct];if(tt=et*De(.5,y.xanchor)-yt*De(.5,y.yanchor),kt===wt){var he=r.getRefType(kt);"domain"===he?("y"===ct&&(Ye=1-Ye),Jt.tail=gt._offset+gt._length*Ye):Jt.tail="paper"===he?"y"===ct?P.t+P.h*(Ye=1-Ye):P.l+P.w*Ye:gt._offset+gt.r2p(Ye),Pe=tt}else Jt.tail=Ne+Ye,Pe=tt+Ye;Jt.text=Jt.tail+tt;var be=M["x"===ct?"width":"height"];if("paper"===wt&&(Jt.head=x.constrain(Jt.head,1,be-1)),"pixel"===kt){var Fe=-Math.max(Jt.tail-3,Jt.text),He=Math.min(Jt.tail+3,Jt.text)-be;Fe>0?(Jt.tail+=Fe,Jt.text+=Fe):He>0&&(Jt.tail-=He,Jt.text-=He)}Jt.tail+=en,Jt.head+=en}else Pe=tt=Vt*De(Ge,Gt),Jt.text=Ne+tt;Jt.text+=en,tt+=en,y["_"+ct+"padplus"]=Vt/2+(Pe+=en),y["_"+ct+"padminus"]=Vt/2-Pe,y["_"+ct+"size"]=Vt,y["_"+ct+"shift"]=tt}if(Oe)V.remove();else{var Ke=0,Ze=0;"left"!==y.align&&(Ke=(de-Te)*("center"===y.align?.5:1)),"top"!==y.valign&&(Ze=(Ae-se)*("middle"===y.valign?.5:1)),pe?Se.select("svg").attr({x:ee+Ke-1,y:ee+Ze}).call(c.setClipUrl,K?j:null,a):ce.call(m.positionText,ee+Ke-ge.left,ee+Ze-ge.top).call(c.setClipUrl,K?j:null,a),J.select("rect").call(c.setRect,ee,ee,de,Ae),B.call(c.setRect,N/2,N/2,Le-N,Me-N),V.call(c.setTranslate,Math.round(q.x.text-Le/2),Math.round(q.y.text-Me/2)),G.attr({transform:"rotate("+Z+","+q.x.text+","+q.y.text+")"});var Lt,Ot=function(ot,pt){W.selectAll(".annotation-arrow-g").remove();var qt=q.x.head,St=q.y.head,Mt=q.x.tail+ot,Ce=q.y.tail+pt,Xe=q.x.text+ot,st=q.y.text+pt,dt=x.rotationXYMatrix(Z,Xe,st),zt=x.apply2DTransform(dt),Ht=x.apply2DTransform2(dt),Kt=+B.attr("width"),Zt=+B.attr("height"),vn=Xe-.5*Kt,zn=vn+Kt,gn=st-.5*Zt,nn=gn+Zt,an=[[vn,gn,vn,nn],[vn,nn,zn,nn],[zn,nn,zn,gn],[zn,gn,vn,gn]].map(Ht);if(!an.reduce(function(Sr,Cr){return Sr^!!x.segmentsIntersect(qt,St,qt+1e6,St+1e6,Cr[0],Cr[1],Cr[2],Cr[3])},!1)){an.forEach(function(Sr){var Cr=x.segmentsIntersect(Mt,Ce,qt,St,Sr[0],Sr[1],Sr[2],Sr[3]);Cr&&(Mt=Cr.x,Ce=Cr.y)});var on=y.arrowwidth,mn=y.arrowcolor,_n=y.arrowside,Pn=W.append("g").style({opacity:i.opacity(mn)}).classed("annotation-arrow-g",!0),Rn=Pn.append("path").attr("d","M"+Mt+","+Ce+"L"+qt+","+St).style("stroke-width",on+"px").call(i.stroke,i.rgb(mn));if(l(Rn,_n,y),z.annotationPosition&&Rn.node().parentNode&&!_){var qn=qt,Xn=St;if(y.standoff){var br=Math.sqrt(Math.pow(qt-Mt,2)+Math.pow(St-Ce,2));qn+=y.standoff*(Mt-qt)/br,Xn+=y.standoff*(Ce-St)/br}var fr,Vr,cr=Pn.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Mt-qn)+","+(Ce-Xn),transform:e(qn,Xn)}).style("stroke-width",on+6+"px").call(i.stroke,"rgba(0,0,0,0)").call(i.fill,"rgba(0,0,0,0)");s.init({element:cr.node(),gd:a,prepFn:function(){var Sr=c.getTranslate(V);fr=Sr.x,Vr=Sr.y,b&&b.autorange&&C(b._name+".autorange",!0),w&&w.autorange&&C(w._name+".autorange",!0)},moveFn:function(Sr,Cr){var pi=zt(fr,Vr),Yn=pi[0]+Sr,ar=pi[1]+Cr;V.call(c.setTranslate,Yn,ar),R("x",d(b,Sr,"x",P,y)),R("y",d(w,Cr,"y",P,y)),y.axref===y.xref&&R("ax",d(b,Sr,"ax",P,y)),y.ayref===y.yref&&R("ay",d(w,Cr,"ay",P,y)),Pn.attr("transform",e(Sr,Cr)),G.attr({transform:"rotate("+Z+","+Yn+","+ar+")"})},doneFn:function(){t.call("_guiRelayout",a,D());var Sr=document.querySelector(".js-notes-box-panel");Sr&&Sr.redraw(Sr.selectedObj)}})}}};y.showarrow&&Ot(0,0),X&&s.init({element:V.node(),gd:a,prepFn:function(){Lt=G.attr("transform")},moveFn:function(ot,pt){var qt="pointer";if(y.showarrow)R("ax",y.axref===y.xref?d(b,ot,"ax",P,y):y.ax+ot),R("ay",y.ayref===y.yref?d(w,pt,"ay",P.w,y):y.ay+pt),Ot(ot,pt);else{if(_)return;var St,Mt;if(b)St=d(b,ot,"x",P,y);else{var Ce=y._xsize/P.w;St=s.align(y.x+(y._xshift-y.xshift)/P.w-Ce/2+ot/P.w,Ce,0,1,y.xanchor)}if(w)Mt=d(w,pt,"y",P,y);else{var st=y._ysize/P.h;Mt=s.align(y.y-(y._yshift+y.yshift)/P.h-st/2-pt/P.h,st,0,1,y.yanchor)}R("x",St),R("y",Mt),b&&w||(qt=s.getCursor(b?.5:St,w?.5:Mt,y.xanchor,y.yanchor))}G.attr({transform:e(ot,pt)+Lt}),p(V,qt)},clickFn:function(ot,pt){y.captureevents&&a.emit("plotly_clickannotation",oe(pt))},doneFn:function(){p(V),t.call("_guiRelayout",a,D());var ot=document.querySelector(".js-notes-box-panel");ot&&ot.redraw(ot.selectedObj)}})}}}Q.exports={draw:function(a){var y=a._fullLayout;y._infolayer.selectAll(".annotation").remove();for(var h=0;h<y.annotations.length;h++)y.annotations[h].visible&&o(a,h);return k.previousPromises(a)},drawOne:o,drawRaw:u}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../color"),k=v("./arrow_paths"),x=v("../../lib"),e=x.strScale,r=x.strRotate,i=x.strTranslate;Q.exports=function(c,n,m){var p,s,f,l,o=c.node(),d=k[m.arrowhead||0],u=k[m.startarrowhead||0],a=(m.arrowwidth||1)*(m.arrowsize||1),y=(m.arrowwidth||1)*(m.startarrowsize||1),h=n.indexOf("start")>=0,_=n.indexOf("end")>=0,b=d.backoff*a+m.standoff,w=u.backoff*y+m.startstandoff;if("line"===o.nodeName){p={x:+c.attr("x1"),y:+c.attr("y1")},s={x:+c.attr("x2"),y:+c.attr("y2")};var T=p.x-s.x,L=p.y-s.y;if(l=(f=Math.atan2(L,T))+Math.PI,b&&w&&b+w>Math.sqrt(T*T+L*L))return void W();if(b){if(b*b>T*T+L*L)return void W();var M=b*Math.cos(f),P=b*Math.sin(f);s.x+=M,s.y+=P,c.attr({x2:s.x,y2:s.y})}if(w){if(w*w>T*T+L*L)return void W();var z=w*Math.cos(f),S=w*Math.sin(f);p.x-=z,p.y-=S,c.attr({x1:p.x,y1:p.y})}}else if("path"===o.nodeName){var C=o.getTotalLength(),R="";if(C<b+w)return void W();var D=o.getPointAtLength(0),j=o.getPointAtLength(.1);f=Math.atan2(D.y-j.y,D.x-j.x),p=o.getPointAtLength(Math.min(w,C)),R="0px,"+w+"px,";var q=o.getPointAtLength(C),Z=o.getPointAtLength(C-.1);l=Math.atan2(q.y-Z.y,q.x-Z.x),s=o.getPointAtLength(Math.max(0,C-b)),c.style("stroke-dasharray",R+=C-(R?w+b:b)+"px,"+C+"px")}function W(){c.style("stroke-dasharray","0px,100px")}function G(X,ne,V,N){X.path&&(X.noRotate&&(V=0),g.select(o.parentNode).append("path").attr({class:c.attr("class"),d:X.path,transform:i(ne.x,ne.y)+r(180*V/Math.PI)+e(N)}).style({fill:t.rgb(m.arrowcolor),"stroke-width":0}))}h&&G(u,p,f,y),_&&G(d,s,l,a)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(v,Q,$){"use strict";var g=v("./draw"),t=v("./click");Q.exports={moduleType:"component",name:"annotations",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("annotations"),calcAutorange:v("./calc_autorange"),draw:g.draw,drawOne:g.drawOne,drawRaw:g.drawRaw,hasClickToShow:t.hasClickToShow,onClick:t.onClick,convertCoords:v("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(v,Q,$){"use strict";var g=v("../annotations/attributes"),t=v("../../plot_api/edit_types").overrideAll,k=v("../../plot_api/plot_template").templatedArray;Q.exports=t(k("annotation",{visible:g.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:g.xanchor,xshift:g.xshift,yanchor:g.yanchor,yshift:g.yshift,text:g.text,textangle:g.textangle,font:g.font,width:g.width,height:g.height,opacity:g.opacity,align:g.align,valign:g.valign,bgcolor:g.bgcolor,bordercolor:g.bordercolor,borderpad:g.borderpad,borderwidth:g.borderwidth,showarrow:g.showarrow,arrowcolor:g.arrowcolor,arrowhead:g.arrowhead,startarrowhead:g.startarrowhead,arrowside:g.arrowside,arrowsize:g.arrowsize,startarrowsize:g.startarrowsize,arrowwidth:g.arrowwidth,standoff:g.standoff,startstandoff:g.startstandoff,hovertext:g.hovertext,hoverlabel:g.hoverlabel,captureevents:g.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes");function k(x,e){var r=e.fullSceneLayout.domain,i=e.fullLayout._size,c={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};x._xa={},g.extendFlat(x._xa,c),t.setConvert(x._xa),x._xa._offset=i.l+r.x[0]*i.w,x._xa.l2p=function(){return.5*(1+x._pdata[0]/x._pdata[3])*i.w*(r.x[1]-r.x[0])},x._ya={},g.extendFlat(x._ya,c),t.setConvert(x._ya),x._ya._offset=i.t+(1-r.y[1])*i.h,x._ya.l2p=function(){return.5*(1-x._pdata[1]/x._pdata[3])*i.h*(r.y[1]-r.y[0])}}Q.exports=function(x){for(var e=x.fullSceneLayout.annotations,r=0;r<e.length;r++)k(e[r],x);x.fullLayout._infolayer.selectAll(".annotation-"+x.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("../annotations/common_defaults"),e=v("./attributes");function r(i,c,n,m){function p(f,l){return g.coerce(i,c,e,f,l)}function s(f){var l=f+"axis",o={_fullLayout:{}};return o._fullLayout[l]=n[l],t.coercePosition(c,o,p,f,f,.5)}p("visible")&&(x(i,c,m.fullLayout,p),s("x"),s("y"),s("z"),g.noneOrAll(i,c,["x","y","z"]),c.xref="x",c.yref="y",c.zref="z",p("xanchor"),p("yanchor"),p("xshift"),p("yshift"),c.showarrow&&(c.axref="pixel",c.ayref="pixel",p("ax",-10),p("ay",-30),g.noneOrAll(i,c,["ax","ay"])))}Q.exports=function(i,c,n){k(i,c,{name:"annotations",handleItemDefaults:r,fullLayout:n.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(v,Q,$){"use strict";var g=v("../annotations/draw").drawRaw,t=v("../../plots/gl3d/project"),k=["x","y","z"];Q.exports=function(x){for(var e=x.fullSceneLayout,r=x.dataScale,i=e.annotations,c=0;c<i.length;c++){for(var n=i[c],m=!1,p=0;p<3;p++){var s=k[p],l=e[s+"axis"].r2fraction(n[s]);if(l<0||l>1){m=!0;break}}m?x.fullLayout._infolayer.select(".annotation-"+x.id+'[data-index="'+c+'"]').remove():(n._pdata=t(x.glplot.cameraParams,[e.xaxis.r2l(n.x)*r[0],e.yaxis.r2l(n.y)*r[1],e.zaxis.r2l(n.z)*r[2]]),g(x.graphDiv,n,c,x.id,n._xa,n._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib");Q.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:v("./attributes")}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),includeBasePlot:function(k,x){var e=g.subplotsRegistry.gl3d;if(e)for(var r=e.attrRegex,i=Object.keys(k),c=0;c<i.length;c++){var n=i[c];r.test(n)&&(k[n].annotations||[]).length&&(t.pushUnique(x._basePlotModules,e),t.pushUnique(x._subplots.gl3d,n))}},convert:v("./convert"),draw:v("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(v,Q,$){"use strict";Q.exports=v("world-calendars/dist/main"),v("world-calendars/dist/plus"),v("world-calendars/dist/calendars/chinese"),v("world-calendars/dist/calendars/coptic"),v("world-calendars/dist/calendars/discworld"),v("world-calendars/dist/calendars/ethiopian"),v("world-calendars/dist/calendars/hebrew"),v("world-calendars/dist/calendars/islamic"),v("world-calendars/dist/calendars/julian"),v("world-calendars/dist/calendars/mayan"),v("world-calendars/dist/calendars/nanakshahi"),v("world-calendars/dist/calendars/nepali"),v("world-calendars/dist/calendars/persian"),v("world-calendars/dist/calendars/taiwan"),v("world-calendars/dist/calendars/thai"),v("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(v,Q,$){"use strict";var g=v("./calendars"),t=v("../../lib"),k=v("../../constants/numerical"),x=k.EPOCHJD,e=k.ONEDAY,r={valType:"enumerated",values:t.sortObjectKeys(g.calendars),editType:"calc",dflt:"gregorian"},i=function(u,a,y,h){var _={};return _[y]=r,t.coerce(u,a,_,y,h)},c={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},n={};function m(u){return n[u]||(n[u]=g.instance(u))}function p(u){return t.extendFlat({},r,{description:u})}function s(u){return"Sets the calendar system to use with `"+u+"` date data."}var f={xcalendar:p(s("x"))},l=t.extendFlat({},f,{ycalendar:p(s("y"))}),o=t.extendFlat({},l,{zcalendar:p(s("z"))}),d=p(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));Q.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:l,bar:l,box:l,heatmap:l,contour:l,histogram:l,histogram2d:l,histogram2dcontour:l,scatter3d:o,surface:o,mesh3d:o,scattergl:l,ohlc:f,candlestick:f},layout:{calendar:p(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:d},yaxis:{calendar:d},scene:{xaxis:{calendar:d},yaxis:{calendar:d},zaxis:{calendar:d}},polar:{radialaxis:{calendar:d}}},transforms:{filter:{valuecalendar:p(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:p(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:r,handleDefaults:i,handleTraceDefaults:function(u,a,y,h){for(var _=0;_<y.length;_++)i(u,a,y[_]+"calendar",h.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:m,worldCalFmt:function(u,a,y){for(var h,_,b,w,T,L=Math.floor((a+.05)/e)+x,M=m(y).fromJD(L),P=0;-1!==(P=u.indexOf("%",P));)"0"===(h=u.charAt(P+1))||"-"===h||"_"===h?(b=3,_=u.charAt(P+2),"_"===h&&(h="-")):(_=h,h="0",b=2),(w=c[_])?(T="##"===w?"##":M.formatDate(w[h]),u=u.substr(0,P)+T+u.substr(P+b),P+=T.length):P+=b;return u}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(v,Q,$){"use strict";$.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],$.defaultLine="#444",$.lightLine="#eee",$.background="#fff",$.borderLine="#BEC8D9",$.lightFraction=1e3/11},{}],367:[function(v,Q,$){"use strict";var g=v("tinycolor2"),t=v("fast-isnumeric"),k=v("../../lib/array").isTypedArray,x=Q.exports={},e=v("./attributes");x.defaults=e.defaults;var r=x.defaultLine=e.defaultLine;x.lightLine=e.lightLine;var i=x.background=e.background;function c(n){if(t(n)||"string"!=typeof n)return n;var m=n.trim();if("rgb"!==m.substr(0,3))return n;var p=m.match(/^rgba?\s*\(([^()]*)\)$/);if(!p)return n;var s=p[1].trim().split(/\s*[\s,]\s*/),f="a"===m.charAt(3)&&4===s.length;if(!f&&3!==s.length)return n;for(var l=0;l<s.length;l++){if(!(s[l].length&&(s[l]=Number(s[l]),s[l]>=0)))return n;if(3===l)s[l]>1&&(s[l]=1);else if(s[l]>=1)return n}var o=Math.round(255*s[0])+", "+Math.round(255*s[1])+", "+Math.round(255*s[2]);return f?"rgba("+o+", "+s[3]+")":"rgb("+o+")"}x.tinyRGB=function(n){var m=n.toRgb();return"rgb("+Math.round(m.r)+", "+Math.round(m.g)+", "+Math.round(m.b)+")"},x.rgb=function(n){return x.tinyRGB(g(n))},x.opacity=function(n){return n?g(n).getAlpha():0},x.addOpacity=function(n,m){var p=g(n).toRgb();return"rgba("+Math.round(p.r)+", "+Math.round(p.g)+", "+Math.round(p.b)+", "+m+")"},x.combine=function(n,m){var p=g(n).toRgb();if(1===p.a)return g(n).toRgbString();var s=g(m||i).toRgb(),f=1===s.a?s:{r:255*(1-s.a)+s.r*s.a,g:255*(1-s.a)+s.g*s.a,b:255*(1-s.a)+s.b*s.a};return g({r:f.r*(1-p.a)+p.r*p.a,g:f.g*(1-p.a)+p.g*p.a,b:f.b*(1-p.a)+p.b*p.a}).toRgbString()},x.contrast=function(n,m,p){var s=g(n);return 1!==s.getAlpha()&&(s=g(x.combine(n,i))),(s.isDark()?m?s.lighten(m):i:p?s.darken(p):r).toString()},x.stroke=function(n,m){var p=g(m);n.style({stroke:x.tinyRGB(p),"stroke-opacity":p.getAlpha()})},x.fill=function(n,m){var p=g(m);n.style({fill:x.tinyRGB(p),"fill-opacity":p.getAlpha()})},x.clean=function(n){if(n&&"object"==typeof n){var m,p,s,f,l=Object.keys(n);for(m=0;m<l.length;m++)if(f=n[s=l[m]],"color"===s.substr(s.length-5))if(Array.isArray(f))for(p=0;p<f.length;p++)f[p]=c(f[p]);else n[s]=c(f);else if("colorscale"===s.substr(s.length-10)&&Array.isArray(f))for(p=0;p<f.length;p++)Array.isArray(f[p])&&(f[p][1]=c(f[p][1]));else if(Array.isArray(f)){var o=f[0];if(!Array.isArray(o)&&o&&"object"==typeof o)for(p=0;p<f.length;p++)x.clean(f[p])}else f&&"object"==typeof f&&!k(f)&&x.clean(f)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/layout_attributes"),t=v("../../plots/font_attributes"),k=v("../../lib/extend").extendFlat,x=v("../../plot_api/edit_types").overrideAll;Q.exports=x({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:g.linecolor,outlinewidth:g.linewidth,bordercolor:g.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:k({},g.ticks,{dflt:""}),ticklabeloverflow:k({},g.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,tickfont:t({}),tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,separatethousands:g.separatethousands,exponentformat:g.exponentformat,minexponent:g.minexponent,showexponent:g.showexponent,title:{text:{valType:"string"},font:t({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:t({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(v,Q,$){"use strict";Q.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plot_api/plot_template"),k=v("../../plots/cartesian/tick_value_defaults"),x=v("../../plots/cartesian/tick_mark_defaults"),e=v("../../plots/cartesian/tick_label_defaults"),r=v("../../plots/cartesian/prefix_suffix_defaults"),i=v("./attributes");Q.exports=function(c,n,m){var p=t.newContainer(n,"colorbar"),s=c.colorbar||{};function f(L,M){return g.coerce(s,p,i,L,M)}var l=m.margin||{t:0,b:0,l:0,r:0},o=m.width-l.l-l.r,d=m.height-l.t-l.b,u="v"===f("orientation"),a=f("thicknessmode");f("thickness","fraction"===a?30/(u?o:d):30);var y=f("lenmode");f("len","fraction"===y?1:u?d:o),f("x",u?1.02:.5),f("xanchor",u?"left":"center"),f("xpad"),f("y",u?.5:1.02),f("yanchor",u?"middle":"bottom"),f("ypad"),g.noneOrAll(s,p,["x","y"]),f("outlinecolor"),f("outlinewidth"),f("bordercolor"),f("borderwidth"),f("bgcolor");var h=g.coerce(s,p,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:u?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");f("ticklabeloverflow",-1!==h.indexOf("inside")?"hide past domain":"hide past div"),k(s,p,f,"linear");var _=m.font,b={outerTicks:!1,font:_};-1!==h.indexOf("inside")&&(b.bgColor="black"),r(s,p,f,"linear",b),e(s,p,f,"linear",b),x(s,p,f,"linear",b),f("title.text",m._dfltTitle.colorbar);var w=p.tickfont,T=g.extendFlat({},w,{color:_.color,size:g.bigFont(w.size)});g.coerceFont(f,"title.font",T),f("title.side",u?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("tinycolor2"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../plots/cartesian/axes"),r=v("../dragelement"),i=v("../../lib"),c=i.strTranslate,n=v("../../lib/extend").extendFlat,m=v("../../lib/setcursor"),p=v("../drawing"),s=v("../color"),f=v("../titles"),l=v("../../lib/svg_text_utils"),o=v("../colorscale/helpers").flipScale,d=v("../../plots/cartesian/axis_defaults"),u=v("../../plots/cartesian/position_defaults"),a=v("../../plots/cartesian/layout_attributes"),y=v("../../constants/alignment"),h=y.LINE_SPACING,_=y.FROM_TL,b=y.FROM_BR,w=v("./constants").cn;Q.exports={draw:function(T){var L=T._fullLayout._infolayer.selectAll("g."+w.colorbar).data(function(M){var P,z,S,C,R=M._fullLayout,D=M.calcdata,j=[];function q(K){return n(K,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Z(){"function"==typeof C.calc?C.calc(M,S,P):(P._fillgradient=z.reversescale?o(z.colorscale):z.colorscale,P._zrange=[z[C.min],z[C.max]])}for(var W=0;W<D.length;W++){var X=(S=D[W][0].trace)._module.colorbar;if(!0===S.visible&&X)for(var ne=Array.isArray(X),V=ne?X:[X],N=0;N<V.length;N++){var U=(C=V[N]).container;(z=U?S[U]:S)&&z.showscale&&((P=q(z.colorbar))._id="cb"+S.uid+(ne&&U?"-"+U:""),P._traceIndex=S.index,P._propPrefix=(U?U+".":"")+"colorbar.",P._meta=S._meta,Z(),j.push(P))}}for(var ee in R._colorAxes)if((z=R[ee]).showscale){var B=R._colorAxes[ee];(P=q(z.colorbar))._id="cb"+ee,P._propPrefix=ee+".colorbar.",P._meta=R._meta,C={min:"cmin",max:"cmax"},"heatmap"!==B[0]&&(C.calc=(S=B[1])._module.colorbar.calc),Z(),j.push(P)}return j}(T),function(M){return M._id});L.enter().append("g").attr("class",function(M){return M._id}).classed(w.colorbar,!0),L.each(function(M){var P=g.select(this);i.ensureSingle(P,"rect",w.cbbg),i.ensureSingle(P,"g",w.cbfills),i.ensureSingle(P,"g",w.cblines),i.ensureSingle(P,"g",w.cbaxis,function(S){S.classed(w.crisp,!0)}),i.ensureSingle(P,"g",w.cbtitleunshift,function(S){S.append("g").classed(w.cbtitle,!0)}),i.ensureSingle(P,"rect",w.cboutline);var S,C,R,D,j,q,Z,W,z=function(S,C,R){var D="v"===C.orientation,j=C.len,q=C.lenmode,Z=C.thickness,W=C.thicknessmode,G=C.outlinewidth,X=C.borderwidth,ne=C.bgcolor,V=C.xanchor,N=C.yanchor,U=C.xpad,ee=C.ypad,B=C.x,K=D?C.y:1-C.y,J=R._fullLayout,te=J._size,ae=C._fillcolor,ce=C._line,oe=C.title,ve=oe.side,fe=C._zrange||g.extent(("function"==typeof ae?ae:ce.color).domain()),xe="function"==typeof ce.color?ce.color:function(){return ce.color},Se="function"==typeof ae?ae:function(){return ae},pe=C._levels,ge=function(cn,Rt,je){var Ye,he,be=Rt._levels,Fe=[],He=[],Ke=be.end+be.size/100,Ze=be.size,ut=1.001*je[0]-.001*je[1],lt=1.001*je[1]-.001*je[0];for(he=0;he<1e5&&(Ye=be.start+he*Ze,!(Ze>0?Ye>=Ke:Ye<=Ke));he++)Ye>ut&&Ye<lt&&Fe.push(Ye);if(Rt._fillgradient)He=[0];else if("function"==typeof Rt._fillcolor){var Lt=Rt._filllevels;if(Lt)for(Ke=Lt.end+Lt.size/100,Ze=Lt.size,he=0;he<1e5&&(Ye=Lt.start+he*Ze,!(Ze>0?Ye>=Ke:Ye<=Ke));he++)Ye>je[0]&&Ye<je[1]&&He.push(Ye);else(He=Fe.map(function(Ot){return Ot-be.size/2})).push(He[He.length-1]+be.size)}else Rt._fillcolor&&"string"==typeof Rt._fillcolor&&(He=[0]);return be.size<0&&(Fe.reverse(),He.reverse()),{line:Fe,fill:He}}(0,C,fe),Te=ge.fill,se=ge.line,de=Math.round(Z*("fraction"===W?D?te.w:te.h:1)),Ae=de/(D?te.w:te.h),Le=Math.round(j*("fraction"===q?D?te.h:te.w:1)),Me=Le/(D?te.h:te.w),De=Math.round(D?B*te.w+U:K*te.h+ee),Oe={center:.5,right:1}[V]||0,Ie={top:1,middle:.5}[N]||0,Qe=D?B-Oe*Ae:K-Ie*Ae,Ne=D?K-Ie*Me:B-Oe*Me,Pe=Math.round(D?te.h*(1-Ne):te.w*Ne);C._lenFrac=Me,C._thickFrac=Ae,C._uFrac=Qe,C._vFrac=Ne;var Re=C._axis=function(cn,Rt,je){var Ye=cn._fullLayout,he="v"===Rt.orientation,be={type:"linear",range:je,tickmode:Rt.tickmode,nticks:Rt.nticks,tick0:Rt.tick0,dtick:Rt.dtick,tickvals:Rt.tickvals,ticktext:Rt.ticktext,ticks:Rt.ticks,ticklen:Rt.ticklen,tickwidth:Rt.tickwidth,tickcolor:Rt.tickcolor,showticklabels:Rt.showticklabels,ticklabelposition:Rt.ticklabelposition,ticklabeloverflow:Rt.ticklabeloverflow,ticklabelstep:Rt.ticklabelstep,tickfont:Rt.tickfont,tickangle:Rt.tickangle,tickformat:Rt.tickformat,exponentformat:Rt.exponentformat,minexponent:Rt.minexponent,separatethousands:Rt.separatethousands,showexponent:Rt.showexponent,showtickprefix:Rt.showtickprefix,tickprefix:Rt.tickprefix,showticksuffix:Rt.showticksuffix,ticksuffix:Rt.ticksuffix,title:Rt.title,showline:!0,anchor:"free",side:he?"right":"bottom",position:1},Fe=he?"y":"x",He={type:"linear",_id:Fe+Rt._id},Ke={letter:Fe,font:Ye.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:Ye.calendar};function Ze(ut,lt){return i.coerce(be,He,a,ut,lt)}return d(be,He,Ze,Ke,Ye),u(be,He,Ze,Ke),He}(R,C,fe);Re.position=Ae+(D?B+U/te.w:K+ee/te.h);var Ge=-1!==["top","bottom"].indexOf(ve);if(D&&Ge&&(Re.title.side=ve,Re.titlex=B+U/te.w,Re.titley=Ne+("top"===oe.side?Me-ee/te.h:ee/te.h)),D||Ge||(Re.title.side=ve,Re.titley=K+ee/te.h,Re.titlex=Ne+U/te.w),ce.color&&"auto"===C.tickmode){Re.tickmode="linear",Re.tick0=pe.start;var tt=pe.size,ct=i.constrain(Le/50,4,15)+1,wt=(fe[1]-fe[0])/((C.nticks||ct)*tt);if(wt>1){var kt=Math.pow(10,Math.floor(Math.log(wt)/Math.LN10));tt*=kt*i.roundUp(wt/kt,[2,5,10]),(Math.abs(pe.start)/pe.size+1e-6)%1<2e-6&&(Re.tick0=0)}Re.dtick=tt}Re.domain=D?[Ne+ee/te.h,Ne+Me-ee/te.h]:[Ne+U/te.w,Ne+Me-U/te.w],Re.setScale(),S.attr("transform",c(Math.round(te.l),Math.round(te.t)));var gt,at=S.select("."+w.cbtitleunshift).attr("transform",c(-Math.round(te.l),-Math.round(te.t))),et=Re.ticklabelposition,yt=Re.title.font.size,Vt=S.select("."+w.cbaxis),Gt=0,en=0;function Jt(cn,Rt){var je={propContainer:Re,propName:C._propPrefix+"title",traceIndex:C._traceIndex,_meta:C._meta,placeholder:J._dfltTitle.colorbar,containerGroup:S.select("."+w.cbtitle)},Ye="h"===cn.charAt(0)?cn.substr(1):"h"+cn;S.selectAll("."+Ye+",."+Ye+"-math-group").remove(),f.draw(R,cn,n(je,Rt||{}))}return i.syncOrAsync([k.previousPromises,function(){var cn,Rt;(D&&Ge||!D&&!Ge)&&("top"===ve&&(cn=U+te.l+te.w*B,Rt=ee+te.t+te.h*(1-Ne-Me)+3+.75*yt),"bottom"===ve&&(cn=U+te.l+te.w*B,Rt=ee+te.t+te.h*(1-Ne)-3-.25*yt),"right"===ve&&(Rt=ee+te.t+te.h*K+3+.75*yt,cn=U+te.l+te.w*Ne),Jt(Re._id+"title",{attributes:{x:cn,y:Rt,"text-anchor":D?"start":"middle"}}))},function(){if(!D&&!Ge||D&&Ge){var cn,Rt=S.select("."+w.cbtitle),je=Rt.select("text"),Ye=[-G/2,G/2],he=Rt.select(".h"+Re._id+"title-math-group").node(),be=15.6;if(je.node()&&(be=parseInt(je.node().style.fontSize,10)*h),he?(cn=p.bBox(he),en=cn.width,(Gt=cn.height)>be&&(Ye[1]-=(Gt-be)/2)):je.node()&&!je.classed(w.jsPlaceholder)&&(cn=p.bBox(je.node()),en=cn.width,Gt=cn.height),D){if(Gt){if(Gt+=5,"top"===ve)Re.domain[1]-=Gt/te.h,Ye[1]*=-1;else{Re.domain[0]+=Gt/te.h;var Fe=l.lineCount(je);Ye[1]+=(1-Fe)*be}Rt.attr("transform",c(Ye[0],Ye[1])),Re.setScale()}}else en&&("right"===ve&&(Re.domain[0]+=(en+yt/2)/te.w),Rt.attr("transform",c(Ye[0],Ye[1])),Re.setScale())}S.selectAll("."+w.cbfills+",."+w.cblines).attr("transform",D?c(0,Math.round(te.h*(1-Re.domain[1]))):c(Math.round(te.w*Re.domain[0]),0)),Vt.attr("transform",D?c(0,Math.round(-te.t)):c(Math.round(-te.l),0));var He=S.select("."+w.cbfills).selectAll("rect."+w.cbfill).attr("style","").data(Te);He.enter().append("rect").classed(w.cbfill,!0).style("stroke","none"),He.exit().remove();var Ke=fe.map(Re.c2p).map(Math.round).sort(function(Ot,ot){return Ot-ot});He.each(function(Ot,ot){var pt=[0===ot?fe[0]:(Te[ot]+Te[ot-1])/2,ot===Te.length-1?fe[1]:(Te[ot]+Te[ot+1])/2].map(Re.c2p).map(Math.round);D&&(pt[1]=i.constrain(pt[1]+(pt[1]>pt[0])?1:-1,Ke[0],Ke[1]));var qt=g.select(this).attr(D?"x":"y",De).attr(D?"y":"x",g.min(pt)).attr(D?"width":"height",Math.max(de,2)).attr(D?"height":"width",Math.max(g.max(pt)-g.min(pt),2));if(C._fillgradient)p.gradient(qt,R,C._id,D?"vertical":"horizontalreversed",C._fillgradient,"fill");else{var St=Se(Ot).replace("e-","");qt.attr("fill",t(St).toHexString())}});var Ze=S.select("."+w.cblines).selectAll("path."+w.cbline).data(ce.color&&ce.width?se:[]);Ze.enter().append("path").classed(w.cbline,!0),Ze.exit().remove(),Ze.each(function(Ot){var ot=De,pt=Math.round(Re.c2p(Ot))+ce.width/2%1;g.select(this).attr("d","M"+(D?ot+","+pt:pt+","+ot)+(D?"h":"v")+de).call(p.lineGroupStyle,ce.width,xe(Ot),ce.dash)}),Vt.selectAll("g."+Re._id+"tick,path").remove();var ut=De+de+(G||0)/2-("outside"===C.ticks?1:0),lt=e.calcTicks(Re),Lt=e.getTickSigns(Re)[2];return e.drawTicks(R,Re,{vals:"inside"===Re.ticks?e.clipEnds(Re,lt):lt,layer:Vt,path:e.makeTickPath(Re,ut,Lt),transFn:e.makeTransTickFn(Re)}),e.drawLabels(R,Re,{vals:lt,layer:Vt,transFn:e.makeTransTickLabelFn(Re),labelFns:e.makeLabelFns(Re,ut)})},function(){if(D&&!Ge||!D&&Ge){var cn,Rt,je=Re.position||0,Ye=Re._offset+Re._length/2;if("right"===ve)Rt=Ye,cn=te.l+te.w*je+10+yt*(Re.showticklabels?1:.5);else if(cn=Ye,"bottom"===ve&&(Rt=te.t+te.h*je+10+(-1===et.indexOf("inside")?Re.tickfont.size:0)+("intside"!==Re.ticks&&C.ticklen||0)),"top"===ve){var he=oe.text.split("<br>").length;Rt=te.t+te.h*je+10-de-h*yt*he}Jt((D?"h":"v")+Re._id+"title",{avoid:{selection:g.select(R).selectAll("g."+Re._id+"tick"),side:ve,offsetTop:D?0:te.t,offsetLeft:D?te.l:0,maxShift:D?J.width:J.height},attributes:{x:cn,y:Rt,"text-anchor":"middle"},transform:{rotate:D?-90:0,offset:0}})}},k.previousPromises,function(){var cn,Rt=de+G/2;-1===et.indexOf("inside")&&(cn=p.bBox(Vt.node()),Rt+=D?cn.width:cn.height),gt=at.select("text");var je=0,Ye=D&&"top"===ve,he=!D&&"right"===ve,be=0;if(gt.node()&&!gt.classed(w.jsPlaceholder)){var Fe,He=at.select(".h"+Re._id+"title-math-group").node();He&&(D&&Ge||!D&&!Ge)?(je=(cn=p.bBox(He)).width,Fe=cn.height):(je=(cn=p.bBox(at.node())).right-te.l-(D?De:Pe),Fe=cn.bottom-te.t-(D?Pe:De),D||"top"!==ve||(Rt+=cn.height,be=cn.height)),he&&(gt.attr("transform",c(je/2+yt/2,0)),je*=2),Rt=Math.max(Rt,D?je:Fe)}var Ke=2*(D?U:ee)+Rt+X+G/2,Ze=0;!D&&oe.text&&"bottom"===N&&K<=0&&(Ke+=Ze=Ke/2,be+=Ze),J._hColorbarMoveTitle=Ze,J._hColorbarMoveCBTitle=be;var ut=X+G;S.select("."+w.cbbg).attr("x",(D?De:Pe)-ut/2-(D?U:0)).attr("y",(D?Pe:De)-(D?Le:ee+be-Ze)).attr(D?"width":"height",Math.max(Ke-Ze,2)).attr(D?"height":"width",Math.max(Le+ut,2)).call(s.fill,ne).call(s.stroke,C.bordercolor).style("stroke-width",X);var lt=he?Math.max(je-10,0):0;if(S.selectAll("."+w.cboutline).attr("x",(D?De:Pe+U)+lt).attr("y",(D?Pe+ee-Le:De)+(Ye?Gt:0)).attr(D?"width":"height",Math.max(de,2)).attr(D?"height":"width",Math.max(Le-(D?2*ee+Gt:2*U+lt),2)).call(s.stroke,C.outlinecolor).style({fill:"none","stroke-width":G}),S.attr("transform",c(te.l-(D?Oe*Ke:0),te.t-(D?0:(1-Ie)*Ke-be))),!D&&(X||t(ne).getAlpha()&&!t.equals(J.paper_bgcolor,ne))){var Lt=Vt.selectAll("text"),Ot=Lt[0].length,ot=S.select("."+w.cbbg).node(),pt=p.bBox(ot),qt=p.getTranslate(S);Lt.each(function(zt,Ht){var Kt=Ot-1;if(0===Ht||Ht===Kt){var Zt,vn=p.bBox(this),zn=p.getTranslate(this);Ht===Kt?(Zt=pt.right+qt.x+Pe-X-2+B-(vn.right+zn.x))>0&&(Zt=0):0===Ht&&(Zt=pt.left+qt.x+Pe+X+2-(vn.left+zn.x))<0&&(Zt=0),Zt&&(Ot<3?this.setAttribute("transform","translate("+Zt+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var St={},Mt=_[V],Ce=b[V],Xe=_[N],st=b[N],dt=Ke-de;D?("pixels"===q?(St.y=K,St.t=Le*Xe,St.b=Le*st):(St.t=St.b=0,St.yt=K+j*Xe,St.yb=K-j*st),"pixels"===W?(St.x=B,St.l=Ke*Mt,St.r=Ke*Ce):(St.l=dt*Mt,St.r=dt*Ce,St.xl=B-Z*Mt,St.xr=B+Z*Ce)):("pixels"===q?(St.x=B,St.l=Le*Mt,St.r=Le*Ce):(St.l=St.r=0,St.xl=B+j*Mt,St.xr=B-j*Ce),"pixels"===W?(St.y=1-K,St.t=Ke*Xe,St.b=Ke*st):(St.t=dt*Xe,St.b=dt*st,St.yt=K-Z*Xe,St.yb=K+Z*st)),k.autoMargin(R,C._id,St)}],R)}(P,M,T);z&&z.then&&(T._promises||[]).push(z),T._context.edits.colorbarPosition&&(Z="v"===(C=M).orientation,W=(R=T)._fullLayout._size,r.init({element:(S=P).node(),gd:R,prepFn:function(){D=S.attr("transform"),m(S)},moveFn:function(G,X){S.attr("transform",D+c(G,X)),j=r.align((Z?C._uFrac:C._vFrac)+G/W.w,Z?C._thickFrac:C._lenFrac,0,1,C.xanchor),q=r.align((Z?C._vFrac:1-C._uFrac)-X/W.h,Z?C._lenFrac:C._thickFrac,0,1,C.yanchor);var ne=r.getCursor(j,q,C.xanchor,C.yanchor);m(S,ne)},doneFn:function(){if(m(S),void 0!==j&&void 0!==q){var G={};G[C._propPrefix+"x"]=j,G[C._propPrefix+"y"]=q,void 0!==C._traceIndex?x.call("_guiRestyle",R,G,C._traceIndex):x.call("_guiRelayout",R,G)}}}))}),L.exit().each(function(M){k.autoMargin(T,M._id)}).remove(),L.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t){return g.isPlainObject(t.colorbar)}},{"../../lib":515}],373:[function(v,Q,$){"use strict";Q.exports={moduleType:"component",name:"colorbar",attributes:v("./attributes"),supplyDefaults:v("./defaults"),draw:v("./draw").draw,hasColorbar:v("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(v,Q,$){"use strict";var g=v("../colorbar/attributes"),t=v("../../lib/regex").counter,k=v("../../lib/sort_object_keys"),x=v("./scales.js").scales;function e(r){return"`"+r+"`"}k(x),Q.exports=function(r,i){r=r||"";var c,n=(i=i||{}).cLetter||"c",m=("onlyIfNumerical"in i||Boolean(r),"noScale"in i?i.noScale:"marker.line"===r),p="showScaleDflt"in i?i.showScaleDflt:"z"===n,s="string"==typeof i.colorscaleDflt?x[i.colorscaleDflt]:null,f=i.editTypeOverride||"",l=r?r+".":"";"colorAttr"in i?c=i.colorAttr:e(l+(c={z:"z",c:"color"}[n]));var o=n+"auto",d=n+"min",u=n+"max",a=n+"mid",y=(e(l+o),e(l+d),e(l+u),{});y[d]=y[u]=void 0;var h={};h[o]=!1;var _={};return"color"===c&&(_.color={valType:"color",arrayOk:!0,editType:f||"style"},i.anim&&(_.color.anim=!0)),_[o]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:y},_[d]={valType:"number",dflt:null,editType:f||"plot",impliedEdits:h},_[u]={valType:"number",dflt:null,editType:f||"plot",impliedEdits:h},_[a]={valType:"number",dflt:null,editType:"calc",impliedEdits:y},_.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},_.autocolorscale={valType:"boolean",dflt:!1!==i.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},_.reversescale={valType:"boolean",dflt:!1,editType:"plot"},m||(_.showscale={valType:"boolean",dflt:p,editType:"calc"},_.colorbar=g),i.noColorAxis||(_.coloraxis={valType:"subplotid",regex:t("coloraxis"),dflt:null,editType:"calc"}),_}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("./helpers").extractOpts;Q.exports=function(x,e,r){var c=x._fullLayout,n=r.vals,m=r.containerStr,p=m?t.nestedProperty(e,m).get():e,s=k(p),f=!1!==s.auto,l=s.min,o=s.max,d=s.mid,u=function(){return t.aggNums(Math.min,null,n)},a=function(){return t.aggNums(Math.max,null,n)};void 0===l?l=u():f&&(l=p._colorAx&&g(l)?Math.min(l,u()):u()),void 0===o?o=a():f&&(o=p._colorAx&&g(o)?Math.max(o,a()):a()),f&&void 0!==d&&(o-d>d-l?l=d-(o-d):o-d<d-l&&(o=d+(d-l))),l===o&&(l-=.5,o+=.5),s._sync("min",l),s._sync("max",o),s.autocolorscale&&s._sync("colorscale",l*o<0?c.colorscale.diverging:l>=0?c.colorscale.sequential:c.colorscale.sequentialminus)}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./helpers").hasColorscale,k=v("./helpers").extractOpts;Q.exports=function(x,e){function r(f,l){var o=f["_"+l];void 0!==o&&(f[l]=o)}function i(f,l){var o=l.container?g.nestedProperty(f,l.container).get():f;if(o)if(o.coloraxis)o._colorAx=e[o.coloraxis];else{var d=k(o),u=d.auto;(u||void 0===d.min)&&r(o,l.min),(u||void 0===d.max)&&r(o,l.max),d.autocolorscale&&r(o,"colorscale")}}for(var c=0;c<x.length;c++){var n=x[c],m=n._module.colorbar;if(m)if(Array.isArray(m))for(var p=0;p<m.length;p++)i(n,m[p]);else i(n,m);t(n,"marker.line")&&i(n,{container:"marker.line",min:"cmin",max:"cmax"})}for(var s in e._colorAxes)i(e[s],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../colorbar/has_colorbar"),x=v("../colorbar/defaults"),e=v("./scales").isValid,r=v("../../registry").traceIs;function i(c,n){var m=n.slice(0,n.length-1);return n?t.nestedProperty(c,m).get()||{}:c}Q.exports=function c(n,m,p,s,f){var l=f.prefix,o=f.cLetter,d="_module"in m,u=i(n,l),a=i(m,l),y=i(m._template||{},l)||{},h=function(){return delete n.coloraxis,delete m.coloraxis,c(n,m,p,s,f)};if(d){var _=p._colorAxes||{},b=s(l+"coloraxis");if(b){var w=r(m,"contour")&&t.nestedProperty(m,"contours.coloring").get()||"heatmap",T=_[b];return void(T?(T[2].push(h),T[0]!==w&&(T[0]=!1,t.warn(["Ignoring coloraxis:",b,"setting","as it is linked to incompatible colorscales."].join(" ")))):_[b]=[w,m,[h]])}}var L=u[o+"min"],M=u[o+"max"],P=g(L)&&g(M)&&L<M;s(l+o+"auto",!P)?s(l+o+"mid"):(s(l+o+"min"),s(l+o+"max"));var z,S,C=u.colorscale,R=y.colorscale;void 0!==C&&(z=!e(C)),void 0!==R&&(z=!e(R)),s(l+"autocolorscale",z),s(l+"colorscale"),s(l+"reversescale"),"marker.line."!==l&&(l&&d&&(S=k(u)),s(l+"showscale",S)&&(l&&y&&(a._template=y),x(u,a,p)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("tinycolor2"),k=v("fast-isnumeric"),x=v("../../lib"),e=v("../color"),r=v("./scales").isValid,i=["showscale","autocolorscale","colorscale","reversescale","colorbar"],c=["min","max","mid","auto"];function n(l){var o,d,u,a=l._colorAx,y=a||l,h={};for(d=0;d<i.length;d++)h[u=i[d]]=y[u];if(a)for(o="c",d=0;d<c.length;d++)h[u=c[d]]=y["c"+u];else{var _;for(d=0;d<c.length;d++)((_="c"+(u=c[d]))in y||(_="z"+u)in y)&&(h[u]=y[_]);o=_.charAt(0)}return h._sync=function(b,w){var T=-1!==c.indexOf(b)?o+b:b;y[T]=y["_"+T]=w},h}function m(l){for(var o=n(l),d=o.min,u=o.max,a=o.reversescale?p(o.colorscale):o.colorscale,y=a.length,h=new Array(y),_=new Array(y),b=0;b<y;b++){var w=a[b];h[b]=d+w[0]*(u-d),_[b]=w[1]}return{domain:h,range:_}}function p(l){for(var o=l.length,d=new Array(o),u=o-1,a=0;u>=0;u--,a++){var y=l[u];d[a]=[1-y[0],y[1]]}return d}function s(l,o){o=o||{};for(var d=l.domain,u=l.range,a=u.length,y=new Array(a),h=0;h<a;h++){var _=t(u[h]).toRgb();y[h]=[_.r,_.g,_.b,_.a]}var b,w=g.scale.linear().domain(d).range(y).clamp(!0),T=o.noNumericCheck,L=o.returnArray;return(b=T&&L?w:T?function(M){return f(w(M))}:L?function(M){return k(M)?w(M):t(M).isValid()?M:e.defaultLine}:function(M){return k(M)?f(w(M)):t(M).isValid()?M:e.defaultLine}).domain=w.domain,b.range=function(){return u},b}function f(l){return t({r:l[0],g:l[1],b:l[2],a:l[3]}).toRgbString()}Q.exports={hasColorscale:function(l,o,d){var u=o?x.nestedProperty(l,o).get()||{}:l,a=u[d||"color"],y=!1;if(x.isArrayOrTypedArray(a))for(var h=0;h<a.length;h++)if(k(a[h])){y=!0;break}return x.isPlainObject(u)&&(y||!0===u.showscale||k(u.cmin)&&k(u.cmax)||r(u.colorscale)||x.isPlainObject(u.colorbar))},extractOpts:n,extractScale:m,flipScale:p,makeColorScaleFunc:s,makeColorScaleFuncFromTrace:function(l,o){return s(m(l),o)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(v,Q,$){"use strict";var g=v("./scales"),t=v("./helpers");Q.exports={moduleType:"component",name:"colorscale",attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),handleDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),calc:v("./calc"),scales:g.scales,defaultScale:g.defaultScale,getScale:g.get,isValidScale:g.isValid,hasColorscale:t.hasColorscale,extractOpts:t.extractOpts,extractScale:t.extractScale,flipScale:t.flipScale,makeColorScaleFunc:t.makeColorScaleFunc,makeColorScaleFuncFromTrace:t.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(v,Q,$){"use strict";var g=v("../../lib/extend").extendFlat,t=v("./attributes"),k=v("./scales").scales;Q.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:k.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:k.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:k.RdBu,editType:"calc"}},coloraxis:g({_isSubplotObj:!0,editType:"calc"},t("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plot_api/plot_template"),k=v("./layout_attributes"),x=v("./defaults");Q.exports=function(e,r){function i(o,d){return g.coerce(e,r,k,o,d)}i("colorscale.sequential"),i("colorscale.sequentialminus"),i("colorscale.diverging");var c,n,m=r._colorAxes;function p(o,d){return g.coerce(c,n,k.coloraxis,o,d)}for(var s in m){var f=m[s];if(f[0])c=e[s]||{},(n=t.newContainer(r,s,"coloraxis"))._name=s,x(c,n,r,p,{prefix:"",cLetter:"c"});else{for(var l=0;l<f[2].length;l++)f[2][l]();delete r._colorAxes[s]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(v,Q,$){"use strict";var g=v("tinycolor2"),t={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},k=t.RdBu;function x(e){var r=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var i=0;i<e.length;i++){var c=e[i];if(2!==c.length||+c[0]<r||!g(c[1]).isValid())return!1;r=+c[0]}return!0}Q.exports={scales:t,defaultScale:k,get:function(e,r){if(r||(r=k),!e)return r;function i(){try{e=t[e]||JSON.parse(e)}catch(c){e=r}}return"string"==typeof e&&(i(),"string"==typeof e&&i()),x(e)?e:r},isValid:function(e){return void 0!==t[e]||x(e)}}},{tinycolor2:313}],383:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){var r=(g-k)/(x-k),i=r+t/(x-k),c=(r+i)/2;return"left"===e||"bottom"===e?r:"center"===e||"middle"===e?c:"right"===e||"top"===e?i:r<2/3-c?r:i>4/3-c?i:c}},{}],384:[function(v,Q,$){"use strict";var g=v("../../lib"),t=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];Q.exports=function(k,x,e,r){return k="left"===e?0:"center"===e?1:"right"===e?2:g.constrain(Math.floor(3*k),0,2),x="bottom"===r?0:"middle"===r?1:"top"===r?2:g.constrain(Math.floor(3*x),0,2),t[x][k]}},{"../../lib":515}],385:[function(v,Q,$){"use strict";$.selectMode=function(g){return"lasso"===g||"select"===g},$.drawMode=function(g){return"drawclosedpath"===g||"drawopenpath"===g||"drawline"===g||"drawrect"===g||"drawcircle"===g},$.openMode=function(g){return"drawline"===g||"drawopenpath"===g},$.rectMode=function(g){return"select"===g||"drawline"===g||"drawrect"===g||"drawcircle"===g},$.freeMode=function(g){return"lasso"===g||"drawclosedpath"===g||"drawopenpath"===g},$.selectingOrDrawing=function(g){return $.freeMode(g)||$.rectMode(g)}},{}],386:[function(v,Q,$){"use strict";var g=v("mouse-event-offset"),t=v("has-hover"),k=v("has-passive-events"),x=v("../../lib").removeElement,e=v("../../plots/cartesian/constants"),r=Q.exports={};r.align=v("./align"),r.getCursor=v("./cursor");var i=v("./unhover");function c(){var m=document.createElement("div");m.className="dragcover";var p=m.style;return p.position="fixed",p.left=0,p.right=0,p.top=0,p.bottom=0,p.zIndex=999999999,p.background="none",document.body.appendChild(m),m}function n(m){return g(m.changedTouches?m.changedTouches[0]:m,document.body)}r.unhover=i.wrapped,r.unhoverRaw=i.raw,r.init=function(m){var p,s,f,l,o,d,u,a,y=m.gd,h=1,_=y._context.doubleClickDelay,b=m.element;y._mouseDownTime||(y._mouseDownTime=0),b.style.pointerEvents="all",b.onmousedown=T,k?(b._ontouchstart&&b.removeEventListener("touchstart",b._ontouchstart),b._ontouchstart=T,b.addEventListener("touchstart",T,{passive:!1})):b.ontouchstart=T;var w=m.clampFn||function(P,z,S){return Math.abs(P)<S&&(P=0),Math.abs(z)<S&&(z=0),[P,z]};function T(P){y._dragged=!1,y._dragging=!0;var z=n(P);p=z[0],s=z[1],u=P.target,d=P,a=2===P.buttons||P.ctrlKey,void 0===P.clientX&&void 0===P.clientY&&(P.clientX=p,P.clientY=s),(f=(new Date).getTime())-y._mouseDownTime<_?h+=1:(h=1,y._mouseDownTime=f),m.prepFn&&m.prepFn(P,p,s),t&&!a?(o=c()).style.cursor=window.getComputedStyle(b).cursor:t||(o=document,l=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(b).cursor),document.addEventListener("mouseup",M),document.addEventListener("touchend",M),!1!==m.dragmode&&(P.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(P){P.preventDefault();var z=n(P),C=w(z[0]-p,z[1]-s,m.minDrag||e.MINDRAG),R=C[0],D=C[1];(R||D)&&(y._dragged=!0,r.unhover(y,P)),y._dragged&&m.moveFn&&!a&&(y._dragdata={element:b,dx:R,dy:D},m.moveFn(R,D))}function M(P){if(delete y._dragdata,!1!==m.dragmode&&(P.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",M),document.removeEventListener("touchend",M),t?x(o):l&&(o.documentElement.style.cursor=l,l=null),y._dragging){if(y._dragging=!1,(new Date).getTime()-y._mouseDownTime>_&&(h=Math.max(h-1,1)),y._dragged)m.doneFn&&m.doneFn();else if(m.clickFn&&m.clickFn(h,d),!a){var z;try{z=new MouseEvent("click",P)}catch(C){var S=n(P);(z=document.createEvent("MouseEvents")).initMouseEvent("click",P.bubbles,P.cancelable,P.view,P.detail,P.screenX,P.screenY,S[0],S[1],P.ctrlKey,P.altKey,P.shiftKey,P.metaKey,P.button,P.relatedTarget)}u.dispatchEvent(z)}y._dragging=!1,y._dragged=!1}else y._dragged=!1}},r.coverSlip=c},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(v,Q,$){"use strict";var g=v("../../lib/events"),t=v("../../lib/throttle"),k=v("../../lib/dom").getGraphDiv,x=v("../fx/constants"),e=Q.exports={};e.wrapped=function(r,i,c){(r=k(r))._fullLayout&&t.clear(r._fullLayout._uid+x.HOVERID),e.raw(r,i,c)},e.raw=function(r,i){var c=r._fullLayout,n=r._hoverdata;i||(i={}),i.target&&!r._dragged&&!1===g.triggerHandler(r,"plotly_beforehover",i)||(c._hoverlayer.selectAll("g").remove(),c._hoverlayer.selectAll("line").remove(),c._hoverlayer.selectAll("circle").remove(),r._hoverdata=void 0,i.target&&n&&r.emit("plotly_unhover",{event:i,points:n}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(v,Q,$){"use strict";$.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},$.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=t.numberFormat,x=v("fast-isnumeric"),e=v("tinycolor2"),r=v("../../registry"),i=v("../color"),c=v("../colorscale"),n=t.strTranslate,m=v("../../lib/svg_text_utils"),p=v("../../constants/xmlns_namespaces"),s=v("../../constants/alignment").LINE_SPACING,f=v("../../constants/interactions").DESELECTDIM,l=v("../../traces/scatter/subtypes"),o=v("../../traces/scatter/make_bubble_size_func"),d=v("../../components/fx/helpers").appendArrayPointValue,u=Q.exports={};function a(pe,ge,Te){var se=ge.fillpattern,de=se&&u.getPatternAttr(se.shape,0,"");if(de){var Ae=u.getPatternAttr(se.bgcolor,0,null),Le=u.getPatternAttr(se.fgcolor,0,null),Me=se.fgopacity,De=u.getPatternAttr(se.size,0,8),Oe=u.getPatternAttr(se.solidity,0,.3);u.pattern(pe,"point",Te,ge.uid,de,De,Oe,void 0,se.fillmode,Ae,Le,Me)}else ge.fillcolor&&pe.call(i.fill,ge.fillcolor)}u.font=function(pe,ge,Te,se){t.isPlainObject(ge)&&(se=ge.color,Te=ge.size,ge=ge.family),ge&&pe.style("font-family",ge),Te+1&&pe.style("font-size",Te+"px"),se&&pe.call(i.fill,se)},u.setPosition=function(pe,ge,Te){pe.attr("x",ge).attr("y",Te)},u.setSize=function(pe,ge,Te){pe.attr("width",ge).attr("height",Te)},u.setRect=function(pe,ge,Te,se,de){pe.call(u.setPosition,ge,Te).call(u.setSize,se,de)},u.translatePoint=function(pe,ge,Te,se){var de=Te.c2p(pe.x),Ae=se.c2p(pe.y);return!!(x(de)&&x(Ae)&&ge.node())&&("text"===ge.node().nodeName?ge.attr("x",de).attr("y",Ae):ge.attr("transform",n(de,Ae)),!0)},u.translatePoints=function(pe,ge,Te){pe.each(function(se){var de=g.select(this);u.translatePoint(se,de,ge,Te)})},u.hideOutsideRangePoint=function(pe,ge,Te,se,de,Ae){ge.attr("display",Te.isPtWithinRange(pe,de)&&se.isPtWithinRange(pe,Ae)?null:"none")},u.hideOutsideRangePoints=function(pe,ge){if(ge._hasClipOnAxisFalse){var Te=ge.xaxis,se=ge.yaxis;pe.each(function(de){var Ae=de[0].trace,Le=Ae.xcalendar,Me=Ae.ycalendar,De=r.traceIs(Ae,"bar-like")?".bartext":".point,.textpoint";pe.selectAll(De).each(function(Oe){u.hideOutsideRangePoint(Oe,g.select(this),Te,se,Le,Me)})})}},u.crispRound=function(pe,ge,Te){return ge&&x(ge)?pe._context.staticPlot?ge:ge<1?1:Math.round(ge):Te||0},u.singleLineStyle=function(pe,ge,Te,se,de){ge.style("fill","none");var Ae=(((pe||[])[0]||{}).trace||{}).line||{},Le=Te||Ae.width||0,Me=de||Ae.dash||"";i.stroke(ge,se||Ae.color),u.dashLine(ge,Me,Le)},u.lineGroupStyle=function(pe,ge,Te,se){pe.style("fill","none").each(function(de){var Ae=(((de||[])[0]||{}).trace||{}).line||{},Le=ge||Ae.width||0,Me=se||Ae.dash||"";g.select(this).call(i.stroke,Te||Ae.color).call(u.dashLine,Me,Le)})},u.dashLine=function(pe,ge,Te){ge=u.dashStyle(ge,Te=+Te||0),pe.style({"stroke-dasharray":ge,"stroke-width":Te+"px"})},u.dashStyle=function(pe,ge){ge=+ge||1;var Te=Math.max(ge,3);return"solid"===pe?pe="":"dot"===pe?pe=Te+"px,"+Te+"px":"dash"===pe?pe=3*Te+"px,"+3*Te+"px":"longdash"===pe?pe=5*Te+"px,"+5*Te+"px":"dashdot"===pe?pe=3*Te+"px,"+Te+"px,"+Te+"px,"+Te+"px":"longdashdot"===pe&&(pe=5*Te+"px,"+2*Te+"px,"+Te+"px,"+2*Te+"px"),pe},u.singleFillStyle=function(pe,ge){var Te=g.select(pe.node());a(pe,((Te.data()[0]||[])[0]||{}).trace||{},ge)},u.fillGroupStyle=function(pe,ge){pe.style("stroke-width",0).each(function(Te){var se=g.select(this);Te[0].trace&&a(se,Te[0].trace,ge)})};var y=v("./symbol_defs");u.symbolNames=[],u.symbolFuncs=[],u.symbolBackOffs=[],u.symbolNeedLines={},u.symbolNoDot={},u.symbolNoFill={},u.symbolList=[],Object.keys(y).forEach(function(pe){var ge=y[pe],Te=ge.n;u.symbolList.push(Te,String(Te),pe,Te+100,String(Te+100),pe+"-open"),u.symbolNames[Te]=pe,u.symbolFuncs[Te]=ge.f,u.symbolBackOffs[Te]=ge.backoff||0,ge.needLine&&(u.symbolNeedLines[Te]=!0),ge.noDot?u.symbolNoDot[Te]=!0:u.symbolList.push(Te+200,String(Te+200),pe+"-dot",Te+300,String(Te+300),pe+"-open-dot"),ge.noFill&&(u.symbolNoFill[Te]=!0)});var h=u.symbolNames.length;function _(pe,ge,Te,se){return u.symbolFuncs[pe%100](ge,Te,se)+(pe>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}u.symbolNumber=function(pe){if(x(pe))pe=+pe;else if("string"==typeof pe){var ge=0;pe.indexOf("-open")>0&&(ge=100,pe=pe.replace("-open","")),pe.indexOf("-dot")>0&&(ge+=200,pe=pe.replace("-dot","")),(pe=u.symbolNames.indexOf(pe))>=0&&(pe+=ge)}return pe%100>=h||pe>=400?0:Math.floor(Math.max(pe,0))};var b={x1:1,x2:0,y1:0,y2:0},w={x1:0,x2:0,y1:1,y2:0},T=k("~f"),L={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:w},verticalreversed:{node:"linearGradient",attrs:w,reversed:!0}};u.gradient=function(pe,ge,Te,se,de,Ae){for(var Le=de.length,Me=L[se],De=new Array(Le),Oe=0;Oe<Le;Oe++)Me.reversed?De[Le-1-Oe]=[T(100*(1-de[Oe][0])),de[Oe][1]]:De[Oe]=[T(100*de[Oe][0]),de[Oe][1]];var Ie=ge._fullLayout,Qe="g"+Ie._uid+"-"+Te,Ne=Ie._defs.select(".gradients").selectAll("#"+Qe).data([se+De.join(";")],t.identity);Ne.exit().remove(),Ne.enter().append(Me.node).each(function(){var Pe=g.select(this);Me.attrs&&Pe.attr(Me.attrs),Pe.attr("id",Qe);var Re=Pe.selectAll("stop").data(De);Re.exit().remove(),Re.enter().append("stop"),Re.each(function(Ge){var tt=e(Ge[1]);g.select(this).attr({offset:Ge[0]+"%","stop-color":i.tinyRGB(tt),"stop-opacity":tt.getAlpha()})})}),pe.style(Ae,V(Qe,ge)).style(Ae+"-opacity",null),pe.classed("gradient_filled",!0)},u.pattern=function(pe,ge,Te,se,de,Ae,Le,Me,De,Oe,Ie,Qe){var Ne="legend"===ge;Me&&("overlay"===De?Ie=i.contrast(Oe=Me):(Oe=void 0,Ie=Me));var Pe,Re,Ge,tt,ct,wt,kt,gt,et,Vt=Te._fullLayout,Gt="p"+Vt._uid+"-"+se,en={},Jt=e(Ie),cn=i.tinyRGB(Jt),Rt=Qe*Jt.getAlpha();switch(de){case"/":Pe=Ae*Math.sqrt(2),Re=Ae*Math.sqrt(2),wt="path",en={d:Ge="M-"+Pe/4+","+Re/4+"l"+Pe/2+",-"+Re/2+"M0,"+Re+"L"+Pe+",0M"+Pe/4*3+","+Re/4*5+"l"+Pe/2+",-"+Re/2,opacity:Rt,stroke:cn,"stroke-width":(tt=Le*Ae)+"px"};break;case"\\":Pe=Ae*Math.sqrt(2),Re=Ae*Math.sqrt(2),wt="path",en={d:Ge="M"+Pe/4*3+",-"+Re/4+"l"+Pe/2+","+Re/2+"M0,0L"+Pe+","+Re+"M-"+Pe/4+","+Re/4*3+"l"+Pe/2+","+Re/2,opacity:Rt,stroke:cn,"stroke-width":(tt=Le*Ae)+"px"};break;case"x":Pe=Ae*Math.sqrt(2),Re=Ae*Math.sqrt(2),Ge="M-"+Pe/4+","+Re/4+"l"+Pe/2+",-"+Re/2+"M0,"+Re+"L"+Pe+",0M"+Pe/4*3+","+Re/4*5+"l"+Pe/2+",-"+Re/2+"M"+Pe/4*3+",-"+Re/4+"l"+Pe/2+","+Re/2+"M0,0L"+Pe+","+Re+"M-"+Pe/4+","+Re/4*3+"l"+Pe/2+","+Re/2,tt=Ae-Ae*Math.sqrt(1-Le),wt="path",en={d:Ge,opacity:Rt,stroke:cn,"stroke-width":tt+"px"};break;case"|":wt="path",wt="path",en={d:Ge="M"+(Pe=Ae)/2+",0L"+Pe/2+","+(Re=Ae),opacity:Rt,stroke:cn,"stroke-width":(tt=Le*Ae)+"px"};break;case"-":wt="path",wt="path",en={d:Ge="M0,"+(Re=Ae)/2+"L"+(Pe=Ae)+","+Re/2,opacity:Rt,stroke:cn,"stroke-width":(tt=Le*Ae)+"px"};break;case"+":wt="path",Ge="M"+(Pe=Ae)/2+",0L"+Pe/2+","+(Re=Ae)+"M0,"+Re/2+"L"+Pe+","+Re/2,tt=Ae-Ae*Math.sqrt(1-Le),wt="path",en={d:Ge,opacity:Rt,stroke:cn,"stroke-width":tt+"px"};break;case".":Pe=Ae,Re=Ae,Le<Math.PI/4?ct=Math.sqrt(Le*Ae*Ae/Math.PI):(kt=Le,gt=Math.PI/4,1,ct=(et=Ae/2)+(Ae/Math.sqrt(2)-et)*(kt-gt)/(1-gt)),wt="circle",en={cx:Pe/2,cy:Re/2,r:ct,opacity:Rt,fill:cn}}var je=[de||"noSh",Oe||"noBg",Ie||"noFg",Ae,Le].join(";"),Ye=Vt._defs.select(".patterns").selectAll("#"+Gt).data([je],t.identity);Ye.exit().remove(),Ye.enter().append("pattern").each(function(){var he=g.select(this);if(he.attr({id:Gt,width:Pe+"px",height:Re+"px",patternUnits:"userSpaceOnUse",patternTransform:Ne?"scale(0.8)":""}),Oe){var be=e(Oe),Fe=i.tinyRGB(be),He=be.getAlpha(),Ke=he.selectAll("rect").data([0]);Ke.exit().remove(),Ke.enter().append("rect").attr({width:Pe+"px",height:Re+"px",fill:Fe,"fill-opacity":He})}var Ze=he.selectAll(wt).data([0]);Ze.exit().remove(),Ze.enter().append(wt).attr(en)}),pe.style("fill",V(Gt,Te)).style("fill-opacity",null),pe.classed("pattern_filled",!0)},u.initGradients=function(pe){t.ensureSingle(pe._fullLayout._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),g.select(pe).selectAll(".gradient_filled").classed("gradient_filled",!1)},u.initPatterns=function(pe){t.ensureSingle(pe._fullLayout._defs,"g","patterns").selectAll("pattern").remove(),g.select(pe).selectAll(".pattern_filled").classed("pattern_filled",!1)},u.getPatternAttr=function(pe,ge,Te){return pe&&t.isArrayOrTypedArray(pe)?ge<pe.length?pe[ge]:Te:pe},u.pointStyle=function(pe,ge,Te){if(pe.size()){var se=u.makePointStyleFns(ge);pe.each(function(de){u.singlePointStyle(de,g.select(this),ge,se,Te)})}},u.singlePointStyle=function(pe,ge,Te,se,de){var Ae=Te.marker,Le=Ae.line;if(ge.style("opacity",se.selectedOpacityFn?se.selectedOpacityFn(pe):void 0===pe.mo?Ae.opacity:pe.mo),se.ms2mrc){var Me;Me="various"===pe.ms||"various"===Ae.size?3:se.ms2mrc(pe.ms),pe.mrc=Me,se.selectedSizeFn&&(Me=pe.mrc=se.selectedSizeFn(pe));var De=u.symbolNumber(pe.mx||Ae.symbol)||0;pe.om=De%200>=100;var Oe=Se(pe,Te),Ie=ee(pe,Te);ge.attr("d",_(De,Me,Oe,Ie))}var Qe,Ne,Pe,Re=!1;if(pe.so?(Pe=Le.outlierwidth,Ne=Le.outliercolor,Qe=Ae.outliercolor):(Pe=(pe.mlw+1||(Le||{}).width+1||(pe.trace?(pe.trace.marker.line||{}).width:0)+1)-1||0,Ne="mlc"in pe?pe.mlcc=se.lineScale(pe.mlc):t.isArrayOrTypedArray(Le.color)?i.defaultLine:Le.color,t.isArrayOrTypedArray(Ae.color)&&(Qe=i.defaultLine,Re=!0),Qe="mc"in pe?pe.mcc=se.markerScale(pe.mc):Ae.color||"rgba(0,0,0,0)",se.selectedColorFn&&(Qe=se.selectedColorFn(pe))),pe.om)ge.call(i.stroke,Qe).style({"stroke-width":(Pe||1)+"px",fill:"none"});else{ge.style("stroke-width",(pe.isBlank?0:Pe)+"px");var tt=Ae.gradient,ct=pe.mgt;ct?Re=!0:ct=tt&&tt.type,t.isArrayOrTypedArray(ct)&&(L[ct=ct[0]]||(ct=0));var wt=Ae.pattern,kt=wt&&u.getPatternAttr(wt.shape,pe.i,"");if(ct&&"none"!==ct){var gt=pe.mgc;gt?Re=!0:gt=tt.color;var at=Te.uid;Re&&(at+="-"+pe.i),u.gradient(ge,de,at,ct,[[0,gt],[1,Qe]],"fill")}else if(kt){var et=u.getPatternAttr(wt.bgcolor,pe.i,null),yt=u.getPatternAttr(wt.fgcolor,pe.i,null),Vt=wt.fgopacity,Gt=u.getPatternAttr(wt.size,pe.i,8),en=u.getPatternAttr(wt.solidity,pe.i,.3),Jt=pe.mcc||t.isArrayOrTypedArray(wt.shape)||t.isArrayOrTypedArray(wt.bgcolor)||t.isArrayOrTypedArray(wt.size)||t.isArrayOrTypedArray(wt.solidity),cn=Te.uid;Jt&&(cn+="-"+pe.i),u.pattern(ge,"point",de,cn,kt,Gt,en,pe.mcc,wt.fillmode,et,yt,Vt)}else i.fill(ge,Qe);Pe&&i.stroke(ge,Ne)}},u.makePointStyleFns=function(pe){var ge={},Te=pe.marker;return ge.markerScale=u.tryColorscale(Te,""),ge.lineScale=u.tryColorscale(Te,"line"),r.traceIs(pe,"symbols")&&(ge.ms2mrc=l.isBubble(pe)?o(pe):function(){return(Te.size||6)/2}),pe.selectedpoints&&t.extendFlat(ge,u.makeSelectedPointStyleFns(pe)),ge},u.makeSelectedPointStyleFns=function(pe){var ge={},de=pe.marker||{},Ae=(pe.selected||{}).marker||{},Le=(pe.unselected||{}).marker||{},De=Ae.opacity,Oe=Le.opacity,Ie=void 0!==De,Qe=void 0!==Oe;(t.isArrayOrTypedArray(de.opacity)||Ie||Qe)&&(ge.selectedOpacityFn=function(gt){var at=void 0===gt.mo?de.opacity:gt.mo;return gt.selected?Ie?De:at:Qe?Oe:f*at});var Ne=de.color,Pe=Ae.color,Re=Le.color;(Pe||Re)&&(ge.selectedColorFn=function(gt){var at=gt.mcc||Ne;return gt.selected?Pe||at:Re||at});var Ge=de.size,tt=Ae.size,ct=Le.size,wt=void 0!==tt,kt=void 0!==ct;return r.traceIs(pe,"symbols")&&(wt||kt)&&(ge.selectedSizeFn=function(gt){var at=gt.mrc||Ge/2;return gt.selected?wt?tt/2:at:kt?ct/2:at}),ge},u.makeSelectedTextStyleFns=function(pe){var ge={},Me=(pe.textfont||{}).color,De=((pe.selected||{}).textfont||{}).color,Oe=((pe.unselected||{}).textfont||{}).color;return ge.selectedTextColorFn=function(Ie){var Qe=Ie.tc||Me;return Ie.selected?De||Qe:Oe||(De?Qe:i.addOpacity(Qe,f))},ge},u.selectedPointStyle=function(pe,ge){if(pe.size()&&ge.selectedpoints){var Te=u.makeSelectedPointStyleFns(ge),se=ge.marker||{},de=[];Te.selectedOpacityFn&&de.push(function(Ae,Le){Ae.style("opacity",Te.selectedOpacityFn(Le))}),Te.selectedColorFn&&de.push(function(Ae,Le){i.fill(Ae,Te.selectedColorFn(Le))}),Te.selectedSizeFn&&de.push(function(Ae,Le){var Me=Le.mx||se.symbol||0,De=Te.selectedSizeFn(Le);Ae.attr("d",_(u.symbolNumber(Me),De,Se(Le,ge),ee(Le,ge))),Le.mrc2=De}),de.length&&pe.each(function(Ae){for(var Le=g.select(this),Me=0;Me<de.length;Me++)de[Me](Le,Ae)})}},u.tryColorscale=function(pe,ge){var Te=ge?t.nestedProperty(pe,ge).get():pe;return Te&&(Te.colorscale||Te._colorAx)&&t.isArrayOrTypedArray(Te.color)?c.makeColorScaleFuncFromTrace(Te):t.identity};var S,C,M={start:1,end:-1,middle:0,bottom:1,top:-1};function P(pe,ge,Te,se,de){var Ae=g.select(pe.node().parentNode),Le=-1!==ge.indexOf("top")?"top":-1!==ge.indexOf("bottom")?"bottom":"middle",Me=-1!==ge.indexOf("left")?"end":-1!==ge.indexOf("right")?"start":"middle",De=se?se/.8+1:0,Oe=(m.lineCount(pe)-1)*s+1,Ie=M[Me]*De,Qe=.75*Te+M[Le]*De+(M[Le]-1)*Oe*Te/2;pe.attr("text-anchor",Me),de||Ae.attr("transform",n(Ie,Qe))}function z(pe,ge){var Te=pe.ts||ge.textfont.size;return x(Te)&&Te>0?Te:0}function R(pe,ge,Te){return Te&&(pe=G(pe)),ge?j(pe[1]):D(pe[0])}function D(pe){var ge=g.round(pe,2);return S=ge,ge}function j(pe){var ge=g.round(pe,2);return C=ge,ge}function q(pe,ge,Te,se){var de=pe[0]-ge[0],Ae=pe[1]-ge[1],Le=Te[0]-ge[0],Me=Te[1]-ge[1],De=Math.pow(de*de+Ae*Ae,.25),Oe=Math.pow(Le*Le+Me*Me,.25),Ie=(Oe*Oe*de-De*De*Le)*se,Qe=(Oe*Oe*Ae-De*De*Me)*se,Ne=3*Oe*(De+Oe),Pe=3*De*(De+Oe);return[[D(ge[0]+(Ne&&Ie/Ne)),j(ge[1]+(Ne&&Qe/Ne))],[D(ge[0]-(Pe&&Ie/Pe)),j(ge[1]-(Pe&&Qe/Pe))]]}u.textPointStyle=function(pe,ge,Te){if(pe.size()){var se;if(ge.selectedpoints){var de=u.makeSelectedTextStyleFns(ge);se=de.selectedTextColorFn}var Ae=ge.texttemplate,Le=Te._fullLayout;pe.each(function(Me){var De=g.select(this),Oe=Ae?t.extractOption(Me,ge,"txt","texttemplate"):t.extractOption(Me,ge,"tx","text");if(Oe||0===Oe){if(Ae){var Ie=ge._module.formatLabels,Qe=Ie?Ie(Me,ge,Le):{},Ne={};d(Ne,ge,Me.i),Oe=t.texttemplateString(Oe,Qe,Le._d3locale,Ne,Me,ge._meta||{})}var Re=Me.tp||ge.textposition,Ge=z(Me,ge),tt=se?se(Me):Me.tc||ge.textfont.color;De.call(u.font,Me.tf||ge.textfont.family,Ge,tt).text(Oe).call(m.convertToTspans,Te).call(P,Re,Ge,Me.mrc)}else De.remove()})}},u.selectedTextStyle=function(pe,ge){if(pe.size()&&ge.selectedpoints){var Te=u.makeSelectedTextStyleFns(ge);pe.each(function(se){var de=g.select(this),Ae=Te.selectedTextColorFn(se),Le=se.tp||ge.textposition,Me=z(se,ge);i.fill(de,Ae);var De=r.traceIs(ge,"bar-like");P(de,Le,Me,se.mrc2||se.mrc,De)})}},u.smoothopen=function(pe,ge){if(pe.length<3)return"M"+pe.join("L");var Te,se="M"+pe[0],de=[];for(Te=1;Te<pe.length-1;Te++)de.push(q(pe[Te-1],pe[Te],pe[Te+1],ge));for(se+="Q"+de[0][0]+" "+pe[1],Te=2;Te<pe.length-1;Te++)se+="C"+de[Te-2][1]+" "+de[Te-1][0]+" "+pe[Te];return se+"Q"+de[pe.length-3][1]+" "+pe[pe.length-1]},u.smoothclosed=function(pe,ge){if(pe.length<3)return"M"+pe.join("L")+"Z";var Te,se="M"+pe[0],de=pe.length-1,Ae=[q(pe[de],pe[0],pe[1],ge)];for(Te=1;Te<de;Te++)Ae.push(q(pe[Te-1],pe[Te],pe[Te+1],ge));for(Ae.push(q(pe[de-1],pe[de],pe[0],ge)),Te=1;Te<=de;Te++)se+="C"+Ae[Te-1][1]+" "+Ae[Te][0]+" "+pe[Te];return se+"C"+Ae[de][1]+" "+Ae[0][0]+" "+pe[0]+"Z"};var Z={hv:function(pe,ge,Te){return"H"+D(ge[0])+"V"+R(ge,1,Te)},vh:function(pe,ge,Te){return"V"+j(ge[1])+"H"+R(ge,0,Te)},hvh:function(pe,ge,Te){return"H"+D((pe[0]+ge[0])/2)+"V"+j(ge[1])+"H"+R(ge,0,Te)},vhv:function(pe,ge,Te){return"V"+j((pe[1]+ge[1])/2)+"H"+D(ge[0])+"V"+R(ge,1,Te)}},W=function(pe,ge,Te){return"L"+R(ge,0,Te)+","+R(ge,1,Te)};function G(pe,ge){var Te=pe.backoff,se=pe.trace,de=pe.d,Ae=pe.i;if(Te&&se&&se.marker&&se.marker.angle%360==0&&se.line&&"spline"!==se.line.shape){var Le=t.isArrayOrTypedArray(Te),Me=pe,De=ge?ge[0]:S||0,Oe=ge?ge[1]:C||0,Ie=Me[0],Qe=Me[1],Re=Math.atan2(Qe-Oe,Ie-De),Ge=Le?Te[Ae]:Te;if("auto"===Ge){var tt=Me.i;"scatter"===se.type&&tt--;var ct=Me.marker;Ge=ct?u.symbolBackOffs[u.symbolNumber(ct.symbol)]*ct.size:0,Ge+=u.getMarkerStandoff(de[tt],se)||0}var wt=Ie-Ge*Math.cos(Re),kt=Qe-Ge*Math.sin(Re);(wt<=Ie&&wt>=De||wt>=Ie&&wt<=De)&&(kt<=Qe&&kt>=Oe||kt>=Qe&&kt<=Oe)&&(pe=[wt,kt])}return pe}u.steps=function(pe){var ge=Z[pe]||W;return function(Te){for(var se="M"+D(Te[0][0])+","+j(Te[0][1]),de=Te.length,Ae=1;Ae<de;Ae++)se+=ge(Te[Ae-1],Te[Ae],Ae===de-1);return se}},u.applyBackoff=G,u.makeTester=function(){var pe=t.ensureSingleById(g.select("body"),"svg","js-plotly-tester",function(Te){Te.attr(p.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),ge=t.ensureSingle(pe,"path","js-reference-point",function(Te){Te.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});u.tester=pe,u.testref=ge},u.savedBBoxes={};var X=0;function ne(pe){var ge=pe.getAttribute("data-unformatted");if(null!==ge)return ge+pe.getAttribute("data-math")+pe.getAttribute("text-anchor")+pe.getAttribute("style")}function V(pe,ge){if(!pe)return null;var Te=ge._context,se=Te._exportedPlot?"":Te._baseUrl||"";return se?"url('"+se+"#"+pe+"')":"url(#"+pe+")"}u.bBox=function(pe,ge,Te){var se,de,Ae;if(Te||(Te=ne(pe)),Te){if(se=u.savedBBoxes[Te])return t.extendFlat({},se)}else if(1===pe.childNodes.length){var Le=pe.childNodes[0];if(Te=ne(Le)){var Me=+Le.getAttribute("x")||0,De=+Le.getAttribute("y")||0,Oe=Le.getAttribute("transform");if(!Oe){var Ie=u.bBox(Le,!1,Te);return Me&&(Ie.left+=Me,Ie.right+=Me),De&&(Ie.top+=De,Ie.bottom+=De),Ie}if(se=u.savedBBoxes[Te+="~"+Me+"~"+De+"~"+Oe])return t.extendFlat({},se)}}ge?de=pe:(Ae=u.tester.node(),de=pe.cloneNode(!0),Ae.appendChild(de)),g.select(de).attr("transform",null).call(m.positionText,0,0);var Qe=de.getBoundingClientRect(),Ne=u.testref.node().getBoundingClientRect();ge||Ae.removeChild(de);var Pe={height:Qe.height,width:Qe.width,left:Qe.left-Ne.left,top:Qe.top-Ne.top,right:Qe.right-Ne.left,bottom:Qe.bottom-Ne.top};return X>=1e4&&(u.savedBBoxes={},X=0),Te&&(u.savedBBoxes[Te]=Pe),X++,t.extendFlat({},Pe)},u.setClipUrl=function(pe,ge,Te){pe.attr("clip-path",V(ge,Te))},u.getTranslate=function(pe){var ge=(pe[pe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(Te,se,de){return[se,de].join(" ")}).split(" ");return{x:+ge[0]||0,y:+ge[1]||0}},u.setTranslate=function(pe,ge,Te){var de=pe.attr?"attr":"setAttribute",Ae=pe[pe.attr?"attr":"getAttribute"]("transform")||"";return ge=ge||0,Te=Te||0,Ae=Ae.replace(/(\btranslate\(.*?\);?)/,"").trim(),Ae=(Ae+=n(ge,Te)).trim(),pe[de]("transform",Ae),Ae},u.getScale=function(pe){var ge=(pe[pe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(Te,se,de){return[se,de].join(" ")}).split(" ");return{x:+ge[0]||1,y:+ge[1]||1}},u.setScale=function(pe,ge,Te){var de=pe.attr?"attr":"setAttribute",Ae=pe[pe.attr?"attr":"getAttribute"]("transform")||"";return ge=ge||1,Te=Te||1,Ae=Ae.replace(/(\bscale\(.*?\);?)/,"").trim(),Ae=(Ae+="scale("+ge+","+Te+")").trim(),pe[de]("transform",Ae),Ae};var N=/\s*sc.*/;u.setPointGroupScale=function(pe,ge,Te){if(ge=ge||1,Te=Te||1,pe){var se=1===ge&&1===Te?"":"scale("+ge+","+Te+")";pe.each(function(){var de=(this.getAttribute("transform")||"").replace(N,"");de=(de+=se).trim(),this.setAttribute("transform",de)})}};var U=/translate\([^)]*\)\s*$/;function ee(pe,ge){var Te;return pe&&(Te=pe.mf),void 0===Te&&(Te=ge.marker&&ge.marker.standoff||0),ge._geo||ge._xA?Te:-Te}u.setTextPointsScale=function(pe,ge,Te){pe&&pe.each(function(){var se,de=g.select(this),Ae=de.select("text");if(Ae.node()){var Le=parseFloat(Ae.attr("x")||0),Me=parseFloat(Ae.attr("y")||0),De=(de.attr("transform")||"").match(U);se=1===ge&&1===Te?[]:[n(Le,Me),"scale("+ge+","+Te+")",n(-Le,-Me)],De&&se.push(De),de.attr("transform",se.join(""))}})},u.getMarkerStandoff=ee;var B,K,J,te,ae,ce,oe=Math.atan2,ve=Math.cos,fe=Math.sin;function xe(pe,ge){var Te=ge[0],se=ge[1];return[Te*ve(pe)-se*fe(pe),Te*fe(pe)+se*ve(pe)]}function Se(pe,ge){var Te,se,de=pe.ma;void 0===de&&(de=ge.marker.angle||0);var Ae=ge.marker.angleref;if("previous"===Ae||"north"===Ae){if(ge._geo){var Le=ge._geo.project(pe.lonlat);Te=Le[0],se=Le[1]}else{var Me=ge._xA,De=ge._yA;if(!Me||!De)return 90;Te=Me.c2p(pe.x),se=De.c2p(pe.y)}if(ge._geo){var Oe,Ie=pe.lonlat[0],Qe=pe.lonlat[1],Ne=ge._geo.project([Ie,Qe+1e-5]),Pe=ge._geo.project([Ie+1e-5,Qe]),Re=oe(Pe[1]-se,Pe[0]-Te),Ge=oe(Ne[1]-se,Ne[0]-Te);if("north"===Ae)Oe=de/180*Math.PI;else if("previous"===Ae){var tt=Ie/180*Math.PI,ct=Qe/180*Math.PI,wt=B/180*Math.PI,kt=K/180*Math.PI,gt=wt-tt,at=ve(kt)*fe(gt),et=fe(kt)*ve(ct)-ve(kt)*fe(ct)*ve(gt);Oe=-oe(at,et)-Math.PI,B=Ie,K=Qe}var yt=xe(Re,[ve(Oe),0]),Vt=xe(Ge,[fe(Oe),0]);de=oe(yt[1]+Vt[1],yt[0]+Vt[0])/Math.PI*180,"previous"!==Ae||ce===ge.uid&&pe.i===ae+1||(de=null)}if("previous"===Ae&&!ge._geo)if(ce===ge.uid&&pe.i===ae+1&&x(Te)&&x(se)){var Gt=Te-J,en=se-te,Jt=ge.line&&ge.line.shape||"",cn=Jt.slice(Jt.length-1);"h"===cn&&(en=0),"v"===cn&&(Gt=0),de+=oe(en,Gt)/Math.PI*180+90}else de=null}return J=Te,te=se,ae=pe.i,ce=ge.uid,de}u.getMarkerAngle=Se},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(v,Q,$){"use strict";var g,t,k,x,e=v("parse-svg-path"),r=v("@plotly/d3").round,i=Math.sqrt(2),c=Math.sqrt(3),n=Math.PI,m=Math.cos,p=Math.sin;function s(l){return null===l}function f(l,o,d){if(!(l&&l%360!=0||o))return d;if(k===l&&x===o&&g===d)return t;function u(C,R){var D=m(C),j=p(C),q=R[0],Z=R[1]+(o||0);return[q*D-Z*j,q*j+Z*D]}k=l,x=o,g=d;for(var a=l/180*n,y=0,h=0,_=e(d),b="",w=0;w<_.length;w++){var T=_[w],L=T[0],M=y,P=h;if("M"===L||"L"===L)y=+T[1],h=+T[2];else if("m"===L||"l"===L)y+=+T[1],h+=+T[2];else if("H"===L)y=+T[1];else if("h"===L)y+=+T[1];else if("V"===L)h=+T[1];else if("v"===L)h+=+T[1];else if("A"===L){y=+T[1],h=+T[2];var z=u(a,[+T[6],+T[7]]);T[6]=z[0],T[7]=z[1],T[3]=+T[3]+l}"H"!==L&&"V"!==L||(L="L"),"h"!==L&&"v"!==L||(L="l"),"m"!==L&&"l"!==L||(y-=M,h-=P);var S=u(a,[y,h]);"H"!==L&&"V"!==L||(L="L"),"M"!==L&&"L"!==L&&"m"!==L&&"l"!==L||(T[1]=S[0],T[2]=S[1]),T[0]=L,b+=T[0]+T.slice(1).join(",")}return t=b,b}Q.exports={circle:{n:0,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2),a="M"+u+",0A"+u+","+u+" 0 1,1 0,-"+u+"A"+u+","+u+" 0 0,1 "+u+",0Z";return d?f(o,d,a):a}},square:{n:1,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+","+u+"H-"+u+"V-"+u+"H"+u+"Z")}},diamond:{n:2,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.3*l,2);return f(o,d,"M"+u+",0L0,"+u+"L-"+u+",0L0,-"+u+"Z")}},cross:{n:3,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.4*l,2),a=r(1.2*l,2);return f(o,d,"M"+a+","+u+"H"+u+"V"+a+"H-"+u+"V"+u+"H-"+a+"V-"+u+"H-"+u+"V-"+a+"H"+u+"V-"+u+"H"+a+"Z")}},x:{n:4,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.8*l/i,2),a="l"+u+","+u,y="l"+u+",-"+u,h="l-"+u+",-"+u,_="l-"+u+","+u;return f(o,d,"M0,"+u+a+y+h+y+h+_+h+_+a+_+a+"Z")}},"triangle-up":{n:5,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l/c,2);return f(o,d,"M-"+u+","+r(l/2,2)+"H"+u+"L0,-"+r(l,2)+"Z")}},"triangle-down":{n:6,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l/c,2);return f(o,d,"M-"+u+",-"+r(l/2,2)+"H"+u+"L0,"+r(l,2)+"Z")}},"triangle-left":{n:7,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l/c,2);return f(o,d,"M"+r(l/2,2)+",-"+u+"V"+u+"L-"+r(l,2)+",0Z")}},"triangle-right":{n:8,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l/c,2);return f(o,d,"M-"+r(l/2,2)+",-"+u+"V"+u+"L"+r(l,2)+",0Z")}},"triangle-ne":{n:9,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.6*l,2),a=r(1.2*l,2);return f(o,d,"M-"+a+",-"+u+"H"+u+"V"+a+"Z")}},"triangle-se":{n:10,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.6*l,2),a=r(1.2*l,2);return f(o,d,"M"+u+",-"+a+"V"+u+"H-"+a+"Z")}},"triangle-sw":{n:11,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.6*l,2),a=r(1.2*l,2);return f(o,d,"M"+a+","+u+"H-"+u+"V-"+a+"Z")}},"triangle-nw":{n:12,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.6*l,2),a=r(1.2*l,2);return f(o,d,"M-"+u+","+a+"V-"+u+"H"+a+"Z")}},pentagon:{n:13,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.951*l,2),a=r(.588*l,2),y=r(-l,2),h=r(-.309*l,2);return f(o,d,"M"+u+","+h+"L"+a+","+r(.809*l,2)+"H-"+a+"L-"+u+","+h+"L0,"+y+"Z")}},hexagon:{n:14,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2),a=r(l/2,2),y=r(l*c/2,2);return f(o,d,"M"+y+",-"+a+"V"+a+"L0,"+u+"L-"+y+","+a+"V-"+a+"L0,-"+u+"Z")}},hexagon2:{n:15,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2),a=r(l/2,2),y=r(l*c/2,2);return f(o,d,"M-"+a+","+y+"H"+a+"L"+u+",0L"+a+",-"+y+"H-"+a+"L-"+u+",0Z")}},octagon:{n:16,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.924*l,2),a=r(.383*l,2);return f(o,d,"M-"+a+",-"+u+"H"+a+"L"+u+",-"+a+"V"+a+"L"+a+","+u+"H-"+a+"L-"+u+","+a+"V-"+a+"Z")}},star:{n:17,f:function(l,o,d){if(s(o))return"M0,0Z";var u=1.4*l,a=r(.225*u,2),y=r(.951*u,2),h=r(.363*u,2),_=r(.588*u,2),b=r(-u,2),w=r(-.309*u,2),T=r(.118*u,2),L=r(.809*u,2);return f(o,d,"M"+a+","+w+"H"+y+"L"+h+","+T+"L"+_+","+L+"L0,"+r(.382*u,2)+"L-"+_+","+L+"L-"+h+","+T+"L-"+y+","+w+"H-"+a+"L0,"+b+"Z")}},hexagram:{n:18,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.66*l,2),a=r(.38*l,2),y=r(.76*l,2);return f(o,d,"M-"+y+",0l-"+a+",-"+u+"h"+y+"l"+a+",-"+u+"l"+a+","+u+"h"+y+"l-"+a+","+u+"l"+a+","+u+"h-"+y+"l-"+a+","+u+"l-"+a+",-"+u+"h-"+y+"Z")}},"star-triangle-up":{n:19,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l*c*.8,2),a=r(.8*l,2),y=r(1.6*l,2),h=r(4*l,2),_="A "+h+","+h+" 0 0 1 ";return f(o,d,"M-"+u+","+a+_+u+","+a+_+"0,-"+y+_+"-"+u+","+a+"Z")}},"star-triangle-down":{n:20,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l*c*.8,2),a=r(.8*l,2),y=r(1.6*l,2),h=r(4*l,2),_="A "+h+","+h+" 0 0 1 ";return f(o,d,"M"+u+",-"+a+_+"-"+u+",-"+a+_+"0,"+y+_+u+",-"+a+"Z")}},"star-square":{n:21,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.1*l,2),a=r(2*l,2),y="A "+a+","+a+" 0 0 1 ";return f(o,d,"M-"+u+",-"+u+y+"-"+u+","+u+y+u+","+u+y+u+",-"+u+y+"-"+u+",-"+u+"Z")}},"star-diamond":{n:22,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.4*l,2),a=r(1.9*l,2),y="A "+a+","+a+" 0 0 1 ";return f(o,d,"M-"+u+",0"+y+"0,"+u+y+u+",0"+y+"0,-"+u+y+"-"+u+",0Z")}},"diamond-tall":{n:23,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(.7*l,2),a=r(1.4*l,2);return f(o,d,"M0,"+a+"L"+u+",0L0,-"+a+"L-"+u+",0Z")}},"diamond-wide":{n:24,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.4*l,2),a=r(.7*l,2);return f(o,d,"M0,"+a+"L"+u+",0L0,-"+a+"L-"+u+",0Z")}},hourglass:{n:25,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+","+u+"H-"+u+"L"+u+",-"+u+"H-"+u+"Z")},noDot:!0},bowtie:{n:26,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+","+u+"V-"+u+"L-"+u+","+u+"V-"+u+"Z")},noDot:!0},"circle-cross":{n:27,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M0,"+u+"V-"+u+"M"+u+",0H-"+u+"M"+u+",0A"+u+","+u+" 0 1,1 0,-"+u+"A"+u+","+u+" 0 0,1 "+u+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2),a=r(l/i,2);return f(o,d,"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a+"M"+u+",0A"+u+","+u+" 0 1,1 0,-"+u+"A"+u+","+u+" 0 0,1 "+u+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M0,"+u+"V-"+u+"M"+u+",0H-"+u+"M"+u+","+u+"H-"+u+"V-"+u+"H"+u+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+","+u+"L-"+u+",-"+u+"M"+u+",-"+u+"L-"+u+","+u+"M"+u+","+u+"H-"+u+"V-"+u+"H"+u+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.3*l,2);return f(o,d,"M"+u+",0L0,"+u+"L-"+u+",0L0,-"+u+"ZM0,-"+u+"V"+u+"M-"+u+",0H"+u)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.3*l,2),a=r(.65*l,2);return f(o,d,"M"+u+",0L0,"+u+"L-"+u+",0L0,-"+u+"ZM-"+a+",-"+a+"L"+a+","+a+"M-"+a+","+a+"L"+a+",-"+a)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.4*l,2);return f(o,d,"M0,"+u+"V-"+u+"M"+u+",0H-"+u)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+","+u+"L-"+u+",-"+u+"M"+u+",-"+u+"L-"+u+","+u)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.2*l,2),a=r(.85*l,2);return f(o,d,"M0,"+u+"V-"+u+"M"+u+",0H-"+u+"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l/2,2),a=r(l,2);return f(o,d,"M"+u+","+a+"V-"+a+"M"+(u-a)+",-"+a+"V"+a+"M"+a+","+u+"H-"+a+"M-"+a+","+(u-a)+"H"+a)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.2*l,2),a=r(1.6*l,2),y=r(.8*l,2);return f(o,d,"M-"+u+","+y+"L0,0M"+u+","+y+"L0,0M0,-"+a+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.2*l,2),a=r(1.6*l,2),y=r(.8*l,2);return f(o,d,"M-"+u+",-"+y+"L0,0M"+u+",-"+y+"L0,0M0,"+a+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.2*l,2),a=r(1.6*l,2),y=r(.8*l,2);return f(o,d,"M"+y+","+u+"L0,0M"+y+",-"+u+"L0,0M-"+a+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.2*l,2),a=r(1.6*l,2),y=r(.8*l,2);return f(o,d,"M-"+y+","+u+"L0,0M-"+y+",-"+u+"L0,0M"+a+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.4*l,2);return f(o,d,"M"+u+",0H-"+u)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(1.4*l,2);return f(o,d,"M0,"+u+"V-"+u)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+",-"+u+"L-"+u+","+u)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M"+u+","+u+"L-"+u+",-"+u)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M0,0L-"+u+","+r(2*l,2)+"H"+u+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M0,0L-"+u+",-"+r(2*l,2)+"H"+u+"Z")},noDot:!0},"arrow-left":{n:47,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l,2),a=r(l,2);return f(o,d,"M0,0L"+u+",-"+a+"V"+a+"Z")},noDot:!0},"arrow-right":{n:48,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l,2),a=r(l,2);return f(o,d,"M0,0L-"+u+",-"+a+"V"+a+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M-"+u+",0H"+u+"M0,0L-"+u+","+r(2*l,2)+"H"+u+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(l,2);return f(o,d,"M-"+u+",0H"+u+"M0,0L-"+u+",-"+r(2*l,2)+"H"+u+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l,2),a=r(l,2);return f(o,d,"M0,-"+a+"V"+a+"M0,0L"+u+",-"+a+"V"+a+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(l,o,d){if(s(o))return"M0,0Z";var u=r(2*l,2),a=r(l,2);return f(o,d,"M0,-"+a+"V"+a+"M0,0L-"+u+",-"+a+"V"+a+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(l,o,d){if(s(o))return"M0,0Z";var u=n/2.5,a=2*l*m(u),y=2*l*p(u);return f(o,d,"M0,0L"+-a+","+y+"L"+a+","+y+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(l,o,d){if(s(o))return"M0,0Z";var u=n/4,a=2*l*m(u),y=2*l*p(u);return f(o,d,"M0,0L"+-a+","+y+"A "+2*l+","+2*l+" 0 0 1 "+a+","+y+"Z")},backoff:.4,noDot:!0}}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(v,Q,$){"use strict";Q.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../registry"),k=v("../../plots/cartesian/axes"),x=v("../../lib"),e=v("./compute_error");function r(i,c,n,m){var p=c["error_"+m]||{},s=[];if(p.visible&&-1!==["linear","log"].indexOf(n.type)){for(var f=e(p),l=0;l<i.length;l++){var o=i[l],d=o.i;if(void 0===d)d=l;else if(null===d)continue;var u=o[m];if(g(n.c2l(u))){var a=f(u,d);if(g(a[0])&&g(a[1])){var y=o[m+"s"]=u-a[0],h=o[m+"h"]=u+a[1];s.push(y,h)}}}var b=c._extremes[n._id],w=k.findExtremes(n,s,x.extendFlat({tozero:b.opts.tozero},{padded:!0}));b.min=b.min.concat(w.min),b.max=b.max.concat(w.max)}}Q.exports=function(i){for(var c=i.calcdata,n=0;n<c.length;n++){var m=c[n],p=m[0].trace;if(!0===p.visible&&t.traceIs(p,"errorBarsOK")){var s=k.getFromId(i,p.xaxis),f=k.getFromId(i,p.yaxis);r(m,p,s,"x"),r(m,p,f,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(v,Q,$){"use strict";function g(t,k){return"percent"===t?function(x){return Math.abs(x*k/100)}:"constant"===t?function(){return Math.abs(k)}:"sqrt"===t?function(x){return Math.sqrt(Math.abs(x))}:void 0}Q.exports=function(t){var k=t.type,x=t.symmetric;if("data"===k){var e=t.array||[];if(x)return function(n,m){var p=+e[m];return[p,p]};var r=t.arrayminus||[];return function(n,m){var p=+e[m],s=+r[m];return isNaN(p)&&isNaN(s)?[NaN,NaN]:[s||0,p||0]}}var i=g(k,t.value),c=g(k,t.valueminus);return x||void 0===t.valueminus?function(n){var m=i(n);return[m,m]}:function(n){return[c(n),i(n)]}}},{}],394:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../registry"),k=v("../../lib"),x=v("../../plot_api/plot_template"),e=v("./attributes");Q.exports=function(r,i,c,n){var m="error_"+n.axis,p=x.newContainer(i,m),s=r[m]||{};function f(u,a){return k.coerce(s,p,e,u,a)}if(!1!==f("visible",void 0!==s.array||void 0!==s.value||"sqrt"===s.type)){var l=f("type","array"in s?"data":"percent"),o=!0;"sqrt"!==l&&(o=f("symmetric",!(("data"===l?"arrayminus":"valueminus")in s))),"data"===l?(f("array"),f("traceref"),o||(f("arrayminus"),f("tracerefminus"))):"percent"!==l&&"constant"!==l||(f("value"),o||f("valueminus"));var d="copy_"+n.inherit+"style";n.inherit&&(i["error_"+n.inherit]||{}).visible&&f(d,!(s.color||g(s.thickness)||g(s.width))),n.inherit&&p[d]||(f("color",c),f("thickness"),f("width",t.traceIs(i,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plot_api/edit_types").overrideAll,k=v("./attributes"),x={error_x:g.extendFlat({},k),error_y:g.extendFlat({},k)};delete x.error_x.copy_zstyle,delete x.error_y.copy_zstyle,delete x.error_y.copy_ystyle;var e={error_x:g.extendFlat({},k),error_y:g.extendFlat({},k),error_z:g.extendFlat({},k)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,Q.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:x,bar:x,histogram:x,scatter3d:t(e,"calc","nested"),scattergl:t(x,"calc","nested")}},supplyDefaults:v("./defaults"),calc:v("./calc"),makeComputeError:v("./compute_error"),plot:v("./plot"),style:v("./style"),hoverInfo:function(r,i,c){(i.error_y||{}).visible&&(c.yerr=r.yh-r.y,i.error_y.symmetric||(c.yerrneg=r.y-r.ys)),(i.error_x||{}).visible&&(c.xerr=r.xh-r.x,i.error_x.symmetric||(c.xerrneg=r.x-r.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../drawing"),x=v("../../traces/scatter/subtypes");Q.exports=function(e,r,i,c){var n=i.xaxis,m=i.yaxis,p=c&&c.duration>0;r.each(function(s){var f,l=s[0].trace,o=l.error_x||{},d=l.error_y||{};l.ids&&(f=function(h){return h.id});var u=x.hasMarkers(l)&&l.marker.maxdisplayed>0;d.visible||o.visible||(s=[]);var a=g.select(this).selectAll("g.errorbar").data(s,f);if(a.exit().remove(),s.length){o.visible||a.selectAll("path.xerror").remove(),d.visible||a.selectAll("path.yerror").remove(),a.style("opacity",1);var y=a.enter().append("g").classed("errorbar",!0);p&&y.style("opacity",0).transition().duration(c.duration).style("opacity",1),k.setClipUrl(a,i.layerClipId,e),a.each(function(h){var z,S,C,R,_=g.select(this),b=(C=m,R={x:(S=n).c2p((z=h).x),y:C.c2p(z.y)},void 0!==z.yh&&(R.yh=C.c2p(z.yh),R.ys=C.c2p(z.ys),t(R.ys)||(R.noYS=!0,R.ys=C.c2p(z.ys,!0))),void 0!==z.xh&&(R.xh=S.c2p(z.xh),R.xs=S.c2p(z.xs),t(R.xs)||(R.noXS=!0,R.xs=S.c2p(z.xs,!0))),R);if(!u||h.vis){var w,T=_.select("path.yerror");if(d.visible&&t(b.x)&&t(b.yh)&&t(b.ys)){var L=d.width;w="M"+(b.x-L)+","+b.yh+"h"+2*L+"m-"+L+",0V"+b.ys,b.noYS||(w+="m-"+L+",0h"+2*L),T.size()?p&&(T=T.transition().duration(c.duration).ease(c.easing)):T=_.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),T.attr("d",w)}else T.remove();var M=_.select("path.xerror");if(o.visible&&t(b.y)&&t(b.xh)&&t(b.xs)){var P=(o.copy_ystyle?d:o).width;w="M"+b.xh+","+(b.y-P)+"v"+2*P+"m0,-"+P+"H"+b.xs,b.noXS||(w+="m0,-"+P+"v"+2*P),M.size()?p&&(M=M.transition().duration(c.duration).ease(c.easing)):M=_.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),M.attr("d",w)}else M.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../color");Q.exports=function(k){k.each(function(x){var e=x[0].trace,r=e.error_y||{},i=e.error_x||{},c=g.select(this);c.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(t.stroke,r.color),i.copy_ystyle&&(i=r),c.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(t.stroke,i.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("./layout_attributes").hoverlabel,k=v("../../lib/extend").extendFlat;Q.exports={hoverlabel:{bgcolor:k({},t.bgcolor,{arrayOk:!0}),bordercolor:k({},t.bordercolor,{arrayOk:!0}),font:g({arrayOk:!0,editType:"none"}),align:k({},t.align,{arrayOk:!0}),namelength:k({},t.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry");function k(x,e,r,i){i=i||g.identity,Array.isArray(x)&&(e[0][r]=i(x))}Q.exports=function(x){var e=x.calcdata,r=x._fullLayout;function i(s){return function(f){return g.coerceHoverinfo({hoverinfo:f},{_module:s._module},r)}}for(var c=0;c<e.length;c++){var n=e[c],m=n[0].trace;if(!t.traceIs(m,"pie-like")){var p=t.traceIs(m,"2dMap")?k:g.fillArray;p(m.hoverinfo,n,"hi",i(m)),m.hovertemplate&&p(m.hovertemplate,n,"ht"),m.hoverlabel&&(p(m.hoverlabel.bgcolor,n,"hbg"),p(m.hoverlabel.bordercolor,n,"hbc"),p(m.hoverlabel.font.size,n,"hts"),p(m.hoverlabel.font.color,n,"htc"),p(m.hoverlabel.font.family,n,"htf"),p(m.hoverlabel.namelength,n,"hnl"),p(m.hoverlabel.align,n,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("./hover").hover;Q.exports=function(k,x,e){var r=g.getComponentMethod("annotations","onClick")(k,k._hoverdata);function i(){k.emit("plotly_click",{points:k._hoverdata,event:x})}void 0!==e&&t(k,x,e,!0),k._hoverdata&&x&&x.target&&(r&&r.then?r.then(i):i(),x.stopImmediatePropagation&&x.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(v,Q,$){"use strict";Q.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("./hoverlabel_defaults");Q.exports=function(x,e,r,i){var c=g.extendFlat({},i.hoverlabel);e.hovertemplate&&(c.namelength=-1),k(x,e,function(n,m){return g.coerce(x,e,t,n,m)},c)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(v,Q,$){"use strict";var g=v("../../lib");$.getSubplot=function(i){return i.subplot||i.xaxis+i.yaxis||i.geo},$.isTraceInSubplots=function(i,c){if("splom"===i.type){for(var n=i.xaxes||[],m=i.yaxes||[],p=0;p<n.length;p++)for(var s=0;s<m.length;s++)if(-1!==c.indexOf(n[p]+m[s]))return!0;return!1}return-1!==c.indexOf($.getSubplot(i))},$.flat=function(i,c){for(var n=new Array(i.length),m=0;m<i.length;m++)n[m]=c;return n},$.p2c=function(i,c){for(var n=new Array(i.length),m=0;m<i.length;m++)n[m]=i[m].p2c(c);return n},$.getDistanceFunction=function(i,c,n,m){return"closest"===i?m||$.quadrature(c,n):"x"===i.charAt(0)?c:n},$.getClosest=function(i,c,n){if(!1!==n.index)n.index>=0&&n.index<i.length?n.distance=0:n.index=!1;else for(var m=0;m<i.length;m++){var p=c(i[m]);p<=n.distance&&(n.index=m,n.distance=p)}return n},$.inbox=function(i,c,n){return i*c<0||0===i?n:1/0},$.quadrature=function(i,c){return function(n){var m=i(n),p=c(n);return Math.sqrt(m*m+p*p)}},$.makeEventData=function(i,c,n){var m="index"in i?i.index:i.pointNumber,p={data:c._input,fullData:c,curveNumber:c.index,pointNumber:m};if(c._indexToPoints){var s=c._indexToPoints[m];1===s.length?p.pointIndex=s[0]:p.pointIndices=s}else p.pointIndex=m;return c._module.eventData?p=c._module.eventData(p,i,c,n,m):("xVal"in i?p.x=i.xVal:"x"in i&&(p.x=i.x),"yVal"in i?p.y=i.yVal:"y"in i&&(p.y=i.y),i.xa&&(p.xaxis=i.xa),i.ya&&(p.yaxis=i.ya),void 0!==i.zLabelVal&&(p.z=i.zLabelVal)),$.appendArrayPointValue(p,c,m),p},$.appendArrayPointValue=function(i,c,n){var m=c._arrayAttrs;if(m)for(var p=0;p<m.length;p++){var s=m[p],f=k(s);if(void 0===i[f]){var l=x(g.nestedProperty(c,s).get(),n);void 0!==l&&(i[f]=l)}}},$.appendArrayMultiPointValues=function(i,c,n){var m=c._arrayAttrs;if(m)for(var p=0;p<m.length;p++){var s=m[p],f=k(s);if(void 0===i[f]){for(var l=g.nestedProperty(c,s).get(),o=new Array(n.length),d=0;d<n.length;d++)o[d]=x(l,n[d]);i[f]=o}}};var t={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function k(i){return t[i]||i}function x(i,c){return Array.isArray(c)?Array.isArray(i)&&Array.isArray(i[c[0]])?i[c[0]][c[1]]:void 0:i[c]}var e={x:!0,y:!0},r={"x unified":!0,"y unified":!0};$.isUnifiedHover=function(i){return"string"==typeof i&&!!r[i]},$.isXYhover=function(i){return"string"==typeof i&&!!e[i]}},{"../../lib":515}],404:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("tinycolor2"),x=v("../../lib"),e=x.strTranslate,r=x.strRotate,i=v("../../lib/events"),c=v("../../lib/svg_text_utils"),n=v("../../lib/override_cursor"),m=v("../drawing"),p=v("../color"),s=v("../dragelement"),f=v("../../plots/cartesian/axes"),l=v("../../registry"),o=v("./helpers"),d=v("./constants"),u=v("../legend/defaults"),a=v("../legend/draw"),y=d.YANGLE,h=Math.PI*y/180,_=1/Math.sin(h),b=Math.cos(h),w=Math.sin(h),T=d.HOVERARROWSIZE,L=d.HOVERTEXTPAD,M={box:!0,ohlc:!0,violin:!0,candlestick:!0},P={scatter:!0,scattergl:!0,splom:!0};function z(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}$.hover=function(N,U,ee,B){N=x.getGraphDiv(N);var K=U.target;x.throttle(N._fullLayout._uid+d.HOVERID,d.HOVERMINTIME,function(){!function(J,te,ae,ce,oe){ae||(ae="xy");var ve=Array.isArray(ae)?ae:[ae],fe=J._fullLayout,xe=fe._plots||[],Se=xe[ae],pe=fe._has("cartesian");if(Se){var ge=Se.overlays.map(function(Yn){return Yn.id});ve=ve.concat(ge)}for(var Te=ve.length,se=new Array(Te),de=new Array(Te),Ae=!1,Le=0;Le<Te;Le++){var Me=ve[Le];if(xe[Me])Ae=!0,se[Le]=xe[Me].xaxis,de[Le]=xe[Me].yaxis;else{if(!fe[Me]||!fe[Me]._subplot)return void x.warn("Unrecognized subplot: "+Me);var De=fe[Me]._subplot;se[Le]=De.xaxis,de[Le]=De.yaxis}}var Oe=te.hovermode||fe.hovermode;if(Oe&&!Ae&&(Oe="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(Oe)||!J.calcdata||J.querySelector(".zoombox")||J._dragging)return s.unhoverRaw(J,te);var Ie=fe.hoverdistance;-1===Ie&&(Ie=1/0);var Qe=fe.spikedistance;-1===Qe&&(Qe=1/0);var Ne,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et,yt,Vt,Gt=[],en=[],Jt={hLinePoint:null,vLinePoint:null},cn=!1;if(Array.isArray(te))for(Oe="array",Re=0;Re<te.length;Re++)(tt=J.calcdata[te[Re].curveNumber||0])&&(ct=tt[0].trace,"skip"!==tt[0].trace.hoverinfo&&(en.push(tt),"h"===ct.orientation&&(cn=!0)));else{for(Ge=0;Ge<J.calcdata.length;Ge++)"skip"!==(ct=(tt=J.calcdata[Ge])[0].trace).hoverinfo&&o.isTraceInSubplots(ct,ve)&&(en.push(tt),"h"===ct.orientation&&(cn=!0));var Rt,je;if(oe){if(!1===i.triggerHandler(J,"plotly_beforehover",te))return;var Ye=oe.getBoundingClientRect();Rt=te.clientX-Ye.left,je=te.clientY-Ye.top,fe._calcInverseTransform(J);var he=x.apply3DTransform(fe._invTransform)(Rt,je);if(je=he[1],(Rt=he[0])<0||Rt>se[0]._length||je<0||je>de[0]._length)return s.unhoverRaw(J,te)}else Rt="xpx"in te?te.xpx:se[0]._length/2,je="ypx"in te?te.ypx:de[0]._length/2;if(te.pointerX=Rt+se[0]._offset,te.pointerY=je+de[0]._offset,Ne="xval"in te?o.flat(ve,te.xval):o.p2c(se,Rt),Pe="yval"in te?o.flat(ve,te.yval):o.p2c(de,je),!t(Ne[0])||!t(Pe[0]))return x.warn("Fx.hover failed",te,J),s.unhoverRaw(J,te)}var be=1/0;function Fe(Yn,ar){for(Ge=0;Ge<en.length;Ge++)if((tt=en[Ge])&&tt[0]&&tt[0].trace&&!0===(ct=tt[0].trace).visible&&0!==ct._length&&-1===["carpet","contourcarpet"].indexOf(ct._module.name)){if("splom"===ct.type?wt=ve[kt=0]:(wt=o.getSubplot(ct),kt=ve.indexOf(wt)),o.isUnifiedHover(gt=Oe)&&(gt=gt.charAt(0)),yt={cd:tt,trace:ct,xa:se[kt],ya:de[kt],maxHoverDistance:Ie,maxSpikeDistance:Qe,index:!1,distance:Math.min(be,Ie),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:p.defaultLine,name:ct.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},fe[wt]&&(yt.subplot=fe[wt]._subplot),fe._splomScenes&&fe._splomScenes[ct.uid]&&(yt.scene=fe._splomScenes[ct.uid]),Vt=Gt.length,"array"===gt){var Ar=te[Ge];"pointNumber"in Ar?(yt.index=Ar.pointNumber,gt="closest"):(gt="","xval"in Ar&&(at=Ar.xval,gt="x"),"yval"in Ar&&(et=Ar.yval,gt=gt?"closest":"y"))}else void 0!==Yn&&void 0!==ar?(at=Yn,et=ar):(at=Ne[kt],et=Pe[kt]);if(0!==Ie)if(ct._module&&ct._module.hoverPoints){var sr=ct._module.hoverPoints(yt,at,et,gt,{finiteRange:!0,hoverLayer:fe._hoverlayer});if(sr)for(var dr,$r=0;$r<sr.length;$r++)t((dr=sr[$r]).x0)&&t(dr.y0)&&Gt.push(j(dr,Oe))}else x.log("Unrecognized trace type in hover:",ct);if("closest"===Oe&&Gt.length>Vt&&(Gt.splice(0,Vt),be=Gt[0].distance),pe&&0!==Qe&&0===Gt.length){yt.distance=Qe,yt.index=!1;var Lr=ct._module.hoverPoints(yt,at,et,"closest",{hoverLayer:fe._hoverlayer});if(Lr&&(Lr=Lr.filter(function(hn){return hn.spikeDistance<=Qe})),Lr&&Lr.length){var jr,ri=Lr.filter(function(hn){return hn.xa.showspikes&&"hovered data"!==hn.xa.spikesnap});if(ri.length){var sn=ri[0];t(sn.x0)&&t(sn.y0)&&(jr=Ke(sn),(!Jt.vLinePoint||Jt.vLinePoint.spikeDistance>jr.spikeDistance)&&(Jt.vLinePoint=jr))}var wn=Lr.filter(function(hn){return hn.ya.showspikes&&"hovered data"!==hn.ya.spikesnap});if(wn.length){var It=wn[0];t(It.x0)&&t(It.y0)&&(jr=Ke(It),(!Jt.hLinePoint||Jt.hLinePoint.spikeDistance>jr.spikeDistance)&&(Jt.hLinePoint=jr))}}}}}function He(Yn,ar,Ar){for(var sr,dr=null,$r=1/0,Lr=0;Lr<Yn.length;Lr++)sr=Yn[Lr].spikeDistance,Ar&&0===Lr&&(sr=-1/0),sr<=$r&&sr<=ar&&(dr=Yn[Lr],$r=sr);return dr}function Ke(Yn){return Yn?{xa:Yn.xa,ya:Yn.ya,x:void 0!==Yn.xSpike?Yn.xSpike:(Yn.x0+Yn.x1)/2,y:void 0!==Yn.ySpike?Yn.ySpike:(Yn.y0+Yn.y1)/2,distance:Yn.distance,spikeDistance:Yn.spikeDistance,curveNumber:Yn.trace.index,color:Yn.color,pointNumber:Yn.index}:null}Fe();var Ze={fullLayout:fe,container:fe._hoverlayer,event:te},ut=J._spikepoints;J._spikepoints={vLinePoint:Jt.vLinePoint,hLinePoint:Jt.hLinePoint};var Lt=function(){Gt.sort(function(Yn,ar){return Yn.distance-ar.distance}),Gt=function(Yn,ar){for(var Ar=ar.charAt(0),sr=[],dr=[],$r=[],Lr=0;Lr<Yn.length;Lr++){var jr=Yn[Lr];l.traceIs(jr.trace,"bar-like")||l.traceIs(jr.trace,"box-violin")?$r.push(jr):jr.trace[Ar+"period"]?dr.push(jr):sr.push(jr)}return sr.concat(dr).concat($r)}(Gt,Oe)};Lt();var Ot=Oe.charAt(0),ot=("x"===Ot||"y"===Ot)&&Gt[0]&&P[Gt[0].trace.type];if(pe&&0!==Qe&&0!==Gt.length){var pt=He(Gt.filter(function(Yn){return Yn.ya.showspikes}),Qe,ot);Jt.hLinePoint=Ke(pt);var qt=He(Gt.filter(function(Yn){return Yn.xa.showspikes}),Qe,ot);Jt.vLinePoint=Ke(qt)}if(0===Gt.length){var St=s.unhoverRaw(J,te);return!pe||null===Jt.hLinePoint&&null===Jt.vLinePoint||Z(ut)&&q(J,Jt,Ze),St}if(pe&&Z(ut)&&q(J,Jt,Ze),o.isXYhover(gt)&&0!==Gt[0].length&&"splom"!==Gt[0].trace.type){var Mt=Gt[0],Ce=(Gt=M[Mt.trace.type]?Gt.filter(function(Yn){return Yn.trace.index===Mt.trace.index}):[Mt]).length;Fe(G("x",Mt,fe),G("y",Mt,fe));var dt,zt=[],Ht={},Kt=0,Zt=function(Yn){var ar=M[Yn.trace.type]?z(Yn):Yn.trace.index;if(Ht[ar]){var Ar=Ht[ar]-1,sr=zt[Ar];Ar>0&&Math.abs(Yn.distance)<Math.abs(sr.distance)&&(zt[Ar]=Yn)}else Kt++,Ht[ar]=Kt,zt.push(Yn)};for(dt=0;dt<Ce;dt++)Zt(Gt[dt]);for(dt=Gt.length-1;dt>Ce-1;dt--)Zt(Gt[dt]);Gt=zt,Lt()}var vn=J._hoverdata,zn=[],gn=X(J),nn=ne(J);for(Re=0;Re<Gt.length;Re++){var an=Gt[Re],on=o.makeEventData(an,an.trace,an.cd);if(!1!==an.hovertemplate){var mn=!1;an.cd[an.index]&&an.cd[an.index].ht&&(mn=an.cd[an.index].ht),an.hovertemplate=mn||an.trace.hovertemplate||!1}if(an.xa&&an.ya){var _n=an.x0+an.xa._offset,Pn=an.x1+an.xa._offset,Rn=an.y0+an.ya._offset,qn=an.y1+an.ya._offset,Xn=Math.min(_n,Pn),br=Math.max(_n,Pn),fr=Math.min(Rn,qn),Vr=Math.max(Rn,qn);on.bbox={x0:Xn+nn,x1:br+nn,y0:fr+gn,y1:Vr+gn}}an.eventData=[on],zn.push(on)}J._hoverdata=zn;var cr="y"===Oe&&(en.length>1||Gt.length>1)||"closest"===Oe&&cn&&Gt.length>1,Sr=p.combine(fe.plot_bgcolor||p.background,fe.paper_bgcolor),Cr=C(Gt,{gd:J,hovermode:Oe,rotateLabels:cr,bgColor:Sr,container:fe._hoverlayer,outerContainer:fe._paper.node(),commonLabelOpts:fe.hoverlabel,hoverdistance:fe.hoverdistance});if(o.isUnifiedHover(Oe)||(function(Yn,ar,Ar){var sr,dr,$r,Lr,jr,ri,sn,wn=0,It=1,hn=Yn.size(),yn=new Array(hn),Hn=0;function Un(Qn){var lr=Qn[0],hr=Qn[Qn.length-1];if($r=hr.pos+hr.dp+hr.size-lr.pmax,(dr=lr.pmin-lr.pos-lr.dp+lr.size)>.01){for(jr=Qn.length-1;jr>=0;jr--)Qn[jr].dp+=dr;sr=!1}if(!($r<.01)){if(dr<-.01){for(jr=Qn.length-1;jr>=0;jr--)Qn[jr].dp-=$r;sr=!1}if(sr){var Mr=0;for(Lr=0;Lr<Qn.length;Lr++)(ri=Qn[Lr]).pos+ri.dp+ri.size>lr.pmax&&Mr++;for(Lr=Qn.length-1;Lr>=0&&!(Mr<=0);Lr--)(ri=Qn[Lr]).pos>lr.pmax-1&&(ri.del=!0,Mr--);for(Lr=0;Lr<Qn.length&&!(Mr<=0);Lr++)if((ri=Qn[Lr]).pos<lr.pmin+1)for(ri.del=!0,Mr--,$r=2*ri.size,jr=Qn.length-1;jr>=0;jr--)Qn[jr].dp-=$r;for(Lr=Qn.length-1;Lr>=0&&!(Mr<=0);Lr--)(ri=Qn[Lr]).pos+ri.dp+ri.size>lr.pmax&&(ri.del=!0,Mr--)}}}for(Yn.each(function(Qn){var lr=Qn[ar],hr="x"===lr._id.charAt(0),Mr=lr.range;0===Hn&&Mr&&Mr[0]>Mr[1]!==hr&&(It=-1),yn[Hn++]=[{datum:Qn,traceIndex:Qn.trace.index,dp:0,pos:Qn.pos,posref:Qn.posref,size:Qn.by*(hr?_:1)/2,pmin:0,pmax:hr?Ar.width:Ar.height}]}),yn.sort(function(Qn,lr){return Qn[0].posref-lr[0].posref||It*(lr[0].traceIndex-Qn[0].traceIndex)});!sr&&wn<=hn;){for(wn++,sr=!0,Lr=0;Lr<yn.length-1;){var jn=yn[Lr],On=yn[Lr+1],kn=jn[jn.length-1],Mn=On[0];if((dr=kn.pos+kn.dp+kn.size-Mn.pos-Mn.dp+Mn.size)>.01&&kn.pmin===Mn.pmin&&kn.pmax===Mn.pmax){for(jr=On.length-1;jr>=0;jr--)On[jr].dp+=dr;for(jn.push.apply(jn,On),yn.splice(Lr+1,1),sn=0,jr=jn.length-1;jr>=0;jr--)sn+=jn[jr].dp;for($r=sn/jn.length,jr=jn.length-1;jr>=0;jr--)jn[jr].dp-=$r;sr=!1}else Lr++}yn.forEach(Un)}for(Lr=yn.length-1;Lr>=0;Lr--){var Ln=yn[Lr];for(jr=Ln.length-1;jr>=0;jr--){var Dn=Ln[jr],Kn=Dn.datum;Kn.offset=Dn.dp,Kn.del=Dn.del}}}(Cr,cr?"xa":"ya",fe),D(Cr,cr,fe._invScaleX,fe._invScaleY)),oe&&oe.tagName){var pi=l.getComponentMethod("annotations","hasClickToShow")(J,zn);n(g.select(oe),pi?"pointer":"")}!oe||ce||!function(Yn,ar,Ar){if(!Ar||Ar.length!==Yn._hoverdata.length)return!0;for(var sr=Ar.length-1;sr>=0;sr--){var dr=Ar[sr],$r=Yn._hoverdata[sr];if(dr.curveNumber!==$r.curveNumber||String(dr.pointNumber)!==String($r.pointNumber)||String(dr.pointNumbers)!==String($r.pointNumbers))return!0}return!1}(J,0,vn)||(vn&&J.emit("plotly_unhover",{event:te,points:vn}),J.emit("plotly_hover",{event:te,points:J._hoverdata,xaxes:se,yaxes:de,xvals:Ne,yvals:Pe}))}(N,U,ee,B,K)})},$.loneHover=function(N,U){var ee=!0;Array.isArray(N)||(ee=!1,N=[N]);var B=U.gd,K=X(B),J=ne(B),te=C(N.map(function(oe){var ve=oe._x0||oe.x0||oe.x||0,fe=oe._x1||oe.x1||oe.x||0,xe=oe._y0||oe.y0||oe.y||0,Se=oe._y1||oe.y1||oe.y||0,pe=oe.eventData;if(pe){var ge=Math.min(ve,fe),Te=Math.max(ve,fe),se=Math.min(xe,Se),de=Math.max(xe,Se),Ae=oe.trace;if(l.traceIs(Ae,"gl3d")){var Le=B._fullLayout[Ae.scene]._scene.container,Me=Le.offsetLeft,De=Le.offsetTop;ge+=Me,Te+=Me,se+=De,de+=De}pe.bbox={x0:ge+J,x1:Te+J,y0:se+K,y1:de+K},U.inOut_bbox&&U.inOut_bbox.push(pe.bbox)}else pe=!1;return{color:oe.color||p.defaultLine,x0:oe.x0||oe.x||0,x1:oe.x1||oe.x||0,y0:oe.y0||oe.y||0,y1:oe.y1||oe.y||0,xLabel:oe.xLabel,yLabel:oe.yLabel,zLabel:oe.zLabel,text:oe.text,name:oe.name,idealAlign:oe.idealAlign,borderColor:oe.borderColor,fontFamily:oe.fontFamily,fontSize:oe.fontSize,fontColor:oe.fontColor,nameLength:oe.nameLength,textAlign:oe.textAlign,trace:oe.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:oe.hovertemplate||!1,hovertemplateLabels:oe.hovertemplateLabels||!1,eventData:pe}}),{gd:B,hovermode:"closest",rotateLabels:!1,bgColor:U.bgColor||p.background,container:g.select(U.container),outerContainer:U.outerContainer||U.container}),ae=0,ce=0;return te.sort(function(oe,ve){return oe.y0-ve.y0}).each(function(oe,ve){var fe=oe.y0-oe.by/2;oe.offset=fe-5<ae?ae-fe+5:0,ae=fe+oe.by+oe.offset,ve===U.anchorIndex&&(ce=oe.offset)}).each(function(oe){oe.offset-=ce}),D(te,!1,B._fullLayout._invScaleX,B._fullLayout._invScaleY),ee?te:te.node()};var S=/<extra>([\s\S]*)<\/extra>/;function C(N,U){var ee=U.gd,B=ee._fullLayout,K=U.hovermode,J=U.rotateLabels,te=U.bgColor,ae=U.container,ce=U.outerContainer,oe=U.commonLabelOpts||{};if(0===N.length)return[[]];var ve=U.fontFamily||d.HOVERFONT,fe=U.fontSize||d.HOVERFONTSIZE,xe=N[0],Se=xe.xa,pe=xe.ya,ge=K.charAt(0),Te=xe[ge+"Label"],se=V(ee,ce),de=se.top,Ae=se.width,Le=se.height,Me=void 0!==Te&&xe.distance<=U.hoverdistance&&("x"===K||"y"===K);if(Me){var De,Oe,Ie=!0;for(De=0;De<N.length;De++)if(Ie&&void 0===N[De].zLabel&&(Ie=!1),Oe=N[De].hoverinfo||N[De].trace.hoverinfo){var Qe=Array.isArray(Oe)?Oe:Oe.split("+");if(-1===Qe.indexOf("all")&&-1===Qe.indexOf(K)){Me=!1;break}}Ie&&(Me=!1)}var Ne=ae.selectAll("g.axistext").data(Me?[0]:[]);if(Ne.enter().append("g").classed("axistext",!0),Ne.exit().remove(),Ne.each(function(){var ot=g.select(this),pt=x.ensureSingle(ot,"path","",function(Pn){Pn.style({"stroke-width":"1px"})}),qt=x.ensureSingle(ot,"text","",function(Pn){Pn.attr("data-notex",1)}),St=oe.bgcolor||p.defaultLine,Mt=oe.bordercolor||p.contrast(St),Ce=p.contrast(St),Xe={family:oe.font.family||ve,size:oe.font.size||fe,color:oe.font.color||Ce};pt.style({fill:St,stroke:Mt}),qt.text(Te).call(m.font,Xe).call(c.positionText,0,0).call(c.convertToTspans,ee),ot.attr("transform","");var st,dt,zt=V(ee,qt.node());if("x"===K){var Ht="top"===Se.side?"-":"";qt.attr("text-anchor","middle").call(c.positionText,0,"top"===Se.side?de-zt.bottom-T-L:de-zt.top+T+L),dt=pe._offset+("top"===Se.side?0:pe._length);var Kt=zt.width/2+L;(st=Se._offset+(xe.x0+xe.x1)/2)<Kt?(st=Kt,pt.attr("d","M-"+(Kt-T)+",0L-"+(Kt-2*T)+","+Ht+T+"H"+(L+zt.width/2)+"v"+Ht+(2*L+zt.height)+"H-"+Kt+"V"+Ht+T+"Z")):st>B.width-Kt?(st=B.width-Kt,pt.attr("d","M"+(Kt-T)+",0L"+Kt+","+Ht+T+"v"+Ht+(2*L+zt.height)+"H-"+Kt+"V"+Ht+T+"H"+(Kt-2*T)+"Z")):pt.attr("d","M0,0L"+T+","+Ht+T+"H"+(L+zt.width/2)+"v"+Ht+(2*L+zt.height)+"H-"+(L+zt.width/2)+"V"+Ht+T+"H-"+T+"Z")}else{var Zt,vn,zn;"right"===pe.side?(Zt="start",vn=1,zn="",st=Se._offset+Se._length):(Zt="end",vn=-1,zn="-",st=Se._offset),dt=pe._offset+(xe.y0+xe.y1)/2,qt.attr("text-anchor",Zt),pt.attr("d","M0,0L"+zn+T+","+T+"V"+(L+zt.height/2)+"h"+zn+(2*L+zt.width)+"V-"+(L+zt.height/2)+"H"+zn+T+"V-"+T+"Z");var gn,nn=zt.height/2,an=de-zt.top-nn,on="clip"+B._uid+"commonlabel"+pe._id;if(st<zt.width+2*L+T){gn="M-"+(T+L)+"-"+nn+"h-"+(zt.width-L)+"V"+nn+"h"+(zt.width-L)+"Z";var mn=zt.width-st+L;c.positionText(qt,mn,an),"end"===Zt&&qt.selectAll("tspan").each(function(){var Pn=g.select(this),Rn=m.tester.append("text").text(Pn.text()).call(m.font,Xe),qn=V(ee,Rn.node());Math.round(qn.width)<Math.round(zt.width)&&Pn.attr("x",mn-qn.width),Rn.remove()})}else c.positionText(qt,vn*(L+T),an),gn=null;var _n=B._topclips.selectAll("#"+on).data(gn?[0]:[]);_n.enter().append("clipPath").attr("id",on).append("path"),_n.exit().remove(),_n.select("path").attr("d",gn),m.setClipUrl(qt,gn?on:null,ee)}ot.attr("transform",e(st,dt))}),o.isUnifiedHover(K)){ae.selectAll("g.hovertext").remove();var Pe=N.filter(function(ot){return"none"!==ot.hoverinfo});if(0===Pe.length)return;var Re=B.hoverlabel,Ge=Re.font,ct={font:Ge};u({showlegend:!0,legend:{title:{text:Te,font:Ge},font:Ge,bgcolor:Re.bgcolor,bordercolor:Re.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:B.legend?B.legend.traceorder:void 0,orientation:"v"}},ct,ee._fullData);var wt=ct.legend;wt.entries=[];for(var kt=0;kt<Pe.length;kt++){var gt=Pe[kt];if("none"!==gt.hoverinfo){var at=R(gt,!0,K,B,Te),et=at[0],yt=at[1];gt.name=yt,gt.text=""!==yt?yt+" : "+et:et;var Vt=gt.cd[gt.index];Vt&&(Vt.mc&&(gt.mc=Vt.mc),Vt.mcc&&(gt.mc=Vt.mcc),Vt.mlc&&(gt.mlc=Vt.mlc),Vt.mlcc&&(gt.mlc=Vt.mlcc),Vt.mlw&&(gt.mlw=Vt.mlw),Vt.mrc&&(gt.mrc=Vt.mrc),Vt.dir&&(gt.dir=Vt.dir)),gt._distinct=!0,wt.entries.push([gt])}}wt.entries.sort(function(ot,pt){return ot[0].trace.index-pt[0].trace.index}),wt.layer=ae,wt._inHover=!0,wt._groupTitleFont=Re.grouptitlefont,a(ee,wt);var Gt,en,Jt,cn,Rt=ae.select("g.legend"),je=V(ee,Rt.node()),Ye=je.width+2*L,he=je.height+2*L,be=Pe[0],Fe=(be.x0+be.x1)/2,He=(be.y0+be.y1)/2,Ke=!(l.traceIs(be.trace,"bar-like")||l.traceIs(be.trace,"box-violin"));"y"===ge?Ke?(en=He-L,Gt=He+L):(en=Math.min.apply(null,Pe.map(function(ot){return Math.min(ot.y0,ot.y1)})),Gt=Math.max.apply(null,Pe.map(function(ot){return Math.max(ot.y0,ot.y1)}))):en=Gt=x.mean(Pe.map(function(ot){return(ot.y0+ot.y1)/2}))-he/2,"x"===ge?Ke?(Jt=Fe+L,cn=Fe-L):(Jt=Math.max.apply(null,Pe.map(function(ot){return Math.max(ot.x0,ot.x1)})),cn=Math.min.apply(null,Pe.map(function(ot){return Math.min(ot.x0,ot.x1)}))):Jt=cn=x.mean(Pe.map(function(ot){return(ot.x0+ot.x1)/2}))-Ye/2;var Ze,ut,lt=Se._offset,Lt=pe._offset;return cn+=lt-Ye,en+=Lt-he,Ze=(Jt+=lt)+Ye<Ae&&Jt>=0?Jt:cn+Ye<Ae&&cn>=0?cn:lt+Ye<Ae?lt:Jt-Fe<Fe-cn+Ye?Ae-Ye:0,ut=(Gt+=Lt)+he<Le&&Gt>=0?Gt:en+he<Le&&en>=0?en:Lt+he<Le?Lt:Gt-He<He-en+he?Le-he:0,Rt.attr("transform",e((Ze+=L)-1,(ut+=L)-1)),Rt}var Ot=ae.selectAll("g.hovertext").data(N,function(ot){return z(ot)});return Ot.enter().append("g").classed("hovertext",!0).each(function(){var ot=g.select(this);ot.append("rect").call(p.fill,p.addOpacity(te,.8)),ot.append("text").classed("name",!0),ot.append("path").style("stroke-width","1px"),ot.append("text").classed("nums",!0).call(m.font,ve,fe)}),Ot.exit().remove(),Ot.each(function(ot){var pt=g.select(this).attr("transform",""),qt=ot.color;Array.isArray(qt)&&(qt=qt[ot.eventData[0].pointNumber]);var St=ot.bgcolor||qt,Mt=p.combine(p.opacity(St)?St:p.defaultLine,te),Ce=p.combine(p.opacity(qt)?qt:p.defaultLine,te),Xe=ot.borderColor||p.contrast(Mt),st=R(ot,Me,K,B,Te,pt),dt=st[0],zt=st[1],Ht=pt.select("text.nums").call(m.font,ot.fontFamily||ve,ot.fontSize||fe,ot.fontColor||Xe).text(dt).attr("data-notex",1).call(c.positionText,0,0).call(c.convertToTspans,ee),Kt=pt.select("text.name"),Zt=0,vn=0;if(zt&&zt!==dt){Kt.call(m.font,ot.fontFamily||ve,ot.fontSize||fe,Ce).text(zt).attr("data-notex",1).call(c.positionText,0,0).call(c.convertToTspans,ee);var zn=V(ee,Kt.node());Zt=zn.width+2*L,vn=zn.height+2*L}else Kt.remove(),pt.select("rect").remove();pt.select("path").style({fill:Mt,stroke:Xe});var gn=ot.xa._offset+(ot.x0+ot.x1)/2,nn=ot.ya._offset+(ot.y0+ot.y1)/2,an=Math.abs(ot.x1-ot.x0),on=Math.abs(ot.y1-ot.y0),mn=V(ee,Ht.node()),_n=mn.width/B._invScaleX,Pn=mn.height/B._invScaleY;ot.ty0=(de-mn.top)/B._invScaleY,ot.bx=_n+2*L,ot.by=Math.max(Pn+2*L,vn),ot.anchor="start",ot.txwidth=_n,ot.tx2width=Zt,ot.offset=0;var Rn,qn,Xn=(_n+T+L+Zt)*B._invScaleX;if(J)ot.pos=gn,Rn=nn+on/2+Xn<=Le,qn=nn-on/2-Xn>=0,"top"!==ot.idealAlign&&Rn||!qn?Rn?(nn+=on/2,ot.anchor="start"):ot.anchor="middle":(nn-=on/2,ot.anchor="end");else if(ot.pos=nn,Rn=gn+an/2+Xn<=Ae,qn=gn-an/2-Xn>=0,"left"!==ot.idealAlign&&Rn||!qn)if(Rn)gn+=an/2,ot.anchor="start";else{ot.anchor="middle";var br=Xn/2,fr=gn+br-Ae,Vr=gn-br;fr>0&&(gn-=fr),Vr<0&&(gn+=-Vr)}else gn-=an/2,ot.anchor="end";Ht.attr("text-anchor",ot.anchor),Zt&&Kt.attr("text-anchor",ot.anchor),pt.attr("transform",e(gn,nn)+(J?r(y):""))}),Ot}function R(N,U,ee,B,K,J){var te="",ae="";void 0!==N.nameOverride&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=x.templateString(N.name,N.trace._meta)),te=W(N.name,N.nameLength));var ce=ee.charAt(0);void 0!==N.zLabel?(void 0!==N.xLabel&&(ae+="x: "+N.xLabel+"<br>"),void 0!==N.yLabel&&(ae+="y: "+N.yLabel+"<br>"),"choropleth"!==N.trace.type&&"choroplethmapbox"!==N.trace.type&&(ae+=(ae?"z: ":"")+N.zLabel)):U&&N[ce+"Label"]===K?ae=N[("x"===ce?"y":"x")+"Label"]||"":void 0===N.xLabel?void 0!==N.yLabel&&"scattercarpet"!==N.trace.type&&(ae=N.yLabel):ae=void 0===N.yLabel?N.xLabel:"("+N.xLabel+", "+N.yLabel+")",!N.text&&0!==N.text||Array.isArray(N.text)||(ae+=(ae?"<br>":"")+N.text),void 0!==N.extraText&&(ae+=(ae?"<br>":"")+N.extraText),J&&""===ae&&!N.hovertemplate&&(""===te&&J.remove(),ae=te);var ve=N.hovertemplate||!1;if(ve){var fe=N.hovertemplateLabels||N;N[ce+"Label"]!==K&&(fe[ce+"other"]=fe[ce+"Val"],fe[ce+"otherLabel"]=fe[ce+"Label"]),ae=(ae=x.hovertemplateString(ve,fe,B._d3locale,N.eventData[0]||{},N.trace._meta)).replace(S,function(xe,Se){return te=W(Se,N.nameLength),""})}return[ae,te]}function D(N,U,ee,B){var K=function(te){return te*ee},J=function(te){return te*B};N.each(function(te){var ae=g.select(this);if(te.del)return ae.remove();var ce=ae.select("text.nums"),oe=te.anchor,ve="end"===oe?-1:1,fe={start:1,end:-1,middle:0}[oe],xe=fe*(T+L),Se=xe+fe*(te.txwidth+L),pe=0,ge=te.offset,Te="middle"===oe;Te&&(xe-=te.tx2width/2,Se+=te.txwidth/2+L),U&&(ge*=-w,pe=te.offset*b),ae.select("path").attr("d",Te?"M-"+K(te.bx/2+te.tx2width/2)+","+J(ge-te.by/2)+"h"+K(te.bx)+"v"+J(te.by)+"h-"+K(te.bx)+"Z":"M0,0L"+K(ve*T+pe)+","+J(T+ge)+"v"+J(te.by/2-T)+"h"+K(ve*te.bx)+"v-"+J(te.by)+"H"+K(ve*T+pe)+"V"+J(ge-T)+"Z");var se=pe+xe,de=ge+te.ty0-te.by/2+L,Ae=te.textAlign||"auto";"auto"!==Ae&&("left"===Ae&&"start"!==oe?(ce.attr("text-anchor","start"),se=Te?-te.bx/2-te.tx2width/2+L:-te.bx-L):"right"===Ae&&"end"!==oe&&(ce.attr("text-anchor","end"),se=Te?te.bx/2-te.tx2width/2-L:te.bx+L)),ce.call(c.positionText,K(se),J(de)),te.tx2width&&(ae.select("text.name").call(c.positionText,K(Se+fe*L+pe),J(ge+te.ty0-te.by/2+L)),ae.select("rect").call(m.setRect,K(Se+(fe-1)*te.tx2width/2+pe),J(ge-te.by/2-1),K(te.tx2width),J(te.by+2)))})}function j(N,U){var ee=N.index,B=N.trace||{},K=N.cd[0],J=N.cd[ee]||{};function te(xe){return xe||t(xe)&&0===xe}var ae=Array.isArray(ee)?function(xe,Se){var pe=x.castOption(K,ee,xe);return te(pe)?pe:x.extractOption({},B,"",Se)}:function(xe,Se){return x.extractOption(J,B,xe,Se)};function ce(xe,Se,pe){var ge=ae(Se,pe);te(ge)&&(N[xe]=ge)}if(ce("hoverinfo","hi","hoverinfo"),ce("bgcolor","hbg","hoverlabel.bgcolor"),ce("borderColor","hbc","hoverlabel.bordercolor"),ce("fontFamily","htf","hoverlabel.font.family"),ce("fontSize","hts","hoverlabel.font.size"),ce("fontColor","htc","hoverlabel.font.color"),ce("nameLength","hnl","hoverlabel.namelength"),ce("textAlign","hta","hoverlabel.align"),N.posref="y"===U||"closest"===U&&"h"===B.orientation?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=x.constrain(N.x0,0,N.xa._length),N.x1=x.constrain(N.x1,0,N.xa._length),N.y0=x.constrain(N.y0,0,N.ya._length),N.y1=x.constrain(N.y1,0,N.ya._length),void 0!==N.xLabelVal&&(N.xLabel="xLabel"in N?N.xLabel:f.hoverLabelText(N.xa,N.xLabelVal,B.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),void 0!==N.yLabelVal&&(N.yLabel="yLabel"in N?N.yLabel:f.hoverLabelText(N.ya,N.yLabelVal,B.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),void 0!==N.zLabelVal&&void 0===N.zLabel&&(N.zLabel=String(N.zLabelVal)),!(isNaN(N.xerr)||"log"===N.xa.type&&N.xerr<=0)){var oe=f.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xLabel+=void 0!==N.xerrneg?" +"+oe+" / -"+f.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:" \xb1 "+oe,"x"===U&&(N.distance+=1)}if(!(isNaN(N.yerr)||"log"===N.ya.type&&N.yerr<=0)){var ve=f.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yLabel+=void 0!==N.yerrneg?" +"+ve+" / -"+f.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:" \xb1 "+ve,"y"===U&&(N.distance+=1)}var fe=N.hoverinfo||N.trace.hoverinfo;return fe&&"all"!==fe&&(-1===(fe=Array.isArray(fe)?fe:fe.split("+")).indexOf("x")&&(N.xLabel=void 0),-1===fe.indexOf("y")&&(N.yLabel=void 0),-1===fe.indexOf("z")&&(N.zLabel=void 0),-1===fe.indexOf("text")&&(N.text=void 0),-1===fe.indexOf("name")&&(N.name=void 0)),N}function q(N,U,ee){var B,K,J=ee.container,te=ee.fullLayout,ae=te._size,ce=ee.event,oe=!!U.hLinePoint,ve=!!U.vLinePoint;if(J.selectAll(".spikeline").remove(),ve||oe){var fe=p.combine(te.plot_bgcolor,te.paper_bgcolor);if(oe){var xe,Se,pe=U.hLinePoint;B=pe&&pe.xa,"cursor"===(K=pe&&pe.ya).spikesnap?(xe=ce.pointerX,Se=ce.pointerY):(xe=B._offset+pe.x,Se=K._offset+pe.y);var ge,Te,se=k.readability(pe.color,fe)<1.5?p.contrast(fe):pe.color,de=K.spikemode,Ae=K.spikethickness,Le=K.spikecolor||se,Me=f.getPxPosition(N,K);if(-1!==de.indexOf("toaxis")||-1!==de.indexOf("across")){if(-1!==de.indexOf("toaxis")&&(ge=Me,Te=xe),-1!==de.indexOf("across")){var De=K._counterDomainMin,Oe=K._counterDomainMax;"free"===K.anchor&&(De=Math.min(De,K.position),Oe=Math.max(Oe,K.position)),ge=ae.l+De*ae.w,Te=ae.l+Oe*ae.w}J.insert("line",":first-child").attr({x1:ge,x2:Te,y1:Se,y2:Se,"stroke-width":Ae,stroke:Le,"stroke-dasharray":m.dashStyle(K.spikedash,Ae)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:ge,x2:Te,y1:Se,y2:Se,"stroke-width":Ae+2,stroke:fe}).classed("spikeline",!0).classed("crisp",!0)}-1!==de.indexOf("marker")&&J.insert("circle",":first-child").attr({cx:Me+("right"!==K.side?Ae:-Ae),cy:Se,r:Ae,fill:Le}).classed("spikeline",!0)}if(ve){var Ie,Qe,Ne=U.vLinePoint;K=Ne&&Ne.ya,"cursor"===(B=Ne&&Ne.xa).spikesnap?(Ie=ce.pointerX,Qe=ce.pointerY):(Ie=B._offset+Ne.x,Qe=K._offset+Ne.y);var Pe,Re,Ge=k.readability(Ne.color,fe)<1.5?p.contrast(fe):Ne.color,tt=B.spikemode,ct=B.spikethickness,wt=B.spikecolor||Ge,kt=f.getPxPosition(N,B);if(-1!==tt.indexOf("toaxis")||-1!==tt.indexOf("across")){if(-1!==tt.indexOf("toaxis")&&(Pe=kt,Re=Qe),-1!==tt.indexOf("across")){var gt=B._counterDomainMin,at=B._counterDomainMax;"free"===B.anchor&&(gt=Math.min(gt,B.position),at=Math.max(at,B.position)),Pe=ae.t+(1-at)*ae.h,Re=ae.t+(1-gt)*ae.h}J.insert("line",":first-child").attr({x1:Ie,x2:Ie,y1:Pe,y2:Re,"stroke-width":ct,stroke:wt,"stroke-dasharray":m.dashStyle(B.spikedash,ct)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:Ie,x2:Ie,y1:Pe,y2:Re,"stroke-width":ct+2,stroke:fe}).classed("spikeline",!0).classed("crisp",!0)}-1!==tt.indexOf("marker")&&J.insert("circle",":first-child").attr({cx:Ie,cy:kt-("top"!==B.side?ct:-ct),r:ct,fill:wt}).classed("spikeline",!0)}}}function Z(N,U){return!U||U.vLinePoint!==N._spikepoints.vLinePoint||U.hLinePoint!==N._spikepoints.hLinePoint}function W(N,U){return c.plainText(N||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function G(N,U,ee){var B=U[N+"a"],K=U[N+"Val"],J=U.cd[0];if("category"===B.type)K=B._categoriesMap[K];else if("date"===B.type){var te=U.trace[N+"periodalignment"];if(te){var ae=U.cd[U.index],ce=ae[N+"Start"];void 0===ce&&(ce=ae[N]);var oe=ae[N+"End"];void 0===oe&&(oe=ae[N]);var ve=oe-ce;"end"===te?K+=ve:"middle"===te&&(K+=ve/2)}K=B.d2c(K)}return J&&J.t&&J.t.posLetter===B._id&&("group"!==ee.boxmode&&"group"!==ee.violinmode||(K+=J.t.dPos)),K}function X(N){return N.offsetTop+N.clientTop}function ne(N){return N.offsetLeft+N.clientLeft}function V(N,U){var ee=N._fullLayout,B=U.getBoundingClientRect(),K=B.x,J=B.y,te=K+B.width,ae=J+B.height,ce=x.apply3DTransform(ee._invTransform)(K,J),oe=x.apply3DTransform(ee._invTransform)(te,ae),ve=ce[0],fe=ce[1],xe=oe[0],Se=oe[1];return{x:ve,y:fe,width:xe-ve,height:Se-fe,top:Math.min(fe,Se),left:Math.min(ve,xe),right:Math.max(ve,xe),bottom:Math.max(fe,Se)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../color"),k=v("./helpers").isUnifiedHover;Q.exports=function(x,e,r,i){i=i||{};var c=e.legend;function n(m){i.font[m]||(i.font[m]=c?e.legend.font[m]:e.font[m])}e&&k(e.hovermode)&&(i.font||(i.font={}),n("size"),n("family"),n("color"),c?(i.bgcolor||(i.bgcolor=t.combine(e.legend.bgcolor,e.paper_bgcolor)),i.bordercolor||(i.bordercolor=e.legend.bordercolor)):i.bgcolor||(i.bgcolor=e.paper_bgcolor)),r("hoverlabel.bgcolor",i.bgcolor),r("hoverlabel.bordercolor",i.bordercolor),r("hoverlabel.namelength",i.namelength),g.coerceFont(r,"hoverlabel.font",i.font),r("hoverlabel.align",i.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x){function e(r,i){return void 0!==x[r]?x[r]:g.coerce(k,x,t,r,i)}return e("clickmode"),e("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../dragelement"),x=v("./helpers"),e=v("./layout_attributes"),r=v("./hover");Q.exports={moduleType:"component",name:"fx",constants:v("./constants"),schema:{layout:e},attributes:v("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:v("./layout_global_defaults"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),getDistanceFunction:x.getDistanceFunction,getClosest:x.getClosest,inbox:x.inbox,quadrature:x.quadrature,appendArrayPointValue:x.appendArrayPointValue,castHoverOption:function(i,c,n){return t.castOption(i,c,"hoverlabel."+n)},castHoverinfo:function(i,c,n){return t.castOption(i,n,"hoverinfo",function(m){return t.coerceHoverinfo({hoverinfo:m},{_module:i._module},c)})},hover:r.hover,unhover:k.unhover,loneHover:r.loneHover,loneUnhover:function(i){var c=t.isD3Selection(i)?i:g.select(i);c.selectAll("g.hovertext").remove(),c.selectAll(".spikeline").remove()},click:v("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(v,Q,$){"use strict";var g=v("./constants"),t=v("../../plots/font_attributes"),k=t({editType:"none"});k.family.dflt=g.HOVERFONT,k.size.dflt=g.HOVERFONTSIZE,Q.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:k,grouptitlefont:t({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes"),k=v("./hovermode_defaults"),x=v("./hoverlabel_defaults");Q.exports=function(e,r){function i(p,s){return g.coerce(e,r,t,p,s)}k(e,r)&&(i("hoverdistance"),i("spikedistance")),"select"===i("dragmode")&&i("selectdirection");var c=r._has("mapbox"),n=r._has("geo"),m=r._basePlotModules.length;"zoom"===r.dragmode&&((c||n)&&1===m||c&&n&&2===m)&&(r.dragmode="pan"),x(e,r,i),g.coerceFont(i,"hoverlabel.grouptitlefont",r.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./hoverlabel_defaults"),k=v("./layout_attributes");Q.exports=function(x,e){t(x,e,function(r,i){return g.coerce(x,e,k,r,i)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../lib/regex").counter,k=v("../../plots/domain").attributes,x=v("../../plots/cartesian/constants").idRegex,e=v("../../plot_api/plot_template"),r={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[t("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[x.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[x.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:k({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function i(m,p,s){var f=p[s+"axes"],l=Object.keys((m._splomAxes||{})[s]||{});return Array.isArray(f)?f:l.length?l:void 0}function c(m,p,s,f,l,o){var d=p(m+"gap",s),u=p("domain."+m);p(m+"side",f);for(var a=new Array(l),y=u[0],h=(u[1]-y)/(l-d),_=h*(1-d),b=0;b<l;b++){var w=y+h*b;a[o?l-1-b:b]=[w,w+_]}return a}function n(m,p,s,f,l){var o,d=new Array(s);function u(a,y){-1!==p.indexOf(y)&&void 0===f[y]?(d[a]=y,f[y]=a):d[a]=""}if(Array.isArray(m))for(o=0;o<s;o++)u(o,m[o]);else for(u(0,l),o=1;o<s;o++)u(o,l+(o+1));return d}Q.exports={moduleType:"component",name:"grid",schema:{layout:{grid:r}},layoutAttributes:r,sizeDefaults:function(m,p){var s=m.grid||{},f=i(p,s,"x"),l=i(p,s,"y");if(m.grid||f||l){var o,d,u=Array.isArray(s.subplots)&&Array.isArray(s.subplots[0]),a=Array.isArray(f),y=Array.isArray(l),h=a&&f!==s.xaxes&&y&&l!==s.yaxes;u?(o=s.subplots.length,d=s.subplots[0].length):(y&&(o=l.length),a&&(d=f.length));var _=e.newContainer(p,"grid"),b=S("rows",o),w=S("columns",d);if(b*w>1){!u&&!a&&!y&&"independent"===S("pattern")&&(u=!0),_._hasSubplotGrid=u;var T,L,M="top to bottom"===S("roworder"),z=u?.3:.1;h&&p._splomGridDflt&&(T=p._splomGridDflt.xside,L=p._splomGridDflt.yside),_._domains={x:c("x",S,u?.2:.1,T,w),y:c("y",S,z,L,b,M)}}else delete p.grid}function S(C,R){return g.coerce(s,_,r,C,R)}},contentDefaults:function(m,p){var s=p.grid;if(s&&s._domains){var f,l,o,d,u,a,y,h=m.grid||{},_=p._subplots,b=s._hasSubplotGrid,w=s.rows,T=s.columns,L="independent"===s.pattern,M=s._axisMap={};if(b){var P=h.subplots||[];a=s.subplots=new Array(w);var z=1;for(f=0;f<w;f++){var S=a[f]=new Array(T),C=P[f]||[];for(l=0;l<T;l++)if(L?(u=1===z?"xy":"x"+z+"y"+z,z++):u=C[l],S[l]="",-1!==_.cartesian.indexOf(u)){if(y=u.indexOf("y"),o=u.slice(0,y),d=u.slice(y),void 0!==M[o]&&M[o]!==l||void 0!==M[d]&&M[d]!==f)continue;S[l]=u,M[o]=l,M[d]=f}}}else{var R=i(p,h,"x"),D=i(p,h,"y");s.xaxes=n(R,_.xaxis,T,M,"x"),s.yaxes=n(D,_.yaxis,w,M,"y")}var j=s._anchors={},q="top to bottom"===s.roworder;for(var Z in M){var W,G,X,ne=Z.charAt(0),V=s[ne+"side"];if(V.length<8)j[Z]="free";else if("x"===ne){if("t"===V.charAt(0)===q?(W=0,G=1,X=w):(W=w-1,G=-1,X=-1),b){var N=M[Z];for(f=W;f!==X;f+=G)if((u=a[f][N])&&(y=u.indexOf("y"),u.slice(0,y)===Z)){j[Z]=u.slice(y);break}}else for(f=W;f!==X;f+=G)if(-1!==_.cartesian.indexOf(Z+(d=s.yaxes[f]))){j[Z]=d;break}}else if("l"===V.charAt(0)?(W=0,G=1,X=T):(W=T-1,G=-1,X=-1),b){var U=M[Z];for(f=W;f!==X;f+=G)if((u=a[U][f])&&(y=u.indexOf("y"),u.slice(y)===Z)){j[Z]=u.slice(0,y);break}}else for(f=W;f!==X;f+=G)if(-1!==_.cartesian.indexOf((o=s.xaxes[f])+Z)){j[Z]=o;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/constants"),t=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),Q.exports=t("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",g.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",g.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib/to_log_range");Q.exports=function(k,x,e,r){x=x||{};var i="log"===e&&"linear"===x.type;if(i||"linear"===e&&"log"===x.type)for(var n,m,p=k._fullLayout.images,s=x._id.charAt(0),f=0;f<p.length;f++)if(m="images["+f+"].",(n=p[f])[s+"ref"]===x._id){var l=n[s],o=n["size"+s],d=null,u=null;if(i){d=t(l,x.range);var a=o/Math.pow(10,d)/2;u=2*Math.log(a+Math.sqrt(1+a*a))/Math.LN10}else u=(d=Math.pow(10,l))*(Math.pow(10,o/2)-Math.pow(10,-o/2));g(d)?g(u)||(u=null):(d=null,u=null),r(m+s,d),r(m+"size"+s,u)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./attributes");function e(r,i,c){function n(d,u){return g.coerce(r,i,x,d,u)}var m=n("source");if(!n("visible",!!m))return i;n("layer"),n("xanchor"),n("yanchor"),n("sizex"),n("sizey"),n("sizing"),n("opacity");for(var p={_fullLayout:c},s=["x","y"],f=0;f<2;f++){var l=s[f],o=t.coerceRef(r,i,p,l,"paper",void 0);"paper"!==o&&t.getFromId(p,o)._imgIndices.push(i._index),t.coercePosition(i,p,n,o,l,0)}return i}Q.exports=function(r,i){k(r,i,{name:"images",handleItemDefaults:e})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../drawing"),k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/axis_ids"),e=v("../../constants/xmlns_namespaces");Q.exports=function(r){var i,c,n=r._fullLayout,m=[],p={},s=[];for(c=0;c<n.images.length;c++){var f=n.images[c];if(f.visible)if("below"===f.layer&&"paper"!==f.xref&&"paper"!==f.yref){i=x.ref2id(f.xref)+x.ref2id(f.yref);var l=n._plots[i];if(!l){s.push(f);continue}l.mainplot&&(i=l.mainplot.id),p[i]||(p[i]=[]),p[i].push(f)}else"above"===f.layer?m.push(f):s.push(f)}var o={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},d={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function u(T){var L=g.select(this);if(this._imgSrc!==T.source)if(L.attr("xmlns",e.svg),T.source&&"data:"===T.source.slice(0,5))L.attr("xlink:href",T.source),this._imgSrc=T.source;else{var M=new Promise(function(P){var z=new Image;function S(){L.remove(),P()}this.img=z,z.setAttribute("crossOrigin","anonymous"),z.onerror=S,z.onload=function(){var C=document.createElement("canvas");C.width=this.width,C.height=this.height,C.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var R=C.toDataURL("image/png");L.attr("xlink:href",R),P()},L.on("error",S),z.src=T.source,this._imgSrc=T.source}.bind(this));r._promises.push(M)}}function a(T){var L,M,P=g.select(this),z=k.getFromId(r,T.xref),S=k.getFromId(r,T.yref),C="domain"===k.getRefType(T.xref),R="domain"===k.getRefType(T.yref),D=n._size;L=void 0!==z?"string"==typeof T.xref&&C?z._length*T.sizex:Math.abs(z.l2p(T.sizex)-z.l2p(0)):T.sizex*D.w,M=void 0!==S?"string"==typeof T.yref&&R?S._length*T.sizey:Math.abs(S.l2p(T.sizey)-S.l2p(0)):T.sizey*D.h;var j,q,Z=L*o[T.xanchor].offset,W=M*d[T.yanchor].offset,G=o[T.xanchor].sizing+d[T.yanchor].sizing;switch(j=void 0!==z?"string"==typeof T.xref&&C?z._length*T.x+z._offset:z.r2p(T.x)+z._offset:T.x*D.w+D.l,j+=Z,q=void 0!==S?"string"==typeof T.yref&&R?S._length*(1-T.y)+S._offset:S.r2p(T.y)+S._offset:D.h-T.y*D.h+D.t,q+=W,T.sizing){case"fill":G+=" slice";break;case"stretch":G="none"}P.attr({x:j,y:q,width:L,height:M,preserveAspectRatio:G,opacity:T.opacity});var X=(z&&"domain"!==k.getRefType(T.xref)?z._id:"")+(S&&"domain"!==k.getRefType(T.yref)?S._id:"");t.setClipUrl(P,X?"clip"+n._uid+X:null,r)}var y=n._imageLowerLayer.selectAll("image").data(s),h=n._imageUpperLayer.selectAll("image").data(m);y.enter().append("image"),h.enter().append("image"),y.exit().remove(),h.exit().remove(),y.each(function(T){u.bind(this)(T),a.bind(this)(T)}),h.each(function(T){u.bind(this)(T),a.bind(this)(T)});var _=Object.keys(n._plots);for(c=0;c<_.length;c++){var b=n._plots[i=_[c]];if(b.imagelayer){var w=b.imagelayer.selectAll("image").data(p[i]||[]);w.enter().append("image"),w.exit().remove(),w.each(function(T){u.bind(this)(T),a.bind(this)(T)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(v,Q,$){"use strict";Q.exports={moduleType:"component",name:"images",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("images"),draw:v("./draw"),convertCoords:v("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("../color/attributes");Q.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:g({editType:"legend"}),grouptitlefont:g({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:g({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(v,Q,$){"use strict";Q.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../../plot_api/plot_template"),x=v("../../plots/attributes"),e=v("./attributes"),r=v("../../plots/layout_attributes"),i=v("./helpers");Q.exports=function(c,n,m){var p,s=c.legend||{},f=k.newContainer(n,"legend");function l(S,C){return t.coerce(s,f,e,S,C)}for(var o=function(S,C){return t.coerce(p._input,p,x,S,C)},d=n.font||{},u=t.coerceFont(l,"grouptitlefont",t.extendFlat({},d,{size:Math.round(1.1*d.size)})),a=0,y=!1,h="normal",_=0;_<m.length;_++)(p=m[_]).visible&&((p.showlegend||p._dfltShowLegend&&!(p._module&&p._module.attributes&&p._module.attributes.showlegend&&!1===p._module.attributes.showlegend.dflt))&&(a++,p.showlegend&&(y=!0,(g.traceIs(p,"pie-like")||!0===p._input.showlegend)&&a++),t.coerceFont(o,"legendgrouptitle.font",u)),(g.traceIs(p,"bar")&&"stack"===n.barmode||-1!==["tonextx","tonexty"].indexOf(p.fill))&&(h=i.isGrouped({traceorder:h})?"grouped+reversed":"reversed"),void 0!==p.legendgroup&&""!==p.legendgroup&&(h=i.isReversed({traceorder:h})?"reversed+grouped":"grouped"));var b=t.coerce(c,n,r,"showlegend",y&&a>1);if(!1===b&&(n.legend=void 0),(!1!==b||s.uirevision)&&(l("uirevision",n.uirevision),!1!==b)){l("bgcolor",n.paper_bgcolor),l("bordercolor"),l("borderwidth");var w,T,L,M=t.coerceFont(l,"font",n.font),P="h"===l("orientation");if(P?(w=0,g.getComponentMethod("rangeslider","isVisible")(c.xaxis)?(T=1.1,L="bottom"):(T=-.1,L="top")):(w=1.02,T=1,L="auto"),l("traceorder",h),i.isGrouped(n.legend)&&l("tracegroupgap"),l("entrywidth"),l("entrywidthmode"),l("itemsizing"),l("itemwidth"),l("itemclick"),l("itemdoubleclick"),l("groupclick"),l("x",w),l("xanchor"),l("y",T),l("yanchor",L),l("valign"),t.noneOrAll(s,f,["x","y"]),l("title.text")){l("title.side",P?"left":"top");var z=t.extendFlat({},M,{size:t.bigFont(M.size)});t.coerceFont(l,"title.font",z)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../lib/events"),r=v("../dragelement"),i=v("../drawing"),c=v("../color"),n=v("../../lib/svg_text_utils"),m=v("./handle_click"),p=v("./constants"),s=v("../../constants/alignment"),f=s.LINE_SPACING,l=s.FROM_TL,o=s.FROM_BR,d=v("./get_legend_data"),u=v("./style"),a=v("./helpers");function y(P,z,S){var C=P[0],j=C.trace.legendwidth||z.entrywidth;return"fraction"===z.entrywidthmode?z._maxWidth*j:S+(j||C.width)}function h(P,z,S,C,R){var D=S.data()[0][0].trace,j={event:R,node:S.node(),curveNumber:D.index,expandedIndex:D._expandedIndex,data:P.data,layout:P.layout,frames:P._transitionData._frames,config:P._context,fullData:P._fullData,fullLayout:P._fullLayout};D._group&&(j.group=D._group),x.traceIs(D,"pie-like")&&(j.label=S.datum()[0].label),!1!==e.triggerHandler(P,"plotly_legendclick",j)&&(1===C?z._clickTimeout=setTimeout(function(){P._fullLayout&&m(S,P,C)},P._context.doubleClickDelay):2===C&&(z._clickTimeout&&clearTimeout(z._clickTimeout),P._legendMouseDownTime=0,!1!==e.triggerHandler(P,"plotly_legenddoubleclick",j)&&m(S,P,C)))}function _(P,z,S){var C,R,D=P.data()[0][0],j=D.trace,q=x.traceIs(j,"pie-like"),Z=!S._inHover&&z._context.edits.legendText&&!q,W=S._maxNameLength;D.groupTitle?(C=D.groupTitle.text,R=D.groupTitle.font):(R=S.font,S.entries?C=D.text:(C=q?D.label:j.name,j._meta&&(C=t.templateString(C,j._meta))));var G=t.ensureSingle(P,"text","legendtext");G.attr("text-anchor","start").call(i.font,R).text(Z?b(C,W):C),n.positionText(G,S.itemwidth+2*p.itemGap,0),Z?G.call(n.makeEditable,{gd:z,text:C}).call(T,P,z,S).on("edit",function(ne){this.text(b(ne,W)).call(T,P,z,S);var V=D.trace._fullInput||{},N={};if(x.hasTransform(V,"groupby")){var U=x.getTransformIndices(V,"groupby"),B=t.keyedContainer(V,"transforms["+U[U.length-1]+"].styles","target","value.name");B.set(D.trace._group,ne),N=B.constructUpdate()}else N.name=ne;return x.call("_guiRestyle",z,N,j.index)}):T(G,P,z,S)}function b(P,z){var S=Math.max(4,z);if(P&&P.trim().length>=S/2)return P;for(var C=S-(P=P||"").length;C>0;C--)P+=" ";return P}function w(P,z){var S,C=z._context.doubleClickDelay,R=1,D=t.ensureSingle(P,"rect","legendtoggle",function(j){z._context.staticPlot||j.style("cursor","pointer").attr("pointer-events","all"),j.call(c.fill,"rgba(0,0,0,0)")});z._context.staticPlot||(D.on("mousedown",function(){(S=(new Date).getTime())-z._legendMouseDownTime<C?R+=1:(R=1,z._legendMouseDownTime=S)}),D.on("mouseup",function(){if(!z._dragged&&!z._editing){var j=z._fullLayout.legend;(new Date).getTime()-z._legendMouseDownTime>C&&(R=Math.max(R-1,1)),h(z,j,P,R,g.event)}}))}function T(P,z,S,C,R){C._inHover&&P.attr("data-notex",!0),n.convertToTspans(P,S,function(){!function(D,j,q,Z){var W=D.data()[0][0];if(q._inHover||!W||W.trace.showlegend){var G=D.select("g[class*=math-group]"),X=G.node();q||(q=j._fullLayout.legend);var N,U,V=q.borderwidth,ee=(1===Z?q.title.font:W.groupTitle?W.groupTitle.font:q.font).size*f;if(X){var B=i.bBox(X);N=B.height,U=B.width,1===Z?i.setTranslate(G,V,V+.75*N):i.setTranslate(G,0,.25*N)}else{var K=D.select(1===Z?".legendtitletext":".legendtext"),J=n.lineCount(K),te=K.node();if(N=ee*J,U=te?i.bBox(te).width:0,1===Z)"left"===q.title.side&&(U+=2*p.itemGap),n.positionText(K,V+p.titlePad,V+ee);else{var ae=2*p.itemGap+q.itemwidth;W.groupTitle&&(ae=p.itemGap,U-=q.itemwidth),n.positionText(K,ae,-ee*((J-1)/2-.3))}}1===Z?(q._titleWidth=U,q._titleHeight=N):(W.lineHeight=ee,W.height=Math.max(N,16)+3,W.width=U)}else D.remove()}(z,S,C,R)})}function L(P){return t.isRightAnchor(P)?"right":t.isCenterAnchor(P)?"center":"left"}function M(P){return t.isBottomAnchor(P)?"bottom":t.isMiddleAnchor(P)?"middle":"top"}Q.exports=function(P,z){return z||(z=P._fullLayout.legend||{}),function(S,C){var R,D,j=S._fullLayout,q="legend"+j._uid,Z=C._inHover;if(Z?(R=C.layer,q+="-hover"):R=j._infolayer,R){if(S._legendMouseDownTime||(S._legendMouseDownTime=0),Z){if(!C.entries)return;D=d(C.entries,C)}else{if(!S.calcdata)return;D=j.showlegend&&d(S.calcdata,C)}var W=j.hiddenlabels||[];if(!(Z||j.showlegend&&D.length))return R.selectAll(".legend").remove(),j._topdefs.select("#"+q).remove(),k.autoMargin(S,"legend");var G=t.ensureSingle(R,"g","legend",function(J){Z||J.attr("pointer-events","all")}),X=t.ensureSingleById(j._topdefs,"clipPath",q,function(J){J.append("rect")}),ne=t.ensureSingle(G,"rect","bg",function(J){J.attr("shape-rendering","crispEdges")});ne.call(c.stroke,C.bordercolor).call(c.fill,C.bgcolor).style("stroke-width",C.borderwidth+"px");var V=t.ensureSingle(G,"g","scrollbox"),N=C.title;if(C._titleWidth=0,C._titleHeight=0,N.text){var U=t.ensureSingle(V,"text","legendtitletext");U.attr("text-anchor","start").call(i.font,N.font).text(N.text),T(U,V,S,C,1)}else V.selectAll(".legendtitletext").remove();var ee=t.ensureSingle(G,"rect","scrollbar",function(J){J.attr(p.scrollBarEnterAttrs).call(c.fill,p.scrollBarColor)}),B=V.selectAll("g.groups").data(D);B.enter().append("g").attr("class","groups"),B.exit().remove();var K=B.selectAll("g.traces").data(t.identity);K.enter().append("g").attr("class","traces"),K.exit().remove(),K.style("opacity",function(J){var te=J[0].trace;return x.traceIs(te,"pie-like")?-1!==W.indexOf(J[0].label)?.5:1:"legendonly"===te.visible?.5:1}).each(function(){g.select(this).call(_,S,C)}).call(u,S,C).each(function(){Z||g.select(this).call(w,S)}),t.syncOrAsync([k.previousPromises,function(){return function(J,te,ae,ce){var oe=J._fullLayout;ce||(ce=oe.legend);var ve=oe._size,fe=a.isVertical(ce),xe=a.isGrouped(ce),Se="fraction"===ce.entrywidthmode,pe=ce.borderwidth,ge=2*pe,Te=p.itemGap,se=ce.itemwidth+2*Te,de=2*(pe+Te),Ae=M(ce),Le=ce.y<0||0===ce.y&&"top"===Ae,Me=ce.y>1||1===ce.y&&"bottom"===Ae,De=ce.tracegroupgap,Oe={};ce._maxHeight=Math.max(Le||Me?oe.height/2:ve.h,30);var Ie=0;ce._width=0,ce._height=0;var Ye,he,be,Fe,Qe=(he=0,be=0,(Fe=(Ye=ce).title.side)&&(-1!==Fe.indexOf("left")&&(he=Ye._titleWidth),-1!==Fe.indexOf("top")&&(be=Ye._titleHeight)),[he,be]);if(fe)ae.each(function(Ye){var he=Ye[0].height;i.setTranslate(this,pe+Qe[0],pe+Qe[1]+ce._height+he/2+Te),ce._height+=he,ce._width=Math.max(ce._width,Ye[0].width)}),Ie=se+ce._width,ce._width+=Te+se+ge,ce._height+=de,xe&&(te.each(function(Ye,he){i.setTranslate(this,0,he*ce.tracegroupgap)}),ce._height+=(ce._lgroupsLength-1)*ce.tracegroupgap);else{var Ne=L(ce),Ge=Me||Le,tt=oe.width/2;ce._maxWidth=Math.max(ce.x<0||0===ce.x&&"right"===Ne?Ge&&"left"===Ne?ve.l+ve.w:tt:ce.x>1||1===ce.x&&"left"===Ne?Ge&&"right"===Ne?ve.r+ve.w:tt:ve.w,2*se);var ct=0,wt=0;ae.each(function(Ye){var he=y(Ye,ce,se);ct=Math.max(ct,he),wt+=he}),Ie=null;var kt=0;if(xe){var gt=0,at=0,et=0;te.each(function(){var Ye=0,he=0;g.select(this).selectAll("g.traces").each(function(Fe){var He=y(Fe,ce,se),Ke=Fe[0].height;i.setTranslate(this,Qe[0],Qe[1]+pe+Te+Ke/2+he),he+=Ke,Ye=Math.max(Ye,He),Oe[Fe[0].trace.legendgroup]=Ye});var be=Ye+Te;at>0&&be+pe+at>ce._maxWidth?(kt=Math.max(kt,at),at=0,et+=gt+De,gt=he):gt=Math.max(gt,he),i.setTranslate(this,at,et),at+=be}),ce._width=Math.max(kt,at)+pe,ce._height=et+gt+de}else{var yt=ae.size(),Vt=wt+ge+(yt-1)*Te<ce._maxWidth,Gt=0,en=0,Jt=0,cn=0;ae.each(function(Ye){var he=Ye[0].height,be=y(Ye,ce,se),Fe=Vt?be:ct;Se||(Fe+=Te),Fe+pe+en-Te>=ce._maxWidth&&(kt=Math.max(kt,cn),en=0,Jt+=Gt,ce._height+=Gt,Gt=0),i.setTranslate(this,Qe[0]+pe+en,Qe[1]+pe+Jt+he/2+Te),cn=en+be+Te,en+=Fe,Gt=Math.max(Gt,he)}),Vt?(ce._width=en+ge,ce._height=Gt+de):(ce._width=Math.max(kt,cn)+ge,ce._height+=Gt+de)}}ce._width=Math.ceil(Math.max(ce._width+Qe[0],ce._titleWidth+2*(pe+p.titlePad))),ce._height=Math.ceil(Math.max(ce._height+Qe[1],ce._titleHeight+2*(pe+p.itemGap))),ce._effHeight=Math.min(ce._height,ce._maxHeight);var Rt=J._context.edits,je=Rt.legendText||Rt.legendPosition;ae.each(function(Ye){var he=g.select(this).select(".legendtoggle"),be=Ye[0].height,Fe=Ye[0].trace.legendgroup,He=y(Ye,ce,se);xe&&""!==Fe&&(He=Oe[Fe]);var Ke=je?se:Ie||He;fe||Se||(Ke+=Te/2),i.setRect(he,0,-be/2,Ke,be)})}(S,B,K,C)},function(){var J,te,ae,ce,Pe,Re,Ge,tt,oe=j._size,ve=C.borderwidth;if(!Z){if(Ge=L(Re=(Pe=S)._fullLayout.legend),tt=M(Re),k.autoMargin(Pe,"legend",{x:Re.x,y:Re.y,l:Re._width*l[Ge],r:Re._width*o[Ge],b:Re._effHeight*o[tt],t:Re._effHeight*l[tt]}))return;var fe=oe.l+oe.w*C.x-l[L(C)]*C._width,xe=oe.t+oe.h*(1-C.y)-l[M(C)]*C._effHeight;if(j.margin.autoexpand){var Se=fe,pe=xe;fe=t.constrain(fe,0,j.width-C._width),xe=t.constrain(xe,0,j.height-C._effHeight),fe!==Se&&t.log("Constrain legend.x to make legend fit inside graph"),xe!==pe&&t.log("Constrain legend.y to make legend fit inside graph")}i.setTranslate(G,fe,xe)}if(ee.on(".drag",null),G.on("wheel",null),Z||C._height<=C._maxHeight||S._context.staticPlot){var ge=C._effHeight;Z&&(ge=C._height),ne.attr({width:C._width-ve,height:ge-ve,x:ve/2,y:ve/2}),i.setTranslate(V,0,0),X.select("rect").attr({width:C._width-2*ve,height:ge-2*ve,x:ve,y:ve}),i.setClipUrl(V,q,S),i.setRect(ee,0,0,0,0),delete C._scrollY}else{var Te,de,Ae=Math.max(p.scrollBarMinHeight,C._effHeight*C._effHeight/C._height),Le=C._effHeight-Ae-2*p.scrollBarMargin,Me=C._height-C._effHeight,De=Le/Me,Oe=Math.min(C._scrollY||0,Me);ne.attr({width:C._width-2*ve+p.scrollBarWidth+p.scrollBarMargin,height:C._effHeight-ve,x:ve/2,y:ve/2}),X.select("rect").attr({width:C._width-2*ve+p.scrollBarWidth+p.scrollBarMargin,height:C._effHeight-2*ve,x:ve,y:ve+Oe}),i.setClipUrl(V,q,S),Ne(Oe,Ae,De),G.on("wheel",function(){Ne(Oe=t.constrain(C._scrollY+g.event.deltaY/Le*Me,0,Me),Ae,De),0!==Oe&&Oe!==Me&&g.event.preventDefault()});var Ie=g.behavior.drag().on("dragstart",function(){var Pe=g.event.sourceEvent;Te="touchstart"===Pe.type?Pe.changedTouches[0].clientY:Pe.clientY,de=Oe}).on("drag",function(){var Pe=g.event.sourceEvent;2===Pe.buttons||Pe.ctrlKey||Ne(Oe=function(Re,Ge,tt){return t.constrain((tt-Ge)/De+Re,0,Me)}(de,Te,"touchmove"===Pe.type?Pe.changedTouches[0].clientY:Pe.clientY),Ae,De)});ee.call(Ie);var Qe=g.behavior.drag().on("dragstart",function(){var Pe=g.event.sourceEvent;"touchstart"===Pe.type&&(Te=Pe.changedTouches[0].clientY,de=Oe)}).on("drag",function(){var Pe=g.event.sourceEvent;"touchmove"===Pe.type&&Ne(Oe=function(Re,Ge,tt){return t.constrain((Ge-tt)/De+Re,0,Me)}(de,Te,Pe.changedTouches[0].clientY),Ae,De)});V.call(Qe)}function Ne(Pe,Re,Ge){C._scrollY=S._fullLayout.legend._scrollY=Pe,i.setTranslate(V,0,-Pe),i.setRect(ee,C._width,p.scrollBarMargin+Pe*Ge,p.scrollBarWidth,Re),X.select("rect").attr("y",ve+Pe)}S._context.edits.legendPosition&&(G.classed("cursor-move",!0),r.init({element:G.node(),gd:S,prepFn:function(){var Pe=i.getTranslate(G);ae=Pe.x,ce=Pe.y},moveFn:function(Pe,Re){var Ge=ae+Pe,tt=ce+Re;i.setTranslate(G,Ge,tt),J=r.align(Ge,0,oe.l,oe.l+oe.w,C.xanchor),te=r.align(tt,0,oe.t+oe.h,oe.t,C.yanchor)},doneFn:function(){void 0!==J&&void 0!==te&&x.call("_guiRelayout",S,{"legend.x":J,"legend.y":te})},clickFn:function(Pe,Re){var Ge=R.selectAll("g.traces").filter(function(){var tt=this.getBoundingClientRect();return Re.clientX>=tt.left&&Re.clientX<=tt.right&&Re.clientY>=tt.top&&Re.clientY<=tt.bottom});Ge.size()>0&&h(S,G,Ge,Pe,Re)}}))}],S)}}(P,z)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("./helpers");Q.exports=function(k,x){var e,r,i=x._inHover,c=t.isGrouped(x),n=t.isReversed(x),m={},p=[],s=!1,f={},l=0,o=0;function d(D,j){if(""!==D&&t.isGrouped(x))-1===p.indexOf(D)?(p.push(D),s=!0,m[D]=[j]):m[D].push(j);else{var q="~~i"+l;p.push(q),m[q]=[j],l++}}for(e=0;e<k.length;e++){var u=k[e],a=u[0],y=a.trace,h=y.legendgroup;if(i||y.visible&&y.showlegend)if(g.traceIs(y,"pie-like"))for(f[h]||(f[h]={}),r=0;r<u.length;r++){var _=u[r].label;f[h][_]||(d(h,{label:_,color:u[r].color,i:u[r].i,trace:y,pts:u[r].pts}),f[h][_]=!0,o=Math.max(o,(_||"").length))}else d(h,a),o=Math.max(o,(y.name||"").length)}if(!p.length)return[];var b=!s||!c,w=[];for(e=0;e<p.length;e++){var T=m[p[e]];w.push(b?T[0]:T)}for(b&&(w=[w]),e=0;e<w.length;e++){var L=1/0;for(r=0;r<w[e].length;r++){var M=w[e][r].trace.legendrank;L>M&&(L=M)}w[e][0]._groupMinRank=L,w[e][0]._preGroupSort=e}var P=function(D,j){return D.trace.legendrank-j.trace.legendrank||D._preSort-j._preSort};for(w.forEach(function(D,j){D[0]._preGroupSort=j}),w.sort(function(D,j){return D[0]._groupMinRank-j[0]._groupMinRank||D[0]._preGroupSort-j[0]._preGroupSort}),e=0;e<w.length;e++){w[e].forEach(function(D,j){D._preSort=j}),w[e].sort(P);var z=w[e][0].trace,S=null;for(r=0;r<w[e].length;r++){var C=w[e][r].trace.legendgrouptitle;if(C&&C.text){S=C,i&&(C.font=x._groupTitleFont);break}}if(n&&w[e].reverse(),S){var R=!1;for(r=0;r<w[e].length;r++)if(g.traceIs(w[e][r].trace,"pie-like")){R=!0;break}w[e].unshift({i:-1,groupTitle:S,noClick:R,trace:{showlegend:z.showlegend,legendgroup:z.legendgroup,visible:"toggleitem"===x.groupclick||z.visible}})}for(r=0;r<w[e].length;r++)w[e][r]=[w[e][r]]}return x._lgroupsLength=w.length,x._maxNameLength=o,w}},{"../../registry":647,"./helpers":423}],422:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry"),k=!0;Q.exports=function(x,e,r){var i=e._fullLayout;if(!e._dragged&&!e._editing){var c,n=i.legend.itemclick,m=i.legend.itemdoubleclick,p=i.legend.groupclick;if(1===r&&"toggle"===n&&"toggleothers"===m&&k&&e.data&&e._context.showTips&&g.notifier(g._(e,"Double-click on legend to isolate one trace"),"long"),k=!1,1===r?c=n:2===r&&(c=m),c){var s="togglegroup"===p,f=i.hiddenlabels?i.hiddenlabels.slice():[],l=x.data()[0][0];if(!l.groupTitle||!l.noClick){var o,d,u,a,y,h=e._fullData,_=l.trace,b=_.legendgroup,w={},T=[],L=[],M=[];if(t.traceIs(_,"pie-like")){var P=l.label,z=f.indexOf(P);"toggle"===c?-1===z?f.push(P):f.splice(z,1):"toggleothers"===c&&(f=[],e.calcdata[0].forEach(function(U){P!==U.label&&f.push(U.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===f.length&&-1===z&&(f=[])),t.call("_guiRelayout",e,"hiddenlabels",f)}else{var S,C=b&&b.length,R=[];if(C)for(o=0;o<h.length;o++)(S=h[o]).visible&&S.legendgroup===b&&R.push(o);if("toggle"===c){var D;switch(_.visible){case!0:D="legendonly";break;case!1:D=!1;break;case"legendonly":D=!0}if(C)if(s)for(o=0;o<h.length;o++)!1!==h[o].visible&&h[o].legendgroup===b&&N(h[o],D);else N(_,D);else N(_,D)}else if("toggleothers"===c){var Z,G=!0;for(o=0;o<h.length;o++)if(Z=!0!==h[o].showlegend,!(h[o]===_||Z||C&&h[o].legendgroup===b||!0!==h[o].visible||t.traceIs(h[o],"notLegendIsolatable"))){G=!1;break}for(o=0;o<h.length;o++)if(!1!==h[o].visible&&!t.traceIs(h[o],"notLegendIsolatable"))switch(_.visible){case"legendonly":N(h[o],!0);break;case!0:Z=!0!==h[o].showlegend&&!h[o].legendgroup,N(h[o],!!(h[o]===_||C&&h[o].legendgroup===b||Z)||!!G||"legendonly")}}for(o=0;o<L.length;o++)if(u=L[o]){var X=u.constructUpdate(),ne=Object.keys(X);for(d=0;d<ne.length;d++)(w[a=ne[d]]=w[a]||[])[M[o]]=X[a]}for(y=Object.keys(w),o=0;o<y.length;o++)for(a=y[o],d=0;d<T.length;d++)w[a].hasOwnProperty(d)||(w[a][d]=void 0);t.call("_guiRestyle",e,w,T)}}}}function V(U,ee,B){var K=T.indexOf(U),J=w[ee];return J||(J=w[ee]=[]),-1===T.indexOf(U)&&(T.push(U),K=T.length-1),J[K]=B,K}function N(U,ee){if(!l.groupTitle||s){var B=U._fullInput;if(t.hasTransform(B,"groupby")){var K=L[B.index];if(!K){var J=t.getTransformIndices(B,"groupby");K=g.keyedContainer(B,"transforms["+J[J.length-1]+"].styles","target","value.visible"),L[B.index]=K}var ae=K.get(U._group);void 0===ae&&(ae=!0),!1!==ae&&K.set(U._group,ee),M[B.index]=V(B.index,"visible",!1!==B.visible)}else V(B.index,"visible",!1!==B.visible&&ee)}}}},{"../../lib":515,"../../registry":647}],423:[function(v,Q,$){"use strict";$.isGrouped=function(g){return-1!==(g.traceorder||"").indexOf("grouped")},$.isVertical=function(g){return"h"!==g.orientation},$.isReversed=function(g){return-1!==(g.traceorder||"").indexOf("reversed")}},{}],424:[function(v,Q,$){"use strict";Q.exports={moduleType:"component",name:"legend",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),draw:v("./draw"),style:v("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../lib"),x=k.strTranslate,e=v("../drawing"),r=v("../color"),i=v("../colorscale/helpers").extractOpts,c=v("../../traces/scatter/subtypes"),n=v("../../traces/pie/style_one"),m=v("../../traces/pie/helpers").castOption,p=v("./constants");function s(o,d){return(d?"radial":"horizontal")+(o?"":"reversed")}function f(o){var d=o[0].trace,u=d.contours,a=c.hasLines(d),y=c.hasMarkers(d),h=d.visible&&d.fill&&"none"!==d.fill,_=!1,b=!1;if(u){var w=u.coloring;"lines"===w?_=!0:a="none"===w||"heatmap"===w||u.showlines,"constraint"===u.type?h="="!==u._operation:"fill"!==w&&"heatmap"!==w||(b=!0)}return{showMarker:y,showLine:a,showFill:h,showGradientLine:_,showGradientFill:b,anyLine:a||_,anyFill:h||b}}function l(o,d,u){return o&&k.isArrayOrTypedArray(o)?d:o>u?u:o}Q.exports=function(o,d,u){u||(u=d._fullLayout.legend);var y="constant"===u.itemsizing,h=u.itemwidth,b=x((h+2*p.itemGap)/2,0),w=function(M,P,z,S){var C;if(M+1)C=M;else{if(!(P&&P.width>0))return 0;C=P.width}return y?S:Math.min(C,z)};function T(M,P,z){var S=M[0].trace,C=S.marker||{},R=C.line||{},D=z?S.visible&&S.type===z:t.traceIs(S,"bar"),j=g.select(P).select("g.legendpoints").selectAll("path.legend"+z).data(D?[M]:[]);j.enter().append("path").classed("legend"+z,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),j.exit().remove(),j.each(function(q){var Z=g.select(this),W=q[0],G=w(W.mlw,C.line,5,2);Z.style("stroke-width",G+"px");var X=W.mcc;if(!u._inHover&&"mc"in W){var ne=i(C),V=ne.mid;void 0===V&&(V=(ne.max+ne.min)/2),X=e.tryColorscale(C,"")(V)}var N=X||W.mc||C.color,U=C.pattern,ee=U&&e.getPatternAttr(U.shape,0,"");if(ee){var B=e.getPatternAttr(U.bgcolor,0,null),K=e.getPatternAttr(U.fgcolor,0,null),J=U.fgopacity,te=l(U.size,8,10),ae=l(U.solidity,.5,1);Z.call(e.pattern,"legend",d,"legend-"+S.uid,ee,te,ae,X,U.fillmode,B,K,J)}else Z.call(r.fill,N);G&&r.stroke(Z,W.mlc||R.color)})}function L(M,P,z){var S=M[0],C=S.trace,R=z?C.visible&&C.type===z:t.traceIs(C,z),D=g.select(P).select("g.legendpoints").selectAll("path.legend"+z).data(R?[M]:[]);if(D.enter().append("path").classed("legend"+z,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),D.exit().remove(),D.size()){var j=(C.marker||{}).line,q=w(m(j.width,S.pts),j,5,2),Z=k.minExtend(C,{marker:{line:{width:q}}});Z.marker.line.color=j.color;var W=k.minExtend(S,{trace:Z});n(D,W,Z)}}o.each(function(M){var P=g.select(this),z=k.ensureSingle(P,"g","layers");z.style("opacity",M[0].trace.opacity);var S=u.valign,C=M[0].lineHeight,R=M[0].height;z.attr("transform","middle"!==S&&C&&R?x(0,{top:1,bottom:-1}[S]*(.5*(C-R+3))):null),z.selectAll("g.legendfill").data([M]).enter().append("g").classed("legendfill",!0),z.selectAll("g.legendlines").data([M]).enter().append("g").classed("legendlines",!0);var j=z.selectAll("g.legendsymbols").data([M]);j.enter().append("g").classed("legendsymbols",!0),j.selectAll("g.legendpoints").data([M]).enter().append("g").classed("legendpoints",!0)}).each(function(M){var P,z=M[0].trace,S=[];if(z.visible)switch(z.type){case"histogram2d":case"heatmap":S=[["M-15,-2V4H15V-2Z"]],P=!0;break;case"choropleth":case"choroplethmapbox":S=[["M-6,-6V6H6V-6Z"]],P=!0;break;case"densitymapbox":S=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],P="radial";break;case"cone":S=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],P=!1;break;case"streamtube":S=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],P=!1;break;case"surface":S=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],P=!0;break;case"mesh3d":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],P=!1;break;case"volume":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],P=!0;break;case"isosurface":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],P=!1}var C=g.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(S);C.enter().append("path").classed("legend3dandfriends",!0).attr("transform",b).style("stroke-miterlimit",1),C.exit().remove(),C.each(function(R,D){var j,q=g.select(this),Z=i(z),W=Z.colorscale,G=Z.reversescale;if(W){if(!P){var X=W.length;j=0===D?W[G?X-1:0][1]:1===D?W[G?0:X-1][1]:W[Math.floor((X-1)/2)][1]}}else{var ne=z.vertexcolor||z.facecolor||z.color;j=k.isArrayOrTypedArray(ne)?ne[D]||ne[0]:ne}q.attr("d",R[0]),j?q.call(r.fill,j):q.call(function(V){V.size()&&e.gradient(V,d,"legendfill-"+z.uid,s(G,"radial"===P),W,"fill")})})}).each(function(M){var P=M[0].trace,z="waterfall"===P.type;if(M[0]._distinct&&z){var S=M[0].trace[M[0].dir].marker;return M[0].mc=S.color,M[0].mlw=S.line.width,M[0].mlc=S.line.color,T(M,this,"waterfall")}var C=[];P.visible&&z&&(C=M[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var R=g.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(C);R.enter().append("path").classed("legendwaterfall",!0).attr("transform",b).style("stroke-miterlimit",1),R.exit().remove(),R.each(function(D){var j=g.select(this),q=P[D[0]].marker,Z=w(void 0,q.line,5,2);j.attr("d",D[1]).style("stroke-width",Z+"px").call(r.fill,q.color),Z&&j.call(r.stroke,q.line.color)})}).each(function(M){T(M,this,"funnel")}).each(function(M){T(M,this)}).each(function(M){var P=M[0].trace,z=g.select(this).select("g.legendpoints").selectAll("path.legendbox").data(P.visible&&t.traceIs(P,"box-violin")?[M]:[]);z.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),z.exit().remove(),z.each(function(){var S=g.select(this);if("all"!==P.boxpoints&&"all"!==P.points||0!==r.opacity(P.fillcolor)||0!==r.opacity((P.line||{}).color)){var C=w(void 0,P.line,5,2);S.style("stroke-width",C+"px").call(r.fill,P.fillcolor),C&&r.stroke(S,P.line.color)}else{var R=k.minExtend(P,{marker:{size:y?12:k.constrain(P.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});z.call(e.pointStyle,R,d)}})}).each(function(M){L(M,this,"funnelarea")}).each(function(M){L(M,this,"pie")}).each(function(M){var P,z,S=f(M),C=S.showFill,R=S.showLine,D=S.showGradientLine,j=S.showGradientFill,q=S.anyFill,Z=S.anyLine,W=M[0],G=W.trace,X=i(G),ne=X.colorscale,V=X.reversescale,N=c.hasMarkers(G)||!q?"M5,0":Z?"M5,-2":"M5,-3",U=g.select(this),ee=U.select(".legendfill").selectAll("path").data(C||j?[M]:[]);if(ee.enter().append("path").classed("js-fill",!0),ee.exit().remove(),ee.attr("d",N+"h"+h+"v6h-"+h+"z").call(function(J){J.size()&&(C?e.fillGroupStyle(J,d):e.gradient(J,d,"legendfill-"+G.uid,s(V),ne,"fill"))}),R||D){var B=w(void 0,G.line,10,5);z=k.minExtend(G,{line:{width:B}}),P=[k.minExtend(W,{trace:z})]}var K=U.select(".legendlines").selectAll("path").data(R||D?[P]:[]);K.enter().append("path").classed("js-line",!0),K.exit().remove(),K.attr("d",N+(D?"l"+h+",0.0001":"h"+h)).call(R?e.lineGroupStyle:function(J){if(J.size()){var te="legendline-"+G.uid;e.lineGroupStyle(J),e.gradient(J,d,te,s(V),ne,"stroke")}})}).each(function(M){var P,z,S=f(M),D=S.showLine,j=S.showMarker,q=M[0],Z=q.trace,W=!j&&!S.anyLine&&!S.anyFill&&c.hasText(Z);function G(K,J,te,ae){var ce=k.nestedProperty(Z,K).get(),oe=k.isArrayOrTypedArray(ce)&&J?J(ce):ce;if(y&&oe&&void 0!==ae&&(oe=ae),te){if(oe<te[0])return te[0];if(oe>te[1])return te[1]}return oe}function X(K){return q._distinct&&q.index&&K[q.index]?K[q.index]:K[0]}if(j||W||D){var ne={},V={};if(j){ne.mc=G("marker.color",X),ne.mx=G("marker.symbol",X),ne.mo=G("marker.opacity",k.mean,[.2,1]),ne.mlc=G("marker.line.color",X),ne.mlw=G("marker.line.width",k.mean,[0,5],2),V.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var N=G("marker.size",k.mean,[2,16],12);ne.ms=N,V.marker.size=N}D&&(V.line={width:G("line.width",X,[0,10],5)}),W&&(ne.tx="Aa",ne.tp=G("textposition",X),ne.ts=10,ne.tc=G("textfont.color",X),ne.tf=G("textfont.family",X)),P=[k.minExtend(q,ne)],(z=k.minExtend(Z,V)).selectedpoints=null,z.texttemplate=null}var U=g.select(this).select("g.legendpoints"),ee=U.selectAll("path.scatterpts").data(j?P:[]);ee.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",b),ee.exit().remove(),ee.call(e.pointStyle,z,d),j&&(P[0].mrc=3);var B=U.selectAll("g.pointtext").data(W?P:[]);B.enter().append("g").classed("pointtext",!0).append("text").attr("transform",b),B.exit().remove(),B.selectAll("text").call(e.textPointStyle,z,d)}).each(function(M){var P=M[0].trace,z=g.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(P.visible&&"candlestick"===P.type?[M,M]:[]);z.enter().append("path").classed("legendcandle",!0).attr("d",function(S,C){return C?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",b).style("stroke-miterlimit",1),z.exit().remove(),z.each(function(S,C){var R=g.select(this),D=P[C?"increasing":"decreasing"],j=w(void 0,D.line,5,2);R.style("stroke-width",j+"px").call(r.fill,D.fillcolor),j&&r.stroke(R,D.line.color)})}).each(function(M){var P=M[0].trace,z=g.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(P.visible&&"ohlc"===P.type?[M,M]:[]);z.enter().append("path").classed("legendohlc",!0).attr("d",function(S,C){return C?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",b).style("stroke-miterlimit",1),z.exit().remove(),z.each(function(S,C){var R=g.select(this),D=P[C?"increasing":"decreasing"],j=w(void 0,D.line,5,2);R.style("fill","none").call(e.dashLine,D.line.dash,j),j&&r.stroke(R,D.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(v,Q,$){"use strict";v("./constants"),Q.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../plots/plots"),k=v("../../plots/cartesian/axis_ids"),x=v("../../fonts/ploticon"),e=v("../shapes/draw").eraseActiveShape,r=v("../../lib"),i=r._,c=Q.exports={};function n(a,y){var h,_,b=y.currentTarget,w=b.getAttribute("data-attr"),T=b.getAttribute("data-val")||!0,L=a._fullLayout,M={},P=k.list(a,null,!0),z=L._cartesianSpikesEnabled;if("zoom"===w){var S,C="in"===T?.5:2,R=(1+C)/2,D=(1-C)/2;for(_=0;_<P.length;_++)if(!(h=P[_]).fixedrange)if(S=h._name,"auto"===T)M[S+".autorange"]=!0;else if("reset"===T){if(void 0===h._rangeInitial)M[S+".autorange"]=!0;else{var j=h._rangeInitial.slice();M[S+".range[0]"]=j[0],M[S+".range[1]"]=j[1]}void 0!==h._showSpikeInitial&&(M[S+".showspikes"]=h._showSpikeInitial,"on"!==z||h._showSpikeInitial||(z="off"))}else{var q=[h.r2l(h.range[0]),h.r2l(h.range[1])],Z=[R*q[0]+D*q[1],R*q[1]+D*q[0]];M[S+".range[0]"]=h.l2r(Z[0]),M[S+".range[1]"]=h.l2r(Z[1])}}else"hovermode"!==w||"x"!==T&&"y"!==T||b.setAttribute("data-val",T=L._isHoriz?"y":"x"),M[w]=T;L._cartesianSpikesEnabled=z,g.call("_guiRelayout",a,M)}function m(a,y){for(var h=y.currentTarget,_=h.getAttribute("data-attr"),b=h.getAttribute("data-val")||!0,w=a._fullLayout._subplots.gl3d||[],T={},L=_.split("."),M=0;M<w.length;M++)T[w[M]+"."+L[1]]=b;T.dragmode="pan"===b?b:"zoom",g.call("_guiRelayout",a,T)}function p(a,y){for(var h=y.currentTarget.getAttribute("data-attr"),_="resetLastSave"===h,b="resetDefault"===h,w=a._fullLayout,T=w._subplots.gl3d||[],L={},M=0;M<T.length;M++){var P,z=T[M],S=z+".camera",C=z+".aspectratio",R=z+".aspectmode",D=w[z]._scene;_?(L[S+".up"]=D.viewInitial.up,L[S+".eye"]=D.viewInitial.eye,L[S+".center"]=D.viewInitial.center,P=!0):b&&(L[S+".up"]=null,L[S+".eye"]=null,L[S+".center"]=null,P=!0),P&&(L[C+".x"]=D.viewInitial.aspectratio.x,L[C+".y"]=D.viewInitial.aspectratio.y,L[C+".z"]=D.viewInitial.aspectratio.z,L[R]=D.viewInitial.aspectmode)}g.call("_guiRelayout",a,L)}function s(a,y){var h=y.currentTarget,_=h._previousVal,b=a._fullLayout,w=b._subplots.gl3d||[],T=["xaxis","yaxis","zaxis"],L={},M={};if(_)M=_,h._previousVal=null;else{for(var P=0;P<w.length;P++){var z=w[P],S=b[z],C=z+".hovermode";L[C]=S.hovermode,M[C]=!1;for(var R=0;R<3;R++){var D=T[R],j=z+"."+D+".showspikes";M[j]=!1,L[j]=S[D].showspikes}}h._previousVal=L}return M}function f(a,y){for(var h=y.currentTarget,_=h.getAttribute("data-attr"),b=h.getAttribute("data-val")||!0,w=a._fullLayout,T=w._subplots.geo||[],L=0;L<T.length;L++){var M=T[L];if("zoom"===_){var z=w[M].projection.scale;g.call("_guiRelayout",a,M+".projection.scale","in"===b?2*z:.5*z)}}"reset"===_&&u(a,"geo")}function l(a){var y=a._fullLayout;return!y.hovermode&&(y._has("cartesian")?y._isHoriz?"y":"x":"closest")}function o(a){var y=l(a);g.call("_guiRelayout",a,"hovermode",y)}function d(a,y){for(var h=y.currentTarget.getAttribute("data-val"),_=a._fullLayout,b=_._subplots.mapbox||[],w={},T=0;T<b.length;T++){var L=b[T],M=_[L].zoom;w[L+".zoom"]="in"===h?1.05*M:M/1.05}g.call("_guiRelayout",a,w)}function u(a,y){for(var h=a._fullLayout,_=h._subplots[y]||[],b={},w=0;w<_.length;w++)for(var T=_[w],L=h[T]._subplot.viewInitial,M=Object.keys(L),P=0;P<M.length;P++){var z=M[P];b[T+"."+z]=L[z]}g.call("_guiRelayout",a,b)}c.toImage={name:"toImage",title:function(a){return i(a,"png"===((a._context.toImageButtonOptions||{}).format||"png")?"Download plot as a png":"Download plot")},icon:x.camera,click:function(a){var y=a._context.toImageButtonOptions,h={format:y.format||"png"};r.notifier(i(a,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==h.format&&r.isIE()&&(r.notifier(i(a,"IE only supports svg.  Changing format to svg."),"long"),h.format="svg"),["filename","width","height","scale"].forEach(function(_){_ in y&&(h[_]=y[_])}),g.call("downloadImage",a,h).then(function(_){r.notifier(i(a,"Snapshot succeeded")+" - "+_,"long")}).catch(function(){r.notifier(i(a,"Sorry, there was a problem downloading your snapshot!"),"long")})}},c.sendDataToCloud={name:"sendDataToCloud",title:function(a){return i(a,"Edit in Chart Studio")},icon:x.disk,click:function(a){t.sendDataToCloud(a)}},c.editInChartStudio={name:"editInChartStudio",title:function(a){return i(a,"Edit in Chart Studio")},icon:x.pencil,click:function(a){t.sendDataToCloud(a)}},c.zoom2d={name:"zoom2d",_cat:"zoom",title:function(a){return i(a,"Zoom")},attr:"dragmode",val:"zoom",icon:x.zoombox,click:n},c.pan2d={name:"pan2d",_cat:"pan",title:function(a){return i(a,"Pan")},attr:"dragmode",val:"pan",icon:x.pan,click:n},c.select2d={name:"select2d",_cat:"select",title:function(a){return i(a,"Box Select")},attr:"dragmode",val:"select",icon:x.selectbox,click:n},c.lasso2d={name:"lasso2d",_cat:"lasso",title:function(a){return i(a,"Lasso Select")},attr:"dragmode",val:"lasso",icon:x.lasso,click:n},c.drawclosedpath={name:"drawclosedpath",title:function(a){return i(a,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:x.drawclosedpath,click:n},c.drawopenpath={name:"drawopenpath",title:function(a){return i(a,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:x.drawopenpath,click:n},c.drawline={name:"drawline",title:function(a){return i(a,"Draw line")},attr:"dragmode",val:"drawline",icon:x.drawline,click:n},c.drawrect={name:"drawrect",title:function(a){return i(a,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:x.drawrect,click:n},c.drawcircle={name:"drawcircle",title:function(a){return i(a,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:x.drawcircle,click:n},c.eraseshape={name:"eraseshape",title:function(a){return i(a,"Erase active shape")},icon:x.eraseshape,click:e},c.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(a){return i(a,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:n},c.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(a){return i(a,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:n},c.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(a){return i(a,"Autoscale")},attr:"zoom",val:"auto",icon:x.autoscale,click:n},c.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(a){return i(a,"Reset axes")},attr:"zoom",val:"reset",icon:x.home,click:n},c.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(a){return i(a,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:x.tooltip_basic,gravity:"ne",click:n},c.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(a){return i(a,"Compare data on hover")},attr:"hovermode",val:function(a){return a._fullLayout._isHoriz?"y":"x"},icon:x.tooltip_compare,gravity:"ne",click:n},c.zoom3d={name:"zoom3d",_cat:"zoom",title:function(a){return i(a,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:x.zoombox,click:m},c.pan3d={name:"pan3d",_cat:"pan",title:function(a){return i(a,"Pan")},attr:"scene.dragmode",val:"pan",icon:x.pan,click:m},c.orbitRotation={name:"orbitRotation",title:function(a){return i(a,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:x["3d_rotate"],click:m},c.tableRotation={name:"tableRotation",title:function(a){return i(a,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:x["z-axis"],click:m},c.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(a){return i(a,"Reset camera to default")},attr:"resetDefault",icon:x.home,click:p},c.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(a){return i(a,"Reset camera to last save")},attr:"resetLastSave",icon:x.movie,click:p},c.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(a){return i(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:function(a,y){var h=s(a,y);g.call("_guiRelayout",a,h)}},c.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(a){return i(a,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:f},c.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(a){return i(a,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:f},c.resetGeo={name:"resetGeo",_cat:"reset",title:function(a){return i(a,"Reset")},attr:"reset",val:null,icon:x.autoscale,click:f},c.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(a){return i(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:o},c.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(a){return i(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:o},c.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(a){return i(a,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:x.tooltip_basic,gravity:"ne",click:o},c.resetViewSankey={name:"resetSankeyGroup",title:function(a){return i(a,"Reset view")},icon:x.home,click:function(a){for(var y={"node.groups":[],"node.x":[],"node.y":[]},h=0;h<a._fullData.length;h++){var _=a._fullData[h]._viewInitial;y["node.groups"].push(_.node.groups.slice()),y["node.x"].push(_.node.x.slice()),y["node.y"].push(_.node.y.slice())}g.call("restyle",a,y)}},c.toggleHover={name:"toggleHover",title:function(a){return i(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:function(a,y){var h=s(a,y);h.hovermode=l(a),g.call("_guiRelayout",a,h)}},c.resetViews={name:"resetViews",title:function(a){return i(a,"Reset views")},icon:x.home,click:function(a,y){var h=y.currentTarget;h.setAttribute("data-attr","zoom"),h.setAttribute("data-val","reset"),n(a,y),h.setAttribute("data-attr","resetLastSave"),p(a,y),u(a,"geo"),u(a,"mapbox")}},c.toggleSpikelines={name:"toggleSpikelines",title:function(a){return i(a,"Toggle Spike Lines")},icon:x.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(a){var y=a._fullLayout;y._cartesianSpikesEnabled="on"===y._cartesianSpikesEnabled?"off":"on",g.call("_guiRelayout",a,function(_){for(var b="on"===_._fullLayout._cartesianSpikesEnabled,w=k.list(_,null,!0),T={},L=0;L<w.length;L++){var M=w[L];T[M._name+".showspikes"]=!!b||M._showSpikeInitial}return T}(a))}},c.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(a){return i(a,"Reset view")},attr:"reset",icon:x.home,click:function(a){u(a,"mapbox")}},c.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(a){return i(a,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:d},c.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(a){return i(a,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:d}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(v,Q,$){"use strict";var g=v("./buttons"),t=Object.keys(g),k=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],x=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(k),e=[];t.forEach(function(r){!function(i){if(-1===x.indexOf(i._cat||i.name)){var c=i.name,n=(i._cat||i.name).toLowerCase();-1===e.indexOf(c)&&e.push(c),-1===e.indexOf(n)&&e.push(n)}}(g[r])}),e.sort(),Q.exports={DRAW_MODES:k,backButtons:x,foreButtons:e}},{"./buttons":427}],429:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../color"),k=v("../../plot_api/plot_template"),x=v("./attributes");Q.exports=function(e,r){var i=e.modebar||{},c=k.newContainer(r,"modebar");function n(p,s){return g.coerce(i,c,x,p,s)}n("orientation"),n("bgcolor",t.addOpacity(r.paper_bgcolor,.5));var m=t.contrast(t.rgb(r.modebar.bgcolor));n("color",t.addOpacity(m,.3)),n("activecolor",t.addOpacity(m,.7)),n("uirevision",r.uirevision),n("add"),n("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(v,Q,$){"use strict";Q.exports={moduleType:"component",name:"modebar",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),manage:v("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axis_ids"),t=v("../../traces/scatter/subtypes"),k=v("../../registry"),x=v("../fx/helpers").isUnifiedHover,e=v("./modebar"),r=v("./buttons"),i=v("./constants").DRAW_MODES,c=v("../../lib").extendDeep;Q.exports=function(n){var m=n._fullLayout,p=n._context,s=m._modeBar;if(p.displayModeBar||p.watermark){if(!Array.isArray(p.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(p.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var f,l=p.modeBarButtons;f=Array.isArray(l)&&l.length?function(o){for(var d=c([],o),u=0;u<d.length;u++)for(var a=d[u],y=0;y<a.length;y++){var h=a[y];if("string"==typeof h){if(void 0===r[h])throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));d[u][y]=r[h]}}return d}(l):!p.displayModeBar&&p.watermark?[]:function(o){var d=o._fullLayout,u=o._fullData,a=o._context;function y(ce,oe){if("string"==typeof oe){if(oe.toLowerCase()===ce.toLowerCase())return!0}else if(oe.name===ce||(oe._cat||oe.name)===ce.toLowerCase())return!0;return!1}var h=d.modebar.add;"string"==typeof h&&(h=[h]);var _=d.modebar.remove;"string"==typeof _&&(_=[_]);var b=a.modeBarButtonsToAdd.concat(h.filter(function(ce){for(var oe=0;oe<a.modeBarButtonsToRemove.length;oe++)if(y(ce,a.modeBarButtonsToRemove[oe]))return!1;return!0})),w=a.modeBarButtonsToRemove.concat(_.filter(function(ce){for(var oe=0;oe<a.modeBarButtonsToAdd.length;oe++)if(y(ce,a.modeBarButtonsToAdd[oe]))return!1;return!0})),T=d._has("cartesian"),L=d._has("gl3d"),M=d._has("geo"),P=d._has("pie"),z=d._has("funnelarea"),S=d._has("gl2d"),C=d._has("ternary"),R=d._has("mapbox"),D=d._has("polar"),j=d._has("smith"),q=d._has("sankey"),Z=function(ce){for(var oe=g.list({_fullLayout:ce},null,!0),ve=0;ve<oe.length;ve++)if(!oe[ve].fixedrange)return!1;return!0}(d),W=x(d.hovermode),G=[];function X(ce){if(ce.length){for(var oe=[],ve=0;ve<ce.length;ve++){for(var fe=ce[ve],xe=r[fe],Se=xe.name.toLowerCase(),pe=(xe._cat||xe.name).toLowerCase(),ge=!1,Te=0;Te<w.length;Te++){var se=w[Te].toLowerCase();if(se===Se||se===pe){ge=!0;break}}ge||oe.push(r[fe])}G.push(oe)}}var ne=["toImage"];a.showEditInChartStudio?ne.push("editInChartStudio"):a.showSendToCloud&&ne.push("sendDataToCloud"),X(ne);var V=[],N=[],U=[],ee=[];(T||S||P||z||C)+M+L+R+D+j>1?(N=["toggleHover"],U=["resetViews"]):M?(V=["zoomInGeo","zoomOutGeo"],N=["hoverClosestGeo"],U=["resetGeo"]):L?(N=["hoverClosest3d"],U=["resetCameraDefault3d","resetCameraLastSave3d"]):R?(V=["zoomInMapbox","zoomOutMapbox"],N=["toggleHover"],U=["resetViewMapbox"]):S?N=["hoverClosestGl2d"]:P?N=["hoverClosestPie"]:q?(N=["hoverClosestCartesian","hoverCompareCartesian"],U=["resetViewSankey"]):N=["toggleHover"],T&&(N=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(ce){for(var oe=0;oe<ce.length;oe++)if(!k.traceIs(ce[oe],"noHover"))return!1;return!0}(u)||W)&&(N=[]),!T&&!S||Z||(V=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==U[0]&&(U=["resetScale2d"])),L?ee=["zoom3d","pan3d","orbitRotation","tableRotation"]:(T||S)&&!Z||C?ee=["zoom2d","pan2d"]:R||M?ee=["pan2d"]:D&&(ee=["zoom2d"]),function(ce){for(var oe=!1,ve=0;ve<ce.length&&!oe;ve++){var fe=ce[ve];fe._module&&fe._module.selectPoints&&(k.traceIs(fe,"scatter-like")?(t.hasMarkers(fe)||t.hasText(fe))&&(oe=!0):k.traceIs(fe,"box-violin")&&"all"!==fe.boxpoints&&"all"!==fe.points||(oe=!0))}return oe}(u)&&ee.push("select2d","lasso2d");var B=[],K=function(ce){-1===B.indexOf(ce)&&-1!==N.indexOf(ce)&&B.push(ce)};if(Array.isArray(b)){for(var J=[],te=0;te<b.length;te++){var ae=b[te];"string"==typeof ae?(ae=ae.toLowerCase(),-1!==i.indexOf(ae)?(d._has("mapbox")||d._has("cartesian"))&&ee.push(ae):"togglespikelines"===ae?K("toggleSpikelines"):"togglehover"===ae?K("toggleHover"):"hovercompare"===ae?K("hoverCompareCartesian"):"hoverclosest"===ae?(K("hoverClosestCartesian"),K("hoverClosestGeo"),K("hoverClosest3d"),K("hoverClosestGl2d"),K("hoverClosestPie")):"v1hovermode"===ae&&(K("toggleHover"),K("hoverClosestCartesian"),K("hoverCompareCartesian"),K("hoverClosestGeo"),K("hoverClosest3d"),K("hoverClosestGl2d"),K("hoverClosestPie"))):J.push(ae)}b=J}return X(ee),X(V.concat(U)),X(B),function(ce,oe){if(oe.length)if(Array.isArray(oe[0]))for(var ve=0;ve<oe.length;ve++)ce.push(oe[ve]);else ce.push(oe);return ce}(G,b)}(n),s?s.update(n,f):m._modeBar=e(n,f)}else s&&(s.destroy(),delete m._modeBar)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../../lib"),x=v("../../fonts/ploticon"),e=v("../../version").version,r=new DOMParser;function i(n){this.container=n.container,this.element=document.createElement("div"),this.update(n.graphInfo,n.buttons),this.container.appendChild(this.element)}var c=i.prototype;c.update=function(n,m){this.graphInfo=n;var p=this.graphInfo._context,s=this.graphInfo._fullLayout,f="modebar-"+s._uid;this.element.setAttribute("id",f),this._uid=f,this.element.className="modebar","hover"===p.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===s.modebar.orientation&&(this.element.className+=" vertical",m=m.reverse());var l=s.modebar,o="hover"===p.displayModeBar?".js-plotly-plot .plotly:hover ":"";k.deleteRelatedStyleRule(f),k.addRelatedStyleRule(f,o+"#"+f+" .modebar-group","background-color: "+l.bgcolor),k.addRelatedStyleRule(f,"#"+f+" .modebar-btn .icon path","fill: "+l.color),k.addRelatedStyleRule(f,"#"+f+" .modebar-btn:hover .icon path","fill: "+l.activecolor),k.addRelatedStyleRule(f,"#"+f+" .modebar-btn.active .icon path","fill: "+l.activecolor);var d=!this.hasButtons(m),u=this.hasLogo!==p.displaylogo,a=this.locale!==p.locale;if(this.locale=p.locale,(d||u||a)&&(this.removeAllButtons(),this.updateButtons(m),p.watermark||p.displaylogo)){var y=this.getLogo();p.watermark&&(y.className=y.className+" watermark"),"v"===s.modebar.orientation?this.element.insertBefore(y,this.element.childNodes[0]):this.element.appendChild(y),this.hasLogo=!0}this.updateActiveButton()},c.updateButtons=function(n){var m=this;this.buttons=n,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(p){var s=m.createGroup();p.forEach(function(f){var l=f.name;if(!l)throw new Error("must provide button 'name' in button config");if(-1!==m.buttonsNames.indexOf(l))throw new Error("button name '"+l+"' is taken");m.buttonsNames.push(l);var o=m.createButton(f);m.buttonElements.push(o),s.appendChild(o)}),m.element.appendChild(s)})},c.createGroup=function(){var n=document.createElement("div");return n.className="modebar-group",n},c.createButton=function(n){var m=this,p=document.createElement("a");p.setAttribute("rel","tooltip"),p.className="modebar-btn";var s=n.title;void 0===s?s=n.name:"function"==typeof s&&(s=s(this.graphInfo)),(s||0===s)&&p.setAttribute("data-title",s),void 0!==n.attr&&p.setAttribute("data-attr",n.attr);var f=n.val;if(void 0!==f&&("function"==typeof f&&(f=f(this.graphInfo)),p.setAttribute("data-val",f)),"function"!=typeof n.click)throw new Error("must provide button 'click' function in button config");p.addEventListener("click",function(o){n.click(m.graphInfo,o),m.updateActiveButton(o.currentTarget)}),p.setAttribute("data-toggle",n.toggle||!1),n.toggle&&g.select(p).classed("active",!0);var l=n.icon;return p.appendChild("function"==typeof l?l():this.createIcon(l||x.question)),p.setAttribute("data-gravity",n.gravity||"n"),p},c.createIcon=function(n){var m,p=t(n.height)?Number(n.height):n.ascent-n.descent,s="http://www.w3.org/2000/svg";if(n.path){(m=document.createElementNS(s,"svg")).setAttribute("viewBox",[0,0,n.width,p].join(" ")),m.setAttribute("class","icon");var f=document.createElementNS(s,"path");f.setAttribute("d",n.path),n.transform?f.setAttribute("transform",n.transform):void 0!==n.ascent&&f.setAttribute("transform","matrix(1 0 0 -1 0 "+n.ascent+")"),m.appendChild(f)}return n.svg&&(m=r.parseFromString(n.svg,"application/xml").childNodes[0]),m.setAttribute("height","1em"),m.setAttribute("width","1em"),m},c.updateActiveButton=function(n){var m=this.graphInfo._fullLayout,p=void 0!==n?n.getAttribute("data-attr"):null;this.buttonElements.forEach(function(s){var f=s.getAttribute("data-val")||!0,l=s.getAttribute("data-attr"),o="true"===s.getAttribute("data-toggle"),d=g.select(s);if(o)l===p&&d.classed("active",!d.classed("active"));else{var u=null===l?l:k.nestedProperty(m,l).get();d.classed("active",u===f)}})},c.hasButtons=function(n){var m=this.buttons;if(!m||n.length!==m.length)return!1;for(var p=0;p<n.length;++p){if(n[p].length!==m[p].length)return!1;for(var s=0;s<n[p].length;s++)if(n[p][s].name!==m[p][s].name)return!1}return!0},c.getLogo=function(){var n=this.createGroup(),m=document.createElement("a");return m.href="https://plotly.com/",m.target="_blank",m.setAttribute("data-title",k._(this.graphInfo,"Produced with Plotly.js")+" (v"+e+")"),m.className="modebar-btn plotlyjsicon modebar-btn--logo",m.appendChild(this.createIcon(x.newplotlylogo)),n.appendChild(m),n},c.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},c.destroy=function(){k.removeElement(this.container.querySelector(".modebar")),k.deleteRelatedStyleRule(this._uid)},Q.exports=function(n,m){var p=n._fullLayout,s=new i({graphInfo:n,container:p._modebardiv.node(),buttons:m});return p._privateplot&&g.select(s.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),s}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("../color/attributes"),k=(0,v("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});Q.exports={visible:{valType:"boolean",editType:"plot"},buttons:k,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:g({editType:"plot"}),bgcolor:{valType:"color",dflt:t.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(v,Q,$){"use strict";Q.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../color"),k=v("../../plot_api/plot_template"),x=v("../../plots/array_container_defaults"),e=v("./attributes"),r=v("./constants");function i(c,n,m,p){var s=p.calendar;function f(o,d){return g.coerce(c,n,e.buttons,o,d)}if(f("visible")){var l=f("step");"all"!==l&&(!s||"gregorian"===s||"month"!==l&&"year"!==l?f("stepmode"):n.stepmode="backward",f("count")),f("label")}}Q.exports=function(c,n,m,p,s){var f=c.rangeselector||{},l=k.newContainer(n,"rangeselector");function o(a,y){return g.coerce(f,l,e,a,y)}if(o("visible",x(f,l,{name:"buttons",handleItemDefaults:i,calendar:s}).length>0)){var d=function(a,y,h){for(var _=h.filter(function(L){return y[L].anchor===a._id}),b=0,w=0;w<_.length;w++){var T=y[_[w]].domain;T&&(b=Math.max(T[1],b))}return[a.domain[0],b+r.yPad]}(n,m,p);o("x",d[0]),o("y",d[1]),g.noneOrAll(c,n,["x","y"]),o("xanchor"),o("yanchor"),g.coerceFont(o,"font",m.font);var u=o("bgcolor");o("activecolor",t.contrast(u,r.lightAmount,r.darkAmount)),o("bordercolor"),o("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../plots/plots"),x=v("../color"),e=v("../drawing"),r=v("../../lib"),i=r.strTranslate,c=v("../../lib/svg_text_utils"),n=v("../../plots/cartesian/axis_ids"),m=v("../../constants/alignment"),p=m.LINE_SPACING,s=m.FROM_TL,f=m.FROM_BR,l=v("./constants"),o=v("./get_update_object");function d(y){return y._id}function u(y,h,_){var w,T,b=r.ensureSingle(y,"rect","selector-rect",function(w){w.attr("shape-rendering","crispEdges")});b.attr({rx:l.rx,ry:l.ry}),b.call(x.stroke,h.bordercolor).call(x.fill,(w=h,T=_,T._isActive||T._isHovered?w.activecolor:w.bgcolor)).style("stroke-width",h.borderwidth+"px")}function a(y,h,_,b){var w,T;r.ensureSingle(y,"text","selector-text",function(w){w.attr("text-anchor","middle")}).call(e.font,h.font).text((w=_,T=b._fullLayout._meta,w.label?T?r.templateString(w.label,T):w.label:"all"===w.step?"all":w.count+w.step.charAt(0))).call(function(w){c.convertToTspans(w,b)})}Q.exports=function(y){var h=y._fullLayout._infolayer.selectAll(".rangeselector").data(function(_){for(var b=n.list(_,"x",!0),w=[],T=0;T<b.length;T++){var L=b[T];L.rangeselector&&L.rangeselector.visible&&w.push(L)}return w}(y),d);h.enter().append("g").classed("rangeselector",!0),h.exit().remove(),h.style({cursor:"pointer","pointer-events":"all"}),h.each(function(_){var b=g.select(this),w=_,T=w.rangeselector,L=b.selectAll("g.button").data(r.filterVisible(T.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(M){var P=g.select(this),z=o(w,M);M._isActive=function(S,C,R){if("all"===C.step)return!0===S.autorange;var D=Object.keys(R);return S.range[0]===R[D[0]]&&S.range[1]===R[D[1]]}(w,M,z),P.call(u,T,M),P.call(a,T,M,y),P.on("click",function(){y._dragged||t.call("_guiRelayout",y,z)}),P.on("mouseover",function(){M._isHovered=!0,P.call(u,T,M)}),P.on("mouseout",function(){M._isHovered=!1,P.call(u,T,M)})}),function(M,P,z,S,C){var R=0,D=0,j=z.borderwidth;P.each(function(){var ne=g.select(this).select(".selector-text"),N=Math.max(z.font.size*p*c.lineCount(ne),16)+3;D=Math.max(D,N)}),P.each(function(){var ne=g.select(this),V=ne.select(".selector-rect"),N=ne.select(".selector-text"),U=N.node()&&e.bBox(N.node()).width,ee=z.font.size*p,B=c.lineCount(N),K=Math.max(U+10,l.minButtonWidth);ne.attr("transform",i(j+R,j)),V.attr({x:0,y:0,width:K,height:D}),c.positionText(N,K/2,D/2-(B-1)*ee/2+3),R+=K+5});var q=M._fullLayout._size,Z=q.l+q.w*z.x,W=q.t+q.h*(1-z.y),G="left";r.isRightAnchor(z)&&(Z-=R,G="right"),r.isCenterAnchor(z)&&(Z-=R/2,G="center");var X="top";r.isBottomAnchor(z)&&(W-=D,X="bottom"),r.isMiddleAnchor(z)&&(W-=D/2,X="middle"),R=Math.ceil(R),D=Math.ceil(D),Z=Math.round(Z),W=Math.round(W),k.autoMargin(M,S+"-range-selector",{x:z.x,y:z.y,l:R*s[G],r:R*f[G],b:D*f[X],t:D*s[X]}),C.attr("transform",i(Z,W))}(y,L,T,w._name,b)})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(v,Q,$){"use strict";var g=v("d3-time"),t=v("../../lib").titleCase;Q.exports=function(k,x){var e=k._name,r={};if("all"===x.step)r[e+".autorange"]=!0;else{var i=function(c,n){var m,p=c.range,s=new Date(c.r2l(p[1])),l=g["utc"+t(n.step)],o=n.count;switch(n.stepmode){case"backward":m=c.l2r(+l.offset(s,-o));break;case"todate":var d=l.offset(s,-o);m=c.l2r(+l.ceil(d))}return[m,p[1]]}(k,x);r[e+".range[0]"]=i[0],r[e+".range[1]"]=i[1]}return r}},{"../../lib":515,"d3-time":122}],438:[function(v,Q,$){"use strict";Q.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:v("./attributes")}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),draw:v("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(v,Q,$){"use strict";var g=v("../color/attributes");Q.exports={bgcolor:{valType:"color",dflt:g.background,editType:"plot"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axis_ids").list,t=v("../../plots/cartesian/autorange").getAutoRange,k=v("./constants");Q.exports=function(x){for(var e=g(x,"x",!0),r=0;r<e.length;r++){var i=e[r],c=i[k.name];c&&c.visible&&c.autorange&&(c._input.autorange=!0,c._input.range=c.range=t(x,i))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(v,Q,$){"use strict";Q.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plot_api/plot_template"),k=v("../../plots/cartesian/axis_ids"),x=v("./attributes"),e=v("./oppaxis_attributes");Q.exports=function(r,i,c){var n=r[c],m=i[c];if(n.rangeslider||i._requestRangeslider[m._id]){g.isPlainObject(n.rangeslider)||(n.rangeslider={});var p,s,f=n.rangeslider,l=t.newContainer(m,"rangeslider");if(b("visible")){b("bgcolor",i.plot_bgcolor),b("bordercolor"),b("borderwidth"),b("thickness"),b("autorange",!m.isValidRange(f.range)),b("range");var o=i._subplots;if(o)for(var d=o.cartesian.filter(function(T){return T.substr(0,T.indexOf("y"))===k.name2id(c)}).map(function(T){return T.substr(T.indexOf("y"),T.length)}),u=g.simpleMap(d,k.id2name),a=0;a<u.length;a++){var y=u[a];p=f[y]||{},s=t.newContainer(l,y,"yaxis");var h,_=i[y];p.range&&_.isValidRange(p.range)&&(h="fixed"),"match"!==w("rangemode",h)&&w("range",_.range.slice())}l._input=f}}function b(T,L){return g.coerce(f,l,x,T,L)}function w(T,L){return g.coerce(p,s,e,T,L)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../plots/plots"),x=v("../../lib"),e=x.strTranslate,r=v("../drawing"),i=v("../color"),c=v("../titles"),n=v("../../plots/cartesian"),m=v("../../plots/cartesian/axis_ids"),p=v("../dragelement"),s=v("../../lib/setcursor"),f=v("./constants");function l(h,_,b,w){var T=x.ensureSingle(h,"rect",f.bgClassName,function(z){z.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=w.borderwidth%2==0?w.borderwidth:w.borderwidth-1,M=-w._offsetShift,P=r.crispRound(_,w.borderwidth);T.attr({width:w._width+L,height:w._height+L,transform:e(M,M),"stroke-width":P}).call(i.stroke,w.bordercolor).call(i.fill,w.bgcolor)}function o(h,_,b,w){x.ensureSingleById(_._fullLayout._topdefs,"clipPath",w._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:w._width,height:w._height})}function d(h,_,b,w){var T,L=_.calcdata,M=h.selectAll("g."+f.rangePlotClassName).data(b._subplotsWith,x.identity);M.enter().append("g").attr("class",function(P){return f.rangePlotClassName+" "+P}).call(r.setClipUrl,w._clipId,_),M.order(),M.exit().remove(),M.each(function(P,z){var S=g.select(this),C=0===z,R=m.getFromId(_,P,"y"),D=R._name,j=w[D],q={data:[],layout:{xaxis:{type:b.type,domain:[0,1],range:w.range.slice(),calendar:b.calendar},width:w._width,height:w._height,margin:{t:0,b:0,l:0,r:0}},_context:_._context};b.rangebreaks&&(q.layout.xaxis.rangebreaks=b.rangebreaks),q.layout[D]={type:R.type,domain:[0,1],range:"match"!==j.rangemode?j.range.slice():R.range.slice(),calendar:R.calendar},R.rangebreaks&&(q.layout[D].rangebreaks=R.rangebreaks),k.supplyDefaults(q);var Z=q._fullLayout.xaxis,W=q._fullLayout[D];Z.clearCalc(),Z.setScale(),W.clearCalc(),W.setScale();var G={id:P,plotgroup:S,xaxis:Z,yaxis:W,isRangePlot:!0};C?T=G:(G.mainplot="xy",G.mainplotinfo=T),n.rangePlot(_,G,function(X,ne){for(var V=[],N=0;N<X.length;N++){var U=X[N],ee=U[0].trace;ee.xaxis+ee.yaxis===ne&&V.push(U)}return V}(L,P))})}function u(h,_,b,w,T){x.ensureSingle(h,"rect",f.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(i.fill,f.maskColor),x.ensureSingle(h,"rect",f.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(i.fill,f.maskColor),"match"!==T.rangemode&&(x.ensureSingle(h,"rect",f.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).call(i.fill,f.maskOppAxisColor),x.ensureSingle(h,"rect",f.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).style("border-top",f.maskOppBorder).call(i.fill,f.maskOppAxisColor))}function a(h,_,b,w){_._context.staticPlot||x.ensureSingle(h,"rect",f.slideBoxClassName,function(T){T.attr({y:0,cursor:f.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:w._height,fill:f.slideBoxFill})}function y(h,_,b,w){var T=x.ensureSingle(h,"g",f.grabberMinClassName),L=x.ensureSingle(h,"g",f.grabberMaxClassName),M={x:0,width:f.handleWidth,rx:f.handleRadius,fill:i.background,stroke:i.defaultLine,"stroke-width":f.handleStrokeWidth,"shape-rendering":"crispEdges"},P={y:Math.round(w._height/4),height:Math.round(w._height/2)};x.ensureSingle(T,"rect",f.handleMinClassName,function(S){S.attr(M)}).attr(P),x.ensureSingle(L,"rect",f.handleMaxClassName,function(S){S.attr(M)}).attr(P);var z={width:f.grabAreaWidth,x:0,y:0,fill:f.grabAreaFill,cursor:_._context.staticPlot?void 0:f.grabAreaCursor};x.ensureSingle(T,"rect",f.grabAreaMinClassName,function(S){S.attr(z)}).attr("height",w._height),x.ensureSingle(L,"rect",f.grabAreaMaxClassName,function(S){S.attr(z)}).attr("height",w._height)}Q.exports=function(h){for(var _=h._fullLayout,b=_._rangeSliderData,w=0;w<b.length;w++){var T=b[w][f.name];T._clipId=T._id+"-"+_._uid}var L=_._infolayer.selectAll("g."+f.containerClassName).data(b,function(M){return M._name});L.exit().each(function(M){_._topdefs.select("#"+M[f.name]._clipId).remove()}).remove(),0!==b.length&&(L.enter().append("g").classed(f.containerClassName,!0).attr("pointer-events","all"),L.each(function(M){var P=g.select(this),z=M[f.name],S=_[m.id2name(M.anchor)],C=z[m.id2name(M.anchor)];if(z.range){var R,D=x.simpleMap(z.range,M.r2l),j=x.simpleMap(M.range,M.r2l);R=j[0]<j[1]?[Math.min(D[0],j[0]),Math.max(D[1],j[1])]:[Math.max(D[0],j[0]),Math.min(D[1],j[1])],z.range=z._input.range=x.simpleMap(R,M.l2r)}M.cleanRange("rangeslider.range");var q=_._size,Z=M.domain;z._width=q.w*(Z[1]-Z[0]);var W=Math.round(q.l+q.w*Z[0]),G=Math.round(q.t+q.h*(1-M._counterDomainMin)+("bottom"===M.side?M._depth:0)+z._offsetShift+f.extraPad);P.attr("transform",e(W,G)),z._rl=x.simpleMap(z.range,M.r2l);var X=z._rl[0],ne=z._rl[1],V=ne-X;if(z.p2d=function(ce){return ce/z._width*V+X},z.d2p=function(ce){return(ce-X)/V*z._width},M.rangebreaks){var N=M.locateBreaks(X,ne);if(N.length){var U,ee,B=0;for(U=0;U<N.length;U++)B+=(ee=N[U]).max-ee.min;var K=z._width/(ne-X-B),J=[-K*X];for(U=0;U<N.length;U++)J.push(J[J.length-1]-K*((ee=N[U]).max-ee.min));for(z.d2p=function(ce){for(var oe=J[0],ve=0;ve<N.length;ve++){var fe=N[ve];if(ce>=fe.max)oe=J[ve+1];else if(ce<fe.min)break}return oe+K*ce},U=0;U<N.length;U++)(ee=N[U]).pmin=z.d2p(ee.min),ee.pmax=z.d2p(ee.max);z.p2d=function(ce){for(var oe=J[0],ve=0;ve<N.length;ve++){var fe=N[ve];if(ce>=fe.pmax)oe=J[ve+1];else if(ce<fe.pmin)break}return(ce-oe)/K}}}if("match"!==C.rangemode){var te=S.r2l(C.range[0]),ae=S.r2l(C.range[1])-te;z.d2pOppAxis=function(ce){return(ce-te)/ae*z._height}}P.call(l,h,M,z).call(o,h,M,z).call(d,h,M,z).call(u,h,M,z,C).call(a,h,M,z).call(y,h,M,z),function(ce,oe,ve,fe){if(!oe._context.staticPlot){var xe=ce.select("rect."+f.slideBoxClassName).node(),Se=ce.select("rect."+f.grabAreaMinClassName).node(),pe=ce.select("rect."+f.grabAreaMaxClassName).node();ce.on("mousedown",ge),ce.on("touchstart",ge)}function ge(){var Te=g.event,se=Te.target,de=Te.clientX||Te.touches[0].clientX,Ae=de-ce.node().getBoundingClientRect().left,Le=fe.d2p(ve._rl[0]),Me=fe.d2p(ve._rl[1]),De=p.coverSlip();function Oe(Qe){var Ne,Pe,Re,Ge=+(Qe.clientX||Qe.touches[0].clientX)-de;switch(se){case xe:Re="ew-resize",Ne=Le+Ge,Pe=Me+Ge;break;case Se:Re="col-resize",Ne=Le+Ge,Pe=Me;break;case pe:Re="col-resize",Ne=Le,Pe=Me+Ge;break;default:Re="ew-resize",Ne=Ae,Pe=Ae+Ge}if(Pe<Ne){var tt=Pe;Pe=Ne,Ne=tt}fe._pixelMin=Ne,fe._pixelMax=Pe,s(g.select(De),Re),function(ct,wt,kt,gt){function at(Vt){return kt.l2r(x.constrain(Vt,gt._rl[0],gt._rl[1]))}var et=at(gt.p2d(gt._pixelMin)),yt=at(gt.p2d(gt._pixelMax));window.requestAnimationFrame(function(){t.call("_guiRelayout",wt,kt._name+".range",[et,yt])})}(0,oe,ve,fe)}function Ie(){De.removeEventListener("mousemove",Oe),De.removeEventListener("mouseup",Ie),this.removeEventListener("touchmove",Oe),this.removeEventListener("touchend",Ie),x.removeElement(De)}this.addEventListener("touchmove",Oe),this.addEventListener("touchend",Ie),De.addEventListener("mousemove",Oe),De.addEventListener("mouseup",Ie)}}(P,h,M,z),function(ce,oe,ve,fe,xe,Se){var pe=f.handleWidth/2;function ge(Ie){return x.constrain(Ie,0,fe._width)}function Te(Ie){return x.constrain(Ie,0,fe._height)}function se(Ie){return x.constrain(Ie,-pe,fe._width+pe)}var de=ge(fe.d2p(ve._rl[0])),Ae=ge(fe.d2p(ve._rl[1]));if(ce.select("rect."+f.slideBoxClassName).attr("x",de).attr("width",Ae-de),ce.select("rect."+f.maskMinClassName).attr("width",de),ce.select("rect."+f.maskMaxClassName).attr("x",Ae).attr("width",fe._width-Ae),"match"!==Se.rangemode){var Le=fe._height-Te(fe.d2pOppAxis(xe._rl[1])),Me=fe._height-Te(fe.d2pOppAxis(xe._rl[0]));ce.select("rect."+f.maskMinOppAxisClassName).attr("x",de).attr("height",Le).attr("width",Ae-de),ce.select("rect."+f.maskMaxOppAxisClassName).attr("x",de).attr("y",Me).attr("height",fe._height-Me).attr("width",Ae-de),ce.select("rect."+f.slideBoxClassName).attr("y",Le).attr("height",Me-Le)}var De=Math.round(se(de-pe))-.5,Oe=Math.round(se(Ae-pe))+.5;ce.select("g."+f.grabberMinClassName).attr("transform",e(De,.5)),ce.select("g."+f.grabberMaxClassName).attr("transform",e(Oe,.5))}(P,0,M,z,S,C),"bottom"===M.side&&c.draw(h,M._id+"title",{propContainer:M,propName:M._name+".title",placeholder:_._dfltTitle.x,attributes:{x:M._offset+M._length/2,y:G+z._height+z._offsetShift+10+1.5*M.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axis_ids"),t=v("../../lib/svg_text_utils"),k=v("./constants"),x=v("../../constants/alignment").LINE_SPACING,e=k.name;function r(i){var c=i&&i[e];return c&&c.visible}$.isVisible=r,$.makeData=function(i){var c=g.list({_fullLayout:i},"x",!0),n=i.margin,m=[];if(!i._has("gl2d"))for(var p=0;p<c.length;p++){var s=c[p];if(r(s)){m.push(s);var f=s[e];f._id=e+s._id,f._height=(i.height-n.b-n.t)*f.thickness,f._offsetShift=Math.floor(f.borderwidth/2)}}i._rangeSliderData=m},$.autoMarginOpts=function(i,c){var n=i._fullLayout,m=c[e],p=c._id.charAt(0),s=0,f=0;return"bottom"===c.side&&(s=c._depth,c.title.text!==n._dfltTitle[p]&&(f=1.5*c.title.font.size+10+m._offsetShift,f+=(c.title.text.match(t.BR_TAG_ALL)||[]).length*c.title.font.size*x)),{x:0,y:c._counterDomainMin,l:0,r:0,t:0,b:m._height+s+Math.max(n.margin.b,f),pad:k.extraPad+2*m._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("./oppaxis_attributes"),x=v("./helpers");Q.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:g.extendFlat({},t,{yaxis:k})}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),calcAutorange:v("./calc_autorange"),draw:v("./draw"),isVisible:x.isVisible,makeData:x.makeData,autoMarginOpts:x.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(v,Q,$){"use strict";Q.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(v,Q,$){"use strict";var g=v("../annotations/attributes"),t=v("../../traces/scatter/attributes").line,k=v("../drawing/attributes").dash,x=v("../../lib/extend").extendFlat,e=v("../../plot_api/edit_types").overrideAll,r=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),Q.exports=e(r("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:x({},g.xref,{}),yref:x({},g.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:t.color,width:x({},t.width,{min:1,dflt:1}),dash:x({},k,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(v,Q,$){"use strict";Q.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./attributes"),e=v("../shapes/helpers");function r(i,c,n){function m(P,z){return g.coerce(i,c,x,P,z)}var p=m("path"),s="path"!==m("type",p?"path":"rect");s&&delete c.path,m("opacity"),m("line.color"),m("line.width"),m("line.dash");for(var f=["x","y"],l=0;l<2;l++){var o,d,u,a=f[l],y={_fullLayout:n},h=t.coerceRef(i,c,y,a);if((o=t.getFromId(y,h))._selectionIndices.push(c._index),u=e.rangeToShapePosition(o),d=e.shapePositionToRange(o),s){var _=a+"0",b=a+"1",w=i[_],T=i[b];i[_]=d(i[_],!0),i[b]=d(i[b],!0),t.coercePosition(c,y,m,h,_),t.coercePosition(c,y,m,h,b);var L=c[_],M=c[b];void 0!==L&&void 0!==M&&(c[_]=u(L),c[b]=u(M),i[_]=w,i[b]=T)}}s&&g.noneOrAll(i,c,["x0","x1","y0","y1"])}Q.exports=function(i,c){k(i,c,{name:"selections",handleItemDefaults:r});for(var n=c.selections,m=0;m<n.length;m++){var p=n[m];p&&void 0===p.path&&(void 0!==p.x0&&void 0!==p.x1&&void 0!==p.y0&&void 0!==p.y1||(c.selections[m]=null))}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(v,Q,$){"use strict";var g=v("../shapes/draw_newshape/helpers").readPaths,t=v("../shapes/display_outlines"),k=v("../shapes/handle_outline").clearOutlineControllers,x=v("../color"),e=v("../drawing"),r=v("../../plot_api/plot_template").arrayEditor,i=v("../shapes/helpers"),c=i.getPathString;function n(l){var o=l._fullLayout;for(var d in k(l),o._selectionLayer.selectAll("path").remove(),o._plots){var u=o._plots[d].selectionLayer;u&&u.selectAll("path").remove()}for(var a=0;a<o.selections.length;a++)p(l,a)}function m(l){return l._context.editSelection}function p(l,o){l._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+o+'"]').remove();var d=i.makeSelectionsOptionsAndPlotinfo(l,o),u=d.options,a=d.plotinfo;u._input&&function(y){var h=c(l,u),_={"data-index":o,"fill-rule":"evenodd",d:h},b=u.opacity,w="rgba(0,0,0,0)",T=u.line.color||x.contrast(l._fullLayout.plot_bgcolor),L=u.line.width,M=u.line.dash;L||(L=5,M="solid");var P=m(l)&&l._fullLayout._activeSelectionIndex===o;P&&(w=l._fullLayout.activeselection.fillcolor,b=l._fullLayout.activeselection.opacity);for(var z=[],S=1;S>=0;S--){var C=y.append("path").attr(_).style("opacity",S?.1:b).call(x.stroke,T).call(x.fill,w).call(e.dashLine,S?"solid":M,S?4+L:L);if(s(C,l,u),P){var R=r(l.layout,"selections",u);C.style({cursor:"move"});var D={element:C.node(),plotinfo:a,gd:l,editHelpers:R,isActiveSelection:!0},j=g(h,l);t(j,C,D)}else C.style("pointer-events",S?"all":"none");z[S]=C}var q=z[0];z[1].node().addEventListener("click",function(){return function(Z,W){if(m(Z)){var G=+W.node().getAttribute("data-index");if(G>=0){if(G===Z._fullLayout._activeSelectionIndex)return void f(Z);Z._fullLayout._activeSelectionIndex=G,Z._fullLayout._deactivateSelection=f,n(Z)}}}(l,q)})}(l._fullLayout._selectionLayer)}function s(l,o,d){e.setClipUrl(l,"clip"+o._fullLayout._uid+(d.xref+d.yref),o)}function f(l){m(l)&&l._fullLayout._activeSelectionIndex>=0&&(k(l),delete l._fullLayout._activeSelectionIndex,n(l))}Q.exports={draw:n,drawOne:p,activateLastSelection:function(l){m(l)&&(l._fullLayout._activeSelectionIndex=l._fullLayout.selections.length-1,l._fullLayout._deactivateSelection=f,n(l))}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(v,Q,$){"use strict";var g=v("../../drawing/attributes").dash,t=v("../../../lib/extend").extendFlat;Q.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:t({},g,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){k("newselection.mode"),k("newselection.line.width")&&(k("newselection.line.color"),k("newselection.line.dash")),k("activeselection.fillcolor"),k("activeselection.opacity")}},{}],453:[function(v,Q,$){"use strict";var g=v("../../dragelement/helpers").selectMode,t=v("../../shapes/handle_outline").clearOutline,k=v("../../shapes/draw_newshape/helpers"),x=k.readPaths,e=k.writePaths,r=k.fixDatesForPaths;Q.exports=function(i,c){if(i.length){var n=i[0][0];if(n){var m=n.getAttribute("d"),p=c.gd,s=p._fullLayout.newselection,f=c.plotinfo,l=f.xaxis,o=f.yaxis,d=c.isActiveSelection,u=c.dragmode,a=(p.layout||{}).selections||[];if(!g(u)&&void 0!==d){var y=p._fullLayout._activeSelectionIndex;if(y<a.length)switch(p._fullLayout.selections[y].type){case"rect":u="select";break;case"path":u="lasso"}}var h,_=x(m,p,f,d),b={xref:l._id,yref:o._id,opacity:s.opacity,line:{color:s.line.color,width:s.line.width,dash:s.line.dash}};1===_.length&&(h=_[0]),h&&5===h.length&&"select"===u?(b.type="rect",b.x0=h[0][1],b.y0=h[0][2],b.x1=h[2][1],b.y1=h[2][2]):(b.type="path",l&&o&&r(_,l,o),b.path=e(_),h=null),t(p);for(var w=c.editHelpers,T=(w||{}).modifyItem,L=[],M=0;M<a.length;M++){var P=p._fullLayout.selections[M];if(P){if(L[M]=P._input,void 0!==d&&M===p._fullLayout._activeSelectionIndex){var z=b;switch(P.type){case"rect":T("x0",z.x0),T("x1",z.x1),T("y0",z.y0),T("y1",z.y1);break;case"path":T("path",z.path)}}}else L[M]=P}return void 0===d?(L.push(b),L):w?w.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(v,Q,$){"use strict";var g=v("../../lib").strTranslate;function t(k,x){switch(k.type){case"log":return k.p2d(x);case"date":return k.p2r(x,0,k.calendar);default:return k.p2r(x)}}Q.exports={p2r:t,r2p:function(k,x){switch(k.type){case"log":return k.d2p(x);case"date":return k.r2p(x,0,k.calendar);default:return k.r2p(x)}},axValue:function(k){var x="y"===k._id.charAt(0)?1:0;return function(e){return t(k,e[x])}},getTransform:function(k){return g(k.xaxis._offset,k.yaxis._offset)}}},{"../../lib":515}],455:[function(v,Q,$){"use strict";var g=v("./draw"),t=v("./select");Q.exports={moduleType:"component",name:"selections",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),supplyDrawNewSelectionDefaults:v("./draw_newselection/defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("selections"),draw:g.draw,drawOne:g.drawOne,reselect:t.reselect,prepSelect:t.prepSelect,clearOutline:t.clearOutline,clearSelectionsCache:t.clearSelectionsCache,selectOnClick:t.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(v,Q,$){"use strict";var g=v("polybooljs"),t=v("point-in-polygon/nested"),k=v("../../registry"),x=v("../drawing").dashStyle,e=v("../color"),r=v("../fx"),i=v("../fx/helpers").makeEventData,c=v("../dragelement/helpers"),n=c.freeMode,m=c.rectMode,p=c.drawMode,s=c.openMode,f=c.selectMode,l=v("../shapes/helpers"),o=v("../shapes/constants"),d=v("../shapes/display_outlines"),u=v("../shapes/handle_outline").clearOutline,a=v("../shapes/draw_newshape/helpers"),y=a.handleEllipse,h=a.readPaths,_=v("../shapes/draw_newshape/newshapes"),b=v("./draw_newselection/newselections"),w=v("./draw").activateLastSelection,T=v("../../lib"),L=T.sorterAsc,M=v("../../lib/polygon"),P=v("../../lib/throttle"),z=v("../../plots/cartesian/axis_ids").getFromId,S=v("../../lib/clear_gl_canvases"),C=v("../../plot_api/subroutines").redrawReglTraces,R=v("./constants"),D=R.MINSELECT,j=M.filter,q=M.tester,Z=v("./helpers"),W=Z.p2r,G=Z.axValue,X=Z.getTransform;function ne(Ie){return void 0!==Ie.subplot}function V(Ie,Qe,Ne,Pe,Re,Ge,tt){var ct,wt,kt,gt,at,et,yt,Vt,Gt,be,en=Qe._hoverdata,Jt=Qe._fullLayout.clickmode.indexOf("event")>-1,cn=[];if((be=en)&&Array.isArray(be)&&!0!==be[0].hoverOnBox){B(Ie,Qe,Ge);var Rt=function(be,Fe){var He,Ke,Ze=be[0],ut=-1,lt=[];for(Ke=0;Ke<Fe.length;Ke++)if(Ze.fullData._expandedIndex===(He=Fe[Ke]).cd[0].trace._expandedIndex){if(!0===Ze.hoverOnBox)break;void 0!==Ze.pointNumber?ut=Ze.pointNumber:void 0!==Ze.binNumber&&(ut=Ze.binNumber,lt=Ze.pointNumbers);break}return{pointNumber:ut,pointNumbers:lt,searchInfo:He}}(en,ct=te(Qe,Ne,Pe,Re));if(Rt.pointNumbers.length>0?function(be,Fe){var He,Ke,Ze,ut=[];for(Ze=0;Ze<be.length;Ze++)(He=be[Ze]).cd[0].trace.selectedpoints&&He.cd[0].trace.selectedpoints.length>0&&ut.push(He);if(1===ut.length&&ut[0]===Fe.searchInfo&&(Ke=Fe.searchInfo.cd[0].trace).selectedpoints.length===Fe.pointNumbers.length){for(Ze=0;Ze<Fe.pointNumbers.length;Ze++)if(Ke.selectedpoints.indexOf(Fe.pointNumbers[Ze])<0)return!1;return!0}return!1}(ct,Rt):function(be){var He,Ke,Ze=0;for(Ke=0;Ke<be.length;Ke++)if((He=be[Ke].cd[0].trace).selectedpoints&&(He.selectedpoints.length>1||(Ze+=He.selectedpoints.length)>1))return!1;return 1===Ze}(ct)&&(et=ce(Rt))){for(tt&&tt.remove(),Gt=0;Gt<ct.length;Gt++)(wt=ct[Gt])._module.selectPoints(wt,!1);oe(Qe,ct),K(Ge),Jt&&Oe(Qe)}else{for(yt=Ie.shiftKey&&(void 0!==et?et:ce(Rt)),kt=function(be,Fe,He){return{pointNumber:be,searchInfo:Fe,subtract:!!He}}(Rt.pointNumber,Rt.searchInfo,yt),gt=ee(Ge.selectionDefs.concat([kt])),Gt=0;Gt<ct.length;Gt++)if(at=fe(ct[Gt]._module.selectPoints(ct[Gt],gt),ct[Gt]),cn.length)for(var je=0;je<at.length;je++)cn.push(at[je]);else cn=at;if(oe(Qe,ct,Vt={points:cn}),kt&&Ge&&Ge.selectionDefs.push(kt),tt){var Ye=Ge.mergedPolygons,he=s(Ge.dragmode);d(xe(Ye,he),tt,Ge)}Jt&&De(Qe,Vt)}}}function N(Ie){return"pointNumber"in Ie&&"searchInfo"in Ie}function U(Ie){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Qe,Ne,Pe,Re){return Re.cd[0].trace._expandedIndex===Ie.searchInfo.cd[0].trace._expandedIndex&&Pe===Ie.pointNumber},isRect:!1,degenerate:!1,subtract:!!Ie.subtract}}function ee(Ie){if(Ie.length){for(var Qe=[],Ne=N(Ie[0])?0:Ie[0][0][0],Pe=Ne,Re=N(Ie[0])?0:Ie[0][0][1],Ge=Re,tt=0;tt<Ie.length;tt++)if(N(Ie[tt]))Qe.push(U(Ie[tt]));else{var ct=q(Ie[tt]);ct.subtract=!!Ie[tt].subtract,Qe.push(ct),Ne=Math.min(Ne,ct.xmin),Pe=Math.max(Pe,ct.xmax),Re=Math.min(Re,ct.ymin),Ge=Math.max(Ge,ct.ymax)}return{xmin:Ne,xmax:Pe,ymin:Re,ymax:Ge,pts:[],contains:function(wt,kt,gt,at){for(var et=!1,yt=0;yt<Qe.length;yt++)Qe[yt].contains(wt,kt,gt,at)&&(et=!Qe[yt].subtract);return et},isRect:!1,degenerate:!1}}}function B(Ie,Qe,Ne){var Pe=Qe._fullLayout,Re=Ne.plotinfo,Ge=Ne.dragmode,tt=Pe._lastSelectedSubplot&&Pe._lastSelectedSubplot===Re.id,ct=(Ie.shiftKey||Ie.altKey)&&!(p(Ge)&&s(Ge));tt&&ct&&Re.selection&&Re.selection.selectionDefs&&!Ne.selectionDefs?(Ne.selectionDefs=Re.selection.selectionDefs,Ne.mergedPolygons=Re.selection.mergedPolygons):ct&&Re.selection||K(Ne),tt||(u(Qe),Pe._lastSelectedSubplot=Re.id)}function K(Ie,Qe){var Ne=Ie.dragmode,Pe=Ie.plotinfo,Re=Ie.gd;Re._fullLayout._activeShapeIndex>=0&&Re._fullLayout._deactivateShape(Re),Re._fullLayout._activeSelectionIndex>=0&&Re._fullLayout._deactivateSelection(Re);var Ge=Re._fullLayout._zoomlayer,tt=p(Ne),ct=f(Ne);if(tt||ct){var wt,kt,gt=Ge.selectAll(".select-outline-"+Pe.id);gt&&Re._fullLayout._outlining&&(tt&&(wt=_(gt,Ie)),wt&&k.call("_guiRelayout",Re,{shapes:wt}),ct&&!ne(Ie)&&(kt=b(gt,Ie)),kt&&(Re._fullLayout._noEmitSelectedAtStart=!0,k.call("_guiRelayout",Re,{selections:kt}).then(function(){Qe&&w(Re)})),Re._fullLayout._outlining=!1)}Pe.selection={},Pe.selection.selectionDefs=Ie.selectionDefs=[],Pe.selection.mergedPolygons=Ie.mergedPolygons=[]}function J(Ie){return Ie._id}function te(Ie,Qe,Ne,Pe){if(!Ie.calcdata)return[];var Re,Ge,tt,ct=[],wt=Qe.map(J),kt=Ne.map(J);for(tt=0;tt<Ie.calcdata.length;tt++)if(!0===(Ge=(Re=Ie.calcdata[tt])[0].trace).visible&&Ge._module&&Ge._module.selectPoints)if(!ne({subplot:Pe})||Ge.subplot!==Pe&&Ge.geo!==Pe)if("splom"===Ge.type){if(Ge._xaxes[wt[0]]&&Ge._yaxes[kt[0]]){var gt=ae(Ge._module,Re,Qe[0],Ne[0]);gt.scene=Ie._fullLayout._splomScenes[Ge.uid],ct.push(gt)}}else if("sankey"===Ge.type){var at=ae(Ge._module,Re,Qe[0],Ne[0]);ct.push(at)}else{if(-1===wt.indexOf(Ge.xaxis)||-1===kt.indexOf(Ge.yaxis))continue;ct.push(ae(Ge._module,Re,z(Ie,Ge.xaxis),z(Ie,Ge.yaxis)))}else ct.push(ae(Ge._module,Re,Qe[0],Ne[0]));return ct}function ae(Ie,Qe,Ne,Pe){return{_module:Ie,cd:Qe,xaxis:Ne,yaxis:Pe}}function ce(Ie){var Qe=Ie.searchInfo.cd[0].trace,Pe=Ie.pointNumbers;return!!Qe.selectedpoints&&Qe.selectedpoints.indexOf(Pe.length>0?Pe[0]:Ie.pointNumber)>-1}function oe(Ie,Qe,Ne){var Pe,Re;for(Pe=0;Pe<Qe.length;Pe++){var Ge=Qe[Pe].cd[0].trace._fullInput,tt=Ie._fullLayout._tracePreGUI[Ge.uid]||{};void 0===tt.selectedpoints&&(tt.selectedpoints=Ge._input.selectedpoints||null)}if(Ne){var ct=Ne.points||[];for(Pe=0;Pe<Qe.length;Pe++)(Re=Qe[Pe].cd[0].trace)._input.selectedpoints=Re._fullInput.selectedpoints=[],Re._fullInput!==Re&&(Re.selectedpoints=[]);for(var wt=0;wt<ct.length;wt++){var kt=ct[wt],gt=kt.data,at=kt.fullData,et=kt.pointIndex,yt=kt.pointIndices;yt?([].push.apply(gt.selectedpoints,yt),Re._fullInput!==Re&&[].push.apply(at.selectedpoints,yt)):(gt.selectedpoints.push(et),Re._fullInput!==Re&&at.selectedpoints.push(et))}}else for(Pe=0;Pe<Qe.length;Pe++)delete(Re=Qe[Pe].cd[0].trace).selectedpoints,delete Re._input.selectedpoints,Re._fullInput!==Re&&delete Re._fullInput.selectedpoints;!function(Vt,Gt){for(var en=!1,Jt=0;Jt<Gt.length;Jt++){var cn=Gt[Jt],Rt=cn.cd;k.traceIs(Rt[0].trace,"regl")&&(en=!0);var je=cn._module,Ye=je.styleOnSelect||je.style;Ye&&(Ye(Vt,Rt,Rt[0].node3),Rt[0].nodeRangePlot3&&Ye(Vt,Rt,Rt[0].nodeRangePlot3))}en&&(S(Vt),C(Vt))}(Ie,Qe)}function ve(Ie,Qe,Ne){for(var Pe=(Ne?g.difference:g.union)({regions:Ie},{regions:[Qe]}).regions.reverse(),Re=0;Re<Pe.length;Re++){var Ge=Pe[Re];Ge.subtract=de(Ge,Pe.slice(0,Re))}return Pe}function fe(Ie,Qe){if(Array.isArray(Ie))for(var Ne=Qe.cd,Pe=Qe.cd[0].trace,Re=0;Re<Ie.length;Re++)Ie[Re]=i(Ie[Re],Pe,Ne);return Ie}function xe(Ie,Qe){for(var Ne=[],Pe=0;Pe<Ie.length;Pe++){Ne[Pe]=[];for(var Re=0;Re<Ie[Pe].length;Re++){Ne[Pe][Re]=[],Ne[Pe][Re][0]=Re?"L":"M";for(var Ge=0;Ge<Ie[Pe][Re].length;Ge++)Ne[Pe][Re].push(Ie[Pe][Re][Ge])}Qe||Ne[Pe].push(["Z",Ne[Pe][0][1],Ne[Pe][0][2]])}return Ne}function Se(Ie,Qe){for(var Ne,Pe,Re=[],Ge=[],tt=0;tt<Qe.length;tt++){var ct=Qe[tt];Pe=ct._module.selectPoints(ct,Ie),Ge.push(Pe),Ne=fe(Pe,ct),Re=Re.concat(Ne)}return Re}function pe(Ie,Qe,Ne,Pe,Re){var Ge,tt,ct,wt=!!Pe;Re&&(Ge=Re.plotinfo,tt=Re.xaxes[0]._id,ct=Re.yaxes[0]._id);var kt=[],gt=[],at=se(Ie),et=Ie._fullLayout;if(Ge){var yt=et._zoomlayer,Vt=et.dragmode,Gt=p(Vt),en=f(Vt);if(Gt||en){var Jt=z(Ie,tt,"x"),cn=z(Ie,ct,"y");if(Jt&&cn){var Rt=yt.selectAll(".select-outline-"+Ge.id);if(Rt&&Ie._fullLayout._outlining&&Rt.length){for(var je=Rt[0][0].getAttribute("d"),Ye=h(je,Ie,Ge),he=[],be=0;be<Ye.length;be++){for(var Fe=Ye[be],He=[],Ke=0;Ke<Fe.length;Ke++)He.push([Ae(Jt,Fe[Ke][1]),Ae(cn,Fe[Ke][2])]);He.xref=tt,He.yref=ct,He.subtract=de(He,he),he.push(He)}at=at.concat(he)}}}}var Ze=tt&&ct?[tt+ct]:et._subplots.cartesian;!function(Rn){var qn=Rn.calcdata;if(qn)for(var Xn=0;Xn<qn.length;Xn++){var fr=Rn._fullLayout._splomScenes;if(fr){var Vr=fr[qn[Xn][0].trace.uid];Vr&&(Vr.selectBatch=[])}}}(Ie);for(var ut={},lt=0;lt<Ze.length;lt++){var Lt=Ze[lt],Ot=Lt.indexOf("y"),ot=Lt.slice(0,Ot),pt=Lt.slice(Ot),qt=tt&&ct?Ne:void 0;if(qt=Te(at,ot,pt,qt)){var St=Pe;if(!wt){var Mt=z(Ie,ot,"x"),Ce=z(Ie,pt,"y");St=te(Ie,[Mt],[Ce],Lt);for(var Xe=0;Xe<St.length;Xe++){var st=St[Xe],dt=st.cd[0],zt=dt.trace;if("scattergl"===st._module.name&&!dt.t.xpx){var Ht=zt.x,Kt=zt.y,Zt=zt._length;dt.t.xpx=[],dt.t.ypx=[];for(var vn=0;vn<Zt;vn++)dt.t.xpx[vn]=Mt.c2p(Ht[vn]),dt.t.ypx[vn]=Ce.c2p(Kt[vn])}"splom"===st._module.name&&(ut[zt.uid]||(ut[zt.uid]=!0))}}var zn=Se(qt,St);kt=kt.concat(zn),gt=gt.concat(St)}}var gn={points:kt};oe(Ie,gt,gn);var nn=et.clickmode.indexOf("event")>-1&&Qe;if(!Ge&&Qe){var an=se(Ie,!0);if(an.length){var on=an[0].xref,mn=an[0].yref;if(on&&mn){var _n=Le(an);Me([z(Ie,on,"x"),z(Ie,mn,"y")])(gn,_n)}}Ie._fullLayout._noEmitSelectedAtStart?Ie._fullLayout._noEmitSelectedAtStart=!1:nn&&De(Ie,gn),et._reselect=!1}if(!Ge&&et._deselect){var Pn=et._deselect;(function(Rn,qn,Xn){for(var br=0;br<Xn.length;br++){var fr=Xn[br];if(fr.xaxis&&fr.xaxis._id===Rn&&fr.yaxis&&fr.yaxis._id===qn)return!0}return!1})(tt=Pn.xref,ct=Pn.yref,gt)||ge(Ie,tt,ct,Pe),nn&&(gn.points.length?De(Ie,gn):Oe(Ie)),et._deselect=!1}return{eventData:gn,selectionTesters:Ne}}function ge(Ie,Qe,Ne,Pe){Pe=te(Ie,[z(Ie,Qe,"x")],[z(Ie,Ne,"y")],Qe+Ne);for(var Re=0;Re<Pe.length;Re++){var Ge=Pe[Re];Ge._module.selectPoints(Ge,!1)}oe(Ie,Pe)}function Te(Ie,Qe,Ne,Pe){for(var Re,Ge=0;Ge<Ie.length;Ge++){var tt=Ie[Ge];Qe===tt.xref&&Ne===tt.yref&&(Re?Pe=ee(Re=ve(Re,tt,!!tt.subtract)):(Re=[tt],Pe=q(tt)))}return Pe}function se(Ie,Qe){for(var Ne=[],Pe=Ie._fullLayout,Re=Pe.selections,Ge=Re.length,tt=0;tt<Ge;tt++)if(!Qe||tt===Pe._activeSelectionIndex){var ct=Re[tt];if(ct){var wt,kt,gt,at,et,yt=ct.xref,Vt=ct.yref,Gt=z(Ie,yt,"x"),en=z(Ie,Vt,"y");if("rect"===ct.type){et=[];var Jt=Ae(Gt,ct.x0),cn=Ae(Gt,ct.x1),Rt=Ae(en,ct.y0),je=Ae(en,ct.y1);et=[[Jt,Rt],[Jt,je],[cn,je],[cn,Rt]],wt=Math.min(Jt,cn),kt=Math.max(Jt,cn),gt=Math.min(Rt,je),at=Math.max(Rt,je),et.xmin=wt,et.xmax=kt,et.ymin=gt,et.ymax=at,et.xref=yt,et.yref=Vt,et.subtract=!1,et.isRect=!0,Ne.push(et)}else if("path"===ct.type)for(var Ye=ct.path.split("Z"),he=[],be=0;be<Ye.length;be++){var Fe=Ye[be];if(Fe){var He=l.extractPathCoords(Fe+="Z",o.paramIsX,"raw"),Ke=l.extractPathCoords(Fe,o.paramIsY,"raw");wt=1/0,kt=-1/0,gt=1/0,at=-1/0,et=[];for(var Ze=0;Ze<He.length;Ze++){var ut=Ae(Gt,He[Ze]),lt=Ae(en,Ke[Ze]);et.push([ut,lt]),wt=Math.min(ut,wt),kt=Math.max(ut,kt),gt=Math.min(lt,gt),at=Math.max(lt,at)}et.xmin=wt,et.xmax=kt,et.ymin=gt,et.ymax=at,et.xref=yt,et.yref=Vt,et.subtract=de(et,he),he.push(et),Ne.push(et)}}}}return Ne}function de(Ie,Qe){for(var Ne=!1,Pe=0;Pe<Qe.length;Pe++)for(var Re=Qe[Pe],Ge=0;Ge<Ie.length;Ge++)if(t(Ie[Ge],Re)){Ne=!Ne;break}return Ne}function Ae(Ie,Qe){return"date"===Ie.type&&(Qe=Qe.replace("_"," ")),"log"===Ie.type?Ie.c2p(Qe):Ie.r2p(Qe,null,Ie.calendar)}function Le(Ie){for(var Qe=Ie.length,Ne=[],Pe=0;Pe<Qe;Pe++){var Re=Ie[Pe];Ne=(Ne=Ne.concat(Re)).concat([Re[0]])}return(Ge=Ne).isRect=5===Ge.length&&Ge[0][0]===Ge[4][0]&&Ge[0][1]===Ge[4][1]&&Ge[0][0]===Ge[1][0]&&Ge[2][0]===Ge[3][0]&&Ge[0][1]===Ge[3][1]&&Ge[1][1]===Ge[2][1]||Ge[0][1]===Ge[1][1]&&Ge[2][1]===Ge[3][1]&&Ge[0][0]===Ge[3][0]&&Ge[1][0]===Ge[2][0],Ge.isRect&&(Ge.xmin=Math.min(Ge[0][0],Ge[2][0]),Ge.xmax=Math.max(Ge[0][0],Ge[2][0]),Ge.ymin=Math.min(Ge[0][1],Ge[2][1]),Ge.ymax=Math.max(Ge[0][1],Ge[2][1])),Ge;var Ge}function Me(Ie){return function(Qe,Ne){for(var Pe,Re,Ge=0;Ge<Ie.length;Ge++){var tt=Ie[Ge],ct=tt._id,wt=ct.charAt(0);if(Ne.isRect){Pe||(Pe={});var kt=Ne[wt+"min"],gt=Ne[wt+"max"];void 0!==kt&&void 0!==gt&&(Pe[ct]=[W(tt,kt),W(tt,gt)].sort(L))}else Re||(Re={}),Re[ct]=Ne.map(G(tt))}Pe&&(Qe.range=Pe),Re&&(Qe.lassoPoints=Re)}}function De(Ie,Qe){Qe&&(Qe.selections=(Ie.layout||{}).selections||[]),Ie.emit("plotly_selected",Qe)}function Oe(Ie){Ie.emit("plotly_deselect",null)}Q.exports={reselect:pe,prepSelect:function(Ie,Qe,Ne,Pe,Re){var Ge=!ne(Pe),tt=n(Re),ct=m(Re),wt=s(Re),kt=p(Re),gt=f(Re),at="drawcircle"===Re,et="drawline"===Re||at,yt=Pe.gd,Vt=yt._fullLayout,Gt=gt&&"immediate"===Vt.newselection.mode&&Ge,en=Vt._zoomlayer,Jt=Pe.element.getBoundingClientRect(),cn=Pe.plotinfo,Rt=X(cn),je=Qe-Jt.left,Ye=Ne-Jt.top;Vt._calcInverseTransform(yt);var be,Fe,He,Ke,Ze,ut,lt,he=T.apply3DTransform(Vt._invTransform)(je,Ye),Lt=Vt._invScaleX,Ot=Vt._invScaleY,ot=je=he[0],pt=Ye=he[1],qt="M"+je+","+Ye,St=Pe.xaxes[0],Mt=Pe.yaxes[0],Ce=St._length,Xe=Mt._length,st=Ie.altKey&&!(p(Re)&&wt);B(Ie,yt,Pe),tt&&(be=j([[je,Ye]],R.BENDPX));var dt=en.selectAll("path.select-outline-"+cn.id).data([1]),zt=kt?Vt.newshape:Vt.newselection,Ht=kt&&!wt?zt.fillcolor:"rgba(0,0,0,0)",Kt=zt.line.color||(Ge?e.contrast(yt._fullLayout.plot_bgcolor):"#7f7f7f");dt.enter().append("path").attr("class","select-outline select-outline-"+cn.id).style({opacity:kt?zt.opacity/2:1,"stroke-dasharray":x(zt.line.dash,zt.line.width),"stroke-width":zt.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,Kt).call(e.fill,Ht).attr("fill-rule","evenodd").classed("cursor-move",!!kt).attr("transform",Rt).attr("d",qt+"Z");var Zt=en.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",Rt).attr("d","M0,0Z"),vn=Vt._uid+R.SELECTID,zn=[],gn=te(yt,Pe.xaxes,Pe.yaxes,Pe.subplot);Gt&&!Ie.shiftKey&&(Pe._clearSubplotSelections=function(){if(Ge){var an=St._id,on=Mt._id;ge(yt,an,on,gn);for(var mn=(yt.layout||{}).selections||[],_n=[],Pn=!1,Rn=0;Rn<mn.length;Rn++){var qn=Vt.selections[Rn];qn.xref!==an||qn.yref!==on?_n.push(mn[Rn]):Pn=!0}Pn&&(yt._fullLayout._noEmitSelectedAtStart=!0,k.call("_guiRelayout",yt,{selections:_n}))}});var an,nn=(an=Pe).plotinfo.fillRangeItems||Me(an.xaxes.concat(an.yaxes));Pe.moveFn=function(an,on){Pe._clearSubplotSelections&&(Pe._clearSubplotSelections(),Pe._clearSubplotSelections=void 0),ot=Math.max(0,Math.min(Ce,Lt*an+je)),pt=Math.max(0,Math.min(Xe,Ot*on+Ye));var mn=Math.abs(ot-je),_n=Math.abs(pt-Ye);if(ct){var Pn,Rn,qn;if(gt){var Xn=Vt.selectdirection;switch(Pn="any"===Xn?_n<Math.min(.6*mn,D)?"h":mn<Math.min(.6*_n,D)?"v":"d":Xn){case"h":Rn=at?Xe/2:0,qn=Xe;break;case"v":Rn=at?Ce/2:0,qn=Ce}}if(kt)switch(Vt.newshape.drawdirection){case"vertical":Pn="h",Rn=at?Xe/2:0,qn=Xe;break;case"horizontal":Pn="v",Rn=at?Ce/2:0,qn=Ce;break;case"ortho":mn<_n?(Pn="h",Rn=Ye,qn=pt):(Pn="v",Rn=je,qn=ot);break;default:Pn="d"}"h"===Pn?((Ke=et?y(at,[ot,Rn],[ot,qn]):[[je,Rn],[je,qn],[ot,qn],[ot,Rn]]).xmin=et?ot:Math.min(je,ot),Ke.xmax=et?ot:Math.max(je,ot),Ke.ymin=Math.min(Rn,qn),Ke.ymax=Math.max(Rn,qn),Zt.attr("d","M"+Ke.xmin+","+(Ye-D)+"h-4v"+2*D+"h4ZM"+(Ke.xmax-1)+","+(Ye-D)+"h4v"+2*D+"h-4Z")):"v"===Pn?((Ke=et?y(at,[Rn,pt],[qn,pt]):[[Rn,Ye],[Rn,pt],[qn,pt],[qn,Ye]]).xmin=Math.min(Rn,qn),Ke.xmax=Math.max(Rn,qn),Ke.ymin=et?pt:Math.min(Ye,pt),Ke.ymax=et?pt:Math.max(Ye,pt),Zt.attr("d","M"+(je-D)+","+Ke.ymin+"v-4h"+2*D+"v4ZM"+(je-D)+","+(Ke.ymax-1)+"v4h"+2*D+"v-4Z")):"d"===Pn&&((Ke=et?y(at,[je,Ye],[ot,pt]):[[je,Ye],[je,pt],[ot,pt],[ot,Ye]]).xmin=Math.min(je,ot),Ke.xmax=Math.max(je,ot),Ke.ymin=Math.min(Ye,pt),Ke.ymax=Math.max(Ye,pt),Zt.attr("d","M0,0Z"))}else tt&&(be.addPt([ot,pt]),Ke=be.filtered);if(Pe.selectionDefs&&Pe.selectionDefs.length?(He=ve(Pe.mergedPolygons,Ke,st),Ke.subtract=st,Fe=ee(Pe.selectionDefs.concat([Ke]))):(He=[Ke],Fe=q(Ke)),d(xe(He,wt),dt,Pe),gt){var br,fr=pe(yt,!1),Vr=fr.eventData?fr.eventData.points.slice():[];fr=pe(yt,!1,Fe,gn,Pe),Fe=fr.selectionTesters,lt=fr.eventData,br=be?be.filtered:Le(He),P.throttle(vn,R.SELECTDELAY,function(){for(var cr=(zn=Se(Fe,gn)).slice(),Sr=0;Sr<Vr.length;Sr++){for(var Cr=Vr[Sr],pi=!1,Yn=0;Yn<cr.length;Yn++)if(cr[Yn].curveNumber===Cr.curveNumber&&cr[Yn].pointNumber===Cr.pointNumber){pi=!0;break}pi||cr.push(Cr)}cr.length&&(lt||(lt={}),lt.points=cr),nn(lt,br),yt.emit("plotly_selecting",lt)})}},Pe.clickFn=function(an,on){if(Zt.remove(),yt._fullLayout._activeShapeIndex>=0)yt._fullLayout._deactivateShape(yt);else if(!kt){var mn=Vt.clickmode;P.done(vn).then(function(){if(P.clear(vn),2===an){for(dt.remove(),Ze=0;Ze<gn.length;Ze++)(ut=gn[Ze])._module.selectPoints(ut,!1);if(oe(yt,gn),K(Pe),Oe(yt),gn.length){var _n=gn[0].xaxis,Pn=gn[0].yaxis;if(_n&&Pn){for(var Rn=[],qn=yt._fullLayout.selections,Xn=0;Xn<qn.length;Xn++){var br=qn[Xn];br&&(br.xref===_n._id&&br.yref===Pn._id||Rn.push(br))}Rn.length<qn.length&&(yt._fullLayout._noEmitSelectedAtStart=!0,k.call("_guiRelayout",yt,{selections:Rn}))}}}else mn.indexOf("select")>-1&&V(on,yt,Pe.xaxes,Pe.yaxes,Pe.subplot,Pe,dt),"event"===mn&&De(yt,void 0);r.click(yt,on)}).catch(T.error)}},Pe.doneFn=function(){Zt.remove(),P.done(vn).then(function(){P.clear(vn),!Gt&&Ke&&Pe.selectionDefs&&(Ke.subtract=st,Pe.selectionDefs.push(Ke),Pe.mergedPolygons.length=0,[].push.apply(Pe.mergedPolygons,He)),(Gt||kt)&&K(Pe,Gt),Pe.doneFnCompleted&&Pe.doneFnCompleted(zn),gt&&De(yt,lt)}).catch(T.error)}},clearOutline:u,clearSelectionsCache:K,selectOnClick:V}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(v,Q,$){"use strict";var g=v("../annotations/attributes"),t=v("../../traces/scatter/attributes").line,k=v("../drawing/attributes").dash,x=v("../../lib/extend").extendFlat,e=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),Q.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:x({},g.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:x({},g.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:x({},t.color,{editType:"arraydraw"}),width:x({},t.width,{editType:"calc+arraydraw"}),dash:x({},k,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("./constants"),x=v("./helpers");function e(n){return i(n.line.width,n.xsizemode,n.x0,n.x1,n.path,!1)}function r(n){return i(n.line.width,n.ysizemode,n.y0,n.y1,n.path,!0)}function i(n,m,p,s,f,l){var o=n/2,d=l;if("pixel"===m){var u=f?x.extractPathCoords(f,l?k.paramIsY:k.paramIsX):[p,s],a=g.aggNums(Math.max,null,u),y=g.aggNums(Math.min,null,u),h=y<0?Math.abs(y)+o:o,_=a>0?a+o:o;return{ppad:o,ppadplus:d?h:_,ppadminus:d?_:h}}return{ppad:o}}function c(n,m,p,s,f){var l="category"===n.type||"multicategory"===n.type?n.r2c:n.d2c;if(void 0!==m)return[l(m),l(p)];if(s){var o,d,u,a,y=1/0,h=-1/0,_=s.match(k.segmentRE);for("date"===n.type&&(l=x.decodeDate(l)),o=0;o<_.length;o++)void 0!==(d=f[_[o].charAt(0)].drawn)&&(!(u=_[o].substr(1).match(k.paramRE))||u.length<d||((a=l(u[d]))<y&&(y=a),a>h&&(h=a)));return h>=y?[y,h]:void 0}}Q.exports=function(n){var p=g.filterVisible(n._fullLayout.shapes);if(p.length&&n._fullData.length)for(var s=0;s<p.length;s++){var f,l,o=p[s];o._extremes={};var d=t.getRefType(o.xref),u=t.getRefType(o.yref);if("paper"!==o.xref&&"domain"!==d){var a="pixel"===o.xsizemode?o.xanchor:o.x0,y="pixel"===o.xsizemode?o.xanchor:o.x1;(l=c(f=t.getFromId(n,o.xref),a,y,o.path,k.paramIsX))&&(o._extremes[f._id]=t.findExtremes(f,l,e(o)))}if("paper"!==o.yref&&"domain"!==u){var h="pixel"===o.ysizemode?o.yanchor:o.y0,_="pixel"===o.ysizemode?o.yanchor:o.y1;(l=c(f=t.getFromId(n,o.yref),h,_,o.path,k.paramIsY))&&(o._extremes[f._id]=t.findExtremes(f,l,r(o)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(v,Q,$){"use strict";Q.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./attributes"),e=v("./helpers");function r(i,c,n){function m(C,R){return g.coerce(i,c,x,C,R)}if(m("visible")){var p=m("path"),s="path"!==m("type",p?"path":"rect");s&&delete c.path,m("editable"),m("layer"),m("opacity"),m("fillcolor"),m("fillrule"),m("line.width")&&(m("line.color"),m("line.dash"));for(var f=m("xsizemode"),l=m("ysizemode"),o=["x","y"],d=0;d<2;d++){var u,a,y,h=o[d],_=h+"anchor",b="x"===h?f:l,w={_fullLayout:n},T=t.coerceRef(i,c,w,h,void 0,"paper");if("range"===t.getRefType(T)?((u=t.getFromId(w,T))._shapeIndices.push(c._index),y=e.rangeToShapePosition(u),a=e.shapePositionToRange(u)):a=y=g.identity,s){var L=h+"0",M=h+"1",P=i[L],z=i[M];i[L]=a(i[L],!0),i[M]=a(i[M],!0),"pixel"===b?(m(L,0),m(M,10)):(t.coercePosition(c,w,m,T,L,.25),t.coercePosition(c,w,m,T,M,.75)),c[L]=y(c[L]),c[M]=y(c[M]),i[L]=P,i[M]=z}if("pixel"===b){var S=i[_];i[_]=a(i[_],!0),t.coercePosition(c,w,m,T,_,.25),c[_]=y(c[_]),i[_]=S}}s&&g.noneOrAll(i,c,["x0","x1","y0","y1"])}}Q.exports=function(i,c){k(i,c,{name:"shapes",handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(v,Q,$){"use strict";var g=v("../../lib").strTranslate,t=v("../dragelement"),k=v("../dragelement/helpers"),x=k.drawMode,e=k.selectMode,r=v("../../registry"),i=v("../color"),c=v("./draw_newshape/constants"),n=c.i000,m=c.i090,p=c.i180,s=c.i270,f=v("./handle_outline").clearOutlineControllers,l=v("./draw_newshape/helpers"),o=l.pointsOnRectangle,d=l.pointsOnEllipse,u=l.writePaths,a=v("./draw_newshape/newshapes"),y=v("../selections/draw_newselection/newselections");function h(_,b){var w,T,L,z=_.length;return T=_[w=(b+1)%z][1],L=_[w][2],T===_[b][1]&&L===_[b][2]&&(T=_[w=(b+2)%z][1],L=_[w][2]),[w,T,L]}Q.exports=function _(b,w,T,L){L||(L=0);var M=T.gd;function P(){_(b,w,T,L++),d(b[0])&&z({redrawing:!0})}function z(J){var te={};void 0!==T.isActiveShape&&(T.isActiveShape=!1,te=a(w,T)),void 0!==T.isActiveSelection&&(T.isActiveSelection=!1,te=y(w,T),M._fullLayout._reselect=!0),Object.keys(te).length&&r.call((J||{}).redrawing?"relayout":"_guiRelayout",M,te)}var S,C,R,D,j,q=M._fullLayout._zoomlayer,Z=T.dragmode,W=x(Z),G=e(Z);function X(J){R=+J.srcElement.getAttribute("data-i"),D=+J.srcElement.getAttribute("data-j"),S[R][D].moveFn=ne}function ne(J,te){if(b.length){var ae=j[R][D][1],ce=j[R][D][2],oe=b[R],ve=oe.length;if(o(oe)){var fe=J,xe=te;T.isActiveSelection&&(h(oe,D)[1]===oe[D][1]?xe=0:fe=0);for(var Se=0;Se<ve;Se++)if(Se!==D){var pe=oe[Se];pe[1]===oe[D][1]&&(pe[1]=ae+fe),pe[2]===oe[D][2]&&(pe[2]=ce+xe)}if(oe[D][1]=ae+fe,oe[D][2]=ce+xe,!o(oe))for(var ge=0;ge<ve;ge++)for(var Te=0;Te<oe[ge].length;Te++)oe[ge][Te]=j[R][ge][Te]}else oe[D][1]=ae+J,oe[D][2]=ce+te;P()}}function V(){z()}function N(J,te){if(2===J){R=+te.srcElement.getAttribute("data-i"),D=+te.srcElement.getAttribute("data-j");var ae=b[R];o(ae)||d(ae)||function(){if(b.length&&b[R]&&b[R].length){for(var ce=[],oe=0;oe<b[R].length;oe++)oe!==D&&ce.push(b[R][oe]);ce.length>1&&(2!==ce.length||"Z"!==ce[1][0])&&(0===D&&(ce[0][0]="M"),b[R]=ce,P(),z())}}()}}function U(J,te){(function(ae,ce){if(b.length)for(var oe=0;oe<b.length;oe++)for(var ve=0;ve<b[oe].length;ve++)for(var fe=0;fe+2<b[oe][ve].length;fe+=2)b[oe][ve][fe+1]=j[oe][ve][fe+1]+ae,b[oe][ve][fe+2]=j[oe][ve][fe+2]+ce})(J,te),P()}(W||G)&&(M._fullLayout._outlining=!0),f(M),w.attr("d",u(b)),L||!T.isActiveShape&&!T.isActiveSelection||(j=function(J,te){for(var ae=0;ae<te.length;ae++){var ce=te[ae];J[ae]=[];for(var oe=0;oe<ce.length;oe++){J[ae][oe]=[];for(var ve=0;ve<ce[oe].length;ve++)J[ae][oe][ve]=ce[oe][ve]}}return J}([],b),function(J){S=[];for(var te=0;te<b.length;te++){var ae=b[te],ce=o(ae),oe=!ce&&d(ae);S[te]=[];for(var ve=ae.length,fe=0;fe<ve;fe++)if("Z"!==ae[fe][0]&&(!oe||fe===n||fe===m||fe===p||fe===s)){var xe,Se=ce&&T.isActiveSelection;Se&&(xe=h(ae,fe));var pe=ae[fe][1],ge=ae[fe][2],Te=J.append(Se?"rect":"circle").attr("data-i",te).attr("data-j",fe).style({fill:i.background,stroke:i.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Se){var se=xe[1]-pe,de=xe[2]-ge,Ae=de?5:Math.max(Math.min(25,Math.abs(se)-5),5),Le=se?5:Math.max(Math.min(25,Math.abs(de)-5),5);Te.classed(de?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Ae).attr("height",Le).attr("x",pe-Ae/2).attr("y",ge-Le/2).attr("transform",g(se/2,de/2))}else Te.classed("cursor-grab",!0).attr("r",5).attr("cx",pe).attr("cy",ge);S[te][fe]={element:Te.node(),gd:M,prepFn:X,doneFn:V,clickFn:N},t.init(S[te][fe])}}}(q.append("g").attr("class","outline-controllers")),C=[],b.length&&(C[0]={element:w[0][0],gd:M,prepFn:function ee(J){(R=+J.srcElement.getAttribute("data-i"))||(R=0),C[R].moveFn=U},doneFn:function B(){z()},clickFn:function K(J){2===J&&function(te){if(e(te._fullLayout.dragmode)){f(te);var ae=te._fullLayout._activeSelectionIndex,ce=(te.layout||{}).selections||[];if(ae<ce.length){for(var oe=[],ve=0;ve<ce.length;ve++)ve!==ae&&oe.push(ce[ve]);delete te._fullLayout._activeSelectionIndex;var fe=te._fullLayout.selections[ae];te._fullLayout._deselect={xref:fe.xref,yref:fe.yref},r.call("_guiRelayout",te,{selections:oe})}}}(M)}},t.init(C[0])))}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("./draw_newshape/helpers").readPaths,e=v("./display_outlines"),r=v("./handle_outline").clearOutlineControllers,i=v("../color"),c=v("../drawing"),n=v("../../plot_api/plot_template").arrayEditor,m=v("../dragelement"),p=v("../../lib/setcursor"),s=v("./constants"),f=v("./helpers"),l=f.getPathString;function o(b){var w=b._fullLayout;for(var T in w._shapeUpperLayer.selectAll("path").remove(),w._shapeLowerLayer.selectAll("path").remove(),w._plots){var L=w._plots[T].shapelayer;L&&L.selectAll("path").remove()}for(var M=0;M<w.shapes.length;M++)w.shapes[M].visible&&a(b,M)}function d(b){return!!b._fullLayout._outlining}function u(b){return!b._context.edits.shapePosition}function a(b,w){b._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+w+'"]').remove();var T=f.makeShapesOptionsAndPlotinfo(b,w),L=T.options,M=T.plotinfo;L._input&&!1!==L.visible&&function P(z){var S=l(b,L),C={"data-index":w,"fill-rule":L.fillrule,d:S},R=L.opacity,D=L.fillcolor,j=L.line.width?L.line.color:"rgba(0,0,0,0)",q=L.line.width,Z=L.line.dash;q||!0!==L.editable||(q=5,Z="solid");var W="Z"!==S[S.length-1],G=u(b)&&L.editable&&b._fullLayout._activeShapeIndex===w;G&&(D=W?"rgba(0,0,0,0)":b._fullLayout.activeshape.fillcolor,R=b._fullLayout.activeshape.opacity);var X,ne=z.append("path").attr(C).style("opacity",R).call(i.stroke,j).call(i.fill,D).call(c.dashLine,Z,q);if(y(ne,b,L),(G||b._context.edits.shapePosition)&&(X=n(b.layout,"shapes",L)),G){ne.style({cursor:"move"});var V={element:ne.node(),plotinfo:M,gd:b,editHelpers:X,isActiveShape:!0},N=x(S,b);e(N,ne,V)}else b._context.edits.shapePosition?function(U,ee,B,K,J,te){var ae,ce,oe,ve,fe,xe,Se,pe,ge,Te,se,de,Ae,Le,Me,De,Oe="pixel"===B.xsizemode,Ie="pixel"===B.ysizemode,Qe="line"===B.type,Ne="path"===B.type,Pe=te.modifyItem,Re=k.getFromId(U,B.xref),Ge=k.getRefType(B.xref),tt=k.getFromId(U,B.yref),ct=k.getRefType(B.yref),wt=f.getDataToPixel(U,Re,!1,Ge),kt=f.getDataToPixel(U,tt,!0,ct),gt=f.getPixelToData(U,Re,!1,Ge),at=f.getPixelToData(U,tt,!0,ct),et=Qe?function(){var Rt=Math.max(B.line.width,10),je=J.append("g").attr("data-index",K);je.append("path").attr("d",ee.attr("d")).style({cursor:"move","stroke-width":Rt,"stroke-opacity":"0"});var Ye={"fill-opacity":"0"},he=Math.max(Rt/2,10);return je.append("circle").attr({"data-line-point":"start-point",cx:Oe?wt(B.xanchor)+B.x0:wt(B.x0),cy:Ie?kt(B.yanchor)-B.y0:kt(B.y0),r:he}).style(Ye).classed("cursor-grab",!0),je.append("circle").attr({"data-line-point":"end-point",cx:Oe?wt(B.xanchor)+B.x1:wt(B.x1),cy:Ie?kt(B.yanchor)-B.y1:kt(B.y1),r:he}).style(Ye).classed("cursor-grab",!0),je}():ee,yt={element:et.node(),gd:U,prepFn:function(Rt){var je,Ye,he,be,Fe,He,Ke,Ze;d(U)||(Oe&&(fe=wt(B.xanchor)),Ie&&(xe=kt(B.yanchor)),"path"===B.type?Me=B.path:(ae=Oe?B.x0:wt(B.x0),ce=Ie?B.y0:kt(B.y0),oe=Oe?B.x1:wt(B.x1),ve=Ie?B.y1:kt(B.y1)),ae<oe?(ge=ae,Ae="x0",Te=oe,Le="x1"):(ge=oe,Ae="x1",Te=ae,Le="x0"),!Ie&&ce<ve||Ie&&ce>ve?(Se=ce,se="y0",pe=ve,de="y1"):(Se=ve,se="y1",pe=ce,de="y0"),Vt(Rt),Jt(J,B),je=ee,Fe=(Ye=B).yref,He=k.getFromId(he=U,be=Ye.xref),Ke=k.getFromId(he,Fe),Ze="","paper"===be||He.autorange||(Ze+=be),"paper"===Fe||Ke.autorange||(Ze+=Fe),c.setClipUrl(je,Ze?"clip"+he._fullLayout._uid+Ze:null,he),yt.moveFn="move"===De?Gt:en,yt.altKey=Rt.altKey)},doneFn:function(){d(U)||(p(ee),cn(J),y(ee,U,B),g.call("_guiRelayout",U,te.getUpdateObj()))},clickFn:function(){d(U)||cn(J)}};function Vt(Rt){if(d(U))De=null;else if(Qe)De="path"===Rt.target.tagName?"move":"start-point"===Rt.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var je=yt.element.getBoundingClientRect(),Ye=je.right-je.left,he=je.bottom-je.top,He=!Ne&&Ye>10&&he>10&&!Rt.shiftKey?m.getCursor((Rt.clientX-je.left)/Ye,1-(Rt.clientY-je.top)/he):"move";p(ee,He),De=He.split("-")[0]}}function Gt(Rt,je){if("path"===B.type){var Ye=function(Fe){return Fe},he=Ye,be=Ye;Oe?Pe("xanchor",B.xanchor=gt(fe+Rt)):(he=function(Fe){return gt(wt(Fe)+Rt)},Re&&"date"===Re.type&&(he=f.encodeDate(he))),Ie?Pe("yanchor",B.yanchor=at(xe+je)):(be=function(Fe){return at(kt(Fe)+je)},tt&&"date"===tt.type&&(be=f.encodeDate(be))),Pe("path",B.path=h(Me,he,be))}else Oe?Pe("xanchor",B.xanchor=gt(fe+Rt)):(Pe("x0",B.x0=gt(ae+Rt)),Pe("x1",B.x1=gt(oe+Rt))),Ie?Pe("yanchor",B.yanchor=at(xe+je)):(Pe("y0",B.y0=at(ce+je)),Pe("y1",B.y1=at(ve+je)));ee.attr("d",l(U,B)),Jt(J,B)}function en(Rt,je){if(Ne){var Ye=function(Ce){return Ce},he=Ye,be=Ye;Oe?Pe("xanchor",B.xanchor=gt(fe+Rt)):(he=function(Ce){return gt(wt(Ce)+Rt)},Re&&"date"===Re.type&&(he=f.encodeDate(he))),Ie?Pe("yanchor",B.yanchor=at(xe+je)):(be=function(Ce){return at(kt(Ce)+je)},tt&&"date"===tt.type&&(be=f.encodeDate(be))),Pe("path",B.path=h(Me,he,be))}else if(Qe){if("resize-over-start-point"===De){var Fe=ae+Rt,He=Ie?ce-je:ce+je;Pe("x0",B.x0=Oe?Fe:gt(Fe)),Pe("y0",B.y0=Ie?He:at(He))}else if("resize-over-end-point"===De){var Ke=oe+Rt,Ze=Ie?ve-je:ve+je;Pe("x1",B.x1=Oe?Ke:gt(Ke)),Pe("y1",B.y1=Ie?Ze:at(Ze))}}else{var ut=function(Ce){return-1!==De.indexOf(Ce)},lt=ut("n"),Lt=ut("s"),Ot=ut("w"),ot=ut("e"),pt=lt?Se+je:Se,qt=Lt?pe+je:pe,St=Ot?ge+Rt:ge,Mt=ot?Te+Rt:Te;Ie&&(lt&&(pt=Se-je),Lt&&(qt=pe-je)),(!Ie&&qt-pt>10||Ie&&pt-qt>10)&&(Pe(se,B[se]=Ie?pt:at(pt)),Pe(de,B[de]=Ie?qt:at(qt))),Mt-St>10&&(Pe(Ae,B[Ae]=Oe?St:gt(St)),Pe(Le,B[Le]=Oe?Mt:gt(Mt)))}ee.attr("d",l(U,B)),Jt(J,B)}function Jt(Rt,je){(Oe||Ie)&&function(){var Ye="path"!==je.type,he=Rt.selectAll(".visual-cue").data([0]);he.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var be=wt(Oe?je.xanchor:t.midRange(Ye?[je.x0,je.x1]:f.extractPathCoords(je.path,s.paramIsX))),Fe=kt(Ie?je.yanchor:t.midRange(Ye?[je.y0,je.y1]:f.extractPathCoords(je.path,s.paramIsY)));be=f.roundPositionForSharpStrokeRendering(be,1),Fe=f.roundPositionForSharpStrokeRendering(Fe,1),he.attr("d",Oe&&Ie?"M"+(be-1-1)+","+(Fe-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z":Oe?"M"+(be-1-1)+","+(Fe-9-1)+"v18 h2 v-18 Z":"M"+(be-9-1)+","+(Fe-1-1)+"h18 v2 h-18 Z")}()}function cn(Rt){Rt.selectAll(".visual-cue").remove()}m.init(yt),et.node().onmousemove=Vt}(b,ne,L,w,z,X):!0===L.editable&&ne.style("pointer-events",W||i.opacity(D)*R<=.5?"stroke":"all");ne.node().addEventListener("click",function(){return function(U,ee){if(u(U)){var B=+ee.node().getAttribute("data-index");if(B>=0){if(B===U._fullLayout._activeShapeIndex)return void _(U);U._fullLayout._activeShapeIndex=B,U._fullLayout._deactivateShape=_,o(U)}}}(b,ne)})}("below"!==L.layer?b._fullLayout._shapeUpperLayer:"paper"===L.xref||"paper"===L.yref?b._fullLayout._shapeLowerLayer:M._hadPlotinfo?(M.mainplotinfo||M).shapelayer:b._fullLayout._shapeLowerLayer)}function y(b,w,T){var L=(T.xref+T.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");c.setClipUrl(b,L?"clip"+w._fullLayout._uid+L:null,w)}function h(b,w,T){return b.replace(s.segmentRE,function(L){var M=0,P=L.charAt(0),z=s.paramIsX[P],S=s.paramIsY[P],C=s.numParams[P];return P+L.substr(1).replace(s.paramRE,function(R){return M>=C||(z[M]?R=w(R):S[M]&&(R=T(R)),M++),R})})}function _(b){u(b)&&b._fullLayout._activeShapeIndex>=0&&(r(b),delete b._fullLayout._activeShapeIndex,o(b))}Q.exports={draw:o,drawOne:a,eraseActiveShape:function(b){if(u(b)){r(b);var w=b._fullLayout._activeShapeIndex,T=(b.layout||{}).shapes||[];if(w<T.length){for(var L=[],M=0;M<T.length;M++)M!==w&&L.push(T[M]);delete b._fullLayout._activeShapeIndex,g.call("_guiRelayout",b,{shapes:L})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(v,Q,$){"use strict";var g=v("../../drawing/attributes").dash,t=v("../../../lib/extend").extendFlat;Q.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:t({},g,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(v,Q,$){"use strict";Q.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(v,Q,$){"use strict";var g=v("../../color");Q.exports=function(t,k,x){x("newshape.drawdirection"),x("newshape.layer"),x("newshape.fillcolor"),x("newshape.fillrule"),x("newshape.opacity"),x("newshape.line.width")&&(x("newshape.line.color",g.contrast((t||{}).plot_bgcolor||"#FFF")),x("newshape.line.dash")),x("activeshape.fillcolor"),x("activeshape.opacity")}},{"../../color":367}],466:[function(v,Q,$){"use strict";var g=v("parse-svg-path"),t=v("./constants"),k=t.CIRCLE_SIDES,x=t.SQRT2,e=v("../../selections/helpers"),r=e.p2r,i=e.r2p,c=[0,3,4,5,6,1,2],n=[0,3,4,1,2];function m(s,f){return Math.abs(s-f)<=1e-6}function p(s,f){var l=f[1]-s[1],o=f[2]-s[2];return Math.sqrt(l*l+o*o)}$.writePaths=function(s){var f=s.length;if(!f)return"M0,0Z";for(var l="",o=0;o<f;o++)for(var d=s[o].length,u=0;u<d;u++){var a=s[o][u][0];if("Z"===a)l+="Z";else for(var y=s[o][u].length,h=0;h<y;h++){var _=h;"Q"===a||"S"===a?_=n[h]:"C"===a&&(_=c[h]),l+=s[o][u][_],h>0&&h<y-1&&(l+=",")}}return l},$.readPaths=function(s,f,l,o){var d,u,a,y=g(s),h=[],_=-1,b=0,w=0,T=function(){u=b,a=w};T();for(var L=0;L<y.length;L++){var C=[],R=y[L][0],D=R;switch(R){case"M":h[++_]=[],C.push([D,b=+y[L][1],w=+y[L][2]]),T();break;case"Q":case"S":C.push([D,b=+y[L][3],w=+y[L][4],+y[L][1],+y[L][2]]);break;case"C":C.push([D,b=+y[L][5],w=+y[L][6],+y[L][1],+y[L][2],+y[L][3],+y[L][4]]);break;case"T":case"L":C.push([D,b=+y[L][1],w=+y[L][2]]);break;case"H":C.push([D="L",b=+y[L][1],w]);break;case"V":C.push([D="L",b,w=+y[L][1]]);break;case"A":D="L";var j=+y[L][1],q=+y[L][2];+y[L][4]||(j=-j,q=-q);var Z=b-j,W=w;for(d=1;d<=k/2;d++){var G=2*Math.PI*d/k;C.push([D,Z+j*Math.cos(G),W+q*Math.sin(G)])}break;case"Z":b===u&&w===a||C.push([D,b=u,w=a])}for(var X=(l||{}).domain,ne=f._fullLayout._size,V=l&&"pixel"===l.xsizemode,N=l&&"pixel"===l.ysizemode,U=!1===o,ee=0;ee<C.length;ee++){for(d=0;d+2<7;d+=2){var B=C[ee][d+1],K=C[ee][d+2];void 0!==B&&void 0!==K&&(b=B,w=K,l&&(l.xaxis&&l.xaxis.p2r?(U&&(B-=l.xaxis._offset),B=V?i(l.xaxis,l.xanchor)+B:r(l.xaxis,B)):(U&&(B-=ne.l),X?B=X.x[0]+B/ne.w:B/=ne.w),l.yaxis&&l.yaxis.p2r?(U&&(K-=l.yaxis._offset),K=N?i(l.yaxis,l.yanchor)-K:r(l.yaxis,K)):(U&&(K-=ne.t),K=X?X.y[1]-K/ne.h:1-K/ne.h)),C[ee][d+1]=B,C[ee][d+2]=K)}h[_].push(C[ee].slice())}}return h},$.pointsOnRectangle=function(s){if(5!==s.length)return!1;for(var f=1;f<3;f++)if(!m(s[0][f]-s[1][f],s[3][f]-s[2][f])||!m(s[0][f]-s[3][f],s[1][f]-s[2][f]))return!1;return!(!m(s[0][1],s[1][1])&&!m(s[0][1],s[3][1])||!(p(s[0],s[1])*p(s[0],s[3])))},$.pointsOnEllipse=function(s){var f=s.length;if(f!==k+1)return!1;f=k;for(var l=0;l<f;l++){var o=(2*f-l)%f,d=(f/2+o)%f;if(!m(p(s[l],s[(f/2+l)%f]),p(s[o],s[d])))return!1}return!0},$.handleEllipse=function(s,f,l){if(!s)return[f,l];var o=$.ellipseOver({x0:f[0],y0:f[1],x1:l[0],y1:l[1]}),d=(o.x1+o.x0)/2,u=(o.y1+o.y0)/2,a=(o.x1-o.x0)/2,y=(o.y1-o.y0)/2;a||(a=y/=x),y||(y=a/=x);for(var h=[],_=0;_<k;_++){var b=2*_*Math.PI/k;h.push([d+a*Math.cos(b),u+y*Math.sin(b)])}return h},$.ellipseOver=function(s){var f=s.x0,l=s.y0,o=s.x1,d=s.y1,u=o-f,a=d-l,y=((f-=u)+o)/2,h=((l-=a)+d)/2;return{x0:y-(u*=x),y0:h-(a*=x),x1:y+u,y1:h+a}},$.fixDatesForPaths=function(s,f,l){var o="date"===f.type,d="date"===l.type;if(!o&&!d)return s;for(var u=0;u<s.length;u++)for(var a=0;a<s[u].length;a++)for(var y=0;y+2<s[u][a].length;y+=2)o&&(s[u][a][y+1]=s[u][a][y+1].replace(" ","_")),d&&(s[u][a][y+2]=s[u][a][y+2].replace(" ","_"));return s}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(v,Q,$){"use strict";var g=v("../../dragelement/helpers"),t=g.drawMode,k=g.openMode,x=v("./constants"),e=x.i000,r=x.i090,i=x.i180,c=x.i270,n=x.cos45,m=x.sin45,p=v("../../selections/helpers"),s=p.p2r,f=p.r2p,l=v(".././handle_outline").clearOutline,o=v("./helpers"),d=o.readPaths,u=o.writePaths,a=o.ellipseOver,y=o.fixDatesForPaths;Q.exports=function(h,_){if(h.length){var b=h[0][0];if(b){var w=b.getAttribute("d"),T=_.gd,L=T._fullLayout.newshape,M=_.plotinfo,P=M.xaxis,z=M.yaxis,S=!!M.domain||!M.xaxis,C=!!M.domain||!M.yaxis,R=_.isActiveShape,D=_.dragmode,j=(T.layout||{}).shapes||[];if(!t(D)&&void 0!==R){var q=T._fullLayout._activeShapeIndex;if(q<j.length)switch(T._fullLayout.shapes[q].type){case"rect":D="drawrect";break;case"circle":D="drawcircle";break;case"line":D="drawline";break;case"path":var Z=j[q].path||"";D="Z"===Z[Z.length-1]?"drawclosedpath":"drawopenpath"}}var W,G=k(D),X=d(w,T,M,R),ne={editable:!0,xref:S?"paper":P._id,yref:C?"paper":z._id,layer:L.layer,opacity:L.opacity,line:{color:L.line.color,width:L.line.width,dash:L.line.dash}};if(G||(ne.fillcolor=L.fillcolor,ne.fillrule=L.fillrule),1===X.length&&(W=X[0]),W&&5===W.length&&"drawrect"===D)ne.type="rect",ne.x0=W[0][1],ne.y0=W[0][2],ne.x1=W[2][1],ne.y1=W[2][2];else if(W&&"drawline"===D)ne.type="line",ne.x0=W[0][1],ne.y0=W[0][2],ne.x1=W[1][1],ne.y1=W[1][2];else if(W&&"drawcircle"===D){ne.type="circle";var V=W[e][1],N=W[r][1],U=W[i][1],ee=W[c][1],B=W[e][2],K=W[r][2],J=W[i][2],te=W[c][2],ae=M.xaxis&&("date"===M.xaxis.type||"log"===M.xaxis.type),ce=M.yaxis&&("date"===M.yaxis.type||"log"===M.yaxis.type);ae&&(V=f(M.xaxis,V),N=f(M.xaxis,N),U=f(M.xaxis,U),ee=f(M.xaxis,ee)),ce&&(B=f(M.yaxis,B),K=f(M.yaxis,K),J=f(M.yaxis,J),te=f(M.yaxis,te));var oe=(N+ee)/2,ve=(B+J)/2,fe=a({x0:oe,y0:ve,x1:oe+(ee-N+U-V)/2*n,y1:ve+(te-K+J-B)/2*m});ae&&(fe.x0=s(M.xaxis,fe.x0),fe.x1=s(M.xaxis,fe.x1)),ce&&(fe.y0=s(M.yaxis,fe.y0),fe.y1=s(M.yaxis,fe.y1)),ne.x0=fe.x0,ne.y0=fe.y0,ne.x1=fe.x1,ne.y1=fe.y1}else ne.type="path",P&&z&&y(X,P,z),ne.path=u(X),W=null;l(T);for(var xe=_.editHelpers,Se=(xe||{}).modifyItem,pe=[],ge=0;ge<j.length;ge++){var Te=T._fullLayout.shapes[ge];if(pe[ge]=Te._input,void 0!==R&&ge===T._fullLayout._activeShapeIndex){var se=ne;switch(Te.type){case"line":case"rect":case"circle":Se("x0",se.x0),Se("x1",se.x1),Se("y0",se.y0),Se("y1",se.y1);break;case"path":Se("path",se.path)}}}return void 0===R?(pe.push(ne),pe):xe?xe.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(v,Q,$){"use strict";Q.exports={clearOutlineControllers:function(g){var t=g._fullLayout._zoomlayer;t&&t.selectAll(".outline-controllers").remove()},clearOutline:function(g){var t=g._fullLayout._zoomlayer;t&&t.selectAll(".select-outline").remove(),g._fullLayout._outlining=!1}}},{}],469:[function(v,Q,$){"use strict";var g=v("./constants"),t=v("../../lib"),k=v("../../plots/cartesian/axes");$.rangeToShapePosition=function(x){return"log"===x.type?x.r2d:function(e){return e}},$.shapePositionToRange=function(x){return"log"===x.type?x.d2r:function(e){return e}},$.decodeDate=function(x){return function(e){return e.replace&&(e=e.replace("_"," ")),x(e)}},$.encodeDate=function(x){return function(e){return x(e).replace(" ","_")}},$.extractPathCoords=function(x,e,r){var i=[];return x.match(g.segmentRE).forEach(function(c){var n=e[c.charAt(0)].drawn;if(void 0!==n){var m=c.substr(1).match(g.paramRE);if(m&&!(m.length<n)){var p=m[n],s=r?p:t.cleanNumber(p);i.push(s)}}}),i},$.getDataToPixel=function(x,e,r,i){var c,n=x._fullLayout._size;if(e)if("domain"===i)c=function(p){return e._length*(r?1-p:p)+e._offset};else{var m=$.shapePositionToRange(e);c=function(p){return e._offset+e.r2p(m(p,!0))},"date"===e.type&&(c=$.decodeDate(c))}else c=r?function(p){return n.t+n.h*(1-p)}:function(p){return n.l+n.w*p};return c},$.getPixelToData=function(x,e,r,i){var c,n=x._fullLayout._size;if(e)if("domain"===i)c=function(p){var s=(p-e._offset)/e._length;return r?1-s:s};else{var m=$.rangeToShapePosition(e);c=function(p){return m(e.p2r(p-e._offset))}}else c=r?function(p){return 1-(p-n.t)/n.h}:function(p){return(p-n.l)/n.w};return c},$.roundPositionForSharpStrokeRendering=function(x,e){var r=1===Math.round(e%2),i=Math.round(x);return r?i+.5:i},$.makeShapesOptionsAndPlotinfo=function(x,e){var r=x._fullLayout.shapes[e]||{},i=x._fullLayout._plots[r.xref+r.yref];return i?i._hadPlotinfo=!0:(i={},r.xref&&"paper"!==r.xref&&(i.xaxis=x._fullLayout[r.xref+"axis"]),r.yref&&"paper"!==r.yref&&(i.yaxis=x._fullLayout[r.yref+"axis"])),i.xsizemode=r.xsizemode,i.ysizemode=r.ysizemode,i.xanchor=r.xanchor,i.yanchor=r.yanchor,{options:r,plotinfo:i}},$.makeSelectionsOptionsAndPlotinfo=function(x,e){var r=x._fullLayout.selections[e]||{},i=x._fullLayout._plots[r.xref+r.yref];return i?i._hadPlotinfo=!0:(i={},r.xref&&(i.xaxis=x._fullLayout[r.xref+"axis"]),r.yref&&(i.yaxis=x._fullLayout[r.yref+"axis"])),{options:r,plotinfo:i}},$.getPathString=function(x,e){var r,i,c,n,m,p,s,f,z,S,C,D,j,q,Z,l=e.type,o=k.getRefType(e.xref),d=k.getRefType(e.yref),u=k.getFromId(x,e.xref),a=k.getFromId(x,e.yref),y=x._fullLayout._size;if(u?"domain"===o?i=function(z){return u._offset+u._length*z}:(r=$.shapePositionToRange(u),i=function(z){return u._offset+u.r2p(r(z,!0))}):i=function(z){return y.l+y.w*z},a?"domain"===d?n=function(z){return a._offset+a._length*(1-z)}:(c=$.shapePositionToRange(a),n=function(z){return a._offset+a.r2p(c(z,!0))}):n=function(z){return y.t+y.h*(1-z)},"path"===l)return u&&"date"===u.type&&(i=$.decodeDate(i)),a&&"date"===a.type&&(n=$.decodeDate(n)),S=i,C=n,D=(z=e).xsizemode,j=z.ysizemode,q=z.xanchor,Z=z.yanchor,z.path.replace(g.segmentRE,function(W){var G=0,X=W.charAt(0),ne=g.paramIsX[X],V=g.paramIsY[X],N=g.numParams[X],U=W.substr(1).replace(g.paramRE,function(ee){return ne[G]?ee="pixel"===D?S(q)+Number(ee):S(ee):V[G]&&(ee="pixel"===j?C(Z)-Number(ee):C(ee)),++G>N&&(ee="X"),ee});return G>N&&(U=U.replace(/[\s,]*X.*/,""),t.log("Ignoring extra params in segment "+W)),X+U});if("pixel"===e.xsizemode){var h=i(e.xanchor);m=h+e.x0,p=h+e.x1}else m=i(e.x0),p=i(e.x1);if("pixel"===e.ysizemode){var _=n(e.yanchor);s=_-e.y0,f=_-e.y1}else s=n(e.y0),f=n(e.y1);if("line"===l)return"M"+m+","+s+"L"+p+","+f;if("rect"===l)return"M"+m+","+s+"H"+p+"V"+f+"H"+m+"Z";var b=(m+p)/2,w=(s+f)/2,T=Math.abs(b-m),L=Math.abs(w-s),M="A"+T+","+L,P=b+T+","+w;return"M"+P+M+" 0 1,1 "+b+","+(w-L)+M+" 0 0,1 "+P+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(v,Q,$){"use strict";var g=v("./draw");Q.exports={moduleType:"component",name:"shapes",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),supplyDrawNewShapeDefaults:v("./draw_newshape/defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("shapes"),calcAutorange:v("./calc_autorange"),draw:g.draw,drawOne:g.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("../../plots/pad_attributes"),k=v("../../lib/extend").extendDeepAll,x=v("../../plot_api/edit_types").overrideAll,e=v("../../plots/animation_attributes"),r=v("../../plot_api/plot_template").templatedArray,i=v("./constants"),c=r("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});Q.exports=x(r("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:c,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:k(t({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:g({})},font:g({}),activebgcolor:{valType:"color",dflt:i.gripBgActiveColor},bgcolor:{valType:"color",dflt:i.railBgColor},bordercolor:{valType:"color",dflt:i.railBorderColor},borderwidth:{valType:"number",min:0,dflt:i.railBorderWidth},ticklen:{valType:"number",min:0,dflt:i.tickLength},tickcolor:{valType:"color",dflt:i.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:i.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(v,Q,$){"use strict";Q.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/array_container_defaults"),k=v("./attributes"),x=v("./constants").name,e=k.steps;function r(c,n,m){function p(d,u){return g.coerce(c,n,k,d,u)}for(var s=t(c,n,{name:"steps",handleItemDefaults:i}),f=0,l=0;l<s.length;l++)s[l].visible&&f++;if(f<2?n.visible=!1:p("visible")){n._stepCount=f;var o=n._visibleSteps=g.filterVisible(s);(s[p("active")]||{}).visible||(n.active=o[0]._index),p("x"),p("y"),g.noneOrAll(c,n,["x","y"]),p("xanchor"),p("yanchor"),p("len"),p("lenmode"),p("pad.t"),p("pad.r"),p("pad.b"),p("pad.l"),g.coerceFont(p,"font",m.font),p("currentvalue.visible")&&(p("currentvalue.xanchor"),p("currentvalue.prefix"),p("currentvalue.suffix"),p("currentvalue.offset"),g.coerceFont(p,"currentvalue.font",n.font)),p("transition.duration"),p("transition.easing"),p("bgcolor"),p("activebgcolor"),p("bordercolor"),p("borderwidth"),p("ticklen"),p("tickwidth"),p("tickcolor"),p("minorticklen")}}function i(c,n){function m(s,f){return g.coerce(c,n,e,s,f)}if("skip"===c.method||Array.isArray(c.args)?m("visible"):n.visible=!1){m("method"),m("args");var p=m("label","step-"+n._index);m("value",p),m("execute")}}Q.exports=function(c,n){t(c,n,{name:x,handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../plots/plots"),k=v("../color"),x=v("../drawing"),e=v("../../lib"),r=e.strTranslate,i=v("../../lib/svg_text_utils"),c=v("../../plot_api/plot_template").arrayEditor,n=v("./constants"),m=v("../../constants/alignment"),p=m.LINE_SPACING,s=m.FROM_TL,f=m.FROM_BR;function l(C){return n.autoMarginIdRoot+C._index}function o(C){return C._index}function d(C,R){var D=x.tester.selectAll("g."+n.labelGroupClass).data(R._visibleSteps);D.enter().append("g").classed(n.labelGroupClass,!0);var j=0,q=0;D.each(function(ee){var B=y(g.select(this),{step:ee},R).node();if(B){var K=x.bBox(B);q=Math.max(q,K.height),j=Math.max(j,K.width)}}),D.remove();var Z=R._dims={};Z.inputAreaWidth=Math.max(n.railWidth,n.gripHeight);var W=C._fullLayout._size;if(Z.lx=W.l+W.w*R.x,Z.ly=W.t+W.h*(1-R.y),Z.outerLength="fraction"===R.lenmode?Math.round(W.w*R.len):R.len,Z.inputAreaStart=0,Z.inputAreaLength=Math.round(Z.outerLength-R.pad.l-R.pad.r),Z.labelStride=Math.max(1,Math.ceil((j+n.labelPadding)/((Z.inputAreaLength-2*n.stepInset)/(R._stepCount-1)))),Z.labelHeight=q,Z.currentValueMaxWidth=0,Z.currentValueHeight=0,Z.currentValueTotalHeight=0,Z.currentValueMaxLines=1,R.currentvalue.visible){var ne=x.tester.append("g");D.each(function(ee){var B=u(ne,R,ee.label),K=B.node()&&x.bBox(B.node())||{width:0,height:0},J=i.lineCount(B);Z.currentValueMaxWidth=Math.max(Z.currentValueMaxWidth,Math.ceil(K.width)),Z.currentValueHeight=Math.max(Z.currentValueHeight,Math.ceil(K.height)),Z.currentValueMaxLines=Math.max(Z.currentValueMaxLines,J)}),Z.currentValueTotalHeight=Z.currentValueHeight+R.currentvalue.offset,ne.remove()}Z.height=Z.currentValueTotalHeight+n.tickOffset+R.ticklen+n.labelOffset+Z.labelHeight+R.pad.t+R.pad.b;var V="left";e.isRightAnchor(R)&&(Z.lx-=Z.outerLength,V="right"),e.isCenterAnchor(R)&&(Z.lx-=Z.outerLength/2,V="center");var N="top";e.isBottomAnchor(R)&&(Z.ly-=Z.height,N="bottom"),e.isMiddleAnchor(R)&&(Z.ly-=Z.height/2,N="middle"),Z.outerLength=Math.ceil(Z.outerLength),Z.height=Math.ceil(Z.height),Z.lx=Math.round(Z.lx),Z.ly=Math.round(Z.ly);var U={y:R.y,b:Z.height*f[N],t:Z.height*s[N]};"fraction"===R.lenmode?(U.l=0,U.xl=R.x-R.len*s[V],U.r=0,U.xr=R.x+R.len*f[V]):(U.x=R.x,U.l=Z.outerLength*s[V],U.r=Z.outerLength*f[V]),t.autoMargin(C,l(R),U)}function u(C,R,D){if(R.currentvalue.visible){var j,q,Z=R._dims;switch(R.currentvalue.xanchor){case"right":j=Z.inputAreaLength-n.currentValueInset-Z.currentValueMaxWidth,q="left";break;case"center":j=.5*Z.inputAreaLength,q="middle";break;default:j=n.currentValueInset,q="left"}var W=e.ensureSingle(C,"text",n.labelClass,function(U){U.attr({"text-anchor":q,"data-notex":1})}),G=R.currentvalue.prefix?R.currentvalue.prefix:"";if("string"==typeof D)G+=D;else{var X=R.steps[R.active].label,ne=R._gd._fullLayout._meta;ne&&(X=e.templateString(X,ne)),G+=X}R.currentvalue.suffix&&(G+=R.currentvalue.suffix),W.call(x.font,R.currentvalue.font).text(G).call(i.convertToTspans,R._gd);var V=i.lineCount(W);return i.positionText(W,j,(Z.currentValueMaxLines+1-V)*R.currentvalue.font.size*p),W}}function a(C,R,D){e.ensureSingle(C,"rect",n.gripRectClass,function(j){j.call(w,R,C,D).style("pointer-events","all")}).attr({width:n.gripWidth,height:n.gripHeight,rx:n.gripRadius,ry:n.gripRadius}).call(k.stroke,D.bordercolor).call(k.fill,D.bgcolor).style("stroke-width",D.borderwidth+"px")}function y(C,R,D){var j=e.ensureSingle(C,"text",n.labelClass,function(W){W.attr({"text-anchor":"middle","data-notex":1})}),q=R.step.label,Z=D._gd._fullLayout._meta;return Z&&(q=e.templateString(q,Z)),j.call(x.font,D.font).text(q).call(i.convertToTspans,D._gd),j}function h(C,R){var D=e.ensureSingle(C,"g",n.labelsClass),j=R._dims,q=D.selectAll("g."+n.labelGroupClass).data(j.labelSteps);q.enter().append("g").classed(n.labelGroupClass,!0),q.exit().remove(),q.each(function(Z){var W=g.select(this);W.call(y,Z,R),x.setTranslate(W,M(R,Z.fraction),n.tickOffset+R.ticklen+R.font.size*p+n.labelOffset+j.currentValueTotalHeight)})}function _(C,R,D,j,q){var Z=Math.round(j*(D._stepCount-1)),W=D._visibleSteps[Z]._index;W!==D.active&&b(C,R,D,W,!0,q)}function b(C,R,D,j,q,Z){var W=D.active;D.active=j,c(C.layout,n.name,D).applyUpdate("active",j);var G=D.steps[D.active];R.call(L,D,Z),R.call(u,D),C.emit("plotly_sliderchange",{slider:D,step:D.steps[D.active],interaction:q,previousActive:W}),G&&G.method&&q&&(R._nextMethod?(R._nextMethod.step=G,R._nextMethod.doCallback=q,R._nextMethod.doTransition=Z):(R._nextMethod={step:G,doCallback:q,doTransition:Z},R._nextMethodRaf=window.requestAnimationFrame(function(){var X=R._nextMethod.step;X.method&&(X.execute&&t.executeAPICommand(C,X.method,X.args),R._nextMethod=null,R._nextMethodRaf=null)})))}function w(C,R,D){var j=D.node(),q=g.select(R);function Z(){return D.data()[0]}function W(){var G=Z();R.emit("plotly_sliderstart",{slider:G});var X=D.select("."+n.gripRectClass);g.event.stopPropagation(),g.event.preventDefault(),X.call(k.fill,G.activebgcolor);var ne=P(G,g.mouse(j)[0]);function V(){var U=Z(),ee=P(U,g.mouse(j)[0]);_(R,D,U,ee,!1)}function N(){var U=Z();U._dragging=!1,X.call(k.fill,U.bgcolor),q.on("mouseup",null),q.on("mousemove",null),q.on("touchend",null),q.on("touchmove",null),R.emit("plotly_sliderend",{slider:U,step:U.steps[U.active]})}_(R,D,G,ne,!0),G._dragging=!0,q.on("mousemove",V),q.on("touchmove",V),q.on("mouseup",N),q.on("touchend",N)}C.on("mousedown",W),C.on("touchstart",W)}function T(C,R){var D=C.selectAll("rect."+n.tickRectClass).data(R._visibleSteps),j=R._dims;D.enter().append("rect").classed(n.tickRectClass,!0),D.exit().remove(),D.attr({width:R.tickwidth+"px","shape-rendering":"crispEdges"}),D.each(function(q,Z){var W=Z%j.labelStride==0,G=g.select(this);G.attr({height:W?R.ticklen:R.minorticklen}).call(k.fill,R.tickcolor),x.setTranslate(G,M(R,Z/(R._stepCount-1))-.5*R.tickwidth,(W?n.tickOffset:n.minorTickOffset)+j.currentValueTotalHeight)})}function L(C,R,D){for(var j=C.select("rect."+n.gripRectClass),q=0,Z=0;Z<R._stepCount;Z++)if(R._visibleSteps[Z]._index===R.active){q=Z;break}var W=M(R,q/(R._stepCount-1));if(!R._invokingCommand){var G=j;D&&R.transition.duration>0&&(G=G.transition().duration(R.transition.duration).ease(R.transition.easing)),G.attr("transform",r(W-.5*n.gripWidth,R._dims.currentValueTotalHeight))}}function M(C,R){var D=C._dims;return D.inputAreaStart+n.stepInset+(D.inputAreaLength-2*n.stepInset)*Math.min(1,Math.max(0,R))}function P(C,R){var D=C._dims;return Math.min(1,Math.max(0,(R-n.stepInset-D.inputAreaStart)/(D.inputAreaLength-2*n.stepInset-2*D.inputAreaStart)))}function z(C,R,D){var j=D._dims,q=e.ensureSingle(C,"rect",n.railTouchRectClass,function(Z){Z.call(w,R,C,D).style("pointer-events","all")});q.attr({width:j.inputAreaLength,height:Math.max(j.inputAreaWidth,n.tickOffset+D.ticklen+j.labelHeight)}).call(k.fill,D.bgcolor).attr("opacity",0),x.setTranslate(q,0,j.currentValueTotalHeight)}function S(C,R){var D=R._dims,j=D.inputAreaLength-2*n.railInset,q=e.ensureSingle(C,"rect",n.railRectClass);q.attr({width:j,height:n.railWidth,rx:n.railRadius,ry:n.railRadius,"shape-rendering":"crispEdges"}).call(k.stroke,R.bordercolor).call(k.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px"),x.setTranslate(q,n.railInset,.5*(D.inputAreaWidth-n.railWidth)+D.currentValueTotalHeight)}Q.exports=function(C){var R=C._fullLayout,D=function(X,ne){for(var V=X[n.name],N=[],U=0;U<V.length;U++){var ee=V[U];ee.visible&&(ee._gd=ne,N.push(ee))}return N}(R,C),j=R._infolayer.selectAll("g."+n.containerClassName).data(D.length>0?[0]:[]);function q(X){X._commandObserver&&(X._commandObserver.remove(),delete X._commandObserver),t.autoMargin(C,l(X))}if(j.enter().append("g").classed(n.containerClassName,!0).style("cursor","ew-resize"),j.exit().each(function(){g.select(this).selectAll("g."+n.groupClassName).each(q)}).remove(),0!==D.length){var Z=j.selectAll("g."+n.groupClassName).data(D,o);Z.enter().append("g").classed(n.groupClassName,!0),Z.exit().each(q).remove();for(var W=0;W<D.length;W++)d(C,D[W]);Z.each(function(X){var ne=g.select(this);(function(V){var N=V._dims;N.labelSteps=[];for(var U=V._stepCount,ee=0;ee<U;ee+=N.labelStride)N.labelSteps.push({fraction:ee/(U-1),step:V._visibleSteps[ee]})})(X),t.manageCommandObserver(C,X,X._visibleSteps,function(V){var N=ne.data()[0];N.active!==V.index&&(N._dragging||b(C,ne,N,V.index,!1,!0))}),function(V,N,U){(U.steps[U.active]||{}).visible||(U.active=U._visibleSteps[0]._index),N.call(u,U).call(S,U).call(h,U).call(T,U).call(z,V,U).call(a,V,U);var ee=U._dims;x.setTranslate(N,ee.lx+U.pad.l,ee.ly+U.pad.t),N.call(L,U,!1),N.call(u,U)}(C,g.select(this),X)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(v,Q,$){"use strict";var g=v("./constants");Q.exports={moduleType:"component",name:g.name,layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),draw:v("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../lib"),r=e.strTranslate,i=v("../drawing"),c=v("../color"),n=v("../../lib/svg_text_utils"),m=v("../../constants/interactions"),p=v("../../constants/alignment").OPPOSITE_SIDE,s=/ [XY][0-9]* /;Q.exports={draw:function(f,l,o){var d,a=o.propName,y=o.placeholder,h=o.traceIndex,_=o.avoid||{},b=o.attributes,w=o.transform,T=o.containerGroup,L=f._fullLayout,M=1,P=!1,z=o.propContainer.title,S=(z&&z.text?z.text:"").trim(),C=z&&z.font?z.font:{},R=C.family,D=C.size,j=C.color;"title.text"===a?d="titleText":-1!==a.indexOf("axis")?d="axisTitleText":a.indexOf(!0)&&(d="colorbarTitleText");var q=f._context.edits[d];""===S?M=0:S.replace(s," % ")===y.replace(s," % ")&&(M=.2,P=!0,q||(S="")),o._meta?S=e.templateString(S,o._meta):L._meta&&(S=e.templateString(S,L._meta));var Z,W=S||q;T||(T=e.ensureSingle(L._infolayer,"g","g-"+l),Z=L._hColorbarMoveTitle);var G=T.selectAll("text").data(W?[0]:[]);if(G.enter().append("text"),G.text(S).attr("class",l),G.exit().remove(),!W)return T;function X(N){e.syncOrAsync([ne,V],N)}function ne(N){var U;return!w&&Z&&(w={}),w?(U="",w.rotate&&(U+="rotate("+[w.rotate,b.x,b.y]+")"),(w.offset||Z)&&(U+=r(0,(w.offset||0)-(Z||0)))):U=null,N.attr("transform",U),N.style({"font-family":R,"font-size":g.round(D,2)+"px",fill:c.rgb(j),opacity:M*c.opacity(j),"font-weight":k.fontWeight}).attr(b).call(n.convertToTspans,f),k.previousPromises(f)}function V(N){var U=g.select(N.node().parentNode);if(_&&_.selection&&_.side&&S){U.attr("transform",null);var ee=p[_.side],B="left"===_.side||"top"===_.side?-1:1,K=t(_.pad)?_.pad:2,J=i.bBox(U.node()),ae=_.maxShift||B*({left:0,top:0,right:L.width,bottom:L.height}[_.side]-J[_.side]),ce=0;if(ae<0)ce=ae;else{var oe=_.offsetLeft||0,ve=_.offsetTop||0;J.left-=oe,J.right-=oe,J.top-=ve,J.bottom-=ve,_.selection.each(function(){var xe=i.bBox(this);e.bBoxIntersect(J,xe,K)&&(ce=Math.max(ce,B*(xe[_.side]-J[ee])+K))}),ce=Math.min(ae,ce)}if(ce>0||ae<0){var fe={left:[-ce,0],right:[ce,0],top:[0,-ce],bottom:[0,ce]}[_.side];U.attr("transform",r(fe[0],fe[1]))}}}return G.call(X),q&&(S?G.on(".opacity",null):(M=0,P=!0,G.text(y).on("mouseover.opacity",function(){g.select(this).transition().duration(m.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){g.select(this).transition().duration(m.HIDE_PLACEHOLDER).style("opacity",0)})),G.call(n.makeEditable,{gd:f}).on("edit",function(N){void 0!==h?x.call("_guiRestyle",f,a,N,h):x.call("_guiRelayout",f,a,N)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(X)}).on("input",function(N){this.text(N||" ").call(n.positionText,b.x,b.y)})),G.classed("js-placeholder",P),T}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("../color/attributes"),k=v("../../lib/extend").extendFlat,x=v("../../plot_api/edit_types").overrideAll,e=v("../../plots/pad_attributes"),r=v("../../plot_api/plot_template").templatedArray,i=r("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});Q.exports=x(r("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:i,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:k(e({editType:"arraydraw"}),{}),font:g({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:t.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(v,Q,$){"use strict";Q.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25c4",right:"\u25ba",up:"\u25b2",down:"\u25bc"}}},{}],479:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/array_container_defaults"),k=v("./attributes"),x=v("./constants").name,e=k.buttons;function r(c,n,m){function p(s,f){return g.coerce(c,n,k,s,f)}p("visible",t(c,n,{name:"buttons",handleItemDefaults:i}).length>0)&&(p("active"),p("direction"),p("type"),p("showactive"),p("x"),p("y"),g.noneOrAll(c,n,["x","y"]),p("xanchor"),p("yanchor"),p("pad.t"),p("pad.r"),p("pad.b"),p("pad.l"),g.coerceFont(p,"font",m.font),p("bgcolor",m.paper_bgcolor),p("bordercolor"),p("borderwidth"))}function i(c,n){function m(p,s){return g.coerce(c,n,e,p,s)}m("visible","skip"===c.method||Array.isArray(c.args))&&(m("method"),m("args"),m("args2"),m("label"),m("execute"))}Q.exports=function(c,n){t(c,n,{name:x,handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../plots/plots"),k=v("../color"),x=v("../drawing"),e=v("../../lib"),r=v("../../lib/svg_text_utils"),i=v("../../plot_api/plot_template").arrayEditor,c=v("../../constants/alignment").LINE_SPACING,n=v("./constants"),m=v("./scrollbox");function p(M){return M._index}function s(M,P){return+M.attr(n.menuIndexAttrName)===P._index}function f(M,P,z,S,C,R,D,j){P.active=D,i(M.layout,n.name,P).applyUpdate("active",D),"buttons"===P.type?o(M,S,null,null,P):"dropdown"===P.type&&(C.attr(n.menuIndexAttrName,"-1"),l(M,S,C,R,P),j||o(M,S,C,R,P))}function l(M,P,z,S,C){var R=e.ensureSingle(P,"g",n.headerClassName,function(G){G.style("pointer-events","all")}),D=C._dims,Z={y:C.pad.t,yPad:0,x:C.pad.l,xPad:0,index:0},W={width:D.headerWidth,height:D.headerHeight};R.call(d,C,C.buttons[C.active]||n.blankHeaderOpts,M).call(T,C,Z,W),e.ensureSingle(P,"text",n.headerArrowClassName,function(G){G.attr("text-anchor","end").call(x.font,C.font).text(n.arrowSymbol[C.direction])}).attr({x:D.headerWidth-n.arrowOffsetX+C.pad.l,y:D.headerHeight/2+n.textOffsetY+C.pad.t}),R.on("click",function(){z.call(L,String(s(z,C)?-1:C._index)),o(M,P,z,S,C)}),R.on("mouseover",function(){R.call(h)}),R.on("mouseout",function(){R.call(_,C)}),x.setTranslate(P,D.lx,D.ly)}function o(M,P,z,S,C){z||(z=P).attr("pointer-events","all");var R=-1==+z.attr(n.menuIndexAttrName)&&"buttons"!==C.type?[]:C.buttons,D="dropdown"===C.type?n.dropdownButtonClassName:n.buttonClassName,j=z.selectAll("g."+D).data(e.filterVisible(R)),q=j.enter().append("g").classed(D,!0),Z=j.exit();"dropdown"===C.type?(q.attr("opacity","0").transition().attr("opacity","1"),Z.transition().attr("opacity","0").remove()):Z.remove();var W=0,G=0,X=C._dims,ne=-1!==["up","down"].indexOf(C.direction);"dropdown"===C.type&&(ne?G=X.headerHeight+n.gapButtonHeader:W=X.headerWidth+n.gapButtonHeader),"dropdown"===C.type&&"up"===C.direction&&(G=-n.gapButtonHeader+n.gapButton-X.openHeight),"dropdown"===C.type&&"left"===C.direction&&(W=-n.gapButtonHeader+n.gapButton-X.openWidth);var U,ee,B,V={x:X.lx+W+C.pad.l,y:X.ly+G+C.pad.t,yPad:n.gapButton,xPad:n.gapButton,index:0},N={l:V.x+C.borderwidth,t:V.y+C.borderwidth};j.each(function(U,ee){var B=g.select(this);B.call(d,C,U,M).call(T,C,V),B.on("click",function(){g.event.defaultPrevented||(U.execute&&(U.args2&&C.active===ee?(f(M,C,0,P,z,S,-1),t.executeAPICommand(M,U.method,U.args2)):(f(M,C,0,P,z,S,ee),t.executeAPICommand(M,U.method,U.args))),M.emit("plotly_buttonclicked",{menu:C,button:U,active:C.active}))}),B.on("mouseover",function(){B.call(h)}),B.on("mouseout",function(){B.call(_,C),j.call(y,C)})}),j.call(y,C),ne?(N.w=Math.max(X.openWidth,X.headerWidth),N.h=V.y-N.t):(N.w=V.x-N.l,N.h=Math.max(X.openHeight,X.headerHeight)),N.direction=C.direction,S&&(j.size()?function(U,ee,B,K,J,te){var ae,ce,oe,ve=J.direction,xe=J._dims,Se=J.active;if("up"===ve||"down"===ve)for(ce=0,oe=0;oe<Se;oe++)ce+=xe.heights[oe]+n.gapButton;else for(ae=0,oe=0;oe<Se;oe++)ae+=xe.widths[oe]+n.gapButton;K.enable(te,ae,ce),K.hbar&&K.hbar.attr("opacity","0").transition().attr("opacity","1"),K.vbar&&K.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,S,C,N):(B=!!(U=S).vbar,(ee=!!U.hbar)&&U.hbar.transition().attr("opacity","0").each("end",function(){ee=!1,B||U.disable()}),B&&U.vbar.transition().attr("opacity","0").each("end",function(){B=!1,ee||U.disable()})))}function d(M,P,z,S){M.call(u,P).call(a,P,z,S)}function u(M,P){e.ensureSingle(M,"rect",n.itemRectClassName,function(z){z.attr({rx:n.rx,ry:n.ry,"shape-rendering":"crispEdges"})}).call(k.stroke,P.bordercolor).call(k.fill,P.bgcolor).style("stroke-width",P.borderwidth+"px")}function a(M,P,z,S){var C=e.ensureSingle(M,"text",n.itemTextClassName,function(j){j.attr({"text-anchor":"start","data-notex":1})}),R=z.label,D=S._fullLayout._meta;D&&(R=e.templateString(R,D)),C.call(x.font,P.font).text(R).call(r.convertToTspans,S)}function y(M,P){var z=P.active;M.each(function(S,C){var R=g.select(this);C===z&&P.showactive&&R.select("rect."+n.itemRectClassName).call(k.fill,n.activeColor)})}function h(M){M.select("rect."+n.itemRectClassName).call(k.fill,n.hoverColor)}function _(M,P){M.select("rect."+n.itemRectClassName).call(k.fill,P.bgcolor)}function b(M,P){var z=P._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},S=x.tester.selectAll("g."+n.dropdownButtonClassName).data(e.filterVisible(P.buttons));S.enter().append("g").classed(n.dropdownButtonClassName,!0);var C=-1!==["up","down"].indexOf(P.direction);S.each(function(W,G){var X=g.select(this);X.call(d,P,W,M);var ne=X.select("."+n.itemTextClassName),V=ne.node()&&x.bBox(ne.node()).width,N=Math.max(V+n.textPadX,n.minWidth),U=P.font.size*c,ee=r.lineCount(ne),B=Math.max(U*ee,n.minHeight)+n.textOffsetY;B=Math.ceil(B),N=Math.ceil(N),z.widths[G]=N,z.heights[G]=B,z.height1=Math.max(z.height1,B),z.width1=Math.max(z.width1,N),C?(z.totalWidth=Math.max(z.totalWidth,N),z.openWidth=z.totalWidth,z.totalHeight+=B+n.gapButton,z.openHeight+=B+n.gapButton):(z.totalWidth+=N+n.gapButton,z.openWidth+=N+n.gapButton,z.totalHeight=Math.max(z.totalHeight,B),z.openHeight=z.totalHeight)}),C?z.totalHeight-=n.gapButton:z.totalWidth-=n.gapButton,z.headerWidth=z.width1+n.arrowPadX,z.headerHeight=z.height1,"dropdown"===P.type&&(C?(z.width1+=n.arrowPadX,z.totalHeight=z.height1):z.totalWidth=z.width1,z.totalWidth+=n.arrowPadX),S.remove();var R=z.totalWidth+P.pad.l+P.pad.r,D=z.totalHeight+P.pad.t+P.pad.b,j=M._fullLayout._size;z.lx=j.l+j.w*P.x,z.ly=j.t+j.h*(1-P.y);var q="left";e.isRightAnchor(P)&&(z.lx-=R,q="right"),e.isCenterAnchor(P)&&(z.lx-=R/2,q="center");var Z="top";e.isBottomAnchor(P)&&(z.ly-=D,Z="bottom"),e.isMiddleAnchor(P)&&(z.ly-=D/2,Z="middle"),z.totalWidth=Math.ceil(z.totalWidth),z.totalHeight=Math.ceil(z.totalHeight),z.lx=Math.round(z.lx),z.ly=Math.round(z.ly),t.autoMargin(M,w(P),{x:P.x,y:P.y,l:R*({right:1,center:.5}[q]||0),r:R*({left:1,center:.5}[q]||0),b:D*({top:1,middle:.5}[Z]||0),t:D*({bottom:1,middle:.5}[Z]||0)})}function w(M){return n.autoMarginIdRoot+M._index}function T(M,P,z,S){S=S||{};var C=M.select("."+n.itemRectClassName),R=M.select("."+n.itemTextClassName),D=P.borderwidth,j=z.index,q=P._dims;x.setTranslate(M,D+z.x,D+z.y);var Z=-1!==["up","down"].indexOf(P.direction),W=S.height||(Z?q.heights[j]:q.height1);C.attr({x:0,y:0,width:S.width||(Z?q.width1:q.widths[j]),height:W});var G=P.font.size*c,X=(r.lineCount(R)-1)*G/2;r.positionText(R,n.textOffsetX,W/2-X+n.textOffsetY),Z?z.y+=q.heights[j]+z.yPad:z.x+=q.widths[j]+z.xPad,z.index++}function L(M,P){M.attr(n.menuIndexAttrName,P||"-1").selectAll("g."+n.dropdownButtonClassName).remove()}Q.exports=function(M){var P=M._fullLayout,z=e.filterVisible(P[n.name]);function S(G){t.autoMargin(M,w(G))}var C=P._menulayer.selectAll("g."+n.containerClassName).data(z.length>0?[0]:[]);if(C.enter().append("g").classed(n.containerClassName,!0).style("cursor","pointer"),C.exit().each(function(){g.select(this).selectAll("g."+n.headerGroupClassName).each(S)}).remove(),0!==z.length){var R=C.selectAll("g."+n.headerGroupClassName).data(z,p);R.enter().append("g").classed(n.headerGroupClassName,!0);for(var D=e.ensureSingle(C,"g",n.dropdownButtonGroupClassName,function(G){G.style("pointer-events","all")}),j=0;j<z.length;j++)b(M,z[j]);var W=new m(M,D,"updatemenus"+P._uid);R.enter().size()&&(D.node().parentNode.appendChild(D.node()),D.call(L)),R.exit().each(function(G){D.call(L),S(G)}).remove(),R.each(function(G){var X=g.select(this),ne="dropdown"===G.type?D:null;t.manageCommandObserver(M,G,G.buttons,function(V){f(M,G,0,X,ne,W,V.index,!0)}),"dropdown"===G.type?(l(M,X,D,W,G),s(D,G)&&o(M,X,D,W,G)):o(M,X,null,null,G)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(v,Q,$){arguments[4][475][0].apply($,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(v,Q,$){"use strict";Q.exports=e;var g=v("@plotly/d3"),t=v("../color"),k=v("../drawing"),x=v("../../lib");function e(r,i,c){this.gd=r,this.container=i,this.id=c,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(r,i,c){var n=this.gd._fullLayout,m=n.width,p=n.height;this.position=r;var s,f,l,o,d=this.position.l,u=this.position.w,a=this.position.t,y=this.position.h,h=this.position.direction,_="down"===h,b="left"===h,w="up"===h,T=u,L=y;_||b||"right"===h||w||(this.position.direction="down",_=!0),_||w?(f=(s=d)+T,_?(l=a,L=(o=Math.min(l+L,p))-l):L=(o=a+L)-(l=Math.max(o-L,0))):(o=(l=a)+L,b?T=(f=d+T)-(s=Math.max(f-T,0)):(s=d,T=(f=Math.min(s+T,m))-s)),this._box={l:s,t:l,w:T,h:L};var M=u>T,P=e.barLength+2*e.barPad,z=e.barWidth+2*e.barPad,S=d,C=a+y;C+z>p&&(C=p-z);var R=this.container.selectAll("rect.scrollbar-horizontal").data(M?[0]:[]);R.exit().on(".drag",null).remove(),R.enter().append("rect").classed("scrollbar-horizontal",!0).call(t.fill,e.barColor),M?(this.hbar=R.attr({rx:e.barRadius,ry:e.barRadius,x:S,y:C,width:P,height:z}),this._hbarXMin=S+P/2,this._hbarTranslateMax=T-P):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var D=y>L,j=e.barWidth+2*e.barPad,q=e.barLength+2*e.barPad,Z=d+u,W=a;Z+j>m&&(Z=m-j);var G=this.container.selectAll("rect.scrollbar-vertical").data(D?[0]:[]);G.exit().on(".drag",null).remove(),G.enter().append("rect").classed("scrollbar-vertical",!0).call(t.fill,e.barColor),D?(this.vbar=G.attr({rx:e.barRadius,ry:e.barRadius,x:Z,y:W,width:j,height:q}),this._vbarYMin=W+q/2,this._vbarTranslateMax=L-q):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var X=this.id,ne=s-.5,V=D?f+j+.5:f+.5,N=l-.5,U=M?o+z+.5:o+.5,ee=n._topdefs.selectAll("#"+X).data(M||D?[0]:[]);if(ee.exit().remove(),ee.enter().append("clipPath").attr("id",X).append("rect"),M||D?(this._clipRect=ee.select("rect").attr({x:Math.floor(ne),y:Math.floor(N),width:Math.ceil(V)-Math.floor(ne),height:Math.ceil(U)-Math.floor(N)}),this.container.call(k.setClipUrl,X,this.gd),this.bg.attr({x:d,y:a,width:u,height:y})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(k.setClipUrl,null),delete this._clipRect),M||D){var B=g.behavior.drag().on("dragstart",function(){g.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(B);var K=g.behavior.drag().on("dragstart",function(){g.event.sourceEvent.preventDefault(),g.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));M&&this.hbar.on(".drag",null).call(K),D&&this.vbar.on(".drag",null).call(K)}this.setTranslate(i,c)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(k.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var r=this.translateX,i=this.translateY;this.hbar&&(r-=g.event.dx),this.vbar&&(i-=g.event.dy),this.setTranslate(r,i)},e.prototype._onBoxWheel=function(){var r=this.translateX,i=this.translateY;this.hbar&&(r+=g.event.deltaY),this.vbar&&(i+=g.event.deltaY),this.setTranslate(r,i)},e.prototype._onBarDrag=function(){var r=this.translateX,i=this.translateY;if(this.hbar){var c=r+this._hbarXMin,n=c+this._hbarTranslateMax;r=(x.constrain(g.event.x,c,n)-c)/(n-c)*(this.position.w-this._box.w)}if(this.vbar){var m=i+this._vbarYMin,p=m+this._vbarTranslateMax;i=(x.constrain(g.event.y,m,p)-m)/(p-m)*(this.position.h-this._box.h)}this.setTranslate(r,i)},e.prototype.setTranslate=function(r,i){var c=this.position.w-this._box.w,n=this.position.h-this._box.h;r=x.constrain(r||0,0,c),i=x.constrain(i||0,0,n),this.translateX=r,this.translateY=i,this.container.call(k.setTranslate,this._box.l-this.position.l-r,this._box.t-this.position.t-i),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+r-.5),y:Math.floor(this.position.t+i-.5)}),this.hbar&&this.hbar.call(k.setTranslate,r+r/c*this._hbarTranslateMax,i),this.vbar&&this.vbar.call(k.setTranslate,r,i+i/n*this._vbarTranslateMax)}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(v,Q,$){"use strict";Q.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(v,Q,$){"use strict";Q.exports={axisRefDescription:function(g,t,k){return["If set to a",g,"axis id (e.g. *"+g+"* or","*"+g+"2*), the `"+g+"` position refers to a",g,"coordinate. If set to *paper*, the `"+g+"`","position refers to the distance from the",t,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",t,"("+k+"). If set to a",g,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",t,"of the domain of that axis: e.g.,","*"+g+"2 domain* refers to the domain of the second",g," axis and a",g,"position of 0.5 refers to the","point between the",t,"and the",k,"of the domain of the","second",g,"axis."].join(" ")}}},{}],485:[function(v,Q,$){"use strict";Q.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25b2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25bc"}}},{}],486:[function(v,Q,$){"use strict";Q.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(v,Q,$){"use strict";Q.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(v,Q,$){"use strict";Q.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(v,Q,$){"use strict";Q.exports={circle:"\u25cf","circle-open":"\u25cb",square:"\u25a0","square-open":"\u25a1",diamond:"\u25c6","diamond-open":"\u25c7",cross:"+",x:"\u274c"}},{}],490:[function(v,Q,$){"use strict";Q.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(v,Q,$){"use strict";Q.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(v,Q,$){"use strict";$.xmlns="http://www.w3.org/2000/xmlns/",$.svg="http://www.w3.org/2000/svg",$.xlink="http://www.w3.org/1999/xlink",$.svgAttrs={xmlns:$.svg,"xmlns:xlink":$.xlink}},{}],493:[function(v,Q,$){"use strict";$.version=v("./version").version,v("native-promise-only"),v("../build/plotcss");for(var g=v("./registry"),t=$.register=g.register,k=v("./plot_api"),x=Object.keys(k),e=0;e<x.length;e++){var r=x[e];"_"!==r.charAt(0)&&($[r]=k[r]),t({moduleType:"apiMethod",name:r,fn:k[r]})}t(v("./traces/scatter")),t([v("./components/legend"),v("./components/fx"),v("./components/annotations"),v("./components/annotations3d"),v("./components/selections"),v("./components/shapes"),v("./components/images"),v("./components/updatemenus"),v("./components/sliders"),v("./components/rangeslider"),v("./components/rangeselector"),v("./components/grid"),v("./components/errorbars"),v("./components/colorscale"),v("./components/colorbar"),v("./components/modebar")]),t([v("./locale-en"),v("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(t(window.PlotlyLocales),delete window.PlotlyLocales),$.Icons=v("./fonts/ploticon");var i=v("./components/fx"),c=v("./plots/plots");$.Plots={resize:c.resize,graphJson:c.graphJson,sendDataToCloud:c.sendDataToCloud},$.Fx={hover:i.hover,unhover:i.unhover,loneHover:i.loneHover,loneUnhover:i.loneUnhover},$.Snapshot=v("./snapshot"),$.PlotSchema=v("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(v,Q,$){"use strict";Q.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(v,Q,$){"use strict";$.isLeftAnchor=function(g){return"left"===g.xanchor||"auto"===g.xanchor&&g.x<=1/3},$.isCenterAnchor=function(g){return"center"===g.xanchor||"auto"===g.xanchor&&g.x>1/3&&g.x<2/3},$.isRightAnchor=function(g){return"right"===g.xanchor||"auto"===g.xanchor&&g.x>=2/3},$.isTopAnchor=function(g){return"top"===g.yanchor||"auto"===g.yanchor&&g.y>=2/3},$.isMiddleAnchor=function(g){return"middle"===g.yanchor||"auto"===g.yanchor&&g.y>1/3&&g.y<2/3},$.isBottomAnchor=function(g){return"bottom"===g.yanchor||"auto"===g.yanchor&&g.y<=1/3}},{}],496:[function(v,Q,$){"use strict";var g=v("./mod"),t=g.mod,k=g.modHalf,x=Math.PI,e=2*x;function r(m){return Math.abs(m[1]-m[0])>e-1e-14}function i(m,p){return k(p-m,e)}function c(m,p){if(r(p))return!0;var s,f;p[0]<p[1]?(s=p[0],f=p[1]):(s=p[1],f=p[0]),(s=t(s,e))>(f=t(f,e))&&(f+=e);var l=t(m,e),o=l+e;return l>=s&&l<=f||o>=s&&o<=f}function n(m,p,s,f,l,o,d){l=l||0,o=o||0;var u,a,y,h,_,b=r([s,f]);function w(P,z){return[P*Math.cos(z)+l,o-P*Math.sin(z)]}b?(u=0,a=x,y=e):s<f?(u=s,y=f):(u=f,y=s),m<p?(h=m,_=p):(h=p,_=m);var T,L=Math.abs(y-u)<=x?0:1;function M(P,z,S){return"A"+[P,P]+" "+[0,L,S]+" "+w(P,z)}return b?T=null===h?"M"+w(_,u)+M(_,a,0)+M(_,y,0)+"Z":"M"+w(h,u)+M(h,a,0)+M(h,y,0)+"ZM"+w(_,u)+M(_,a,1)+M(_,y,1)+"Z":null===h?(T="M"+w(_,u)+M(_,y,0),d&&(T+="L0,0Z")):T="M"+w(h,u)+"L"+w(_,u)+M(_,y,0)+"L"+w(h,y)+M(h,u,1)+"Z",T}Q.exports={deg2rad:function(m){return m/180*x},rad2deg:function(m){return m/x*180},angleDelta:i,angleDist:function(m,p){return Math.abs(i(m,p))},isFullCircle:r,isAngleInsideSector:c,isPtInsideSector:function(m,p,s,f){return!!c(p,f)&&(s[0]<s[1]?(l=s[0],o=s[1]):(l=s[1],o=s[0]),m>=l&&m<=o);var l,o},pathArc:function(m,p,s,f,l){return n(null,m,p,s,f,l,0)},pathSector:function(m,p,s,f,l){return n(null,m,p,s,f,l,1)},pathAnnulus:function(m,p,s,f,l,o){return n(m,p,s,f,l,o,1)}}},{"./mod":522}],497:[function(v,Q,$){"use strict";var g=Array.isArray,t=ArrayBuffer,k=DataView;function x(i){return t.isView(i)&&!(i instanceof k)}function e(i){return g(i)||x(i)}function r(i,c,n){if(e(i)){if(e(i[0])){for(var m=n,p=0;p<i.length;p++)m=c(m,i[p].length);return m}return i.length}return 0}$.isTypedArray=x,$.isArrayOrTypedArray=e,$.isArray1D=function(i){return!e(i[0])},$.ensureArray=function(i,c){return g(i)||(i=[]),i.length=c,i},$.concat=function(){var i,c,n,m,p,s,f,l,o=[],d=!0,u=0;for(n=0;n<arguments.length;n++)(s=(m=arguments[n]).length)&&(c?o.push(m):(c=m,p=s),g(m)?i=!1:(d=!1,u?i!==m.constructor&&(i=!1):i=m.constructor),u+=s);if(!u)return[];if(!o.length)return c;if(d)return c.concat.apply(c,o);if(i){for((f=new i(u)).set(c),n=0;n<o.length;n++)f.set(m=o[n],p),p+=m.length;return f}for(f=new Array(u),l=0;l<c.length;l++)f[l]=c[l];for(n=0;n<o.length;n++){for(m=o[n],l=0;l<m.length;l++)f[p+l]=m[l];p+=l}return f},$.maxRowLength=function(i){return r(i,Math.max,0)},$.minRowLength=function(i){return r(i,Math.min,1/0)}},{}],498:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../constants/numerical").BADNUM,k=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;Q.exports=function(x){return"string"==typeof x&&(x=x.replace(k,"")),g(x)?Number(x):t}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(v,Q,$){"use strict";Q.exports=function(g){var t=g._fullLayout;t._glcanvas&&t._glcanvas.size()&&t._glcanvas.each(function(k){k.regl&&k.regl.clear({color:!0,depth:!0})})}},{}],500:[function(v,Q,$){"use strict";Q.exports=function(g){g._responsiveChartHandler&&(window.removeEventListener("resize",g._responsiveChartHandler),delete g._responsiveChartHandler)}},{}],501:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("tinycolor2"),k=v("../plots/attributes"),x=v("../components/colorscale/scales"),e=v("../components/color"),r=v("../constants/interactions").DESELECTDIM,i=v("./nested_property"),c=v("./regex").counter,n=v("./mod").modHalf,m=v("./array").isArrayOrTypedArray;function p(s,f){var l=$.valObjectMeta[f.valType];if(f.arrayOk&&m(s))return!0;if(l.validateFunction)return l.validateFunction(s,f);var o={},d=o;return l.coerceFunction(s,{set:function(a){d=a}},o,f),d!==o}$.valObjectMeta={data_array:{coerceFunction:function(s,f,l){m(s)?f.set(s):void 0!==l&&f.set(l)}},enumerated:{coerceFunction:function(s,f,l,o){o.coerceNumber&&(s=+s),-1===o.values.indexOf(s)?f.set(l):f.set(s)},validateFunction:function(s,f){f.coerceNumber&&(s=+s);for(var l=f.values,o=0;o<l.length;o++){var d=String(l[o]);if("/"===d.charAt(0)&&"/"===d.charAt(d.length-1)){if(new RegExp(d.substr(1,d.length-2)).test(s))return!0}else if(s===l[o])return!0}return!1}},boolean:{coerceFunction:function(s,f,l){f.set(!0===s||!1===s?s:l)}},number:{coerceFunction:function(s,f,l,o){!g(s)||void 0!==o.min&&s<o.min||void 0!==o.max&&s>o.max?f.set(l):f.set(+s)}},integer:{coerceFunction:function(s,f,l,o){s%1||!g(s)||void 0!==o.min&&s<o.min||void 0!==o.max&&s>o.max?f.set(l):f.set(+s)}},string:{coerceFunction:function(s,f,l,o){f.set("string"!=typeof s?!0!==o.strict&&"number"==typeof s?String(s):l:o.noBlank&&!s?l:s)}},color:{coerceFunction:function(s,f,l){t(s).isValid()?f.set(s):f.set(l)}},colorlist:{coerceFunction:function(s,f,l){Array.isArray(s)&&s.length&&s.every(function(o){return t(o).isValid()})?f.set(s):f.set(l)}},colorscale:{coerceFunction:function(s,f,l){f.set(x.get(s,l))}},angle:{coerceFunction:function(s,f,l){"auto"===s?f.set("auto"):g(s)?f.set(n(+s,360)):f.set(l)}},subplotid:{coerceFunction:function(s,f,l,o){var d=o.regex||c(l);"string"==typeof s&&d.test(s)?f.set(s):f.set(l)},validateFunction:function(s,f){var l=f.dflt;return s===l||"string"==typeof s&&!!c(l).test(s)}},flaglist:{coerceFunction:function(s,f,l,o){if(-1===(o.extras||[]).indexOf(s))if("string"==typeof s){for(var d=s.split("+"),u=0;u<d.length;){var a=d[u];-1===o.flags.indexOf(a)||d.indexOf(a)<u?d.splice(u,1):u++}f.set(d.length?d.join("+"):l)}else f.set(l);else f.set(s)}},any:{coerceFunction:function(s,f,l){f.set(void 0===s?l:s)}},info_array:{coerceFunction:function(s,f,l,o){function d(C,R,D){var j;return void 0===D&&(D=R.dflt),$.valObjectMeta[R.valType].coerceFunction(C,{set:function(Z){j=Z}},D,R),j}var u=2===o.dimensions||"1-2"===o.dimensions&&Array.isArray(s)&&Array.isArray(s[0]);if(Array.isArray(s)){var a,y,h,b,w,T=o.items,L=[],M=Array.isArray(T),P=M&&u&&Array.isArray(T[0]),z=u&&M&&!P,S=M&&!z?T.length:s.length;if(l=Array.isArray(l)?l:[],u)for(a=0;a<S;a++)for(L[a]=[],h=Array.isArray(s[a])?s[a]:[],b=z?T.length:M?T[a].length:h.length,y=0;y<b;y++)void 0!==(w=d(h[y],z?T[y]:M?T[a][y]:T,(l[a]||[])[y]))&&(L[a][y]=w);else for(a=0;a<S;a++)void 0!==(w=d(s[a],M?T[a]:T,l[a]))&&(L[a]=w);f.set(L)}else f.set(l)},validateFunction:function(s,f){if(!Array.isArray(s))return!1;var l=f.items,o=Array.isArray(l),d=2===f.dimensions;if(!f.freeLength&&s.length!==l.length)return!1;for(var u=0;u<s.length;u++)if(d){if(!Array.isArray(s[u])||!f.freeLength&&s[u].length!==l[u].length)return!1;for(var a=0;a<s[u].length;a++)if(!p(s[u][a],o?l[u][a]:l))return!1}else if(!p(s[u],o?l[u]:l))return!1;return!0}}},$.coerce=function(s,f,l,o,d){var u=i(l,o).get(),a=i(s,o),y=i(f,o),h=a.get(),_=f._template;if(void 0===h&&_&&(h=i(_,o).get(),_=0),void 0===d&&(d=u.dflt),u.arrayOk&&m(h))return y.set(h),h;var b=$.valObjectMeta[u.valType].coerceFunction;b(h,y,d,u);var w=y.get();return _&&w===d&&!p(h,u)&&(b(h=i(_,o).get(),y,d,u),w=y.get()),w},$.coerce2=function(s,f,l,o,d){var u=i(s,o),a=$.coerce(s,f,l,o,d);return null!=u.get()&&a},$.coerceFont=function(s,f,l){var o={};return o.family=s(f+".family",(l=l||{}).family),o.size=s(f+".size",l.size),o.color=s(f+".color",l.color),o},$.coercePattern=function(s,f,l,o){if(s(f+".shape")){s(f+".solidity"),s(f+".size");var d="overlay"===s(f+".fillmode");if(!o){var u=s(f+".bgcolor",d?l:void 0);s(f+".fgcolor",d?e.contrast(u):l)}s(f+".fgopacity",d?.5:1)}},$.coerceHoverinfo=function(s,f,l){var o,d=f._module.attributes,u=d.hoverinfo?d:k,a=u.hoverinfo;if(1===l._dataLength){var y="all"===a.dflt?a.flags.slice():a.dflt.split("+");y.splice(y.indexOf("name"),1),o=y.join("+")}return $.coerce(s,f,u,"hoverinfo",o)},$.coerceSelectionMarkerOpacity=function(s,f){if(s.marker){var l,o,d=s.marker.opacity;void 0!==d&&(m(d)||s.selected||s.unselected||(l=d,o=r*d),f("selected.marker.opacity",l),f("unselected.marker.opacity",o))}},$.validate=p},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(v,Q,$){"use strict";var g,t,k=v("d3-time-format").timeFormat,x=v("fast-isnumeric"),e=v("./loggers"),r=v("./mod").mod,i=v("../constants/numerical"),c=i.BADNUM,n=i.ONEDAY,m=i.ONEHOUR,p=i.ONEMIN,s=i.ONESEC,f=i.EPOCHJD,l=v("../registry"),o=v("d3-time-format").utcFormat,d=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,u=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,a=(new Date).getFullYear()-70;function y(R){return R&&l.componentsRegistry.calendars&&"string"==typeof R&&"gregorian"!==R}function h(R,D){return String(R+Math.pow(10,D)).substr(1)}$.dateTick0=function(R,D){var Z,W,j=(W=!!D,y(Z=R)?W?l.getComponentMethod("calendars","CANONICAL_SUNDAY")[Z]:l.getComponentMethod("calendars","CANONICAL_TICK")[Z]:W?"2000-01-02":"2000-01-01");if(D<2)return j;var q=$.dateTime2ms(j,R);return $.ms2DateTime(q+=n*(D-1),0,R)},$.dfltRange=function(R){return y(R)?l.getComponentMethod("calendars","DFLTRANGE")[R]:["2000-01-01","2001-01-01"]},$.isJSDate=function(R){return"object"==typeof R&&null!==R&&"function"==typeof R.getTime},$.dateTime2ms=function(R,D){if($.isJSDate(R)){var j=R.getTimezoneOffset()*p,q=(R.getUTCMinutes()-R.getMinutes())*p+(R.getUTCSeconds()-R.getSeconds())*s+(R.getUTCMilliseconds()-R.getMilliseconds());if(q){var Z=3*p;j=j-Z/2+r(q-j+Z/2,Z)}return(R=Number(R)-j)>=g&&R<=t?R:c}if("string"!=typeof R&&"number"!=typeof R)return c;R=String(R);var W=y(D),G=R.charAt(0);!W||"G"!==G&&"g"!==G||(R=R.substr(1),D="");var X=W&&"chinese"===D.substr(0,7),ne=R.match(X?u:d);if(!ne)return c;var V=ne[1],N=ne[3]||"1",U=Number(ne[5]||1),ee=Number(ne[7]||0),B=Number(ne[9]||0),K=Number(ne[11]||0);if(W){if(2===V.length)return c;var J;V=Number(V);try{var te=l.getComponentMethod("calendars","getCal")(D);if(X){var ae="i"===N.charAt(N.length-1);N=parseInt(N,10),J=te.newDate(V,te.toMonthIndex(V,N,ae),U)}else J=te.newDate(V,Number(N),U)}catch(oe){return c}return J?(J.toJD()-f)*n+ee*m+B*p+K*s:c}V=2===V.length?(Number(V)+2e3-a)%100+a:Number(V),N-=1;var ce=new Date(Date.UTC(2e3,N,U,ee,B));return ce.setUTCFullYear(V),ce.getUTCMonth()!==N||ce.getUTCDate()!==U?c:ce.getTime()+K*s},g=$.MIN_MS=$.dateTime2ms("-9999"),t=$.MAX_MS=$.dateTime2ms("9999-12-31 23:59:59.9999"),$.isDateTime=function(R,D){return $.dateTime2ms(R,D)!==c};var _=90*n,b=3*m,w=5*p;function T(R,D,j,q,Z){if((D||j||q||Z)&&(R+=" "+h(D,2)+":"+h(j,2),(q||Z)&&(R+=":"+h(q,2),Z))){for(var W=4;Z%10==0;)W-=1,Z/=10;R+="."+h(Z,W)}return R}$.ms2DateTime=function(R,D,j){if("number"!=typeof R||!(R>=g&&R<=t))return c;D||(D=0);var q,Z,W,G,X,ne,V=Math.floor(10*r(R+.05,1)),N=Math.round(R-V/10);if(y(j)){var U=Math.floor(N/n)+f,ee=Math.floor(r(R,n));try{q=l.getComponentMethod("calendars","getCal")(j).fromJD(U).formatDate("yyyy-mm-dd")}catch(B){q=o("G%Y-%m-%d")(new Date(N))}if("-"===q.charAt(0))for(;q.length<11;)q="-0"+q.substr(1);else for(;q.length<10;)q="0"+q;Z=D<_?Math.floor(ee/m):0,W=D<_?Math.floor(ee%m/p):0,G=D<b?Math.floor(ee%p/s):0,X=D<w?ee%s*10+V:0}else ne=new Date(N),q=o("%Y-%m-%d")(ne),Z=D<_?ne.getUTCHours():0,W=D<_?ne.getUTCMinutes():0,G=D<b?ne.getUTCSeconds():0,X=D<w?10*ne.getUTCMilliseconds()+V:0;return T(q,Z,W,G,X)},$.ms2DateTimeLocal=function(R){if(!(R>=g+n&&R<=t-n))return c;var D=Math.floor(10*r(R+.05,1)),j=new Date(Math.round(R-D/10));return T(k("%Y-%m-%d")(j),j.getHours(),j.getMinutes(),j.getSeconds(),10*j.getUTCMilliseconds()+D)},$.cleanDate=function(R,D,j){if(R===c)return D;if($.isJSDate(R)||"number"==typeof R&&isFinite(R)){if(y(j))return e.error("JS Dates and milliseconds are incompatible with world calendars",R),D;if(!(R=$.ms2DateTimeLocal(+R))&&void 0!==D)return D}else if(!$.isDateTime(R,j))return e.error("unrecognized date",R),D;return R};var L=/%\d?f/g,M=/%h/g,P={1:"1",2:"1",3:"2",4:"2"};function z(R,D,j,q){R=R.replace(L,function(W){var G=Math.min(+W.charAt(1)||6,6);return(D/1e3%1+2).toFixed(G).substr(2).replace(/0+$/,"")||"0"});var Z=new Date(Math.floor(D+.05));if(R=R.replace(M,function(){return P[j("%q")(Z)]}),y(q))try{R=l.getComponentMethod("calendars","worldCalFmt")(R,D,q)}catch(W){return"Invalid"}return j(R)(Z)}var S=[59,59.9,59.99,59.999,59.9999];$.formatDate=function(R,D,j,q,Z,W){if(Z=y(Z)&&Z,!D)if("y"===j)D=W.year;else if("m"===j)D=W.month;else{if("d"!==j)return function(G,X){var ne=r(G+.05,n),V=h(Math.floor(ne/m),2)+":"+h(r(Math.floor(ne/p),60),2);if("M"!==X){x(X)||(X=0);var N=(100+Math.min(r(G/s,60),S[X])).toFixed(X).substr(1);X>0&&(N=N.replace(/0+$/,"").replace(/[\.]$/,"")),V+=":"+N}return V}(R,j)+"\n"+z(W.dayMonthYear,R,q,Z);D=W.dayMonth+"\n"+W.year}return z(D,R,q,Z)};var C=3*n;$.incrementMonth=function(R,D,j){j=y(j)&&j;var q=r(R,n);if(R=Math.round(R-q),j)try{var Z=Math.round(R/n)+f,W=l.getComponentMethod("calendars","getCal")(j),G=W.fromJD(Z);return D%12?W.add(G,D,"m"):W.add(G,D/12,"y"),(G.toJD()-f)*n+q}catch(ne){e.error("invalid ms "+R+" in calendar "+j)}var X=new Date(R+C);return X.setUTCMonth(X.getUTCMonth()+D)+q-C},$.findExactDates=function(R,D){for(var j,q,Z=0,W=0,G=0,X=0,ne=y(D)&&l.getComponentMethod("calendars","getCal")(D),V=0;V<R.length;V++)if(x(q=R[V])){if(!(q%n))if(ne)try{1===(j=ne.fromJD(q/n+f)).day()?1===j.month()?Z++:W++:G++}catch(U){}else 1===(j=new Date(q)).getUTCDate()?0===j.getUTCMonth()?Z++:W++:G++}else X++;G+=W+=Z;var N=R.length-X;return{exactYears:Z/N,exactMonths:W/N,exactDays:G/N}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("./loggers"),k=v("./matrix"),x=v("gl-mat4");function e(m){var p=m&&m.parentNode;p&&p.removeChild(m)}function r(m,p,s){var f="plotly.js-style-"+m,l=document.getElementById(f);l||((l=document.createElement("style")).setAttribute("id",f),l.appendChild(document.createTextNode("")),document.head.appendChild(l));var o=l.sheet;o.insertRule?o.insertRule(p+"{"+s+"}",0):o.addRule?o.addRule(p,s,0):t.warn("addStyleRule failed")}function i(m){var p=window.getComputedStyle(m,null),s=p.getPropertyValue("-webkit-transform")||p.getPropertyValue("-moz-transform")||p.getPropertyValue("-ms-transform")||p.getPropertyValue("-o-transform")||p.getPropertyValue("transform");return"none"===s?null:s.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(f){return+f})}function c(m){for(var p=[];n(m);)p.push(m),m=m.parentNode;return p}function n(m){return m&&(m instanceof Element||m instanceof HTMLElement)}Q.exports={getGraphDiv:function(m){var p;if("string"==typeof m){if(null===(p=document.getElementById(m)))throw new Error("No DOM element with id '"+m+"' exists on the page.");return p}if(null==m)throw new Error("DOM element provided is null or undefined");return m},isPlotDiv:function(m){var p=g.select(m);return p.node()instanceof HTMLElement&&p.size()&&p.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(m,p){r("global",m,p)},addRelatedStyleRule:r,deleteRelatedStyleRule:function(m){var s=document.getElementById("plotly.js-style-"+m);s&&e(s)},getFullTransformMatrix:function(m){var p=c(m),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return p.forEach(function(f){var l=i(f);if(l){var o=k.convertCssMatrix(l);s=x.multiply(s,s,o)}}),s},getElementTransformMatrix:i,getElementAndAncestors:c,equalDomRects:function(m,p){return m&&p&&m.x===p.x&&m.y===p.y&&m.top===p.top&&m.left===p.left&&m.right===p.right&&m.bottom===p.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(v,Q,$){"use strict";var g=v("events").EventEmitter;Q.exports={init:function(k){if(k._ev instanceof g)return k;var x=new g,e=new g;return k._ev=x,k._internalEv=e,k.on=x.on.bind(x),k.once=x.once.bind(x),k.removeListener=x.removeListener.bind(x),k.removeAllListeners=x.removeAllListeners.bind(x),k._internalOn=e.on.bind(e),k._internalOnce=e.once.bind(e),k._removeInternalListener=e.removeListener.bind(e),k._removeAllInternalListeners=e.removeAllListeners.bind(e),k.emit=function(r,i){"undefined"!=typeof jQuery&&jQuery(k).trigger(r,i),x.emit(r,i),e.emit(r,i)},k},triggerHandler:function(k,x,e){var r,i;"undefined"!=typeof jQuery&&(r=jQuery(k).triggerHandler(x,e));var c=k._ev;if(!c)return r;var n,m=c._events[x];if(!m)return r;function p(s){return s.listener?(c.removeListener(x,s.listener),s.fired?void 0:(s.fired=!0,s.listener.apply(c,[e]))):s.apply(c,[e])}for(m=Array.isArray(m)?m:[m],n=0;n<m.length-1;n++)p(m[n]);return i=p(m[n]),void 0!==r?r:i},purge:function(k){return delete k._ev,delete k.on,delete k.once,delete k.removeListener,delete k.removeAllListeners,delete k.emit,delete k._ev,delete k._internalEv,delete k._internalOn,delete k._internalOnce,delete k._removeInternalListener,delete k._removeAllInternalListeners,k}}},{events:84}],505:[function(v,Q,$){"use strict";var g=v("./is_plain_object.js"),t=Array.isArray;function k(x,e,r,i){var c,n,m,p,s,f,l=x[0],o=x.length;if(2===o&&t(l)&&t(x[1])&&0===l.length){if(function(u,a){var y,h;for(y=0;y<u.length;y++){if(null!==(h=u[y])&&"object"==typeof h)return!1;void 0!==h&&(a[y]=h)}return!0}(x[1],l))return l;l.splice(0,l.length)}for(var d=1;d<o;d++)for(n in c=x[d])m=l[n],p=c[n],i&&t(p)?l[n]=p:e&&p&&(g(p)||(s=t(p)))?(s?(s=!1,f=m&&t(m)?m:[]):f=m&&g(m)?m:{},l[n]=k([f,p],e,r,i)):(void 0!==p||r)&&(l[n]=p);return l}$.extendFlat=function(){return k(arguments,!1,!1,!1)},$.extendDeep=function(){return k(arguments,!0,!1,!1)},$.extendDeepAll=function(){return k(arguments,!0,!0,!1)},$.extendDeepNoArrays=function(){return k(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(v,Q,$){"use strict";Q.exports=function(g){for(var t={},k=[],x=0,e=0;e<g.length;e++){var r=g[e];1!==t[r]&&(t[r]=1,k[x++]=r)}return k}},{}],507:[function(v,Q,$){"use strict";function g(k){return!0===k.visible}function t(k){var x=k[0].trace;return!0===x.visible&&0!==x._length}Q.exports=function(k){for(var x,e=(x=k,Array.isArray(x)&&Array.isArray(x[0])&&x[0][0]&&x[0][0].trace?t:g),r=[],i=0;i<k.length;i++){var c=k[i];e(c)&&r.push(c)}return r}},{}],508:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("country-regex"),k=v("@turf/area"),x=v("@turf/centroid"),e=v("@turf/bbox"),r=v("./identity"),i=v("./loggers"),c=v("./is_plain_object"),n=v("./nested_property"),m=v("./polygon"),p=Object.keys(t),s={"ISO-3":r,"USA-states":r,"country names":function(l){for(var o=0;o<p.length;o++){var d=p[o];if(new RegExp(t[d]).test(l.trim().toLowerCase()))return d}return i.log("Unrecognized country name: "+l+"."),!1}};function f(l){var o=l.geojson,d=window.PlotlyGeoAssets||{},u="string"==typeof o?d[o]:o;return c(u)?u:(i.error("Oops ... something went wrong when fetching "+o),!1)}Q.exports={locationToFeature:function(l,o,d){if(!o||"string"!=typeof o)return!1;var u,a,y,h=s[l](o);if(h){if("USA-states"===l)for(u=[],y=0;y<d.length;y++)(a=d[y]).properties&&a.properties.gu&&"USA"===a.properties.gu&&u.push(a);else u=d;for(y=0;y<u.length;y++)if((a=u[y]).id===h)return a;i.log(["Location with id",h,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(l){var o,d,u,a,y=l.geometry,h=y.coordinates,_=l.id,b=[];function w(T){for(var L=0;L<T.length-1;L++)if(T[L][0]>0&&T[L+1][0]<0)return L;return null}switch(o="RUS"===_||"FJI"===_?function(T){var L;if(null===w(T))L=T;else for(L=new Array(T.length),a=0;a<T.length;a++)L[a]=[T[a][0]<0?T[a][0]+360:T[a][0],T[a][1]];b.push(m.tester(L))}:"ATA"===_?function(T){var L=w(T);if(null===L)return b.push(m.tester(T));var M=new Array(T.length+1),P=0;for(a=0;a<T.length;a++)a>L?M[P++]=[T[a][0]+360,T[a][1]]:a===L?(M[P++]=T[a],M[P++]=[T[a][0],-90]):M[P++]=T[a];var z=m.tester(M);z.pts.pop(),b.push(z)}:function(T){b.push(m.tester(T))},y.type){case"MultiPolygon":for(d=0;d<h.length;d++)for(u=0;u<h[d].length;u++)o(h[d][u]);break;case"Polygon":for(d=0;d<h.length;d++)o(h[d])}return b},getTraceGeojson:f,extractTraceFeature:function(l){var o=l[0].trace,d=f(o);if(!d)return!1;var u,a={},y=[];for(u=0;u<o._length;u++){var h=l[u];(h.loc||0===h.loc)&&(a[h.loc]=h)}function _(T){var L=n(T,o.featureidkey||"id").get(),M=a[L];if(M){var P=T.geometry;if("Polygon"===P.type||"MultiPolygon"===P.type){var z={type:"Feature",id:L,geometry:P,properties:{}};z.properties.ct=function(S){var C,R=S.geometry;if("MultiPolygon"===R.type)for(var D=R.coordinates,j=0,q=0;q<D.length;q++){var Z={type:"Polygon",coordinates:D[q]},W=k.default(Z);W>j&&(j=W,C=Z)}else C=R;return x.default(C).geometry.coordinates}(z),M.fIn=T,M.fOut=z,y.push(z)}else i.log(["Location",M.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete a[L]}switch(d.type){case"FeatureCollection":var b=d.features;for(u=0;u<b.length;u++)_(b[u]);break;case"Feature":_(d);break;default:return i.warn(["Invalid GeoJSON type",(d.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var w in a)i.log(["Location *"+w+"*","does not have a matching feature with id-key","*"+o.featureidkey+"*."].join(" "));return y},fetchTraceGeoData:function(l){var o=window.PlotlyGeoAssets||{},d=[];function u(_){return new Promise(function(b,w){g.json(_,function(T,L){return T?(delete o[_],w(new Error(404===T.status?'GeoJSON at URL "'+_+'" does not exist.':"Unexpected error while fetching from "+_))):(o[_]=L,b(L))})})}function a(_){return new Promise(function(b,w){var T=0,L=setInterval(function(){return o[_]&&"pending"!==o[_]?(clearInterval(L),b(o[_])):T>100?(clearInterval(L),w("Unexpected error while fetching from "+_)):void T++},50)})}for(var y=0;y<l.length;y++){var h=l[y][0].trace.geojson;"string"==typeof h&&(o[h]?"pending"===o[h]&&d.push(a(h)):(o[h]="pending",d.push(u(h))))}return d},computeBbox:function(l){return e.default(l)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(v,Q,$){"use strict";var g=v("../constants/numerical").BADNUM;$.calcTraceToLineCoords=function(t){for(var k=t[0].trace.connectgaps,x=[],e=[],r=0;r<t.length;r++){var i=t[r].lonlat;i[0]!==g?e.push(i):!k&&e.length>0&&(x.push(e),e=[])}return e.length>0&&x.push(e),x},$.makeLine=function(t){return 1===t.length?{type:"LineString",coordinates:t[0]}:{type:"MultiLineString",coordinates:t}},$.makePolygon=function(t){if(1===t.length)return{type:"Polygon",coordinates:t};for(var k=new Array(t.length),x=0;x<t.length;x++)k[x]=[t[x]];return{type:"MultiPolygon",coordinates:k}},$.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(v,Q,$){"use strict";var g,t,k,x=v("./mod").mod;function e(i,c,n,m,p,s,f,l){var o=n-i,d=p-i,u=f-p,a=m-c,y=s-c,h=l-s,_=o*h-u*a;if(0===_)return null;var b=(d*h-u*y)/_,w=(d*a-o*y)/_;return w<0||w>1||b<0||b>1?null:{x:i+o*b,y:c+a*b}}function r(i,c,n,m,p){var s=m*i+p*c;if(s<0)return m*m+p*p;if(s>n){var f=m-i,l=p-c;return f*f+l*l}var o=m*c-p*i;return o*o/n}$.segmentsIntersect=e,$.segmentDistance=function(i,c,n,m,p,s,f,l){if(e(i,c,n,m,p,s,f,l))return 0;var o=n-i,d=m-c,u=f-p,a=l-s,y=o*o+d*d,h=u*u+a*a,_=Math.min(r(o,d,y,p-i,s-c),r(o,d,y,f-i,l-c),r(u,a,h,i-p,c-s),r(u,a,h,n-p,m-s));return Math.sqrt(_)},$.getTextLocation=function(i,c,n,m){if(i===t&&m===k||(g={},t=i,k=m),g[n])return g[n];var p=i.getPointAtLength(x(n-m/2,c)),s=i.getPointAtLength(x(n+m/2,c)),f=Math.atan((s.y-p.y)/(s.x-p.x)),l=i.getPointAtLength(x(n,c)),o={x:(4*l.x+p.x+s.x)/6,y:(4*l.y+p.y+s.y)/6,theta:f};return g[n]=o,o},$.clearLocationCache=function(){t=null},$.getVisibleSegment=function(i,c,n){var m,p,s=c.left,f=c.right,l=c.top,o=c.bottom,d=0,u=i.getTotalLength(),a=u;function y(_){var b=i.getPointAtLength(_);0===_?m=b:_===u&&(p=b);var w=b.x<s?s-b.x:b.x>f?b.x-f:0,T=b.y<l?l-b.y:b.y>o?b.y-o:0;return Math.sqrt(w*w+T*T)}for(var h=y(d);h;){if((d+=h+n)>a)return;h=y(d)}for(h=y(a);h;){if(d>(a-=h+n))return;h=y(a)}return{min:d,max:a,len:a-d,total:u,isClosed:0===d&&a===u&&Math.abs(m.x-p.x)<.1&&Math.abs(m.y-p.y)<.1}},$.findPointOnPath=function(i,c,n,m){for(var p,s,f,l=(m=m||{}).pathLength||i.getTotalLength(),o=m.tolerance||.001,d=m.iterationLimit||30,u=i.getPointAtLength(0)[n]>i.getPointAtLength(l)[n]?-1:1,a=0,y=0,h=l;a<d;){if(f=(s=i.getPointAtLength(p=(y+h)/2))[n]-c,Math.abs(f)<o)return s;u*f>0?h=p:y=p,a++}return s}},{"./mod":522}],511:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("tinycolor2"),k=v("color-normalize"),x=v("../components/colorscale"),e=v("../components/color/attributes").defaultLine,r=v("./array").isArrayOrTypedArray,i=k(e);function c(p,s){var f=p;return f[3]*=s,f}function n(p){if(g(p))return i;var s=k(p);return s.length?s:i}function m(p){return g(p)?p:1}Q.exports={formatColor:function(p,s,f){var l,o,d,u,a,y=p.color,h=r(y),_=r(s),b=x.extractOpts(p),w=[];if(l=void 0!==b.colorscale?x.makeColorScaleFuncFromTrace(p):n,o=h?function(L,M){return void 0===L[M]?i:k(l(L[M]))}:n,d=_?function(L,M){return void 0===L[M]?1:m(L[M])}:m,h||_)for(var T=0;T<f;T++)u=o(y,T),a=d(s,T),w[T]=c(u,a);else w=c(k(y),s);return w},parseColorScale:function(p){var s=x.extractOpts(p),f=s.colorscale;return s.reversescale&&(f=x.flipScale(s.colorscale)),f.map(function(l){var o=l[0],d=t(l[1]).toRgb();return{index:o,rgb:[d.r,d.g,d.b,d.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(v,Q,$){"use strict";var g=v("./identity");function t(k){return[k]}Q.exports={keyFun:function(k){return k.key},repeat:t,descend:g,wrap:t,unwrap:function(k){return k[0]}}},{"./identity":513}],513:[function(v,Q,$){"use strict";Q.exports=function(g){return g}},{}],514:[function(v,Q,$){"use strict";Q.exports=function(g,t){if(!t)return g;var k=1/Math.abs(t),x=k>1?(k*g+k*t)/k:g+t,e=String(x).length;if(e>16){var r=String(t).length;if(e>=String(g).length+r){var i=parseFloat(x).toPrecision(12);-1===i.indexOf("e+")&&(x=+i)}}return x}},{}],515:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-time-format").utcFormat,k=v("d3-format").format,x=v("fast-isnumeric"),e=v("../constants/numerical"),r=e.FP_SAFE,i=-r,c=e.BADNUM,n=Q.exports={};n.adjustFormat=function(V){return!V||/^\d[.]\df/.test(V)||/[.]\d%/.test(V)?V:"0.f"===V?"~f":/^\d%/.test(V)?"~%":/^\ds/.test(V)?"~s":!/^[~,.0$]/.test(V)&&/[&fps]/.test(V)?"~"+V:V};var m={};n.warnBadFormat=function(V){var N=String(V);m[N]||(m[N]=1,n.warn('encountered bad format: "'+N+'"'))},n.noFormat=function(V){return String(V)},n.numberFormat=function(V){var N;try{N=k(n.adjustFormat(V))}catch(U){return n.warnBadFormat(V),n.noFormat}return N},n.nestedProperty=v("./nested_property"),n.keyedContainer=v("./keyed_container"),n.relativeAttr=v("./relative_attr"),n.isPlainObject=v("./is_plain_object"),n.toLogRange=v("./to_log_range"),n.relinkPrivateKeys=v("./relink_private");var p=v("./array");n.isTypedArray=p.isTypedArray,n.isArrayOrTypedArray=p.isArrayOrTypedArray,n.isArray1D=p.isArray1D,n.ensureArray=p.ensureArray,n.concat=p.concat,n.maxRowLength=p.maxRowLength,n.minRowLength=p.minRowLength;var s=v("./mod");n.mod=s.mod,n.modHalf=s.modHalf;var f=v("./coerce");n.valObjectMeta=f.valObjectMeta,n.coerce=f.coerce,n.coerce2=f.coerce2,n.coerceFont=f.coerceFont,n.coercePattern=f.coercePattern,n.coerceHoverinfo=f.coerceHoverinfo,n.coerceSelectionMarkerOpacity=f.coerceSelectionMarkerOpacity,n.validate=f.validate;var l=v("./dates");n.dateTime2ms=l.dateTime2ms,n.isDateTime=l.isDateTime,n.ms2DateTime=l.ms2DateTime,n.ms2DateTimeLocal=l.ms2DateTimeLocal,n.cleanDate=l.cleanDate,n.isJSDate=l.isJSDate,n.formatDate=l.formatDate,n.incrementMonth=l.incrementMonth,n.dateTick0=l.dateTick0,n.dfltRange=l.dfltRange,n.findExactDates=l.findExactDates,n.MIN_MS=l.MIN_MS,n.MAX_MS=l.MAX_MS;var o=v("./search");n.findBin=o.findBin,n.sorterAsc=o.sorterAsc,n.sorterDes=o.sorterDes,n.distinctVals=o.distinctVals,n.roundUp=o.roundUp,n.sort=o.sort,n.findIndexOfMin=o.findIndexOfMin,n.sortObjectKeys=v("./sort_object_keys");var d=v("./stats");n.aggNums=d.aggNums,n.len=d.len,n.mean=d.mean,n.median=d.median,n.midRange=d.midRange,n.variance=d.variance,n.stdev=d.stdev,n.interp=d.interp;var u=v("./matrix");n.init2dArray=u.init2dArray,n.transposeRagged=u.transposeRagged,n.dot=u.dot,n.translationMatrix=u.translationMatrix,n.rotationMatrix=u.rotationMatrix,n.rotationXYMatrix=u.rotationXYMatrix,n.apply3DTransform=u.apply3DTransform,n.apply2DTransform=u.apply2DTransform,n.apply2DTransform2=u.apply2DTransform2,n.convertCssMatrix=u.convertCssMatrix,n.inverseTransformMatrix=u.inverseTransformMatrix;var a=v("./angles");n.deg2rad=a.deg2rad,n.rad2deg=a.rad2deg,n.angleDelta=a.angleDelta,n.angleDist=a.angleDist,n.isFullCircle=a.isFullCircle,n.isAngleInsideSector=a.isAngleInsideSector,n.isPtInsideSector=a.isPtInsideSector,n.pathArc=a.pathArc,n.pathSector=a.pathSector,n.pathAnnulus=a.pathAnnulus;var y=v("./anchor_utils");n.isLeftAnchor=y.isLeftAnchor,n.isCenterAnchor=y.isCenterAnchor,n.isRightAnchor=y.isRightAnchor,n.isTopAnchor=y.isTopAnchor,n.isMiddleAnchor=y.isMiddleAnchor,n.isBottomAnchor=y.isBottomAnchor;var h=v("./geometry2d");n.segmentsIntersect=h.segmentsIntersect,n.segmentDistance=h.segmentDistance,n.getTextLocation=h.getTextLocation,n.clearLocationCache=h.clearLocationCache,n.getVisibleSegment=h.getVisibleSegment,n.findPointOnPath=h.findPointOnPath;var _=v("./extend");n.extendFlat=_.extendFlat,n.extendDeep=_.extendDeep,n.extendDeepAll=_.extendDeepAll,n.extendDeepNoArrays=_.extendDeepNoArrays;var b=v("./loggers");n.log=b.log,n.warn=b.warn,n.error=b.error;var w=v("./regex");n.counterRegex=w.counter;var T=v("./throttle");n.throttle=T.throttle,n.throttleDone=T.done,n.clearThrottle=T.clear;var L=v("./dom");function M(V){var N={};for(var U in V)for(var ee=V[U],B=0;B<ee.length;B++)N[ee[B]]=+U;return N}n.getGraphDiv=L.getGraphDiv,n.isPlotDiv=L.isPlotDiv,n.removeElement=L.removeElement,n.addStyleRule=L.addStyleRule,n.addRelatedStyleRule=L.addRelatedStyleRule,n.deleteRelatedStyleRule=L.deleteRelatedStyleRule,n.getFullTransformMatrix=L.getFullTransformMatrix,n.getElementTransformMatrix=L.getElementTransformMatrix,n.getElementAndAncestors=L.getElementAndAncestors,n.equalDomRects=L.equalDomRects,n.clearResponsive=v("./clear_responsive"),n.preserveDrawingBuffer=v("./preserve_drawing_buffer"),n.makeTraceGroups=v("./make_trace_groups"),n._=v("./localize"),n.notifier=v("./notifier"),n.filterUnique=v("./filter_unique"),n.filterVisible=v("./filter_visible"),n.pushUnique=v("./push_unique"),n.increment=v("./increment"),n.cleanNumber=v("./clean_number"),n.ensureNumber=function(V){return x(V)?(V=Number(V))>r||V<i?c:V:c},n.isIndex=function(V,N){return!(void 0!==N&&V>=N)&&x(V)&&V>=0&&V%1==0},n.noop=v("./noop"),n.identity=v("./identity"),n.repeat=function(V,N){for(var U=new Array(N),ee=0;ee<N;ee++)U[ee]=V;return U},n.swapAttrs=function(V,N,U,ee){U||(U="x"),ee||(ee="y");for(var B=0;B<N.length;B++){var K=N[B],J=n.nestedProperty(V,K.replace("?",U)),te=n.nestedProperty(V,K.replace("?",ee)),ae=J.get();J.set(te.get()),te.set(ae)}},n.raiseToTop=function(V){V.parentNode.appendChild(V)},n.cancelTransition=function(V){return V.transition().duration(0)},n.constrain=function(V,N,U){return N>U?Math.max(U,Math.min(N,V)):Math.max(N,Math.min(U,V))},n.bBoxIntersect=function(V,N,U){return V.left<=N.right+(U=U||0)&&N.left<=V.right+U&&V.top<=N.bottom+U&&N.top<=V.bottom+U},n.simpleMap=function(V,N,U,ee,B){for(var K=V.length,J=new Array(K),te=0;te<K;te++)J[te]=N(V[te],U,ee,B);return J},n.randstr=function V(N,U,ee,B){if(ee||(ee=16),void 0===U&&(U=24),U<=0)return"0";var K,J,te=Math.log(Math.pow(2,U))/Math.log(ee),ae="";for(K=2;te===1/0;K*=2)te=Math.log(Math.pow(2,U/K))/Math.log(ee)*K;var ce=te-Math.floor(te);for(K=0;K<Math.floor(te);K++)ae=Math.floor(Math.random()*ee).toString(ee)+ae;ce&&(J=Math.pow(ee,ce),ae=Math.floor(Math.random()*J).toString(ee)+ae);var oe=parseInt(ae,ee);return N&&N[ae]||oe!==1/0&&oe>=Math.pow(2,U)?B>10?(n.warn("randstr failed uniqueness"),ae):V(N,U,ee,(B||0)+1):ae},n.OptionControl=function(V,N){V||(V={}),N||(N="opt");var U={optionList:[],_newoption:function(ee){ee[N]=V,U[ee.name]=ee,U.optionList.push(ee)}};return U["_"+N]=V,U},n.smooth=function(V,N){if((N=Math.round(N)||0)<2)return V;var U,ee,B,K,J=V.length,te=2*J,ae=2*N-1,ce=new Array(ae),oe=new Array(J);for(U=0;U<ae;U++)ce[U]=(1-Math.cos(Math.PI*(U+1)/N))/(2*N);for(U=0;U<J;U++){for(K=0,ee=0;ee<ae;ee++)(B=U+ee+1-N)<-J?B-=te*Math.round(B/te):B>=te&&(B-=te*Math.floor(B/te)),B<0?B=-1-B:B>=J&&(B=te-1-B),K+=V[B]*ce[ee];oe[U]=K}return oe},n.syncOrAsync=function(V,N,U){var ee;function B(){return n.syncOrAsync(V,N,U)}for(;V.length;)if((ee=(0,V.splice(0,1)[0])(N))&&ee.then)return ee.then(B);return U&&U(N)},n.stripTrailingSlash=function(V){return"/"===V.substr(-1)?V.substr(0,V.length-1):V},n.noneOrAll=function(V,N,U){if(V){var ee,B=!1,K=!0;for(ee=0;ee<U.length;ee++)null!=V[U[ee]]?B=!0:K=!1;if(B&&!K)for(ee=0;ee<U.length;ee++)V[U[ee]]=N[U[ee]]}},n.mergeArray=function(V,N,U,ee){var B="function"==typeof ee;if(n.isArrayOrTypedArray(V))for(var K=Math.min(V.length,N.length),J=0;J<K;J++){var te=V[J];N[J][U]=B?ee(te):te}},n.mergeArrayCastPositive=function(V,N,U){return n.mergeArray(V,N,U,function(ee){var B=+ee;return isFinite(B)&&B>0?B:0})},n.fillArray=function(V,N,U,ee){if(ee=ee||n.identity,n.isArrayOrTypedArray(V))for(var B=0;B<N.length;B++)N[B][U]=ee(V[B])},n.castOption=function(V,N,U,ee){ee=ee||n.identity;var B=n.nestedProperty(V,U).get();return n.isArrayOrTypedArray(B)?Array.isArray(N)&&n.isArrayOrTypedArray(B[N[0]])?ee(B[N[0]][N[1]]):ee(B[N]):B},n.extractOption=function(V,N,U,ee){if(U in V)return V[U];var B=n.nestedProperty(N,ee).get();return Array.isArray(B)?void 0:B},n.tagSelected=function(V,N,U){var ee,B,K=N.selectedpoints,J=N._indexToPoints;J&&(ee=M(J));for(var te=0;te<K.length;te++){var ae=K[te];if(n.isIndex(ae)||n.isArrayOrTypedArray(ae)&&n.isIndex(ae[0])&&n.isIndex(ae[1])){var ce=ee?ee[ae]:ae,oe=U?U[ce]:ce;void 0!==(B=oe)&&B<V.length&&(V[oe].selected=1)}}},n.selIndices2selPoints=function(V){var N=V.selectedpoints,U=V._indexToPoints;if(U){for(var ee=M(U),B=[],K=0;K<N.length;K++){var J=N[K];if(n.isIndex(J)){var te=ee[J];n.isIndex(te)&&B.push(te)}}return B}return N},n.getTargetArray=function(V,N){var U=N.target;if("string"==typeof U&&U){var ee=n.nestedProperty(V,U).get();return!!Array.isArray(ee)&&ee}return!!Array.isArray(U)&&U},n.minExtend=function(V,N){var U={};"object"!=typeof N&&(N={});var ee,B,K,J=Object.keys(V);for(ee=0;ee<J.length;ee++)K=V[B=J[ee]],"_"!==B.charAt(0)&&"function"!=typeof K&&(U[B]="module"===B?K:Array.isArray(K)?"colorscale"===B?K.slice():K.slice(0,3):n.isTypedArray(K)?K.subarray(0,3):K&&"object"==typeof K?n.minExtend(V[B],N[B]):K);for(J=Object.keys(N),ee=0;ee<J.length;ee++)"object"==typeof(K=N[B=J[ee]])&&B in U&&"object"==typeof U[B]||(U[B]=K);return U},n.titleCase=function(V){return V.charAt(0).toUpperCase()+V.substr(1)},n.containsAny=function(V,N){for(var U=0;U<N.length;U++)if(-1!==V.indexOf(N[U]))return!0;return!1},n.isIE=function(){return void 0!==window.navigator.msSaveBlob};var P=/Version\/[\d\.]+.*Safari/;n.isSafari=function(){return P.test(window.navigator.userAgent)};var z=/iPad|iPhone|iPod/;n.isIOS=function(){return z.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;n.getFirefoxVersion=function(){var V=S.exec(window.navigator.userAgent);if(V&&2===V.length){var N=parseInt(V[1]);if(!isNaN(N))return N}return null},n.isD3Selection=function(V){return V instanceof g.selection},n.ensureSingle=function(V,N,U,ee){var B=V.select(N+(U?"."+U:""));if(B.size())return B;var K=V.append(N);return U&&K.classed(U,!0),ee&&K.call(ee),K},n.ensureSingleById=function(V,N,U,ee){var B=V.select(N+"#"+U);if(B.size())return B;var K=V.append(N).attr("id",U);return ee&&K.call(ee),K},n.objectFromPath=function(V,N){for(var U,ee=V.split("."),B=U={},K=0;K<ee.length;K++){var J=ee[K],te=null,ae=ee[K].match(/(.*)\[([0-9]+)\]/);ae?(te=ae[2],(U=U[J=ae[1]]=[])[te]=K===ee.length-1?N:{},U=U[te]):(U[J]=K===ee.length-1?N:{},U=U[J])}return B};var C=/^([^\[\.]+)\.(.+)?/,R=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;n.expandObjectPaths=function(V){var N,U,ee,B,K,J,te;if("object"==typeof V&&!Array.isArray(V))for(U in V)V.hasOwnProperty(U)&&((N=U.match(C))?(B=V[U],ee=N[1],delete V[U],V[ee]=n.extendDeepNoArrays(V[ee]||{},n.objectFromPath(U,n.expandObjectPaths(B))[ee])):(N=U.match(R))?(B=V[U],ee=N[1],K=parseInt(N[2]),delete V[U],V[ee]=V[ee]||[],"."===N[3]?(te=N[4],J=V[ee][K]=V[ee][K]||{},n.extendDeepNoArrays(J,n.objectFromPath(te,n.expandObjectPaths(B)))):V[ee][K]=n.expandObjectPaths(B)):V[U]=n.expandObjectPaths(V[U]));return V},n.numSeparate=function(V,N,U){if(U||(U=!1),"string"!=typeof N||0===N.length)throw new Error("Separator string required for formatting!");"number"==typeof V&&(V=String(V));var ee=/(\d+)(\d{3})/,B=N.charAt(0),K=N.charAt(1),J=V.split("."),te=J[0],ae=J.length>1?B+J[1]:"";if(K&&(J.length>1||te.length>4||U))for(;ee.test(te);)te=te.replace(ee,"$1"+K+"$2");return te+ae},n.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;n.templateString=function(V,N){var U={};return V.replace(n.TEMPLATE_STRING_REGEX,function(ee,B){var K;return D.test(B)?K=N[B]:(U[B]=U[B]||n.nestedProperty(N,B).get,K=U[B]()),n.isValidTextValue(K)?K:""})};var j={max:10,count:0,name:"hovertemplate"};n.hovertemplateString=function(){return W.apply(j,arguments)};var q={max:10,count:0,name:"texttemplate"};n.texttemplateString=function(){return W.apply(q,arguments)};var Z=/^[:|\|]/;function W(V,N,U){var ee=this,B=arguments;N||(N={});var K={};return V.replace(n.TEMPLATE_STRING_REGEX,function(J,te,ae){var ce,oe,ve,fe="_xother"===te||"_yother"===te,xe="_xother_"===te||"_yother_"===te,Se="xother_"===te||"yother_"===te,pe="xother"===te||"yother"===te||fe||Se||xe,ge=te;if((fe||xe)&&(ge=ge.substring(1)),(Se||xe)&&(ge=ge.substring(0,ge.length-1)),pe){if(void 0===(ce=N[ge]))return""}else for(ve=3;ve<B.length;ve++)if(oe=B[ve]){if(oe.hasOwnProperty(ge)){ce=oe[ge];break}if(D.test(ge)||(ce=n.nestedProperty(oe,ge).get(),(ce=K[ge]||n.nestedProperty(oe,ge).get())&&(K[ge]=ce)),void 0!==ce)break}if(void 0===ce&&ee)return ee.count<ee.max&&(n.warn("Variable '"+ge+"' in "+ee.name+" could not be found!"),ce=J),ee.count===ee.max&&n.warn("Too many "+ee.name+" warnings - additional warnings will be suppressed"),ee.count++,J;if(ae){var Te;if(":"===ae[0]&&(ce=(Te=U?U.numberFormat:n.numberFormat)(ae.replace(Z,""))(ce)),"|"===ae[0]){Te=U?U.timeFormat:t;var se=n.dateTime2ms(ce);ce=n.formatDate(se,ae.replace(Z,""),!1,Te)}}else{var de=ge+"Label";N.hasOwnProperty(de)&&(ce=N[de])}return pe&&(ce="("+ce+")",(fe||xe)&&(ce=" "+ce),(Se||xe)&&(ce+=" ")),ce})}n.subplotSort=function(V,N){for(var U=Math.min(V.length,N.length)+1,ee=0,B=0,K=0;K<U;K++){var J=V.charCodeAt(K)||0,te=N.charCodeAt(K)||0,ae=J>=48&&J<=57,ce=te>=48&&te<=57;if(ae&&(ee=10*ee+J-48),ce&&(B=10*B+te-48),!ae||!ce){if(ee!==B)return ee-B;if(J!==te)return J-te}}return B-ee};var G=2e9;n.seedPseudoRandom=function(){G=2e9},n.pseudoRandom=function(){var V=G;return G=(69069*G+1)%4294967296,Math.abs(G-V)<429496729?n.pseudoRandom():G/4294967296},n.fillText=function(V,N,U){var ee=Array.isArray(U)?function(J){U.push(J)}:function(J){U.text=J},B=n.extractOption(V,N,"htx","hovertext");if(n.isValidTextValue(B))return ee(B);var K=n.extractOption(V,N,"tx","text");return n.isValidTextValue(K)?ee(K):void 0},n.isValidTextValue=function(V){return V||0===V},n.formatPercent=function(V,N){N=N||0;for(var U=(Math.round(100*V*Math.pow(10,N))*Math.pow(.1,N)).toFixed(N)+"%",ee=0;ee<N;ee++)-1!==U.indexOf(".")&&(U=(U=U.replace("0%","%")).replace(".%","%"));return U},n.isHidden=function(V){var N=window.getComputedStyle(V).display;return!N||"none"===N},n.strTranslate=function(V,N){return V||N?"translate("+V+","+N+")":""},n.strRotate=function(V){return V?"rotate("+V+")":""},n.strScale=function(V){return 1!==V?"scale("+V+")":""},n.getTextTransform=function(V){var N=V.noCenter,U=V.textX,ee=V.textY,ae=V.rotate,ce=V.scale;return ce?ce>1&&(ce=1):ce=0,n.strTranslate(V.targetX-ce*(U+(V.anchorX||0)),V.targetY-ce*(ee+(V.anchorY||0)))+n.strScale(ce)+(ae?"rotate("+ae+(N?"":" "+U+" "+ee)+")":"")},n.setTransormAndDisplay=function(V,N){V.attr("transform",n.getTextTransform(N)),V.style("display",N.scale?null:"none")},n.ensureUniformFontSize=function(V,N){var U=n.extendFlat({},N);return U.size=Math.max(N.size,V._fullLayout.uniformtext.minsize||0),U},n.join2=function(V,N,U){var ee=V.length;return ee>1?V.slice(0,-1).join(N)+U+V[ee-1]:V.join(N)},n.bigFont=function(V){return Math.round(1.2*V)};var X=n.getFirefoxVersion(),ne=null!==X&&X<86;n.getPositionFromD3Event=function(){return ne?[g.event.layerX,g.event.layerY]:[g.event.offsetX,g.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(v,Q,$){"use strict";Q.exports=function(g){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(g):"[object Object]"===Object.prototype.toString.call(g)&&Object.getPrototypeOf(g).hasOwnProperty("hasOwnProperty")}},{}],517:[function(v,Q,$){"use strict";var g=v("./nested_property"),t=/^\w*$/;Q.exports=function(k,x,e,r){var i,c,n;e=e||"name",r=r||"value";var m={};x&&x.length?(n=g(k,x),c=n.get()):c=k,x=x||"";var p={};if(c)for(i=0;i<c.length;i++)p[c[i][e]]=i;var s=t.test(r),f={set:function(l,o){var d=null===o?4:0;if(!c){if(!n||4===d)return;n.set(c=[])}var u=p[l];if(void 0===u){if(4===d)return;d|=3,p[l]=u=c.length}else o!==(s?c[u][r]:g(c[u],r).get())&&(d|=2);var a=c[u]=c[u]||{};return a[e]=l,s?a[r]=o:g(a,r).set(o),null!==o&&(d&=-5),m[u]=m[u]|d,f},get:function(l){if(c){var o=p[l];return void 0===o?void 0:s?c[o][r]:g(c[o],r).get()}},rename:function(l,o){var d=p[l];return void 0===d||(m[d]=1|m[d],p[o]=d,delete p[l],c[d][e]=o),f},remove:function(l){var o=p[l];if(void 0===o)return f;var d=c[o];if(Object.keys(d).length>2)return m[o]=2|m[o],f.set(l,null);if(s){for(i=o;i<c.length;i++)m[i]=3|m[i];for(i=o;i<c.length;i++)p[c[i][e]]--;c.splice(o,1),delete p[l]}else g(d,r).set(null),m[o]=6|m[o];return f},constructUpdate:function(){for(var l,o,d={},u=Object.keys(m),a=0;a<u.length;a++)l=x+"["+(o=u[a])+"]",c[o]?(1&m[o]&&(d[l+"."+e]=c[o][e]),2&m[o]&&(d[l+"."+r]=s?4&m[o]?null:c[o][r]:4&m[o]?null:g(c[o],r).get())):d[l]=null;return d}};return f}},{"./nested_property":523}],518:[function(v,Q,$){"use strict";var g=v("../registry");Q.exports=function(t,k){for(var x=t._context.locale,e=0;e<2;e++){for(var r=t._context.locales,i=0;i<2;i++){var c=(r[x]||{}).dictionary;if(c){var n=c[k];if(n)return n}r=g.localeRegistry}var m=x.split("-")[0];if(m===x)break;x=m}return k}},{"../registry":647}],519:[function(v,Q,$){"use strict";var g=v("../plot_api/plot_config").dfltConfig,t=v("./notifier"),k=Q.exports={};k.log=function(){var x;if(g.logging>1){var e=["LOG:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.trace.apply(console,e)}if(g.notifyOnLogging>1){var r=[];for(x=0;x<arguments.length;x++)r.push(arguments[x]);t(r.join("<br>"),"long")}},k.warn=function(){var x;if(g.logging>0){var e=["WARN:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.trace.apply(console,e)}if(g.notifyOnLogging>0){var r=[];for(x=0;x<arguments.length;x++)r.push(arguments[x]);t(r.join("<br>"),"stick")}},k.error=function(){var x;if(g.logging>0){var e=["ERROR:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.error.apply(console,e)}if(g.notifyOnLogging>0){var r=[];for(x=0;x<arguments.length;x++)r.push(arguments[x]);t(r.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(v,Q,$){"use strict";var g=v("@plotly/d3");Q.exports=function(t,k,x){var e=t.selectAll("g."+x.replace(/\s/g,".")).data(k,function(i){return i[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",x),e.order();var r=t.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(i){i[0][r]=g.select(this)}),e}},{"@plotly/d3":58}],521:[function(v,Q,$){"use strict";var g=v("gl-mat4");$.init2dArray=function(t,k){for(var x=new Array(t),e=0;e<t;e++)x[e]=new Array(k);return x},$.transposeRagged=function(t){var k,x,e=0,r=t.length;for(k=0;k<r;k++)e=Math.max(e,t[k].length);var i=new Array(e);for(k=0;k<e;k++)for(i[k]=new Array(r),x=0;x<r;x++)i[k][x]=t[x][k];return i},$.dot=function(t,k){if(!t.length||!k.length||t.length!==k.length)return null;var x,e,r=t.length;if(t[0].length)for(x=new Array(r),e=0;e<r;e++)x[e]=$.dot(t[e],k);else if(k[0].length){var i=$.transposeRagged(k);for(x=new Array(i.length),e=0;e<i.length;e++)x[e]=$.dot(t,i[e])}else for(x=0,e=0;e<r;e++)x+=t[e]*k[e];return x},$.translationMatrix=function(t,k){return[[1,0,t],[0,1,k],[0,0,1]]},$.rotationMatrix=function(t){var k=t*Math.PI/180;return[[Math.cos(k),-Math.sin(k),0],[Math.sin(k),Math.cos(k),0],[0,0,1]]},$.rotationXYMatrix=function(t,k,x){return $.dot($.dot($.translationMatrix(k,x),$.rotationMatrix(t)),$.translationMatrix(-k,-x))},$.apply3DTransform=function(t){return function(){var k=arguments,x=1===arguments.length?k[0]:[k[0],k[1],k[2]||0];return $.dot(t,[x[0],x[1],x[2],1]).slice(0,3)}},$.apply2DTransform=function(t){return function(){var k=arguments;3===k.length&&(k=k[0]);var x=1===arguments.length?k[0]:[k[0],k[1]];return $.dot(t,[x[0],x[1],1]).slice(0,2)}},$.apply2DTransform2=function(t){var k=$.apply2DTransform(t);return function(x){return k(x.slice(0,2)).concat(k(x.slice(2,4)))}},$.convertCssMatrix=function(t){if(t){var k=t.length;if(16===k)return t;if(6===k)return[t[0],t[1],0,0,t[2],t[3],0,0,0,0,1,0,t[4],t[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$.inverseTransformMatrix=function(t){var k=[];return g.invert(k,t),[[k[0],k[1],k[2],k[3]],[k[4],k[5],k[6],k[7]],[k[8],k[9],k[10],k[11]],[k[12],k[13],k[14],k[15]]]}},{"gl-mat4":210}],522:[function(v,Q,$){"use strict";Q.exports={mod:function(g,t){var k=g%t;return k<0?k+t:k},modHalf:function(g,t){return Math.abs(g)>t/2?g-Math.round(g/t)*t:g}}},{}],523:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("./array").isArrayOrTypedArray;function k(m,p){return function(){var s,f,l,o,d,u=m;for(o=0;o<p.length-1;o++){if(-1===(s=p[o])){for(f=!0,l=[],d=0;d<u.length;d++)l[d]=k(u[d],p.slice(o+1))(),l[d]!==l[0]&&(f=!1);return f?l[0]:l}if("number"==typeof s&&!t(u)||"object"!=typeof(u=u[s])||null===u)return}if("object"==typeof u&&null!==u&&null!==(l=u[p[o]]))return l}}Q.exports=function(m,p){if(g(p))p=String(p);else if("string"!=typeof p||"[-1]"===p.substr(p.length-4))throw"bad property string";for(var s,f,l,o=0,d=p.split(".");o<d.length;){if(s=String(d[o]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(s[1])d[o]=s[1];else{if(0!==o)throw"bad property string";d.splice(0,1)}for(f=s[2].substr(1,s[2].length-2).split("]["),l=0;l<f.length;l++)o++,d.splice(o,0,Number(f[l]))}o++}return"object"!=typeof m?{set:function(){throw"bad container"},get:function(){},astr:p,parts:d,obj:m}:{set:r(m,d,p),get:k(m,d),astr:p,parts:d,obj:m}};var x=/(^|\.)args\[/;function e(m,p){return void 0===m||null===m&&!p.match(x)}function r(m,p,s){return function(f){var l,o,d=m,u="",a=[[m,u]],y=e(f,s);for(o=0;o<p.length-1;o++){if("number"==typeof(l=p[o])&&!t(d))throw"array index but container is not an array";if(-1===l){if(y=!c(d,p.slice(o+1),f,s))break;return}if(!n(d,l,p[o+1],y))break;if("object"!=typeof(d=d[l])||null===d)throw"container is not an object";u=i(u,l),a.push([d,u])}if(y){if(o===p.length-1&&(delete d[p[o]],Array.isArray(d)&&+p[o]==d.length-1))for(;d.length&&void 0===d[d.length-1];)d.pop()}else d[p[o]]=f}}function i(m,p){var s=p;return g(p)?s="["+p+"]":m&&(s="."+p),m+s}function c(m,p,s,f){var l,o=t(s),d=!0,u=s,a=f.replace("-1",0),y=!o&&e(s,a),h=p[0];for(l=0;l<m.length;l++)a=f.replace("-1",l),o&&(y=e(u=s[l%s.length],a)),y&&(d=!1),n(m,l,h,y)&&r(m[l],p,f.replace("-1",l))(u);return d}function n(m,p,s,f){if(void 0===m[p]){if(f)return!1;m[p]="number"==typeof s?[]:{}}return!0}},{"./array":497,"fast-isnumeric":190}],524:[function(v,Q,$){"use strict";Q.exports=function(){}},{}],525:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=[];Q.exports=function(x,e){if(-1===k.indexOf(x)){k.push(x);var r=1e3;t(e)?r=e:"long"===e&&(r=3e3);var i=g.select("body").selectAll(".plotly-notifier").data([0]);i.enter().append("div").classed("plotly-notifier",!0),i.selectAll(".notifier-note").data(k).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(n){var m=g.select(this);m.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){m.transition().call(c)});for(var p=m.append("p"),s=n.split(/<br\s*\/?>/g),f=0;f<s.length;f++)f&&p.append("br"),p.append("span").text(s[f]);"stick"===e?m.transition().duration(350).style("opacity",1):m.transition().duration(700).style("opacity",1).transition().delay(r).call(c)})}function c(n){n.duration(700).style("opacity",0).each("end",function(m){var p=k.indexOf(m);-1!==p&&k.splice(p,1),g.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(v,Q,$){"use strict";var g=v("./setcursor"),t="data-savedcursor";Q.exports=function(k,x){var e=k.attr(t);if(x){if(!e){for(var r=(k.attr("class")||"").split(" "),i=0;i<r.length;i++){var c=r[i];0===c.indexOf("cursor-")&&k.attr(t,c.substr(7)).classed(c,!1)}k.attr(t)||k.attr(t,"!!")}g(k,x)}else e&&(k.attr(t,null),"!!"===e?g(k):g(k,e))}},{"./setcursor":536}],527:[function(v,Q,$){"use strict";var g=v("./matrix").dot,t=v("../constants/numerical").BADNUM,k=Q.exports={};k.tester=function(x){var e,r=x.slice(),i=r[0][0],c=i,n=r[0][1],m=n;for(r[r.length-1][0]===r[0][0]&&r[r.length-1][1]===r[0][1]||r.push(r[0]),e=1;e<r.length;e++)i=Math.min(i,r[e][0]),c=Math.max(c,r[e][0]),n=Math.min(n,r[e][1]),m=Math.max(m,r[e][1]);var p,s=!1;5===r.length&&(r[0][0]===r[1][0]?r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]&&(s=!0,p=function(o){return o[0]===r[0][0]}):r[0][1]===r[1][1]&&r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]&&(s=!0,p=function(o){return o[1]===r[0][1]}));var f=!0,l=r[0];for(e=1;e<r.length;e++)if(l[0]!==r[e][0]||l[1]!==r[e][1]){f=!1;break}return{xmin:i,xmax:c,ymin:n,ymax:m,pts:r,contains:s?function(o,d){var u=o[0],a=o[1];return!(u===t||u<i||u>c||a===t||a<n||a>m||d&&p(o))}:function(o,d){var u=o[0],a=o[1];if(u===t||u<i||u>c||a===t||a<n||a>m)return!1;var y,h,_,b,w,T=r.length,L=r[0][0],M=r[0][1],P=0;for(y=1;y<T;y++)if(h=L,_=M,L=r[y][0],M=r[y][1],!(u<(b=Math.min(h,L))||u>Math.max(h,L)||a>Math.max(_,M)))if(a<Math.min(_,M))u!==b&&P++;else{if(a===(w=L===h?a:_+(u-h)*(M-_)/(L-h)))return 1!==y||!d;a<=w&&u!==b&&P++}return P%2==1},isRect:s,degenerate:f}},k.isSegmentBent=function(x,e,r,i){var c,n,m,p=x[e],s=[x[r][0]-p[0],x[r][1]-p[1]],f=g(s,s),l=Math.sqrt(f),o=[-s[1]/l,s[0]/l];for(c=e+1;c<r;c++)if((m=g(n=[x[c][0]-p[0],x[c][1]-p[1]],s))<0||m>f||Math.abs(g(n,o))>i)return!0;return!1},k.filter=function(x,e){var r=[x[0]],i=0,c=0;function n(m){x.push(m);var p=r.length,s=i;r.splice(c+1);for(var f=s+1;f<x.length;f++)(f===x.length-1||k.isSegmentBent(x,s,f+1,e))&&(r.push(x[f]),r.length<p-2&&(i=f,c=r.length-1),s=f)}return x.length>1&&n(x.pop()),{addPt:n,raw:x,filtered:r}}},{"../constants/numerical":491,"./matrix":521}],528:[function(v,Q,$){(function(g){(function(){"use strict";var t=v("./show_no_webgl_msg"),k=v("regl");Q.exports=function(x,e,r){var i=x._fullLayout,c=!0;return i._glcanvas.each(function(n){if(n.regl)n.regl.preloadCachedCode(r);else if(!n.pick||i._has("parcoords")){try{n.regl=k({canvas:this,attributes:{antialias:!n.pick,preserveDrawingBuffer:!0},pixelRatio:x._context.plotGlPixelRatio||g.devicePixelRatio,extensions:e||[],cachedCode:r||{}})}catch(m){c=!1}n.regl||(c=!1),c&&this.addEventListener("webglcontextlost",function(m){x&&x.emit&&x.emit("plotly_webglcontextlost",{event:m,layer:n.key})},!1)}}),c||t({container:i._glcontainer.node()}),c}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("is-mobile");Q.exports=function(k){var x,p;if("string"!=typeof(x=k&&k.hasOwnProperty("userAgent")?k.userAgent:("undefined"!=typeof navigator&&(p=navigator.userAgent),p&&p.headers&&"string"==typeof p.headers["user-agent"]&&(p=p.headers["user-agent"]),p)))return!0;var e=t({ua:{headers:{"user-agent":x}},tablet:!0,featureDetect:!1});if(!e)for(var r=x.split(" "),i=1;i<r.length;i++)if(-1!==r[i].indexOf("Safari"))for(var c=i-1;c>-1;c--){var n=r[c];if("Version/"===n.substr(0,8)){var m=n.substr(8).split(".")[0];if(g(m)&&(m=+m),m>=13)return!0}}return e}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(v,Q,$){"use strict";Q.exports=function(g,t){if(t instanceof RegExp){for(var k=t.toString(),x=0;x<g.length;x++)if(g[x]instanceof RegExp&&g[x].toString()===k)return g;g.push(t)}else!t&&0!==t||-1!==g.indexOf(t)||g.push(t);return g}},{}],531:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plot_api/plot_config").dfltConfig,k={add:function(x,e,r,i,c){var n,m;x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},m=x.undoQueue.index,x.autoplay?x.undoQueue.inSequence||(x.autoplay=!1):(!x.undoQueue.sequence||x.undoQueue.beginSequence?(x.undoQueue.queue.splice(m,x.undoQueue.queue.length-m,n={undo:{calls:[],args:[]},redo:{calls:[],args:[]}}),x.undoQueue.index+=1):n=x.undoQueue.queue[m-1],x.undoQueue.beginSequence=!1,n&&(n.undo.calls.unshift(e),n.undo.args.unshift(r),n.redo.calls.push(i),n.redo.args.push(c)),x.undoQueue.queue.length>t.queueLength&&(x.undoQueue.queue.shift(),x.undoQueue.index--))},startSequence:function(x){x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},x.undoQueue.sequence=!0,x.undoQueue.beginSequence=!0},stopSequence:function(x){x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},x.undoQueue.sequence=!1,x.undoQueue.beginSequence=!1},undo:function(x){var e,r;if(!(void 0===x.undoQueue||isNaN(x.undoQueue.index)||x.undoQueue.index<=0)){for(x.undoQueue.index--,e=x.undoQueue.queue[x.undoQueue.index],x.undoQueue.inSequence=!0,r=0;r<e.undo.calls.length;r++)k.plotDo(x,e.undo.calls[r],e.undo.args[r]);x.undoQueue.inSequence=!1,x.autoplay=!1}},redo:function(x){var e,r;if(!(void 0===x.undoQueue||isNaN(x.undoQueue.index)||x.undoQueue.index>=x.undoQueue.queue.length)){for(e=x.undoQueue.queue[x.undoQueue.index],x.undoQueue.inSequence=!0,r=0;r<e.redo.calls.length;r++)k.plotDo(x,e.redo.calls[r],e.redo.args[r]);x.undoQueue.inSequence=!1,x.autoplay=!1,x.undoQueue.index++}},plotDo:function(x,e,r){x.autoplay=!0,r=function(i,c){for(var n,m=[],p=0;p<c.length;p++)m[p]=(n=c[p])===i?n:"object"==typeof n?Array.isArray(n)?g.extendDeep([],n):g.extendDeepAll({},n):n;return m}(x,r),e.apply(null,r)}};Q.exports=k},{"../lib":515,"../plot_api/plot_config":553}],532:[function(v,Q,$){"use strict";$.counter=function(g,t,k,x){var e=(t||"")+(k?"":"$"),r=!1===x?"":"^";return"xy"===g?new RegExp(r+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(r+g+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(v,Q,$){"use strict";var g=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,t=/^[^\.\[\]]+$/;Q.exports=function(k,x){for(;x;){var e=k.match(g);if(e)k=e[1];else{if(!k.match(t))throw new Error("bad relativeAttr call:"+[k,x]);k=""}if("^"!==x.charAt(0))break;x=x.slice(1)}return k&&"["!==x.charAt(0)?k+"."+x:k+x}},{}],534:[function(v,Q,$){"use strict";var g=v("./array").isArrayOrTypedArray,t=v("./is_plain_object");Q.exports=function k(x,e){for(var r in e){var i=e[r],c=x[r];if(c!==i)if("_"===r.charAt(0)||"function"==typeof i){if(r in x)continue;x[r]=i}else if(g(i)&&g(c)&&t(i[0])){if("customdata"===r||"ids"===r)continue;for(var n=Math.min(i.length,c.length),m=0;m<n;m++)c[m]!==i[m]&&t(i[m])&&t(c[m])&&k(c[m],i[m])}else t(i)&&t(c)&&(k(c,i),Object.keys(c).length||delete x[r])}}},{"./array":497,"./is_plain_object":516}],535:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("./loggers"),k=v("./identity"),x=v("../constants/numerical").BADNUM;function e(n,m){return n<m}function r(n,m){return n<=m}function i(n,m){return n>m}function c(n,m){return n>=m}$.findBin=function(n,m,p){if(g(m.start))return p?Math.ceil((n-m.start)/m.size-1e-9)-1:Math.floor((n-m.start)/m.size+1e-9);var s,f,l=0,o=m.length,d=0,u=o>1?(m[o-1]-m[0])/(o-1):1;for(f=u>=0?p?e:r:p?c:i,n+=1e-9*u*(p?-1:1)*(u>=0?1:-1);l<o&&d++<100;)f(m[s=Math.floor((l+o)/2)],n)?l=s+1:o=s;return d>90&&t.log("Long binary search..."),l-1},$.sorterAsc=function(n,m){return n-m},$.sorterDes=function(n,m){return m-n},$.distinctVals=function(n){var m,p=n.slice();for(p.sort($.sorterAsc),m=p.length-1;m>-1&&p[m]===x;m--);for(var s,f=p[m]-p[0]||1,l=f/(m||1)/1e4,o=[],d=0;d<=m;d++){var u=p[d],a=u-s;void 0===s?(o.push(u),s=u):a>l&&(f=Math.min(f,a),o.push(u),s=u)}return{vals:o,minDiff:f}},$.roundUp=function(n,m,p){for(var s,f=0,l=m.length-1,o=0,d=p?0:1,u=p?1:0,a=p?Math.ceil:Math.floor;f<l&&o++<100;)m[s=a((f+l)/2)]<=n?f=s+d:l=s-u;return m[f]},$.sort=function(n,m){for(var p=0,s=0,f=1;f<n.length;f++){var l=m(n[f],n[f-1]);if(l<0?p=1:l>0&&(s=1),p&&s)return n.sort(m)}return s?n:n.reverse()},$.findIndexOfMin=function(n,m){m=m||k;for(var p,s=1/0,f=0;f<n.length;f++){var l=m(n[f]);l<s&&(s=l,p=f)}return p}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(v,Q,$){"use strict";Q.exports=function(g,t){(g.attr("class")||"").split(" ").forEach(function(k){0===k.indexOf("cursor-")&&g.classed(k,!1)}),t&&g.classed("cursor-"+t,!0)}},{}],537:[function(v,Q,$){"use strict";var g=v("../components/color"),t=function(){};Q.exports=function(k){for(var x in k)"function"==typeof k[x]&&(k[x]=t);k.destroy=function(){k.container.parentNode.removeChild(k.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=g.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=g.lightLine,e.style["z-index"]=30;var r=document.createElement("p");return r.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",r.style.position="relative",r.style.top="50%",r.style.left="50%",r.style.height="30%",r.style.width="50%",r.style.margin="-15% 0 0 -25%",e.appendChild(r),k.container.appendChild(e),k.container.style.background="#FFFFFF",k.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(v,Q,$){"use strict";Q.exports=function(g){return Object.keys(g).sort()}},{}],539:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("./array").isArrayOrTypedArray;$.aggNums=function(k,x,e,r){var i,c;if((!r||r>e.length)&&(r=e.length),g(x)||(x=!1),t(e[0])){for(c=new Array(r),i=0;i<r;i++)c[i]=$.aggNums(k,x,e[i]);e=c}for(i=0;i<r;i++)g(x)?g(e[i])&&(x=k(+x,+e[i])):x=e[i];return x},$.len=function(k){return $.aggNums(function(x){return x+1},0,k)},$.mean=function(k,x){return x||(x=$.len(k)),$.aggNums(function(e,r){return e+r},0,k)/x},$.midRange=function(k){if(void 0!==k&&0!==k.length)return($.aggNums(Math.max,null,k)+$.aggNums(Math.min,null,k))/2},$.variance=function(k,x,e){return x||(x=$.len(k)),g(e)||(e=$.mean(k,x)),$.aggNums(function(r,i){return r+Math.pow(i-e,2)},0,k)/x},$.stdev=function(k,x,e){return Math.sqrt($.variance(k,x,e))},$.median=function(k){var x=k.slice().sort();return $.interp(x,.5)},$.interp=function(k,x){if(!g(x))throw"n should be a finite number";if((x=x*k.length-.5)<0)return k[0];if(x>k.length-1)return k[k.length-1];var e=x%1;return e*k[Math.ceil(x)]+(1-e)*k[Math.floor(x)]}},{"./array":497,"fast-isnumeric":190}],540:[function(v,Q,$){"use strict";var g=v("color-normalize");Q.exports=function(t){return t?g(t):[0,0,0,1]}},{"color-normalize":89}],541:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../lib"),k=t.strTranslate,x=v("../constants/xmlns_namespaces"),e=v("../constants/alignment").LINE_SPACING,r=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;$.convertToTspans=function(S,C,R){var D=S.text(),j=!S.attr("data-notex")&&C&&C._context.typesetMath&&"undefined"!=typeof MathJax&&D.match(r),q=g.select(S.node().parentNode);if(!q.empty()){var Z=S.attr("class")?S.attr("class").split(" ")[0]:"text";return q.selectAll("svg."+(Z+="-math")).remove(),q.selectAll("g."+Z+"-group").remove(),S.style("display",null).attr({"data-unformatted":D,"data-math":"N"}),j?(C&&C._promises||[]).push(new Promise(function(G){S.style("display","none");var X=parseInt(S.node().style.fontSize,10);!function(V,N,U){var ee,B,K,J,te=parseInt((MathJax.version||"").split(".")[0]);if(2===te||3===te){var ae=function(){var oe="math-output-"+t.randstr({},64),ve=(J=g.select("body").append("div").attr({id:oe}).style({visibility:"hidden",position:"absolute","font-size":N.fontSize+"px"}).text(V.replace(i,"\\lt ").replace(c,"\\gt "))).node();return 2===te?MathJax.Hub.Typeset(ve):MathJax.typeset([ve])},ce=function(){var oe=J.select(2===te?".MathJax_SVG":".MathJax"),ve=!oe.empty()&&J.select("svg").node();if(ve){var fe,xe=ve.getBoundingClientRect();fe=2===te?g.select("body").select("#MathJax_SVG_glyphs"):oe.select("defs"),U(oe,fe,xe)}else t.log("There was an error in the tex syntax.",V),U();J.remove()};2===te?MathJax.Hub.Queue(function(){return B=t.extendDeepAll({},MathJax.Hub.config),K=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:n},displayAlign:"left"})},function(){if("SVG"!==(ee=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")},ae,ce,function(){if("SVG"!==ee)return MathJax.Hub.setRenderer(ee)},function(){return void 0!==K&&(MathJax.Hub.processSectionDelay=K),MathJax.Hub.Config(B)}):3===te&&(B=t.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=n,"svg"!==(ee=MathJax.config.startup.output)&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ae(),ce(),"svg"!==ee&&(MathJax.config.startup.output=ee),MathJax.config=B}))}else t.warn("No MathJax version:",MathJax.version)}(j[2],{fontSize:X},function(V,N,U){q.selectAll("svg."+Z).remove(),q.selectAll("g."+Z+"-group").remove();var ee=V&&V.select("svg");if(!ee||!ee.node())return W(),void G();var B=q.append("g").classed(Z+"-group",!0).attr({"pointer-events":"none","data-unformatted":D,"data-math":"Y"});B.node().appendChild(ee.node()),N&&N.node()&&ee.node().insertBefore(N.node().cloneNode(!0),ee.node().firstChild);var K=U.width,J=U.height;ee.attr({class:Z,height:J,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var te=S.node().style.fill||"black",ae=ee.select("g");ae.attr({fill:te,stroke:te});var ce=ae.node().getBoundingClientRect(),oe=ce.width,ve=ce.height;(oe>K||ve>J)&&(ee.style("overflow","hidden"),oe=(ce=ee.node().getBoundingClientRect()).width,ve=ce.height);var fe=+S.attr("x"),xe=+S.attr("y"),Se=-(X||S.node().getBoundingClientRect().height)/4;if("y"===Z[0])B.attr({transform:"rotate("+[-90,fe,xe]+")"+k(-oe/2,Se-ve/2)});else if("l"===Z[0])xe=Se-ve/2;else if("a"===Z[0]&&0!==Z.indexOf("atitle"))fe=0,xe=Se;else{var pe=S.attr("text-anchor");fe-=oe*("middle"===pe?.5:"end"===pe?1:0),xe=xe+Se-ve/2}ee.attr({x:fe,y:xe}),R&&R.call(S,B),G(B)})})):W(),S}function W(){q.empty()||(Z=S.attr("class")+"-math",q.select("svg."+Z).remove()),S.text("").style("white-space","pre"),function(G,X){X=X.replace(l," ");var ne,V=!1,N=[],U=-1;function ee(){U++;var se=document.createElementNS(x.svg,"tspan");g.select(se).attr({class:"line",dy:U*e+"em"}),G.appendChild(se),ne=se;var de=N;if(N=[{node:se}],de.length>1)for(var Ae=1;Ae<de.length;Ae++)B(de[Ae])}function B(se){var de,Ae=se.type,Le={};if("a"===Ae){de="a";var Me=se.target,De=se.href,Oe=se.popup;De&&(Le={"xlink:xlink:show":"_blank"===Me||"_"!==Me.charAt(0)?"new":"replace",target:Me,"xlink:xlink:href":De},Oe&&(Le.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Oe+'");return false;'))}else de="tspan";se.style&&(Le.style=se.style);var Ie=document.createElementNS(x.svg,de);if("sup"===Ae||"sub"===Ae){K(ne,"\u200b"),ne.appendChild(Ie);var Qe=document.createElementNS(x.svg,"tspan");K(Qe,"\u200b"),g.select(Qe).attr("dy",s[Ae]),Le.dy=p[Ae],ne.appendChild(Ie),ne.appendChild(Qe)}else ne.appendChild(Ie);g.select(Ie).attr(Le),ne=se.node=Ie,N.push(se)}function K(se,de){se.appendChild(document.createTextNode(de))}function J(se){if(1!==N.length){var de=N.pop();se!==de.type&&t.log("Start tag <"+de.type+"> doesnt match end tag <"+se+">. Pretending it did match.",X),ne=N[N.length-1].node}else t.log("Ignoring unexpected end tag </"+se+">.",X)}u.test(X)?ee():(ne=G,N=[{node:G}]);for(var te=X.split(o),ae=0;ae<te.length;ae++){var ce=te[ae],oe=ce.match(d),ve=oe&&oe[2].toLowerCase(),fe=m[ve];if("br"===ve)ee();else if(void 0===fe)K(ne,M(ce));else if(oe[1])J(ve);else{var xe=oe[4],Se={type:ve},pe=b(xe,a);if(pe?(pe=pe.replace(w,"$1 fill:"),fe&&(pe+=";"+fe)):fe&&(pe=fe),pe&&(Se.style=pe),"a"===ve){V=!0;var ge=b(xe,y);if(ge){var Te=P(ge);Te&&(Se.href=Te,Se.target=b(xe,h)||"_blank",Se.popup=b(xe,_))}}B(Se)}}return V}(S.node(),D)&&S.style("pointer-events","all"),$.positionText(S),R&&R.call(S)}};var i=/(<|&lt;|&#60;)/g,c=/(>|&gt;|&#62;)/g,n=[["$","$"],["\\(","\\)"]],m={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},p={sub:"0.3em",sup:"-0.6em"},s={sub:"-0.21em",sup:"0.42em"},f=["http:","https:","mailto:","",void 0,":"],l=$.NEWLINES=/(\r\n?|\n)/g,o=/(<[^<>]*>)/,d=/<(\/?)([^ >]*)(\s+(.*))?>/i,u=/<br(\s+.*)?>/i;$.BR_TAG_ALL=/<br(\s+.*)?>/gi;var a=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,y=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,h=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,_=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function b(S,C){if(!S)return null;var R=S.match(C),D=R&&(R[3]||R[4]);return D&&M(D)}var w=/(^|;)\s*color:/;$.plainText=function(S,C){for(var R=void 0!==(C=C||{}).len&&-1!==C.len?C.len:1/0,D=void 0!==C.allowedTags?C.allowedTags:["br"],q=S.split(o),Z=[],W="",G=0,X=0;X<q.length;X++){var ne=q[X],V=ne.match(d),N=V&&V[2].toLowerCase();if(N)-1!==D.indexOf(N)&&(Z.push(ne),W=N);else{var U=ne.length;if(G+U<R)Z.push(ne),G+=U;else if(G<R){var ee=R-G;W&&("br"!==W||ee<=3||U<=3)&&Z.pop(),Z.push(R>3?ne.substr(0,ee-3)+"...":ne.substr(0,ee));break}W=""}}return Z.join("")};var T={mu:"\u03bc",amp:"&",lt:"<",gt:">",nbsp:"\xa0",times:"\xd7",plusmn:"\xb1",deg:"\xb0"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function M(S){return S.replace(L,function(C,R){return("#"===R.charAt(0)?function(D){if(!(D>1114111)){var j=String.fromCodePoint;if(j)return j(D);var q=String.fromCharCode;return D<=65535?q(D):q(55232+(D>>10),D%1024+56320)}}("x"===R.charAt(1)?parseInt(R.substr(2),16):parseInt(R.substr(1),10)):T[R])||C})}function P(S){var C=encodeURI(decodeURI(S)),R=document.createElement("a"),D=document.createElement("a");R.href=S,D.href=C;var q=D.protocol;return-1!==f.indexOf(R.protocol)&&-1!==f.indexOf(q)?C:""}function z(S,C,R){var D,j,q,Z=R.horizontalAlign,W=R.verticalAlign||"top",G=S.node().getBoundingClientRect(),X=C.node().getBoundingClientRect();return j="bottom"===W?function(){return G.bottom-D.height}:"middle"===W?function(){return G.top+(G.height-D.height)/2}:function(){return G.top},q="right"===Z?function(){return G.right-D.width}:"center"===Z?function(){return G.left+(G.width-D.width)/2}:function(){return G.left},function(){D=this.node().getBoundingClientRect();var ne=q()-X.left,V=j()-X.top,N=R.gd||{};if(R.gd){N._fullLayout._calcInverseTransform(N);var U=t.apply3DTransform(N._fullLayout._invTransform)(ne,V);ne=U[0],V=U[1]}return this.style({top:V+"px",left:ne+"px","z-index":1e3}),this}}$.convertEntities=M,$.sanitizeHTML=function(S){S=S.replace(l," ");for(var C=document.createElement("p"),R=C,D=[],j=S.split(o),q=0;q<j.length;q++){var Z=j[q],W=Z.match(d),G=W&&W[2].toLowerCase();if(G in m)if(W[1])D.length&&(R=D.pop());else{var X=W[4],ne=b(X,a),V=ne?{style:ne}:{};if("a"===G){var N=b(X,y);if(N){var U=P(N);if(U){V.href=U;var ee=b(X,h);ee&&(V.target=ee)}}}var B=document.createElement(G);R.appendChild(B),g.select(B).attr(V),R=B,D.push(B)}else R.appendChild(document.createTextNode(M(Z)))}return C.innerHTML},$.lineCount=function(S){return S.selectAll("tspan.line").size()||1},$.positionText=function(S,C,R){return S.each(function(){var D=g.select(this);function j(W,G){return void 0===G?null===(G=D.attr(W))&&(D.attr(W,0),G=0):D.attr(W,G),G}var q=j("x",C),Z=j("y",R);"text"===this.nodeName&&D.selectAll("tspan.line").attr({x:q,y:Z})})},$.makeTextShadow=function(S){var C="1px ",R="1px ",D="1px ";return C+R+D+S+", -"+C+"-"+R+D+S+", "+C+"-"+R+D+S+", -"+C+R+D+S},$.makeEditable=function(S,C){var R=C.gd,D=C.delegate,j=g.dispatch("edit","input","cancel"),q=D||S;if(S.style({"pointer-events":D?"none":"all"}),1!==S.size())throw new Error("boo");function Z(){var ne,V,N,U,ee;ne=g.select(R).select(".svg-container"),V=ne.append("div"),N=S.node().style,U=parseFloat(N.fontSize||12),void 0===(ee=C.text)&&(ee=S.attr("data-unformatted")),V.classed("plugin-editable editable",!0).style({position:"absolute","font-family":N.fontFamily||"Arial","font-size":U,color:C.fill||N.fill||"black",opacity:1,"background-color":C.background||"transparent",outline:"#ffffff33 1px solid",margin:[-U/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(ee).call(z(S,ne,C)).on("blur",function(){R._editing=!1,S.text(this.textContent).style({opacity:1});var B,K=g.select(this).attr("class");(B=K?"."+K.split(" ")[0]+"-math-group":"[class*=-math-group]")&&g.select(S.node().parentNode).select(B).style({opacity:0});var J=this.textContent;g.select(this).transition().duration(0).remove(),g.select(document).on("mouseup",null),j.edit.call(S,J)}).on("focus",function(){var B=this;R._editing=!0,g.select(document).on("mouseup",function(){if(g.event.target===B)return!1;document.activeElement===V.node()&&V.node().blur()})}).on("keyup",function(){27===g.event.which?(R._editing=!1,S.style({opacity:1}),g.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),j.cancel.call(S,this.textContent)):(j.input.call(S,this.textContent),g.select(this).call(z(S,ne,C)))}).on("keydown",function(){13===g.event.which&&this.blur()}).call(W),S.style({opacity:0});var G,X=q.attr("class");(G=X?"."+X.split(" ")[0]+"-math-group":"[class*=-math-group]")&&g.select(S.node().parentNode).select(G).style({opacity:0})}function W(G){var X=G.node(),ne=document.createRange();ne.selectNodeContents(X);var V=window.getSelection();V.removeAllRanges(),V.addRange(ne),X.focus()}return C.immediate?Z():q.on("click",Z),g.rebind(S,j,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(v,Q,$){"use strict";var g={};function t(k){k&&null!==k.timer&&(clearTimeout(k.timer),k.timer=null)}$.throttle=function(k,x,e){var r=g[k],i=Date.now();if(!r){for(var c in g)g[c].ts<i-6e4&&delete g[c];r=g[k]={ts:0,timer:null}}function n(){e(),r.ts=Date.now(),r.onDone&&(r.onDone(),r.onDone=null)}t(r),i>r.ts+x?n():r.timer=setTimeout(function(){n(),r.timer=null},x)},$.done=function(k){var x=g[k];return x&&x.timer?new Promise(function(e){var r=x.onDone;x.onDone=function(){r&&r(),e(),x.onDone=null}}):Promise.resolve()},$.clear=function(k){if(k)t(g[k]),delete g[k];else for(var x in g)$.clear(x)}},{}],543:[function(v,Q,$){"use strict";var g=v("fast-isnumeric");Q.exports=function(t,k){if(t>0)return Math.log(t)/Math.LN10;var x=Math.log(Math.min(k[0],k[1]))/Math.LN10;return g(x)||(x=Math.log(Math.max(k[0],k[1]))/Math.LN10-6),x}},{"fast-isnumeric":190}],544:[function(v,Q,$){"use strict";var g=Q.exports={},t=v("../plots/geo/constants").locationmodeToLayer,k=v("topojson-client").feature;g.getTopojsonName=function(x){return[x.scope.replace(/ /g,"-"),"_",x.resolution.toString(),"m"].join("")},g.getTopojsonPath=function(x,e){return x+e+".json"},g.getTopojsonFeatures=function(x,e){return k(e,e.objects[t[x.locationmode]]).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(v,Q,$){"use strict";Q.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(v,Q,$){"use strict";Q.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(v,Q,$){"use strict";var g=v("../registry");Q.exports=function(t){for(var k,x,e=g.layoutArrayContainers,r=g.layoutArrayRegexes,i=t.split("[")[0],c=0;c<r.length;c++)if((x=t.match(r[c]))&&0===x.index){k=x[0];break}if(k||(k=e[e.indexOf(i)]),!k)return!1;var n=t.substr(k.length);return n?!!(x=n.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:k,index:Number(x[1]),property:x[3]||""}:{array:k,index:"",property:""}}},{"../registry":647}],548:[function(v,Q,$){"use strict";var g=v("../lib"),t=g.extendFlat,k=g.isPlainObject,x={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},r=x.flags.slice().concat(["fullReplot"]),i=e.flags.slice().concat("layoutReplot");function c(p){for(var s={},f=0;f<p.length;f++)s[p[f]]=!1;return s}function n(p,s,f){var l=t({},p);for(var o in l){var d=l[o];k(d)&&(l[o]=m(d,s,0,o))}return"from-root"===f&&(l.editType=s),l}function m(p,s,f,l){if(p.valType){var o=t({},p);if(o.editType=s,Array.isArray(p.items)){o.items=new Array(p.items.length);for(var d=0;d<p.items.length;d++)o.items[d]=m(p.items[d],s)}return o}return n(p,s,"_"===l.charAt(0)?"nested":"from-root")}Q.exports={traces:x,layout:e,traceFlags:function(){return c(r)},layoutFlags:function(){return c(i)},update:function(p,s){var f=s.editType;if(f&&"none"!==f)for(var l=f.split("+"),o=0;o<l.length;o++)p[l[o]]=!0},overrideAll:n}},{"../lib":515}],549:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("gl-mat4/fromQuat"),k=v("../registry"),x=v("../lib"),e=v("../plots/plots"),r=v("../plots/cartesian/axis_ids"),i=v("../components/color"),c=r.cleanId,n=r.getFromTrace,m=k.traceIs;function p(h,_){var b=h[_],w=_.charAt(0);b&&"paper"!==b&&(h[_]=c(b,w,!0))}function s(h){function _(b,w){h[b]&&(!h.title||!h.title[w])&&(h.title||(h.title={}),h.title[w]=h[b],delete h[b])}h&&("string"!=typeof h.title&&"number"!=typeof h.title||(h.title={text:h.title}),_("titlefont","font"),_("titleposition","position"),_("titleside","side"),_("titleoffset","offset"))}function f(h){if(!x.isPlainObject(h))return!1;var _=h.name;return delete h.name,delete h.showlegend,("string"==typeof _||"number"==typeof _)&&String(_)}function l(h,_,b,w){if(b&&!w)return h;if(w&&!b||!h.trim())return _;if(!_.trim())return h;var T,L=Math.min(h.length,_.length);for(T=0;T<L&&h.charAt(T)===_.charAt(T);T++);return h.substr(0,T).trim()}function o(h){var _="middle",b="center";return"string"==typeof h&&(-1!==h.indexOf("top")?_="top":-1!==h.indexOf("bottom")&&(_="bottom"),-1!==h.indexOf("left")?b="left":-1!==h.indexOf("right")&&(b="right")),_+" "+b}function d(h,_){return _ in h&&"object"==typeof h[_]&&0===Object.keys(h[_]).length}$.clearPromiseQueue=function(h){Array.isArray(h._promises)&&h._promises.length>0&&x.log("Clearing previous rejected promises from queue."),h._promises=[]},$.cleanLayout=function(h){var _,b;h||(h={}),h.xaxis1&&(h.xaxis||(h.xaxis=h.xaxis1),delete h.xaxis1),h.yaxis1&&(h.yaxis||(h.yaxis=h.yaxis1),delete h.yaxis1),h.scene1&&(h.scene||(h.scene=h.scene1),delete h.scene1);var w=(e.subplotsRegistry.cartesian||{}).attrRegex,T=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,M=(e.subplotsRegistry.gl3d||{}).attrRegex,P=Object.keys(h);for(_=0;_<P.length;_++){var z=P[_];if(w&&w.test(z)){var S=h[z];S.anchor&&"free"!==S.anchor&&(S.anchor=c(S.anchor)),S.overlaying&&(S.overlaying=c(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":!1===S.isdate&&!1===S.islog&&(S.type="linear")),"withzero"!==S.autorange&&"tozero"!==S.autorange||(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,d(S,"domain")&&delete S.domain,void 0!==S.autotick&&(void 0===S.tickmode&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),s(S)}else if(T&&T.test(z))s(h[z].radialaxis);else if(L&&L.test(z)){var C=h[z];s(C.aaxis),s(C.baxis),s(C.caxis)}else if(M&&M.test(z)){var R=h[z],D=R.cameraposition;if(Array.isArray(D)&&4===D[0].length){var q=D[1],Z=D[2],W=t([],D[0]),G=[];for(b=0;b<3;++b)G[b]=q[b]+Z*W[2+4*b];R.camera={eye:{x:G[0],y:G[1],z:G[2]},center:{x:q[0],y:q[1],z:q[2]},up:{x:0,y:0,z:1}},delete R.cameraposition}s(R.xaxis),s(R.yaxis),s(R.zaxis)}}var X=Array.isArray(h.annotations)?h.annotations.length:0;for(_=0;_<X;_++){var ne=h.annotations[_];x.isPlainObject(ne)&&(ne.ref&&("paper"===ne.ref?(ne.xref="paper",ne.yref="paper"):"data"===ne.ref&&(ne.xref="x",ne.yref="y"),delete ne.ref),p(ne,"xref"),p(ne,"yref"))}var V=Array.isArray(h.shapes)?h.shapes.length:0;for(_=0;_<V;_++){var N=h.shapes[_];x.isPlainObject(N)&&(p(N,"xref"),p(N,"yref"))}var U=Array.isArray(h.images)?h.images.length:0;for(_=0;_<U;_++){var ee=h.images[_];x.isPlainObject(ee)&&(p(ee,"xref"),p(ee,"yref"))}var B=h.legend;return B&&(B.x>3?(B.x=1.02,B.xanchor="left"):B.x<-2&&(B.x=-.02,B.xanchor="right"),B.y>3?(B.y=1.02,B.yanchor="bottom"):B.y<-2&&(B.y=-.02,B.yanchor="top")),s(h),"rotate"===h.dragmode&&(h.dragmode="orbit"),i.clean(h),h.template&&h.template.layout&&$.cleanLayout(h.template.layout),h},$.cleanData=function(h){for(var _=0;_<h.length;_++){var b,w=h[_];if("histogramy"===w.type&&"xbins"in w&&!("ybins"in w)&&(w.ybins=w.xbins,delete w.xbins),w.error_y&&"opacity"in w.error_y){var T=i.defaults,L=w.error_y.color||(m(w,"bar")?i.defaultLine:T[_%T.length]);w.error_y.color=i.addOpacity(i.rgb(L),i.opacity(L)*w.error_y.opacity),delete w.error_y.opacity}if("bardir"in w&&("h"!==w.bardir||!m(w,"bar")&&"histogram"!==w.type.substr(0,9)||(w.orientation="h",$.swapXYData(w)),delete w.bardir),"histogramy"===w.type&&$.swapXYData(w),"histogramx"!==w.type&&"histogramy"!==w.type||(w.type="histogram"),"scl"in w&&!("colorscale"in w)&&(w.colorscale=w.scl,delete w.scl),"reversescl"in w&&!("reversescale"in w)&&(w.reversescale=w.reversescl,delete w.reversescl),w.xaxis&&(w.xaxis=c(w.xaxis,"x")),w.yaxis&&(w.yaxis=c(w.yaxis,"y")),m(w,"gl3d")&&w.scene&&(w.scene=e.subplotsRegistry.gl3d.cleanId(w.scene)),!m(w,"pie-like")&&!m(w,"bar-like"))if(Array.isArray(w.textposition))for(b=0;b<w.textposition.length;b++)w.textposition[b]=o(w.textposition[b]);else w.textposition&&(w.textposition=o(w.textposition));var M=k.getModule(w);if(M&&M.colorbar){var P=M.colorbar.container,z=P?w[P]:w;z&&z.colorscale&&("YIGnBu"===z.colorscale&&(z.colorscale="YlGnBu"),"YIOrRd"===z.colorscale&&(z.colorscale="YlOrRd"))}if("surface"===w.type&&x.isPlainObject(w.contours)){var S=["x","y","z"];for(b=0;b<S.length;b++){var C=w.contours[S[b]];x.isPlainObject(C)&&(C.highlightColor&&(C.highlightcolor=C.highlightColor,delete C.highlightColor),C.highlightWidth&&(C.highlightwidth=C.highlightWidth,delete C.highlightWidth))}}if("candlestick"===w.type||"ohlc"===w.type){var R=!1!==(w.increasing||{}).showlegend,D=!1!==(w.decreasing||{}).showlegend,j=f(w.increasing),q=f(w.decreasing);if(!1!==j&&!1!==q){var Z=l(j,q,R,D);Z&&(w.name=Z)}else!j&&!q||w.name||(w.name=j||q)}if(Array.isArray(w.transforms)){var W=w.transforms;for(b=0;b<W.length;b++){var G=W[b];if(x.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var X=G.styles,ne=Object.keys(X);G.styles=[];for(var V=0;V<ne.length;V++)G.styles.push({target:ne[V],value:X[ne[V]]})}}}}d(w,"line")&&delete w.line,"marker"in w&&(d(w.marker,"line")&&delete w.marker.line,d(w,"marker")&&delete w.marker),i.clean(w),w.autobinx&&(delete w.autobinx,delete w.xbins),w.autobiny&&(delete w.autobiny,delete w.ybins),s(w),w.colorbar&&s(w.colorbar),w.marker&&w.marker.colorbar&&s(w.marker.colorbar),w.line&&w.line.colorbar&&s(w.line.colorbar),w.aaxis&&s(w.aaxis),w.baxis&&s(w.baxis)}},$.swapXYData=function(h){var _;if(x.swapAttrs(h,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(h.z)&&Array.isArray(h.z[0])&&(h.transpose?delete h.transpose:h.transpose=!0),h.error_x&&h.error_y){var b=h.error_y,w="copy_ystyle"in b?b.copy_ystyle:!(b.color||b.thickness||b.width);x.swapAttrs(h,["error_?.copy_ystyle"]),w&&x.swapAttrs(h,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof h.hoverinfo){var T=h.hoverinfo.split("+");for(_=0;_<T.length;_++)"x"===T[_]?T[_]="y":"y"===T[_]&&(T[_]="x");h.hoverinfo=T.join("+")}},$.coerceTraceIndices=function(h,_){if(g(_))return[_];if(!Array.isArray(_)||!_.length)return h.data.map(function(T,L){return L});if(Array.isArray(_)){for(var b=[],w=0;w<_.length;w++)x.isIndex(_[w],h.data.length)?b.push(_[w]):x.warn("trace index (",_[w],") is not a number or is out of bounds");return b}return _},$.manageArrayContainers=function(h,_,b){var w=h.obj,T=h.parts,L=T.length,M=T[L-1],P=g(M);if(P&&null===_){var z=T.slice(0,L-1).join(".");x.nestedProperty(w,z).get().splice(M,1)}else P&&void 0===h.get()&&void 0===h.get()&&(b[h.astr]=null),h.set(_)};var u=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function a(h){var _=h.search(u);if(_>0)return h.substr(0,_)}$.hasParent=function(h,_){for(var b=a(_);b;){if(b in h)return!0;b=a(b)}return!1};var y=["x","y","z"];$.clearAxisTypes=function(h,_,b){for(var w=0;w<_.length;w++)for(var T=h._fullData[w],L=0;L<3;L++){var M=n(h,T,y[L]);if(M&&"log"!==M.type){var P=M._name,z=M._id.substr(1);if("scene"===z.substr(0,5)){if(void 0!==b[z])continue;P=z+"."+P}var S=P+".type";void 0===b[P]&&void 0===b[S]&&x.nestedProperty(h.layout,S).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(v,Q,$){"use strict";var g=v("./plot_api");$._doPlot=g._doPlot,$.newPlot=g.newPlot,$.restyle=g.restyle,$.relayout=g.relayout,$.redraw=g.redraw,$.update=g.update,$._guiRestyle=g._guiRestyle,$._guiRelayout=g._guiRelayout,$._guiUpdate=g._guiUpdate,$._storeDirectGUIEdit=g._storeDirectGUIEdit,$.react=g.react,$.extendTraces=g.extendTraces,$.prependTraces=g.prependTraces,$.addTraces=g.addTraces,$.deleteTraces=g.deleteTraces,$.moveTraces=g.moveTraces,$.purge=g.purge,$.addFrames=g.addFrames,$.deleteFrames=g.deleteFrames,$.animate=g.animate,$.setPlotConfig=g.setPlotConfig,$.toImage=v("./to_image"),$.validate=v("./validate"),$.downloadImage=v("../snapshot/download");var t=v("./template_api");$.makeTemplate=t.makeTemplate,$.validateTemplate=t.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(v,Q,$){"use strict";var g=v("../lib/is_plain_object"),t=v("../lib/noop"),k=v("../lib/loggers"),x=v("../lib/search").sorterAsc,e=v("../registry");$.containerArrayMatch=v("./container_array_match");var r=$.isAddVal=function(c){return"add"===c||g(c)},i=$.isRemoveVal=function(c){return null===c||"remove"===c};$.applyContainerArrayChanges=function(c,n,m,p,s){var f=n.astr,l=e.getComponentMethod(f,"supplyLayoutDefaults"),o=e.getComponentMethod(f,"draw"),d=e.getComponentMethod(f,"drawOne"),u=p.replot||p.recalc||l===t||o===t,a=c.layout,y=c._fullLayout;if(m[""]){Object.keys(m).length>1&&k.warn("Full array edits are incompatible with other edits",f);var h=m[""][""];if(i(h))n.set(null);else{if(!Array.isArray(h))return k.warn("Unrecognized full array edit value",f,h),!0;n.set(h)}return!u&&(l(a,y),o(c),!0)}var _,b,w,T,L,M,P,S=Object.keys(m).map(Number).sort(x),C=n.get(),R=C||[],D=s(y,f).get(),j=[],q=-1,Z=R.length;for(_=0;_<S.length;_++)if(T=m[w=S[_]],L=Object.keys(T),P=r(M=T[""]),w<0||w>R.length-(P?0:1))k.warn("index out of range",f,w);else if(void 0!==M)L.length>1&&k.warn("Insertion & removal are incompatible with edits to the same index.",f,w),i(M)?j.push(w):P?("add"===M&&(M={}),R.splice(w,0,M),D&&D.splice(w,0,{})):k.warn("Unrecognized full object edit value",f,w,M),-1===q&&(q=w);else for(b=0;b<L.length;b++)s(R[w],L[b],f+"["+w+"].").set(T[L[b]]);for(_=j.length-1;_>=0;_--)R.splice(j[_],1),D&&D.splice(j[_],1);if(R.length?C||n.set(R):n.set(null),u)return!1;if(l(a,y),d!==t){var W;if(-1===q)W=S;else{for(Z=Math.max(R.length,Z),W=[],_=0;_<S.length&&!((w=S[_])>=q);_++)W.push(w);for(_=q;_<Z;_++)W.push(_)}for(_=0;_<W.length;_++)d(c,W[_])}else o(c);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("has-hover"),x=v("../lib"),e=x.nestedProperty,r=v("../lib/events"),i=v("../lib/queue"),c=v("../registry"),n=v("./plot_schema"),m=v("../plots/plots"),p=v("../plots/cartesian/axes"),s=v("../components/drawing"),f=v("../components/color"),l=v("../plots/cartesian/graph_interact").initInteractions,o=v("../constants/xmlns_namespaces"),d=v("../components/selections").clearOutline,u=v("./plot_config").dfltConfig,a=v("./manage_arrays"),y=v("./helpers"),h=v("./subroutines"),_=v("./edit_types"),b=v("../plots/cartesian/constants").AX_NAME_PATTERN,w=0;function T(se){var de=se._fullLayout;de._redrawFromAutoMarginCount?de._redrawFromAutoMarginCount--:se.emit("plotly_afterplot")}function L(se,de){try{se._fullLayout._paper.style("background",de)}catch(Ae){x.error(Ae)}}function M(se,de){L(se,f.combine(de,"white"))}function P(se,de){if(!se._context){se._context=x.extendDeep({},u);var Ae=g.select("base");se._context._baseUrl=Ae.size()&&Ae.attr("href")?window.location.href.split("#")[0]:""}var Le,Me,De,Oe=se._context;if(de){for(Me=Object.keys(de),Le=0;Le<Me.length;Le++)"editable"!==(De=Me[Le])&&"edits"!==De&&De in Oe&&(Oe[De]="setBackground"===De&&"opaque"===de[De]?M:de[De]);de.plot3dPixelRatio&&!Oe.plotGlPixelRatio&&(Oe.plotGlPixelRatio=Oe.plot3dPixelRatio);var Ie=de.editable;if(void 0!==Ie)for(Oe.editable=Ie,Me=Object.keys(Oe.edits),Le=0;Le<Me.length;Le++)Oe.edits[Me[Le]]=Ie;if(de.edits)for(Me=Object.keys(de.edits),Le=0;Le<Me.length;Le++)(De=Me[Le])in Oe.edits&&(Oe.edits[De]=de.edits[De]);Oe._exportedPlot=de._exportedPlot}Oe.staticPlot&&(Oe.editable=!1,Oe.edits={},Oe.autosizable=!1,Oe.scrollZoom=!1,Oe.doubleClick=!1,Oe.showTips=!1,Oe.showLink=!1,Oe.displayModeBar=!1),"hover"!==Oe.displayModeBar||k||(Oe.displayModeBar=!0),"transparent"!==Oe.setBackground&&"function"==typeof Oe.setBackground||(Oe.setBackground=L),Oe._hasZeroHeight=Oe._hasZeroHeight||0===se.clientHeight,Oe._hasZeroWidth=Oe._hasZeroWidth||0===se.clientWidth;var Qe=Oe.scrollZoom,Ne=Oe._scrollZoom={};if(!0===Qe)Ne.cartesian=1,Ne.gl3d=1,Ne.geo=1,Ne.mapbox=1;else if("string"==typeof Qe){var Pe=Qe.split("+");for(Le=0;Le<Pe.length;Le++)Ne[Pe[Le]]=1}else!1!==Qe&&(Ne.gl3d=1,Ne.geo=1,Ne.mapbox=1)}function z(se,de){var Ae,Le,Me=de+1,De=[];for(Ae=0;Ae<se.length;Ae++)(Le=se[Ae])<0?De.push(Me+Le):De.push(Le);return De}function S(se,de,Ae){var Le,Me;for(Le=0;Le<de.length;Le++){if((Me=de[Le])!==parseInt(Me,10))throw new Error("all values in "+Ae+" must be integers");if(Me>=se.data.length||Me<-se.data.length)throw new Error(Ae+" must be valid indices for gd.data.");if(de.indexOf(Me,Le+1)>-1||Me>=0&&de.indexOf(-se.data.length+Me)>-1||Me<0&&de.indexOf(se.data.length+Me)>-1)throw new Error("each index in "+Ae+" must be unique.")}}function C(se,de,Ae){if(!Array.isArray(se.data))throw new Error("gd.data must be an array.");if(void 0===de)throw new Error("currentIndices is a required argument.");if(Array.isArray(de)||(de=[de]),S(se,de,"currentIndices"),void 0===Ae||Array.isArray(Ae)||(Ae=[Ae]),void 0!==Ae&&S(se,Ae,"newIndices"),void 0!==Ae&&de.length!==Ae.length)throw new Error("current and new indices must be of equal length.")}function R(se,de,Ae,Le,Me){!function(Ge,tt,ct,wt){var kt=x.isPlainObject(wt);if(!Array.isArray(Ge.data))throw new Error("gd.data must be an array");if(!x.isPlainObject(tt))throw new Error("update must be a key:value object");if(void 0===ct)throw new Error("indices must be an integer or array of integers");for(var gt in S(Ge,ct,"indices"),tt){if(!Array.isArray(tt[gt])||tt[gt].length!==ct.length)throw new Error("attribute "+gt+" must be an array of length equal to indices array length");if(kt&&(!(gt in wt)||!Array.isArray(wt[gt])||wt[gt].length!==tt[gt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(se,de,Ae,Le);for(var De=function(Ge,tt,ct,wt){var gt,at,et,yt,Vt=x.isPlainObject(wt),Gt=[];for(var en in Array.isArray(ct)||(ct=[ct]),ct=z(ct,Ge.data.length-1),tt)for(var Jt=0;Jt<ct.length;Jt++){if(gt=(at=e(Ge.data[ct[Jt]],en)).get(),!x.isArrayOrTypedArray(et=tt[en][Jt]))throw new Error("attribute: "+en+" index: "+Jt+" must be an array");if(!x.isArrayOrTypedArray(gt))throw new Error("cannot extend missing or non-array attribute: "+en);if(gt.constructor!==et.constructor)throw new Error("cannot extend array with an array of a different type: "+en);t(yt=Vt?wt[en][Jt]:wt)||(yt=-1),Gt.push({prop:at,target:gt,insert:et,maxp:Math.floor(yt)})}return Gt}(se,de,Ae,Le),Oe={},Ie={},Qe=0;Qe<De.length;Qe++){var Ne=De[Qe].prop,Re=Me(De[Qe].target,De[Qe].insert,De[Qe].maxp);Ne.set(Re[0]),Array.isArray(Oe[Ne.astr])||(Oe[Ne.astr]=[]),Oe[Ne.astr].push(Re[1]),Array.isArray(Ie[Ne.astr])||(Ie[Ne.astr]=[]),Ie[Ne.astr].push(De[Qe].target.length)}return{update:Oe,maxPoints:Ie}}function D(se,de){var Ae=new se.constructor(se.length+de.length);return Ae.set(se),Ae.set(de,se.length),Ae}function j(se,de,Ae,Le){se=x.getGraphDiv(se),y.clearPromiseQueue(se);var Me={};if("string"==typeof de)Me[de]=Ae;else{if(!x.isPlainObject(de))return x.warn("Restyle fail.",de,Ae,Le),Promise.reject();Me=x.extendFlat({},de),void 0===Le&&(Le=Ae)}Object.keys(Me).length&&(se.changed=!0);var De=y.coerceTraceIndices(se,Le),Oe=G(se,Me,De),Ie=Oe.flags;Ie.calc&&(se.calcdata=void 0),Ie.clearAxisTypes&&y.clearAxisTypes(se,De,{});var Qe=[];Ie.fullReplot?Qe.push($._doPlot):(Qe.push(m.previousPromises),m.supplyDefaults(se),Ie.markerSize&&(m.doCalcdata(se),N(Qe)),Ie.style&&Qe.push(h.doTraceStyle),Ie.colorbars&&Qe.push(h.doColorBars),Qe.push(T)),Qe.push(m.rehover,m.redrag,m.reselect),i.add(se,j,[se,Oe.undoit,Oe.traces],j,[se,Oe.redoit,Oe.traces]);var Ne=x.syncOrAsync(Qe,se);return Ne&&Ne.then||(Ne=Promise.resolve()),Ne.then(function(){return se.emit("plotly_restyle",Oe.eventData),se})}function q(se){return void 0===se?null:se}function Z(se,de){return de?function(Ae,Le,Me){var De=e(Ae,Le),Oe=De.set;return De.set=function(Ie){W((Me||"")+Le,De.get(),Ie,se),Oe(Ie)},De}:e}function W(se,de,Ae,Le){if(Array.isArray(de)||Array.isArray(Ae))for(var Me=Array.isArray(de)?de:[],De=Array.isArray(Ae)?Ae:[],Oe=Math.max(Me.length,De.length),Ie=0;Ie<Oe;Ie++)W(se+"["+Ie+"]",Me[Ie],De[Ie],Le);else if(x.isPlainObject(de)||x.isPlainObject(Ae)){var Qe=x.isPlainObject(de)?de:{},Ne=x.isPlainObject(Ae)?Ae:{},Pe=x.extendFlat({},Qe,Ne);for(var Re in Pe)W(se+"."+Re,Qe[Re],Ne[Re],Le)}else void 0===Le[se]&&(Le[se]=q(de))}function G(se,de,Ae){var Le,Me=se._fullLayout,De=se._fullData,Oe=se.data,Ie=Me._guiEditing,Qe=Z(Me._preGUI,Ie),Ne=x.extendDeepAll({},de);X(de);var Pe,Re=_.traceFlags(),Ge={},tt={};function ct(){return Ae.map(function(){})}function wt(st){var dt=p.id2name(st);-1===Pe.indexOf(dt)&&Pe.push(dt)}function kt(st){return"LAYOUT"+st+".autorange"}function gt(st){return"LAYOUT"+st+".range"}function at(st){for(var dt=st;dt<De.length;dt++)if(De[dt]._input===Oe[st])return De[dt]}function et(st,dt,zt){if(Array.isArray(st))st.forEach(function(Zt){et(Zt,dt,zt)});else if(!(st in de)&&!y.hasParent(de,st)){var Ht;if("LAYOUT"===st.substr(0,6))Ht=Qe(se.layout,st.replace("LAYOUT",""));else{var Kt=Ae[zt];Ht=Z(Me._tracePreGUI[at(Kt)._fullInput.uid],Ie)(Oe[Kt],st)}st in tt||(tt[st]=ct()),void 0===tt[st][zt]&&(tt[st][zt]=q(Ht.get())),void 0!==dt&&Ht.set(dt)}}function yt(st){return function(dt){return De[dt][st]}}function Vt(st){return function(dt,zt){return!1===dt?De[Ae[zt]][st]:null}}for(var Gt in de){if(y.hasParent(de,Gt))throw new Error("cannot set "+Gt+" and a parent attribute simultaneously");var en,Jt,cn,Rt,je,Ye,he=de[Gt];if("autobinx"!==Gt&&"autobiny"!==Gt||(Gt=Gt.charAt(Gt.length-1)+"bins",he=Array.isArray(he)?he.map(Vt(Gt)):!1===he?Ae.map(yt(Gt)):null),Ge[Gt]=he,"LAYOUT"!==Gt.substr(0,6)){for(tt[Gt]=ct(),Le=0;Le<Ae.length;Le++)if(en=Oe[Ae[Le]],Jt=at(Ae[Le]),Rt=(cn=Z(Me._tracePreGUI[Jt._fullInput.uid],Ie)(en,Gt)).get(),void 0!==(je=Array.isArray(he)?he[Le%he.length]:he)){var be=cn.parts[cn.parts.length-1],Fe=Gt.substr(0,Gt.length-be.length-1),He=Fe?Fe+".":"",Ke=Fe?e(Jt,Fe).get():Jt;if((Ye=n.getTraceValObject(Jt,cn.parts))&&Ye.impliedEdits&&null!==je)for(var Ze in Ye.impliedEdits)et(x.relativeAttr(Gt,Ze),Ye.impliedEdits[Ze],Le);else if("thicknessmode"!==be&&"lenmode"!==be||Rt===je||"fraction"!==je&&"pixels"!==je||!Ke){if("type"===Gt&&("pie"===je!=("pie"===Rt)||"funnelarea"===je!=("funnelarea"===Rt))){var ut="x",lt="y";"bar"!==je&&"bar"!==Rt||"h"!==en.orientation||(ut="y",lt="x"),x.swapAttrs(en,["?","?src"],"labels",ut),x.swapAttrs(en,["d?","?0"],"label",ut),x.swapAttrs(en,["?","?src"],"values",lt),"pie"===Rt||"funnelarea"===Rt?(e(en,"marker.color").set(e(en,"marker.colors").get()),Me._pielayer.selectAll("g.trace").remove()):c.traceIs(en,"cartesian")&&e(en,"marker.colors").set(e(en,"marker.color").get())}}else{var Lt=Me._size,Ot=Ke.orient,ot="top"===Ot||"bottom"===Ot;if("thicknessmode"===be){var pt=ot?Lt.h:Lt.w;et(He+"thickness",Ke.thickness*("fraction"===je?1/pt:pt),Le)}else{var qt=ot?Lt.w:Lt.h;et(He+"len",Ke.len*("fraction"===je?1/qt:qt),Le)}}if(tt[Gt][Le]=q(Rt),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(Gt)){if("orientation"===Gt){cn.set(je);var St=en.x&&!en.y?"h":"v";if((cn.get()||St)===Jt.orientation)continue}else"orientationaxes"===Gt&&(en.orientation={v:"h",h:"v"}[Jt.orientation]);y.swapXYData(en),Re.calc=Re.clearAxisTypes=!0}else-1!==m.dataArrayContainers.indexOf(cn.parts[0])?(y.manageArrayContainers(cn,je,tt),Re.calc=!0):(Ye?Ye.arrayOk&&!c.traceIs(Jt,"regl")&&(x.isArrayOrTypedArray(je)||x.isArrayOrTypedArray(Rt))?Re.calc=!0:_.update(Re,Ye):Re.calc=!0,cn.set(je))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(Gt)&&p.swap(se,Ae),"orientationaxes"===Gt){var Mt=e(se.layout,"hovermode"),Ce=Mt.get();"x"===Ce?Mt.set("y"):"y"===Ce?Mt.set("x"):"x unified"===Ce?Mt.set("y unified"):"y unified"===Ce&&Mt.set("x unified")}if(-1!==["orientation","type"].indexOf(Gt)){for(Pe=[],Le=0;Le<Ae.length;Le++){var Xe=Oe[Ae[Le]];c.traceIs(Xe,"cartesian")&&(wt(Xe.xaxis||"x"),wt(Xe.yaxis||"y"))}et(Pe.map(kt),!0,0),et(Pe.map(gt),[0,1],0)}}else cn=Qe(se.layout,Gt.replace("LAYOUT","")),tt[Gt]=[q(cn.get())],cn.set(Array.isArray(he)?he[0]:he),Re.calc=!0}return(Re.calc||Re.plot)&&(Re.fullReplot=!0),{flags:Re,undoit:tt,redoit:Ge,traces:Ae,eventData:x.extendDeepNoArrays([],[Ne,Ae])}}function X(se){var de,Ae,Le,Me=x.counterRegex("axis",".title",!1,!1),De=/colorbar\.title$/,Oe=Object.keys(se);for(de=0;de<Oe.length;de++)Le=se[Ae=Oe[de]],"title"!==Ae&&!Me.test(Ae)&&!De.test(Ae)||"string"!=typeof Le&&"number"!=typeof Le?Ae.indexOf("titlefont")>-1&&-1===Ae.indexOf("grouptitlefont")?Ie(Ae,Ae.replace("titlefont","title.font")):Ae.indexOf("titleposition")>-1?Ie(Ae,Ae.replace("titleposition","title.position")):Ae.indexOf("titleside")>-1?Ie(Ae,Ae.replace("titleside","title.side")):Ae.indexOf("titleoffset")>-1&&Ie(Ae,Ae.replace("titleoffset","title.offset")):Ie(Ae,Ae.replace("title","title.text"));function Ie(Qe,Ne){se[Ne]=se[Qe],delete se[Qe]}}function ne(se,de,Ae){se=x.getGraphDiv(se),y.clearPromiseQueue(se);var Le={};if("string"==typeof de)Le[de]=Ae;else{if(!x.isPlainObject(de))return x.warn("Relayout fail.",de,Ae),Promise.reject();Le=x.extendFlat({},de)}Object.keys(Le).length&&(se.changed=!0);var Me=K(se,Le),De=Me.flags;De.calc&&(se.calcdata=void 0);var Oe=[m.previousPromises];De.layoutReplot?Oe.push(h.layoutReplot):Object.keys(Le).length&&(V(se,De,Me)||m.supplyDefaults(se),De.legend&&Oe.push(h.doLegend),De.layoutstyle&&Oe.push(h.layoutStyles),De.axrange&&N(Oe,Me.rangesAltered),De.ticks&&Oe.push(h.doTicksRelayout),De.modebar&&Oe.push(h.doModeBar),De.camera&&Oe.push(h.doCamera),De.colorbars&&Oe.push(h.doColorBars),Oe.push(T)),Oe.push(m.rehover,m.redrag,m.reselect),i.add(se,ne,[se,Me.undoit],ne,[se,Me.redoit]);var Ie=x.syncOrAsync(Oe,se);return Ie&&Ie.then||(Ie=Promise.resolve(se)),Ie.then(function(){return se.emit("plotly_relayout",Me.eventData),se})}function V(se,de,Ae){var Le=se._fullLayout;if(!de.axrange)return!1;for(var Me in de)if("axrange"!==Me&&de[Me])return!1;for(var De in Ae.rangesAltered){var Oe=p.id2name(De),Ie=se.layout[Oe],Qe=Le[Oe];if(Qe.autorange=Ie.autorange,Ie.range&&(Qe.range=Ie.range.slice()),Qe.cleanRange(),Qe._matchGroup)for(var Ne in Qe._matchGroup)if(Ne!==De){var Pe=Le[p.id2name(Ne)];Pe.autorange=Qe.autorange,Pe.range=Qe.range.slice(),Pe._input.range=Qe.range.slice()}}return!0}function N(se,de){se.push(d,h.doAutoRangeAndConstraints,de?function(Le){var Me=[];for(var De in de){var Oe=p.getFromId(Le,De);if(Me.push(De),-1!==(Oe.ticklabelposition||"").indexOf("inside")&&Oe._anchorAxis&&Me.push(Oe._anchorAxis._id),Oe._matchGroup)for(var Ie in Oe._matchGroup)de[Ie]||Me.push(Ie)}return p.draw(Le,Me,{skipTitle:!0})}:function(Le){return p.draw(Le,"redraw")},h.drawData,h.finalDraw)}var U=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,B=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function K(se,de){var Ae,Le,Me,De=se.layout,Oe=se._fullLayout,Qe=Z(Oe._preGUI,Oe._guiEditing),Ne=Object.keys(de),Pe=p.list(se),Re=x.extendDeepAll({},de),Ge={};for(X(de),Ne=Object.keys(de),Le=0;Le<Ne.length;Le++)if(0===Ne[Le].indexOf("allaxes")){for(Me=0;Me<Pe.length;Me++){var tt=Pe[Me]._id.substr(1),ct=-1!==tt.indexOf("scene")?tt+".":"",wt=Ne[Le].replace("allaxes",ct+Pe[Me]._name);de[wt]||(de[wt]=de[Ne[Le]])}delete de[Ne[Le]]}var kt=_.layoutFlags(),gt={},at={};function et(Kt,Zt){if(Array.isArray(Kt))Kt.forEach(function(zn){et(zn,Zt)});else if(!(Kt in de)&&!y.hasParent(de,Kt)){var vn=Qe(De,Kt);Kt in at||(at[Kt]=q(vn.get())),void 0!==Zt&&vn.set(Zt)}}var yt,Vt={};function Gt(Kt){var Zt=p.name2id(Kt.split(".")[0]);return Vt[Zt]=1,Zt}for(var en in de){if(y.hasParent(de,en))throw new Error("cannot set "+en+" and a parent attribute simultaneously");for(var Jt=Qe(De,en),cn=de[en],Rt=Jt.parts.length-1;Rt>0&&"string"!=typeof Jt.parts[Rt];)Rt--;var je=Jt.parts[Rt],Ye=Jt.parts[Rt-1]+"."+je,he=Jt.parts.slice(0,Rt).join("."),be=e(se.layout,he).get(),Fe=e(Oe,he).get(),He=Jt.get();if(void 0!==cn){gt[en]=cn,at[en]="reverse"===je?cn:q(He);var Ke=n.getLayoutValObject(Oe,Jt.parts);if(Ke&&Ke.impliedEdits&&null!==cn)for(var Ze in Ke.impliedEdits)et(x.relativeAttr(en,Ze),Ke.impliedEdits[Ze]);if(-1!==["width","height"].indexOf(en))if(cn){et("autosize",null);var ut="height"===en?"width":"height";et(ut,Oe[ut])}else Oe[en]=se._initialAutoSize[en];else if("autosize"===en)et("width",cn?null:Oe.width),et("height",cn?null:Oe.height);else if(Ye.match(U))Gt(Ye),e(Oe,he+"._inputRange").set(null);else if(Ye.match(ee)){Gt(Ye),e(Oe,he+"._inputRange").set(null);var lt=e(Oe,he).get();lt._inputDomain&&(lt._input.domain=lt._inputDomain.slice())}else Ye.match(B)&&e(Oe,he+"._inputDomain").set(null);if("type"===je){yt=be;var Lt="linear"===Fe.type&&"log"===cn;if(Lt||"log"===Fe.type&&"linear"===cn){if(yt&&yt.range)if(Fe.autorange)Lt&&(yt.range=yt.range[1]>yt.range[0]?[1,2]:[2,1]);else{var ot=yt.range[0],pt=yt.range[1];Lt?(ot<=0&&pt<=0&&et(he+".autorange",!0),ot<=0?ot=pt/1e6:pt<=0&&(pt=ot/1e6),et(he+".range[0]",Math.log(ot)/Math.LN10),et(he+".range[1]",Math.log(pt)/Math.LN10)):(et(he+".range[0]",Math.pow(10,ot)),et(he+".range[1]",Math.pow(10,pt)))}else et(he+".autorange",!0);Array.isArray(Oe._subplots.polar)&&Oe._subplots.polar.length&&Oe[Jt.parts[0]]&&"radialaxis"===Jt.parts[1]&&delete Oe[Jt.parts[0]]._subplot.viewInitial["radialaxis.range"],c.getComponentMethod("annotations","convertCoords")(se,Fe,cn,et),c.getComponentMethod("images","convertCoords")(se,Fe,cn,et)}else et(he+".autorange",!0),et(he+".range",null);e(Oe,he+"._inputRange").set(null)}else if(je.match(b)){var qt=e(Oe,en).get(),St=(cn||{}).type;St&&"-"!==St||(St="linear"),c.getComponentMethod("annotations","convertCoords")(se,qt,St,et),c.getComponentMethod("images","convertCoords")(se,qt,St,et)}var Mt=a.containerArrayMatch(en);if(Mt){Ae=Mt.array;var Ce=Mt.property,Xe=Ke||{editType:"calc"};""!==(Le=Mt.index)&&""===Ce&&(a.isAddVal(cn)?at[en]=null:a.isRemoveVal(cn)?at[en]=(e(De,Ae).get()||[])[Le]:x.warn("unrecognized full object value",de)),_.update(kt,Xe),Ge[Ae]||(Ge[Ae]={});var st=Ge[Ae][Le];st||(st=Ge[Ae][Le]={}),st[Ce]=cn,delete de[en]}else"reverse"===je?(be.range?be.range.reverse():(et(he+".autorange",!0),be.range=[1,0]),Fe.autorange?kt.calc=!0:kt.plot=!0):("dragmode"===en&&(!1===cn&&!1!==He||!1!==cn&&!1===He)||Oe._has("scatter-like")&&Oe._has("regl")&&"dragmode"===en&&("lasso"===cn||"select"===cn)&&"lasso"!==He&&"select"!==He||Oe._has("gl2d")?kt.plot=!0:Ke?_.update(kt,Ke):kt.calc=!0,Jt.set(cn))}}for(Ae in Ge)a.applyContainerArrayChanges(se,Qe(De,Ae),Ge[Ae],kt,Qe)||(kt.plot=!0);for(var dt in Vt){var zt=(yt=p.getFromId(se,dt))&&yt._constraintGroup;if(zt)for(var Ht in kt.calc=!0,zt)Vt[Ht]||(p.getFromId(se,Ht)._constraintShrinkable=!0)}return(J(se)||de.height||de.width)&&(kt.plot=!0),(kt.plot||kt.calc)&&(kt.layoutReplot=!0),{flags:kt,rangesAltered:Vt,undoit:at,redoit:gt,eventData:Re}}function J(se){var de=se._fullLayout,Ae=de.width,Le=de.height;return se.layout.autosize&&m.plotAutoSize(se,se.layout,de),de.width!==Ae||de.height!==Le}function te(se,de,Ae,Le){se=x.getGraphDiv(se),y.clearPromiseQueue(se),x.isPlainObject(de)||(de={}),x.isPlainObject(Ae)||(Ae={}),Object.keys(de).length&&(se.changed=!0),Object.keys(Ae).length&&(se.changed=!0);var Me=y.coerceTraceIndices(se,Le),De=G(se,x.extendFlat({},de),Me),Oe=De.flags,Ie=K(se,x.extendFlat({},Ae)),Qe=Ie.flags;(Oe.calc||Qe.calc)&&(se.calcdata=void 0),Oe.clearAxisTypes&&y.clearAxisTypes(se,Me,Ae);var Ne=[];Qe.layoutReplot?Ne.push(h.layoutReplot):Oe.fullReplot?Ne.push($._doPlot):(Ne.push(m.previousPromises),V(se,Qe,Ie)||m.supplyDefaults(se),Oe.style&&Ne.push(h.doTraceStyle),(Oe.colorbars||Qe.colorbars)&&Ne.push(h.doColorBars),Qe.legend&&Ne.push(h.doLegend),Qe.layoutstyle&&Ne.push(h.layoutStyles),Qe.axrange&&N(Ne,Ie.rangesAltered),Qe.ticks&&Ne.push(h.doTicksRelayout),Qe.modebar&&Ne.push(h.doModeBar),Qe.camera&&Ne.push(h.doCamera),Ne.push(T)),Ne.push(m.rehover,m.redrag,m.reselect),i.add(se,te,[se,De.undoit,Ie.undoit,De.traces],te,[se,De.redoit,Ie.redoit,De.traces]);var Pe=x.syncOrAsync(Ne,se);return Pe&&Pe.then||(Pe=Promise.resolve(se)),Pe.then(function(){return se.emit("plotly_update",{data:De.eventData,layout:Ie.eventData}),se})}function ae(se){return function(de){de._fullLayout._guiEditing=!0;var Ae=se.apply(null,arguments);return de._fullLayout._guiEditing=!1,Ae}}var ce=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],oe=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function ve(se,de){for(var Ae=0;Ae<de.length;Ae++){var Le=de[Ae],Me=se.match(Le.pattern);if(Me){var De=Me[1]||"";return{head:De,tail:se.substr(De.length+1),attr:Le.attr}}}}function fe(se,de){var Ae=e(de,se).get();if(void 0!==Ae)return Ae;var Le=se.split(".");for(Le.pop();Le.length>1;)if(Le.pop(),void 0!==(Ae=e(de,Le.join(".")+".uirevision").get()))return Ae;return de.uirevision}function xe(se,de){for(var Ae=0;Ae<de.length;Ae++)if(de[Ae]._fullInput.uid===se)return Ae;return-1}function Se(se,de,Ae){for(var Le=0;Le<de.length;Le++)if(de[Le].uid===se)return Le;return!de[Ae]||de[Ae].uid?-1:Ae}function pe(se,de){var Ae=x.isPlainObject(se),Le=Array.isArray(se);return Ae||Le?(Ae&&x.isPlainObject(de)||Le&&Array.isArray(de))&&JSON.stringify(se)===JSON.stringify(de):se===de}function ge(se,de,Ae,Le){var Me,De,Oe,Ie=Le.getValObject,Qe=Le.flags,Ne=Le.immutable,Pe=Le.inArray,Re=Le.arrayIndex;function Ge(){var be=Me.editType;Pe&&-1!==be.indexOf("arraydraw")?x.pushUnique(Qe.arrays[Pe],Re):(_.update(Qe,Me),"none"!==be&&Qe.nChanges++,Le.transition&&Me.anim&&Qe.nChangesAnim++,(U.test(Oe)||ee.test(Oe))&&(Qe.rangesAltered[Ae[0]]=1),B.test(Oe)&&e(de,"_inputDomain").set(null),"datarevision"===De&&(Qe.newDataRevision=1))}function tt(be){return"data_array"===be.valType||be.arrayOk}for(De in se){if(Qe.calc&&!Le.transition)return;var ct=se[De],wt=de[De],kt=Ae.concat(De);if(Oe=kt.join("."),"_"!==De.charAt(0)&&"function"!=typeof ct&&ct!==wt){if(("tick0"===De||"dtick"===De)&&"geo"!==Ae[0]){var gt=de.tickmode;if("auto"===gt||"array"===gt||!gt)continue}if(("range"!==De||!de.autorange)&&("zmin"!==De&&"zmax"!==De||"contourcarpet"!==de.type)&&(Me=Ie(kt))&&(!Me._compareAsJSON||JSON.stringify(ct)!==JSON.stringify(wt))){var at,et=Me.valType,yt=tt(Me),Vt=Array.isArray(ct),Gt=Array.isArray(wt);if(Vt&&Gt){var en="_input_"+De,Jt=se[en],cn=de[en];if(Array.isArray(Jt)&&Jt===cn)continue}if(void 0===wt)yt&&Vt?Qe.calc=!0:Ge();else if(Me._isLinkedToArray){var Rt=[],je=!1;Pe||(Qe.arrays[De]=Rt);var Ye=Math.min(ct.length,wt.length),he=Math.max(ct.length,wt.length);if(Ye!==he){if("arraydraw"!==Me.editType){Ge();continue}je=!0}for(at=0;at<Ye;at++)ge(ct[at],wt[at],kt.concat(at),x.extendFlat({inArray:De,arrayIndex:at},Le));if(je)for(at=Ye;at<he;at++)Rt.push(at)}else!et&&x.isPlainObject(ct)?ge(ct,wt,kt,Le):yt?Vt&&Gt?(Ne&&(Qe.calc=!0),(Ne||Le.newDataRevision)&&Ge()):Vt!==Gt?Qe.calc=!0:Ge():Vt&&Gt&&ct.length===wt.length&&String(ct)===String(wt)||Ge()}}}for(De in de)if(!(De in se)&&"_"!==De.charAt(0)&&"function"!=typeof de[De]){if(tt(Me=Ie(Ae.concat(De)))&&Array.isArray(de[De]))return void(Qe.calc=!0);Ge()}}function Te(se){var de=se._fullLayout,Ae=se.getBoundingClientRect();if(!x.equalDomRects(Ae,de._lastBBox)){var Le=de._invTransform=x.inverseTransformMatrix(x.getFullTransformMatrix(se));de._invScaleX=Math.sqrt(Le[0][0]*Le[0][0]+Le[0][1]*Le[0][1]+Le[0][2]*Le[0][2]),de._invScaleY=Math.sqrt(Le[1][0]*Le[1][0]+Le[1][1]*Le[1][1]+Le[1][2]*Le[1][2]),de._lastBBox=Ae}}$.animate=function(se,de,Ae){if(se=x.getGraphDiv(se),!x.isPlotDiv(se))throw new Error("This element is not a Plotly plot: "+se+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Le=se._transitionData;Le._frameQueue||(Le._frameQueue=[]);var Me=(Ae=m.supplyAnimationDefaults(Ae)).transition,De=Ae.frame;function Oe(Ne){return Array.isArray(Me)?Ne>=Me.length?Me[0]:Me[Ne]:Me}function Ie(Ne){return Array.isArray(De)?Ne>=De.length?De[0]:De[Ne]:De}function Qe(Ne,Pe){var Re=0;return function(){if(Ne&&++Re===Pe)return Ne()}}return void 0===Le._frameWaitingCnt&&(Le._frameWaitingCnt=0),new Promise(function(Ne,Pe){function Ge(){se.emit("plotly_animating"),Le._lastFrameAt=-1/0,Le._timeToNext=0,Le._runningTransitions=0,Le._currentFrame=null;var Jt=function(){Le._animationRaf=window.requestAnimationFrame(Jt),Date.now()-Le._lastFrameAt>Le._timeToNext&&function Re(){Le._currentFrame&&Le._currentFrame.onComplete&&Le._currentFrame.onComplete();var Jt=Le._currentFrame=Le._frameQueue.shift();if(Jt){var cn=Jt.name?Jt.name.toString():null;se._fullLayout._currentFrame=cn,Le._lastFrameAt=Date.now(),Le._timeToNext=Jt.frameOpts.duration,m.transition(se,Jt.frame.data,Jt.frame.layout,y.coerceTraceIndices(se,Jt.frame.traces),Jt.frameOpts,Jt.transitionOpts).then(function(){Jt.onComplete&&Jt.onComplete()}),se.emit("plotly_animatingframe",{name:cn,frame:Jt.frame,animation:{frame:Jt.frameOpts,transition:Jt.transitionOpts}})}else se.emit("plotly_animated"),window.cancelAnimationFrame(Le._animationRaf),Le._animationRaf=null}()};Jt()}var tt,ct,wt=0;function kt(Jt){return Jt.transitionOpts=Array.isArray(Me)?wt>=Me.length?Me[wt]:Me[0]:Me,wt++,Jt}var gt=[],at=null==de,et=Array.isArray(de);if(at||et||!x.isPlainObject(de)){if(at||-1!==["string","number"].indexOf(typeof de))for(tt=0;tt<Le._frames.length;tt++)(ct=Le._frames[tt])&&(at||String(ct.group)===String(de))&&gt.push({type:"byname",name:String(ct.name),data:kt({name:ct.name})});else if(et)for(tt=0;tt<de.length;tt++){var yt=de[tt];-1!==["number","string"].indexOf(typeof yt)?(yt=String(yt),gt.push({type:"byname",name:yt,data:kt({name:yt})})):x.isPlainObject(yt)&&gt.push({type:"object",data:kt(x.extendFlat({},yt))})}}else gt.push({type:"object",data:kt(x.extendFlat({},de))});for(tt=0;tt<gt.length;tt++)if("byname"===(ct=gt[tt]).type&&!Le._frameHash[ct.data.name])return x.warn('animate failure: frame not found: "'+ct.data.name+'"'),void Pe();-1!==["next","immediate"].indexOf(Ae.mode)&&function(){if(0!==Le._frameQueue.length){for(;Le._frameQueue.length;){var Jt=Le._frameQueue.pop();Jt.onInterrupt&&Jt.onInterrupt()}se.emit("plotly_animationinterrupted",[])}}(),"reverse"===Ae.direction&&gt.reverse();var Vt=se._fullLayout._currentFrame;if(Vt&&Ae.fromcurrent){var Gt=-1;for(tt=0;tt<gt.length;tt++)if("byname"===(ct=gt[tt]).type&&ct.name===Vt){Gt=tt;break}if(Gt>0&&Gt<gt.length-1){var en=[];for(tt=0;tt<gt.length;tt++)ct=gt[tt],("byname"!==gt[tt].type||tt>Gt)&&en.push(ct);gt=en}}gt.length>0?function(Jt){if(0!==Jt.length){for(var cn=0;cn<Jt.length;cn++){var Rt;Rt="byname"===Jt[cn].type?m.computeFrame(se,Jt[cn].name):Jt[cn].data;var je=Ie(cn),Ye=Oe(cn);Ye.duration=Math.min(Ye.duration,je.duration);var he={frame:Rt,name:Jt[cn].name,frameOpts:je,transitionOpts:Ye};cn===Jt.length-1&&(he.onComplete=Qe(Ne,2),he.onInterrupt=Pe),Le._frameQueue.push(he)}"immediate"===Ae.mode&&(Le._lastFrameAt=-1/0),Le._animationRaf||Ge()}}(gt):(se.emit("plotly_animated"),Ne())})},$.addFrames=function(se,de,Ae){if(se=x.getGraphDiv(se),null==de)return Promise.resolve();if(!x.isPlotDiv(se))throw new Error("This element is not a Plotly plot: "+se+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Le,Me,De,Oe,Ie=se._transitionData._frames,Qe=se._transitionData._frameHash;if(!Array.isArray(de))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+de);var Ne=Ie.length+2*de.length,Pe=[],Re={};for(Le=de.length-1;Le>=0;Le--)if(x.isPlainObject(de[Le])){var Ge=de[Le].name,tt=(Qe[Ge]||Re[Ge]||{}).name,ct=de[Le].name;tt&&ct&&"number"==typeof ct&&(Qe[tt]||Re[tt])&&w<5&&(w++,x.warn('addFrames: overwriting frame "'+(Qe[tt]||Re[tt]).name+'" with a frame whose name of type "number" also equates to "'+tt+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===w&&x.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Re[Ge]={name:Ge},Pe.push({frame:m.supplyFrameDefaults(de[Le]),index:Ae&&null!=Ae[Le]?Ae[Le]:Ne+Le})}Pe.sort(function(en,Jt){return en.index>Jt.index?-1:en.index<Jt.index?1:0});var kt=[],gt=[],at=Ie.length;for(Le=Pe.length-1;Le>=0;Le--){if("number"==typeof(Me=Pe[Le].frame).name&&x.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Me.name)for(;Qe[Me.name="frame "+se._transitionData._counter++];);if(Qe[Me.name]){for(De=0;De<Ie.length&&(Ie[De]||{}).name!==Me.name;De++);kt.push({type:"replace",index:De,value:Me}),gt.unshift({type:"replace",index:De,value:Ie[De]})}else Oe=Math.max(0,Math.min(Pe[Le].index,at)),kt.push({type:"insert",index:Oe,value:Me}),gt.unshift({type:"delete",index:Oe}),at++}return i&&i.add(se,m.modifyFrames,[se,gt],m.modifyFrames,[se,kt]),m.modifyFrames(se,kt)},$.deleteFrames=function(se,de){if(se=x.getGraphDiv(se),!x.isPlotDiv(se))throw new Error("This element is not a Plotly plot: "+se);var Ae,Le,Me=se._transitionData._frames,De=[],Oe=[];if(!de)for(de=[],Ae=0;Ae<Me.length;Ae++)de.push(Ae);for((de=de.slice()).sort(),Ae=de.length-1;Ae>=0;Ae--)De.push({type:"delete",index:Le=de[Ae]}),Oe.unshift({type:"insert",index:Le,value:Me[Le]});return i&&i.add(se,m.modifyFrames,[se,Oe],m.modifyFrames,[se,De]),m.modifyFrames(se,De)},$.addTraces=function se(de,Ae,Le){de=x.getGraphDiv(de);var Me,De,Oe=[],Ie=$.deleteTraces,Qe=se,Ne=[de,Oe],Pe=[de,Ae];for(function(Re,Ge,tt){var ct,wt;if(!Array.isArray(Re.data))throw new Error("gd.data must be an array.");if(void 0===Ge)throw new Error("traces must be defined.");for(Array.isArray(Ge)||(Ge=[Ge]),ct=0;ct<Ge.length;ct++)if("object"!=typeof(wt=Ge[ct])||Array.isArray(wt)||null===wt)throw new Error("all values in traces array must be non-array objects");if(void 0===tt||Array.isArray(tt)||(tt=[tt]),void 0!==tt&&tt.length!==Ge.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(de,Ae,Le),Array.isArray(Ae)||(Ae=[Ae]),Ae=Ae.map(function(Re){return x.extendFlat({},Re)}),y.cleanData(Ae),Me=0;Me<Ae.length;Me++)de.data.push(Ae[Me]);for(Me=0;Me<Ae.length;Me++)Oe.push(-Ae.length+Me);if(void 0===Le)return De=$.redraw(de),i.add(de,Ie,Ne,Qe,Pe),De;Array.isArray(Le)||(Le=[Le]);try{C(de,Oe,Le)}catch(Re){throw de.data.splice(de.data.length-Ae.length,Ae.length),Re}return i.startSequence(de),i.add(de,Ie,Ne,Qe,Pe),De=$.moveTraces(de,Oe,Le),i.stopSequence(de),De},$.deleteTraces=function se(de,Ae){de=x.getGraphDiv(de);var Le,Me,De=[],Oe=$.addTraces,Ie=se,Qe=[de,De,Ae],Ne=[de,Ae];if(void 0===Ae)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ae)||(Ae=[Ae]),S(de,Ae,"indices"),(Ae=z(Ae,de.data.length-1)).sort(x.sorterDes),Le=0;Le<Ae.length;Le+=1)Me=de.data.splice(Ae[Le],1)[0],De.push(Me);var Pe=$.redraw(de);return i.add(de,Oe,Qe,Ie,Ne),Pe},$.extendTraces=function se(de,Ae,Le,Me){function De(Ne,Pe,Re){var Ge,tt;if(x.isTypedArray(Ne))if(Re<0){var ct=new Ne.constructor(0),wt=D(Ne,Pe);Re<0?(Ge=wt,tt=ct):(Ge=ct,tt=wt)}else if(Ge=new Ne.constructor(Re),tt=new Ne.constructor(Ne.length+Pe.length-Re),Re===Pe.length)Ge.set(Pe),tt.set(Ne);else if(Re<Pe.length){var kt=Pe.length-Re;Ge.set(Pe.subarray(kt)),tt.set(Ne),tt.set(Pe.subarray(0,kt),Ne.length)}else{var gt=Re-Pe.length,at=Ne.length-gt;Ge.set(Ne.subarray(at)),Ge.set(Pe,gt),tt.set(Ne.subarray(0,at))}else Ge=Ne.concat(Pe),tt=Re>=0&&Re<Ge.length?Ge.splice(0,Ge.length-Re):[];return[Ge,tt]}var Oe=R(de=x.getGraphDiv(de),Ae,Le,Me,De),Ie=$.redraw(de);return i.add(de,$.prependTraces,[de,Oe.update,Le,Oe.maxPoints],se,arguments),Ie},$.moveTraces=function se(de,Ae,Le){var Me,De=[],Oe=[],Ie=se,Qe=se,Ne=[de=x.getGraphDiv(de),Le,Ae],Pe=[de,Ae,Le];if(C(de,Ae,Le),Ae=Array.isArray(Ae)?Ae:[Ae],void 0===Le)for(Le=[],Me=0;Me<Ae.length;Me++)Le.push(-Ae.length+Me);for(Le=Array.isArray(Le)?Le:[Le],Ae=z(Ae,de.data.length-1),Le=z(Le,de.data.length-1),Me=0;Me<de.data.length;Me++)-1===Ae.indexOf(Me)&&De.push(de.data[Me]);for(Me=0;Me<Ae.length;Me++)Oe.push({newIndex:Le[Me],trace:de.data[Ae[Me]]});for(Oe.sort(function(Ge,tt){return Ge.newIndex-tt.newIndex}),Me=0;Me<Oe.length;Me+=1)De.splice(Oe[Me].newIndex,0,Oe[Me].trace);de.data=De;var Re=$.redraw(de);return i.add(de,Ie,Ne,Qe,Pe),Re},$.prependTraces=function se(de,Ae,Le,Me){function De(Ne,Pe,Re){var Ge,tt;if(x.isTypedArray(Ne))if(Re<=0){var ct=new Ne.constructor(0),wt=D(Pe,Ne);Re<0?(Ge=wt,tt=ct):(Ge=ct,tt=wt)}else if(Ge=new Ne.constructor(Re),tt=new Ne.constructor(Ne.length+Pe.length-Re),Re===Pe.length)Ge.set(Pe),tt.set(Ne);else if(Re<Pe.length){var kt=Pe.length-Re;Ge.set(Pe.subarray(0,kt)),tt.set(Pe.subarray(kt)),tt.set(Ne,kt)}else{var gt=Re-Pe.length;Ge.set(Pe),Ge.set(Ne.subarray(0,gt),Pe.length),tt.set(Ne.subarray(gt))}else Ge=Pe.concat(Ne),tt=Re>=0&&Re<Ge.length?Ge.splice(Re,Ge.length):[];return[Ge,tt]}var Oe=R(de=x.getGraphDiv(de),Ae,Le,Me,De),Ie=$.redraw(de);return i.add(de,$.extendTraces,[de,Oe.update,Le,Oe.maxPoints],se,arguments),Ie},$.newPlot=function(se,de,Ae,Le){return se=x.getGraphDiv(se),m.cleanPlot([],{},se._fullData||[],se._fullLayout||{}),m.purge(se),$._doPlot(se,de,Ae,Le)},$._doPlot=function(se,de,Ae,Le){var Me;if(se=x.getGraphDiv(se),r.init(se),x.isPlainObject(de)){var De=de;de=De.data,Ae=De.layout,Le=De.config,Me=De.frames}if(!1===r.triggerHandler(se,"plotly_beforeplot",[de,Ae,Le]))return Promise.reject();de||Ae||x.isPlotDiv(se)||x.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",se),P(se,Le),Ae||(Ae={}),g.select(se).classed("js-plotly-plot",!0),s.makeTester(),Array.isArray(se._promises)||(se._promises=[]);var Oe=0===(se.data||[]).length&&Array.isArray(de);Array.isArray(de)&&(y.cleanData(de),Oe?se.data=de:se.data.push.apply(se.data,de),se.empty=!1),se.layout&&!Oe||(se.layout=y.cleanLayout(Ae)),m.supplyDefaults(se);var Ie=se._fullLayout,Qe=Ie._has("cartesian");Ie._replotting=!0,(Oe||Ie._shouldCreateBgLayer)&&(function(gt){var at=g.select(gt),et=gt._fullLayout;if(et._calcInverseTransform=Te,et._calcInverseTransform(gt),et._container=at.selectAll(".plot-container").data([0]),et._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),et._paperdiv=et._container.selectAll(".svg-container").data([0]),et._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),et._glcontainer=et._paperdiv.selectAll(".gl-container").data([{}]),et._glcontainer.enter().append("div").classed("gl-container",!0),et._paperdiv.selectAll(".main-svg").remove(),et._paperdiv.select(".modebar-container").remove(),et._paper=et._paperdiv.insert("svg",":first-child").classed("main-svg",!0),et._toppaper=et._paperdiv.append("svg").classed("main-svg",!0),et._modebardiv=et._paperdiv.append("div"),delete et._modeBar,et._hoverpaper=et._paperdiv.append("svg").classed("main-svg",!0),!et._uid){var yt={};g.selectAll("defs").each(function(){this.id&&(yt[this.id.split("-")[1]]=1)}),et._uid=x.randstr(yt)}et._paperdiv.selectAll(".main-svg").attr(o.svgAttrs),et._defs=et._paper.append("defs").attr("id","defs-"+et._uid),et._clips=et._defs.append("g").classed("clips",!0),et._topdefs=et._toppaper.append("defs").attr("id","topdefs-"+et._uid),et._topclips=et._topdefs.append("g").classed("clips",!0),et._bgLayer=et._paper.append("g").classed("bglayer",!0),et._draggers=et._paper.append("g").classed("draglayer",!0);var Vt=et._paper.append("g").classed("layer-below",!0);et._imageLowerLayer=Vt.append("g").classed("imagelayer",!0),et._shapeLowerLayer=Vt.append("g").classed("shapelayer",!0),et._cartesianlayer=et._paper.append("g").classed("cartesianlayer",!0),et._polarlayer=et._paper.append("g").classed("polarlayer",!0),et._smithlayer=et._paper.append("g").classed("smithlayer",!0),et._ternarylayer=et._paper.append("g").classed("ternarylayer",!0),et._geolayer=et._paper.append("g").classed("geolayer",!0),et._funnelarealayer=et._paper.append("g").classed("funnelarealayer",!0),et._pielayer=et._paper.append("g").classed("pielayer",!0),et._iciclelayer=et._paper.append("g").classed("iciclelayer",!0),et._treemaplayer=et._paper.append("g").classed("treemaplayer",!0),et._sunburstlayer=et._paper.append("g").classed("sunburstlayer",!0),et._indicatorlayer=et._toppaper.append("g").classed("indicatorlayer",!0),et._glimages=et._paper.append("g").classed("glimages",!0);var Gt=et._toppaper.append("g").classed("layer-above",!0);et._imageUpperLayer=Gt.append("g").classed("imagelayer",!0),et._shapeUpperLayer=Gt.append("g").classed("shapelayer",!0),et._selectionLayer=et._toppaper.append("g").classed("selectionlayer",!0),et._infolayer=et._toppaper.append("g").classed("infolayer",!0),et._menulayer=et._toppaper.append("g").classed("menulayer",!0),et._zoomlayer=et._toppaper.append("g").classed("zoomlayer",!0),et._hoverlayer=et._hoverpaper.append("g").classed("hoverlayer",!0),et._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),gt.emit("plotly_framework")}(se),Ie._shouldCreateBgLayer&&delete Ie._shouldCreateBgLayer),s.initGradients(se),s.initPatterns(se),Oe&&p.saveShowSpikeInitial(se);var Ne=!se.calcdata||se.calcdata.length!==(se._fullData||[]).length;Ne&&m.doCalcdata(se);for(var Pe=0;Pe<se.calcdata.length;Pe++)se.calcdata[Pe][0].trace=se._fullData[Pe];se._context.responsive?se._responsiveChartHandler||(se._responsiveChartHandler=function(){x.isHidden(se)||m.resize(se)},window.addEventListener("resize",se._responsiveChartHandler)):x.clearResponsive(se);var Re=x.extendFlat({},Ie._size),Ge=0;function tt(){if(m.clearAutoMarginIds(se),h.drawMarginPushers(se),p.allowAutoMargin(se),Ie._has("pie"))for(var gt=se._fullData,at=0;at<gt.length;at++){var et=gt[at];"pie"===et.type&&et.automargin&&m.allowAutoMargin(se,"pie."+et.uid+".automargin")}return m.doAutoMargin(se),m.previousPromises(se)}function ct(){se._transitioning||(h.doAutoRangeAndConstraints(se),Oe&&p.saveRangeInitial(se),c.getComponentMethod("rangeslider","calcAutorange")(se))}var wt=[m.previousPromises,function(){if(Me)return $.addFrames(se,Me)},function gt(){for(var at=Ie._basePlotModules,et=0;et<at.length;et++)at[et].drawFramework&&at[et].drawFramework(se);!Ie._glcanvas&&Ie._has("gl")&&(Ie._glcanvas=Ie._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(en){return en.key}),Ie._glcanvas.enter().append("canvas").attr("class",function(en){return"gl-canvas gl-canvas-"+en.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var yt=se._context.plotGlPixelRatio;if(Ie._glcanvas){Ie._glcanvas.attr("width",Ie.width*yt).attr("height",Ie.height*yt).style("width",Ie.width+"px").style("height",Ie.height+"px");var Vt=Ie._glcanvas.data()[0].regl;if(Vt&&(Math.floor(Ie.width*yt)!==Vt._gl.drawingBufferWidth||Math.floor(Ie.height*yt)!==Vt._gl.drawingBufferHeight)){var Gt="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!Ge)return x.log(Gt+" Clearing graph and plotting again."),m.cleanPlot([],{},se._fullData,Ie),m.supplyDefaults(se),Ie=se._fullLayout,m.doCalcdata(se),Ge++,gt();x.error(Gt)}}return"h"===Ie.modebar.orientation?Ie._modebardiv.style("height",null).style("width","100%"):Ie._modebardiv.style("width",null).style("height",Ie.height+"px"),m.previousPromises(se)},tt,function(){if(m.didMarginChange(Re,Ie._size))return x.syncOrAsync([tt,h.layoutStyles],se)}];Qe&&wt.push(function(){if(Ne)return x.syncOrAsync([c.getComponentMethod("shapes","calcAutorange"),c.getComponentMethod("annotations","calcAutorange"),ct],se);ct()}),wt.push(h.layoutStyles),Qe&&wt.push(function(){return p.draw(se,Oe?"":"redraw")},function(gt){gt._fullLayout._insideTickLabelsAutorange&&ne(gt,gt._fullLayout._insideTickLabelsAutorange).then(function(){gt._fullLayout._insideTickLabelsAutorange=void 0})}),wt.push(h.drawData,h.finalDraw,l,m.addLinks,m.rehover,m.redrag,m.reselect,m.doAutoMargin,function(gt){gt._fullLayout._insideTickLabelsAutorange&&Oe&&p.saveRangeInitial(gt,!0)},m.previousPromises);var kt=x.syncOrAsync(wt,se);return kt&&kt.then||(kt=Promise.resolve()),kt.then(function(){return T(se),se})},$.purge=function(se){var de=(se=x.getGraphDiv(se))._fullLayout||{};return m.cleanPlot([],{},se._fullData||[],de),m.purge(se),r.purge(se),de._container&&de._container.remove(),delete se._context,se},$.react=function(se,de,Ae,Le){var Me,De;se=x.getGraphDiv(se),y.clearPromiseQueue(se);var he,be,Fe,He,Ke,Ze,Oe=se._fullData,Ie=se._fullLayout;if(x.isPlotDiv(se)&&Oe&&Ie){if(x.isPlainObject(de)){var Qe=de;de=Qe.data,Ae=Qe.layout,Le=Qe.config,Me=Qe.frames}var Ne=!1;if(Le){var Pe=x.extendDeep({},se._context);se._context=void 0,P(se,Le),Ne=function he(be,Fe){var He;for(He in be)if("_"!==He.charAt(0)){var Ke=be[He],Ze=Fe[He];if(Ke!==Ze)if(x.isPlainObject(Ke)&&x.isPlainObject(Ze)){if(he(Ke,Ze))return!0}else{if(!Array.isArray(Ke)||!Array.isArray(Ze)||Ke.length!==Ze.length)return!0;for(var ut=0;ut<Ke.length;ut++)if(Ke[ut]!==Ze[ut]&&(!x.isPlainObject(Ke[ut])||!x.isPlainObject(Ze[ut])||he(Ke[ut],Ze[ut])))return!0}}}(Pe,se._context)}se.data=de||[],y.cleanData(se.data),se.layout=Ae||{},y.cleanLayout(se.layout),function(he,be,Fe,He){var Ke,Ze,ut,lt,Lt,Ot,ot,pt,qt,St,Mt=He._preGUI,Ce=[],Xe={},st={};for(Ke in Mt){if(Lt=ve(Ke,ce)){if(qt=Lt.head,St=Lt.tail,(lt=(ut=e(He,Ze=Lt.attr||qt+".uirevision").get())&&fe(Ze,be))&&lt===ut){if(null===(Ot=Mt[Ke])&&(Ot=void 0),pe(pt=(ot=e(be,Ke)).get(),Ot)){void 0===pt&&"autorange"===St&&Ce.push(qt),ot.set(q(e(He,Ke).get()));continue}if("autorange"===St||"range["===St.substr(0,6)){var Ht=Mt[qt+".autorange"];if(Ht||null===Ht&&null===Mt[qt+".range[0]"]&&null===Mt[qt+".range[1]"]){if(!(qt in Xe)){var Kt=e(be,qt).get();Xe[qt]=Kt&&(Kt.autorange||!1!==Kt.autorange&&(!Kt.range||2!==Kt.range.length))}if(Xe[qt]){ot.set(q(e(He,Ke).get()));continue}}}}}else x.warn("unrecognized GUI edit: "+Ke);delete Mt[Ke],Lt&&"range["===Lt.tail.substr(0,6)&&(st[Lt.head]=1)}for(var Zt=0;Zt<Ce.length;Zt++){var vn=Ce[Zt];if(st[vn]){var zn=e(be,vn).get();zn&&delete zn.autorange}}var gn=He._tracePreGUI;for(var nn in gn){var an,on=gn[nn],mn=null;for(Ke in on){if(!mn){var _n=xe(nn,Fe);if(_n<0){delete gn[nn];break}var Pn=Se(nn,he,(an=Fe[_n]._fullInput).index);if(Pn<0){delete gn[nn];break}mn=he[Pn]}if(Lt=ve(Ke,oe)){if(Lt.attr?lt=(ut=e(He,Lt.attr).get())&&fe(Lt.attr,be):(ut=an.uirevision,void 0===(lt=mn.uirevision)&&(lt=be.uirevision)),lt&&lt===ut&&(null===(Ot=on[Ke])&&(Ot=void 0),pe(pt=(ot=e(mn,Ke)).get(),Ot))){ot.set(q(e(an,Ke).get()));continue}}else x.warn("unrecognized GUI edit: "+Ke+" in trace uid "+nn);delete on[Ke]}}}(se.data,se.layout,Oe,Ie),m.supplyDefaults(se,{skipUpdateCalc:!0});var Re=se._fullData,Ge=se._fullLayout,tt=void 0===Ge.datarevision,ct=Ge.transition,wt=(he=se,be=Ie,Fe=Ge,He=tt,Ke=ct,(Ze=_.layoutFlags()).arrays={},Ze.rangesAltered={},Ze.nChanges=0,Ze.nChangesAnim=0,ge(be,Fe,[],{getValObject:function ut(lt){return n.getLayoutValObject(Fe,lt)},flags:Ze,immutable:He,transition:Ke,gd:he}),(Ze.plot||Ze.calc)&&(Ze.layoutReplot=!0),Ke&&Ze.nChanges&&Ze.nChangesAnim&&(Ze.anim=Ze.nChanges===Ze.nChangesAnim?"all":"some"),Ze),gt=function(he,be,Fe,He,Ke,Ze){var ut=be.length===Fe.length;if(!Ke&&!ut)return{fullReplot:!0,calc:!0};var lt,Lt,Ot=_.traceFlags();Ot.arrays={},Ot.nChanges=0,Ot.nChangesAnim=0;var ot={getValObject:function(qt){var St=n.getTraceValObject(Lt,qt);return!Lt._module.animatable&&St.anim&&(St.anim=!1),St},flags:Ot,immutable:He,transition:Ke,newDataRevision:Ze,gd:he},pt={};for(lt=0;lt<be.length;lt++)if(Fe[lt]){if(m.hasMakesDataTransform(Lt=Fe[lt]._fullInput)&&(Lt=Fe[lt]),pt[Lt.uid])continue;pt[Lt.uid]=1,ge(be[lt]._fullInput,Lt,[],ot)}return(Ot.calc||Ot.plot)&&(Ot.fullReplot=!0),Ke&&Ot.nChanges&&Ot.nChangesAnim&&(Ot.anim=Ot.nChanges===Ot.nChangesAnim&&ut?"all":"some"),Ot}(se,Oe,Re,tt,ct,wt.newDataRevision);if(J(se)&&(wt.layoutReplot=!0),gt.calc||wt.calc){se.calcdata=void 0;for(var at=Object.getOwnPropertyNames(Ge),et=0;et<at.length;et++){var yt=at[et],Vt=yt.substring(0,5);if("xaxis"===Vt||"yaxis"===Vt){var Gt=Ge[yt]._emptyCategories;Gt&&Gt()}}}else m.supplyDefaultsUpdateCalc(se.calcdata,Re);var en=[];if(Me&&(se._transitionData={},m.createTransitionData(se),en.push(function(){return $.addFrames(se,Me)})),Ge.transition&&!Ne&&(gt.anim||wt.anim))wt.ticks&&en.push(h.doTicksRelayout),m.doCalcdata(se),h.doAutoRangeAndConstraints(se),en.push(function(){return m.transitionFromReact(se,gt,wt,Ie)});else if(gt.fullReplot||wt.layoutReplot||Ne)se._fullLayout._skipDefaults=!0,en.push($._doPlot);else{for(var Jt in wt.arrays){var cn=wt.arrays[Jt];if(cn.length){var Rt=c.getComponentMethod(Jt,"drawOne");if(Rt!==x.noop)for(var je=0;je<cn.length;je++)Rt(se,cn[je]);else{var Ye=c.getComponentMethod(Jt,"draw");if(Ye===x.noop)throw new Error("cannot draw components: "+Jt);Ye(se)}}}en.push(m.previousPromises),gt.style&&en.push(h.doTraceStyle),(gt.colorbars||wt.colorbars)&&en.push(h.doColorBars),wt.legend&&en.push(h.doLegend),wt.layoutstyle&&en.push(h.layoutStyles),wt.axrange&&N(en),wt.ticks&&en.push(h.doTicksRelayout),wt.modebar&&en.push(h.doModeBar),wt.camera&&en.push(h.doCamera),en.push(T)}en.push(m.rehover,m.redrag,m.reselect),(De=x.syncOrAsync(en,se))&&De.then||(De=Promise.resolve(se))}else De=$.newPlot(se,de,Ae,Le);return De.then(function(){return se.emit("plotly_react",{data:de,layout:Ae}),se})},$.redraw=function(se){if(se=x.getGraphDiv(se),!x.isPlotDiv(se))throw new Error("This element is not a Plotly plot: "+se);return y.cleanData(se.data),y.cleanLayout(se.layout),se.calcdata=void 0,$._doPlot(se).then(function(){return se.emit("plotly_redraw"),se})},$.relayout=ne,$.restyle=j,$.setPlotConfig=function(se){return x.extendFlat(u,se)},$.update=te,$._guiRelayout=ae(ne),$._guiRestyle=ae(j),$._guiUpdate=ae(te),$._storeDirectGUIEdit=function(se,de,Ae){for(var Le in Ae)W(Le,e(se,Le).get(),Ae[Le],de)}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(v,Q,$){"use strict";var g={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},t={};(function k(x,e){for(var r in x){var i=x[r];i.valType?e[r]=i.dflt:(e[r]||(e[r]={}),k(i,e[r]))}})(g,t),Q.exports={configAttributes:g,dfltConfig:t}},{}],554:[function(v,Q,$){"use strict";var g=v("../registry"),t=v("../lib"),k=v("../plots/attributes"),x=v("../plots/layout_attributes"),e=v("../plots/frame_attributes"),r=v("../plots/animation_attributes"),i=v("./plot_config").configAttributes,c=v("./edit_types"),n=t.extendDeepAll,m=t.isPlainObject,p=t.isArrayOrTypedArray,s=t.nestedProperty,f=t.valObjectMeta,l=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function o(b,w,T){if(!b)return!1;if(b._isLinkedToArray)if(d(w[T]))T++;else if(T<w.length)return!1;for(;T<w.length;T++){var L=b[w[T]];if(!m(L)||(b=L,T===w.length-1))break;if(b._isLinkedToArray){if(!d(w[++T]))return!1}else if("info_array"===b.valType){var M=w[++T];if(!d(M))return!1;var P=b.items;if(Array.isArray(P)){if(M>=P.length)return!1;if(2===b.dimensions){if(T++,w.length===T)return b;var z=w[T];if(!d(z))return!1;b=P[M][z]}else b=P[M]}else b=P}}return b}function d(b){return b===Math.round(b)&&b>=0}function u(){var b,w,T={};for(b in n(T,x),g.subplotsRegistry)if((w=g.subplotsRegistry[b]).layoutAttributes)if(Array.isArray(w.attr))for(var L=0;L<w.attr.length;L++)h(T,w,w.attr[L]);else h(T,w,"subplot"===w.attr?w.name:w.attr);for(b in g.componentsRegistry){var M=(w=g.componentsRegistry[b]).schema;if(M&&(M.subplots||M.layout)){var P=M.subplots;if(P&&P.xaxis&&!P.yaxis)for(var z in P.xaxis)delete T.yaxis[z]}else"colorscale"===w.name?n(T,w.layoutAttributes):w.layoutAttributes&&_(T,w.layoutAttributes,w.name)}return{layoutAttributes:y(T)}}function a(){var b={frames:n({},e)};return y(b),b.frames}function y(b){return $.crawl(b,function(T,L,M){$.isValObject(T)?!0!==T.arrayOk&&"data_array"!==T.valType||(M[L+"src"]={valType:"string",editType:"none"}):m(T)&&(T.role="object")}),$.crawl(b,function(T,L,M){if(T){var P=T._isLinkedToArray;P&&(delete T._isLinkedToArray,M[L]={items:{}},M[L].items[P]=T,M[L].role="object")}}),function(w){!function T(L){for(var M in L)if(m(L[M]))T(L[M]);else if(Array.isArray(L[M]))for(var P=0;P<L[M].length;P++)T(L[M][P]);else L[M]instanceof RegExp&&(L[M]=L[M].toString())}(w)}(b),b}function h(b,w,T){var L=s(b,T),M=n({},w.layoutAttributes);M._isSubplotObj=!0,L.set(M)}function _(b,w,T){var L=s(b,T);L.set(n(L.get()||{},w))}$.IS_SUBPLOT_OBJ="_isSubplotObj",$.IS_LINKED_TO_ARRAY="_isLinkedToArray",$.DEPRECATED="_deprecated",$.UNDERSCORE_ATTRS=l,$.get=function(){var b={};g.allTypes.forEach(function(T){b[T]=function(L){var M,P;P=(M=g.modules[L]._module).basePlotModule;var z={type:null},S=n({},k),C=n({},M.attributes);$.crawl(C,function(j,q,Z,W,G){s(S,G).set(void 0),void 0===j&&s(C,G).set(void 0)}),n(z,S),g.traceIs(L,"noOpacity")&&delete z.opacity,g.traceIs(L,"showLegend")||(delete z.showlegend,delete z.legendgroup),g.traceIs(L,"noHover")&&(delete z.hoverinfo,delete z.hoverlabel),M.selectPoints||delete z.selectedpoints,n(z,C),P.attributes&&n(z,P.attributes),z.type=L;var R={meta:M.meta||{},categories:M.categories||{},animatable:Boolean(M.animatable),type:L,attributes:y(z)};if(M.layoutAttributes){var D={};n(D,M.layoutAttributes),R.layoutAttributes=y(D)}return M.animatable||$.crawl(R,function(j){$.isValObject(j)&&"anim"in j&&delete j.anim}),R}(T)});var w={};return Object.keys(g.transformsRegistry).forEach(function(T){var L,P;w[T]=(P=n({},g.transformsRegistry[L=T].attributes),Object.keys(g.componentsRegistry).forEach(function(z){var S=g.componentsRegistry[z];S.schema&&S.schema.transforms&&S.schema.transforms[L]&&Object.keys(S.schema.transforms[L]).forEach(function(C){_(P,S.schema.transforms[L][C],C)})}),{attributes:y(P)})}),{defs:{valObjects:f,metaKeys:l.concat(["description","role","editType","impliedEdits"]),editType:{traces:c.traces,layout:c.layout},impliedEdits:{}},traces:b,layout:u(),transforms:w,frames:a(),animation:y(r),config:y(i)}},$.crawl=function(b,w,T,L){var M=T||0;L=L||"",Object.keys(b).forEach(function(P){var z=b[P];if(-1===l.indexOf(P)){var S=(L?L+".":"")+P;w(z,P,b,M,S),$.isValObject(z)||m(z)&&"impliedEdits"!==P&&$.crawl(z,w,M+1,S)}})},$.isValObject=function(b){return b&&void 0!==b.valType},$.findArrayAttributes=function(b){var w,T,L=[],M=[],P=[];function z(j,q,Z,W){M=M.slice(0,W).concat([q]),P=P.slice(0,W).concat([j&&j._isLinkedToArray]),j&&("data_array"===j.valType||!0===j.arrayOk)&&("colorbar"!==M[W-1]||"ticktext"!==q&&"tickvals"!==q)&&function G(X,ne,V){var N=X[M[ne]],U=V+M[ne];if(ne===M.length-1)p(N)&&L.push(T+U);else if(P[ne]){if(Array.isArray(N))for(var ee=0;ee<N.length;ee++)m(N[ee])&&G(N[ee],ne+1,U+"["+ee+"].")}else m(N)&&G(N,ne+1,U+".")}(w,0,"")}w=b,T="",$.crawl(k,z),b._module&&b._module.attributes&&$.crawl(b._module.attributes,z);var S=b.transforms;if(S)for(var C=0;C<S.length;C++){var R=S[C],D=R._module;D&&(T="transforms["+C+"].",w=R,$.crawl(D.attributes,z))}return L},$.getTraceValObject=function(b,w){var T,L,M=w[0],P=1;if("transforms"===M){if(1===w.length)return k.transforms;var z=b.transforms;if(!Array.isArray(z)||!z.length)return!1;var S=w[1];if(!d(S)||S>=z.length)return!1;L=(T=(g.transformsRegistry[z[S].type]||{}).attributes)&&T[w[2]],P=3}else{var C=b._module;if(C||(C=(g.modules[b.type||k.type.dflt]||{})._module),!C)return!1;if(!(L=(T=C.attributes)&&T[M])){var R=C.basePlotModule;R&&R.attributes&&(L=R.attributes[M])}L||(L=k[M])}return o(L,w,P)},$.getLayoutValObject=function(b,w){return o(function(T,L){var M,P,z,S,C=T._basePlotModules;if(C){var R;for(M=0;M<C.length;M++){if((z=C[M]).attrRegex&&z.attrRegex.test(L)){if(z.layoutAttrOverrides)return z.layoutAttrOverrides;!R&&z.layoutAttributes&&(R=z.layoutAttributes)}var D=z.baseLayoutAttrOverrides;if(D&&L in D)return D[L]}if(R)return R}var j=T._modules;if(j)for(M=0;M<j.length;M++)if((S=j[M].layoutAttributes)&&L in S)return S[L];for(P in g.componentsRegistry){if("colorscale"===(z=g.componentsRegistry[P]).name&&0===L.indexOf("coloraxis"))return z.layoutAttributes[L];if(!z.schema&&L===z.name)return z.layoutAttributes}return L in x&&x[L]}(b,w[0]),w,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plots/attributes"),k={name:{valType:"string",editType:"none"}};function x(r){return r&&"string"==typeof r}function e(r){return"s"!==r.charAt(r.length-1)&&g.warn("bad argument to arrayDefaultKey: "+r),r.substr(0,r.length-1)+"defaults"}k.templateitemname={valType:"string",editType:"calc"},$.templatedArray=function(r,i){return i._isLinkedToArray=r,i.name=k.name,i.templateitemname=k.templateitemname,i},$.traceTemplater=function(r){var i,c,n={};for(i in r)c=r[i],Array.isArray(c)&&c.length&&(n[i]=0);return{newTrace:function(m){var p={type:i=g.coerce(m,{},t,"type"),_template:null};if(i in n){var s=n[i]%(c=r[i]).length;n[i]++,p._template=c[s]}return p}}},$.newContainer=function(r,i,c){var n=r._template,m=n&&(n[i]||c&&n[c]);return g.isPlainObject(m)||(m=null),r[i]={_template:m}},$.arrayTemplater=function(r,i,c){var n=r._template,m=n&&n[e(i)],p=n&&n[i];Array.isArray(p)&&p.length||(p=[]);var s={};return{newItem:function(f){var l={name:f.name,_input:f},o=l.templateitemname=f.templateitemname;if(!x(o))return l._template=m,l;for(var d=0;d<p.length;d++){var u=p[d];if(u.name===o)return s[o]=1,l._template=u,l}return l[c]=f[c]||!1,l._template=!1,l},defaultItems:function(){for(var f=[],l=0;l<p.length;l++){var o=p[l],d=o.name;if(x(d)&&!s[d]){var u={_template:o,name:d,_input:{_templateitemname:d}};u.templateitemname=o.templateitemname,f.push(u),s[d]=1}}return f}}},$.arrayDefaultKey=e,$.arrayEditor=function(r,i,c){var n=(g.nestedProperty(r,i).get()||[]).length,m=c._index,p=m>=n&&(c._input||{})._templateitemname;p&&(m=n);var s,f=i+"["+m+"]";function l(){s={},p&&(s[f]={},s[f].templateitemname=p)}function o(u,a){p?g.nestedProperty(s[f],u).set(a):s[f+"."+u]=a}function d(){var u=s;return l(),u}return l(),{modifyBase:function(u,a){s[u]=a},modifyItem:o,getUpdateObj:d,applyUpdate:function(u,a){u&&o(u,a);var y=d();for(var h in y)g.nestedProperty(r,h).set(y[h])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../registry"),k=v("../plots/plots"),x=v("../lib"),e=v("../lib/clear_gl_canvases"),r=v("../components/color"),i=v("../components/drawing"),c=v("../components/titles"),n=v("../components/modebar"),m=v("../plots/cartesian/axes"),p=v("../constants/alignment"),s=v("../plots/cartesian/constraints"),f=s.enforce,l=s.clean,o=v("../plots/cartesian/autorange").doAutoRange;function d(w,T,L){for(var M=0;M<L.length;M++){var P=L[M][0],z=L[M][1];if(!(P[0]>=w[1]||P[1]<=w[0])&&z[0]<T[1]&&z[1]>T[0])return!0}return!1}function u(w){var T,L,M,P,z,S,C=w._fullLayout,R=C._size,D=R.p,j=m.list(w,"",!0);if(C._paperdiv.style({width:w._context.responsive&&C.autosize&&!w._context._hasZeroWidth&&!w.layout.width?"100%":C.width+"px",height:w._context.responsive&&C.autosize&&!w._context._hasZeroHeight&&!w.layout.height?"100%":C.height+"px"}).selectAll(".main-svg").call(i.setSize,C.width,C.height),w._context.setBackground(w,C.paper_bgcolor),$.drawMainTitle(w),n.manage(w),!C._has("cartesian"))return k.previousPromises(w);function q(Ge,tt,ct){var wt=Ge._lw/2;return"x"===Ge._id.charAt(0)?tt?"top"===ct?tt._offset-D-wt:tt._offset+tt._length+D+wt:R.t+R.h*(1-(Ge.position||0))+wt%1:tt?"right"===ct?tt._offset+tt._length+D+wt:tt._offset-D-wt:R.l+R.w*(Ge.position||0)+wt%1}for(T=0;T<j.length;T++){var Z=(P=j[T])._anchorAxis;P._linepositions={},P._lw=i.crispRound(w,P.linewidth,1),P._mainLinePosition=q(P,Z,P.side),P._mainMirrorPosition=P.mirror&&Z?q(P,Z,p.OPPOSITE_SIDE[P.side]):null}var W=[],G=[],X=[],ne=1===r.opacity(C.paper_bgcolor)&&1===r.opacity(C.plot_bgcolor)&&C.paper_bgcolor===C.plot_bgcolor;for(L in C._plots)if((M=C._plots[L]).mainplot)M.bg&&M.bg.remove(),M.bg=void 0;else{var V=M.xaxis.domain,N=M.yaxis.domain,U=M.plotgroup;if(d(V,N,X)){var ee=U.node(),B=M.bg=x.ensureSingle(U,"rect","bg");ee.insertBefore(B.node(),ee.childNodes[0]),G.push(L)}else U.select("rect.bg").remove(),X.push([V,N]),ne||(W.push(L),G.push(L))}var K,J,te,ae,ce,oe,ve,fe,xe,Se,pe,ge,Te,se=C._bgLayer.selectAll(".bg").data(W);for(se.enter().append("rect").classed("bg",!0),se.exit().remove(),se.each(function(Ge){C._plots[Ge].bg=g.select(this)}),T=0;T<G.length;T++)z=(M=C._plots[G[T]]).xaxis,S=M.yaxis,M.bg&&void 0!==z._offset&&void 0!==S._offset&&M.bg.call(i.setRect,z._offset-D,S._offset-D,z._length+2*D,S._length+2*D).call(r.fill,C.plot_bgcolor).style("stroke-width",0);if(!C._hasOnlyLargeSploms)for(L in C._plots){z=(M=C._plots[L]).xaxis,S=M.yaxis;var de,Ae,Le=M.clipId="clip"+C._uid+L+"plot",Me=x.ensureSingleById(C._clips,"clipPath",Le,function(Ge){Ge.classed("plotclip",!0).append("rect")});M.clipRect=Me.select("rect").attr({width:z._length,height:S._length}),i.setTranslate(M.plot,z._offset,S._offset),M._hasClipOnAxisFalse?(de=null,Ae=Le):(de=Le,Ae=null),i.setClipUrl(M.plot,de,w),M.layerClipId=Ae}function De(Ge){return"M"+K+","+Ge+"H"+J}function Oe(Ge){return"M"+z._offset+","+Ge+"h"+z._length}function Ie(Ge){return"M"+Ge+","+fe+"V"+ve}function Qe(Ge){return"M"+Ge+","+S._offset+"v"+S._length}function Ne(Ge,tt,ct){if(!Ge.showline||L!==Ge._mainSubplot)return"";if(!Ge._anchorAxis)return ct(Ge._mainLinePosition);var wt=tt(Ge._mainLinePosition);return Ge.mirror&&(wt+=tt(Ge._mainMirrorPosition)),wt}for(L in C._plots){S=(M=C._plots[L]).yaxis;var Pe="M0,0";a(z=M.xaxis,L)&&(ce=h(z,"left",S,j),K=z._offset-(ce?D+ce:0),oe=h(z,"right",S,j),J=z._offset+z._length+(oe?D+oe:0),te=q(z,S,"bottom"),ae=q(z,S,"top"),!(Te=!z._anchorAxis||L!==z._mainSubplot)||"allticks"!==z.mirror&&"all"!==z.mirror||(z._linepositions[L]=[te,ae]),Pe=Ne(z,De,Oe),Te&&z.showline&&("all"===z.mirror||"allticks"===z.mirror)&&(Pe+=De(te)+De(ae)),M.xlines.style("stroke-width",z._lw+"px").call(r.stroke,z.showline?z.linecolor:"rgba(0,0,0,0)")),M.xlines.attr("d",Pe);var Re="M0,0";a(S,L)&&(pe=h(S,"bottom",z,j),ve=S._offset+S._length+(pe?D:0),ge=h(S,"top",z,j),fe=S._offset-(ge?D:0),xe=q(S,z,"left"),Se=q(S,z,"right"),!(Te=!S._anchorAxis||L!==S._mainSubplot)||"allticks"!==S.mirror&&"all"!==S.mirror||(S._linepositions[L]=[xe,Se]),Re=Ne(S,Ie,Qe),Te&&S.showline&&("all"===S.mirror||"allticks"===S.mirror)&&(Re+=Ie(xe)+Ie(Se)),M.ylines.style("stroke-width",S._lw+"px").call(r.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),M.ylines.attr("d",Re)}return m.makeClipPaths(w),k.previousPromises(w)}function a(w,T){return(w.ticks||w.showline)&&(T===w._mainSubplot||"all"===w.mirror||"allticks"===w.mirror)}function y(w,T,L){if(!L.showline||!L._lw)return!1;if("all"===L.mirror||"allticks"===L.mirror)return!0;var M=L._anchorAxis;if(!M)return!1;var P=p.FROM_BL[T];return L.side===T?M.domain[P]===w.domain[P]:L.mirror&&M.domain[1-P]===w.domain[1-P]}function h(w,T,L,M){if(y(w,T,L))return L._lw;for(var P=0;P<M.length;P++){var z=M[P];if(z._mainAxis===L._mainAxis&&y(w,T,z))return z._lw}return 0}function _(w,T){var L=w.title,M=w._size,P=0;return"paper"===("start"===T?P=L.pad.l:"end"===T&&(P=-L.pad.r),L.xref)?M.l+M.w*L.x+P:w.width*L.x+P}function b(w,T){var L=w.title,M=w._size,P=0;return"0em"!==T&&T?T===p.CAP_SHIFT+"em"&&(P=L.pad.t):P=-L.pad.b,"auto"===L.y?M.t/2:"paper"===L.yref?M.t+M.h-M.h*L.y+P:w.height-w.height*L.y+P}$.layoutStyles=function(w){return x.syncOrAsync([k.doAutoMargin,u],w)},$.drawMainTitle=function(w){var z,S,T=w._fullLayout,L=(S="middle",x.isRightAnchor(z=T.title)?S="end":x.isLeftAnchor(z)&&(S="start"),S),M=function(P){var z=P.title,S="0em";return x.isTopAnchor(z)?S=p.CAP_SHIFT+"em":x.isMiddleAnchor(z)&&(S=p.MID_SHIFT+"em"),S}(T);c.draw(w,"gtitle",{propContainer:T,propName:"title.text",placeholder:T._dfltTitle.plot,attributes:{x:_(T,L),y:b(T,M),"text-anchor":L,dy:M}})},$.doTraceStyle=function(w){var T,L=w.calcdata,M=[];for(T=0;T<L.length;T++){var P=L[T],z=P[0]||{},S=z.trace||{},C=S._module||{},R=C.arraysToCalcdata;R&&R(P,S);var D=C.editStyle;D&&M.push({fn:D,cd0:z})}if(M.length){for(T=0;T<M.length;T++){var j=M[T];j.fn(w,j.cd0)}e(w),$.redrawReglTraces(w)}return k.style(w),t.getComponentMethod("legend","draw")(w),k.previousPromises(w)},$.doColorBars=function(w){return t.getComponentMethod("colorbar","draw")(w),k.previousPromises(w)},$.layoutReplot=function(w){var T=w.layout;return w.layout=void 0,t.call("_doPlot",w,"",T)},$.doLegend=function(w){return t.getComponentMethod("legend","draw")(w),k.previousPromises(w)},$.doTicksRelayout=function(w){return m.draw(w,"redraw"),w._fullLayout._hasOnlyLargeSploms&&(t.subplotsRegistry.splom.updateGrid(w),e(w),$.redrawReglTraces(w)),$.drawMainTitle(w),k.previousPromises(w)},$.doModeBar=function(w){var T=w._fullLayout;n.manage(w);for(var L=0;L<T._basePlotModules.length;L++){var M=T._basePlotModules[L].updateFx;M&&M(w)}return k.previousPromises(w)},$.doCamera=function(w){for(var T=w._fullLayout,L=T._subplots.gl3d,M=0;M<L.length;M++){var P=T[L[M]];P._scene.setViewport(P)}},$.drawData=function(w){var T=w._fullLayout;e(w);for(var L=T._basePlotModules,M=0;M<L.length;M++)L[M].plot(w);return $.redrawReglTraces(w),k.style(w),t.getComponentMethod("selections","draw")(w),t.getComponentMethod("shapes","draw")(w),t.getComponentMethod("annotations","draw")(w),t.getComponentMethod("images","draw")(w),T._replotting=!1,k.previousPromises(w)},$.redrawReglTraces=function(w){var T=w._fullLayout;if(T._has("regl")){var L,M,P=w._fullData,z=[],S=[];for(T._hasOnlyLargeSploms&&T._splomGrid.draw(),L=0;L<P.length;L++){var C=P[L];!0===C.visible&&0!==C._length&&("splom"===C.type?T._splomScenes[C.uid].draw():"scattergl"===C.type?x.pushUnique(z,C.xaxis+C.yaxis):"scatterpolargl"===C.type&&x.pushUnique(S,C.subplot))}for(L=0;L<z.length;L++)(M=T._plots[z[L]])._scene&&M._scene.draw();for(L=0;L<S.length;L++)(M=T[S[L]]._subplot)._scene&&M._scene.draw()}},$.doAutoRangeAndConstraints=function(w){for(var T,L=m.list(w,"",!0),M={},P=0;P<L.length;P++)if(!M[(T=L[P])._id]){M[T._id]=1,l(w,T),o(w,T);var z=T._matchGroup;if(z)for(var S in z){var C=m.getFromId(w,S);o(w,C,T.range),M[S]=1}}f(w)},$.finalDraw=function(w){t.getComponentMethod("rangeslider","draw")(w),t.getComponentMethod("rangeselector","draw")(w)},$.drawMarginPushers=function(w){t.getComponentMethod("legend","draw")(w),t.getComponentMethod("rangeselector","draw")(w),t.getComponentMethod("sliders","draw")(w),t.getComponentMethod("updatemenus","draw")(w),t.getComponentMethod("colorbar","draw")(w)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(v,Q,$){"use strict";var g=v("../lib"),t=g.isPlainObject,k=v("./plot_schema"),x=v("../plots/plots"),e=v("../plots/attributes"),r=v("./plot_template"),i=v("./plot_config").dfltConfig;function c(d,u){d=g.extendDeep({},d);var a,y,h=Object.keys(d).sort();function _(M,P,z){if(t(P)&&t(M))c(M,P);else if(Array.isArray(P)&&Array.isArray(M)){var S=r.arrayTemplater({_template:d},z);for(y=0;y<P.length;y++){var C=P[y],R=S.newItem(C)._template;R&&c(R,C)}var D=S.defaultItems();for(y=0;y<D.length;y++)P.push(D[y]._template);for(y=0;y<P.length;y++)delete P[y].templateitemname}}for(a=0;a<h.length;a++){var b=h[a],w=d[b];if(b in u?_(w,u[b],b):u[b]=w,n(b)===b)for(var T in u){var L=n(T);T===L||L!==b||T in d||_(w,u[T],b)}}}function n(d){return d.replace(/[0-9]+$/,"")}function m(d,u,a,y,h){var _=h&&a(h);for(var b in d){var w=d[b],T=f(d,b,y),L=f(d,b,h),M=a(L);if(!M){var P=n(b);P!==b&&(M=a(L=f(d,P,h)))}if(!(_&&_===M||!M||M._noTemplating||"data_array"===M.valType||M.arrayOk&&Array.isArray(w)))if(!M.valType&&t(w))m(w,u,a,T,L);else if(M._isLinkedToArray&&Array.isArray(w))for(var z=!1,S=0,C={},R=0;R<w.length;R++){var D=w[R];if(t(D)){var j=D.name;if(j)C[j]||(m(D,u,a,f(w,S,T),f(w,S,L)),S++,C[j]=1);else if(!z){var q=f(d,r.arrayDefaultKey(b),y),Z=f(w,S,T);m(D,u,a,Z,f(w,S,L));var W=g.nestedProperty(u,Z);g.nestedProperty(u,q).set(W.get()),W.set(null),z=!0}}}else g.nestedProperty(u,T).set(w)}}function p(d,u){return k.getLayoutValObject(d,g.nestedProperty({},u).parts)}function s(d,u){return k.getTraceValObject(d,g.nestedProperty({},u).parts)}function f(d,u,a){return a?Array.isArray(d)?a+"["+u+"]":a+"."+u:u}function l(d){for(var u=0;u<d.length;u++)if(t(d[u]))return!0}function o(d){var u;switch(d.code){case"data":u="The template has no key data.";break;case"layout":u="The template has no key layout.";break;case"missing":u=d.path?"There are no templates for item "+d.path+" with name "+d.templateitemname:"There are no templates for trace "+d.index+", of type "+d.traceType+".";break;case"unused":u=d.path?"The template item at "+d.path+" was not used in constructing the plot.":d.dataCount?"Some of the templates of type "+d.traceType+" were not used. The template has "+d.templateCount+" traces, the data only has "+d.dataCount+" of this type.":"The template has "+d.templateCount+" traces of type "+d.traceType+" but there are none in the data.";break;case"reused":u="Some of the templates of type "+d.traceType+" were used more than once. The template has "+d.templateCount+" traces, the data has "+d.dataCount+" of this type."}return d.msg=u,d}$.makeTemplate=function(d){d=g.isPlainObject(d)?d:g.getGraphDiv(d),d=g.extendDeep({_context:i},{data:d.data,layout:d.layout}),x.supplyDefaults(d);var u=d.data||[],a=d.layout||{};a._basePlotModules=d._fullLayout._basePlotModules,a._modules=d._fullLayout._modules;var y={data:{},layout:{}};u.forEach(function(S){var C={};m(S,C,s.bind(null,S));var R=g.coerce(S,{},e,"type"),D=y.data[R];D||(D=y.data[R]=[]),D.push(C)}),m(a,y.layout,p.bind(null,a)),delete y.layout.template;var h=a.template;if(t(h)){var _,b,w,T,L,M,P=h.layout;t(P)&&c(P,y.layout);var z=h.data;if(t(z)){for(b in y.data)if(w=z[b],Array.isArray(w)){for(M=(L=y.data[b]).length,T=w.length,_=0;_<M;_++)c(w[_%T],L[_]);for(_=M;_<T;_++)L.push(g.extendDeep({},w[_]))}for(b in z)b in y.data||(y.data[b]=g.extendDeep([],z[b]))}}return y},$.validateTemplate=function(d,u){var a=g.extendDeep({},{_context:i,data:d.data,layout:d.layout}),y=a.layout||{};t(u)||(u=y.template||{});var h=u.layout,_=u.data,b=[];a.layout=y,a.layout.template=u,x.supplyDefaults(a);var w=a._fullLayout,T=a._fullData,L={};if(t(h)?(function D(j,q){for(var Z in j)if("_"!==Z.charAt(0)&&t(j[Z])){var W,G=n(Z),X=[];for(W=0;W<q.length;W++)X.push(f(j,Z,q[W])),G!==Z&&X.push(f(j,G,q[W]));for(W=0;W<X.length;W++)L[X[W]]=1;D(j[Z],X)}}(w,["layout"]),function D(j,q){for(var Z in j)if(-1===Z.indexOf("defaults")&&t(j[Z])){var W=f(j,Z,q);L[W]?D(j[Z],W):b.push({code:"unused",path:W})}}(h,"layout")):b.push({code:"layout"}),t(_)){for(var M,P={},z=0;z<T.length;z++){var S=T[z];P[M=S.type]=(P[M]||0)+1,S._fullInput._template||b.push({code:"missing",index:S._fullInput.index,traceType:M})}for(M in _){var C=_[M].length,R=P[M]||0;C>R?b.push({code:"unused",traceType:M,templateCount:C,dataCount:R}):R>C&&b.push({code:"reused",traceType:M,templateCount:C,dataCount:R})}}else b.push({code:"data"});if(function D(j,q){for(var Z in j)if("_"!==Z.charAt(0)){var W=j[Z],G=f(j,Z,q);t(W)?(Array.isArray(j)&&!1===W._template&&W.templateitemname&&b.push({code:"missing",path:G,templateitemname:W.templateitemname}),D(W,G)):Array.isArray(W)&&l(W)&&D(W,G)}}({data:T,layout:w},""),b.length)return b.map(o)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("./plot_api"),k=v("../plots/plots"),x=v("../lib"),e=v("../snapshot/helpers"),r=v("../snapshot/tosvg"),i=v("../snapshot/svgtoimg"),c=v("../version").version,n={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};Q.exports=function(m,p){var s,f,l,o;function d(R){return!(R in p)||x.validate(p[R],n[R])}if(p=p||{},x.isPlainObject(m)?(s=m.data||[],f=m.layout||{},l=m.config||{},o={}):(m=x.getGraphDiv(m),s=x.extendDeep([],m.data),f=x.extendDeep({},m.layout),l=m._context,o=m._fullLayout||{}),!d("width")&&null!==p.width||!d("height")&&null!==p.height)throw new Error("Height and width should be pixel values.");if(!d("format"))throw new Error("Export format is not "+x.join2(n.format.values,", "," or ")+".");var u={};function a(R,D){return x.coerce(p,u,n,R,D)}var y=a("format"),h=a("width"),_=a("height"),b=a("scale"),w=a("setBackground"),T=a("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var M=x.extendFlat({},f);h?M.width=h:null===p.width&&g(o.width)&&(M.width=o.width),_?M.height=_:null===p.height&&g(o.height)&&(M.height=o.height);var P=x.extendFlat({},l,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),z=e.getRedrawFunc(L);function S(){return new Promise(function(R){setTimeout(R,e.getDelay(L._fullLayout))})}function C(){return new Promise(function(R,D){var j=r(L,y,b),q=L._fullLayout.width,Z=L._fullLayout.height;function W(){t.purge(L),document.body.removeChild(L)}if("full-json"===y){var G=k.graphJson(L,!1,"keepdata","object",!0,!0);return G.version=c,G=JSON.stringify(G),W(),R(T?G:e.encodeJSON(G))}if(W(),"svg"===y)return R(T?j:e.encodeSVG(j));var X=document.createElement("canvas");X.id=x.randstr(),i({format:y,width:q,height:Z,scale:b,canvas:X,svg:j,promise:!0}).then(R).catch(D)})}return new Promise(function(R,D){t.newPlot(L,s,M,P).then(z).then(S).then(C).then(function(j){var q;R((q=j,T?q.replace(e.IMAGE_URL_PREFIX,""):q))}).catch(function(j){D(j)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plots/plots"),k=v("./plot_schema"),x=v("./plot_config").dfltConfig,e=g.isPlainObject,r=Array.isArray,i=g.isArrayOrTypedArray;function c(u,a,y,h,_,b){b=b||[];for(var w=Object.keys(u),T=0;T<w.length;T++){var L=w[T];if("transforms"!==L){var M=b.slice();M.push(L);var P=u[L],z=a[L],S=l(y,L),C=(S||{}).valType,R="info_array"===C,D="colorscale"===C,j=(S||{}).items;if(f(y,L))if(e(P)&&e(z)&&"any"!==C)c(P,z,S,h,_,M);else if(R&&r(P)){P.length>z.length&&h.push(s("unused",_,M.concat(z.length)));var q,Z,G,X,ne=z.length,V=Array.isArray(j);if(V&&(ne=Math.min(ne,j.length)),2===S.dimensions)for(Z=0;Z<ne;Z++)if(r(P[Z])){P[Z].length>z[Z].length&&h.push(s("unused",_,M.concat(Z,z[Z].length)));var N=z[Z].length;for(q=0;q<(V?Math.min(N,j[Z].length):N);q++)X=z[Z][q],g.validate(G=P[Z][q],V?j[Z][q]:j)?X!==G&&X!==+G&&h.push(s("dynamic",_,M.concat(Z,q),G,X)):h.push(s("value",_,M.concat(Z,q),G))}else h.push(s("array",_,M.concat(Z),P[Z]));else for(Z=0;Z<ne;Z++)X=z[Z],g.validate(G=P[Z],V?j[Z]:j)?X!==G&&X!==+G&&h.push(s("dynamic",_,M.concat(Z),G,X)):h.push(s("value",_,M.concat(Z),G))}else if(S.items&&!R&&r(P)){var U,ee,B=j[Object.keys(j)[0]],K=[];for(U=0;U<z.length;U++){var J=z[U]._index||U;if((ee=M.slice()).push(J),e(P[J])&&e(z[U])){K.push(J);var te=P[J],ae=z[U];e(te)&&!1!==te.visible&&!1===ae.visible?h.push(s("invisible",_,ee)):c(te,ae,B,h,_,ee)}}for(U=0;U<P.length;U++)(ee=M.slice()).push(U),e(P[U])?-1===K.indexOf(U)&&h.push(s("unused",_,ee)):h.push(s("object",_,ee,P[U]))}else!e(P)&&e(z)?h.push(s("object",_,M,P)):i(P)||!i(z)||R||D?L in a?g.validate(P,S)?"enumerated"===S.valType&&(S.coerceNumber&&P!==+z||P!==z)&&h.push(s("dynamic",_,M,P,z)):h.push(s("value",_,M,P)):h.push(s("unused",_,M,P)):h.push(s("array",_,M,P));else h.push(s("schema",_,M))}}return h}function n(u,a){for(var y=u.layout.layoutAttributes,h=0;h<a.length;h++){var _=a[h],b=u.traces[_.type],w=b.layoutAttributes;w&&g.extendFlat(_.subplot?y[b.attributes.subplot.dflt]:y,w)}return y}Q.exports=function(u,a){void 0===u&&(u=[]),void 0===a&&(a={});var y,h,_=k.get(),b=[],w={_context:g.extendFlat({},x)};r(u)?(w.data=g.extendDeep([],u),y=u):(w.data=[],y=[],b.push(s("array","data"))),e(a)?(w.layout=g.extendDeep({},a),h=a):(w.layout={},h={},arguments.length>1&&b.push(s("object","layout"))),t.supplyDefaults(w);for(var T=w._fullData,L=y.length,M=0;M<L;M++){var P=y[M],z=["data",M];if(e(P)){var S=T[M],C=S.type,R=_.traces[C].attributes;R.type={valType:"enumerated",values:[C]},!1===S.visible&&!1!==P.visible&&b.push(s("invisible",z)),c(P,S,R,b,z);var D=P.transforms,j=S.transforms;if(D){r(D)||b.push(s("array",z,["transforms"])),z.push("transforms");for(var q=0;q<D.length;q++){var Z=["transforms",q],W=D[q].type;if(e(D[q])){var G=_.transforms[W]?_.transforms[W].attributes:{};G.type={valType:"enumerated",values:Object.keys(_.transforms)},c(D[q],j[q],G,b,z,Z)}else b.push(s("object",z,Z))}}}else b.push(s("object",z))}return c(h,w._fullLayout,n(_,T),b,"layout"),0===b.length?void 0:b};var m={object:function(u,a){return("layout"===u&&""===a?"The layout argument":"data"===u[0]&&""===a?"Trace "+u[1]+" in the data argument":p(u)+"key "+a)+" must be linked to an object container"},array:function(u,a){return("data"===u?"The data argument":p(u)+"key "+a)+" must be linked to an array container"},schema:function(u,a){return p(u)+"key "+a+" is not part of the schema"},unused:function(u,a,y){var h=e(y)?"container":"key";return p(u)+h+" "+a+" did not get coerced"},dynamic:function(u,a,y,h){return[p(u)+"key",a,"(set to '"+y+"')","got reset to","'"+h+"'","during defaults."].join(" ")},invisible:function(u,a){return(a?p(u)+"item "+a:"Trace "+u[1])+" got defaulted to be not visible"},value:function(u,a,y){return[p(u)+"key "+a,"is set to an invalid value ("+y+")"].join(" ")}};function p(u){return r(u)?"In data trace "+u[1]+", ":"In "+u+", "}function s(u,a,y,h,_){var b,w;y=y||"",r(a)?(b=a[0],w=a[1]):(b=a,w=null);var T=function(M){if(!r(M))return String(M);for(var P="",z=0;z<M.length;z++){var S=M[z];"number"==typeof S?P=P.substr(0,P.length-1)+"["+S+"]":P+=S,z<M.length-1&&(P+=".")}return P}(y),L=m[u](a,T,h,_);return g.log(L),{code:u,container:b,trace:w,path:y,astr:T,msg:L}}function f(u,a){var y=d(a),h=y.keyMinusId;return!!(h in u&&u[h]._isSubplotObj&&y.id)||a in u}function l(u,a){return a in u?u[a]:u[d(a).keyMinusId]}var o=g.counterRegex("([a-z]+)");function d(u){var a=u.match(o);return{keyMinusId:a&&a[1],id:a&&a[2]}}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(v,Q,$){"use strict";Q.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plot_api/plot_template");Q.exports=function(k,x,e){var r,i,c=e.name,n=e.inclusionAttr||"visible",m=x[c],p=g.isArrayOrTypedArray(k[c])?k[c]:[],s=x[c]=[],f=t.arrayTemplater(x,c,n);for(r=0;r<p.length;r++){var l=p[r];g.isPlainObject(l)?i=f.newItem(l):(i=f.newItem({}))[n]=!1,i._index=r,!1!==i[n]&&e.handleItemDefaults(l,i,x,e),s.push(i)}var o=f.defaultItems();for(r=0;r<o.length;r++)(i=o[r])._index=s.length,e.handleItemDefaults({},i,x,e,{}),s.push(i);if(g.isArrayOrTypedArray(m)){var d=Math.min(m.length,s.length);for(r=0;r<d;r++)g.relinkPrivateKeys(s[r],m[r])}return s}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(v,Q,$){"use strict";var g=v("./font_attributes"),t=v("../components/fx/attributes");Q.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:g({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:t.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=t.dateTime2ms,x=t.incrementMonth,e=v("../../constants/numerical").ONEAVGMONTH;Q.exports=function(r,i,c,n){if("date"!==i.type)return{vals:n};var m=r[c+"periodalignment"];if(!m)return{vals:n};var p,s=r[c+"period"];if(g(s)){if((s=+s)<=0)return{vals:n}}else if("string"==typeof s&&"M"===s.charAt(0)){var f=+s.substring(1);if(!(f>0&&Math.round(f)===f))return{vals:n};p=f}for(var l=i.calendar,o="start"===m,d="end"===m,a=k(r[c+"period0"],l)||0,y=[],h=[],_=[],b=n.length,w=0;w<b;w++){var T,L,M,P=n[w];if(p){for(T=Math.round((P-a)/(p*e)),M=x(a,p*T,l);M>P;)M=x(M,-p,l);for(;M<=P;)M=x(M,p,l);L=x(M,-p,l)}else{for(M=a+(T=Math.round((P-a)/s))*s;M>P;)M-=s;for(;M<=P;)M+=s;L=M-s}y[w]=o?L:d?M:(L+M)/2,h[w]=L,_[w]=M}return{vals:y,starts:h,ends:_}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(v,Q,$){"use strict";Q.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../../lib"),x=v("../../constants/numerical").FP_SAFE,e=v("../../registry"),r=v("../../components/drawing"),i=v("./axis_ids"),c=i.getFromId,n=i.isLinked;function m(h,_){var b,w,T=[],L=h._fullLayout,M=s(L,_,0),P=s(L,_,1),z=f(h,_),S=z.min,C=z.max;if(0===S.length||0===C.length)return k.simpleMap(_.range,_.r2l);var R=S[0].val,D=C[0].val;for(b=1;b<S.length&&R===D;b++)R=Math.min(R,S[b].val);for(b=1;b<C.length&&R===D;b++)D=Math.max(D,C[b].val);var j=!1;if(_.range){var q=k.simpleMap(_.range,_.r2l);j=q[1]<q[0]}"reversed"===_.autorange&&(j=!0,_.autorange=!0);var Z,W,G,X,ne,V,N=_.rangemode,U="tozero"===N,ee="nonnegative"===N,B=_._length,K=B/10,J=0;for(b=0;b<S.length;b++)for(Z=S[b],w=0;w<C.length;w++)(V=(W=C[w]).val-Z.val-p(_,Z.val,W.val))>0&&((ne=B-M(Z)-P(W))>K?V/ne>J&&(G=Z,X=W,J=V/ne):V/B>J&&(G={val:Z.val,nopad:1},X={val:W.val,nopad:1},J=V/B));if(R===D){var te=R-1,ae=R+1;if(U)if(0===R)T=[0,1];else{var ce=(R>0?C:S).reduce(function(ve,fe){return Math.max(ve,P(fe))},0),oe=R/(1-Math.min(.5,ce/B));T=R>0?[0,oe]:[oe,0]}else T=ee?[Math.max(0,te),Math.max(1,ae)]:[te,ae]}else U?(G.val>=0&&(G={val:0,nopad:1}),X.val<=0&&(X={val:0,nopad:1})):ee&&(G.val-J*M(G)<0&&(G={val:0,nopad:1}),X.val<=0&&(X={val:1,nopad:1})),J=(X.val-G.val-p(_,Z.val,W.val))/(B-M(G)-P(X)),T=[G.val-J*M(G),X.val+J*P(X)];return j&&T.reverse(),k.simpleMap(T,_.l2r||Number)}function p(h,_,b){var w=0;if(h.rangebreaks)for(var T=h.locateBreaks(_,b),L=0;L<T.length;L++){var M=T[L];w+=M.max-M.min}return w}function s(h,_,b){var w=.05*_._length,T=_._anchorAxis||{};if(-1!==(_.ticklabelposition||"").indexOf("inside")||-1!==(T.ticklabelposition||"").indexOf("inside")){var L="reversed"===_.autorange;if(!L){var M=k.simpleMap(_.range,_.r2l);L=M[1]<M[0]}L&&(b=!b)}var P=0;return n(h,_._id)||(P=function(z,S,C){var R=0,D="x"===S._id.charAt(0);for(var j in z._plots){var q=z._plots[j];if(S._id===q.xaxis._id||S._id===q.yaxis._id){var Z=(D?q.yaxis:q.xaxis)||{};if(-1!==(Z.ticklabelposition||"").indexOf("inside")&&(!C&&("left"===Z.side||"bottom"===Z.side)||C&&("top"===Z.side||"right"===Z.side))){if(Z._vals){var W=k.deg2rad(Z._tickAngles[Z._id+"tick"]||0),G=Math.abs(Math.cos(W)),X=Math.abs(Math.sin(W));Z._vals[0].bb||Z._selections[Z._id+"tick"].each(function(B){var K=g.select(this);K.select(".text-math-group").empty()&&(B.bb=r.bBox(K.node()))});for(var V=0;V<Z._vals.length;V++){var N=Z._vals[V].bb;if(N){var U=6+N.width,ee=6+N.height;R=Math.max(R,D?Math.max(U*G,ee*X):Math.max(ee*G,U*X))}}}"inside"===Z.ticks&&"inside"===Z.ticklabelposition&&(R+=Z.ticklen||0)}}}return R}(h,_,b)),w=Math.max(P,w),"domain"===_.constrain&&_._inputDomain&&(w*=(_._inputDomain[1]-_._inputDomain[0])/(_.domain[1]-_.domain[0])),function(z){return z.nopad?0:z.pad+(z.extrapad?w:P)}}function f(h,_,b){var w,T,L,M=_._id,z=h._fullLayout,S=[],C=[];function R(W,G){for(w=0;w<G.length;w++){var X=W[G[w]],ne=(X._extremes||{})[M];if(!0===X.visible&&ne){for(T=0;T<ne.min.length;T++)l(S,(L=ne.min[T]).val,L.pad,{extrapad:L.extrapad});for(T=0;T<ne.max.length;T++)o(C,(L=ne.max[T]).val,L.pad,{extrapad:L.extrapad})}}}if(R(h._fullData,_._traceIndices),R(z.annotations||[],_._annIndices||[]),R(z.shapes||[],_._shapeIndices||[]),_._matchGroup&&!b)for(var D in _._matchGroup)if(D!==_._id){var j=c(h,D),q=f(h,j,!0),Z=_._length/j._length;for(T=0;T<q.min.length;T++)l(S,(L=q.min[T]).val,L.pad*Z,{extrapad:L.extrapad});for(T=0;T<q.max.length;T++)o(C,(L=q.max[T]).val,L.pad*Z,{extrapad:L.extrapad})}return{min:S,max:C}}function l(h,_,b,w){d(h,_,b,w,a)}function o(h,_,b,w){d(h,_,b,w,y)}function d(h,_,b,w,T){for(var L=w.tozero,M=w.extrapad,P=!0,z=0;z<h.length&&P;z++){var S=h[z];if(T(S.val,_)&&S.pad>=b&&(S.extrapad||!M)){P=!1;break}T(_,S.val)&&S.pad<=b&&(M||!S.extrapad)&&(h.splice(z,1),z--)}if(P){var C=L&&0===_;h.push({val:_,pad:C?0:b,extrapad:!C&&M})}}function u(h){return t(h)&&Math.abs(h)<x}function a(h,_){return h<=_}function y(h,_){return h>=_}Q.exports={getAutoRange:m,makePadFn:s,doAutoRange:function(h,_,b){if(_.setScale(),_.autorange){_.range=b?b.slice():m(h,_),_._r=_.range.slice(),_._rl=k.simpleMap(_._r,_.r2l);var w=_._input,T={};T[_._attr+".range"]=_.range,T[_._attr+".autorange"]=_.autorange,e.call("_storeDirectGUIEdit",h.layout,h._fullLayout._preGUI,T),w.range=_.range.slice(),w.autorange=_.autorange}var L=_._anchorAxis;if(L&&L.rangeslider){var M=L.rangeslider[_._name];M&&"auto"===M.rangemode&&(M.range=m(h,_)),L._input.rangeslider[_._name]=k.extendFlat({},M)}},findExtremes:function(h,_,b){b||(b={}),h._m||h.setScale();var w,T,L,M,P,z,S,C,R,D=[],j=[],q=_.length,Z=b.padded||!1,W=b.tozero&&("linear"===h.type||"-"===h.type),G="log"===h.type,X=!1,ne=b.vpadLinearized||!1;function V(ae){if(Array.isArray(ae))return X=!0,function(oe){return Math.max(Number(ae[oe]||0),0)};var ce=Math.max(Number(ae||0),0);return function(){return ce}}var N=V((h._m>0?b.ppadplus:b.ppadminus)||b.ppad||0),U=V((h._m>0?b.ppadminus:b.ppadplus)||b.ppad||0),ee=V(b.vpadplus||b.vpad),B=V(b.vpadminus||b.vpad);if(!X){if(C=1/0,R=-1/0,G)for(w=0;w<q;w++)(T=_[w])<C&&T>0&&(C=T),T>R&&T<x&&(R=T);else for(w=0;w<q;w++)(T=_[w])<C&&T>-x&&(C=T),T>R&&T<x&&(R=T);_=[C,R],q=2}var K={tozero:W,extrapad:Z};function J(ae){t(L=_[ae])&&(z=N(ae),S=U(ae),ne?(M=h.c2l(L)-B(ae),P=h.c2l(L)+ee(ae)):(C=L-B(ae),R=L+ee(ae),G&&C<R/10&&(C=R/10),M=h.c2l(C),P=h.c2l(R)),W&&(M=Math.min(0,M),P=Math.max(0,P)),u(M)&&l(D,M,S,K),u(P)&&o(j,P,z,K))}var te=Math.min(6,q);for(w=0;w<te;w++)J(w);for(w=q-1;w>=te;w--)J(w);return{min:D,max:j,opts:b}},concatExtremes:f}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../lib"),r=e.strTranslate,i=v("../../lib/svg_text_utils"),c=v("../../components/titles"),n=v("../../components/color"),m=v("../../components/drawing"),p=v("./layout_attributes"),s=v("./clean_ticks"),f=v("../../constants/numerical"),l=f.ONEMAXYEAR,o=f.ONEAVGYEAR,d=f.ONEMINYEAR,u=f.ONEMAXQUARTER,a=f.ONEAVGQUARTER,y=f.ONEMINQUARTER,h=f.ONEMAXMONTH,_=f.ONEAVGMONTH,b=f.ONEMINMONTH,w=f.ONEWEEK,T=f.ONEDAY,L=T/2,M=f.ONEHOUR,P=f.ONEMIN,z=f.ONESEC,S=f.MINUS_SIGN,C=f.BADNUM,R={K:"zeroline"},D={K:"gridline",L:"path"},j={K:"minor-gridline",L:"path"},q={K:"tick",L:"path"},Z={K:"tick",L:"text"},W={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},G=v("../../constants/alignment"),X=G.MID_SHIFT,ne=G.CAP_SHIFT,V=G.LINE_SPACING,N=G.OPPOSITE_SIDE,U=Q.exports={};U.setConvert=v("./set_convert");var ee=v("./axis_autotype"),B=v("./axis_ids"),K=B.idSort,J=B.isLinked;U.id2name=B.id2name,U.name2id=B.name2id,U.cleanId=B.cleanId,U.list=B.list,U.listIds=B.listIds,U.getFromId=B.getFromId,U.getFromTrace=B.getFromTrace;var te=v("./autorange");function ae(he){var be=1e-4*(he[1]-he[0]);return[he[0]-be,he[1]+be]}U.getAutoRange=te.getAutoRange,U.findExtremes=te.findExtremes,U.coerceRef=function(he,be,Fe,He,Ke,Ze){var ut=He.charAt(He.length-1),lt=Fe._fullLayout._subplots[ut+"axis"],Lt=He+"ref",Ot={};return Ke||(Ke=lt[0]||("string"==typeof Ze?Ze:Ze[0])),Ze||(Ze=Ke),lt=lt.concat(lt.map(function(ot){return ot+" domain"})),Ot[Lt]={valType:"enumerated",values:lt.concat(Ze?"string"==typeof Ze?[Ze]:Ze:[]),dflt:Ke},e.coerce(he,be,Ot,Lt)},U.getRefType=function(he){return void 0===he?he:"paper"===he?"paper":"pixel"===he?"pixel":/( domain)$/.test(he)?"domain":"range"},U.coercePosition=function(he,be,Fe,He,Ke,Ze){var ut,lt;if("range"!==U.getRefType(He))ut=e.ensureNumber,lt=Fe(Ke,Ze);else{var Lt=U.getFromId(be,He);lt=Fe(Ke,Ze=Lt.fraction2r(Ze)),ut=Lt.cleanPos}he[Ke]=ut(lt)},U.cleanPosition=function(he,be,Fe){return("paper"===Fe||"pixel"===Fe?e.ensureNumber:U.getFromId(be,Fe).cleanPos)(he)},U.redrawComponents=function(he,be){be=be||U.listIds(he);var Fe=he._fullLayout;function He(Ke,Ze,ut,lt){for(var Lt=x.getComponentMethod(Ke,Ze),Ot={},ot=0;ot<be.length;ot++)for(var pt=Fe[U.id2name(be[ot])][ut],qt=0;qt<pt.length;qt++){var St=pt[qt];if(!Ot[St]&&(Lt(he,St),Ot[St]=1,lt))return}}He("annotations","drawOne","_annIndices"),He("shapes","drawOne","_shapeIndices"),He("images","draw","_imgIndices",!0),He("selections","drawOne","_selectionIndices")};var ce=U.getDataConversions=function(he,be,Fe,He){var Ke,Ze="x"===Fe||"y"===Fe||"z"===Fe?Fe:He;if(Array.isArray(Ze)){if(Ke={type:ee(He,void 0,{autotypenumbers:he._fullLayout.autotypenumbers}),_categories:[]},U.setConvert(Ke),"category"===Ke.type)for(var ut=0;ut<He.length;ut++)Ke.d2c(He[ut])}else Ke=U.getFromTrace(he,be,Ze);return Ke?{d2c:Ke.d2c,c2d:Ke.c2d}:"ids"===Ze?{d2c:ve,c2d:ve}:{d2c:oe,c2d:oe}};function oe(he){return+he}function ve(he){return String(he)}function fe(he,be){return Math.abs((he/be+.5)%1-.5)<.001}function xe(he,be){return Math.abs(he/be-1)<.001}function Se(he){return+he.substring(1)}function pe(he){var be=ae(e.simpleMap(he.range,he.r2l)),Fe=Math.min(be[0],be[1]),He=Math.max(be[0],be[1]),Ke="category"===he.type?he.d2l_noadd:he.d2l;"log"===he.type&&"L"!==String(he.dtick).charAt(0)&&(he.dtick="L"+Math.pow(10,Math.floor(Math.min(he.range[0],he.range[1]))-1));for(var Ze=[],ut=0;ut<=1;ut++)if(!ut||he.minor){var lt=ut?he.minor.tickvals:he.tickvals,Lt=ut?[]:he.ticktext;if(lt){Array.isArray(Lt)||(Lt=[]);for(var Ot=0;Ot<lt.length;Ot++){var ot=Ke(lt[Ot]);if(ot>Fe&&ot<He){var pt=void 0===Lt[Ot]?U.tickText(he,ot):Ie(he,ot,String(Lt[Ot]));ut&&(pt.minor=!0,pt.text=""),Ze.push(pt)}}}}return he.rangebreaks&&(Ze=Ze.filter(function(qt){return he.maskBreaks(qt.x)!==C})),Ze}U.getDataToCoordFunc=function(he,be,Fe,He){return ce(he,be,Fe,He).d2c},U.counterLetter=function(he){var be=he.charAt(0);return"x"===be?"y":"y"===be?"x":void 0},U.minDtick=function(he,be,Fe,He){-1===["log","category","multicategory"].indexOf(he.type)&&He?void 0===he._minDtick?(he._minDtick=be,he._forceTick0=Fe):he._minDtick&&((he._minDtick/be+1e-6)%1<2e-6&&((Fe-he._forceTick0)/be%1+1.000001)%1<2e-6?(he._minDtick=be,he._forceTick0=Fe):((be/he._minDtick+1e-6)%1>2e-6||((Fe-he._forceTick0)/he._minDtick%1+1.000001)%1>2e-6)&&(he._minDtick=0)):he._minDtick=0},U.saveRangeInitial=function(he,be){for(var Fe=U.list(he,"",!0),He=!1,Ke=0;Ke<Fe.length;Ke++){var Ze=Fe[Ke],ut=void 0===Ze._rangeInitial;(ut&&!1===Ze.autorange||be&&(ut||Ze.range[0]!==Ze._rangeInitial[0]||Ze.range[1]!==Ze._rangeInitial[1]))&&(Ze._rangeInitial=Ze.range.slice(),He=!0)}return He},U.saveShowSpikeInitial=function(he,be){for(var Fe=U.list(he,"",!0),He=!1,Ke="on",Ze=0;Ze<Fe.length;Ze++){var ut=Fe[Ze],lt=void 0===ut._showSpikeInitial;(lt||be&&(lt||ut.showspikes!==ut._showspikes))&&(ut._showSpikeInitial=ut.showspikes,He=!0),"on"!==Ke||ut.showspikes||(Ke="off")}return he._fullLayout._cartesianSpikesEnabled=Ke,He},U.autoBin=function(he,be,Fe,He,Ke,Ze){var ut,lt=e.aggNums(Math.min,null,he),Lt=e.aggNums(Math.max,null,he);if("category"===be.type||"multicategory"===be.type)return{start:lt-.5,end:Lt+.5,size:Math.max(1,Math.round(Ze)||1),_dataSpan:Lt-lt};if(Ke||(Ke=be.calendar),ut="log"===be.type?{type:"linear",range:[lt,Lt]}:{type:be.type,range:e.simpleMap([lt,Lt],be.c2r,0,Ke),calendar:Ke},U.setConvert(ut),Ze=Ze&&s.dtick(Ze,ut.type))ut.dtick=Ze,ut.tick0=s.tick0(void 0,ut.type,Ke);else{var Ot;if(Fe)Ot=(Lt-lt)/Fe;else{var ot=e.distinctVals(he),pt=Math.pow(10,Math.floor(Math.log(ot.minDiff)/Math.LN10)),qt=pt*e.roundUp(ot.minDiff/pt,[.9,1.9,4.9,9.9],!0);Ot=Math.max(qt,2*e.stdev(he)/Math.pow(he.length,He?.25:.4)),t(Ot)||(Ot=1)}U.autoTicks(ut,Ot)}var St,Mt=ut.dtick,Ce=U.tickIncrement(U.tickFirst(ut),Mt,"reverse",Ke);if("number"==typeof Mt)St=(Ce=function(Xe,st,dt,zt,Ht){var Kt=0,Zt=0,vn=0,zn=0;function gn(mn){return(1+100*(mn-Xe)/dt.dtick)%100<2}for(var nn=0;nn<st.length;nn++)st[nn]%1==0?vn++:t(st[nn])||zn++,gn(st[nn])&&Kt++,gn(st[nn]+dt.dtick/2)&&Zt++;var an=st.length-zn;if(vn===an&&"date"!==dt.type)dt.dtick<1?Xe=zt-.5*dt.dtick:(Xe-=.5)+dt.dtick<zt&&(Xe+=dt.dtick);else if(Zt<.1*an&&(Kt>.3*an||gn(zt)||gn(Ht))){var on=dt.dtick/2;Xe+=Xe+on<zt?on:-on}return Xe}(Ce,he,ut,lt,Lt))+(1+Math.floor((Lt-Ce)/Mt))*Mt;else for("M"===ut.dtick.charAt(0)&&(Ce=function(Xe,st,dt,zt,Ht){var Kt=e.findExactDates(st,Ht);if(Kt.exactDays>.8){var Zt=Number(dt.substr(1));Kt.exactYears>.8&&Zt%12==0?Xe=U.tickIncrement(Xe,"M6","reverse")+1.5*T:Kt.exactMonths>.8?Xe=U.tickIncrement(Xe,"M1","reverse")+15.5*T:Xe-=L;var vn=U.tickIncrement(Xe,dt);if(vn<=zt)return vn}return Xe}(Ce,he,Mt,lt,Ke)),St=Ce;St<=Lt;)St=U.tickIncrement(St,Mt,!1,Ke);return{start:be.c2r(Ce,0,Ke),end:be.c2r(St,0,Ke),size:Mt,_dataSpan:Lt-lt}},U.prepMinorTicks=function(he,be,Fe){if(!be.minor.dtick){delete he.dtick;var He,Ke=be.dtick&&t(be._tmin);if(Ke){var Ze=U.tickIncrement(be._tmin,be.dtick,!0);He=[be._tmin,.99*Ze+.01*be._tmin]}else{var ut=e.simpleMap(be.range,be.r2l);He=[ut[0],.8*ut[0]+.2*ut[1]]}if(he.range=e.simpleMap(He,be.l2r),he._isMinor=!0,U.prepTicks(he,Fe),Ke){var lt=t(be.dtick),Lt=t(he.dtick),Ot=lt?be.dtick:+be.dtick.substring(1),ot=Lt?he.dtick:+he.dtick.substring(1);lt&&Lt?fe(Ot,ot)?Ot===2*w&&ot===2*T&&(he.dtick=w):he.dtick=Ot===2*w&&ot===3*T?w:Ot!==w||(be._input.minor||{}).nticks?xe(Ot/ot,2.5)?Ot/2:Ot:T:"M"===String(be.dtick).charAt(0)?Lt?he.dtick="M1":fe(Ot,ot)?Ot>=12&&2===ot&&(he.dtick="M3"):he.dtick=be.dtick:"L"===String(he.dtick).charAt(0)?"L"===String(be.dtick).charAt(0)?fe(Ot,ot)||(he.dtick=xe(Ot/ot,2.5)?be.dtick/2:be.dtick):he.dtick="D1":"D2"===he.dtick&&+be.dtick>1&&(he.dtick=1)}he.range=be.range}void 0===be.minor._tick0Init&&(he.tick0=be.tick0)},U.prepTicks=function(he,be){var Fe=e.simpleMap(he.range,he.r2l,void 0,void 0,be);if("auto"===he.tickmode||!he.dtick){var He,Ke=he.nticks;Ke||("category"===he.type||"multicategory"===he.type?(He=he.tickfont?e.bigFont(he.tickfont.size||12):15,Ke=he._length/He):(He="y"===he._id.charAt(0)?40:80,Ke=e.constrain(he._length/He,4,9)+1),"radialaxis"===he._name&&(Ke*=2)),he.minor&&"array"!==he.minor.tickmode||"array"===he.tickmode&&(Ke*=100),he._roughDTick=Math.abs(Fe[1]-Fe[0])/Ke,U.autoTicks(he,he._roughDTick),he._minDtick>0&&he.dtick<2*he._minDtick&&(he.dtick=he._minDtick,he.tick0=he.l2r(he._forceTick0))}"period"===he.ticklabelmode&&function(Ze){var ut;function lt(){return!(t(Ze.dtick)||"M"!==Ze.dtick.charAt(0))}var Lt=lt(),Ot=U.getTickFormat(Ze);if(Ot){var ot=Ze._dtickInit!==Ze.dtick;/%[fLQsSMX]/.test(Ot)||(/%[HI]/.test(Ot)?(ut=M,ot&&!Lt&&Ze.dtick<M&&(Ze.dtick=M)):/%p/.test(Ot)?(ut=L,ot&&!Lt&&Ze.dtick<L&&(Ze.dtick=L)):/%[Aadejuwx]/.test(Ot)?(ut=T,ot&&!Lt&&Ze.dtick<T&&(Ze.dtick=T)):/%[UVW]/.test(Ot)?(ut=w,ot&&!Lt&&Ze.dtick<w&&(Ze.dtick=w)):/%[Bbm]/.test(Ot)?(ut=_,ot&&(Lt?Se(Ze.dtick)<1:Ze.dtick<b)&&(Ze.dtick="M1")):/%[q]/.test(Ot)?(ut=a,ot&&(Lt?Se(Ze.dtick)<3:Ze.dtick<y)&&(Ze.dtick="M3")):/%[Yy]/.test(Ot)&&(ut=o,ot&&(Lt?Se(Ze.dtick)<12:Ze.dtick<d)&&(Ze.dtick="M12")))}(Lt=lt())&&Ze.tick0===Ze._dowTick0&&(Ze.tick0=Ze._rawTick0),Ze._definedDelta=ut}(he),he.tick0||(he.tick0="date"===he.type?"2000-01-01":0),"date"===he.type&&he.dtick<.1&&(he.dtick=.1),Oe(he)},U.calcTicks=function(he,be){for(var Fe,He,Ke=he.type,Ze=he.calendar,ut=he.ticklabelstep,lt="period"===he.ticklabelmode,Lt=e.simpleMap(he.range,he.r2l,void 0,void 0,be),Ot=Lt[1]<Lt[0],ot=Math.min(Lt[0],Lt[1]),pt=Math.max(Lt[0],Lt[1]),qt=Math.max(1e3,he._length||0),St=[],Mt=[],Ce=[],Xe=[],st=he.minor&&(he.minor.ticks||he.minor.showgrid),dt=1;dt>=(st?0:1);dt--){var zt=!dt;dt?(he._dtickInit=he.dtick,he._tick0Init=he.tick0):(he.minor._dtickInit=he.minor.dtick,he.minor._tick0Init=he.minor.tick0);var Ht=dt?he:e.extendFlat({},he,he.minor);if(zt?U.prepMinorTicks(Ht,he,be):U.prepTicks(Ht,be),"array"!==Ht.tickmode){var Kt=ae(Lt),Zt=Kt[0],vn=Kt[1],zn=t(Ht.dtick),gn="log"===Ke&&!(zn||"L"===Ht.dtick.charAt(0)),nn=U.tickFirst(Ht,be);if(dt){if(he._tmin=nn,nn<Zt!==Ot)break;"category"!==Ke&&"multicategory"!==Ke||(vn=Ot?Math.max(-.5,vn):Math.min(he._categories.length-.5,vn))}var an,on,mn=null,_n=nn;dt&&(zn?on=he.dtick:"date"===Ke?"string"==typeof he.dtick&&"M"===he.dtick.charAt(0)&&(on=_*he.dtick.substring(1)):on=he._roughDTick,an=Math.round((he.r2l(_n)-he.r2l(he.tick0))/on)-1);var Pn=Ht.dtick;for(Ht.rangebreaks&&Ht._tick0Init!==Ht.tick0&&(_n=Rt(_n,he),Ot||(_n=U.tickIncrement(_n,Pn,!Ot,Ze))),dt&&lt&&(_n=U.tickIncrement(_n,Pn,!Ot,Ze),an--);Ot?_n>=vn:_n<=vn;_n=U.tickIncrement(_n,Pn,Ot,Ze)){if(dt&&an++,Ht.rangebreaks&&!Ot){if(_n<Zt)continue;if(Ht.maskBreaks(_n)===C&&Rt(_n,Ht)>=pt)break}if(Ce.length>qt||_n===mn)break;mn=_n;var Rn={value:_n};dt?(gn&&_n!==(0|_n)&&(Rn.simpleLabel=!0),ut>1&&an%ut&&(Rn.skipLabel=!0),Ce.push(Rn)):(Rn.minor=!0,Xe.push(Rn))}}else dt?(Ce=[],St=pe(he)):(Xe=[],Mt=pe(he))}if(st&&!("inside"===he.minor.ticks&&"outside"===he.ticks||"outside"===he.minor.ticks&&"inside"===he.ticks)){for(var qn=Ce.map(function(jr){return jr.value}),Xn=[],br=0;br<Xe.length;br++){var fr=Xe[br],Vr=fr.value;if(-1===qn.indexOf(Vr)){for(var cr=!1,Sr=0;!cr&&Sr<Ce.length;Sr++)1e7+Ce[Sr].value===1e7+Vr&&(cr=!0);cr||Xn.push(fr)}}Xe=Xn}if(lt&&function(jr,ri,sn){for(var wn=0;wn<jr.length;wn++){var It=jr[wn].value,hn=wn,yn=wn+1;wn<jr.length-1?(hn=wn,yn=wn+1):wn>0?(hn=wn-1,yn=wn):(hn=wn,yn=wn);var Hn,On=Math.abs(jr[yn].value-jr[hn].value),kn=sn||On,Mn=0;kn>=d?Mn=On>=d&&On<=l?On:o:sn===a&&kn>=y?Mn=On>=y&&On<=u?On:a:kn>=b?Mn=On>=b&&On<=h?On:_:sn===w&&kn>=w?Mn=w:kn>=T?Mn=T:sn===L&&kn>=L?Mn=L:sn===M&&kn>=M&&(Mn=M),Mn>=On&&(Mn=On,Hn=!0);var Ln=It+Mn;if(ri.rangebreaks&&Mn>0){for(var Dn=0,Kn=0;Kn<84;Kn++){var Qn=(Kn+.5)/84;ri.maskBreaks(It*(1-Qn)+Qn*Ln)!==C&&Dn++}(Mn*=Dn/84)||(jr[wn].drop=!0),Hn&&On>w&&(Mn=On)}(Mn>0||0===wn)&&(jr[wn].periodX=It+Mn/2)}}(Ce,he,he._definedDelta),he.rangebreaks){var Cr="y"===he._id.charAt(0),pi=1;"auto"===he.tickmode&&(pi=he.tickfont?he.tickfont.size:12);var Yn=NaN;for(Fe=Ce.length-1;Fe>-1;Fe--)if(Ce[Fe].drop)Ce.splice(Fe,1);else{Ce[Fe].value=Rt(Ce[Fe].value,he);var ar=he.c2p(Ce[Fe].value);(Cr?Yn>ar-pi:Yn<ar+pi)?Ce.splice(Ot?Fe+1:Fe,1):Yn=ar}}cn(he)&&360===Math.abs(Lt[1]-Lt[0])&&Ce.pop(),he._tmax=(Ce[Ce.length-1]||{}).value,he._prevDateHead="",he._inCalcTicks=!0;var Ar,sr,dr=function(jr){jr.text="",he._prevDateHead=He};for(Ce=Ce.concat(Xe),Fe=0;Fe<Ce.length;Fe++){var Lr=Ce[Fe].value;Ce[Fe].minor?Mt.push({x:Lr,minor:!0}):(He=he._prevDateHead,Ar=U.tickText(he,Lr,!1,Ce[Fe].simpleLabel),void 0!==(sr=Ce[Fe].periodX)&&(Ar.periodX=sr,(sr>pt||sr<ot)&&(sr>pt&&(Ar.periodX=pt),sr<ot&&(Ar.periodX=ot),dr(Ar))),Ce[Fe].skipLabel&&dr(Ar),St.push(Ar))}return St=St.concat(Mt),he._inCalcTicks=!1,lt&&St.length&&(St[0].noTick=!0),St};var ge=[2,5,10],Te=[1,2,3,6,12],se=[1,2,5,10,15,30],de=[1,2,3,7,14],Ae=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Le=[-.301,0,.301,.699,1],Me=[15,30,45,90,180];function De(he,be,Fe){return be*e.roundUp(he/be,Fe)}function Oe(he){var be=he.dtick;if(he._tickexponent=0,t(be)||"string"==typeof be||(be=1),"category"!==he.type&&"multicategory"!==he.type||(he._tickround=null),"date"===he.type){var Fe=he.r2l(he.tick0),He=he.l2r(Fe).replace(/(^-|i)/g,""),Ke=He.length;if("M"===String(be).charAt(0))he._tickround=Ke>10||"01-01"!==He.substr(5)?"d":+be.substr(1)%12==0?"y":"m";else if(be>=T&&Ke<=10||be>=15*T)he._tickround="d";else if(be>=P&&Ke<=16||be>=M)he._tickround="M";else if(be>=z&&Ke<=19||be>=P)he._tickround="S";else{var Ze=he.l2r(Fe+be).replace(/^-/,"").length;he._tickround=Math.max(Ke,Ze)-20,he._tickround<0&&(he._tickround=4)}}else if(t(be)||"L"===be.charAt(0)){var ut=he.range.map(he.r2d||Number);t(be)||(be=Number(be.substr(1))),he._tickround=2-Math.floor(Math.log(be)/Math.LN10+.01);var lt=Math.max(Math.abs(ut[0]),Math.abs(ut[1])),Lt=Math.floor(Math.log(lt)/Math.LN10+.01),Ot=void 0===he.minexponent?3:he.minexponent;Math.abs(Lt)>Ot&&(he._tickexponent=Ne(he.exponentformat)&&!Pe(Lt)?3*Math.round((Lt-1)/3):Lt)}else he._tickround=null}function Ie(he,be,Fe){var He=he.tickfont||{};return{x:be,dx:0,dy:0,text:Fe||"",fontSize:He.size,font:He.family,fontColor:He.color}}U.autoTicks=function(he,be,Fe){var He;function Ke(pt){return Math.pow(pt,Math.floor(Math.log(be)/Math.LN10))}if("date"===he.type){he.tick0=e.dateTick0(he.calendar,0);var Ze=2*be;if(Ze>o)be/=o,He=Ke(10),he.dtick="M"+12*De(be,He,ge);else if(Ze>_)he.dtick="M"+De(be/=_,1,Te);else if(Ze>T){if(he.dtick=De(be,T,he._hasDayOfWeekBreaks?[1,2,7,14]:de),!Fe){var ut=U.getTickFormat(he),lt="period"===he.ticklabelmode;lt&&(he._rawTick0=he.tick0),he.tick0=/%[uVW]/.test(ut)?e.dateTick0(he.calendar,2):e.dateTick0(he.calendar,1),lt&&(he._dowTick0=he.tick0)}}else Ze>M?he.dtick=De(be,M,Te):Ze>P?he.dtick=De(be,P,se):Ze>z?he.dtick=De(be,z,se):(He=Ke(10),he.dtick=De(be,He,ge))}else if("log"===he.type){he.tick0=0;var Lt=e.simpleMap(he.range,he.r2l);if(he._isMinor&&(be*=1.5),be>.7)he.dtick=Math.ceil(be);else if(Math.abs(Lt[1]-Lt[0])<1){var Ot=1.5*Math.abs((Lt[1]-Lt[0])/be);be=Math.abs(Math.pow(10,Lt[1])-Math.pow(10,Lt[0]))/Ot,He=Ke(10),he.dtick="L"+De(be,He,ge)}else he.dtick=be>.3?"D2":"D1"}else"category"===he.type||"multicategory"===he.type?(he.tick0=0,he.dtick=Math.ceil(Math.max(be,1))):cn(he)?(he.tick0=0,he.dtick=De(be,He=1,Me)):(he.tick0=0,He=Ke(10),he.dtick=De(be,He,ge));if(0===he.dtick&&(he.dtick=1),!t(he.dtick)&&"string"!=typeof he.dtick){var ot=he.dtick;throw he.dtick=1,"ax.dtick error: "+String(ot)}},U.tickIncrement=function(he,be,Fe,He){var Ke=Fe?-1:1;if(t(be))return e.increment(he,Ke*be);var Ze=be.charAt(0),ut=Ke*Number(be.substr(1));if("M"===Ze)return e.incrementMonth(he,ut,He);if("L"===Ze)return Math.log(Math.pow(10,he)+ut)/Math.LN10;if("D"===Ze){var lt="D2"===be?Le:Ae,Lt=he+.01*Ke,Ot=e.roundUp(e.mod(Lt,1),lt,Fe);return Math.floor(Lt)+Math.log(g.round(Math.pow(10,Ot),1))/Math.LN10}throw"unrecognized dtick "+String(be)},U.tickFirst=function(he,be){var Fe=he.r2l||Number,He=e.simpleMap(he.range,Fe,void 0,void 0,be),Ke=He[1]<He[0],Ze=Ke?Math.floor:Math.ceil,ut=ae(He)[0],lt=he.dtick,Lt=Fe(he.tick0);if(t(lt)){var Ot=Ze((ut-Lt)/lt)*lt+Lt;return"category"!==he.type&&"multicategory"!==he.type||(Ot=e.constrain(Ot,0,he._categories.length-1)),Ot}var ot=lt.charAt(0),pt=Number(lt.substr(1));if("M"===ot){for(var qt,St,Mt,Ce=0,Xe=Lt;Ce<10;){if(((qt=U.tickIncrement(Xe,lt,Ke,he.calendar))-ut)*(Xe-ut)<=0)return Ke?Math.min(Xe,qt):Math.max(Xe,qt);St=(ut-(Xe+qt)/2)/(qt-Xe),Mt=ot+(Math.abs(Math.round(St))||1)*pt,Xe=U.tickIncrement(Xe,Mt,St<0?!Ke:Ke,he.calendar),Ce++}return e.error("tickFirst did not converge",he),Xe}if("L"===ot)return Math.log(Ze((Math.pow(10,ut)-Lt)/pt)*pt+Lt)/Math.LN10;if("D"===ot){var st="D2"===lt?Le:Ae,dt=e.roundUp(e.mod(ut,1),st,Ke);return Math.floor(ut)+Math.log(g.round(Math.pow(10,dt),1))/Math.LN10}throw"unrecognized dtick "+String(lt)},U.tickText=function(he,be,Fe,He){var Ke,Ze=Ie(he,be),ut="array"===he.tickmode,lt=Fe||ut,Lt=he.type,Ot="category"===Lt?he.d2l_noadd:he.d2l;if(ut&&Array.isArray(he.ticktext)){var ot=e.simpleMap(he.range,he.r2l),pt=(Math.abs(ot[1]-ot[0])-(he._lBreaks||0))/1e4;for(Ke=0;Ke<he.ticktext.length&&!(Math.abs(be-Ot(he.tickvals[Ke]))<pt);Ke++);if(Ke<he.ticktext.length)return Ze.text=String(he.ticktext[Ke]),Ze}function qt(Ce){return void 0===Ce||(Fe?"none"===Ce:"all"!==Ce&&be!=={first:he._tmin,last:he._tmax}[Ce])}var Xe,st,St=Fe?"never":"none"!==he.exponentformat&&qt(he.showexponent)?"hide":"";if("date"===Lt?function(Ce,Xe,st,dt){var zt=Ce._tickround,Ht=st&&Ce.hoverformat||U.getTickFormat(Ce);dt&&(zt=t(zt)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[zt]);var Kt,Zt=e.formatDate(Xe.x,Ht,zt,Ce._dateFormat,Ce.calendar,Ce._extraFormat),vn=Zt.indexOf("\n");if(-1!==vn&&(Kt=Zt.substr(vn+1),Zt=Zt.substr(0,vn)),dt&&("00:00:00"===Zt||"00:00"===Zt?(Zt=Kt,Kt=""):8===Zt.length&&(Zt=Zt.replace(/:00$/,""))),Kt)if(st)"d"===zt?Zt+=", "+Kt:Zt=Kt+(Zt?", "+Zt:"");else if(Ce._inCalcTicks&&Ce._prevDateHead===Kt){var zn=je(Ce),gn=Ce._trueSide||Ce.side;(!zn&&"top"===gn||zn&&"bottom"===gn)&&(Zt+="<br> ")}else Ce._prevDateHead=Kt,Zt+="<br>"+Kt;Xe.text=Zt}(he,Ze,Fe,lt):"log"===Lt?function(Ce,Xe,st,dt,zt){var Ht=Ce.dtick,Kt=Xe.x,Zt=Ce.tickformat,vn="string"==typeof Ht&&Ht.charAt(0);if("never"===zt&&(zt=""),dt&&"L"!==vn&&(Ht="L3",vn="L"),Zt||"L"===vn)Xe.text=Re(Math.pow(10,Kt),Ce,zt,dt);else if(t(Ht)||"D"===vn&&e.mod(Kt+.01,1)<.1){var zn=Math.round(Kt),gn=Math.abs(zn),nn=Ce.exponentformat;"power"===nn||Ne(nn)&&Pe(zn)?(Xe.text=0===zn?1:1===zn?"10":"10<sup>"+(zn>1?"":S)+gn+"</sup>",Xe.fontSize*=1.25):("e"===nn||"E"===nn)&&gn>2?Xe.text="1"+nn+(zn>0?"+":S)+gn:(Xe.text=Re(Math.pow(10,Kt),Ce,"","fakehover"),"D1"===Ht&&"y"===Ce._id.charAt(0)&&(Xe.dy-=Xe.fontSize/6))}else{if("D"!==vn)throw"unrecognized dtick "+String(Ht);Xe.text=String(Math.round(Math.pow(10,e.mod(Kt,1)))),Xe.fontSize*=.75}if("D1"===Ce.dtick){var an=String(Xe.text).charAt(0);"0"!==an&&"1"!==an||("y"===Ce._id.charAt(0)?Xe.dx-=Xe.fontSize/4:(Xe.dy+=Xe.fontSize/2,Xe.dx+=(Ce.range[1]>Ce.range[0]?1:-1)*Xe.fontSize*(Kt<0?.5:.25)))}}(he,Ze,0,lt,St):"category"===Lt?(Xe=Ze,void 0===(st=he._categories[Math.round(Xe.x)])&&(st=""),Xe.text=String(st)):"multicategory"===Lt?function(Ce,Xe,st){var dt=Math.round(Xe.x),zt=Ce._categories[dt]||[],Ht=void 0===zt[1]?"":String(zt[1]),Kt=void 0===zt[0]?"":String(zt[0]);st?Xe.text=Kt+" - "+Ht:(Xe.text=Ht,Xe.text2=Kt)}(he,Ze,Fe):cn(he)?function(Ce,Xe,st,dt,zt){if("radians"!==Ce.thetaunit||st)Xe.text=Re(Xe.x,Ce,zt,dt);else{var Ht=Xe.x/180;if(0===Ht)Xe.text="0";else{var Kt=function(vn){function zn(on,mn){return Math.abs(on-mn)<=1e-6}var gn=function(on){for(var mn=1;!zn(Math.round(on*mn)/mn,on);)mn*=10;return mn}(vn),nn=vn*gn,an=Math.abs(function on(mn,_n){return zn(_n,0)?mn:on(_n,mn%_n)}(nn,gn));return[Math.round(nn/an),Math.round(gn/an)]}(Ht);if(Kt[1]>=100)Xe.text=Re(e.deg2rad(Xe.x),Ce,zt,dt);else{var Zt=Xe.x<0;Xe.text=1===Kt[1]?1===Kt[0]?"\u03c0":Kt[0]+"\u03c0":["<sup>",Kt[0],"</sup>","\u2044","<sub>",Kt[1],"</sub>","\u03c0"].join(""),Zt&&(Xe.text=S+Xe.text)}}}}(he,Ze,Fe,lt,St):function(Ce,Xe,st,dt,zt){"never"===zt?zt="":"all"===Ce.showexponent&&Math.abs(Xe.x/Ce.dtick)<1e-6&&(zt="hide"),Xe.text=Re(Xe.x,Ce,zt,dt)}(he,Ze,0,lt,St),He||(he.tickprefix&&!qt(he.showtickprefix)&&(Ze.text=he.tickprefix+Ze.text),he.ticksuffix&&!qt(he.showticksuffix)&&(Ze.text+=he.ticksuffix)),"boundaries"===he.tickson||he.showdividers){var Mt=function(Ce){var Xe=he.l2p(Ce);return Xe>=0&&Xe<=he._length?Ce:null};Ze.xbnd=[Mt(Ze.x-.5),Mt(Ze.x+he.dtick-.5)]}return Ze},U.hoverLabelText=function(he,be,Fe){Fe&&(he=e.extendFlat({},he,{hoverformat:Fe}));var He=Array.isArray(be)?be[0]:be,Ke=Array.isArray(be)?be[1]:void 0;if(void 0!==Ke&&Ke!==He)return U.hoverLabelText(he,He,Fe)+" - "+U.hoverLabelText(he,Ke,Fe);var Ze="log"===he.type&&He<=0,ut=U.tickText(he,he.c2l(Ze?-He:He),"hover").text;return Ze?0===He?"0":S+ut:ut};var Qe=["f","p","n","\u03bc","m","","k","M","G","T"];function Ne(he){return"SI"===he||"B"===he}function Pe(he){return he>14||he<-15}function Re(he,be,Fe,He){var Ke=he<0,Ze=be._tickround,ut=Fe||be.exponentformat||"B",lt=be._tickexponent,Lt=U.getTickFormat(be),Ot=be.separatethousands;if(He){var ot={exponentformat:ut,minexponent:be.minexponent,dtick:"none"===be.showexponent?be.dtick:t(he)&&Math.abs(he)||1,range:"none"===be.showexponent?be.range.map(be.r2d):[0,he||1]};Oe(ot),Ze=(Number(ot._tickround)||0)+4,lt=ot._tickexponent,be.hoverformat&&(Lt=be.hoverformat)}if(Lt)return be._numFormat(Lt)(he).replace(/-/g,S);var pt,qt=Math.pow(10,-Ze)/2;if("none"===ut&&(lt=0),(he=Math.abs(he))<qt)he="0",Ke=!1;else{if(he+=qt,lt&&(he*=Math.pow(10,-lt),Ze+=lt),0===Ze)he=String(Math.floor(he));else if(Ze<0){he=(he=String(Math.round(he))).substr(0,he.length+Ze);for(var St=Ze;St<0;St++)he+="0"}else{var Mt=(he=String(he)).indexOf(".")+1;Mt&&(he=he.substr(0,Mt+Ze).replace(/\.?0+$/,""))}he=e.numSeparate(he,be._separators,Ot)}return lt&&"hide"!==ut&&(Ne(ut)&&Pe(lt)&&(ut="power"),pt=lt<0?S+-lt:"power"!==ut?"+"+lt:String(lt),"e"===ut||"E"===ut?he+=ut+pt:"power"===ut?he+="\xd710<sup>"+pt+"</sup>":"B"===ut&&9===lt?he+="B":Ne(ut)&&(he+=Qe[lt/3+5])),Ke?S+he:he}function Ge(he,be){if(he){var Fe=Object.keys(W).reduce(function(He,Ke){return-1!==be.indexOf(Ke)&&W[Ke].forEach(function(Ze){He[Ze]=1}),He},{});Object.keys(he).forEach(function(He){Fe[He]||(1===He.length?he[He]=0:delete he[He])})}}function tt(he,be){for(var Fe=[],He={},Ke=0;Ke<be.length;Ke++){var Ze=be[Ke];He[Ze.text2]?He[Ze.text2].push(Ze.x):He[Ze.text2]=[Ze.x]}for(var ut in He)Fe.push(Ie(he,e.interp(He[ut],.5),ut));return Fe}function ct(he){return void 0!==he.periodX?he.periodX:he.x}function wt(he){return[he.text,he.x,he.axInfo,he.font,he.fontSize,he.fontColor].join("_")}function kt(he){var be=he.title.font.size,Fe=(he.title.text.match(i.BR_TAG_ALL)||[]).length;return he.title.hasOwnProperty("standoff")?Fe?be*(ne+Fe*V):be*ne:Fe?be*(Fe+1)*V:be}function gt(he,be){var Fe=he.l2p(be);return Fe>1&&Fe<he._length-1}function at(he){var be=g.select(he),Fe=be.select(".text-math-group");return Fe.empty()?be.select("text"):Fe}function et(he){return he._id+".automargin"}function yt(he){return et(he)+".mirror"}function Vt(he){return he._id+".rangeslider"}function Gt(he,be){for(var Fe=0;Fe<be.length;Fe++)-1===he.indexOf(be[Fe])&&he.push(be[Fe])}function en(he,be,Fe){var He,Ke,Ze=[],ut=[],lt=he.layout;for(He=0;He<be.length;He++)Ze.push(U.getFromId(he,be[He]));for(He=0;He<Fe.length;He++)ut.push(U.getFromId(he,Fe[He]));var Lt=Object.keys(p),Ot=["anchor","domain","overlaying","position","side","tickangle","editType"],ot=["linear","log"];for(He=0;He<Lt.length;He++){var pt=Lt[He],qt=Ze[0][pt],St=ut[0][pt],Mt=!0,Ce=!1,Xe=!1;if("_"!==pt.charAt(0)&&"function"!=typeof qt&&-1===Ot.indexOf(pt)){for(Ke=1;Ke<Ze.length&&Mt;Ke++){var st=Ze[Ke][pt];"type"===pt&&-1!==ot.indexOf(qt)&&-1!==ot.indexOf(st)&&qt!==st?Ce=!0:st!==qt&&(Mt=!1)}for(Ke=1;Ke<ut.length&&Mt;Ke++){var dt=ut[Ke][pt];"type"===pt&&-1!==ot.indexOf(St)&&-1!==ot.indexOf(dt)&&St!==dt?Xe=!0:ut[Ke][pt]!==St&&(Mt=!1)}Mt&&(Ce&&(lt[Ze[0]._name].type="linear"),Xe&&(lt[ut[0]._name].type="linear"),Jt(lt,pt,Ze,ut,he._fullLayout._dfltTitle))}}for(He=0;He<he._fullLayout.annotations.length;He++){var zt=he._fullLayout.annotations[He];-1!==be.indexOf(zt.xref)&&-1!==Fe.indexOf(zt.yref)&&e.swapAttrs(lt.annotations[He],["?"])}}function Jt(he,be,Fe,He,Ke){var Ze,ut=e.nestedProperty,lt=ut(he[Fe[0]._name],be).get(),Lt=ut(he[He[0]._name],be).get();for("title"===be&&(lt&&lt.text===Ke.x&&(lt.text=Ke.y),Lt&&Lt.text===Ke.y&&(Lt.text=Ke.x)),Ze=0;Ze<Fe.length;Ze++)ut(he,Fe[Ze]._name+"."+be).set(Lt);for(Ze=0;Ze<He.length;Ze++)ut(he,He[Ze]._name+"."+be).set(lt)}function cn(he){return"angularaxis"===he._id}function Rt(he,be){for(var Fe=be._rangebreaks.length,He=0;He<Fe;He++){var Ke=be._rangebreaks[He];if(he>=Ke.min&&he<Ke.max)return Ke.max}return he}function je(he){return-1!==(he.ticklabelposition||"").indexOf("inside")}function Ye(he,be){je(he._anchorAxis||{})&&he._hideCounterAxisInsideTickLabels&&he._hideCounterAxisInsideTickLabels(be)}U.getTickFormat=function(he){var be,Fe,He,Ke,Ze,ut,lt,Lt,qt,St,Mt,Ce,Xe,st;function Ot(qt){return"string"!=typeof qt?qt:Number(qt.replace("M",""))*_}function ot(qt,St){var Mt=["L","D"];if(typeof qt==typeof St){if("number"==typeof qt)return qt-St;var Ce=Mt.indexOf(qt.charAt(0)),Xe=Mt.indexOf(St.charAt(0));return Ce===Xe?Number(qt.replace(/(L|D)/g,""))-Number(St.replace(/(L|D)/g,"")):Ce-Xe}return"number"==typeof qt?1:-1}if(he.tickformatstops&&he.tickformatstops.length>0)switch(he.type){case"date":case"linear":for(be=0;be<he.tickformatstops.length;be++)if((He=he.tickformatstops[be]).enabled&&(Ke=he.dtick,ut=void 0,void 0,void 0,ut=Ot||function(qt){return qt},Lt=(Ze=He.dtickrange)[1],(!(lt=Ze[0])&&"number"!=typeof lt||ut(lt)<=ut(Ke))&&(!Lt&&"number"!=typeof Lt||ut(Lt)>=ut(Ke)))){Fe=He;break}break;case"log":for(be=0;be<he.tickformatstops.length;be++)if((He=he.tickformatstops[be]).enabled&&(Mt=void 0,Ce=void 0,Xe=void 0,st=void 0,Mt=null===(St=He.dtickrange)[0],Ce=null===St[1],Xe=ot(qt=he.dtick,St[0])>=0,st=ot(qt,St[1])<=0,(Mt||Xe)&&(Ce||st))){Fe=He;break}}return Fe?Fe.value:he.tickformat},U.getSubplots=function(he,be){var Fe=he._fullLayout._subplots,He=Fe.cartesian.concat(Fe.gl2d||[]),Ke=be?U.findSubplotsWithAxis(He,be):He;return Ke.sort(function(Ze,ut){var lt=Ze.substr(1).split("y"),Lt=ut.substr(1).split("y");return lt[0]===Lt[0]?+lt[1]-+Lt[1]:+lt[0]-+Lt[0]}),Ke},U.findSubplotsWithAxis=function(he,be){for(var Fe=new RegExp("x"===be._id.charAt(0)?"^"+be._id+"y":be._id+"$"),He=[],Ke=0;Ke<he.length;Ke++){var Ze=he[Ke];Fe.test(Ze)&&He.push(Ze)}return He},U.makeClipPaths=function(he){var be=he._fullLayout;if(!be._hasOnlyLargeSploms){var Fe,He,Ke={_offset:0,_length:be.width,_id:""},Ze={_offset:0,_length:be.height,_id:""},ut=U.list(he,"x",!0),lt=U.list(he,"y",!0),Lt=[];for(Fe=0;Fe<ut.length;Fe++)for(Lt.push({x:ut[Fe],y:Ze}),He=0;He<lt.length;He++)0===Fe&&Lt.push({x:Ke,y:lt[He]}),Lt.push({x:ut[Fe],y:lt[He]});var Ot=be._clips.selectAll(".axesclip").data(Lt,function(ot){return ot.x._id+ot.y._id});Ot.enter().append("clipPath").classed("axesclip",!0).attr("id",function(ot){return"clip"+be._uid+ot.x._id+ot.y._id}).append("rect"),Ot.exit().remove(),Ot.each(function(ot){g.select(this).select("rect").attr({x:ot.x._offset||0,y:ot.y._offset||0,width:ot.x._length||1,height:ot.y._length||1})})}},U.draw=function(he,be,Fe){var He=he._fullLayout;"redraw"===be&&He._paper.selectAll("g.subplot").each(function(Ze){var lt=He._plots[Ze[0]];if(lt){var Lt=lt.xaxis,Ot=lt.yaxis;lt.xaxislayer.selectAll("."+Lt._id+"tick").remove(),lt.yaxislayer.selectAll("."+Ot._id+"tick").remove(),lt.xaxislayer.selectAll("."+Lt._id+"tick2").remove(),lt.yaxislayer.selectAll("."+Ot._id+"tick2").remove(),lt.xaxislayer.selectAll("."+Lt._id+"divider").remove(),lt.yaxislayer.selectAll("."+Ot._id+"divider").remove(),lt.minorGridlayer&&lt.minorGridlayer.selectAll("path").remove(),lt.gridlayer&&lt.gridlayer.selectAll("path").remove(),lt.zerolinelayer&&lt.zerolinelayer.selectAll("path").remove(),He._infolayer.select(".g-"+Lt._id+"title").remove(),He._infolayer.select(".g-"+Ot._id+"title").remove()}});var Ke=be&&"redraw"!==be?be:U.listIds(he);return e.syncOrAsync(Ke.map(function(Ze){return function(){if(Ze){var ut=U.getFromId(he,Ze),lt=U.drawOne(he,ut,Fe);return ut._r=ut.range.slice(),ut._rl=e.simpleMap(ut._r,ut.r2l),lt}}}))},U.drawOne=function(he,be,Fe){var He,Ke,Ze;Fe=Fe||{},be.setScale();var ut=he._fullLayout,lt=be._id,Lt=lt.charAt(0),Ot=U.counterLetter(lt),ot=ut._plots[be._mainSubplot];if(ot){var pt=ot[Lt+"axislayer"],qt=be._mainLinePosition,St=be._mainMirrorPosition,Mt=be._vals=U.calcTicks(be),Ce=[be.mirror,qt,St].join("_");for(He=0;He<Mt.length;He++)Mt[He].axInfo=Ce;be._selections={},be._tickAngles&&(be._prevTickAngles=be._tickAngles),be._tickAngles={},be._depth=null;var Xe={};if(be.visible){var st,dt,zt=U.makeTransTickFn(be),Ht=U.makeTransTickLabelFn(be),Kt="inside"===be.ticks,Zt="outside"===be.ticks;if("boundaries"===be.tickson){var vn=function(sn,wn){var It,hn=[],yn=function(Hn,Un){var jn=Hn.xbnd[Un];null!==jn&&hn.push(e.extendFlat({},Hn,{x:jn}))};if(wn.length){for(It=0;It<wn.length;It++)yn(wn[It],0);yn(wn[It-1],1)}return hn}(0,Mt);dt=U.clipEnds(be,vn),st=Kt?dt:vn}else dt=U.clipEnds(be,Mt),st=Kt&&"period"!==be.ticklabelmode?dt:Mt;var zn,gn=be._gridVals=dt,nn=function(sn,wn){var It,hn,yn=[],Hn=wn.length&&wn[wn.length-1].x<wn[0].x,Un=function(On,kn){var Mn=On.xbnd[kn];null!==Mn&&yn.push(e.extendFlat({},On,{x:Mn}))};if(sn.showdividers&&wn.length){for(It=0;It<wn.length;It++){var jn=wn[It];jn.text2!==hn&&Un(jn,Hn?1:0),hn=jn.text2}Un(wn[It-1],Hn?0:1)}return yn}(be,Mt);if(!ut._hasOnlyLargeSploms){var an=be._subplotsWith,on={};for(He=0;He<an.length;He++){var mn=(Ze=ut._plots[Ke=an[He]])[Ot+"axis"],_n=mn._mainAxis._id;if(!on[_n]){on[_n]=1;var Pn="x"===Lt?"M0,"+mn._offset+"v"+mn._length:"M"+mn._offset+",0h"+mn._length;U.drawGrid(he,be,{vals:gn,counterAxis:mn,layer:Ze.gridlayer.select("."+lt),minorLayer:Ze.minorGridlayer.select("."+lt),path:Pn,transFn:zt}),U.drawZeroLine(he,be,{counterAxis:mn,layer:Ze.zerolinelayer,path:Pn,transFn:zt})}}}var Rn=U.getTickSigns(be),qn=U.getTickSigns(be,"minor");if(be.ticks||be.minor&&be.minor.ticks){var Xn,br,fr,Vr,cr=U.makeTickPath(be,qt,Rn[2]),Sr=U.makeTickPath(be,qt,qn[2],{minor:!0});if(be._anchorAxis&&be.mirror&&!0!==be.mirror?(Xn=U.makeTickPath(be,St,Rn[3]),br=U.makeTickPath(be,St,qn[3],{minor:!0}),fr=cr+Xn,Vr=Sr+br):(Xn="",br="",fr=cr,Vr=Sr),be.showdividers&&Zt&&"boundaries"===be.tickson){var Cr={};for(He=0;He<nn.length;He++)Cr[nn[He].x]=1;zn=function(sn){return Cr[sn.x]?Xn:fr}}else zn=function(sn){return sn.minor?Vr:fr}}if(U.drawTicks(he,be,{vals:st,layer:pt,path:zn,transFn:zt}),"allticks"===be.mirror){var pi=Object.keys(be._linepositions||{});for(He=0;He<pi.length;He++){Ze=ut._plots[Ke=pi[He]];var Yn=be._linepositions[Ke]||[],Ar=Yn[1],sr=Yn[2],dr=U.makeTickPath(be,Yn[0],sr?Rn[0]:qn[0],{minor:sr})+U.makeTickPath(be,Ar,sr?Rn[1]:qn[1],{minor:sr});U.drawTicks(he,be,{vals:st,layer:Ze[Lt+"axislayer"],path:dr,transFn:zt})}}var $r=[];if($r.push(function(){return U.drawLabels(he,be,{vals:Mt,layer:pt,plotinfo:Ze,transFn:Ht,labelFns:U.makeLabelFns(be,qt)})}),"multicategory"===be.type){var Lr={x:2,y:10}[Lt];$r.push(function(){var sn={x:"height",y:"width"}[Lt],wn=ri()[sn]+Lr+(be._tickAngles[lt+"tick"]?be.tickfont.size*V:0);return U.drawLabels(he,be,{vals:tt(be,Mt),layer:pt,cls:lt+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:zt,labelFns:U.makeLabelFns(be,qt+wn*Rn[4])})}),$r.push(function(){return be._depth=Rn[4]*(ri("tick2")[be.side]-qt),sn=he,wn=be,yn=(It={vals:nn,layer:pt,path:U.makeTickPath(be,qt,Rn[4],{len:be._depth}),transFn:zt}).vals,(Hn=It.layer.selectAll("path."+(hn=wn._id+"divider")).data(yn,wt)).exit().remove(),Hn.enter().insert("path",":first-child").classed(hn,1).classed("crisp",1).call(n.stroke,wn.dividercolor).style("stroke-width",m.crispRound(sn,wn.dividerwidth,1)+"px"),void Hn.attr("transform",It.transFn).attr("d",It.path);var sn,wn,It,hn,yn,Hn})}else be.title.hasOwnProperty("standoff")&&$r.push(function(){be._depth=Rn[4]*(ri()[be.side]-qt)});var jr=x.getComponentMethod("rangeslider","isVisible")(be);return $r.push(function(){var sn,wn,It,hn,yn=be.side.charAt(0),Hn=N[be.side].charAt(0),Un=U.getPxPosition(he,be),jn=Zt?be.ticklen:0;if((be.automargin||jr)&&("multicategory"===be.type?sn=ri("tick2"):(sn=ri(),"x"===Lt&&"b"===yn&&(be._depth=Math.max(sn.width>0?sn.bottom-Un:0,jn)))),be.automargin){wn={x:0,y:0,r:0,l:0,t:0,b:0};var On=[0,1];if("x"===Lt){if("b"===yn?wn[yn]=be._depth:(wn[yn]=be._depth=Math.max(sn.width>0?Un-sn.top:0,jn),On.reverse()),sn.width>0){var kn=sn.right-(be._offset+be._length);kn>0&&(wn.xr=1,wn.r=kn);var Mn=be._offset-sn.left;Mn>0&&(wn.xl=0,wn.l=Mn)}}else if("l"===yn?wn[yn]=be._depth=Math.max(sn.height>0?Un-sn.left:0,jn):(wn[yn]=be._depth=Math.max(sn.height>0?sn.right-Un:0,jn),On.reverse()),sn.height>0){var Ln=sn.bottom-(be._offset+be._length);Ln>0&&(wn.yb=0,wn.b=Ln);var Dn=be._offset-sn.top;Dn>0&&(wn.yt=1,wn.t=Dn)}wn[Ot]="free"===be.anchor?be.position:be._anchorAxis.domain[On[0]],be.title.text!==ut._dfltTitle[Lt]&&(wn[yn]+=kt(be)+(be.title.standoff||0)),be.mirror&&"free"!==be.anchor&&((It={x:0,y:0,r:0,l:0,t:0,b:0})[Hn]=be.linewidth,be.mirror&&!0!==be.mirror&&(It[Hn]+=jn),!0===be.mirror||"ticks"===be.mirror?It[Ot]=be._anchorAxis.domain[On[1]]:"all"!==be.mirror&&"allticks"!==be.mirror||(It[Ot]=[be._counterDomainMin,be._counterDomainMax][On[1]]))}jr&&(hn=x.getComponentMethod("rangeslider","autoMarginOpts")(he,be)),"string"==typeof be.automargin&&(Ge(wn,be.automargin),Ge(It,be.automargin)),k.autoMargin(he,et(be),wn),k.autoMargin(he,yt(be),It),k.autoMargin(he,Vt(be),hn)}),Fe.skipTitle||jr&&"bottom"===be.side||$r.push(function(){return function(sn,wn){var It,hn=sn._fullLayout,yn=wn._id,Hn=yn.charAt(0),Un=wn.title.font.size;if(wn.title.hasOwnProperty("standoff"))It=wn._depth+wn.title.standoff+kt(wn);else{var jn=je(wn);if("multicategory"===wn.type)It=wn._depth;else{var On=1.5*Un;jn&&(On=.5*Un,"outside"===wn.ticks&&(On+=wn.ticklen)),It=10+On+(wn.linewidth?wn.linewidth-1:0)}jn||(It+="x"===Hn?"top"===wn.side?Un*(wn.showticklabels?1:0):Un*(wn.showticklabels?1.5:.5):"right"===wn.side?Un*(wn.showticklabels?1:.5):Un*(wn.showticklabels?.5:0))}var kn,Mn,Ln,Dn,Kn=U.getPxPosition(sn,wn);if("x"===Hn?(Mn=wn._offset+wn._length/2,Ln="top"===wn.side?Kn-It:Kn+It):(Ln=wn._offset+wn._length/2,Mn="right"===wn.side?Kn+It:Kn-It,kn={rotate:"-90",offset:0}),"multicategory"!==wn.type){var Qn=wn._selections[wn._id+"tick"];if(Dn={selection:Qn,side:wn.side},Qn&&Qn.node()&&Qn.node().parentNode){var lr=m.getTranslate(Qn.node().parentNode);Dn.offsetLeft=lr.x,Dn.offsetTop=lr.y}wn.title.hasOwnProperty("standoff")&&(Dn.pad=0)}return c.draw(sn,yn+"title",{propContainer:wn,propName:wn._name+".title.text",placeholder:hn._dfltTitle[Hn],avoid:Dn,transform:kn,attributes:{x:Mn,y:Ln,"text-anchor":"middle"}})}(he,be)}),e.syncOrAsync($r)}}function ri(sn){var It,hn,yn,Hn,Un,jn,wn=lt+(sn||"tick");return Xe[wn]||(Xe[wn]=((It=be)._selections[hn=wn].size()?(yn=1/0,Hn=-1/0,Un=1/0,jn=-1/0,It._selections[hn].each(function(){var On=at(this),kn=m.bBox(On.node().parentNode);yn=Math.min(yn,kn.top),Hn=Math.max(Hn,kn.bottom),Un=Math.min(Un,kn.left),jn=Math.max(jn,kn.right)})):(yn=0,Hn=0,Un=0,jn=0),{top:yn,bottom:Hn,left:Un,right:jn,height:Hn-yn,width:jn-Un})),Xe[wn]}},U.getTickSigns=function(he,be){var Fe=he._id.charAt(0),Ke=he.side==={x:"top",y:"right"}[Fe]?1:-1,Ze=[-1,1,Ke,-Ke];return"inside"!==(be?(he.minor||{}).ticks:he.ticks)==("x"===Fe)&&(Ze=Ze.map(function(ut){return-ut})),he.side&&Ze.push({l:-1,t:-1,r:1,b:1}[he.side.charAt(0)]),Ze},U.makeTransTickFn=function(he){return"x"===he._id.charAt(0)?function(be){return r(he._offset+he.l2p(be.x),0)}:function(be){return r(0,he._offset+he.l2p(be.x))}},U.makeTransTickLabelFn=function(he){var be=function(Ke){var Ze=Ke.ticklabelposition||"",ut=function(st){return-1!==Ze.indexOf(st)},lt=ut("top"),Lt=ut("left"),Ot=ut("right"),ot=ut("bottom"),pt=ut("inside"),qt=ot||Lt||lt||Ot;if(!qt&&!pt)return[0,0];var St=Ke.side,Mt=qt?(Ke.tickwidth||0)/2:0,Ce=3,Xe=Ke.tickfont?Ke.tickfont.size:12;return(ot||lt)&&(Mt+=Xe*ne,Ce+=(Ke.linewidth||0)/2),(Lt||Ot)&&(Mt+=(Ke.linewidth||0)/2,Ce+=3),pt&&"top"===St&&(Ce-=Xe*(1-ne)),(Lt||lt)&&(Mt=-Mt),"bottom"!==St&&"right"!==St||(Ce=-Ce),[qt?Mt:0,pt?Ce:0]}(he),Fe=be[0],He=be[1];return"x"===he._id.charAt(0)?function(Ke){return r(Fe+he._offset+he.l2p(ct(Ke)),He)}:function(Ke){return r(He,Fe+he._offset+he.l2p(ct(Ke)))}},U.makeTickPath=function(he,be,Fe,He){He||(He={});var Ke=He.minor;if(Ke&&!he.minor)return"";var Ze=void 0!==He.len?He.len:Ke?he.minor.ticklen:he.ticklen,ut=he._id.charAt(0),lt=(he.linewidth||1)/2;return"x"===ut?"M0,"+(be+lt*Fe)+"v"+Ze*Fe:"M"+(be+lt*Fe)+",0h"+Ze*Fe},U.makeLabelFns=function(he,be,Fe){var He=he.ticklabelposition||"",Ke=function(an){return-1!==He.indexOf(an)},Ze=Ke("top"),ut=Ke("left"),lt=Ke("right"),Lt=Ke("bottom")||ut||Ze||lt,Ot=Ke("inside"),ot="inside"===He&&"inside"===he.ticks||!Ot&&"outside"===he.ticks&&"boundaries"!==he.tickson,pt=0,qt=0,St=ot?he.ticklen:0;if(Ot?St*=-1:Lt&&(St=0),ot&&(pt+=St,Fe)){var Mt=e.deg2rad(Fe);pt=St*Math.cos(Mt)+1,qt=St*Math.sin(Mt)}he.showticklabels&&(ot||he.showline)&&(pt+=.2*he.tickfont.size);var Ce,Xe,st,dt,zt,Ht={labelStandoff:pt+=(he.linewidth||1)/2*(Ot?-1:1),labelShift:qt},Kt=0,Zt=he.side,vn=he._id.charAt(0),zn=he.tickangle;if("x"===vn)dt=(zt=!Ot&&"bottom"===Zt||Ot&&"top"===Zt)?1:-1,Ot&&(dt*=-1),Ce=qt*dt,Xe=be+pt*dt,st=zt?1:-.2,90===Math.abs(zn)&&(Ot?st+=X:st=-90===zn&&"bottom"===Zt?ne:90===zn&&"top"===Zt?X:.5,Kt=X/2*(zn/90)),Ht.xFn=function(an){return an.dx+Ce+Kt*an.fontSize},Ht.yFn=function(an){return an.dy+Xe+an.fontSize*st},Ht.anchorFn=function(an,on){if(Lt){if(ut)return"end";if(lt)return"start"}return t(on)&&0!==on&&180!==on?on*dt<0!==Ot?"end":"start":"middle"},Ht.heightFn=function(an,on,mn){return on<-60||on>60?-.5*mn:"top"===he.side!==Ot?-mn:0};else if("y"===vn){if(dt=(zt=!Ot&&"left"===Zt||Ot&&"right"===Zt)?1:-1,Ot&&(dt*=-1),Ce=pt,Xe=qt*dt,st=0,Ot||90!==Math.abs(zn)||(st=-90===zn&&"left"===Zt||90===zn&&"right"===Zt?ne:.5),Ot){var gn=t(zn)?+zn:0;if(0!==gn){var nn=e.deg2rad(gn);Kt=Math.abs(Math.sin(nn))*ne*dt,st=0}}Ht.xFn=function(an){return an.dx+be-(Ce+an.fontSize*st)*dt+Kt*an.fontSize},Ht.yFn=function(an){return an.dy+Xe+an.fontSize*X},Ht.anchorFn=function(an,on){return t(on)&&90===Math.abs(on)?"middle":zt?"end":"start"},Ht.heightFn=function(an,on,mn){return"right"===he.side&&(on*=-1),on<-30?-mn:on<30?-.5*mn:0}}return Ht},U.drawTicks=function(he,be,Fe){Fe=Fe||{};var He=be._id+"tick",Ke=[].concat(be.minor&&be.minor.ticks?Fe.vals.filter(function(ut){return ut.minor&&!ut.noTick}):[]).concat(be.ticks?Fe.vals.filter(function(ut){return!ut.minor&&!ut.noTick}):[]),Ze=Fe.layer.selectAll("path."+He).data(Ke,wt);Ze.exit().remove(),Ze.enter().append("path").classed(He,1).classed("ticks",1).classed("crisp",!1!==Fe.crisp).each(function(ut){return n.stroke(g.select(this),ut.minor?be.minor.tickcolor:be.tickcolor)}).style("stroke-width",function(ut){return m.crispRound(he,ut.minor?be.minor.tickwidth:be.tickwidth,1)+"px"}).attr("d",Fe.path).style("display",null),Ye(be,[q]),Ze.attr("transform",Fe.transFn)},U.drawGrid=function(he,be,Fe){Fe=Fe||{};var He=be._id+"grid",Ke=be.minor&&be.minor.showgrid,Ze=Ke?Fe.vals.filter(function(st){return st.minor}):[],ut=be.showgrid?Fe.vals.filter(function(st){return!st.minor}):[],lt=Fe.counterAxis;if(lt&&U.shouldShowZeroLine(he,be,lt))for(var Lt="array"===be.tickmode,Ot=0;Ot<ut.length;Ot++){var ot=ut[Ot].x;if(Lt?!ot:Math.abs(ot)<be.dtick/100){if(ut=ut.slice(0,Ot).concat(ut.slice(Ot+1)),!Lt)break;Ot--}}be._gw=m.crispRound(he,be.gridwidth,1);for(var pt=Ke?m.crispRound(he,be.minor.gridwidth,1):0,qt=Fe.layer,St=Fe.minorLayer,Mt=1;Mt>=0;Mt--){var Ce=Mt?qt:St;if(Ce){var Xe=Ce.selectAll("path."+He).data(Mt?ut:Ze,wt);Xe.exit().remove(),Xe.enter().append("path").classed(He,1).classed("crisp",!1!==Fe.crisp),Xe.attr("transform",Fe.transFn).attr("d",Fe.path).each(function(st){return n.stroke(g.select(this),st.minor?be.minor.gridcolor:be.gridcolor||"#ddd")}).style("stroke-dasharray",function(st){return m.dashStyle(st.minor?be.minor.griddash:be.griddash,st.minor?be.minor.gridwidth:be.gridwidth)}).style("stroke-width",function(st){return(st.minor?pt:be._gw)+"px"}).style("display",null),"function"==typeof Fe.path&&Xe.attr("d",Fe.path)}}Ye(be,[D,j])},U.drawZeroLine=function(he,be,Fe){var He=be._id+"zl",Ke=U.shouldShowZeroLine(he,be,(Fe=Fe||Fe).counterAxis),Ze=Fe.layer.selectAll("path."+He).data(Ke?[{x:0,id:be._id}]:[]);Ze.exit().remove(),Ze.enter().append("path").classed(He,1).classed("zl",1).classed("crisp",!1!==Fe.crisp).each(function(){Fe.layer.selectAll("path").sort(function(ut,lt){return K(ut.id,lt.id)})}),Ze.attr("transform",Fe.transFn).attr("d",Fe.path).call(n.stroke,be.zerolinecolor||n.defaultLine).style("stroke-width",m.crispRound(he,be.zerolinewidth,be._gw||1)+"px").style("display",null),Ye(be,[R])},U.drawLabels=function(he,be,Fe){Fe=Fe||{};var He=he._fullLayout,Ke=be._id,Ze=Ke.charAt(0),ut=Fe.cls||Ke+"tick",lt=Fe.vals.filter(function(dt){return dt.text}),Lt=Fe.labelFns,Ot=Fe.secondary?0:be.tickangle,ot=(be._prevTickAngles||{})[ut],pt=Fe.layer.selectAll("g."+ut).data(be.showticklabels?lt:[],wt),qt=[];function St(dt,zt){dt.each(function(Ht){var Kt=g.select(this),Zt=Kt.select(".text-math-group"),vn=Lt.anchorFn(Ht,zt),zn=Fe.transFn.call(Kt.node(),Ht)+(t(zt)&&0!=+zt?" rotate("+zt+","+Lt.xFn(Ht)+","+(Lt.yFn(Ht)-Ht.fontSize/2)+")":""),gn=i.lineCount(Kt),nn=V*Ht.fontSize,an=Lt.heightFn(Ht,t(zt)?+zt:0,(gn-1)*nn);if(an&&(zn+=r(0,an)),Zt.empty()){var on=Kt.select("text");on.attr({transform:zn,"text-anchor":vn}),on.style("opacity",1),be._adjustTickLabelsOverflow&&be._adjustTickLabelsOverflow()}else{var mn=m.bBox(Zt.node()).width*{end:-.5,start:.5}[vn];Zt.attr("transform",zn+r(mn,0))}})}pt.enter().append("g").classed(ut,1).append("text").attr("text-anchor","middle").each(function(dt){var zt=g.select(this),Ht=he._promises.length;zt.call(i.positionText,Lt.xFn(dt),Lt.yFn(dt)).call(m.font,dt.font,dt.fontSize,dt.fontColor).text(dt.text).call(i.convertToTspans,he),he._promises[Ht]?qt.push(he._promises.pop().then(function(){St(zt,Ot)})):St(zt,Ot)}),Ye(be,[Z]),pt.exit().remove(),Fe.repositionOnUpdate&&pt.each(function(dt){g.select(this).select("text").call(i.positionText,Lt.xFn(dt),Lt.yFn(dt))}),be._adjustTickLabelsOverflow=function(){var dt=be.ticklabeloverflow;if(dt&&"allow"!==dt){var zt=-1!==dt.indexOf("hide"),Ht="x"===be._id.charAt(0),Kt=0,Zt=Ht?he._fullLayout.width:he._fullLayout.height;if(-1!==dt.indexOf("domain")){var vn=e.simpleMap(be.range,be.r2l);Kt=be.l2p(vn[0])+be._offset,Zt=be.l2p(vn[1])+be._offset}var zn=Math.min(Kt,Zt),gn=Math.max(Kt,Zt),nn=be.side,an=1/0,on=-1/0;for(var mn in pt.each(function(Rn){var qn=g.select(this);if(qn.select(".text-math-group").empty()){var Xn=m.bBox(qn.node()),br=0;Ht?(Xn.right>gn||Xn.left<zn)&&(br=1):(Xn.bottom>gn||Xn.top+(be.tickangle?0:Rn.fontSize/4)<zn)&&(br=1);var fr=qn.select("text");br?zt&&fr.style("opacity",0):(fr.style("opacity",1),an="bottom"===nn||"right"===nn?Math.min(an,Ht?Xn.top:Xn.left):-1/0,on="top"===nn||"left"===nn?Math.max(on,Ht?Xn.bottom:Xn.right):1/0)}}),He._plots){var _n=He._plots[mn];if(be._id===_n.xaxis._id||be._id===_n.yaxis._id){var Pn=Ht?_n.yaxis:_n.xaxis;Pn&&(Pn["_visibleLabelMin_"+be._id]=an,Pn["_visibleLabelMax_"+be._id]=on)}}}},be._hideCounterAxisInsideTickLabels=function(dt){var zt="x"===be._id.charAt(0),Ht=[];for(var Kt in He._plots){var Zt=He._plots[Kt];be._id!==Zt.xaxis._id&&be._id!==Zt.yaxis._id||Ht.push(zt?Zt.yaxis:Zt.xaxis)}Ht.forEach(function(vn,zn){vn&&je(vn)&&(dt||[R,j,D,q,Z]).forEach(function(gn){var nn="tick"===gn.K&&"text"===gn.L&&"period"===be.ticklabelmode,an=He._plots[be._mainSubplot];(gn.K===R.K?an.zerolinelayer.selectAll("."+be._id+"zl"):gn.K===j.K?an.minorGridlayer.selectAll("."+be._id):gn.K===D.K?an.gridlayer.selectAll("."+be._id):an[be._id.charAt(0)+"axislayer"]).each(function(){var on=g.select(this);gn.L&&(on=on.selectAll(gn.L)),on.each(function(mn){var _n=be.l2p(nn?ct(mn):mn.x)+be._offset,Pn=g.select(this);_n<be["_visibleLabelMax_"+vn._id]&&_n>be["_visibleLabelMin_"+vn._id]?Pn.style("display","none"):"tick"!==gn.K||zn||Pn.style("display",null)})})})})},St(pt,ot+1?ot:Ot);var Mt=null;be._selections&&(be._selections[ut]=pt);var Ce=[function(){return qt.length&&Promise.all(qt)}];be.automargin&&He._redrawFromAutoMarginCount&&90===ot?(Mt=90,Ce.push(function(){St(pt,ot)})):Ce.push(function(){if(St(pt,Ot),lt.length&&"x"===Ze&&!t(Ot)&&("log"!==be.type||"D"!==String(be.dtick).charAt(0))){Mt=0;var dt,zt=0,Ht=[];if(pt.each(function(qn){zt=Math.max(zt,qn.fontSize);var Xn=be.l2p(qn.x),br=at(this),fr=m.bBox(br.node());Ht.push({top:0,bottom:10,height:10,left:Xn-fr.width/2,right:Xn+fr.width/2+2,width:fr.width+2})}),"boundaries"!==be.tickson&&!be.showdividers||Fe.secondary){var Kt=lt.length,Zt=Math.abs((lt[Kt-1].x-lt[0].x)*be._m)/(Kt-1),vn=be.ticklabelposition||"",zn=function(qn){return-1!==vn.indexOf(qn)},gn=zn("top"),nn=zn("left"),an=zn("right"),on=zn("bottom")||nn||gn||an?(be.tickwidth||0)+6:0,mn=Zt<2.5*zt||"multicategory"===be.type||"realaxis"===be._name;for(dt=0;dt<Ht.length-1;dt++)if(e.bBoxIntersect(Ht[dt],Ht[dt+1],on)){Mt=mn?90:30;break}}else{var _n=2;for(be.ticks&&(_n+=be.tickwidth/2),dt=0;dt<Ht.length;dt++){var Pn=lt[dt].xbnd,Rn=Ht[dt];if(null!==Pn[0]&&Rn.left-be.l2p(Pn[0])<_n||null!==Pn[1]&&be.l2p(Pn[1])-Rn.right<_n){Mt=90;break}}}Mt&&St(pt,Mt)}}),be._tickAngles&&Ce.push(function(){be._tickAngles[ut]=null===Mt?t(Ot)?Ot:0:Mt});var Xe=be._anchorAxis;Xe&&Xe.autorange&&je(be)&&!J(He,be._id)&&(He._insideTickLabelsAutorange||(He._insideTickLabelsAutorange={}),He._insideTickLabelsAutorange[Xe._name+".autorange"]=Xe.autorange,Ce.push(function(){pt.each(function(dt,zt){var Ht=at(this);Ht.select(".text-math-group").empty()&&(be._vals[zt].bb=m.bBox(Ht.node()))})}));var st=e.syncOrAsync(Ce);return st&&st.then&&he._promises.push(st),st},U.getPxPosition=function(he,be){var Fe,He=he._fullLayout._size,Ke=be._id.charAt(0),Ze=be.side;return"free"!==be.anchor?Fe=be._anchorAxis:"x"===Ke?Fe={_offset:He.t+(1-(be.position||0))*He.h,_length:0}:"y"===Ke&&(Fe={_offset:He.l+(be.position||0)*He.w,_length:0}),"top"===Ze||"left"===Ze?Fe._offset:"bottom"===Ze||"right"===Ze?Fe._offset+Fe._length:void 0},U.shouldShowZeroLine=function(he,be,Fe){var He=e.simpleMap(be.range,be.r2l);return He[0]*He[1]<=0&&be.zeroline&&("linear"===be.type||"-"===be.type)&&!(be.rangebreaks&&be.maskBreaks(0)===C)&&(gt(be,0)||!function(Ke,Ze,ut,lt){var Lt=ut._mainAxis;if(Lt){var Ot=Ke._fullLayout,ot=Ze._id.charAt(0),pt=U.counterLetter(Ze._id),qt=Ze._offset+(Math.abs(lt[0])<Math.abs(lt[1])==("x"===ot)?0:Ze._length),Mt=Ot._plots[ut._mainSubplot];if(!(Mt.mainplotinfo||Mt).overlays.length)return St(ut);for(var Ce=U.list(Ke,pt),Xe=0;Xe<Ce.length;Xe++){var st=Ce[Xe];if(st._mainAxis===Lt&&St(st))return!0}}function St(dt){if(!dt.showline||!dt.linewidth)return!1;var zt=Math.max((dt.linewidth+Ze.zerolinewidth)/2,1);function Ht(vn){return"number"==typeof vn&&Math.abs(vn-qt)<zt}if(Ht(dt._mainLinePosition)||Ht(dt._mainMirrorPosition))return!0;var Kt=dt._linepositions||{};for(var Zt in Kt)if(Ht(Kt[Zt][0])||Ht(Kt[Zt][1]))return!0}}(he,be,Fe,He)||function(Ke,Ze){for(var ut=Ke._fullData,lt=Ze._mainSubplot,Lt=Ze._id.charAt(0),Ot=0;Ot<ut.length;Ot++){var ot=ut[Ot];if(!0===ot.visible&&ot.xaxis+ot.yaxis===lt&&(x.traceIs(ot,"bar-like")&&ot.orientation==={x:"h",y:"v"}[Lt]||ot.fill&&ot.fill.charAt(ot.fill.length-1)===Lt))return!0}return!1}(he,be))},U.clipEnds=function(he,be){return be.filter(function(Fe){return gt(he,Fe.x)})},U.allowAutoMargin=function(he){for(var be=U.list(he,"",!0),Fe=0;Fe<be.length;Fe++){var He=be[Fe];He.automargin&&(k.allowAutoMargin(he,et(He)),He.mirror&&k.allowAutoMargin(he,yt(He))),x.getComponentMethod("rangeslider","isVisible")(He)&&k.allowAutoMargin(he,Vt(He))}},U.swap=function(he,be){for(var Fe=function(Ke,Ze){var ut,lt,Lt=[];for(ut=0;ut<Ze.length;ut++){var Ot=[],ot=Ke._fullData[Ze[ut]].xaxis,pt=Ke._fullData[Ze[ut]].yaxis;if(ot&&pt){for(lt=0;lt<Lt.length;lt++)-1===Lt[lt].x.indexOf(ot)&&-1===Lt[lt].y.indexOf(pt)||Ot.push(lt);if(Ot.length){var qt,St=Lt[Ot[0]];if(Ot.length>1)for(lt=1;lt<Ot.length;lt++)Gt(St.x,(qt=Lt[Ot[lt]]).x),Gt(St.y,qt.y);Gt(St.x,[ot]),Gt(St.y,[pt])}else Lt.push({x:[ot],y:[pt]})}}return Lt}(he,be),He=0;He<Fe.length;He++)en(he,Fe[He].x,Fe[He].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../constants/numerical").BADNUM,x=t.isArrayOrTypedArray,e=t.isDateTime,r=t.cleanNumber,i=Math.round;function c(m,p){return p?g(m):"number"==typeof m}function n(m){return Math.max(1,(m-1)/1e3)}Q.exports=function(m,p,s){var y,f=m,l=s.noMultiCategory;if(x(f)&&!f.length)return"-";if(!l&&x((y=f)[0])&&x(y[1]))return"multicategory";if(l&&Array.isArray(f[0])){for(var o=[],d=0;d<f.length;d++)if(x(f[d]))for(var u=0;u<f[d].length;u++)o.push(f[d][u]);f=o}if(function(y,h){for(var _=y.length,b=n(_),w=0,T=0,L={},M=0;M<_;M+=b){var z=y[i(M)],S=String(z);L[S]||(L[S]=1,e(z,h)&&w++,g(z)&&T++)}return w>2*T}(f,p))return"date";var a="strict"!==s.autotypenumbers;return function(y,h){for(var _=y.length,b=n(_),w=0,T=0,L={},M=0;M<_;M+=b){var z=y[i(M)],S=String(z);if(!L[S]){L[S]=1;var C=typeof z;"boolean"===C?T++:(h?r(z)!==k:"number"===C)?w++:"string"===C&&T++}}return T>2*w}(f,a)?"category":function(y,h){for(var _=y.length,b=0;b<_;b++)if(c(y[b],h))return!0;return!1}(f,a)?"linear":"-"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../registry"),k=v("../../lib"),x=v("../../plot_api/plot_template"),e=v("../array_container_defaults"),r=v("./layout_attributes"),i=v("./tick_value_defaults"),c=v("./tick_mark_defaults"),n=v("./tick_label_defaults"),m=v("./prefix_suffix_defaults"),p=v("./category_order_defaults"),s=v("./line_grid_defaults"),f=v("./set_convert"),l=v("./constants").WEEKDAY_PATTERN,o=v("./constants").HOUR_PATTERN;function d(y,h,_){function b(C,R){return k.coerce(y,h,r.rangebreaks,C,R)}if(b("enabled")){var w=b("bounds");if(w&&w.length>=2){var T,L,M="";if(2===w.length)for(T=0;T<2;T++)if(L=a(w[T])){M=l;break}var P=b("pattern",M);if(P===l)for(T=0;T<2;T++)(L=a(w[T]))&&(h.bounds[T]=w[T]=L-1);if(P)for(T=0;T<2;T++)switch(L=w[T],P){case l:if(!g(L)||(L=+L)!==Math.floor(L)||L<0||L>=7)return void(h.enabled=!1);h.bounds[T]=w[T]=L;break;case o:if(!g(L)||(L=+L)<0||L>24)return void(h.enabled=!1);h.bounds[T]=w[T]=L}if(!1===_.autorange){var z=_.range;if(z[0]<z[1]){if(w[0]<z[0]&&w[1]>z[1])return void(h.enabled=!1)}else if(w[0]>z[0]&&w[1]<z[1])return void(h.enabled=!1)}}else{var S=b("values");if(!S||!S.length)return void(h.enabled=!1);b("dvalue")}}}Q.exports=function(y,h,_,b,w){var T,L=b.letter,M=b.font||{},P=b.splomStash||{},z=_("visible",!b.visibleDflt),C=h.type||(h._template||{}).type||"-";"date"===C&&(t.getComponentMethod("calendars","handleDefaults")(y,h,"calendar",b.calendar),b.noTicklabelmode||(T=_("ticklabelmode")));var R="";b.noTicklabelposition&&"multicategory"!==C||(R=k.coerce(y,h,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:"period"===T?["outside","inside"]:"x"===L?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),b.noTicklabeloverflow||_("ticklabeloverflow",-1!==R.indexOf("inside")?"hide past domain":"category"===C||"multicategory"===C?"allow":"hide past div"),f(h,w);var D=!h.isValidRange(y.range);D&&b.reverseDflt&&(D="reversed"),!_("autorange",D)||"linear"!==C&&"-"!==C||_("rangemode"),_("range"),h.cleanRange(),p(y,h,_,b),"category"===C||b.noHover||_("hoverformat");var j=_("color"),q=j!==r.color.dflt?j:M.color,Z=P.label||w._dfltTitle[L];if(m(y,h,_,C,b),!z)return h;_("title.text",Z),k.coerceFont(_,"title.font",{family:M.family,size:k.bigFont(M.size),color:q}),i(y,h,_,C);var W=b.hasMinor;if(W&&(x.newContainer(h,"minor"),i(y,h,_,C,{isMinor:!0})),n(y,h,_,C,b),c(y,h,_,b),W){var G=b.isMinor;b.isMinor=!0,c(y,h,_,b),b.isMinor=G}s(y,h,_,{dfltColor:j,bgColor:b.bgColor,showGrid:b.showGrid,hasMinor:W,attributes:r}),!W||h.minor.ticks||h.minor.showgrid||delete h.minor,(h.showline||h.ticks)&&_("mirror"),b.automargin&&_("automargin");var X,ne="multicategory"===C;if(b.noTickson||"category"!==C&&!ne||!h.ticks&&!h.showgrid||(ne&&(X="boundaries"),"boundaries"===_("tickson",X)&&delete h.ticklabelposition),ne&&_("showdividers")&&(_("dividercolor"),_("dividerwidth")),"date"===C)if(e(y,h,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:d}),h.rangebreaks.length){for(var V=0;V<h.rangebreaks.length;V++)if(h.rangebreaks[V].pattern===l){h._hasDayOfWeekBreaks=!0;break}if(f(h,w),w._has("scattergl")||w._has("splom"))for(var N=0;N<b.data.length;N++){var U=b.data[N];"scattergl"!==U.type&&"splom"!==U.type||(U.visible=!1,k.warn(U.type+" traces do not work on axes with rangebreaks. Setting trace "+U.index+" to `visible: false`."))}}else delete h.rangebreaks;return h};var u={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function a(y){if("string"==typeof y)return u[y.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(v,Q,$){"use strict";var g=v("../../constants/docs"),t=g.FORMAT_LINK,k=g.DATE_FORMAT_LINK;function x(r,i){return["Sets the "+r+" formatting rule"+(i?"for `"+i+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+t+"."].join(" ")}function e(r,i){return x(r,i)+[" And for dates see: "+k+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}Q.exports={axisHoverFormat:function(r,i){return{valType:"string",dflt:"",editType:"none",description:(i?x:e)("hover text",r)+["By default the values are formatted using "+(i?"generic number format":"`"+r+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:x,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("./constants");function k(x,e){if(e&&e.length)for(var r=0;r<e.length;r++)if(e[r][x])return!0;return!1}$.id2name=function(x){if("string"==typeof x&&x.match(t.AX_ID_PATTERN)){var e=x.split(" ")[0].substr(1);return"1"===e&&(e=""),x.charAt(0)+"axis"+e}},$.name2id=function(x){if(x.match(t.AX_NAME_PATTERN)){var e=x.substr(5);return"1"===e&&(e=""),x.charAt(0)+e}},$.cleanId=function(x,e,r){var i=/( domain)$/.test(x);if("string"==typeof x&&x.match(t.AX_ID_PATTERN)&&(!e||x.charAt(0)===e)&&(!i||r)){var c=x.split(" ")[0].substr(1).replace(/^0+/,"");return"1"===c&&(c=""),x.charAt(0)+c+(i&&r?" domain":"")}},$.list=function(x,e,r){var i=x._fullLayout;if(!i)return[];var c,n=$.listIds(x,e),m=new Array(n.length);for(c=0;c<n.length;c++){var p=n[c];m[c]=i[p.charAt(0)+"axis"+p.substr(1)]}if(!r){var s=i._subplots.gl3d||[];for(c=0;c<s.length;c++){var f=i[s[c]];e?m.push(f[e+"axis"]):m.push(f.xaxis,f.yaxis,f.zaxis)}}return m},$.listIds=function(x,e){var r=x._fullLayout;if(!r)return[];var i=r._subplots;return e?i[e+"axis"]:i.xaxis.concat(i.yaxis)},$.getFromId=function(x,e,r){var i=x._fullLayout;return e=void 0===e||"string"!=typeof e?e:e.replace(" domain",""),"x"===r?e=e.replace(/y[0-9]*/,""):"y"===r&&(e=e.replace(/x[0-9]*/,"")),i[$.id2name(e)]},$.getFromTrace=function(x,e,r){var i=x._fullLayout,c=null;if(g.traceIs(e,"gl3d")){var n=e.scene;"scene"===n.substr(0,5)&&(c=i[n][r+"axis"])}else c=$.getFromId(x,e[r+"axis"]||r);return c},$.idSort=function(x,e){var r=x.charAt(0),i=e.charAt(0);return r!==i?r>i?1:-1:+(x.substr(1)||1)-+(e.substr(1)||1)},$.ref2id=function(x){return!!/^[xyz]/.test(x)&&x.split(" ")[0]},$.isLinked=function(x,e){return k(e,x._axisMatchGroups)||k(e,x._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x){if("category"===t.type){var e,r=g.categoryarray,i=Array.isArray(r)&&r.length>0;i&&(e="array");var c,n=k("categoryorder",e);"array"===n&&(c=k("categoryarray")),i||"array"!==n||(n=t.categoryorder="trace"),"trace"===n?t._initialCategories=[]:"array"===n?t._initialCategories=c.slice():(c=function(m,p){var s,f,l,o=p.dataAttr||m._id.charAt(0),d={};if(p.axData)s=p.axData;else for(s=[],f=0;f<p.data.length;f++){var u=p.data[f];u[o+"axis"]===m._id&&s.push(u)}for(f=0;f<s.length;f++){var a=s[f][o];for(l=0;l<a.length;l++){var y=a[l];null!=y&&(d[y]=1)}}return Object.keys(d)}(t,x).sort(),"category ascending"===n?t._initialCategories=c:"category descending"===n&&(t._initialCategories=c.reverse()))}}},{}],572:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../constants/numerical"),x=k.ONEDAY,e=k.ONEWEEK;$.dtick=function(r,i){var c="log"===i,n="date"===i,m="category"===i,p=n?x:1;if(!r)return p;if(g(r))return(r=Number(r))<=0?p:m?Math.max(1,Math.round(r)):n?Math.max(.1,r):r;if("string"!=typeof r||!n&&!c)return p;var s=r.charAt(0),f=r.substr(1);return(f=g(f)?Number(f):0)<=0||!(n&&"M"===s&&f===Math.round(f)||c&&"L"===s||c&&"D"===s&&(1===f||2===f))?p:r},$.tick0=function(r,i,c,n){return"date"===i?t.cleanDate(r,t.dateTick0(c,n%e==0?1:0)):"D1"!==n&&"D2"!==n?g(r)?Number(r):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(v,Q,$){"use strict";var g=v("../../lib/regex").counter;Q.exports={idRegex:{x:g("x","( domain)?"),y:g("y","( domain)?")},attrRegex:g("[xy]axis"),xAxisMatch:g("xaxis"),yAxisMatch:g("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./autorange"),k=v("./axis_ids").id2name,x=v("./layout_attributes"),e=v("./scale_zoom"),r=v("./set_convert"),i=v("../../constants/numerical").ALMOST_EQUAL,c=v("../../constants/alignment").FROM_BL;function n(d,u,a){var y=a.axIds,h=a.layoutOut,_=a.hasImage,b=h._axisConstraintGroups,w=h._axisMatchGroups,T=u._id,L=T.charAt(0),M=((h._splomAxes||{})[L]||{})[T]||{},P=u._id,z="x"===P.charAt(0);function S(ee,B){return g.coerce(d,u,x,ee,B)}u._matchGroup=null,u._constraintGroup=null,S("constrain",_?"domain":"range"),g.coerce(d,u,{constraintoward:{valType:"enumerated",values:z?["left","center","right"]:["bottom","middle","top"],dflt:z?"center":"middle"}},"constraintoward");var C,R,D=u.type,j=[];for(C=0;C<y.length;C++)(R=y[C])!==P&&h[k(R)].type===D&&j.push(R);var q=p(b,P);if(q){var Z=[];for(C=0;C<j.length;C++)q[R=j[C]]||Z.push(R);j=Z}var W,G,X=j.length;X&&(d.matches||M.matches)&&(W=g.coerce(d,u,{matches:{valType:"enumerated",values:j,dflt:-1!==j.indexOf(M.matches)?M.matches:void 0}},"matches"));var ne=_&&!z?u.anchor:void 0;if(X&&!W&&(d.scaleanchor||ne)&&(G=g.coerce(d,u,{scaleanchor:{valType:"enumerated",values:j}},"scaleanchor",ne)),W){u._matchGroup=s(w,P,W,1);var V=h[k(W)],N=m(h,u)/m(h,V);z!==("x"===W.charAt(0))&&(N=(z?"x":"y")+N),s(b,P,W,N)}else d.matches&&-1!==y.indexOf(d.matches)&&g.warn("ignored "+u._name+'.matches: "'+d.matches+'" to avoid an infinite loop');if(G){var U=S("scaleratio");U||(U=u.scaleratio=1),s(b,P,G,U)}else d.scaleanchor&&-1!==y.indexOf(d.scaleanchor)&&g.warn("ignored "+u._name+'.scaleanchor: "'+d.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function m(d,u){var a=u.domain;return a||(a=d[k(u.overlaying)].domain),a[1]-a[0]}function p(d,u){for(var a=0;a<d.length;a++)if(d[a][u])return d[a];return null}function s(d,u,a,y){var h,_,b,w,T,L=p(d,u);null===L?((L={})[u]=1,T=d.length,d.push(L)):T=d.indexOf(L);var M=Object.keys(L);for(h=0;h<d.length;h++)if(b=d[h],h!==T&&b[a]){var P=b[a];for(_=0;_<M.length;_++)b[w=M[_]]=f(P,f(y,L[w]));return void d.splice(T,1)}if(1!==y)for(_=0;_<M.length;_++){var z=M[_];L[z]=f(y,L[z])}L[a]=1}function f(d,u){var a,y,h="",_="";"string"==typeof d&&(a=(h=d.match(/^[xy]*/)[0]).length,d=+d.substr(a)),"string"==typeof u&&(y=(_=u.match(/^[xy]*/)[0]).length,u=+u.substr(y));var b=d*u;return a||y?a&&y&&h.charAt(0)!==_.charAt(0)?a===y?b:(a>y?h.substr(y):_.substr(a))+b:h+_+d*u:b}function l(d,u){for(var a=u._size,y=a.h/a.w,h={},_=Object.keys(d),b=0;b<_.length;b++){var w=_[b],T=d[w];if("string"==typeof T){var L=T.match(/^[xy]*/)[0],M=L.length;T=+T.substr(M);for(var P="y"===L.charAt(0)?y:1/y,z=0;z<M;z++)T*=P}h[w]=T}return h}function o(d,u){var a=d._inputDomain,h=a[0]+(a[1]-a[0])*c[d.constraintoward];d.domain=d._input.domain=[h+(a[0]-h)/u,h+(a[1]-h)/u],d.setScale()}$.handleDefaults=function(d,u,a){var y,h,_,b,w,T,L,M,P=a.axIds,z=a.axHasImage,S=u._axisConstraintGroups=[],C=u._axisMatchGroups=[];for(y=0;y<P.length;y++)n(w=d[b=k(P[y])],T=u[b],{axIds:P,layoutOut:u,hasImage:z[b]});function R(V,N){for(y=0;y<V.length;y++)for(_ in h=V[y])u[k(_)][N]=h}for(R(C,"_matchGroup"),y=0;y<S.length;y++)for(_ in h=S[y])if((T=u[k(_)]).fixedrange){for(var D in h){var j=k(D);!1===(d[j]||{}).fixedrange&&g.warn("fixedrange was specified as false for axis "+j+" but was overridden because another axis in its constraint group has fixedrange true"),u[j].fixedrange=!0}break}for(y=0;y<S.length;){for(_ in h=S[y]){(T=u[k(_)])._matchGroup&&Object.keys(T._matchGroup).length===Object.keys(h).length&&(S.splice(y,1),y--);break}y++}R(S,"_constraintGroup");var q=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],Z=!1,W=!1;function G(){M=T[L],"rangebreaks"===L&&(W=T._hasDayOfWeekBreaks)}for(y=0;y<C.length;y++){h=C[y];for(var X=0;X<q.length;X++){var ne;for(_ in L=q[X],M=null,h)if(w=d[b=k(_)],L in(T=u[b])){if(!T.matches&&(ne=T,L in w)){G();break}null===M&&L in w&&G()}if("range"===L&&M&&(Z=!0),"autorange"===L&&null===M&&Z&&(M=!1),null===M&&L in ne&&(M=ne[L]),null!==M)for(_ in h)(T=u[k(_)])[L]="range"===L?M.slice():M,"rangebreaks"===L&&(T._hasDayOfWeekBreaks=W,r(T,u))}}},$.enforce=function(d){var u,a,y,h,_,b,w,T,L=d._fullLayout,M=L._axisConstraintGroups||[];for(u=0;u<M.length;u++){y=l(M[u],L);var P=Object.keys(y),z=1/0,S=0,C=1/0,R={},D={},j=!1;for(a=0;a<P.length;a++)D[h=P[a]]=_=L[k(h)],_._inputDomain?_.domain=_._inputDomain.slice():_._inputDomain=_.domain.slice(),_._inputRange||(_._inputRange=_.range.slice()),_.setScale(),R[h]=b=Math.abs(_._m)/y[h],z=Math.min(z,b),"domain"!==_.constrain&&_._constraintShrinkable||(C=Math.min(C,b)),delete _._constraintShrinkable,S=Math.max(S,b),"domain"===_.constrain&&(j=!0);if(!(z>i*S)||j)for(a=0;a<P.length;a++)if(b=R[h=P[a]],w=(_=D[h]).constrain,b!==C||"domain"===w)if(T=b/C,"range"===w)e(_,T);else{var q=_._inputDomain,Z=(_.domain[1]-_.domain[0])/(q[1]-q[0]),W=(_.r2l(_.range[1])-_.r2l(_.range[0]))/(_.r2l(_._inputRange[1])-_.r2l(_._inputRange[0]));if((T/=Z)*W<1){_.domain=_._input.domain=q.slice(),e(_,T);continue}if(W<1&&(_.range=_._input.range=_._inputRange.slice(),T*=W),_.autorange){var G=_.r2l(_.range[0]),X=_.r2l(_.range[1]),ne=(G+X)/2,V=ne,N=ne,U=Math.abs(X-ne),ee=ne-U*T*1.0001,B=ne+U*T*1.0001,K=t.makePadFn(L,_,0),J=t.makePadFn(L,_,1);o(_,T);var te,ae,ce=Math.abs(_._m),oe=t.concatExtremes(d,_),ve=oe.min,fe=oe.max;for(ae=0;ae<ve.length;ae++)(te=ve[ae].val-K(ve[ae])/ce)>ee&&te<V&&(V=te);for(ae=0;ae<fe.length;ae++)(te=fe[ae].val+J(fe[ae])/ce)<B&&te>N&&(N=te);T/=(N-V)/(2*U),V=_.l2r(V),N=_.l2r(N),_.range=_._input.range=G<X?[V,N]:[N,V]}o(_,T)}}},$.getAxisGroup=function(d,u){for(var a=d._axisMatchGroups,y=0;y<a.length;y++)if(a[y][u])return"g"+y;return u},$.clean=function(d,u){if(u._inputDomain){for(var a=!1,y=u._id,h=d._fullLayout._axisConstraintGroups,_=0;_<h.length;_++)if(h[_][y]){a=!0;break}a&&"domain"===u.constrain||(u._input.domain=u.domain=u._inputDomain,delete u._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=t.numberFormat,x=v("tinycolor2"),e=v("has-passive-events"),r=v("../../registry"),i=t.strTranslate,c=v("../../lib/svg_text_utils"),n=v("../../components/color"),m=v("../../components/drawing"),p=v("../../components/fx"),s=v("./axes"),f=v("../../lib/setcursor"),l=v("../../components/dragelement"),o=v("../../components/dragelement/helpers"),d=o.selectingOrDrawing,u=o.freeMode,a=v("../../constants/alignment").FROM_TL,y=v("../../lib/clear_gl_canvases"),h=v("../../plot_api/subroutines").redrawReglTraces,_=v("../plots"),b=v("./axis_ids").getFromId,w=v("../../components/selections").prepSelect,T=v("../../components/selections").clearOutline,L=v("../../components/selections").selectOnClick,M=v("./scale_zoom"),P=v("./constants"),z=P.MINDRAG,S=P.MINZOOM,C=!0;function R(te,ae,ce,oe){var ve=t.ensureSingle(te.draglayer,ae,ce,function(fe){fe.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",te.id)});return ve.call(f,oe),ve.node()}function D(te,ae,ce,oe,ve,fe,xe){var Se=R(te,"rect",ae,ce);return g.select(Se).call(m.setRect,oe,ve,fe,xe),Se}function j(te,ae){for(var ce=0;ce<te.length;ce++)if(!te[ce].fixedrange)return ae;return""}function q(te,ae,ce,oe,ve){for(var fe=0;fe<te.length;fe++){var xe=te[fe];if(!xe.fixedrange)if(xe.rangebreaks){var Se="y"===xe._id.charAt(0),ge=Se?1-ce:ce;oe[xe._name+".range[0]"]=xe.l2r(xe.p2l((Se?1-ae:ae)*xe._length)),oe[xe._name+".range[1]"]=xe.l2r(xe.p2l(ge*xe._length))}else{var Te=xe._rl[0],se=xe._rl[1]-Te;oe[xe._name+".range[0]"]=xe.l2r(Te+se*ae),oe[xe._name+".range[1]"]=xe.l2r(Te+se*ce)}}if(ve&&ve.length){var de=(ae+(1-ce))/2;q(ve,de,1-de,oe,[])}}function Z(te,ae){for(var ce=0;ce<te.length;ce++){var oe=te[ce];if(!oe.fixedrange)if(oe.rangebreaks){var ve=oe._length,fe=(oe.p2l(0+ae)-oe.p2l(0)+(oe.p2l(ve+ae)-oe.p2l(ve)))/2;oe.range=[oe.l2r(oe._rl[0]-fe),oe.l2r(oe._rl[1]-fe)]}else oe.range=[oe.l2r(oe._rl[0]-ae/oe._m),oe.l2r(oe._rl[1]-ae/oe._m)]}}function W(te){return 1-(te>=0?Math.min(te,.9):1/(1/Math.max(te,-.3)+3.222))}function G(te,ae,ce,oe,ve){return te.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",i(ce,oe)).attr("d",ve+"Z")}function X(te,ae,ce){return te.append("path").attr("class","zoombox-corners").style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("transform",i(ae,ce)).attr("d","M0,0Z")}function ne(te,ae,ce,oe,ve,fe){te.attr("d",oe+"M"+ce.l+","+ce.t+"v"+ce.h+"h"+ce.w+"v-"+ce.h+"h-"+ce.w+"Z"),V(te,ae,ve,fe)}function V(te,ae,ce,oe){ce||(te.transition().style("fill",oe>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function N(te){g.select(te).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function U(te){C&&te.data&&te._context.showTips&&(t.notifier(t._(te,"Double-click to zoom back out"),"long"),C=!1)}function ee(te){var ae=Math.floor(Math.min(te.b-te.t,te.r-te.l,S)/2);return"M"+(te.l-3.5)+","+(te.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(te.r+3.5)+","+(te.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(te.r+3.5)+","+(te.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(te.l-3.5)+","+(te.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function B(te,ae,ce,oe,ve){for(var fe,xe,Se,pe,ge=!1,Te={},se={},de=(ve||{}).xaHash,Ae=(ve||{}).yaHash,Le=0;Le<ae.length;Le++){var Me=ae[Le];for(fe in ce)if(Me[fe]){for(Se in Me)ve&&(de[Se]||Ae[Se])||("x"===Se.charAt(0)?ce:oe)[Se]||(Te[Se]=fe);for(xe in oe)ve&&(de[xe]||Ae[xe])||!Me[xe]||(ge=!0)}for(xe in oe)if(Me[xe])for(pe in Me)ve&&(de[pe]||Ae[pe])||("x"===pe.charAt(0)?ce:oe)[pe]||(se[pe]=xe)}ge&&(t.extendFlat(Te,se),se={});var De={},Oe=[];for(Se in Te){var Ie=b(te,Se);Oe.push(Ie),De[Ie._id]=Ie}var Qe={},Ne=[];for(pe in se){var Pe=b(te,pe);Ne.push(Pe),Qe[Pe._id]=Pe}return{xaHash:De,yaHash:Qe,xaxes:Oe,yaxes:Ne,xLinks:Te,yLinks:se,isSubplotConstrained:ge}}function K(te,ae){if(e){var ce=void 0!==te.onwheel?"wheel":"mousewheel";te._onwheel&&te.removeEventListener(ce,te._onwheel),te._onwheel=ae,te.addEventListener(ce,ae,{passive:!1})}else void 0!==te.onwheel?te.onwheel=ae:void 0!==te.onmousewheel?te.onmousewheel=ae:te.isAddedWheelEvent||(te.isAddedWheelEvent=!0,te.addEventListener("wheel",ae,{passive:!1}))}function J(te){var ae=[];for(var ce in te)ae.push(te[ce]);return ae}Q.exports={makeDragBox:function(te,ae,ce,oe,ve,fe,xe,Se){var pe,ge,Te,se,de,Ae,Le,Me,De,Oe,Ie,Qe,Ne,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et,yt=te._fullLayout._zoomlayer,Vt=xe+Se==="nsew",Gt=1===(xe+Se).length;function en(){if(De=(pe=ae.xaxis)._length,Oe=(ge=ae.yaxis)._length,Le=pe._offset,Me=ge._offset,(Te={})[pe._id]=pe,(se={})[ge._id]=ge,xe&&Se)for(var nn=ae.overlays,an=0;an<nn.length;an++){var on=nn[an].xaxis;Te[on._id]=on;var mn=nn[an].yaxis;se[mn._id]=mn}de=J(Te),Ae=J(se),Ne=j(de,Se),Pe=j(Ae,xe),Re=!Pe&&!Ne,Qe=B(te,te._fullLayout._axisMatchGroups,Te,se);var _n=(Ie=B(te,te._fullLayout._axisConstraintGroups,Te,se,Qe)).isSubplotConstrained||Qe.isSubplotConstrained;Ge=Se||_n,tt=xe||_n;var Pn=te._fullLayout;ct=Pn._has("scattergl"),wt=Pn._has("splom"),kt=Pn._has("svg")}en();var nn,Jt=(nn=Pe+Ne)?"nsew"===nn?Vt?"":"pan"===te._fullLayout.dragmode?"move":"crosshair":nn.toLowerCase()+"-resize":"pointer",cn=D(ae,xe+Se+"drag",Jt,ce,oe,ve,fe);if(Re&&!Vt)return cn.onmousedown=null,cn.style.pointerEvents="none",cn;var Rt,je,Ye,he,be,Fe,He,Ke,Ze,ut,lt={element:cn,gd:te,plotinfo:ae};function Lt(){lt.plotinfo.selection=!1,T(te)}function Ot(nn,an){var fr,Vr,cr,Sr,Cr,on=lt.gd;if(on._fullLayout._activeShapeIndex>=0)on._fullLayout._deactivateShape(on);else{var mn=on._fullLayout.clickmode;if(N(on),2!==nn||Gt||function Ht(){if(!te._transitioningWithDuration){var nn=te._context.doubleClick,an=[];Ne&&(an=an.concat(de)),Pe&&(an=an.concat(Ae)),Qe.xaxes&&(an=an.concat(Qe.xaxes)),Qe.yaxes&&(an=an.concat(Qe.yaxes));var on,mn,_n,Pn={};if("reset+autosize"===nn)for(nn="autosize",mn=0;mn<an.length;mn++)if((on=an[mn])._rangeInitial&&(on.range[0]!==on._rangeInitial[0]||on.range[1]!==on._rangeInitial[1])||!on._rangeInitial&&!on.autorange){nn="reset";break}if("autosize"===nn)for(mn=0;mn<an.length;mn++)(on=an[mn]).fixedrange||(Pn[on._name+".autorange"]=!0);else if("reset"===nn)for((Ne||Ie.isSubplotConstrained)&&(an=an.concat(Ie.xaxes)),Pe&&!Ie.isSubplotConstrained&&(an=an.concat(Ie.yaxes)),Ie.isSubplotConstrained&&(Ne?Pe||(an=an.concat(Ae)):an=an.concat(de)),mn=0;mn<an.length;mn++)(on=an[mn]).fixedrange||(on._rangeInitial?(Pn[on._name+".range[0]"]=(_n=on._rangeInitial)[0],Pn[on._name+".range[1]"]=_n[1]):Pn[on._name+".autorange"]=!0);te.emit("plotly_doubleclick",null),r.call("_guiRelayout",te,Pn)}}(),Vt)mn.indexOf("select")>-1&&L(an,on,de,Ae,ae.id,lt),mn.indexOf("event")>-1&&p.click(on,an,ae.id);else if(1===nn&&Gt){var _n=xe?ge:pe,Pn="s"===xe||"w"===Se?0:1,Rn=_n._name+".range["+Pn+"]",qn=(Sr=(fr=_n).range[Vr=Pn],Cr=Math.abs(Sr-fr.range[1-Vr]),"date"===fr.type?Sr:"log"===fr.type?(cr=Math.ceil(Math.max(0,-Math.log(Cr)/Math.LN10))+3,k("."+cr+"g")(Math.pow(10,Sr))):(cr=Math.floor(Math.log(Math.abs(Sr))/Math.LN10)-Math.floor(Math.log(Cr)/Math.LN10)+4,k("."+String(cr)+"g")(Sr))),Xn="left",br="middle";if(_n.fixedrange)return;xe?(br="n"===xe?"top":"bottom","right"===_n.side&&(Xn="right")):"e"===Se&&(Xn="right"),on._context.showAxisRangeEntryBoxes&&g.select(cn).call(c.makeEditable,{gd:on,immediate:!0,background:on._fullLayout.paper_bgcolor,text:String(qn),fill:_n.tickfont?_n.tickfont.color:"#444",horizontalAlign:Xn,verticalAlign:br}).on("edit",function(fr){var Vr=_n.d2r(fr);void 0!==Vr&&r.call("_guiRelayout",on,Rn,Vr)})}}}function ot(nn,an){if(te._transitioningWithDuration)return!1;var br,fr,on=Math.max(0,Math.min(De,at*nn+Rt)),mn=Math.max(0,Math.min(Oe,et*an+je)),_n=Math.abs(on-Rt),Pn=Math.abs(mn-je);function Rn(){He="",Ye.r=Ye.l,Ye.t=Ye.b,Ze.attr("d","M0,0Z")}if(Ye.l=Math.min(Rt,on),Ye.r=Math.max(Rt,on),Ye.t=Math.min(je,mn),Ye.b=Math.max(je,mn),Ie.isSubplotConstrained)_n>S||Pn>S?(He="xy",_n/De>Pn/Oe?(Pn=_n*Oe/De,je>mn?Ye.t=je-Pn:Ye.b=je+Pn):(_n=Pn*De/Oe,Rt>on?Ye.l=Rt-_n:Ye.r=Rt+_n),Ze.attr("d",ee(Ye))):Rn();else if(Qe.isSubplotConstrained)if(_n>S||Pn>S){He="xy";var qn=Math.min(Ye.l/De,(Oe-Ye.b)/Oe),Xn=Math.max(Ye.r/De,(Oe-Ye.t)/Oe);Ye.l=qn*De,Ye.r=Xn*De,Ye.b=(1-qn)*Oe,Ye.t=(1-Xn)*Oe,Ze.attr("d",ee(Ye))}else Rn();else!Pe||Pn<Math.min(Math.max(.6*_n,z),S)?_n<z||!Ne?Rn():(Ye.t=0,Ye.b=Oe,He="x",Ze.attr("d","M"+((br=Ye).l-.5)+","+((fr=je)-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(br.r+.5)+","+(fr-S-.5)+"h3v"+(2*S+1)+"h-3Z")):!Ne||_n<Math.min(.6*Pn,S)?(Ye.l=0,Ye.r=De,He="y",Ze.attr("d",function(br,fr){return"M"+(fr-S-.5)+","+(br.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+(fr-S-.5)+","+(br.b+.5)+"v3h"+(2*S+1)+"v-3Z"}(Ye,Rt))):(He="xy",Ze.attr("d",ee(Ye)));Ye.w=Ye.r-Ye.l,Ye.h=Ye.b-Ye.t,He&&(ut=!0),te._dragged=ut,ne(Ke,Ze,Ye,be,Fe,he),pt(),te.emit("plotly_relayouting",gt),Fe=!0}function pt(){gt={},"xy"!==He&&"x"!==He||(q(de,Ye.l/De,Ye.r/De,gt,Ie.xaxes),dt("x",gt)),"xy"!==He&&"y"!==He||(q(Ae,(Oe-Ye.b)/Oe,(Oe-Ye.t)/Oe,gt,Ie.yaxes),dt("y",gt))}function qt(){pt(),N(te),Kt(),U(te)}lt.prepFn=function(nn,an,on){var mn=lt.dragmode,_n=te._fullLayout.dragmode;_n!==mn&&(lt.dragmode=_n),en(),at=te._fullLayout._invScaleX,et=te._fullLayout._invScaleY,Re||(Vt?nn.shiftKey?"pan"===_n?_n="zoom":d(_n)||(_n="pan"):nn.ctrlKey&&(_n="pan"):_n="pan"),lt.minDrag=u(_n)?1:void 0,d(_n)?(lt.xaxes=de,lt.yaxes=Ae,w(nn,an,on,lt,_n)):(lt.clickFn=Ot,d(mn)&&Lt(),Re||("zoom"===_n?(lt.moveFn=ot,lt.doneFn=qt,lt.minDrag=1,function(Pn,Rn,qn){var Xn=cn.getBoundingClientRect();Rt=Rn-Xn.left,je=qn-Xn.top,te._fullLayout._calcInverseTransform(te);var br=t.apply3DTransform(te._fullLayout._invTransform)(Rt,je);Ye={l:Rt=br[0],r:Rt,w:0,t:je=br[1],b:je,h:0},he=te._hmpixcount?te._hmlumcount/te._hmpixcount:x(te._fullLayout.plot_bgcolor).getLuminance(),Fe=!1,He="xy",ut=!1,Ke=G(yt,he,Le,Me,be="M0,0H"+De+"V"+Oe+"H0V0"),Ze=X(yt,Le,Me)}(0,an,on)):"pan"===_n&&(lt.moveFn=st,lt.doneFn=Kt))),te._fullLayout._redrag=function(){var Pn=te._dragdata;Pn&&Pn.element===cn&&(d(te._fullLayout.dragmode)||(en(),Zt([0,0,De,Oe]),lt.moveFn(Pn.dx,Pn.dy)))}},l.init(lt);var St=[0,0,De,Oe],Mt=null,Ce=P.REDRAWDELAY,Xe=ae.mainplot?te._fullLayout._plots[ae.mainplot]:ae;function st(nn,an){if(nn*=at,an*=et,!te._transitioningWithDuration){if(te._fullLayout._replotting=!0,"ew"===Ne||"ns"===Pe){var on=Ne?-nn:0,mn=Pe?-an:0;if(Qe.isSubplotConstrained){if(Ne&&Pe){var _n=(nn/De-an/Oe)/2;on=-(nn=_n*De),mn=-(an=-_n*Oe)}Pe?on=-mn*De/Oe:mn=-on*Oe/De}return Ne&&(Z(de,nn),dt("x")),Pe&&(Z(Ae,an),dt("y")),Zt([on,mn,De,Oe]),zt(),void te.emit("plotly_relayouting",gt)}var Pn,Rn,qn="w"===Ne==("n"===Pe)?1:-1;if(Ne&&Pe&&(Ie.isSubplotConstrained||Qe.isSubplotConstrained)){var Xn=(nn/De+qn*an/Oe)/2;nn=Xn*De,an=qn*Xn*Oe}if("w"===Ne?nn=cr(de,0,nn):"e"===Ne?nn=cr(de,1,-nn):Ne||(nn=0),"n"===Pe?an=cr(Ae,1,an):"s"===Pe?an=cr(Ae,0,-an):Pe||(an=0),Pn="w"===Ne?nn:0,Rn="n"===Pe?an:0,Ie.isSubplotConstrained&&!Qe.isSubplotConstrained||Qe.isSubplotConstrained&&Ne&&Pe&&qn>0){var br;if(Qe.isSubplotConstrained||!Ne&&1===Pe.length){for(br=0;br<de.length;br++)de[br].range=de[br]._r.slice(),M(de[br],1-an/Oe);Pn=(nn=an*De/Oe)/2}if(Qe.isSubplotConstrained||!Pe&&1===Ne.length){for(br=0;br<Ae.length;br++)Ae[br].range=Ae[br]._r.slice(),M(Ae[br],1-nn/De);Rn=(an=nn*Oe/De)/2}}Qe.isSubplotConstrained&&Pe||dt("x"),Qe.isSubplotConstrained&&Ne||dt("y");var fr=De-nn,Vr=Oe-an;!Qe.isSubplotConstrained||Ne&&Pe||(Ne?(Rn=Pn?0:nn*Oe/De,Vr=fr*Oe/De):(Pn=Rn?0:an*De/Oe,fr=Vr*De/Oe)),Zt([Pn,Rn,fr,Vr]),zt(),te.emit("plotly_relayouting",gt)}function cr(Sr,Cr,pi){for(var Yn,ar,Ar=1-Cr,sr=0;sr<Sr.length;sr++){var dr=Sr[sr];if(!dr.fixedrange){Yn=dr,ar=dr._rl[Ar]+(dr._rl[Cr]-dr._rl[Ar])/W(pi/dr._length);var $r=dr.l2r(ar);!1!==$r&&void 0!==$r&&(dr.range[Cr]=$r)}}return Yn._length*(Yn._rl[Cr]-ar)/(Yn._rl[Cr]-Yn._rl[Ar])}}function dt(nn,an){for(var on=Qe.isSubplotConstrained?{x:Ae,y:de}[nn]:Qe[nn+"axes"],mn=Qe.isSubplotConstrained?{x:de,y:Ae}[nn]:[],_n=0;_n<on.length;_n++){var Pn=on[_n],Rn=Pn._id,qn=Qe.xLinks[Rn]||Qe.yLinks[Rn],Xn=mn[0]||Te[qn]||se[qn];Xn&&(an?(an[Pn._name+".range[0]"]=an[Xn._name+".range[0]"],an[Pn._name+".range[1]"]=an[Xn._name+".range[1]"]):Pn.range=Xn.range.slice())}}function zt(){var nn,an=[];function on(Pn){for(nn=0;nn<Pn.length;nn++)Pn[nn].fixedrange||an.push(Pn[nn]._id)}for(Ge&&(on(de),on(Ie.xaxes),on(Qe.xaxes)),tt&&(on(Ae),on(Ie.yaxes),on(Qe.yaxes)),gt={},nn=0;nn<an.length;nn++){var _n=b(te,an[nn]);s.drawOne(te,_n,{skipTitle:!0}),gt[_n._name+".range[0]"]=_n.range[0],gt[_n._name+".range[1]"]=_n.range[1]}s.redrawComponents(te,an)}function Kt(){Zt([0,0,De,Oe]),t.syncOrAsync([_.previousPromises,function(){te._fullLayout._replotting=!1,r.call("_guiRelayout",te,gt)}],te)}function Zt(nn){var an,on,mn,_n,Pn=te._fullLayout,Rn=Pn._plots,qn=Pn._subplots.cartesian;if(wt&&r.subplotsRegistry.splom.drag(te),ct)for(an=0;an<qn.length;an++)if(mn=(on=Rn[qn[an]]).xaxis,_n=on.yaxis,on._scene){var Xn=t.simpleMap(mn.range,mn.r2l),br=t.simpleMap(_n.range,_n.r2l);on._scene.update({range:[Xn[0],br[0],Xn[1],br[1]]})}if((wt||ct)&&(y(te),h(te)),kt){var fr=nn[2]/pe._length,Vr=nn[3]/ge._length;for(an=0;an<qn.length;an++){mn=(on=Rn[qn[an]]).xaxis,_n=on.yaxis;var cr,Sr,Cr,pi,ar=(tt||Qe.isSubplotConstrained)&&!_n.fixedrange&&se[_n._id];if((Ge||Qe.isSubplotConstrained)&&!mn.fixedrange&&Te[mn._id]?(cr=fr,Cr=Se||Qe.isSubplotConstrained?nn[0]:gn(mn,cr)):Qe.xaHash[mn._id]?(cr=fr,Cr=nn[0]*mn._length/pe._length):Qe.yaHash[mn._id]?(cr=Vr,Cr="ns"===Pe?-nn[1]*mn._length/ge._length:gn(mn,cr,{n:"top",s:"bottom"}[Pe])):Cr=zn(mn,cr=vn(mn,fr,Vr)),ar?(Sr=Vr,pi=xe||Qe.isSubplotConstrained?nn[1]:gn(_n,Sr)):Qe.yaHash[_n._id]?(Sr=Vr,pi=nn[1]*_n._length/ge._length):Qe.xaHash[_n._id]?(Sr=fr,pi="ew"===Ne?-nn[0]*_n._length/pe._length:gn(_n,Sr,{e:"right",w:"left"}[Ne])):pi=zn(_n,Sr=vn(_n,fr,Vr)),cr||Sr){cr||(cr=1),Sr||(Sr=1);var Ar=mn._offset-Cr/cr,sr=_n._offset-pi/Sr;on.clipRect.call(m.setTranslate,Cr,pi).call(m.setScale,cr,Sr),on.plot.call(m.setTranslate,Ar,sr).call(m.setScale,1/cr,1/Sr),cr===on.xScaleFactor&&Sr===on.yScaleFactor||(m.setPointGroupScale(on.zoomScalePts,cr,Sr),m.setTextPointsScale(on.zoomScaleTxt,cr,Sr)),m.hideOutsideRangePoints(on.clipOnAxisFalseTraces,on),on.xScaleFactor=cr,on.yScaleFactor=Sr}}}}function vn(nn,an,on){return nn.fixedrange?0:Ge&&Ie.xaHash[nn._id]?an:tt&&(Ie.isSubplotConstrained?Ie.xaHash:Ie.yaHash)[nn._id]?on:0}function zn(nn,an){return an?(nn.range=nn._r.slice(),M(nn,an),gn(nn,an)):0}function gn(nn,an,on){return nn._length*(1-an)*a[on||nn.constraintoward||"middle"]}return xe.length*Se.length!=1&&K(cn,function(nn){if(te._context._scrollZoom.cartesian||te._fullLayout._enablescrollzoom){if(Lt(),te._transitioningWithDuration)return nn.preventDefault(),void nn.stopPropagation();en(),clearTimeout(Mt);var an=-nn.deltaY;if(isFinite(an)||(an=nn.wheelDelta/10),isFinite(an)){var on,mn=Math.exp(-Math.min(Math.max(an,-20),20)/200),_n=Xe.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Pn=(nn.clientX-_n.left)/_n.width,Rn=(_n.bottom-nn.clientY)/_n.height;if(Ge){for(Se||(Pn=.5),on=0;on<de.length;on++)qn(de[on],Pn,mn);dt("x"),St[2]*=mn,St[0]+=St[2]*Pn*(1/mn-1)}if(tt){for(xe||(Rn=.5),on=0;on<Ae.length;on++)qn(Ae[on],Rn,mn);dt("y"),St[3]*=mn,St[1]+=St[3]*(1-Rn)*(1/mn-1)}Zt(St),zt(),te.emit("plotly_relayouting",gt),Mt=setTimeout(function(){te._fullLayout&&(St=[0,0,De,Oe],Kt())},Ce),nn.preventDefault()}else t.log("Did not find wheel motion attributes: ",nn)}function qn(Xn,br,fr){if(!Xn.fixedrange){var Vr=t.simpleMap(Xn.range,Xn.r2l),cr=Vr[0]+(Vr[1]-Vr[0])*br;Xn.range=Vr.map(function(Sr){return Xn.l2r(cr+(Sr-cr)*fr)})}}}),cn},makeDragger:R,makeRectDragger:D,makeZoombox:G,makeCorners:X,updateZoombox:ne,xyCorners:ee,transitionZoombox:V,removeZoombox:N,showDoubleClickNotifier:U,attachWheelEventHandler:K}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/fx"),k=v("../../components/dragelement"),x=v("../../lib/setcursor"),e=v("./dragbox").makeDragBox,r=v("./constants").DRAGGERSIZE;$.initInteractions=function(i){var c=i._fullLayout;if(i._context.staticPlot)g.select(i).selectAll(".drag").remove();else if(c._has("cartesian")||c._has("splom")){Object.keys(c._plots||{}).sort(function(m,p){if((c._plots[m].mainplot&&!0)===(c._plots[p].mainplot&&!0)){var s=m.split("y"),f=p.split("y");return s[0]===f[0]?Number(s[1]||1)-Number(f[1]||1):Number(s[0]||1)-Number(f[0]||1)}return c._plots[m].mainplot?1:-1}).forEach(function(m){var p=c._plots[m],s=p.xaxis,f=p.yaxis;if(!p.mainplot){var l=e(i,p,s._offset,f._offset,s._length,f._length,"ns","ew");l.onmousemove=function(u){i._fullLayout._rehover=function(){i._fullLayout._hoversubplot===m&&i._fullLayout._plots[m]&&t.hover(i,u,m)},t.hover(i,u,m),i._fullLayout._lasthover=l,i._fullLayout._hoversubplot=m},l.onmouseout=function(u){i._dragging||(i._fullLayout._hoversubplot=null,k.unhover(i,u))},i._context.showAxisDragHandles&&(e(i,p,s._offset-r,f._offset-r,r,r,"n","w"),e(i,p,s._offset+s._length,f._offset-r,r,r,"n","e"),e(i,p,s._offset-r,f._offset+f._length,r,r,"s","w"),e(i,p,s._offset+s._length,f._offset+f._length,r,r,"s","e"))}if(i._context.showAxisDragHandles){if(m===s._mainSubplot){var o=s._mainLinePosition;"top"===s.side&&(o-=r),e(i,p,s._offset+.1*s._length,o,.8*s._length,r,"","ew"),e(i,p,s._offset,o,.1*s._length,r,"","w"),e(i,p,s._offset+.9*s._length,o,.1*s._length,r,"","e")}if(m===f._mainSubplot){var d=f._mainLinePosition;"right"!==f.side&&(d-=r),e(i,p,d,f._offset+.1*f._length,r,.8*f._length,"ns",""),e(i,p,d,f._offset+.9*f._length,r,.1*f._length,"s",""),e(i,p,d,f._offset,r,.1*f._length,"n","")}}});var n=c._hoverlayer.node();n.onmousemove=function(m){m.target=i._fullLayout._lasthover,t.hover(i,m,c._hoversubplot)},n.onclick=function(m){m.target=i._fullLayout._lasthover,t.click(i,m)},n.onmousedown=function(m){i._fullLayout._lasthover.onmousedown(m)},$.updateFx(i)}},$.updateFx=function(i){var c=i._fullLayout;x(c._draggers,"pan"===c.dragmode?"move":"crosshair")}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("./axis_ids");Q.exports=function(x){return function(e,r){var i=e[x];if(Array.isArray(i))for(var c=g.subplotsRegistry.cartesian,n=c.idRegex,m=r._subplots,p=m.xaxis,s=m.yaxis,f=m.cartesian,l=r._has("cartesian")||r._has("gl2d"),o=0;o<i.length;o++){var d=i[o];if(t.isPlainObject(d)){var u=k.cleanId(d.xref,"x",!1),a=k.cleanId(d.yref,"y",!1),y=n.x.test(u),h=n.y.test(a);if(y||h){l||t.pushUnique(r._basePlotModules,c);var _=!1;y&&-1===p.indexOf(u)&&(p.push(u),_=!0),h&&-1===s.indexOf(a)&&(s.push(a),_=!0),_&&y&&h&&f.push(u+a)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../lib"),x=v("../plots"),e=v("../../components/drawing"),r=v("../get_data").getModuleCalcData,i=v("./axis_ids"),c=v("./constants"),n=v("../../constants/xmlns_namespaces"),m=k.ensureSingle;function p(d,u,a){return k.ensureSingle(d,u,a,function(y){y.datum(a)})}function s(d,u,a,y,h){for(var _,b,w,T=c.traceLayerClasses,L=d._fullLayout,M=L._modules,P=[],z=[],S=0;S<M.length;S++){var C=(_=M[S]).name,R=t.modules[C].categories;if(R.svg){var D=_.layerName||C+"layer",j=_.plot;w=(b=r(a,j))[0],a=b[1],w.length&&P.push({i:T.indexOf(D),className:D,plotMethod:j,cdModule:w}),R.zoomScale&&z.push("."+D)}}P.sort(function(W,G){return W.i-G.i});var q=u.plot.selectAll("g.mlayer").data(P,function(W){return W.className});if(q.enter().append("g").attr("class",function(W){return W.className}).classed("mlayer",!0).classed("rangeplot",u.isRangePlot),q.exit().remove(),q.order(),q.each(function(W){var G=g.select(this),X=W.className;W.plotMethod(d,u,W.cdModule,G,y,h),-1===c.clipOnAxisFalseQuery.indexOf("."+X)&&e.setClipUrl(G,u.layerClipId,d)}),L._has("scattergl")&&(_=t.getModule("scattergl"),w=r(a,_)[0],_.plot(d,u,w)),!d._context.staticPlot&&(u._hasClipOnAxisFalse&&(u.clipOnAxisFalseTraces=u.plot.selectAll(c.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),z.length)){var Z=u.plot.selectAll(z.join(",")).selectAll(".trace");u.zoomScalePts=Z.selectAll("path.point"),u.zoomScaleTxt=Z.selectAll(".textpoint")}}function f(d,u){var a=u.plotgroup,y=u.id,h=c.layerValue2layerClass[u.xaxis.layer],_=c.layerValue2layerClass[u.yaxis.layer],b=d._fullLayout._hasOnlyLargeSploms;if(u.mainplot){var w=u.mainplotinfo,T=w.plotgroup,L=y+"-x",M=y+"-y";u.minorGridlayer=w.minorGridlayer,u.gridlayer=w.gridlayer,u.zerolinelayer=w.zerolinelayer,m(w.overlinesBelow,"path",L),m(w.overlinesBelow,"path",M),m(w.overaxesBelow,"g",L),m(w.overaxesBelow,"g",M),u.plot=m(w.overplot,"g",y),m(w.overlinesAbove,"path",L),m(w.overlinesAbove,"path",M),m(w.overaxesAbove,"g",L),m(w.overaxesAbove,"g",M),u.xlines=T.select(".overlines-"+h).select("."+L),u.ylines=T.select(".overlines-"+_).select("."+M),u.xaxislayer=T.select(".overaxes-"+h).select("."+L),u.yaxislayer=T.select(".overaxes-"+_).select("."+M)}else if(b)u.xlines=m(a,"path","xlines-above"),u.ylines=m(a,"path","ylines-above"),u.xaxislayer=m(a,"g","xaxislayer-above"),u.yaxislayer=m(a,"g","yaxislayer-above");else{var P=m(a,"g","layer-subplot");u.shapelayer=m(P,"g","shapelayer"),u.imagelayer=m(P,"g","imagelayer"),u.minorGridlayer=m(a,"g","minor-gridlayer"),u.gridlayer=m(a,"g","gridlayer"),u.zerolinelayer=m(a,"g","zerolinelayer"),m(a,"path","xlines-below"),m(a,"path","ylines-below"),u.overlinesBelow=m(a,"g","overlines-below"),m(a,"g","xaxislayer-below"),m(a,"g","yaxislayer-below"),u.overaxesBelow=m(a,"g","overaxes-below"),u.plot=m(a,"g","plot"),u.overplot=m(a,"g","overplot"),u.xlines=m(a,"path","xlines-above"),u.ylines=m(a,"path","ylines-above"),u.overlinesAbove=m(a,"g","overlines-above"),m(a,"g","xaxislayer-above"),m(a,"g","yaxislayer-above"),u.overaxesAbove=m(a,"g","overaxes-above"),u.xlines=a.select(".xlines-"+h),u.ylines=a.select(".ylines-"+_),u.xaxislayer=a.select(".xaxislayer-"+h),u.yaxislayer=a.select(".yaxislayer-"+_)}b||(p(u.minorGridlayer,"g",u.xaxis._id),p(u.minorGridlayer,"g",u.yaxis._id),u.minorGridlayer.selectAll("g").map(function(z){return z[0]}).sort(i.idSort),p(u.gridlayer,"g",u.xaxis._id),p(u.gridlayer,"g",u.yaxis._id),u.gridlayer.selectAll("g").map(function(z){return z[0]}).sort(i.idSort)),u.xlines.style("fill","none").classed("crisp",!0),u.ylines.style("fill","none").classed("crisp",!0)}function l(d,u){if(d){var a={};for(var y in d.each(function(w){var T=w[0];g.select(this).remove(),o(T,u),a[T]=!0}),u._plots)for(var h=u._plots[y].overlays||[],_=0;_<h.length;_++){var b=h[_];a[b.id]&&b.plot.selectAll(".trace").remove()}}}function o(d,u){u._draggers.selectAll("g."+d).remove(),u._defs.select("#clip"+u._uid+d+"plot").remove()}$.name="cartesian",$.attr=["xaxis","yaxis"],$.idRoot=["x","y"],$.idRegex=c.idRegex,$.attrRegex=c.attrRegex,$.attributes=v("./attributes"),$.layoutAttributes=v("./layout_attributes"),$.supplyLayoutDefaults=v("./layout_defaults"),$.transitionAxes=v("./transition_axes"),$.finalizeSubplots=function(d,u){var a,y,h,_=u._subplots,b=_.xaxis,w=_.yaxis,T=_.cartesian,L=T.concat(_.gl2d||[]),M={},P={};for(a=0;a<L.length;a++){var z=L[a].split("y");M[z[0]]=1,P["y"+z[1]]=1}for(a=0;a<b.length;a++)M[y=b[a]]||(h=(d[i.id2name(y)]||{}).anchor,c.idRegex.y.test(h)||(h="y"),T.push(y+h),L.push(y+h),P[h]||(P[h]=1,k.pushUnique(w,h)));for(a=0;a<w.length;a++)P[h=w[a]]||(y=(d[i.id2name(h)]||{}).anchor,c.idRegex.x.test(y)||(y="x"),T.push(y+h),L.push(y+h),M[y]||(M[y]=1,k.pushUnique(b,y)));if(!L.length){for(var S in y="",h="",d)c.attrRegex.test(S)&&("x"===S.charAt(0)?(!y||+S.substr(5)<+y.substr(5))&&(y=S):(!h||+S.substr(5)<+h.substr(5))&&(h=S));y=y?i.name2id(y):"x",h=h?i.name2id(h):"y",b.push(y),w.push(h),T.push(y+h)}},$.plot=function(d,u,a,y){var h,_=d._fullLayout,b=_._subplots.cartesian,w=d.calcdata;if(!Array.isArray(u))for(u=[],h=0;h<w.length;h++)u.push(h);for(h=0;h<b.length;h++){for(var T,L=b[h],M=_._plots[L],P=[],z=0;z<w.length;z++){var S=w[z],C=S[0].trace;C.xaxis+C.yaxis===L&&((-1!==u.indexOf(C.index)||C.carpet)&&(T&&T[0].trace.xaxis+T[0].trace.yaxis===L&&-1!==["tonextx","tonexty","tonext"].indexOf(C.fill)&&-1===P.indexOf(T)&&P.push(T),P.push(S)),T=S)}s(d,M,P,a,y)}},$.clean=function(d,u,a,y){var h,_,b,w=y._plots||{},T=u._plots||{},L=y._subplots||{};if(y._hasOnlyLargeSploms&&!u._hasOnlyLargeSploms)for(b in w)(h=w[b]).plotgroup&&h.plotgroup.remove();var M=y._has&&y._has("gl"),P=u._has&&u._has("gl");if(M&&!P)for(b in w)(h=w[b])._scene&&h._scene.destroy();if(L.xaxis&&L.yaxis){var z=i.listIds({_fullLayout:y});for(_=0;_<z.length;_++){var S=z[_];u[i.id2name(S)]||y._infolayer.selectAll(".g-"+S+"title").remove()}}var C=y._has&&y._has("cartesian"),R=u._has&&u._has("cartesian");if(C&&!R)l(y._cartesianlayer.selectAll(".subplot"),y),y._defs.selectAll(".axesclip").remove(),delete y._axisConstraintGroups,delete y._axisMatchGroups;else if(L.cartesian)for(_=0;_<L.cartesian.length;_++){var D=L.cartesian[_];T[D]||(y._cartesianlayer.selectAll("."+D+",."+D+"-x,."+D+"-y").remove(),o(D,y))}},$.drawFramework=function(d){var u=d._fullLayout,a=function(h){var _,b,w,T,L,M,P=h._fullLayout,z=P._subplots.cartesian,S=z.length,C=[],R=[];for(_=0;_<S;_++){var q=(L=(T=P._plots[w=z[_]]).xaxis)._mainAxis._id+(M=T.yaxis)._mainAxis._id,Z=P._plots[q];T.overlays=[],q!==w&&Z?(T.mainplot=q,T.mainplotinfo=Z,R.push(w)):(T.mainplot=void 0,T.mainplotinfo=void 0,C.push(w))}for(_=0;_<R.length;_++)(T=P._plots[w=R[_]]).mainplotinfo.overlays.push(T);var W=C.concat(R),G=new Array(S);for(_=0;_<S;_++){var X=[w=W[_],(L=(T=P._plots[w]).xaxis).layer,(M=T.yaxis).layer,L.overlaying||"",M.overlaying||""];for(b=0;b<T.overlays.length;b++)X.push(T.overlays[b].id);G[_]=X}return G}(d),y=u._cartesianlayer.selectAll(".subplot").data(a,String);y.enter().append("g").attr("class",function(h){return"subplot "+h[0]}),y.order(),y.exit().call(l,u),y.each(function(h){var _=h[0],b=u._plots[_];b.plotgroup=g.select(this),f(d,b),b.draglayer=m(u._draggers,"g",_)})},$.rangePlot=function(d,u,a){f(d,u),s(d,u,a),x.style(d)},$.toSVG=function(d){var u=d._fullLayout._glimages,a=g.select(d).selectAll(".svg-container");a.filter(function(y,h){return h===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var y=this.toDataURL("image/png");u.append("svg:image").attr({xmlns:n.svg,"xlink:href":y,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},$.updateFx=v("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(v,Q,$){"use strict";var g=v("../font_attributes"),t=v("../../components/color/attributes"),k=v("../../components/drawing/attributes").dash,x=v("../../lib/extend").extendFlat,e=v("../../plot_api/plot_template").templatedArray,r=v("../../plots/cartesian/axis_format_attributes").descriptionWithDates,i=v("../../constants/numerical").ONEDAY,c=v("./constants"),n=c.HOUR_PATTERN,m=c.WEEKDAY_PATTERN,p={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function s(T){return{valType:"integer",min:0,dflt:T?5:0,editType:"ticks"}}var f={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},l={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},o={valType:"data_array",editType:"ticks"},d={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function u(T){var L={valType:"number",min:0,editType:"ticks"};return T||(L.dflt=5),L}function a(T){var L={valType:"number",min:0,editType:"ticks"};return T||(L.dflt=1),L}var y={valType:"color",dflt:t.defaultLine,editType:"ticks"},h={valType:"color",dflt:t.lightLine,editType:"ticks"};function _(T){var L={valType:"number",min:0,editType:"ticks"};return T||(L.dflt=1),L}var b=x({},k,{editType:"ticks"}),w={valType:"boolean",editType:"ticks"};Q.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:t.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:g({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[m,n,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:i},editType:"calc"}),tickmode:p,nticks:s(),tick0:f,dtick:l,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:o,ticktext:{valType:"data_array",editType:"ticks"},ticks:d,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:u(),tickwidth:a(),tickcolor:y,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:x({},k,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:g({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:r("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:r("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:t.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:w,gridcolor:h,gridwidth:_(),griddash:b,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:t.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:t.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},minor:{tickmode:p,nticks:s("minor"),tick0:f,dtick:l,tickvals:o,ticks:d,ticklen:u("minor"),tickwidth:a("minor"),tickcolor:y,gridcolor:h,gridwidth:_("minor"),griddash:b,showgrid:w,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:g({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../../components/fx/helpers").isUnifiedHover,x=v("../../components/fx/hovermode_defaults"),e=v("../../plot_api/plot_template"),r=v("../layout_attributes"),i=v("./layout_attributes"),c=v("./type_defaults"),n=v("./axis_defaults"),m=v("./constraints"),p=v("./position_defaults"),s=v("./axis_ids"),f=s.id2name,l=s.name2id,o=v("./constants").AX_ID_PATTERN,d=v("../../registry"),u=d.traceIs,a=d.getComponentMethod;function y(h,_,b){Array.isArray(h[_])?h[_].push(b):h[_]=[b]}Q.exports=function(h,_,b){var w,T,L=_.autotypenumbers,M={},P={},z={},S={},C={},R={},D={},j={},q={},Z={};for(w=0;w<b.length;w++){var W=b[w];if(u(W,"cartesian")||u(W,"gl2d")){var G,X;if(W.xaxis)G=f(W.xaxis),y(M,G,W);else if(W.xaxes)for(T=0;T<W.xaxes.length;T++)y(M,f(W.xaxes[T]),W);if(W.yaxis)X=f(W.yaxis),y(M,X,W);else if(W.yaxes)for(T=0;T<W.yaxes.length;T++)y(M,f(W.yaxes[T]),W);"funnel"===W.type?"h"===W.orientation?(G&&(P[G]=!0),X&&(D[X]=!0)):X&&(z[X]=!0):"image"===W.type?(X&&(j[X]=!0),G&&(j[G]=!0)):(X&&(C[X]=!0,R[X]=!0),u(W,"carpet")&&("carpet"!==W.type||W._cheater)||G&&(S[G]=!0)),"carpet"===W.type&&W._cheater&&G&&(P[G]=!0),u(W,"2dMap")&&(q[G]=!0,q[X]=!0),u(W,"oriented")&&(Z["h"===W.orientation?X:G]=!0)}}var ne=_._subplots,V=ne.xaxis,N=ne.yaxis,U=g.simpleMap(V,f),ee=g.simpleMap(N,f),B=U.concat(ee),K=t.background;V.length&&N.length&&(K=g.coerce(h,_,r,"plot_bgcolor"));var J,te,ae,ce,oe,ve=t.combine(K,_.paper_bgcolor);function fe(){oe._traceIndices=(M[J]||[]).map(function(yt){return yt._expandedIndex}),oe._annIndices=[],oe._shapeIndices=[],oe._selectionIndices=[],oe._imgIndices=[],oe._subplotsWith=[],oe._counterAxes=[],oe._name=oe._attr=J,oe._id=te}function xe(et,yt){return g.coerce(ce,oe,i,et,yt)}function Se(et,yt){return g.coerce2(ce,oe,i,et,yt)}function pe(et){return"x"===et?N:V}function ge(et,yt){for(var Vt="x"===et?U:ee,Gt=[],en=0;en<Vt.length;en++){var Jt=Vt[en];Jt===yt||(h[Jt]||{}).overlaying||Gt.push(l(Jt))}return Gt}var Te={x:pe("x"),y:pe("y")},se=Te.x.concat(Te.y),de={},Ae=[];function Le(){var et=ce.matches;o.test(et)&&-1===se.indexOf(et)&&(de[et]=ce.type,Ae=Object.keys(de))}var Me=x(h,_),De=k(Me);for(w=0;w<B.length;w++){te=l(J=B[w]),ae=J.charAt(0),g.isPlainObject(h[J])||(h[J]={}),ce=h[J],oe=e.newContainer(_,J,ae+"axis"),fe();var Qe={hasMinor:!0,letter:ae,font:_.font,outerTicks:q[J],showGrid:!Z[J],data:M[J]||[],bgColor:ve,calendar:_.calendar,automargin:!0,visibleDflt:"x"===ae&&!S[J]&&P[J]||"y"===ae&&!C[J]&&z[J],reverseDflt:"y"===ae&&(!R[J]&&D[J]||j[J]),autotypenumbersDflt:L,splomStash:((_._splomAxes||{})[ae]||{})[te]};xe("uirevision",_.uirevision),c(ce,oe,xe,Qe),n(ce,oe,xe,Qe,_);var Ne=De&&ae===Me.charAt(0),Pe=Se("spikecolor",De?oe.color:void 0),Re=Se("spikethickness",De?1.5:void 0),Ge=Se("spikedash",De?"dot":void 0),tt=Se("spikemode",De?"across":void 0),ct=Se("spikesnap");xe("showspikes",!!(Ne||Pe||Re||Ge||tt||ct))||(delete oe.spikecolor,delete oe.spikethickness,delete oe.spikedash,delete oe.spikemode,delete oe.spikesnap),p(ce,oe,xe,{letter:ae,counterAxes:Te[ae],overlayableAxes:ge(ae,J),grid:_.grid}),xe("title.standoff"),Le(),oe._input=ce}for(w=0;w<Ae.length;){te=Ae[w++],ae=(J=f(te)).charAt(0),g.isPlainObject(h[J])||(h[J]={}),ce=h[J],oe=e.newContainer(_,J,ae+"axis"),fe();var wt={letter:ae,font:_.font,outerTicks:q[J],showGrid:!Z[J],data:[],bgColor:ve,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((_._splomAxes||{})[ae]||{})[te]};xe("uirevision",_.uirevision),oe.type=de[te]||"linear",n(ce,oe,xe,wt,_),p(ce,oe,xe,{letter:ae,counterAxes:Te[ae],overlayableAxes:ge(ae,J),grid:_.grid}),xe("fixedrange"),Le(),oe._input=ce}var kt=a("rangeslider","handleDefaults"),gt=a("rangeselector","handleDefaults");for(w=0;w<U.length;w++)ce=h[J=U[w]],oe=_[J],kt(h,_,J),"date"===oe.type&&gt(ce,oe,_,ee,oe.calendar),xe("fixedrange");for(w=0;w<ee.length;w++){ce=h[J=ee[w]];var at=_[f((oe=_[J]).anchor)];xe("fixedrange",a("rangeslider","isVisible")(at))}m.handleDefaults(h,_,{axIds:se.concat(Ae).sort(s.idSort),axHasImage:j})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(v,Q,$){"use strict";var g=v("tinycolor2").mix,t=v("../../components/color/attributes"),k=v("../../lib");Q.exports=function(x,e,r,i){var c=(i=i||{}).dfltColor;function n(h,_){return k.coerce2(x,e,i.attributes,h,_)}var m=n("linecolor",c),p=n("linewidth");r("showline",i.showLine||!!m||!!p)||(delete e.linecolor,delete e.linewidth);var s=n("gridcolor",g(c,i.bgColor,i.blend||t.lightFraction).toRgbString()),f=n("gridwidth"),l=n("griddash");if(r("showgrid",i.showGrid||!!s||!!f||!!l)||(delete e.gridcolor,delete e.gridwidth,delete e.griddash),i.hasMinor){var o=n("minor.gridcolor",g(e.gridcolor,i.bgColor,67).toRgbString()),d=n("minor.gridwidth",e.gridwidth||1),u=n("minor.griddash",e.griddash||"solid");r("minor.showgrid",!!o||!!d||!!u)||(delete e.minor.gridcolor,delete e.minor.gridwidth,delete e.minor.griddash)}if(!i.noZeroLine){var a=n("zerolinecolor",c),y=n("zerolinewidth");r("zeroline",i.showGrid||!!a||!!y)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib");Q.exports=function(k,x,e,r){var i,c,n,m,p=r.counterAxes||[],s=r.overlayableAxes||[],f=r.letter,l=r.grid;l&&(i=l._anchors[x._id],(c=l._domains[f][l._axisMap[x._id]])&&(n=l[f+"side"].split(" ")[0],m=l.domain[f]["right"===n||"top"===n?1:0])),c=c||[0,1],i=i||(g(k.position)?"free":p[0]||"free"),n=n||("x"===f?"bottom":"left"),m=m||0,"free"===t.coerce(k,x,{anchor:{valType:"enumerated",values:["free"].concat(p),dflt:i}},"anchor")&&e("position",m),t.coerce(k,x,{side:{valType:"enumerated",values:"x"===f?["bottom","top"]:["left","right"],dflt:n}},"side");var o=!1;if(s.length&&(o=t.coerce(k,x,{overlaying:{valType:"enumerated",values:[!1].concat(s),dflt:!1}},"overlaying")),!o){var d=e("domain",c);d[0]>d[1]-1/4096&&(x.domain=c),t.noneOrAll(k.domain,x.domain,c)}return e("layer"),x}},{"../../lib":515,"fast-isnumeric":190}],583:[function(v,Q,$){"use strict";var g=v("./show_dflt");Q.exports=function(t,k,x,e,r){r||(r={});var i=r.tickSuffixDflt,c=g(t);x("tickprefix")&&x("showtickprefix",c),x("ticksuffix",i)&&x("showticksuffix",c)}},{"./show_dflt":586}],584:[function(v,Q,$){"use strict";var g=v("../../constants/alignment").FROM_BL;Q.exports=function(t,k,x){void 0===x&&(x=g[t.constraintoward||"center"]);var e=[t.r2l(t.range[0]),t.r2l(t.range[1])],r=e[0]+(e[1]-e[0])*x;t.range=t._input.range=[t.l2r(r+(e[0]-r)*k),t.l2r(r+(e[1]-r)*k)],t.setScale()}},{"../../constants/alignment":483}],585:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-time-format").utcFormat,k=v("../../lib"),x=k.numberFormat,e=v("fast-isnumeric"),r=k.cleanNumber,i=k.ms2DateTime,c=k.dateTime2ms,n=k.ensureNumber,m=k.isArrayOrTypedArray,p=v("../../constants/numerical"),s=p.FP_SAFE,f=p.BADNUM,l=p.LOG_CLIP,o=p.ONEWEEK,d=p.ONEDAY,u=p.ONEHOUR,a=p.ONEMIN,y=p.ONESEC,h=v("./axis_ids"),_=v("./constants"),b=_.HOUR_PATTERN,w=_.WEEKDAY_PATTERN;function T(M){return Math.pow(10,M)}function L(M){return null!=M}Q.exports=function(M,P){P=P||{};var z=M._id||"x",S=z.charAt(0);function C(B,K){if(B>0)return Math.log(B)/Math.LN10;if(B<=0&&K&&M.range&&2===M.range.length){var J=M.range[0],te=M.range[1];return.5*(J+te-2*l*Math.abs(J-te))}return f}function R(B,K,J,te){if((te||{}).msUTC&&e(B))return+B;var ae=c(B,J||M.calendar);if(ae===f){if(!e(B))return f;B=+B;var ce=Math.floor(10*k.mod(B+.05,1)),oe=Math.round(B-ce/10);ae=c(new Date(oe))+ce/10}return ae}function D(B,K,J){return i(B,K,J||M.calendar)}function j(B){return M._categories[Math.round(B)]}function q(B){if(L(B)){if(void 0===M._categoriesMap&&(M._categoriesMap={}),void 0!==M._categoriesMap[B])return M._categoriesMap[B];M._categories.push("number"==typeof B?String(B):B);var K=M._categories.length-1;return M._categoriesMap[B]=K,K}return f}function Z(B){if(M._categoriesMap)return M._categoriesMap[B]}function W(B){var K=Z(B);return void 0!==K?K:e(B)?+B:void 0}function G(B){return e(B)?+B:Z(B)}function X(B,K,J){return g.round(J+K*B,2)}function ne(B,K,J){return(B-J)/K}var V=function(B){return e(B)?X(B,M._m,M._b):f},N=function(B){return ne(B,M._m,M._b)};if(M.rangebreaks){var U="y"===S;V=function(B){if(!e(B))return f;var K=M._rangebreaks.length;if(!K)return X(B,M._m,M._b);var J=U;M.range[0]>M.range[1]&&(J=!J);for(var te=J?-1:1,ae=te*B,ce=0,oe=0;oe<K;oe++){var ve=te*M._rangebreaks[oe].min,fe=te*M._rangebreaks[oe].max;if(ae<ve)break;if(!(ae>fe)){ce=ae<(ve+fe)/2?oe:oe+1;break}ce=oe+1}var xe=M._B[ce]||0;return isFinite(xe)?X(B,M._m2,xe):0},N=function(B){var K=M._rangebreaks.length;if(!K)return ne(B,M._m,M._b);for(var J=0,te=0;te<K&&!(B<M._rangebreaks[te].pmin);te++)B>M._rangebreaks[te].pmax&&(J=te+1);return ne(B,M._m2,M._B[J])}}M.c2l="log"===M.type?C:n,M.l2c="log"===M.type?T:n,M.l2p=V,M.p2l=N,M.c2p="log"===M.type?function(B,K){return V(C(B,K))}:V,M.p2c="log"===M.type?function(B){return T(N(B))}:N,-1!==["linear","-"].indexOf(M.type)?(M.d2r=M.r2d=M.d2c=M.r2c=M.d2l=M.r2l=r,M.c2d=M.c2r=M.l2d=M.l2r=n,M.d2p=M.r2p=function(B){return M.l2p(r(B))},M.p2d=M.p2r=N,M.cleanPos=n):"log"===M.type?(M.d2r=M.d2l=function(B,K){return C(r(B),K)},M.r2d=M.r2c=function(B){return T(r(B))},M.d2c=M.r2l=r,M.c2d=M.l2r=n,M.c2r=C,M.l2d=T,M.d2p=function(B,K){return M.l2p(M.d2r(B,K))},M.p2d=function(B){return T(N(B))},M.r2p=function(B){return M.l2p(r(B))},M.p2r=N,M.cleanPos=n):"date"===M.type?(M.d2r=M.r2d=k.identity,M.d2c=M.r2c=M.d2l=M.r2l=R,M.c2d=M.c2r=M.l2d=M.l2r=D,M.d2p=M.r2p=function(B,K,J){return M.l2p(R(B,0,J))},M.p2d=M.p2r=function(B,K,J){return D(N(B),K,J)},M.cleanPos=function(B){return k.cleanDate(B,f,M.calendar)}):"category"===M.type?(M.d2c=M.d2l=q,M.r2d=M.c2d=M.l2d=j,M.d2r=M.d2l_noadd=W,M.r2c=function(B){var K=G(B);return void 0!==K?K:M.fraction2r(.5)},M.l2r=M.c2r=n,M.r2l=G,M.d2p=function(B){return M.l2p(M.r2c(B))},M.p2d=function(B){return j(N(B))},M.r2p=M.d2p,M.p2r=N,M.cleanPos=function(B){return"string"==typeof B&&""!==B?B:n(B)}):"multicategory"===M.type&&(M.r2d=M.c2d=M.l2d=j,M.d2r=M.d2l_noadd=W,M.r2c=function(B){var K=W(B);return void 0!==K?K:M.fraction2r(.5)},M.r2c_just_indices=Z,M.l2r=M.c2r=n,M.r2l=W,M.d2p=function(B){return M.l2p(M.r2c(B))},M.p2d=function(B){return j(N(B))},M.r2p=M.d2p,M.p2r=N,M.cleanPos=function(B){return Array.isArray(B)||"string"==typeof B&&""!==B?B:n(B)},M.setupMultiCategory=function(B){var K,J,te=M._traceIndices,ae=M._matchGroup;if(ae&&0===M._categories.length)for(var ce in ae)if(ce!==z){var oe=P[h.id2name(ce)];te=te.concat(oe._traceIndices)}var ve=[[0,{}],[0,{}]],fe=[];for(K=0;K<te.length;K++){var xe=B[te[K]];if(S in xe){var Se=xe[S],pe=xe._length||k.minRowLength(Se);if(m(Se[0])&&m(Se[1]))for(J=0;J<pe;J++){var ge=Se[0][J],Te=Se[1][J];L(ge)&&L(Te)&&(fe.push([ge,Te]),ge in ve[0][1]||(ve[0][1][ge]=ve[0][0]++),Te in ve[1][1]||(ve[1][1][Te]=ve[1][0]++))}}}for(fe.sort(function(se,de){var Ae=ve[0][1],Le=Ae[se[0]]-Ae[de[0]];if(Le)return Le;var Me=ve[1][1];return Me[se[1]]-Me[de[1]]}),K=0;K<fe.length;K++)q(fe[K])}),M.fraction2r=function(B){var K=M.r2l(M.range[0]),J=M.r2l(M.range[1]);return M.l2r(K+B*(J-K))},M.r2fraction=function(B){var K=M.r2l(M.range[0]),J=M.r2l(M.range[1]);return(M.r2l(B)-K)/(J-K)},M.cleanRange=function(B,K){K||(K={}),B||(B="range");var J,te,ae=k.nestedProperty(M,B).get();if(te=(te="date"===M.type?k.dfltRange(M.calendar):"y"===S?_.DFLTRANGEY:"realaxis"===M._name?[0,1]:K.dfltRange||_.DFLTRANGEX).slice(),"tozero"!==M.rangemode&&"nonnegative"!==M.rangemode||(te[0]=0),ae&&2===ae.length)for("date"!==M.type||M.autorange||(ae[0]=k.cleanDate(ae[0],f,M.calendar),ae[1]=k.cleanDate(ae[1],f,M.calendar)),J=0;J<2;J++)if("date"===M.type){if(!k.isDateTime(ae[J],M.calendar)){M[B]=te;break}if(M.r2l(ae[0])===M.r2l(ae[1])){var ce=k.constrain(M.r2l(ae[0]),k.MIN_MS+1e3,k.MAX_MS-1e3);ae[0]=M.l2r(ce-1e3),ae[1]=M.l2r(ce+1e3);break}}else{if(!e(ae[J])){if(!e(ae[1-J])){M[B]=te;break}ae[J]=ae[1-J]*(J?10:.1)}if(ae[J]<-s?ae[J]=-s:ae[J]>s&&(ae[J]=s),ae[0]===ae[1]){var oe=Math.max(1,Math.abs(1e-6*ae[0]));ae[0]-=oe,ae[1]+=oe}}else k.nestedProperty(M,B).set(te)},M.setScale=function(B){var K=P._size;if(M.overlaying){var J=h.getFromId({_fullLayout:P},M.overlaying);M.domain=J.domain}var te=B&&M._r?"_r":"range",ae=M.calendar;M.cleanRange(te);var ce,oe,ve=M.r2l(M[te][0],ae),fe=M.r2l(M[te][1],ae),xe="y"===S;if(xe?(M._offset=K.t+(1-M.domain[1])*K.h,M._length=K.h*(M.domain[1]-M.domain[0]),M._m=M._length/(ve-fe),M._b=-M._m*fe):(M._offset=K.l+M.domain[0]*K.w,M._length=K.w*(M.domain[1]-M.domain[0]),M._m=M._length/(fe-ve),M._b=-M._m*ve),M._rangebreaks=[],M._lBreaks=0,M._m2=0,M._B=[],M.rangebreaks&&(M._rangebreaks=M.locateBreaks(Math.min(ve,fe),Math.max(ve,fe)),M._rangebreaks.length)){for(ce=0;ce<M._rangebreaks.length;ce++)oe=M._rangebreaks[ce],M._lBreaks+=Math.abs(oe.max-oe.min);var Se=xe;ve>fe&&(Se=!Se),Se&&M._rangebreaks.reverse();var pe=Se?-1:1;for(M._m2=pe*M._length/(Math.abs(fe-ve)-M._lBreaks),M._B.push(-M._m2*(xe?fe:ve)),ce=0;ce<M._rangebreaks.length;ce++)M._B.push(M._B[M._B.length-1]-pe*M._m2*((oe=M._rangebreaks[ce]).max-oe.min));for(ce=0;ce<M._rangebreaks.length;ce++)(oe=M._rangebreaks[ce]).pmin=V(oe.min),oe.pmax=V(oe.max)}if(!isFinite(M._m)||!isFinite(M._b)||M._length<0)throw P._replotting=!1,new Error("Something went wrong with axis scaling")},M.maskBreaks=function(B){var K,J,te,ae,ce,oe=M.rangebreaks||[];oe._cachedPatterns||(oe._cachedPatterns=oe.map(function(ge){return ge.enabled&&ge.bounds?k.simpleMap(ge.bounds,ge.pattern?r:M.d2c):null})),oe._cachedValues||(oe._cachedValues=oe.map(function(ge){return ge.enabled&&ge.values?k.simpleMap(ge.values,M.d2c).sort(k.sorterAsc):null}));for(var ve=0;ve<oe.length;ve++){var fe=oe[ve];if(fe.enabled)if(fe.bounds){switch(J=(K=oe._cachedPatterns[ve])[0],te=K[1],fe.pattern){case w:ae=(ce=new Date(B)).getUTCDay(),J>te&&(te+=7,ae<J&&(ae+=7));break;case b:ae=(ce=new Date(B)).getUTCHours()+(ce.getUTCMinutes()/60+ce.getUTCSeconds()/3600+ce.getUTCMilliseconds()/36e5),J>te&&(te+=24,ae<J&&(ae+=24));break;case"":ae=B}if(ae>=J&&ae<te)return f}else for(var Se=oe._cachedValues[ve],pe=0;pe<Se.length;pe++)if(te=(J=Se[pe])+fe.dvalue,B>=J&&B<te)return f}return B},M.locateBreaks=function(B,K){var J,te,ae,ce,oe=[];if(!M.rangebreaks)return oe;var ve=M.rangebreaks.slice().sort(function(Me,De){return Me.pattern===w&&De.pattern===b?-1:De.pattern===w&&Me.pattern===b?1:0}),fe=function(Me,De){if((Me=k.constrain(Me,B,K))!==(De=k.constrain(De,B,K))){for(var Oe=!0,Ie=0;Ie<oe.length;Ie++){var Qe=oe[Ie];Me<Qe.max&&De>=Qe.min&&(Me<Qe.min&&(Qe.min=Me),De>Qe.max&&(Qe.max=De),Oe=!1)}Oe&&oe.push({min:Me,max:De})}};for(J=0;J<ve.length;J++){var xe=ve[J];if(xe.enabled)if(xe.bounds){var Se=B,pe=K;xe.pattern&&(Se=Math.floor(Se)),ae=(te=k.simpleMap(xe.bounds,xe.pattern?r:M.r2l))[0],ce=te[1];var ge,Te,se=new Date(Se);switch(xe.pattern){case w:Te=o,ge=(ce-ae+(ce<ae?7:0))*d,Se+=ae*d-(se.getUTCDay()*d+se.getUTCHours()*u+se.getUTCMinutes()*a+se.getUTCSeconds()*y+se.getUTCMilliseconds());break;case b:Te=d,ge=(ce-ae+(ce<ae?24:0))*u,Se+=ae*u-(se.getUTCHours()*u+se.getUTCMinutes()*a+se.getUTCSeconds()*y+se.getUTCMilliseconds());break;default:Se=Math.min(te[0],te[1]),ge=Te=(pe=Math.max(te[0],te[1]))-Se}for(var de=Se;de<pe;de+=Te)fe(de,de+ge)}else for(var Ae=k.simpleMap(xe.values,M.d2c),Le=0;Le<Ae.length;Le++)fe(ae=Ae[Le],ce=ae+xe.dvalue)}return oe.sort(function(Me,De){return Me.min-De.min}),oe},M.makeCalcdata=function(B,K,J){var te,ae,ce,oe,ve=M.type,fe="date"===ve&&B[K+"calendar"];if(K in B){if(te=B[K],oe=B._length||k.minRowLength(te),k.isTypedArray(te)&&("linear"===ve||"log"===ve)){if(oe===te.length)return te;if(te.subarray)return te.subarray(0,oe)}if("multicategory"===ve)return function(pe,ge){for(var Te=new Array(ge),se=0;se<ge;se++)Te[se]=Z([(pe[0]||[])[se],(pe[1]||[])[se]]);return Te}(te,oe);for(ae=new Array(oe),ce=0;ce<oe;ce++)ae[ce]=M.d2c(te[ce],0,fe,J)}else{var xe=K+"0"in B?M.d2c(B[K+"0"],0,fe):0,Se=B["d"+K]?Number(B["d"+K]):1;for(te=B[{x:"y",y:"x"}[K]],oe=B._length||te.length,ae=new Array(oe),ce=0;ce<oe;ce++)ae[ce]=xe+ce*Se}if(M.rangebreaks)for(ce=0;ce<oe;ce++)ae[ce]=M.maskBreaks(ae[ce]);return ae},M.isValidRange=function(B){return Array.isArray(B)&&2===B.length&&e(M.r2l(B[0]))&&e(M.r2l(B[1]))},M.isPtWithinRange=function(B,K){var J=M.c2l(B[S],null,K),te=M.r2l(M.range[0]),ae=M.r2l(M.range[1]);return te<ae?te<=J&&J<=ae:ae<=J&&J<=te},M._emptyCategories=function(){M._categories=[],M._categoriesMap={}},M.clearCalc=function(){var B=M._matchGroup;if(B){var K=null,J=null;for(var te in B){var ae=P[h.id2name(te)];if(ae._categories){K=ae._categories,J=ae._categoriesMap;break}}K&&J?(M._categories=K,M._categoriesMap=J):M._emptyCategories()}else M._emptyCategories();if(M._initialCategories)for(var ce=0;ce<M._initialCategories.length;ce++)q(M._initialCategories[ce])},M.sortByInitialCategories=function(){var B=[];if(M._emptyCategories(),M._initialCategories)for(var K=0;K<M._initialCategories.length;K++)q(M._initialCategories[K]);B=B.concat(M._traceIndices);var J=M._matchGroup;for(var te in J)if(z!==te){var ae=P[h.id2name(te)];ae._categories=M._categories,ae._categoriesMap=M._categoriesMap,B=B.concat(ae._traceIndices)}return B};var ee=P._d3locale;"date"===M.type&&(M._dateFormat=ee?ee.timeFormat:t,M._extraFormat=P._extraFormat),M._separators=P.separators,M._numFormat=ee?ee.numberFormat:x,delete M._minDtick,delete M._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(v,Q,$){"use strict";Q.exports=function(g){var t=["showexponent","showtickprefix","showticksuffix"].filter(function(k){return void 0!==g[k]});if(t.every(function(k){return g[k]===g[t[0]]})||1===t.length)return g[t[0]]}},{}],587:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color").contrast,k=v("./layout_attributes"),x=v("./show_dflt"),e=v("../array_container_defaults");function r(i,c){function n(m,p){return g.coerce(i,c,k.tickformatstops,m,p)}n("enabled")&&(n("dtickrange"),n("value"))}Q.exports=function(i,c,n,m,p){p||(p={});var s=x(i);if(n("showticklabels")){var f=p.font||{},l=c.color,o=-1!==(c.ticklabelposition||"").indexOf("inside")?t(p.bgColor):l&&l!==k.color.dflt?l:f.color;if(g.coerceFont(n,"tickfont",{family:f.family,size:f.size,color:o}),p.noTicklabelstep||"multicategory"===m||"log"===m||n("ticklabelstep"),p.noAng||n("tickangle"),"category"!==m){var d=n("tickformat");e(i,c,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:r}),c.tickformatstops.length||delete c.tickformatstops,p.noExp||d||"date"===m||(n("showexponent",s),n("exponentformat"),n("minexponent"),n("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x,e,r){var i=r.isMinor,c=i?k.minor||{}:k,n=i?x.minor:x,m=i?t.minor:t,p=i?"minor.":"",s=g.coerce2(c,n,m,"ticklen",i?.6*(x.ticklen||5):void 0),f=g.coerce2(c,n,m,"tickwidth",i?x.tickwidth||1:void 0),l=g.coerce2(c,n,m,"tickcolor",(i?x.tickcolor:void 0)||n.color);e(p+"ticks",!i&&r.outerTicks||s||f||l?"outside":"")||(delete n.ticklen,delete n.tickwidth,delete n.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(v,Q,$){"use strict";var g=v("./clean_ticks"),t=v("../../lib").isArrayOrTypedArray;Q.exports=function(k,x,e,r,i){i||(i={});var c=i.isMinor,n=c?k.minor||{}:k,m=c?x.minor:x,p=c?"minor.":"";function s(a){var y=n[a];return void 0!==y?y:(m._template||{})[a]}var f=s("tick0"),l=s("dtick"),o=s("tickvals"),d=e(p+"tickmode",t(o)?"array":l?"linear":"auto");if("auto"===d)e(p+"nticks");else if("linear"===d){var u=m.dtick=g.dtick(l,r);m.tick0=g.tick0(f,r,x.calendar,u)}else"multicategory"!==r&&(void 0===e(p+"tickvals")?m.tickmode="auto":c||e("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../lib"),x=v("../../components/drawing"),e=v("./axes");Q.exports=function(r,i,c,n){var m=r._fullLayout;if(0!==i.length){var p,s,f,l;n&&(p=n());var o=g.ease(c.easing);return r._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(l),l=null,function(){for(var a={},y=0;y<i.length;y++){var h=i[y],b=h.plotinfo.yaxis;h.xr0&&(a[h.plotinfo.xaxis._name+".range"]=h.xr0.slice()),h.yr0&&(a[b._name+".range"]=h.yr0.slice())}return t.call("relayout",r,a).then(function(){for(var w=0;w<i.length;w++)d(i[w].plotinfo)})}()}),s=Date.now(),l=window.requestAnimationFrame(function a(){f=Date.now();for(var y=Math.min(1,(f-s)/c.duration),h=o(y),_=0;_<i.length;_++)u(i[_],h);f-s>c.duration?(function(){for(var b={},w=0;w<i.length;w++){var T=i[w],M=T.plotinfo.yaxis;T.xr1&&(b[T.plotinfo.xaxis._name+".range"]=T.xr1.slice()),T.yr1&&(b[M._name+".range"]=T.yr1.slice())}p&&p(),t.call("relayout",r,b).then(function(){for(var P=0;P<i.length;P++)d(i[P].plotinfo)})}(),l=window.cancelAnimationFrame(a)):l=window.requestAnimationFrame(a)}),Promise.resolve()}function d(a){var y=a.xaxis,h=a.yaxis;m._defs.select("#"+a.clipId+"> rect").call(x.setTranslate,0,0).call(x.setScale,1,1),a.plot.call(x.setTranslate,y._offset,h._offset).call(x.setScale,1,1);var _=a.plot.selectAll(".scatterlayer .trace");_.selectAll(".point").call(x.setPointGroupScale,1,1),_.selectAll(".textpoint").call(x.setTextPointsScale,1,1),_.call(x.hideOutsideRangePoints,a)}function u(a,y){var h=a.plotinfo,_=h.xaxis,b=h.yaxis,w=_._length,T=b._length,L=!!a.xr1,M=!!a.yr1,P=[];if(L){var z=k.simpleMap(a.xr0,_.r2l),S=k.simpleMap(a.xr1,_.r2l),C=z[1]-z[0],R=S[1]-S[0];P[0]=(z[0]*(1-y)+y*S[0]-z[0])/(z[1]-z[0])*w,P[2]=w*(1-y+y*R/C),_.range[0]=_.l2r(z[0]*(1-y)+y*S[0]),_.range[1]=_.l2r(z[1]*(1-y)+y*S[1])}else P[0]=0,P[2]=w;if(M){var D=k.simpleMap(a.yr0,b.r2l),j=k.simpleMap(a.yr1,b.r2l),q=D[1]-D[0],Z=j[1]-j[0];P[1]=(D[1]*(1-y)+y*j[1]-D[1])/(D[0]-D[1])*T,P[3]=T*(1-y+y*Z/q),b.range[0]=_.l2r(D[0]*(1-y)+y*j[0]),b.range[1]=b.l2r(D[1]*(1-y)+y*j[1])}else P[1]=0,P[3]=T;e.drawOne(r,_,{skipTitle:!0}),e.drawOne(r,b,{skipTitle:!0}),e.redrawComponents(r,[_._id,b._id]);var W=L?w/P[2]:1,G=M?T/P[3]:1,U=_._offset-(L?P[0]/P[2]*w:0),ee=b._offset-(M?P[1]/P[3]*T:0);h.clipRect.call(x.setTranslate,L?P[0]:0,M?P[1]:0).call(x.setScale,1/W,1/G),h.plot.call(x.setTranslate,U,ee).call(x.setScale,W,G),x.setPointGroupScale(h.zoomScalePts,1/W,1/G),x.setTextPointsScale(h.zoomScaleTxt,1/W,1/G)}e.redrawComponents(r)}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(v,Q,$){"use strict";var g=v("../../registry").traceIs,t=v("./axis_autotype");function k(e){return{v:"x",h:"y"}[e.orientation||"v"]}function x(e,r){var i=k(e),c=g(e,"box-violin"),n=g(e._fullInput||{},"candlestick");return c&&!n&&r===i&&void 0===e[i]&&void 0===e[i+"0"]}Q.exports=function(e,r,i,c){i("autotypenumbers",c.autotypenumbersDflt),"-"===i("type",(c.splomStash||{}).type)&&(function(n,m){if("-"===n.type){var p,s=n._id,f=s.charAt(0);-1!==s.indexOf("scene")&&(s=f);var l=function(b,w,T){for(var L=0;L<b.length;L++){var M=b[L];if("splom"===M.type&&M._length>0&&(M["_"+T+"axes"]||{})[w]||(M[T+"axis"]||T)===w&&(x(M,T)||(M[T]||[]).length||M[T+"0"]))return M}}(m,s,f);if(l){if("histogram"===l.type&&f==={v:"y",h:"x"}[l.orientation||"v"])return void(n.type="linear");var o=f+"calendar",d=l[o],u={noMultiCategory:!g(l,"cartesian")||g(l,"noMultiCategory")};if("box"===l.type&&l._hasPreCompStats&&f==={h:"x",v:"y"}[l.orientation||"v"]&&(u.noMultiCategory=!0),u.autotypenumbers=n.autotypenumbers,x(l,f)){var a=k(l),y=[];for(p=0;p<m.length;p++){var h=m[p];g(h,"box-violin")&&(h[f+"axis"]||f)===s&&(y.push(void 0!==h[a]?h[a][0]:void 0!==h.name?h.name:"text"),h[o]!==d&&(d=void 0))}n.type=t(y,d,u)}else if("splom"===l.type){var _=l.dimensions[l._axesDim[s]];_.visible&&(n.type=t(_.values,d,u))}else n.type=t(l[f]||[l[f+"0"]],d,u)}}}(r,c.data),"-"===r.type?r.type="linear":e.type=r.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(v,Q,$){"use strict";var g=v("../registry"),t=v("../lib");function k(i,c,n){var m,p,s,f=!1;if("data"===c.type)m=i._fullData[null!==c.traces?c.traces[0]:0];else{if("layout"!==c.type)return!1;m=i._fullLayout}return p=t.nestedProperty(m,c.prop).get(),(s=n[c.type]=n[c.type]||{}).hasOwnProperty(c.prop)&&s[c.prop]!==p&&(f=!0),s[c.prop]=p,{changed:f,value:p}}function x(i,c){var n=[],m=c[0],p={};if("string"==typeof m)p[m]=c[1];else{if(!t.isPlainObject(m))return n;p=m}return r(p,function(s,f,l){n.push({type:"layout",prop:s,value:l})},"",0),n}function e(i,c){var n,m,p,s,f=[];if(p=c[1],n=c[2],s={},"string"==typeof(m=c[0]))s[m]=p;else{if(!t.isPlainObject(m))return f;s=m,void 0===n&&(n=p)}return void 0===n&&(n=null),r(s,function(l,o,d){var u,a;if(Array.isArray(d)){a=d.slice();var y=Math.min(a.length,i.data.length);n&&(y=Math.min(y,n.length)),u=[];for(var h=0;h<y;h++)u[h]=n?n[h]:h}else a=d,u=n?n.slice():null;if(null===u)Array.isArray(a)&&(a=a[0]);else if(Array.isArray(u)){if(!Array.isArray(a)){var _=a;a=[];for(var b=0;b<u.length;b++)a[b]=_}a.length=Math.min(u.length,a.length)}f.push({type:"data",prop:l,traces:u,value:a})},"",0),f}function r(i,c,n,m){Object.keys(i).forEach(function(p){var s=i[p];if("_"!==p[0]){var f=n+(m>0?".":"")+p;t.isPlainObject(s)?r(s,c,f,m+1):c(f,p,s)}})}$.manageCommandObserver=function(i,c,n,m){var p={},s=!0;c&&c._commandObserver&&(p=c._commandObserver),p.cache||(p.cache={}),p.lookupTable={};var f=$.hasSimpleAPICommandBindings(i,n,p.lookupTable);if(c&&c._commandObserver){if(f)return p;if(c._commandObserver.remove)return c._commandObserver.remove(),c._commandObserver=null,p}if(f){k(i,f,p.cache),p.check=function(){if(s){var d=k(i,f,p.cache);return d.changed&&m&&void 0!==p.lookupTable[d.value]&&(p.disable(),Promise.resolve(m({value:d.value,type:f.type,prop:f.prop,traces:f.traces,index:p.lookupTable[d.value]})).then(p.enable,p.enable)),d.changed}};for(var l=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],o=0;o<l.length;o++)i._internalOn(l[o],p.check);p.remove=function(){for(var d=0;d<l.length;d++)i._removeInternalListener(l[d],p.check)}}else t.log("Unable to automatically bind plot updates to API command"),p.lookupTable={},p.remove=function(){};return p.disable=function(){s=!1},p.enable=function(){s=!0},c&&(c._commandObserver=p),p},$.hasSimpleAPICommandBindings=function(i,c,n){var m,p,s=c.length;for(m=0;m<s;m++){var f,l=c[m],o=l.method,d=l.args;if(Array.isArray(d)||(d=[]),!o)return!1;var u=$.computeAPICommandBindings(i,o,d);if(1!==u.length)return!1;if(p){if((f=u[0]).type!==p.type||f.prop!==p.prop)return!1;if(Array.isArray(p.traces)){if(!Array.isArray(f.traces))return!1;f.traces.sort();for(var a=0;a<p.traces.length;a++)if(p.traces[a]!==f.traces[a])return!1}else if(f.prop!==p.prop)return!1}else p=u[0],Array.isArray(p.traces)&&p.traces.sort();var y=(f=u[0]).value;if(Array.isArray(y)){if(1!==y.length)return!1;y=y[0]}n&&(n[y]=m)}return p},$.executeAPICommand=function(i,c,n){if("skip"===c)return Promise.resolve();var m=g.apiMethodRegistry[c],p=[i];Array.isArray(n)||(n=[]);for(var s=0;s<n.length;s++)p.push(n[s]);return m.apply(null,p).catch(function(f){return t.warn("API call to Plotly."+c+" rejected.",f),Promise.reject(f)})},$.computeAPICommandBindings=function(i,c,n){var m,s;switch(Array.isArray(n)||(n=[]),c){case"restyle":m=e(i,n);break;case"relayout":m=x(0,n);break;case"update":m=e(i,[n[0],n[2]]).concat(x(0,[n[1]]));break;case"animate":s=n,m=Array.isArray(s[0])&&1===s[0].length&&-1!==["string","number"].indexOf(typeof s[0][0])?[{type:"layout",prop:"_currentFrame",value:s[0][0].toString()}]:[];break;default:m=[]}return m}},{"../lib":515,"../registry":647}],593:[function(v,Q,$){"use strict";var g=v("../lib/extend").extendFlat;$.attributes=function(t,k){k=k||{};var x={valType:"info_array",editType:(t=t||{}).editType,items:[{valType:"number",min:0,max:1,editType:t.editType},{valType:"number",min:0,max:1,editType:t.editType}],dflt:[0,1]},e={x:g({},x,{}),y:g({},x,{}),editType:t.editType};return t.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:t.editType},e.column={valType:"integer",min:0,dflt:0,editType:t.editType}),e},$.defaults=function(t,k,x,e){var r=e&&e.x||[0,1],i=e&&e.y||[0,1],c=k.grid;if(c){var n=x("domain.column");void 0!==n&&(n<c.columns?r=c._domains.x[n]:delete t.domain.column);var m=x("domain.row");void 0!==m&&(m<c.rows?i=c._domains.y[m]:delete t.domain.row)}var p=x("domain.x",r),s=x("domain.y",i);p[0]<p[1]||(t.domain.x=r.slice()),s[0]<s[1]||(t.domain.y=i.slice())}},{"../lib/extend":505}],594:[function(v,Q,$){"use strict";Q.exports=function(g){var t=g.editType,k=g.colorEditType;void 0===k&&(k=t);var x={family:{valType:"string",noBlank:!0,strict:!0,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:k},editType:t};return g.autoSize&&(x.size.dflt="auto"),g.autoColor&&(x.color.dflt="auto"),g.arrayOk&&(x.family.arrayOk=!0,x.size.arrayOk=!0,x.color.arrayOk=!0),x}},{}],595:[function(v,Q,$){"use strict";Q.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(v,Q,$){"use strict";$.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},$.axesNames=["lonaxis","lataxis"],$.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},$.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},$.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},$.clipPad=.001,$.precision=.1,$.landColor="#F0DC82",$.waterColor="#3399FF",$.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},$.sphereSVG={type:"Sphere"},$.fillLayers={ocean:1,land:1,lakes:1},$.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},$.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],$.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],$.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-geo"),k=t.geoPath,x=t.geoDistance,e=v("d3-geo-projection"),r=v("../../registry"),i=v("../../lib"),c=i.strTranslate,n=v("../../components/color"),m=v("../../components/drawing"),p=v("../../components/fx"),s=v("../plots"),f=v("../cartesian/axes"),l=v("../cartesian/autorange").getAutoRange,o=v("../../components/dragelement"),d=v("../../components/selections").prepSelect,u=v("../../components/selections").clearOutline,a=v("../../components/selections").selectOnClick,y=v("./zoom"),h=v("./constants"),_=v("../../lib/geo_location_utils"),b=v("../../lib/topojson_utils"),w=v("topojson-client").feature;function T(P){this.id=P.id,this.graphDiv=P.graphDiv,this.container=P.container,this.topojsonURL=P.topojsonURL,this.isStatic=P.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=T.prototype;function M(P,z){var S=h.clipPad,C=P[0]+S,R=P[1]-S,D=z[0]+S,j=z[1]-S;C>0&&R<0&&(R+=360);var q=(R-C)/4;return{type:"Polygon",coordinates:[[[C,D],[C,j],[C+q,j],[C+2*q,j],[C+3*q,j],[R,j],[R,D],[R-q,D],[R-2*q,D],[R-3*q,D],[C,D]]]}}Q.exports=function(P){return new T(P)},L.plot=function(P,z,S,C){var R=this;if(C)return R.update(P,z,!0);R._geoCalcData=P,R._fullLayout=z;var D=z[this.id],j=[],q=!1;for(var Z in h.layerNameToAdjective)if("frame"!==Z&&D["show"+Z]){q=!0;break}for(var W=!1,G=0;G<P.length;G++){var X=P[0][0].trace;X._geo=R,X.locationmode&&(q=!0);var ne=X.marker;if(ne){var N=ne.angleref;(ne.angle||"north"===N||"previous"===N)&&(W=!0)}}if(this._hasMarkerAngles=W,q){var U=b.getTopojsonName(D);null!==R.topojson&&U===R.topojsonName||(R.topojsonName=U,void 0===PlotlyGeoAssets.topojson[R.topojsonName]&&j.push(R.fetchTopojson()))}j=j.concat(_.fetchTraceGeoData(P)),S.push(new Promise(function(ee,B){Promise.all(j).then(function(){R.topojson=PlotlyGeoAssets.topojson[R.topojsonName],R.update(P,z),ee()}).catch(B)}))},L.fetchTopojson=function(){var P=this,z=b.getTopojsonPath(P.topojsonURL,P.topojsonName);return new Promise(function(S,C){g.json(z,function(R,D){if(R)return C(404===R.status?new Error(["plotly.js could not find topojson file at",z+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")):new Error(["unexpected error while fetching topojson file at",z].join(" ")));PlotlyGeoAssets.topojson[P.topojsonName]=D,S()})})},L.update=function(P,z,S){var C=z[this.id];this.hasChoropleth=!1;for(var R=0;R<P.length;R++){var D=P[R],j=D[0].trace;"choropleth"===j.type&&(this.hasChoropleth=!0),!0===j.visible&&j._length>0&&j._module.calcGeoJSON(D,z)}if(!S){if(this.updateProjection(P,z))return;this.viewInitial&&this.scope===C.scope||this.saveViewInitial(C)}this.scope=C.scope,this.updateBaseLayers(z,C),this.updateDims(z,C),this.updateFx(z,C),s.generalUpdatePerTraceModule(this.graphDiv,this,P,C);var q=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=q.selectAll(".point"),this.dataPoints.text=q.selectAll("text"),this.dataPaths.line=q.selectAll(".js-line");var Z=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=Z.selectAll("path"),this._render()},L.updateProjection=function(P,z){var S=this.graphDiv,C=z[this.id],R=z._size,D=C.domain,j=C.projection,q=C.lonaxis,Z=C.lataxis,W=q._ax,G=Z._ax,X=this.projection=function(se){var de=se.projection,Ae=de.type,Le=h.projNames[Ae];Le="geo"+i.titleCase(Le);for(var Me=(t[Le]||e[Le])(),De=se._isSatellite?180*Math.acos(1/de.distance)/Math.PI:se._isClipped?h.lonaxisSpan[Ae]/2:null,Oe=["center","rotate","parallels","clipExtent"],Ie=function(Pe){return Pe?Me:[]},Qe=0;Qe<Oe.length;Qe++){var Ne=Oe[Qe];"function"!=typeof Me[Ne]&&(Me[Ne]=Ie)}return Me.isLonLatOverEdges=function(Pe){if(null===Me(Pe))return!0;if(De){var Re=Me.rotate();return x(Pe,[-Re[0],-Re[1]])>De*Math.PI/180}return!1},Me.getPath=function(){return k().projection(Me)},Me.getBounds=function(Pe){return Me.getPath().bounds(Pe)},Me.precision(h.precision),se._isSatellite&&Me.tilt(de.tilt).distance(de.distance),De&&Me.clipAngle(De-h.clipPad),Me}(C),ne=[[R.l+R.w*D.x[0],R.t+R.h*(1-D.y[1])],[R.l+R.w*D.x[1],R.t+R.h*(1-D.y[0])]],V=C.center||{},N=j.rotation||{},U=q.range||[],ee=Z.range||[];if(C.fitbounds){W._length=ne[1][0]-ne[0][0],G._length=ne[1][1]-ne[0][1],W.range=l(S,W),G.range=l(S,G);var B=(W.range[0]+W.range[1])/2,K=(G.range[0]+G.range[1])/2;if(C._isScoped)V={lon:B,lat:K};else if(C._isClipped){V={lon:B,lat:K},N={lon:B,lat:K,roll:N.roll};var J=j.type,te=h.lonaxisSpan[J]/2||180,ae=h.lataxisSpan[J]/2||90;U=[B-te,B+te],ee=[K-ae,K+ae]}else V={lon:B,lat:K},N={lon:B,lat:N.lat,roll:N.roll}}X.center([V.lon-N.lon,V.lat-N.lat]).rotate([-N.lon,-N.lat,N.roll]).parallels(j.parallels);var ce=M(U,ee);X.fitExtent(ne,ce);var oe=this.bounds=X.getBounds(ce),ve=this.fitScale=X.scale(),fe=X.translate();if(C.fitbounds){var xe=X.getBounds(M(W.range,G.range)),Se=Math.min((oe[1][0]-oe[0][0])/(xe[1][0]-xe[0][0]),(oe[1][1]-oe[0][1])/(xe[1][1]-xe[0][1]));isFinite(Se)?X.scale(Se*ve):i.warn("Something went wrong during"+this.id+"fitbounds computations.")}else X.scale(j.scale*ve);var pe=this.midPt=[(oe[0][0]+oe[1][0])/2,(oe[0][1]+oe[1][1])/2];if(X.translate([fe[0]+(pe[0]-fe[0]),fe[1]+(pe[1]-fe[1])]).clipExtent(oe),C._isAlbersUsa){var ge=X([V.lon,V.lat]),Te=X.translate();X.translate([Te[0]-(ge[0]-Te[0]),Te[1]-(ge[1]-Te[1])])}},L.updateBaseLayers=function(P,z){var S=this,C=S.topojson,R=S.layers,D=S.basePaths;function j(X){return"lonaxis"===X||"lataxis"===X}function q(X){return Boolean(h.lineLayers[X])}function Z(X){return Boolean(h.fillLayers[X])}var W=(this.hasChoropleth?h.layersForChoropleth:h.layers).filter(function(X){return q(X)||Z(X)?z["show"+X]:!j(X)||z[X].showgrid}),G=S.framework.selectAll(".layer").data(W,String);G.exit().each(function(X){delete R[X],delete D[X],g.select(this).remove()}),G.enter().append("g").attr("class",function(X){return"layer "+X}).each(function(X){var ne=R[X]=g.select(this);"bg"===X?S.bgRect=ne.append("rect").style("pointer-events","all"):j(X)?D[X]=ne.append("path").style("fill","none"):"backplot"===X?ne.append("g").classed("choroplethlayer",!0):"frontplot"===X?ne.append("g").classed("scatterlayer",!0):q(X)?D[X]=ne.append("path").style("fill","none").style("stroke-miterlimit",2):Z(X)&&(D[X]=ne.append("path").style("stroke","none"))}),G.order(),G.each(function(X){var ne=D[X],V=h.layerNameToAdjective[X];"frame"===X?ne.datum(h.sphereSVG):q(X)||Z(X)?ne.datum(w(C,C.objects[X])):j(X)&&ne.datum(function(N,U,ee){var B,K,J,te=U[N],ae=h.scopeDefaults[U.scope];"lonaxis"===N?(B=ae.lonaxisRange,K=ae.lataxisRange,J=function(Te,se){return[Te,se]}):"lataxis"===N&&(B=ae.lataxisRange,K=ae.lonaxisRange,J=function(Te,se){return[se,Te]});var ce={type:"linear",range:[B[0],B[1]-1e-6],tick0:te.tick0,dtick:te.dtick};f.setConvert(ce,ee);var oe=f.calcTicks(ce);U.isScoped||"lonaxis"!==N||oe.pop();for(var ve=oe.length,fe=new Array(ve),xe=0;xe<ve;xe++)for(var Se=oe[xe].x,pe=fe[xe]=[],ge=K[0];ge<K[1]+2.5;ge+=2.5)pe.push(J(Se,ge));return{type:"MultiLineString",coordinates:fe}}(X,z,P)).call(n.stroke,z[X].gridcolor).call(m.dashLine,z[X].griddash,z[X].gridwidth),q(X)?ne.call(n.stroke,z[V+"color"]).call(m.dashLine,"",z[V+"width"]):Z(X)&&ne.call(n.fill,z[V+"color"])})},L.updateDims=function(P,z){var S=this.bounds,C=(z.framewidth||0)/2,R=S[0][0]-C,D=S[0][1]-C,j=S[1][0]-R+C,q=S[1][1]-D+C;m.setRect(this.clipRect,R,D,j,q),this.bgRect.call(m.setRect,R,D,j,q).call(n.fill,z.bgcolor),this.xaxis._offset=R,this.xaxis._length=j,this.yaxis._offset=D,this.yaxis._length=q},L.updateFx=function(P,z){var S=this,C=S.graphDiv,R=S.bgRect,D=P.dragmode,j=P.clickmode;if(!S.isStatic){var q={element:S.bgRect.node(),gd:C,plotinfo:{id:S.id,xaxis:S.xaxis,yaxis:S.yaxis,fillRangeItems:function(W,G){G.isRect?(W.range={})[S.id]=[Z([G.xmin,G.ymin]),Z([G.xmax,G.ymax])]:(W.lassoPoints={})[S.id]=G.map(Z)}},xaxes:[S.xaxis],yaxes:[S.yaxis],subplot:S.id,clickFn:function(W){2===W&&u(C)}};"pan"===D?(R.node().onmousedown=null,R.call(y(S,z)),R.on("dblclick.zoom",function(){var W=S.viewInitial,G={};for(var X in W)G[S.id+"."+X]=W[X];r.call("_guiRelayout",C,G),C.emit("plotly_doubleclick",null)}),C._context._scrollZoom.geo||R.on("wheel.zoom",null)):"select"!==D&&"lasso"!==D||(R.on(".zoom",null),q.prepFn=function(W,G,X){d(W,G,X,q,D)},o.init(q)),R.on("mousemove",function(){var W=S.projection.invert(i.getPositionFromD3Event());if(!W)return o.unhover(C,g.event);S.xaxis.p2c=function(){return W[0]},S.yaxis.p2c=function(){return W[1]},p.hover(C,g.event,S.id)}),R.on("mouseout",function(){C._dragging||o.unhover(C,g.event)}),R.on("click",function(){"select"!==D&&"lasso"!==D&&(j.indexOf("select")>-1&&a(g.event,C,[S.xaxis],[S.yaxis],S.id,q),j.indexOf("event")>-1&&p.click(C,g.event))})}function Z(W){return S.projection.invert([W[0]+S.xaxis._offset,W[1]+S.yaxis._offset])}},L.makeFramework=function(){var P=this,z=P.graphDiv,S=z._fullLayout,C="clip"+S._uid+P.id;P.clipDef=S._clips.append("clipPath").attr("id",C),P.clipRect=P.clipDef.append("rect"),P.framework=g.select(P.container).append("g").attr("class","geo "+P.id).call(m.setClipUrl,C,z),P.project=function(R){var D=P.projection(R);return D?[D[0]-P.xaxis._offset,D[1]-P.yaxis._offset]:[null,null]},P.xaxis={_id:"x",c2p:function(R){return P.project(R)[0]}},P.yaxis={_id:"y",c2p:function(R){return P.project(R)[1]}},P.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},f.setConvert(P.mockAxis,S)},L.saveViewInitial=function(P){var S=P.center||{},C=P.projection,R=C.rotation||{};this.viewInitial={fitbounds:P.fitbounds,"projection.scale":C.scale},i.extendFlat(this.viewInitial,P._isScoped?{"center.lon":S.lon,"center.lat":S.lat}:P._isClipped?{"projection.rotation.lon":R.lon,"projection.rotation.lat":R.lat}:{"center.lon":S.lon,"center.lat":S.lat,"projection.rotation.lon":R.lon})},L.render=function(P){this._hasMarkerAngles&&P?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},L._render=function(){var P,z=this.projection,S=z.getPath();function C(D){var j=z(D.lonlat);return j?c(j[0],j[1]):null}function R(D){return z.isLonLatOverEdges(D.lonlat)?"none":null}for(P in this.basePaths)this.basePaths[P].attr("d",S);for(P in this.dataPaths)this.dataPaths[P].attr("d",function(D){return S(D.geojson)});for(P in this.dataPoints)this.dataPoints[P].attr("display",R).attr("transform",C)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(v,Q,$){"use strict";var g=v("../../plots/get_data").getSubplotCalcData,t=v("../../lib").counterRegex,k=v("./geo"),x="geo",e=t(x),r={};r.geo={valType:"subplotid",dflt:x,editType:"calc"},Q.exports={attr:x,name:x,idRoot:x,idRegex:e,attrRegex:e,attributes:r,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(i){for(var c=i._fullLayout,n=i.calcdata,m=c._subplots.geo,p=0;p<m.length;p++){var s=m[p],f=g(n,x,s),l=c[s]._subplot;l||(l=k({id:s,graphDiv:i,container:c._geolayer.node(),topojsonURL:i._context.topojsonURL,staticPlot:i._context.staticPlot}),c[s]._subplot=l),l.plot(f,c,i._promises)}},updateFx:function(i){for(var c=i._fullLayout,n=c._subplots.geo,m=0;m<n.length;m++){var p=c[n[m]];p._subplot.updateFx(c,p)}},clean:function(i,c,n,m){for(var p=m._subplots.geo||[],s=0;s<p.length;s++){var f=p[s],l=m[f]._subplot;!c[f]&&l&&(l.framework.remove(),l.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(v,Q,$){"use strict";var g=v("../../components/color/attributes"),t=v("../domain").attributes,k=v("../../components/drawing/attributes").dash,x=v("./constants"),e=v("../../plot_api/edit_types").overrideAll,r=v("../../lib/sort_object_keys"),i={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:g.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:k};(Q.exports=e({domain:t({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:r(x.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:r(x.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:g.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:x.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:x.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:x.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:x.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:g.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:g.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:g.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:g.background},lonaxis:i,lataxis:i},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../subplot_defaults"),k=v("../get_data").getSubplotData,x=v("./constants"),e=v("./layout_attributes"),r=x.axesNames;function i(c,n,m,p){var s=k(p.fullData,"geo",p.id).map(function(N){return N._expandedIndex}),f=m("resolution"),l=m("scope"),o=x.scopeDefaults[l],d=m("projection.type",o.projType),u=n._isAlbersUsa="albers usa"===d;u&&(l=n.scope="usa");var a=n._isScoped="world"!==l,y=n._isSatellite="satellite"===d,h=n._isConic=-1!==d.indexOf("conic")||"albers"===d,_=n._isClipped=!!x.lonaxisSpan[d];if(!1===c.visible){var b=g.extendDeep({},n._template);b.showcoastlines=!1,b.showcountries=!1,b.showframe=!1,b.showlakes=!1,b.showland=!1,b.showocean=!1,b.showrivers=!1,b.showsubunits=!1,b.lonaxis&&(b.lonaxis.showgrid=!1),b.lataxis&&(b.lataxis.showgrid=!1),n._template=b}for(var w=m("visible"),T=0;T<r.length;T++){var L,M=r[T],P=[30,10][T];if(a)L=o[M+"Range"];else{var z=x[M+"Span"],S=(z[d]||z["*"])/2,C=m("projection.rotation."+M.substr(0,3),o.projRotate[T]);L=[C-S,C+S]}var R=m(M+".range",L);m(M+".tick0"),m(M+".dtick",P),m(M+".showgrid",!!w&&void 0)&&(m(M+".gridcolor"),m(M+".gridwidth"),m(M+".griddash")),n[M]._ax={type:"linear",_id:M.slice(0,3),_traceIndices:s,setScale:g.identity,c2l:g.identity,r2l:g.identity,autorange:!0,range:R.slice(),_m:1,_input:{}}}var D=n.lonaxis.range,j=n.lataxis.range,q=D[0],Z=D[1];q>0&&Z<0&&(Z+=360);var W,G,X,ne=(q+Z)/2;if(!u){var V=a?o.projRotate:[ne,0,0];W=m("projection.rotation.lon",V[0]),m("projection.rotation.lat",V[1]),m("projection.rotation.roll",V[2]),m("showcoastlines",!a&&w)&&(m("coastlinecolor"),m("coastlinewidth")),m("showocean",!!w&&void 0)&&m("oceancolor")}u?(G=-96.6,X=38.7):(G=a?ne:W,X=(j[0]+j[1])/2),m("center.lon",G),m("center.lat",X),y&&(m("projection.tilt"),m("projection.distance")),h&&m("projection.parallels",o.projParallels||[0,60]),m("projection.scale"),m("showland",!!w&&void 0)&&m("landcolor"),m("showlakes",!!w&&void 0)&&m("lakecolor"),m("showrivers",!!w&&void 0)&&(m("rivercolor"),m("riverwidth")),m("showcountries",a&&"usa"!==l&&w)&&(m("countrycolor"),m("countrywidth")),("usa"===l||"north america"===l&&50===f)&&(m("showsubunits",w),m("subunitcolor"),m("subunitwidth")),a||m("showframe",w)&&(m("framecolor"),m("framewidth")),m("bgcolor"),m("fitbounds")&&(delete n.projection.scale,a?(delete n.center.lon,delete n.center.lat):_?(delete n.center.lon,delete n.center.lat,delete n.projection.rotation.lon,delete n.projection.rotation.lat,delete n.lonaxis.range,delete n.lataxis.range):(delete n.center.lon,delete n.center.lat,delete n.projection.rotation.lon))}Q.exports=function(c,n,m){t(c,n,m,{type:"geo",attributes:e,handleDefaults:i,fullData:m,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../registry"),x=Math.PI/180,e=180/Math.PI,r={cursor:"pointer"},i={cursor:"auto"};function c(w,T){return g.behavior.zoom().translate(T.translate()).scale(T.scale())}function n(w,T,L){var M=w.id,P=w.graphDiv,z=P.layout,S=z[M],C=P._fullLayout,R=C[M],D={},j={};function q(Z,W){D[M+"."+Z]=t.nestedProperty(S,Z).get(),k.call("_storeDirectGUIEdit",z,C._preGUI,D);var G=t.nestedProperty(R,Z);G.get()!==W&&(G.set(W),t.nestedProperty(S,Z).set(W),j[M+"."+Z]=W)}L(q),q("projection.scale",T.scale()/w.fitScale),q("fitbounds",!1),P.emit("plotly_relayout",j)}function m(w,T){var L=c(0,T);function M(P){var z=T.invert(w.midPt);P("center.lon",z[0]),P("center.lat",z[1])}return L.on("zoomstart",function(){g.select(this).style(r)}).on("zoom",function(){T.scale(g.event.scale).translate(g.event.translate),w.render(!0);var P=T.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":T.scale()/w.fitScale,"geo.center.lon":P[0],"geo.center.lat":P[1]})}).on("zoomend",function(){g.select(this).style(i),n(w,T,M)}),L}function p(w,T){var L,M,P,z,S,C,R,D,j,q=c(0,T);function Z(G){return T.invert(G)}function W(G){var X=T.rotate(),ne=T.invert(w.midPt);G("projection.rotation.lon",-X[0]),G("center.lon",ne[0]),G("center.lat",ne[1])}return q.on("zoomstart",function(){g.select(this).style(r),L=g.mouse(this),M=T.rotate(),P=T.translate(),z=M,S=Z(L)}).on("zoom",function(){if(C=g.mouse(this),function(ne){var V=Z(ne);if(!V)return!0;var N=T(V);return Math.abs(N[0]-ne[0])>2||Math.abs(N[1]-ne[1])>2}(L))return q.scale(T.scale()),void q.translate(T.translate());T.scale(g.event.scale),T.translate([P[0],g.event.translate[1]]),S?Z(C)&&(D=Z(C),T.rotate(R=[z[0]+(D[0]-S[0]),M[1],M[2]]),z=R):S=Z(L=C),j=!0,w.render(!0);var G=T.rotate(),X=T.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":T.scale()/w.fitScale,"geo.center.lon":X[0],"geo.center.lat":X[1],"geo.projection.rotation.lon":-G[0]})}).on("zoomend",function(){g.select(this).style(i),j&&n(w,T,W)}),q}function s(w,T){var L,M={r:T.rotate(),k:T.scale()},P=c(0,T),z=function(Z){for(var W=0,G=arguments.length,X=[];++W<G;)X.push(arguments[W]);var ne=g.dispatch.apply(null,X);return ne.of=function(V,N){return function(U){var ee;try{ee=U.sourceEvent=g.event,U.target=Z,g.event=U,ne[U.type].apply(V,N)}finally{g.event=ee}}},ne}(P,"zoomstart","zoom","zoomend"),S=0,C=P.on;function R(Z){S++||Z({type:"zoomstart"})}function D(Z){Z({type:"zoom"})}function j(Z){--S||Z({type:"zoomend"})}function q(Z){var W=T.rotate();Z("projection.rotation.lon",-W[0]),Z("projection.rotation.lat",-W[1])}return P.on("zoomstart",function(){g.select(this).style(r);var Z=g.mouse(this),W=T.rotate(),G=W,X=T.translate(),ne=l(W);L=f(T,Z),C.call(P,"zoom",function(){var V=g.mouse(this);if(T.scale(M.k=g.event.scale),L){if(f(T,V)){T.rotate(W).translate(X);var N=f(T,V),U=d(L,N),ee=_(o(ne,U)),B=M.r=u(ee,L,G);isFinite(B[0])&&isFinite(B[1])&&isFinite(B[2])||(B=G),T.rotate(B),G=B}}else L=f(T,Z=V);D(z.of(this,arguments))}),R(z.of(this,arguments))}).on("zoomend",function(){g.select(this).style(i),C.call(P,"zoom",null),j(z.of(this,arguments)),n(w,T,q)}).on("zoom.redraw",function(){w.render(!0);var Z=T.rotate();w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":T.scale()/w.fitScale,"geo.projection.rotation.lon":-Z[0],"geo.projection.rotation.lat":-Z[1]})}),g.rebind(P,z,"on")}function f(w,T){var M,P,z,S,L=w.invert(T);return L&&isFinite(L[0])&&isFinite(L[1])&&(P=(M=L)[0]*x,z=M[1]*x,[(S=Math.cos(z))*Math.cos(P),S*Math.sin(P),Math.sin(z)])}function l(w){var T=.5*w[0]*x,L=.5*w[1]*x,M=.5*w[2]*x,P=Math.sin(T),z=Math.cos(T),S=Math.sin(L),C=Math.cos(L),R=Math.sin(M),D=Math.cos(M);return[z*C*D+P*S*R,P*C*D-z*S*R,z*S*D+P*C*R,z*C*R-P*S*D]}function o(w,T){var L=w[0],M=w[1],P=w[2],z=w[3],S=T[0],C=T[1],R=T[2],D=T[3];return[L*S-M*C-P*R-z*D,L*C+M*S+P*D-z*R,L*R-M*D+P*S+z*C,L*D+M*R-P*C+z*S]}function d(w,T){if(w&&T){var L=[(S=w)[1]*(C=T)[2]-S[2]*C[1],S[2]*C[0]-S[0]*C[2],S[0]*C[1]-S[1]*C[0]],M=Math.sqrt(b(L,L)),P=.5*Math.acos(Math.max(-1,Math.min(1,b(w,T)))),z=Math.sin(P)/M;return M&&[Math.cos(P),L[2]*z,-L[1]*z,L[0]*z]}var S,C}function u(w,T,L){var M=h(T,2,w[0]);M=h(M,1,w[1]),M=h(M,0,w[2]-L[2]);var P,z,S=T[0],C=T[1],R=T[2],D=M[0],j=M[1],q=M[2],Z=Math.atan2(C,S)*e,W=Math.sqrt(S*S+C*C);Math.abs(j)>W?(z=(j>0?90:-90)-Z,P=0):(z=Math.asin(j/W)*e-Z,P=Math.sqrt(W*W-j*j));var G=180-z-2*Z,X=(Math.atan2(q,D)-Math.atan2(R,P))*e,ne=(Math.atan2(q,D)-Math.atan2(R,-P))*e;return a(L[0],L[1],z,X)<=a(L[0],L[1],G,ne)?[z,X,L[2]]:[G,ne,L[2]]}function a(w,T,L,M){var P=y(L-w),z=y(M-T);return Math.sqrt(P*P+z*z)}function y(w){return(w%360+540)%360-180}function h(w,T,L){var M=L*x,P=w.slice(),z=0===T?1:0,S=2===T?1:2,C=Math.cos(M),R=Math.sin(M);return P[z]=w[z]*C-w[S]*R,P[S]=w[S]*C+w[z]*R,P}function _(w){return[Math.atan2(2*(w[0]*w[1]+w[2]*w[3]),1-2*(w[1]*w[1]+w[2]*w[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(w[0]*w[2]-w[3]*w[1]))))*e,Math.atan2(2*(w[0]*w[3]+w[1]*w[2]),1-2*(w[2]*w[2]+w[3]*w[3]))*e]}function b(w,T){for(var L=0,M=0,P=w.length;M<P;++M)L+=w[M]*T[M];return L}Q.exports=function(w,T){return(T._isScoped?m:T._isClipped?s:p)(w,w.projection)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(v,Q,$){"use strict";var g=v("../registry"),t=v("./cartesian/constants").SUBPLOT_PATTERN;$.getSubplotCalcData=function(k,x,e){var r=g.subplotsRegistry[x];if(!r)return[];for(var i=r.attr,c=[],n=0;n<k.length;n++){var m=k[n];m[0].trace[i]===e&&c.push(m)}return c},$.getModuleCalcData=function(k,x){var e,r=[],i=[];if(!(e="string"==typeof x?g.getModule(x).plot:"function"==typeof x?x:x.plot))return[r,k];for(var c=0;c<k.length;c++){var n=k[c],m=n[0].trace;!0===m.visible&&0!==m._length&&(m._module.plot===e?r.push(n):i.push(n))}return[r,i]},$.getSubplotData=function(k,x,e){if(!g.subplotsRegistry[x])return[];var r,i,c,n=g.subplotsRegistry[x].attr,m=[];if("gl2d"===x){var p=e.match(t);i="x"+p[1],c="y"+p[2]}for(var s=0;s<k.length;s++)r=k[s],"gl2d"===x&&g.traceIs(r,"gl2d")?r[n[0]]===i&&r[n[1]]===c&&m.push(r):r[n]===e&&m.push(r);return m}},{"../registry":647,"./cartesian/constants":573}],603:[function(v,Q,$){"use strict";var g=v("mouse-change"),t=v("mouse-wheel"),k=v("mouse-event-offset"),x=v("../cartesian/constants"),e=v("has-passive-events");function r(i,c){this.element=i,this.plot=c,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}Q.exports=function(i){var c=i.mouseContainer,n=i.glplot,m=new r(c,n);function p(){i.xaxis.autorange=!1,i.yaxis.autorange=!1}function s(f,l,o){var d,u,a=i.calcDataBox(),y=n.viewBox,h=m.lastPos[0],_=m.lastPos[1],b=x.MINDRAG*n.pixelRatio,w=x.MINZOOM*n.pixelRatio;function T(C,R,D){var j=Math.min(R,D),q=Math.max(R,D);j!==q?(a[C]=j,a[C+2]=q,m.dataBox=a,i.setRanges(a)):(i.selectBox.selectBox=[0,0,1,1],i.glplot.setDirty())}switch(l*=n.pixelRatio,o=y[3]-y[1]-(o*=n.pixelRatio),i.fullLayout.dragmode){case"zoom":if(f){var L=l/(y[2]-y[0])*(a[2]-a[0])+a[0],M=o/(y[3]-y[1])*(a[3]-a[1])+a[1];m.boxInited||(m.boxStart[0]=L,m.boxStart[1]=M,m.dragStart[0]=l,m.dragStart[1]=o),m.boxEnd[0]=L,m.boxEnd[1]=M,m.boxInited=!0,m.boxEnabled||m.boxStart[0]===m.boxEnd[0]&&m.boxStart[1]===m.boxEnd[1]||(m.boxEnabled=!0);var P=Math.abs(m.dragStart[0]-l)<w,z=Math.abs(m.dragStart[1]-o)<w;if(!function(){for(var C=i.graphDiv._fullLayout._axisConstraintGroups,R=i.xaxis._id,D=i.yaxis._id,j=0;j<C.length;j++)if(-1!==C[j][R]){if(-1!==C[j][D])return!0;break}return!1}()||P&&z)P&&(m.boxEnd[0]=m.boxStart[0]),z&&(m.boxEnd[1]=m.boxStart[1]);else{d=m.boxEnd[0]-m.boxStart[0],u=m.boxEnd[1]-m.boxStart[1];var S=(a[3]-a[1])/(a[2]-a[0]);Math.abs(d*S)>Math.abs(u)?(m.boxEnd[1]=m.boxStart[1]+Math.abs(d)*S*(u>=0?1:-1),m.boxEnd[1]<a[1]?(m.boxEnd[1]=a[1],m.boxEnd[0]=m.boxStart[0]+(a[1]-m.boxStart[1])/Math.abs(S)):m.boxEnd[1]>a[3]&&(m.boxEnd[1]=a[3],m.boxEnd[0]=m.boxStart[0]+(a[3]-m.boxStart[1])/Math.abs(S))):(m.boxEnd[0]=m.boxStart[0]+Math.abs(u)/S*(d>=0?1:-1),m.boxEnd[0]<a[0]?(m.boxEnd[0]=a[0],m.boxEnd[1]=m.boxStart[1]+(a[0]-m.boxStart[0])*Math.abs(S)):m.boxEnd[0]>a[2]&&(m.boxEnd[0]=a[2],m.boxEnd[1]=m.boxStart[1]+(a[2]-m.boxStart[0])*Math.abs(S)))}}else m.boxEnabled?(u=m.boxStart[1]!==m.boxEnd[1],(d=m.boxStart[0]!==m.boxEnd[0])||u?(d&&(T(0,m.boxStart[0],m.boxEnd[0]),i.xaxis.autorange=!1),u&&(T(1,m.boxStart[1],m.boxEnd[1]),i.yaxis.autorange=!1),i.relayoutCallback()):i.glplot.setDirty(),m.boxEnabled=!1,m.boxInited=!1):m.boxInited&&(m.boxInited=!1);break;case"pan":m.boxEnabled=!1,m.boxInited=!1,f?(m.panning||(m.dragStart[0]=l,m.dragStart[1]=o),Math.abs(m.dragStart[0]-l)<b&&(l=m.dragStart[0]),Math.abs(m.dragStart[1]-o)<b&&(o=m.dragStart[1]),u=(_-o)*(a[3]-a[1])/(n.viewBox[3]-n.viewBox[1]),a[0]+=d=(h-l)*(a[2]-a[0])/(n.viewBox[2]-n.viewBox[0]),a[2]+=d,a[1]+=u,a[3]+=u,i.setRanges(a),m.panning=!0,m.lastInputTime=Date.now(),p(),i.cameraChanged(),i.handleAnnotations()):m.panning&&(m.panning=!1,i.relayoutCallback())}m.lastPos[0]=l,m.lastPos[1]=o}return m.mouseListener=g(c,s),c.addEventListener("touchstart",function(f){var l=k(f.changedTouches[0],c);s(0,l[0],l[1]),s(1,l[0],l[1]),f.preventDefault()},!!e&&{passive:!1}),c.addEventListener("touchmove",function(f){f.preventDefault();var l=k(f.changedTouches[0],c);s(1,l[0],l[1]),f.preventDefault()},!!e&&{passive:!1}),c.addEventListener("touchend",function(f){s(0,m.lastPos[0],m.lastPos[1]),f.preventDefault()},!!e&&{passive:!1}),m.wheelListener=t(c,function(f,l){if(!i.scrollZoom)return!1;var o=i.calcDataBox(),d=n.viewBox,u=m.lastPos[0],a=m.lastPos[1],y=Math.exp(5*l/(d[3]-d[1])),h=u/(d[2]-d[0])*(o[2]-o[0])+o[0],_=a/(d[3]-d[1])*(o[3]-o[1])+o[1];return o[0]=(o[0]-h)*y+h,o[2]=(o[2]-h)*y+h,o[1]=(o[1]-_)*y+_,o[3]=(o[3]-_)*y+_,i.setRanges(o),m.lastInputTime=Date.now(),p(),i.cameraChanged(),i.handleAnnotations(),i.relayoutCallback(),!0},!0),m}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(v,Q,$){"use strict";var g=v("../cartesian/axes"),t=v("../../lib/str2rgbarray");function k(r){this.scene=r,this.gl=r.gl,this.pixelRatio=r.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var x=k.prototype,e=["xaxis","yaxis"];x.merge=function(r){var i,c,n,m,p,s,f,l,o,d,u;for(this.titleEnable=!1,this.backgroundColor=t(r.plot_bgcolor),d=0;d<2;++d){var a=(i=e[d]).charAt(0);for(n=(c=r[this.scene[i]._name]).title.text===this.scene.fullLayout._dfltTitle[a]?"":c.title.text,u=0;u<=2;u+=2)this.labelEnable[d+u]=!1,this.labels[d+u]=n,this.labelColor[d+u]=t(c.title.font.color),this.labelFont[d+u]=c.title.font.family,this.labelSize[d+u]=c.title.font.size,this.labelPad[d+u]=this.getLabelPad(i,c),this.tickEnable[d+u]=!1,this.tickColor[d+u]=t((c.tickfont||{}).color),this.tickAngle[d+u]="auto"===c.tickangle?0:Math.PI*-c.tickangle/180,this.tickPad[d+u]=this.getTickPad(c),this.tickMarkLength[d+u]=0,this.tickMarkWidth[d+u]=c.tickwidth||0,this.tickMarkColor[d+u]=t(c.tickcolor),this.borderLineEnable[d+u]=!1,this.borderLineColor[d+u]=t(c.linecolor),this.borderLineWidth[d+u]=c.linewidth||0;f=this.hasSharedAxis(c),p=this.hasAxisInDfltPos(i,c)&&!f,s=this.hasAxisInAltrPos(i,c)&&!f,m=c.mirror||!1,l=f?-1!==String(m).indexOf("all"):!!m,o=f?"allticks"===m:-1!==String(m).indexOf("ticks"),p?this.labelEnable[d]=!0:s&&(this.labelEnable[d+2]=!0),p?this.tickEnable[d]=c.showticklabels:s&&(this.tickEnable[d+2]=c.showticklabels),(p||l)&&(this.borderLineEnable[d]=c.showline),(s||l)&&(this.borderLineEnable[d+2]=c.showline),(p||o)&&(this.tickMarkLength[d]=this.getTickMarkLength(c)),(s||o)&&(this.tickMarkLength[d+2]=this.getTickMarkLength(c)),this.gridLineEnable[d]=c.showgrid,this.gridLineColor[d]=t(c.gridcolor),this.gridLineWidth[d]=c.gridwidth,this.zeroLineEnable[d]=c.zeroline,this.zeroLineColor[d]=t(c.zerolinecolor),this.zeroLineWidth[d]=c.zerolinewidth}},x.hasSharedAxis=function(r){var i=this.scene;return 0!==g.findSubplotsWithAxis(i.fullLayout._subplots.gl2d,r).indexOf(i.id)},x.hasAxisInDfltPos=function(r,i){var c=i.side;return"xaxis"===r?"bottom"===c:"yaxis"===r?"left"===c:void 0},x.hasAxisInAltrPos=function(r,i){var c=i.side;return"xaxis"===r?"top"===c:"yaxis"===r?"right"===c:void 0},x.getLabelPad=function(r,i){var c=i.title.font.size,n=i.showticklabels;return"xaxis"===r?"top"===i.side?c*(1.5+(n?1:0))-10:c*(1.5+(n?.5:0))-10:"yaxis"===r?"right"===i.side?10+c*(1.5+(n?1:.5)):10+c*(1.5+(n?.5:0)):void 0},x.getTickPad=function(r){return"outside"===r.ticks?10+r.ticklen:15},x.getTickMarkLength=function(r){if(!r.ticks)return 0;var i=r.ticklen;return"inside"===r.ticks?-i:i},Q.exports=function(r){return new k(r)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(v,Q,$){"use strict";var g=v("../../plot_api/edit_types").overrideAll,t=v("./scene2d"),k=v("../layout_attributes"),x=v("../../constants/xmlns_namespaces"),e=v("../cartesian/constants"),r=v("../cartesian"),i=v("../../components/fx/layout_attributes"),c=v("../get_data").getSubplotData;$.name="gl2d",$.attr=["xaxis","yaxis"],$.idRoot=["x","y"],$.idRegex=e.idRegex,$.attrRegex=e.attrRegex,$.attributes=v("../cartesian/attributes"),$.supplyLayoutDefaults=function(n,m,p){m._has("cartesian")||r.supplyLayoutDefaults(n,m,p)},$.layoutAttrOverrides=g(r.layoutAttributes,"plot","from-root"),$.baseLayoutAttrOverrides=g({plot_bgcolor:k.plot_bgcolor,hoverlabel:i.hoverlabel},"plot","nested"),$.plot=function(n){for(var m=n._fullLayout,p=n._fullData,s=m._subplots.gl2d,f=0;f<s.length;f++){var l=s[f],o=m._plots[l],d=c(p,"gl2d",l),u=o._scene2d;void 0===u&&(u=new t({id:l,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio},m),o._scene2d=u),u.plot(d,n.calcdata,m,n.layout)}},$.clean=function(n,m,p,s){for(var f=s._subplots.gl2d||[],l=0;l<f.length;l++){var o=f[l],d=s._plots[o];d._scene2d&&0===c(n,"gl2d",o).length&&(d._scene2d.destroy(),delete s._plots[o])}r.clean.apply(this,arguments)},$.drawFramework=function(n){n._context.staticPlot||r.drawFramework(n)},$.toSVG=function(n){for(var m=n._fullLayout,p=m._subplots.gl2d,s=0;s<p.length;s++){var f=m._plots[p[s]]._scene2d,l=f.toImage("png");m._glimages.append("svg:image").attr({xmlns:x.svg,"xlink:href":l,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),f.destroy()}},$.updateFx=function(n){for(var m=n._fullLayout,p=m._subplots.gl2d,s=0;s<p.length;s++)m._plots[p[s]]._scene2d.updateFx(m.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(v,Q,$){"use strict";var g,t,k=v("../../registry"),x=v("../../plots/cartesian/axes"),e=v("../../components/fx"),r=v("../../../stackgl_modules").gl_plot2d,i=v("../../../stackgl_modules").gl_spikes2d,c=v("../../../stackgl_modules").gl_select_box,n=v("webgl-context"),m=v("./convert"),p=v("./camera"),s=v("../../lib/show_no_webgl_msg"),f=v("../cartesian/constraints"),l=f.enforce,o=f.clean,d=v("../cartesian/autorange").doAutoRange,u=v("../../components/dragelement/helpers"),a=u.drawMode,y=u.selectMode,h=["xaxis","yaxis"],_=v("../cartesian/constants").SUBPLOT_PATTERN;function b(T,L){this.container=T.container,this.graphDiv=T.graphDiv,this.pixelRatio=T.plotGlPixelRatio||window.devicePixelRatio,this.id=T.id,this.staticPlot=!!T.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=m(this),this.glplotOptions.merge(L),this.glplot=r(this.glplotOptions),this.camera=p(this),this.traces={},this.spikes=i(this.glplot),this.selectBox=c(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}Q.exports=b;var w=b.prototype;w.makeFramework=function(){if(this.staticPlot){if(!(t||(g=document.createElement("canvas"),t=n({canvas:g,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=g,this.gl=t}else{var T=this.container.querySelector(".gl-canvas-focus"),L=n({canvas:T,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return s(this),void(this.stopped=!0);this.canvas=T,this.gl=L}var M=this.canvas;M.style.width="100%",M.style.height="100%",M.style.position="absolute",M.style.top="0px",M.style.left="0px",M.style["pointer-events"]="none",this.updateSize(M);var P=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");P.style.position="absolute",P.style.top=P.style.left="0px",P.style.width=P.style.height="100%",P.style["z-index"]=20,P.style["pointer-events"]="none";var z=this.mouseContainer=document.createElement("div");z.style.position="absolute",z.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var S=this.container;S.appendChild(P),S.appendChild(z);var C=this;z.addEventListener("mouseout",function(){C.isMouseOver=!1,C.unhover()}),z.addEventListener("mouseover",function(){C.isMouseOver=!0})},w.toImage=function(T){T||(T="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(g),this.updateSize(this.canvas);var L=this.glplot.gl,M=L.drawingBufferWidth,P=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var z=new Uint8Array(M*P*4);L.readPixels(0,0,M,P,L.RGBA,L.UNSIGNED_BYTE,z);for(var S=0,C=P-1;S<C;++S,--C)for(var R=0;R<M;++R)for(var D=0;D<4;++D){var j=z[4*(M*S+R)+D];z[4*(M*S+R)+D]=z[4*(M*C+R)+D],z[4*(M*C+R)+D]=j}var q=document.createElement("canvas");q.width=M,q.height=P;var Z,W=q.getContext("2d",{willReadFrequently:!0}),G=W.createImageData(M,P);switch(G.data.set(z),W.putImageData(G,0,0),T){case"jpeg":Z=q.toDataURL("image/jpeg");break;case"webp":Z=q.toDataURL("image/webp");break;default:Z=q.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(g),Z},w.updateSize=function(T){T||(T=this.canvas);var L=this.pixelRatio,M=this.fullLayout,z=M.height,S=0|Math.ceil(L*M.width),C=0|Math.ceil(L*z);return T.width===S&&T.height===C||(T.width=S,T.height=C),T},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var T=[x.calcTicks(this.xaxis),x.calcTicks(this.yaxis)],L=0;L<2;++L)for(var M=0;M<T[L].length;++M)T[L][M].text=T[L][M].text+"";return T},w.updateRefs=function(T){this.fullLayout=T;var L=this.id.match(_),P="yaxis"+L[2];this.xaxis=this.fullLayout["xaxis"+L[1]],this.yaxis=this.fullLayout[P]},w.relayoutCallback=function(){var T=this.graphDiv,L=this.xaxis,M=this.yaxis,P=T.layout,z={},S=z[L._name+".range"]=L.range.slice(),C=z[M._name+".range"]=M.range.slice();z[L._name+".autorange"]=L.autorange,z[M._name+".autorange"]=M.autorange,k.call("_storeDirectGUIEdit",T.layout,T._fullLayout._preGUI,z);var R=P[L._name];R.range=S,R.autorange=L.autorange;var D=P[M._name];D.range=C,D.autorange=M.autorange,z.lastInputTime=this.camera.lastInputTime,T.emit("plotly_relayout",z)},w.cameraChanged=function(){var T=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(M,P){for(var z=0;z<2;++z){var S=M[z],C=P[z];if(S.length!==C.length)return!0;for(var R=0;R<S.length;++R)if(S[R].x!==C[R].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=T.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var T=this.graphDiv,L=this.fullLayout.annotations,M=0;M<L.length;M++){var P=L[M];P.xref===this.xaxis._id&&P.yref===this.yaxis._id&&k.getComponentMethod("annotations","drawOne")(T,M)}},w.destroy=function(){if(this.glplot){var T=this.traces;T&&Object.keys(T).map(function(L){T[L].dispose(),delete T[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(T,L,M){var P=this.glplot;this.updateRefs(M),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(T,L),this.updateFx(M.dragmode);var z=M.width,S=M.height;this.updateSize(this.canvas);var C=this.glplotOptions;C.merge(M),C.screenBox=[0,0,z,S];var R={_fullLayout:{_axisConstraintGroups:M._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:M._size}};o(R,this.xaxis),o(R,this.yaxis);var D,j,q=M._size,Z=this.xaxis.domain,W=this.yaxis.domain;for(C.viewBox=[q.l+Z[0]*q.w,q.b+W[0]*q.h,z-q.r-(1-Z[1])*q.w,S-q.t-(1-W[1])*q.h],this.mouseContainer.style.width=q.w*(Z[1]-Z[0])+"px",this.mouseContainer.style.height=q.h*(W[1]-W[0])+"px",this.mouseContainer.height=q.h*(W[1]-W[0]),this.mouseContainer.style.left=q.l+Z[0]*q.w+"px",this.mouseContainer.style.top=q.t+(1-W[1])*q.h+"px",j=0;j<2;++j)(D=this[h[j]])._length=C.viewBox[j+2]-C.viewBox[j],d(this.graphDiv,D),D.setScale();l(R),C.ticks=this.computeTickMarks(),C.dataBox=this.calcDataBox(),C.merge(M),P.update(C),this.glplot.draw()},w.calcDataBox=function(){var T=this.xaxis,L=this.yaxis,M=T.range,P=L.range,z=T.r2l,S=L.r2l;return[z(M[0]),S(P[0]),z(M[1]),S(P[1])]},w.setRanges=function(T){var L=this.xaxis,M=this.yaxis,P=L.l2r,z=M.l2r;L.range=[P(T[0]),P(T[2])],M.range=[z(T[1]),z(T[3])]},w.updateTraces=function(T,L){var M,P,z,S=Object.keys(this.traces);this.fullData=T;e:for(M=0;M<S.length;M++){var C=S[M],R=this.traces[C];for(P=0;P<T.length;P++)if((z=T[P]).uid===C&&z.type===R.type)continue e;R.dispose(),delete this.traces[C]}for(M=0;M<T.length;M++){var D=L[M],j=this.traces[(z=T[M]).uid];j?j.update(z,D):(j=z._module.plot(this,z,D),this.traces[z.uid]=j)}this.glplot.objects.sort(function(q,Z){return q._trace.index-Z._trace.index})},w.updateFx=function(T){y(T)||a(T)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===T?"move":"zoom"===T?"crosshair":null},w.emitPointAction=function(T,L){for(var M,P=T.trace.uid,z=T.pointIndex,S=0;S<this.fullData.length;S++)this.fullData[S].uid===P&&(M=this.fullData[S]);var C={x:T.traceCoord[0],y:T.traceCoord[1],curveNumber:M.index,pointNumber:z,data:M._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(C,M,z),this.graphDiv.emit(L,{points:[C]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var T=this.glplot,L=this.camera,M=L.mouseListener,P=1===this.lastButtonState&&0===M.buttons,z=this.fullLayout;this.lastButtonState=M.buttons,this.cameraChanged();var S,C=M.x*T.pixelRatio,R=this.canvas.height-T.pixelRatio*M.y;if(L.boxEnabled&&"zoom"===z.dragmode){this.selectBox.enabled=!0;for(var D=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],j=0;j<2;j++)L.boxStart[j]===L.boxEnd[j]&&(D[j]=T.dataBox[j],D[j+2]=T.dataBox[j+2]);T.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var q=z._size,G=(S=T.pick(C/T.pixelRatio+q.l+this.xaxis.domain[0]*q.w,R/T.pixelRatio-(q.t+(1-this.yaxis.domain[1])*q.h)))&&S.object._trace.handlePick(S);if(G&&P&&this.emitPointAction(G,"plotly_click"),S&&"skip"!==S.object._trace.hoverinfo&&z.hovermode&&G&&(!this.lastPickResult||this.lastPickResult.traceUid!==G.trace.uid||this.lastPickResult.dataCoord[0]!==G.dataCoord[0]||this.lastPickResult.dataCoord[1]!==G.dataCoord[1])){var X=G;this.lastPickResult={traceUid:G.trace?G.trace.uid:null,dataCoord:G.dataCoord.slice()},this.spikes.update({center:S.dataCoord}),X.screenCoord=[((T.viewBox[2]-T.viewBox[0])*(S.dataCoord[0]-T.dataBox[0])/(T.dataBox[2]-T.dataBox[0])+T.viewBox[0])/T.pixelRatio,(this.canvas.height-(T.viewBox[3]-T.viewBox[1])*(S.dataCoord[1]-T.dataBox[1])/(T.dataBox[3]-T.dataBox[1])-T.viewBox[1])/T.pixelRatio],this.emitPointAction(G,"plotly_hover");var ne=this.fullData[X.trace.index]||{},V=X.pointIndex,N=e.castHoverinfo(ne,z,V);if(N&&"all"!==N){var U=N.split("+");-1===U.indexOf("x")&&(X.traceCoord[0]=void 0),-1===U.indexOf("y")&&(X.traceCoord[1]=void 0),-1===U.indexOf("z")&&(X.traceCoord[2]=void 0),-1===U.indexOf("text")&&(X.textLabel=void 0),-1===U.indexOf("name")&&(X.name=void 0)}e.loneHover({x:X.screenCoord[0],y:X.screenCoord[1],xLabel:this.hoverFormatter("xaxis",X.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",X.traceCoord[1]),zLabel:X.traceCoord[2],text:X.textLabel,name:X.name,color:e.castHoverOption(ne,V,"bgcolor")||X.color,borderColor:e.castHoverOption(ne,V,"bordercolor"),fontFamily:e.castHoverOption(ne,V,"font.family"),fontSize:e.castHoverOption(ne,V,"font.size"),fontColor:e.castHoverOption(ne,V,"font.color"),nameLength:e.castHoverOption(ne,V,"namelength"),textAlign:e.castHoverOption(ne,V,"align")},{container:this.svgContainer,gd:this.graphDiv})}}S||this.unhover(),T.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},w.hoverFormatter=function(T,L){if(void 0!==L){var M=this[T];return x.tickText(M,M.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(v,Q,$){"use strict";var g=v("../../plot_api/edit_types").overrideAll,t=v("../../components/fx/layout_attributes"),k=v("./scene"),x=v("../get_data").getSubplotData,e=v("../../lib"),r=v("../../constants/xmlns_namespaces");$.name="gl3d",$.attr="scene",$.idRoot="scene",$.idRegex=$.attrRegex=e.counterRegex("scene"),$.attributes=v("./layout/attributes"),$.layoutAttributes=v("./layout/layout_attributes"),$.baseLayoutAttrOverrides=g({hoverlabel:t.hoverlabel},"plot","nested"),$.supplyLayoutDefaults=v("./layout/defaults"),$.plot=function(i){for(var c=i._fullLayout,n=i._fullData,m=c._subplots.gl3d,p=0;p<m.length;p++){var s=m[p],f=x(n,"gl3d",s),l=c[s],o=l.camera,d=l._scene;d||(d=new k({id:s,graphDiv:i,container:i.querySelector(".gl-container"),staticPlot:i._context.staticPlot,plotGlPixelRatio:i._context.plotGlPixelRatio,camera:o},c),l._scene=d),d.viewInitial||(d.viewInitial={up:{x:o.up.x,y:o.up.y,z:o.up.z},eye:{x:o.eye.x,y:o.eye.y,z:o.eye.z},center:{x:o.center.x,y:o.center.y,z:o.center.z}}),d.plot(f,c,i.layout)}},$.clean=function(i,c,n,m){for(var p=m._subplots.gl3d||[],s=0;s<p.length;s++){var f=p[s];!c[f]&&m[f]._scene&&(m[f]._scene.destroy(),m._infolayer&&m._infolayer.selectAll(".annotation-"+f).remove())}},$.toSVG=function(i){for(var c=i._fullLayout,n=c._subplots.gl3d,m=c._size,p=0;p<n.length;p++){var s=c[n[p]],f=s.domain,l=s._scene,o=l.toImage("png");c._glimages.append("svg:image").attr({xmlns:r.svg,"xlink:href":o,x:m.l+m.w*f.x[0],y:m.t+m.h*(1-f.y[1]),width:m.w*(f.x[1]-f.x[0]),height:m.h*(f.y[1]-f.y[0]),preserveAspectRatio:"none"}),l.destroy()}},$.cleanId=function(i){if(i.match(/^scene[0-9]*$/)){var c=i.substr(5);return"1"===c&&(c=""),"scene"+c}},$.updateFx=function(i){for(var c=i._fullLayout,n=c._subplots.gl3d,m=0;m<n.length;m++)c[n[m]]._scene.updateFx(c.dragmode,c.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(v,Q,$){"use strict";Q.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(v,Q,$){"use strict";var g=v("../../../components/color"),t=v("../../cartesian/layout_attributes"),k=v("../../../lib/extend").extendFlat,x=v("../../../plot_api/edit_types").overrideAll;Q.exports=x({visible:t.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:g.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:t.color,categoryorder:t.categoryorder,categoryarray:t.categoryarray,title:{text:t.title.text,font:t.title.font},type:k({},t.type,{values:["-","linear","log","date","category"]}),autotypenumbers:t.autotypenumbers,autorange:t.autorange,rangemode:t.rangemode,range:k({},t.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:t.ticks,mirror:t.mirror,ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:t.tickfont,tickangle:t.tickangle,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,showexponent:t.showexponent,exponentformat:t.exponentformat,minexponent:t.minexponent,separatethousands:t.separatethousands,tickformat:t.tickformat,tickformatstops:t.tickformatstops,hoverformat:t.hoverformat,showline:t.showline,linecolor:t.linecolor,linewidth:t.linewidth,showgrid:t.showgrid,gridcolor:k({},t.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:t.gridwidth,zeroline:t.zeroline,zerolinecolor:t.zerolinecolor,zerolinewidth:t.zerolinewidth,_deprecated:{title:t._deprecated.title,titlefont:t._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(v,Q,$){"use strict";var g=v("tinycolor2").mix,t=v("../../../lib"),k=v("../../../plot_api/plot_template"),x=v("./axis_attributes"),e=v("../../cartesian/type_defaults"),r=v("../../cartesian/axis_defaults"),i=["xaxis","yaxis","zaxis"];Q.exports=function(c,n,m){var p,s;function f(d,u){return t.coerce(p,s,x,d,u)}for(var l=0;l<i.length;l++){var o=i[l];p=c[o]||{},(s=k.newContainer(n,o))._id=o[0]+m.scene,s._name=o,e(p,s,f,m),r(p,s,f,{font:m.font,letter:o[0],data:m.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:m.bgColor,calendar:m.calendar},m.fullLayout),f("gridcolor",g(s.color,m.bgColor,13600/187).toRgbString()),f("title.text",o[0]),s.setScale=t.noop,f("showspikes")&&(f("spikesides"),f("spikethickness"),f("spikecolor",s.color)),f("showaxeslabels"),f("showbackground")&&f("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(v,Q,$){"use strict";var g=v("../../../lib/str2rgbarray"),t=v("../../../lib"),k=["xaxis","yaxis","zaxis"];function x(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}x.prototype.merge=function(e,r){for(var i=0;i<3;++i){var c=r[k[i]];c.visible?(this.labels[i]=e._meta?t.templateString(c.title.text,e._meta):c.title.text,"font"in c.title&&(c.title.font.color&&(this.labelColor[i]=g(c.title.font.color)),c.title.font.family&&(this.labelFont[i]=c.title.font.family),c.title.font.size&&(this.labelSize[i]=c.title.font.size)),"showline"in c&&(this.lineEnable[i]=c.showline),"linecolor"in c&&(this.lineColor[i]=g(c.linecolor)),"linewidth"in c&&(this.lineWidth[i]=c.linewidth),"showgrid"in c&&(this.gridEnable[i]=c.showgrid),"gridcolor"in c&&(this.gridColor[i]=g(c.gridcolor)),"gridwidth"in c&&(this.gridWidth[i]=c.gridwidth),"log"===c.type?this.zeroEnable[i]=!1:"zeroline"in c&&(this.zeroEnable[i]=c.zeroline),"zerolinecolor"in c&&(this.zeroLineColor[i]=g(c.zerolinecolor)),"zerolinewidth"in c&&(this.zeroLineWidth[i]=c.zerolinewidth),this.lineTickEnable[i]=!(!("ticks"in c)||!c.ticks),"ticklen"in c&&(this.lineTickLength[i]=this._defaultLineTickLength[i]=c.ticklen),"tickcolor"in c&&(this.lineTickColor[i]=g(c.tickcolor)),"tickwidth"in c&&(this.lineTickWidth[i]=c.tickwidth),"tickangle"in c&&(this.tickAngle[i]="auto"===c.tickangle?-3600:Math.PI*-c.tickangle/180),"showticklabels"in c&&(this.tickEnable[i]=c.showticklabels),"tickfont"in c&&(c.tickfont.color&&(this.tickColor[i]=g(c.tickfont.color)),c.tickfont.family&&(this.tickFont[i]=c.tickfont.family),c.tickfont.size&&(this.tickSize[i]=c.tickfont.size)),"mirror"in c?-1!==["ticks","all","allticks"].indexOf(c.mirror)?(this.lineTickMirror[i]=!0,this.lineMirror[i]=!0):!0===c.mirror?(this.lineTickMirror[i]=!1,this.lineMirror[i]=!0):(this.lineTickMirror[i]=!1,this.lineMirror[i]=!1):this.lineMirror[i]=!1,"showbackground"in c&&!1!==c.showbackground?(this.backgroundEnable[i]=!0,this.backgroundColor[i]=g(c.backgroundcolor)):this.backgroundEnable[i]=!1):(this.tickEnable[i]=!1,this.labelEnable[i]=!1,this.lineEnable[i]=!1,this.lineTickEnable[i]=!1,this.gridEnable[i]=!1,this.zeroEnable[i]=!1,this.backgroundEnable[i]=!1)}},Q.exports=function(e,r){var i=new x;return i.merge(e,r),i}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(v,Q,$){"use strict";var g=v("../../../lib"),t=v("../../../components/color"),k=v("../../../registry"),x=v("../../subplot_defaults"),e=v("./axis_defaults"),r=v("./layout_attributes"),i=v("../../get_data").getSubplotData;function c(n,m,p,s){for(var f=p("bgcolor"),l=t.combine(f,s.paper_bgcolor),o=["up","center","eye"],d=0;d<o.length;d++)p("camera."+o[d]+".x"),p("camera."+o[d]+".y"),p("camera."+o[d]+".z");p("camera.projection.type");var u=!!p("aspectratio.x")&&!!p("aspectratio.y")&&!!p("aspectratio.z"),a=p("aspectmode",u?"manual":"auto");u||(n.aspectratio=m.aspectratio={x:1,y:1,z:1},"manual"===a&&(m.aspectmode="auto"),n.aspectmode=m.aspectmode);var y=i(s.fullData,"gl3d",s.id);e(n,m,{font:s.font,scene:s.id,data:y,bgColor:l,calendar:s.calendar,autotypenumbersDflt:s.autotypenumbersDflt,fullLayout:s.fullLayout}),k.getComponentMethod("annotations3d","handleDefaults")(n,m,s);var h=s.getDfltFromLayout("dragmode");if(!1!==h&&!h)if(h="orbit",n.camera&&n.camera.up){var _=n.camera.up.x,b=n.camera.up.y,w=n.camera.up.z;0!==w&&(_&&b&&w?w/Math.sqrt(_*_+b*b+w*w)>.999&&(h="turntable"):h="turntable")}else h="turntable";p("dragmode",h),p("hovermode",s.getDfltFromLayout("hovermode"))}Q.exports=function(n,m,p){var s=m._basePlotModules.length>1;x(n,m,p,{type:"gl3d",attributes:r,handleDefaults:c,fullLayout:m,font:m.font,fullData:p,getDfltFromLayout:function(f){if(!s)return g.validate(n[f],r[f])?n[f]:void 0},autotypenumbersDflt:m.autotypenumbers,paper_bgcolor:m.paper_bgcolor,calendar:m.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(v,Q,$){"use strict";var g=v("./axis_attributes"),t=v("../../domain").attributes,k=v("../../../lib/extend").extendFlat,x=v("../../../lib").counterRegex;function e(r,i,c){return{x:{valType:"number",dflt:r,editType:"camera"},y:{valType:"number",dflt:i,editType:"camera"},z:{valType:"number",dflt:c,editType:"camera"},editType:"camera"}}Q.exports={_arrayAttrRegexps:[x("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:k(e(0,0,1),{}),center:k(e(0,0,0),{}),eye:k(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:t({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:g,yaxis:g,zaxis:g,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(v,Q,$){"use strict";var g=v("../../../lib/str2rgbarray"),t=["xaxis","yaxis","zaxis"];function k(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}k.prototype.merge=function(x){for(var e=0;e<3;++e){var r=x[t[e]];r.visible?(this.enabled[e]=r.showspikes,this.colors[e]=g(r.spikecolor),this.drawSides[e]=r.spikesides,this.lineWidth[e]=r.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},Q.exports=function(x){var e=new k;return e.merge(x),e}},{"../../../lib/str2rgbarray":540}],615:[function(v,Q,$){"use strict";Q.exports=function(e){for(var r=e.axesOptions,i=e.glplot.axesPixels,c=e.fullSceneLayout,n=[[],[],[]],m=0;m<3;++m){var p=c[k[m]];if(p._length=(i[m].hi-i[m].lo)*i[m].pixelsPerDataUnit/e.dataScale[m],Math.abs(p._length)===1/0||isNaN(p._length))n[m]=[];else{p._input_range=p.range.slice(),p.range[0]=i[m].lo/e.dataScale[m],p.range[1]=i[m].hi/e.dataScale[m],p._m=1/(e.dataScale[m]*i[m].pixelsPerDataUnit),p.range[0]===p.range[1]&&(p.range[0]-=1,p.range[1]+=1);var s=p.tickmode;if("auto"===p.tickmode){p.tickmode="linear";var f=p.nticks||t.constrain(p._length/40,4,9);g.autoTicks(p,Math.abs(p.range[1]-p.range[0])/f)}for(var l=g.calcTicks(p,{msUTC:!0}),o=0;o<l.length;++o)l[o].x=l[o].x*e.dataScale[m],"date"===p.type&&(l[o].text=l[o].text.replace(/\<br\>/g," "));n[m]=l,p.tickmode=s}}for(r.ticks=n,m=0;m<3;++m)for(x[m]=.5*(e.glplot.bounds[0][m]+e.glplot.bounds[1][m]),o=0;o<2;++o)r.bounds[o][m]=e.glplot.bounds[o][m];e.contourLevels=function(d){for(var u=new Array(3),a=0;a<3;++a){for(var y=d[a],h=new Array(y.length),_=0;_<y.length;++_)h[_]=y[_].x;u[a]=h}return u}(n)};var g=v("../../cartesian/axes"),t=v("../../../lib"),k=["xaxis","yaxis","zaxis"],x=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(v,Q,$){"use strict";function g(t,k){var x,e,r=[0,0,0,0];for(x=0;x<4;++x)for(e=0;e<4;++e)r[e]+=t[4*x+e]*k[x];return r}Q.exports=function(t,k){return g(t.projection,g(t.view,g(t.model,[k[0],k[1],k[2],1])))}},{}],617:[function(v,Q,$){"use strict";var g,t,k=v("../../../stackgl_modules").gl_plot3d,x=k.createCamera,e=k.createScene,r=v("webgl-context"),i=v("has-passive-events"),c=v("../../registry"),n=v("../../lib"),m=n.preserveDrawingBuffer(),p=v("../../plots/cartesian/axes"),s=v("../../components/fx"),f=v("../../lib/str2rgbarray"),l=v("../../lib/show_no_webgl_msg"),o=v("./project"),d=v("./layout/convert"),u=v("./layout/spikes"),a=v("./layout/tick_marks");function y(T,L){var M=document.createElement("div"),P=T.container;this.graphDiv=T.graphDiv;var z=document.createElementNS("http://www.w3.org/2000/svg","svg");z.style.position="absolute",z.style.top=z.style.left="0px",z.style.width=z.style.height="100%",z.style["z-index"]=20,z.style["pointer-events"]="none",M.appendChild(z),this.svgContainer=z,M.id=T.id,M.style.position="absolute",M.style.top=M.style.left="0px",M.style.width=M.style.height="100%",P.appendChild(M),this.fullLayout=L,this.id=T.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=d(L,L[this.id]),this.spikeOptions=u(L[this.id]),this.container=M,this.staticMode=!!T.staticPlot,this.pixelRatio=this.pixelRatio||T.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=c.getComponentMethod("annotations3d","convert"),this.drawAnnotations=c.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var h=y.prototype;h.prepareOptions=function(){var T={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:m,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(t||(g=document.createElement("canvas"),t=r({canvas:g,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");T.gl=t,T.canvas=g}return T};var _=!0;h.tryCreatePlot=function(){var T=this.prepareOptions(),L=!0;try{this.glplot=e(T)}catch(M){if(this.staticMode||!_||m)L=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{m=T.glOptions.preserveDrawingBuffer=!0,this.glplot=e(T)}catch(P){m=T.glOptions.preserveDrawingBuffer=!1,L=!1}}}return _=!1,L},h.initializeGLCamera=function(){var T=this.fullSceneLayout.camera;this.camera=x(this.container,{center:[T.center.x,T.center.y,T.center.z],eye:[T.eye.x,T.eye.y,T.eye.z],up:[T.up.x,T.up.y,T.up.z],_ortho:"orthographic"===T.projection.type,zoomMin:.01,zoomMax:100,mode:"orbit"})},h.initializeGLPlot=function(){var T=this;if(T.initializeGLCamera(),!T.tryCreatePlot())return l(T);T.traces={},T.make4thDimension();var L=T.graphDiv,M=L.layout,P=function(){var S={};return T.isCameraChanged(M)&&(S[T.id+".camera"]=T.getCamera()),T.isAspectChanged(M)&&(S[T.id+".aspectratio"]=T.glplot.getAspectratio(),"manual"!==M[T.id].aspectmode&&(T.fullSceneLayout.aspectmode=M[T.id].aspectmode=S[T.id+".aspectmode"]="manual")),S},z=function(S){if(!1!==S.fullSceneLayout.dragmode){var C=P();S.saveLayout(M),S.graphDiv.emit("plotly_relayout",C)}};return T.glplot.canvas&&(T.glplot.canvas.addEventListener("mouseup",function(){z(T)}),T.glplot.canvas.addEventListener("wheel",function(S){if(L._context._scrollZoom.gl3d){if(T.camera._ortho){var C=S.deltaX>S.deltaY?1.1:.9090909090909091,R=T.glplot.getAspectratio();T.glplot.setAspectratio({x:C*R.x,y:C*R.y,z:C*R.z})}z(T)}},!!i&&{passive:!1}),T.glplot.canvas.addEventListener("mousemove",function(){if(!1!==T.fullSceneLayout.dragmode&&0!==T.camera.mouseListener.buttons){var S=P();T.graphDiv.emit("plotly_relayouting",S)}}),T.staticMode||T.glplot.canvas.addEventListener("webglcontextlost",function(S){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:S,layer:T.id})},!1)),T.glplot.oncontextloss=function(){T.recoverContext()},T.glplot.onrender=function(){T.render()},!0},h.render=function(){var T,L=this,M=L.graphDiv,P=L.svgContainer,z=L.container.getBoundingClientRect();M._fullLayout._calcInverseTransform(M);var R=z.width*M._fullLayout._invScaleX,D=z.height*M._fullLayout._invScaleY;P.setAttributeNS(null,"viewBox","0 0 "+R+" "+D),P.setAttributeNS(null,"width",R),P.setAttributeNS(null,"height",D),a(L),L.glplot.axes.update(L.axesOptions);for(var j=Object.keys(L.traces),q=null,Z=L.glplot.selection,W=0;W<j.length;++W)"skip"!==(T=L.traces[j[W]]).data.hoverinfo&&T.handlePick(Z)&&(q=T),T.setContourLevels&&T.setContourLevels();function G(oe,ve,fe){var xe=L.fullSceneLayout[oe+"axis"];return"log"!==xe.type&&(ve=xe.d2l(ve)),p.hoverLabelText(xe,ve,fe)}if(null!==q){var ne,X=o(L.glplot.cameraParams,Z.dataCoordinate),V=M._fullData[(T=q.data).index],N=Z.index,U={xLabel:G("x",Z.traceCoordinate[0],T.xhoverformat),yLabel:G("y",Z.traceCoordinate[1],T.yhoverformat),zLabel:G("z",Z.traceCoordinate[2],T.zhoverformat)},ee=s.castHoverinfo(V,L.fullLayout,N),B=(ee||"").split("+"),K=ee&&"all"===ee;V.hovertemplate||K||(-1===B.indexOf("x")&&(U.xLabel=void 0),-1===B.indexOf("y")&&(U.yLabel=void 0),-1===B.indexOf("z")&&(U.zLabel=void 0),-1===B.indexOf("text")&&(Z.textLabel=void 0),-1===B.indexOf("name")&&(q.name=void 0));var J=[];"cone"===T.type||"streamtube"===T.type?(U.uLabel=G("x",Z.traceCoordinate[3],T.uhoverformat),(K||-1!==B.indexOf("u"))&&J.push("u: "+U.uLabel),U.vLabel=G("y",Z.traceCoordinate[4],T.vhoverformat),(K||-1!==B.indexOf("v"))&&J.push("v: "+U.vLabel),U.wLabel=G("z",Z.traceCoordinate[5],T.whoverformat),(K||-1!==B.indexOf("w"))&&J.push("w: "+U.wLabel),U.normLabel=Z.traceCoordinate[6].toPrecision(3),(K||-1!==B.indexOf("norm"))&&J.push("norm: "+U.normLabel),"streamtube"===T.type&&(U.divergenceLabel=Z.traceCoordinate[7].toPrecision(3),(K||-1!==B.indexOf("divergence"))&&J.push("divergence: "+U.divergenceLabel)),Z.textLabel&&J.push(Z.textLabel),ne=J.join("<br>")):"isosurface"===T.type||"volume"===T.type?(U.valueLabel=p.hoverLabelText(L._mockAxis,L._mockAxis.d2l(Z.traceCoordinate[3]),T.valuehoverformat),J.push("value: "+U.valueLabel),Z.textLabel&&J.push(Z.textLabel),ne=J.join("<br>")):ne=Z.textLabel;var te={x:Z.traceCoordinate[0],y:Z.traceCoordinate[1],z:Z.traceCoordinate[2],data:V._input,fullData:V,curveNumber:V.index,pointNumber:N};s.appendArrayPointValue(te,V,N),T._module.eventData&&(te=V._module.eventData(te,Z,V,{},N));var ae={points:[te]};if(L.fullSceneLayout.hovermode){var ce=[];s.loneHover({trace:V,x:(.5+.5*X[0]/X[3])*R,y:(.5-.5*X[1]/X[3])*D,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:ne,name:q.name,color:s.castHoverOption(V,N,"bgcolor")||q.color,borderColor:s.castHoverOption(V,N,"bordercolor"),fontFamily:s.castHoverOption(V,N,"font.family"),fontSize:s.castHoverOption(V,N,"font.size"),fontColor:s.castHoverOption(V,N,"font.color"),nameLength:s.castHoverOption(V,N,"namelength"),textAlign:s.castHoverOption(V,N,"align"),hovertemplate:n.castOption(V,N,"hovertemplate"),hovertemplateLabels:n.extendFlat({},te,U),eventData:[te]},{container:P,gd:M,inOut_bbox:ce}),te.bbox=ce[0]}M.emit(Z.buttons&&Z.distance<5?"plotly_click":"plotly_hover",ae),this.oldEventData=ae}else s.loneUnhover(P),this.oldEventData&&M.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;L.drawAnnotations(L)},h.recoverContext=function(){var T=this;T.glplot.dispose();var L=function(){T.glplot.gl.isContextLost()?requestAnimationFrame(L):T.initializeGLPlot()?T.plot.apply(T,T.plotArgs):n.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var b=["xaxis","yaxis","zaxis"];function w(T,L,M){for(var P=T.fullSceneLayout,z=0;z<3;z++){var S=b[z],C=S.charAt(0),R=P[S],D=L[C],j=L[C+"calendar"],q=L["_"+C+"length"];if(n.isArrayOrTypedArray(D))for(var Z,W=0;W<(q||D.length);W++)if(n.isArrayOrTypedArray(D[W]))for(var G=0;G<D[W].length;++G)Z=R.d2l(D[W][G],0,j),!isNaN(Z)&&isFinite(Z)&&(M[0][z]=Math.min(M[0][z],Z),M[1][z]=Math.max(M[1][z],Z));else Z=R.d2l(D[W],0,j),!isNaN(Z)&&isFinite(Z)&&(M[0][z]=Math.min(M[0][z],Z),M[1][z]=Math.max(M[1][z],Z));else M[0][z]=Math.min(M[0][z],0),M[1][z]=Math.max(M[1][z],q-1)}}h.plot=function(T,L,M){if(this.plotArgs=[T,L,M],!this.glplot.contextLost){var P,z,S,C,R,D,j=L[this.id],q=M[this.id];this.fullLayout=L,this.fullSceneLayout=j,this.axesOptions.merge(L,j),this.spikeOptions.merge(j),this.setViewport(j),this.updateFx(j.dragmode,j.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(f(j.bgcolor)),this.setConvert(R),T?Array.isArray(T)||(T=[T]):T=[];var Z=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(S=0;S<T.length;++S)!0===(P=T[S]).visible&&0!==P._length&&w(this,P,Z);!function(Ae,Le){for(var Me=Ae.fullSceneLayout,De=Me.annotations||[],Oe=0;Oe<3;Oe++)for(var Ie=b[Oe],Qe=Ie.charAt(0),Ne=Me[Ie],Pe=0;Pe<De.length;Pe++){var Re=De[Pe];if(Re.visible){var Ge=Ne.r2l(Re[Qe]);!isNaN(Ge)&&isFinite(Ge)&&(Le[0][Oe]=Math.min(Le[0][Oe],Ge),Le[1][Oe]=Math.max(Le[1][Oe],Ge))}}}(this,Z);var W=[1,1,1];for(C=0;C<3;++C)W[C]=Z[1][C]===Z[0][C]?1:1/(Z[1][C]-Z[0][C]);for(this.dataScale=W,this.convertAnnotations(this),S=0;S<T.length;++S)!0===(P=T[S]).visible&&0!==P._length&&((z=this.traces[P.uid])?z.data.type===P.type?z.update(P):(z.dispose(),z=P._module.plot(this,P),this.traces[P.uid]=z):(z=P._module.plot(this,P),this.traces[P.uid]=z),z.name=P.name);var G=Object.keys(this.traces);e:for(S=0;S<G.length;++S){for(C=0;C<T.length;++C)if(T[C].uid===G[S]&&!0===T[C].visible&&0!==T[C]._length)continue e;(z=this.traces[G[S]]).dispose(),delete this.traces[G[S]]}this.glplot.objects.sort(function(Ae,Le){return Ae._trace.data.index-Le._trace.data.index});var X,ne=[[0,0,0],[0,0,0]],V=[],N={};for(S=0;S<3;++S){if((D=(R=j[b[S]]).type)in N?(N[D].acc*=W[S],N[D].count+=1):N[D]={acc:W[S],count:1},R.autorange){ne[0][S]=1/0,ne[1][S]=-1/0;var U=this.glplot.objects,ee=this.fullSceneLayout.annotations||[],B=R._name.charAt(0);for(C=0;C<U.length;C++){var K=U[C],J=K.bounds,te=K._trace.data._pad||0;ne[0][S]="ErrorBars"===K.constructor.name&&R._lowerLogErrorBound?Math.min(ne[0][S],R._lowerLogErrorBound):Math.min(ne[0][S],J[0][S]/W[S]-te),ne[1][S]=Math.max(ne[1][S],J[1][S]/W[S]+te)}for(C=0;C<ee.length;C++){var ae=ee[C];if(ae.visible){var ce=R.r2l(ae[B]);ne[0][S]=Math.min(ne[0][S],ce),ne[1][S]=Math.max(ne[1][S],ce)}}if("rangemode"in R&&"tozero"===R.rangemode&&(ne[0][S]=Math.min(ne[0][S],0),ne[1][S]=Math.max(ne[1][S],0)),ne[0][S]>ne[1][S])ne[0][S]=-1,ne[1][S]=1;else{var oe=ne[1][S]-ne[0][S];ne[0][S]-=oe/32,ne[1][S]+=oe/32}if("reversed"===R.autorange){var ve=ne[0][S];ne[0][S]=ne[1][S],ne[1][S]=ve}}else{var fe=R.range;ne[0][S]=R.r2l(fe[0]),ne[1][S]=R.r2l(fe[1])}ne[0][S]===ne[1][S]&&(ne[0][S]-=1,ne[1][S]+=1),V[S]=ne[1][S]-ne[0][S],this.glplot.setBounds(S,{min:ne[0][S]*W[S],max:ne[1][S]*W[S]})}var xe=j.aspectmode;if("cube"===xe)X=[1,1,1];else if("manual"===xe){var Se=j.aspectratio;X=[Se.x,Se.y,Se.z]}else{if("auto"!==xe&&"data"!==xe)throw new Error("scene.js aspectRatio was not one of the enumerated types");var pe=[1,1,1];for(S=0;S<3;++S){var ge=N[D=(R=j[b[S]]).type];pe[S]=Math.pow(ge.acc,1/ge.count)/W[S]}X="data"===xe||Math.max.apply(null,pe)/Math.min.apply(null,pe)<=4?pe:[1,1,1]}j.aspectratio.x=q.aspectratio.x=X[0],j.aspectratio.y=q.aspectratio.y=X[1],j.aspectratio.z=q.aspectratio.z=X[2],this.glplot.setAspectratio(j.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:j.aspectratio.x,y:j.aspectratio.y,z:j.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=j.aspectmode);var Te=j.domain||null,se=L._size||null;if(Te&&se){var de=this.container.style;de.position="absolute",de.left=se.l+Te.x[0]*se.w+"px",de.top=se.t+(1-Te.y[1])*se.h+"px",de.width=se.w*(Te.x[1]-Te.x[0])+"px",de.height=se.h*(Te.y[1]-Te.y[0])+"px"}this.glplot.redraw()}},h.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},h.getCamera=function(){var T;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(T=this.camera).up[0],y:T.up[1],z:T.up[2]},center:{x:T.center[0],y:T.center[1],z:T.center[2]},eye:{x:T.eye[0],y:T.eye[1],z:T.eye[2]},projection:{type:!0===T._ortho?"orthographic":"perspective"}}},h.setViewport=function(T){var L,M=T.camera;this.camera.lookAt.apply(this,[[(L=M).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(T.aspectratio),"orthographic"===M.projection.type!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},h.isCameraChanged=function(T){var L=this.getCamera(),M=n.nestedProperty(T,this.id+".camera").get();var R,D,j,q,Z,W,z=!1;if(void 0===M)z=!0;else{for(var S=0;S<3;S++)for(var C=0;C<3;C++)if(R=L,q=C,Z=void 0,W=void 0,W=["x","y","z"],!(D=M)[(Z=["up","center","eye"])[j=S]]||R[Z[j]][W[q]]!==D[Z[j]][W[q]]){z=!0;break}(!M.projection||L.projection&&L.projection.type!==M.projection.type)&&(z=!0)}return z},h.isAspectChanged=function(T){var L=this.glplot.getAspectratio(),M=n.nestedProperty(T,this.id+".aspectratio").get();return void 0===M||M.x!==L.x||M.y!==L.y||M.z!==L.z},h.saveLayout=function(T){var L,M,P,z,S,C,R=this.fullLayout,D=this.isCameraChanged(T),j=this.isAspectChanged(T),q=D||j;if(q){var Z={};D&&(L=this.getCamera(),P=(M=n.nestedProperty(T,this.id+".camera")).get(),Z[this.id+".camera"]=P),j&&(z=this.glplot.getAspectratio(),C=(S=n.nestedProperty(T,this.id+".aspectratio")).get(),Z[this.id+".aspectratio"]=C),c.call("_storeDirectGUIEdit",T,R._preGUI,Z),D&&(M.set(L),n.nestedProperty(R,this.id+".camera").set(L)),j&&(S.set(z),n.nestedProperty(R,this.id+".aspectratio").set(z),this.glplot.redraw())}return q},h.updateFx=function(T,L){var M=this.camera;if(M)if("orbit"===T)M.mode="orbit",M.keyBindingMode="rotate";else if("turntable"===T){M.up=[0,0,1],M.mode="turntable",M.keyBindingMode="rotate";var P=this.graphDiv,z=P._fullLayout,S=this.fullSceneLayout.camera,C=S.up.x,R=S.up.y,D=S.up.z;if(D/Math.sqrt(C*C+R*R+D*D)<.999){var j=this.id+".camera.up",q={x:0,y:0,z:1},Z={};Z[j]=q;var W=P.layout;c.call("_storeDirectGUIEdit",W,z._preGUI,Z),S.up=q,n.nestedProperty(W,j).set(q)}}else M.keyBindingMode=T;this.fullSceneLayout.hovermode=L},h.toImage=function(T){T||(T="png"),this.staticMode&&this.container.appendChild(g),this.glplot.redraw();var L=this.glplot.gl,M=L.drawingBufferWidth,P=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var z=new Uint8Array(M*P*4);L.readPixels(0,0,M,P,L.RGBA,L.UNSIGNED_BYTE,z),function(j,q,Z){for(var W=0,G=Z-1;W<G;++W,--G)for(var X=0;X<q;++X)for(var ne=0;ne<4;++ne){var V=4*(q*W+X)+ne,N=4*(q*G+X)+ne,U=j[V];j[V]=j[N],j[N]=U}}(z,M,P),function(j,q,Z){for(var W=0;W<Z;++W)for(var G=0;G<q;++G){var X=4*(q*W+G),ne=j[X+3];if(ne>0)for(var V=255/ne,N=0;N<3;++N)j[X+N]=Math.min(V*j[X+N],255)}}(z,M,P);var S=document.createElement("canvas");S.width=M,S.height=P;var C,R=S.getContext("2d",{willReadFrequently:!0}),D=R.createImageData(M,P);switch(D.data.set(z),R.putImageData(D,0,0),T){case"jpeg":C=S.toDataURL("image/jpeg");break;case"webp":C=S.toDataURL("image/webp");break;default:C=S.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(g),C},h.setConvert=function(){for(var T=0;T<3;T++){var L=this.fullSceneLayout[b[T]];p.setConvert(L,this.fullLayout),L.setScale=n.noop}},h.make4thDimension=function(){var T=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},p.setConvert(this._mockAxis,T)},Q.exports=y},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x){x=x||g.length;for(var e=new Array(x),r=0;r<x;r++)e[r]=[g[r],t[r],k[r]];return e}},{}],619:[function(v,Q,$){"use strict";var g=v("./font_attributes"),t=v("./animation_attributes"),k=v("../components/color/attributes"),x=v("../components/shapes/draw_newshape/attributes"),e=v("../components/selections/draw_newselection/attributes"),r=v("./pad_attributes"),i=v("../lib/extend").extendFlat,c=g({editType:"calc"});c.family.dflt='"Open Sans", verdana, arial, sans-serif',c.size.dflt=12,c.color.dflt=k.defaultLine,Q.exports={font:c,title:{text:{valType:"string",editType:"layoutstyle"},font:g({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:i(r({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:k.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:k.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:k.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:x.newshape,activeshape:x.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:i({},t.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:g({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(v,Q,$){"use strict";var g=v("../../lib/sort_object_keys"),t='\xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',k=['\xa9 <a target="_blank" href="https://carto.com/">Carto</a>',t].join(" "),x=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:t,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:k,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:k,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:x,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:x,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=g(e);Q.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{"../../lib/sort_object_keys":538}],621:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){var x=t.split(" "),e=x[0],r=x[1],i=g.isArrayOrTypedArray(k)?g.mean(k):k,c=.5+i/100,n=1.5+i/100,m=["",""],p=[0,0];switch(e){case"top":m[0]="top",p[1]=-n;break;case"bottom":m[0]="bottom",p[1]=n}switch(r){case"left":m[1]="right",p[0]=-c;break;case"right":m[1]="left",p[0]=c}return{anchor:m[0]&&m[1]?m.join("-"):m[0]?m[0]:m[1]?m[1]:"center",offset:p}}},{"../../lib":515}],622:[function(v,Q,$){"use strict";var g=v("mapbox-gl/dist/mapbox-gl-unminified"),t=v("../../lib"),k=t.strTranslate,x=t.strScale,e=v("../../plots/get_data").getSubplotCalcData,r=v("../../constants/xmlns_namespaces"),i=v("@plotly/d3"),c=v("../../components/drawing"),n=v("../../lib/svg_text_utils"),m=v("./mapbox"),p=$.constants=v("./constants");function s(f){return"string"==typeof f&&(-1!==p.styleValuesMapbox.indexOf(f)||0===f.indexOf("mapbox://"))}$.name="mapbox",$.attr="subplot",$.idRoot="mapbox",$.idRegex=$.attrRegex=t.counterRegex("mapbox"),$.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},$.layoutAttributes=v("./layout_attributes"),$.supplyLayoutDefaults=v("./layout_defaults"),$.plot=function(f){var l=f._fullLayout,o=f.calcdata,d=l._subplots.mapbox;if(g.version!==p.requiredVersion)throw new Error(p.wrongVersionErrorMsg);var u=function(w,T){var L=w._fullLayout;if(""===w._context.mapboxAccessToken)return"";for(var M=[],P=[],z=!1,S=!1,C=0;C<T.length;C++){var R=L[T[C]],D=R.accesstoken;s(R.style)&&(D?t.pushUnique(M,D):(s(R._input.style)&&(t.error("Uses Mapbox map style, but did not set an access token."),z=!0),S=!0)),D&&t.pushUnique(P,D)}if(S){var j=z?p.noAccessTokenErrorMsg:p.missingStyleErrorMsg;throw t.error(j),new Error(j)}return M.length?(M.length>1&&t.warn(p.multipleTokensErrorMsg),M[0]):(P.length&&t.log(["Listed mapbox access token(s)",P.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(f,d);g.accessToken=u;for(var a=0;a<d.length;a++){var y=d[a],h=e(o,"mapbox",y),_=l[y],b=_._subplot;b||(b=new m(f,y),l[y]._subplot=b),b.viewInitial||(b.viewInitial={center:t.extendFlat({},_.center),zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),b.plot(h,l,f._promises)}},$.clean=function(f,l,o,d){for(var u=d._subplots.mapbox||[],a=0;a<u.length;a++){var y=u[a];!l[y]&&d[y]._subplot&&d[y]._subplot.destroy()}},$.toSVG=function(f){for(var l=f._fullLayout,o=l._subplots.mapbox,d=l._size,u=0;u<o.length;u++){var a=l[o[u]],y=a.domain,h=a._subplot.toImage("png");l._glimages.append("svg:image").attr({xmlns:r.svg,"xlink:href":h,x:d.l+d.w*y.x[0],y:d.t+d.h*(1-y.y[1]),width:d.w*(y.x[1]-y.x[0]),height:d.h*(y.y[1]-y.y[0]),preserveAspectRatio:"none"});var _=i.select(a._subplot.div);if(null!==_.select(".mapboxgl-ctrl-logo").node().offsetParent){var b=l._glimages.append("g");b.attr("transform",k(d.l+d.w*y.x[0]+10,d.t+d.h*(1-y.y[0])-31)),b.append("path").attr("d",p.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),b.append("path").attr("d",p.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),b.append("path").attr("d",p.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),b.append("polygon").attr("points",p.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var w=_.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),T=l._glimages.append("g"),L=T.append("text");L.text(w).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":w});var M=c.bBox(L.node()),P=d.w*(y.x[1]-y.x[0]);if(M.width>P/2){var z=w.split("|").join("<br>");L.text(z).attr("data-unformatted",z).call(n.convertToTspans,f),M=c.bBox(L.node())}L.attr("transform",k(-3,8-M.height)),T.insert("rect",".static-attribution").attr({x:-M.width-6,y:-M.height-3,width:M.width+6,height:M.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;M.width+6>P&&(S=P/(M.width+6));var C=[d.l+d.w*y.x[1],d.t+d.h*(1-y.y[0])];T.attr("transform",k(C[0],C[1])+x(S))}},$.updateFx=function(f){for(var l=f._fullLayout,o=l._subplots.mapbox,d=0;d<o.length;d++)l[o[d]]._subplot.updateFx(l)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../lib/svg_text_utils").sanitizeHTML,k=v("./convert_text_opts"),x=v("./constants");function e(n,m){this.subplot=n,this.uid=n.uid+"-"+m,this.index=m,this.idSource="source-"+this.uid,this.idLayer=x.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var r=e.prototype;function i(n){if(!n.visible)return!1;var m=n.source;if(Array.isArray(m)&&m.length>0){for(var p=0;p<m.length;p++)if("string"!=typeof m[p]||0===m[p].length)return!1;return!0}return g.isPlainObject(m)||"string"==typeof m&&m.length>0}function c(n){var m={},p={};switch(n.type){case"circle":g.extendFlat(p,{"circle-radius":n.circle.radius,"circle-color":n.color,"circle-opacity":n.opacity});break;case"line":g.extendFlat(p,{"line-width":n.line.width,"line-color":n.color,"line-opacity":n.opacity,"line-dasharray":n.line.dash});break;case"fill":g.extendFlat(p,{"fill-color":n.color,"fill-outline-color":n.fill.outlinecolor,"fill-opacity":n.opacity});break;case"symbol":var s=n.symbol,f=k(s.textposition,s.iconsize);g.extendFlat(m,{"icon-image":s.icon+"-15","icon-size":s.iconsize/10,"text-field":s.text,"text-size":s.textfont.size,"text-anchor":f.anchor,"text-offset":f.offset,"symbol-placement":s.placement}),g.extendFlat(p,{"icon-color":n.color,"text-color":s.textfont.color,"text-opacity":n.opacity});break;case"raster":g.extendFlat(p,{"raster-fade-duration":0,"raster-opacity":n.opacity})}return{layout:m,paint:p}}r.update=function(n){this.visible?this.needsNewImage(n)?this.updateImage(n):this.needsNewSource(n)?(this.removeLayer(),this.updateSource(n),this.updateLayer(n)):this.needsNewLayer(n)?this.updateLayer(n):this.updateStyle(n):(this.updateSource(n),this.updateLayer(n)),this.visible=i(n)},r.needsNewImage=function(n){return this.subplot.map.getSource(this.idSource)&&"image"===this.sourceType&&"image"===n.sourcetype&&(this.source!==n.source||JSON.stringify(this.coordinates)!==JSON.stringify(n.coordinates))},r.needsNewSource=function(n){return this.sourceType!==n.sourcetype||JSON.stringify(this.source)!==JSON.stringify(n.source)||this.layerType!==n.type},r.needsNewLayer=function(n){return this.layerType!==n.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},r.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},r.updateImage=function(n){this.subplot.map.getSource(this.idSource).updateImage({url:n.source,coordinates:n.coordinates});var m=this.findFollowingMapboxLayerId(this.lookupBelow());null!==m&&this.subplot.map.moveLayer(this.idLayer,m)},r.updateSource=function(n){var s,f,l,o,d,m=this.subplot.map;if(m.getSource(this.idSource)&&m.removeSource(this.idSource),this.sourceType=n.sourcetype,this.source=n.source,i(n)){var p=(o=(s=n).source,d={type:l=s.sourcetype},"geojson"===l?f="data":"vector"===l?f="string"==typeof o?"url":"tiles":"raster"===l?(f="tiles",d.tileSize=256):"image"===l&&(f="url",d.coordinates=s.coordinates),d[f]=o,s.sourceattribution&&(d.attribution=t(s.sourceattribution)),d);m.addSource(this.idSource,p)}},r.findFollowingMapboxLayerId=function(n){if("traces"===n)for(var m=this.subplot.getMapLayers(),p=0;p<m.length;p++){var s=m[p].id;if("string"==typeof s&&0===s.indexOf(x.traceLayerPrefix)){n=s;break}}return n},r.updateLayer=function(n){var m=this.subplot,p=c(n),s=this.lookupBelow(),f=this.findFollowingMapboxLayerId(s);this.removeLayer(),i(n)&&m.addLayer({id:this.idLayer,source:this.idSource,"source-layer":n.sourcelayer||"",type:n.type,minzoom:n.minzoom,maxzoom:n.maxzoom,layout:p.layout,paint:p.paint},f),this.layerType=n.type,this.below=s},r.updateStyle=function(n){if(i(n)){var m=c(n);this.subplot.setOptions(this.idLayer,"setLayoutProperty",m.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",m.paint)}},r.removeLayer=function(){var n=this.subplot.map;n.getLayer(this.idLayer)&&n.removeLayer(this.idLayer)},r.dispose=function(){var n=this.subplot.map;n.getLayer(this.idLayer)&&n.removeLayer(this.idLayer),n.getSource(this.idSource)&&n.removeSource(this.idSource)},Q.exports=function(n,m,p){var s=new e(n,m);return s.update(p),s}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color").defaultLine,k=v("../domain").attributes,x=v("../font_attributes"),e=v("../../traces/scatter/attributes").textposition,r=v("../../plot_api/edit_types").overrideAll,i=v("../../plot_api/plot_template").templatedArray,c=v("./constants"),n=x({});n.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(Q.exports=r({_arrayAttrRegexps:[g.counterRegex("mapbox",".layers",!0)],domain:k({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:c.styleValuesMapbox.concat(c.styleValuesNonMapbox),dflt:c.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:i("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:t},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:t}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:n,textposition:g.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../subplot_defaults"),k=v("../array_container_defaults"),x=v("./layout_attributes");function e(i,c,n,m){n("accesstoken",m.accessToken),n("style"),n("center.lon"),n("center.lat"),n("zoom"),n("bearing"),n("pitch");var p=n("bounds.west"),s=n("bounds.east"),f=n("bounds.south"),l=n("bounds.north");void 0!==p&&void 0!==s&&void 0!==f&&void 0!==l||delete c.bounds,k(i,c,{name:"layers",handleItemDefaults:r}),c._input=i}function r(i,c){function n(l,o){return g.coerce(i,c,x.layers,l,o)}if(n("visible")){var m,p=n("sourcetype"),s="raster"===p||"image"===p;n("source"),n("sourceattribution"),"vector"===p&&n("sourcelayer"),"image"===p&&n("coordinates"),s&&(m="raster");var f=n("type",m);s&&"raster"!==f&&(f=c.type="raster",g.log("Source types *raster* and *image* must drawn *raster* layer type.")),n("below"),n("color"),n("opacity"),n("minzoom"),n("maxzoom"),"circle"===f&&n("circle.radius"),"line"===f&&(n("line.width"),n("line.dash")),"fill"===f&&n("fill.outlinecolor"),"symbol"===f&&(n("symbol.icon"),n("symbol.iconsize"),n("symbol.text"),g.coerceFont(n,"symbol.textfont"),n("symbol.textposition"),n("symbol.placement"))}}Q.exports=function(i,c,n){t(i,c,n,{type:"mapbox",attributes:x,handleDefaults:e,partition:"y",accessToken:c._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(v,Q,$){"use strict";var g=v("mapbox-gl/dist/mapbox-gl-unminified"),t=v("../../lib"),k=v("../../lib/geo_location_utils"),x=v("../../registry"),e=v("../cartesian/axes"),r=v("../../components/dragelement"),i=v("../../components/fx"),c=v("../../components/dragelement/helpers"),n=c.drawMode,m=c.selectMode,p=v("../../components/selections").prepSelect,s=v("../../components/selections").clearOutline,f=v("../../components/selections").clearSelectionsCache,l=v("../../components/selections").selectOnClick,o=v("./constants"),d=v("./layers");function u(w,T){this.id=T,this.gd=w;var L=w._fullLayout,M=w._context;this.container=L._glcontainer.node(),this.isStatic=M.staticPlot,this.uid=L._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(L),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var a=u.prototype;a.plot=function(w,T,L){var M,P=this;P.map&&T[P.id].accesstoken!==P.accessToken&&(P.map.remove(),P.map=null,P.styleObj=null,P.traceHash={},P.layerList=[]),M=new Promise(P.map?function(S,C){P.updateMap(w,T,S,C)}:function(S,C){P.createMap(w,T,S,C)}),L.push(M)},a.createMap=function(w,T,L,M){var P=this,z=T[P.id],S=P.styleObj=h(z.style);P.accessToken=z.accesstoken;var C=z.bounds,R=C?[[C.west,C.south],[C.east,C.north]]:null,D=P.map=new g.Map({container:P.div,style:S.style,center:b(z.center),zoom:z.zoom,bearing:z.bearing,pitch:z.pitch,maxBounds:R,interactive:!P.isStatic,preserveDrawingBuffer:P.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new g.AttributionControl({compact:!0}));D._canvas.style.left="0px",D._canvas.style.top="0px",P.rejectOnError(M),P.isStatic||P.initFx(w,T);var j=[];j.push(new Promise(function(q){D.once("load",q)})),j=j.concat(k.fetchTraceGeoData(w)),Promise.all(j).then(function(){P.fillBelowLookup(w,T),P.updateData(w),P.updateLayout(T),P.resolveOnRender(L)}).catch(M)},a.updateMap=function(w,T,L,M){var P=this,z=P.map,S=T[this.id];P.rejectOnError(M);var C=[],R=h(S.style);JSON.stringify(P.styleObj)!==JSON.stringify(R)&&(P.styleObj=R,z.setStyle(R.style),P.traceHash={},C.push(new Promise(function(D){z.once("styledata",D)}))),C=C.concat(k.fetchTraceGeoData(w)),Promise.all(C).then(function(){P.fillBelowLookup(w,T),P.updateData(w),P.updateLayout(T),P.resolveOnRender(L)}).catch(M)},a.fillBelowLookup=function(w,T){var L,M,P=T[this.id].layers,z=this.belowLookup={},S=!1;for(L=0;L<w.length;L++){var C=w[L][0].trace,R=C._module;"string"==typeof C.below?M=C.below:R.getBelow&&(M=R.getBelow(C,this)),""===M&&(S=!0),z["trace-"+C.uid]=M||""}for(L=0;L<P.length;L++){var D=P[L];z["layout-"+L]=M="string"==typeof D.below?D.below:S?"traces":""}var j,q,Z={};for(j in z)Z[M=z[j]]?Z[M].push(j):Z[M]=[j];for(M in Z){var W=Z[M];if(W.length>1)for(L=0;L<W.length;L++)0===(j=W[L]).indexOf("trace-")?(q=j.split("trace-")[1],this.traceHash[q]&&(this.traceHash[q].below=null)):0===j.indexOf("layout-")&&(q=j.split("layout-")[1],this.layerList[q]&&(this.layerList[q].below=null))}};var y={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function h(w){var T={};return t.isPlainObject(w)?(T.id=w.id,T.style=w):"string"==typeof w?(T.id=w,T.style=-1!==o.styleValuesMapbox.indexOf(w)?_(w):o.stylesNonMapbox[w]?o.stylesNonMapbox[w]:w):(T.id=o.styleValueDflt,T.style=_(o.styleValueDflt)),T.transition={duration:0,delay:0},T}function _(w){return o.styleUrlPrefix+w+"-"+o.styleUrlSuffix}function b(w){return[w.lon,w.lat]}a.updateData=function(w){var T,L,M,P,z=this.traceHash,S=w.slice().sort(function(q,Z){return y[q[0].trace.type]-y[Z[0].trace.type]});for(M=0;M<S.length;M++){var C=S[M],R=!1;(T=z[(L=C[0].trace).uid])&&(T.type===L.type?(T.update(C),R=!0):T.dispose()),!R&&L._module&&(z[L.uid]=L._module.plot(this,C))}var D=Object.keys(z);e:for(M=0;M<D.length;M++){var j=D[M];for(P=0;P<w.length;P++)if(j===(L=w[P][0].trace).uid)continue e;(T=z[j]).dispose(),delete z[j]}},a.updateLayout=function(w){var T=this.map,L=w[this.id];this.dragging||this.wheeling||(T.setCenter(b(L.center)),T.setZoom(L.zoom),T.setBearing(L.bearing),T.setPitch(L.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?T.scrollZoom.enable():T.scrollZoom.disable()},a.resolveOnRender=function(w){var T=this.map;T.on("render",function L(){T.loaded()&&(T.off("render",L),setTimeout(w,10))})},a.rejectOnError=function(w){var T=this.map;function L(){w(new Error(o.mapOnErrorMsg))}T.once("error",L),T.once("style.error",L),T.once("source.error",L),T.once("tile.error",L),T.once("layer.error",L)},a.createFramework=function(w){var T=this,L=T.div=document.createElement("div");L.id=T.uid,L.style.position="absolute",T.container.appendChild(L),T.xaxis={_id:"x",c2p:function(M){return T.project(M).x}},T.yaxis={_id:"y",c2p:function(M){return T.project(M).y}},T.updateFramework(w),T.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(T.mockAxis,w)},a.initFx=function(w,T){var L=this,M=L.gd,P=L.map;function z(){i.loneUnhover(T._hoverlayer)}function S(){var C=L.getView();M.emit("plotly_relayouting",L.getViewEditsWithDerived(C))}P.on("moveend",function(C){if(L.map){var R=M._fullLayout;if(C.originalEvent||L.wheeling){var D=R[L.id];x.call("_storeDirectGUIEdit",M.layout,R._preGUI,L.getViewEdits(D));var j=L.getView();D._input.center=D.center=j.center,D._input.zoom=D.zoom=j.zoom,D._input.bearing=D.bearing=j.bearing,D._input.pitch=D.pitch=j.pitch,M.emit("plotly_relayout",L.getViewEditsWithDerived(j))}C.originalEvent&&"mouseup"===C.originalEvent.type?L.dragging=!1:L.wheeling&&(L.wheeling=!1),R._rehover&&R._rehover()}}),P.on("wheel",function(){L.wheeling=!0}),P.on("mousemove",function(C){var R=L.div.getBoundingClientRect(),D=[C.originalEvent.offsetX,C.originalEvent.offsetY];C.target.getBoundingClientRect=function(){return R},L.xaxis.p2c=function(){return P.unproject(D).lng},L.yaxis.p2c=function(){return P.unproject(D).lat},M._fullLayout._rehover=function(){M._fullLayout._hoversubplot===L.id&&M._fullLayout[L.id]&&i.hover(M,C,L.id)},i.hover(M,C,L.id),M._fullLayout._hoversubplot=L.id}),P.on("dragstart",function(){L.dragging=!0,z()}),P.on("zoomstart",z),P.on("mouseout",function(){M._fullLayout._hoversubplot=null}),P.on("drag",S),P.on("zoom",S),P.on("dblclick",function(){var C=M._fullLayout[L.id];x.call("_storeDirectGUIEdit",M.layout,M._fullLayout._preGUI,L.getViewEdits(C));var R=L.viewInitial;P.setCenter(b(R.center)),P.setZoom(R.zoom),P.setBearing(R.bearing),P.setPitch(R.pitch);var D=L.getView();C._input.center=C.center=D.center,C._input.zoom=C.zoom=D.zoom,C._input.bearing=C.bearing=D.bearing,C._input.pitch=C.pitch=D.pitch,M.emit("plotly_doubleclick",null),M.emit("plotly_relayout",L.getViewEditsWithDerived(D))}),L.clearOutline=function(){f(L.dragOptions),s(L.dragOptions.gd)},L.onClickInPanFn=function(C){return function(R){var D=M._fullLayout.clickmode;D.indexOf("select")>-1&&l(R.originalEvent,M,[L.xaxis],[L.yaxis],L.id,C),D.indexOf("event")>-1&&i.click(M,R.originalEvent)}}},a.updateFx=function(w){var T=this,L=T.map;if(!T.isStatic){var z=w.dragmode;T.dragOptions=t.extendDeep(T.dragOptions||{},{dragmode:w.dragmode,element:T.div,gd:T.gd,plotinfo:{id:T.id,domain:w[T.id].domain,xaxis:T.xaxis,yaxis:T.yaxis,fillRangeItems:function(R,D){D.isRect?(R.range={})[T.id]=[C([D.xmin,D.ymin]),C([D.xmax,D.ymax])]:(R.lassoPoints={})[T.id]=D.map(C)}},xaxes:[T.xaxis],yaxes:[T.yaxis],subplot:T.id}),L.off("click",T.onClickInPanHandler),m(z)||n(z)?(L.dragPan.disable(),L.on("zoomstart",T.clearOutline),T.dragOptions.prepFn=function(R,D,j){p(R,D,j,T.dragOptions,z)},r.init(T.dragOptions)):(L.dragPan.enable(),L.off("zoomstart",T.clearOutline),T.div.onmousedown=null,T.div.ontouchstart=null,T.div.removeEventListener("touchstart",T.div._ontouchstart),T.onClickInPanHandler=T.onClickInPanFn(T.dragOptions),L.on("click",T.onClickInPanHandler))}function C(R){var D=T.map.unproject(R);return[D.lng,D.lat]}},a.updateFramework=function(w){var T=w[this.id].domain,L=w._size,M=this.div.style;M.width=L.w*(T.x[1]-T.x[0])+"px",M.height=L.h*(T.y[1]-T.y[0])+"px",M.left=L.l+T.x[0]*L.w+"px",M.top=L.t+(1-T.y[1])*L.h+"px",this.xaxis._offset=L.l+T.x[0]*L.w,this.xaxis._length=L.w*(T.x[1]-T.x[0]),this.yaxis._offset=L.t+(1-T.y[1])*L.h,this.yaxis._length=L.h*(T.y[1]-T.y[0])},a.updateLayers=function(w){var T,L=w[this.id].layers,M=this.layerList;if(L.length!==M.length){for(T=0;T<M.length;T++)M[T].dispose();for(M=this.layerList=[],T=0;T<L.length;T++)M.push(d(this,T,L[T]))}else for(T=0;T<L.length;T++)M[T].update(L[T])},a.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},a.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},a.setOptions=function(w,T,L){for(var M in L)this.map[T](w,M,L[M])},a.getMapLayers=function(){return this.map.getStyle().layers},a.addLayer=function(w,T){var L=this.map;if("string"==typeof T){if(""===T)return void L.addLayer(w,T);for(var M=this.getMapLayers(),P=0;P<M.length;P++)if(T===M[P].id)return void L.addLayer(w,T);t.warn(["Trying to add layer with *below* value",T,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}L.addLayer(w)},a.project=function(w){return this.map.project(new g.LngLat(w[0],w[1]))},a.getView=function(){var w=this.map,T=w.getCenter(),L={lon:T.lng,lat:T.lat},M=w.getCanvas(),P=parseInt(M.style.width),z=parseInt(M.style.height);return{center:L,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([P,0]).toArray(),w.unproject([P,z]).toArray(),w.unproject([0,z]).toArray()]}}},a.getViewEdits=function(w){for(var T=this.id,L=["center","zoom","bearing","pitch"],M={},P=0;P<L.length;P++){var z=L[P];M[T+"."+z]=w[z]}return M},a.getViewEditsWithDerived=function(w){var T=this.id,L=this.getViewEdits(w);return L[T+"._derived"]=w._derived,L},Q.exports=u},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(v,Q,$){"use strict";Q.exports=function(g){var t=g.editType;return{t:{valType:"number",dflt:0,editType:t},r:{valType:"number",dflt:0,editType:t},b:{valType:"number",dflt:0,editType:t},l:{valType:"number",dflt:0,editType:t},editType:t}}},{}],628:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-time-format").timeFormatLocale,k=v("d3-format").formatLocale,x=v("fast-isnumeric"),e=v("../registry"),r=v("../plot_api/plot_schema"),i=v("../plot_api/plot_template"),c=v("../lib"),n=v("../components/color"),m=v("../constants/numerical").BADNUM,p=v("./cartesian/axis_ids"),s=v("../components/shapes/handle_outline").clearOutline,f=v("./animation_attributes"),l=v("./frame_attributes"),o=v("../plots/get_data").getModuleCalcData,d=c.relinkPrivateKeys,u=c._,a=Q.exports={};c.extendFlat(a,e),a.attributes=v("./attributes"),a.attributes.type.values=a.allTypes,a.fontAttrs=v("./font_attributes"),a.layoutAttributes=v("./layout_attributes"),a.fontWeight="normal";var y=a.transformsRegistry,h=v("./command");a.executeAPICommand=h.executeAPICommand,a.computeAPICommandBindings=h.computeAPICommandBindings,a.manageCommandObserver=h.manageCommandObserver,a.hasSimpleAPICommandBindings=h.hasSimpleAPICommandBindings,a.redrawText=function(q){return q=c.getGraphDiv(q),new Promise(function(Z){setTimeout(function(){q._fullLayout&&(e.getComponentMethod("annotations","draw")(q),e.getComponentMethod("legend","draw")(q),e.getComponentMethod("colorbar","draw")(q),Z(a.previousPromises(q)))},300)})},a.resize=function(q){var Z;q=c.getGraphDiv(q);var W=new Promise(function(G,X){q&&!c.isHidden(q)||X(new Error("Resize must be passed a displayed plot div element.")),q._redrawTimer&&clearTimeout(q._redrawTimer),q._resolveResize&&(Z=q._resolveResize),q._resolveResize=G,q._redrawTimer=setTimeout(function(){if(!q.layout||q.layout.width&&q.layout.height||c.isHidden(q))G(q);else{delete q.layout.width,delete q.layout.height;var ne=q.changed;q.autoplay=!0,e.call("relayout",q,{autosize:!0}).then(function(){q.changed=ne,q._resolveResize===G&&(delete q._resolveResize,G(q))})}},100)});return Z&&Z(W),W},a.previousPromises=function(q){if((q._promises||[]).length)return Promise.all(q._promises).then(function(){q._promises=[]})},a.addLinks=function(q){if(q._context.showLink||q._context.showSources){var Z=q._fullLayout,W=c.ensureSingle(Z._paper,"text","js-plot-link-container",function(U){U.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:n.defaultLine,"pointer-events":"all"}).each(function(){var ee=g.select(this);ee.append("tspan").classed("js-link-to-tool",!0),ee.append("tspan").classed("js-link-spacer",!0),ee.append("tspan").classed("js-sourcelinks",!0)})}),G=W.node(),X={y:Z._paper.attr("height")-9};document.body.contains(G)&&G.getComputedTextLength()>=Z.width-20?(X["text-anchor"]="start",X.x=5):(X["text-anchor"]="end",X.x=Z._paper.attr("width")-7),W.attr(X);var ne=W.select(".js-link-to-tool"),V=W.select(".js-link-spacer"),N=W.select(".js-sourcelinks");q._context.showSources&&q._context.showSources(q),q._context.showLink&&function(U,ee){ee.text("");var B=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(U._context.linkText+" "+String.fromCharCode(187));if(U._context.sendData)B.on("click",function(){a.sendDataToCloud(U)});else{var K=window.location.pathname.split("/"),J=window.location.search;B.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+K[2].split(".")[0]+"/"+K[1]+J})}}(q,ne),V.text(ne.text()&&N.text()?" - ":"")}},a.sendDataToCloud=function(q){var Z=(window.PLOTLYENV||{}).BASE_URL||q._context.plotlyServerURL;if(Z){q.emit("plotly_beforeexport");var W=g.select(q).append("div").attr("id","hiddenform").style("display","none"),G=W.append("form").attr({action:Z+"/external",method:"post",target:"_blank"});return G.append("input").attr({type:"text",name:"data"}).node().value=a.graphJson(q,!1,"keepdata"),G.node().submit(),W.remove(),q.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],b=["year","month","dayMonth","dayMonthYear"];function w(q,Z){var W=q._context.locale;W||(W="en-US");var G=!1,X={};function ne(K){for(var J=!0,te=0;te<Z.length;te++){var ae=Z[te];X[ae]||(K[ae]?X[ae]=K[ae]:J=!1)}J&&(G=!0)}for(var V=0;V<2;V++){for(var N=q._context.locales,U=0;U<2;U++){var ee=(N[W]||{}).format;if(ee&&(ne(ee),G))break;N=e.localeRegistry}var B=W.split("-")[0];if(G||B===W)break;W=B}return G||ne(e.localeRegistry.en.format),X}function T(q,Z){var W={_fullLayout:Z},G="x"===q._id.charAt(0),X=q._mainAxis._anchorAxis,ne="",V="",N="";if(X&&(N=X._mainAxis._id,ne=G?q._id+N:N+q._id),!ne||!Z._plots[ne]){ne="";for(var U=q._counterAxes,ee=0;ee<U.length;ee++){var B=U[ee],K=G?q._id+B:B+q._id;V||(V=K);var J=p.getFromId(W,B);if(N&&J.overlaying===N){ne=K;break}}}return ne||V}function L(q){var Z=q.transforms;if(Array.isArray(Z)&&Z.length)for(var W=0;W<Z.length;W++){var G=Z[W],X=G._module||y[G.type];if(X&&X.makesData)return!0}return!1}function M(q,Z,W,G){for(var X=q.transforms,ne=[q],V=0;V<X.length;V++){var N=X[V],U=y[N.type];U&&U.transform&&(ne=U.transform(ne,{transform:N,fullTrace:q,fullData:Z,layout:W,fullLayout:G,transformIndex:V}))}return ne}function P(q){return"string"==typeof q&&"px"===q.substr(q.length-2)&&parseFloat(q)}function z(q){var Z=q.margin;if(!q._size){var W=q._size={l:Math.round(Z.l),r:Math.round(Z.r),t:Math.round(Z.t),b:Math.round(Z.b),p:Math.round(Z.pad)};W.w=Math.round(q.width)-W.l-W.r,W.h=Math.round(q.height)-W.t-W.b}q._pushmargin||(q._pushmargin={}),q._pushmarginIds||(q._pushmarginIds={})}a.supplyDefaults=function(q,Z){var Pe,Re,W=Z&&Z.skipUpdateCalc,G=q._fullLayout||{};if(G._skipDefaults)delete G._skipDefaults;else{var X,ne=q._fullLayout={},V=q.layout||{},N=q._fullData||[],U=q._fullData=[],ee=q.data||[],B=q.calcdata||[],K=q._context||{};q._transitionData||a.createTransitionData(q),ne._dfltTitle={plot:u(q,"Click to enter Plot title"),x:u(q,"Click to enter X axis title"),y:u(q,"Click to enter Y axis title"),colorbar:u(q,"Click to enter Colorscale title"),annotation:u(q,"new text")},ne._traceWord=u(q,"trace");var J=w(q,_);if(ne._mapboxAccessToken=K.mapboxAccessToken,G._initialAutoSizeIsDone){var te=G.width,ae=G.height;a.supplyLayoutGlobalDefaults(V,ne,J),V.width||(ne.width=te),V.height||(ne.height=ae),a.sanitizeMargins(ne)}else{a.supplyLayoutGlobalDefaults(V,ne,J);var ce=!V.width||!V.height,oe=ne.autosize;ce&&(oe||K.autosizable)?a.plotAutoSize(q,V,ne):ce&&a.sanitizeMargins(ne),!oe&&ce&&(V.width=ne.width,V.height=ne.height)}ne._d3locale=((Pe=J).decimal=(Re=ne.separators).charAt(0),Pe.thousands=Re.charAt(1),{numberFormat:function(Ge){try{Ge=k(Pe).format(c.adjustFormat(Ge))}catch(tt){return c.warnBadFormat(Ge),c.noFormat}return Ge},timeFormat:t(Pe).utcFormat}),ne._extraFormat=w(q,b),ne._initialAutoSizeIsDone=!0,ne._dataLength=ee.length,ne._modules=[],ne._visibleModules=[],ne._basePlotModules=[];var fe=ne._subplots=function(){var Pe,Re,Ge=e.collectableSubplotTypes,tt={};if(!Ge){Ge=[];var ct=e.subplotsRegistry;for(var wt in ct){var kt=ct[wt].attr;if(kt&&(Ge.push(wt),Array.isArray(kt)))for(Re=0;Re<kt.length;Re++)c.pushUnique(Ge,kt[Re])}}for(Pe=0;Pe<Ge.length;Pe++)tt[Ge[Pe]]=[];return tt}(),xe=ne._splomAxes={x:{},y:{}},Se=ne._splomSubplots={};ne._splomGridDflt={},ne._scatterStackOpts={},ne._firstScatter={},ne._alignmentOpts={},ne._colorAxes={},ne._requestRangeslider={},ne._traceUids=function(Pe,Re){var Ge,tt,ct=Re.length,wt=[];for(Ge=0;Ge<Pe.length;Ge++){var kt=Pe[Ge]._fullInput;kt!==tt&&wt.push(kt),tt=kt}var gt=wt.length,at=new Array(ct),et={};function yt(en,Jt){at[Jt]=en,et[en]=1}function Vt(en,Jt){if(en&&"string"==typeof en&&!et[en])return yt(en,Jt),!0}for(Ge=0;Ge<ct;Ge++){var Gt=Re[Ge].uid;"number"==typeof Gt&&(Gt=String(Gt)),Vt(Gt,Ge)||Ge<gt&&Vt(wt[Ge].uid,Ge)||yt(c.randstr(et),Ge)}return at}(N,ee),ne._globalTransforms=(q._context||{}).globalTransforms,a.supplyDataDefaults(ee,U,V,ne);var pe=Object.keys(xe.x),ge=Object.keys(xe.y);if(pe.length>1&&ge.length>1){for(e.getComponentMethod("grid","sizeDefaults")(V,ne),X=0;X<pe.length;X++)c.pushUnique(fe.xaxis,pe[X]);for(X=0;X<ge.length;X++)c.pushUnique(fe.yaxis,ge[X]);for(var Te in Se)c.pushUnique(fe.cartesian,Te)}if(ne._has=a._hasPlotType.bind(ne),N.length===U.length)for(X=0;X<U.length;X++)d(U[X],N[X]);a.supplyLayoutModuleDefaults(V,ne,U,q._transitionData);var se=ne._visibleModules,de=[];for(X=0;X<se.length;X++){var Ae=se[X].crossTraceDefaults;Ae&&c.pushUnique(de,Ae)}for(X=0;X<de.length;X++)de[X](U,ne);ne._hasOnlyLargeSploms=1===ne._basePlotModules.length&&"splom"===ne._basePlotModules[0].name&&pe.length>15&&ge.length>15&&0===ne.shapes.length&&0===ne.images.length,a.linkSubplots(U,ne,N,G),a.cleanPlot(U,ne,N,G);var Le=!(!G._has||!G._has("gl2d")),Me=!(!ne._has||!ne._has("gl2d")),De=!(!G._has||!G._has("cartesian"))||Le,Oe=!(!ne._has||!ne._has("cartesian"))||Me;De&&!Oe?G._bgLayer.remove():Oe&&!De&&(ne._shouldCreateBgLayer=!0),G._zoomlayer&&!q._dragging&&s({_fullLayout:G}),function(Pe,Re){var Ge,tt=[];Re.meta&&(Ge=Re._meta={meta:Re.meta,layout:{meta:Re.meta}});for(var ct=0;ct<Pe.length;ct++){var wt=Pe[ct];wt.meta?tt[wt.index]=wt._meta={meta:wt.meta}:Re.meta&&(wt._meta={meta:Re.meta}),Re.meta&&(wt._meta.layout={meta:Re.meta})}tt.length&&(Ge||(Ge=Re._meta={}),Ge.data=tt)}(U,ne),d(ne,G),e.getComponentMethod("colorscale","crossTraceDefaults")(U,ne),ne._preGUI||(ne._preGUI={}),ne._tracePreGUI||(ne._tracePreGUI={});var Ie,Qe=ne._tracePreGUI,Ne={};for(Ie in Qe)Ne[Ie]="old";for(X=0;X<U.length;X++)Ne[Ie=U[X]._fullInput.uid]||(Qe[Ie]={}),Ne[Ie]="new";for(Ie in Ne)"old"===Ne[Ie]&&delete Qe[Ie];z(ne),e.getComponentMethod("rangeslider","makeData")(ne),W||B.length!==U.length||a.supplyDefaultsUpdateCalc(B,U)}},a.supplyDefaultsUpdateCalc=function(q,Z){for(var W=0;W<Z.length;W++){var G=Z[W],X=(q[W]||[])[0];if(X&&X.trace){var ne=X.trace;if(ne._hasCalcTransform){var V,N,U,ee=ne._arrayAttrs;for(V=0;V<ee.length;V++)U=c.nestedProperty(ne,N=ee[V]).get().slice(),c.nestedProperty(G,N).set(U)}X.trace=G}}},a.createTransitionData=function(q){q._transitionData||(q._transitionData={}),q._transitionData._frames||(q._transitionData._frames=[]),q._transitionData._frameHash||(q._transitionData._frameHash={}),q._transitionData._counter||(q._transitionData._counter=0),q._transitionData._interruptCallbacks||(q._transitionData._interruptCallbacks=[])},a._hasPlotType=function(q){var Z,W=this._basePlotModules||[];for(Z=0;Z<W.length;Z++)if(W[Z].name===q)return!0;var G=this._modules||[];for(Z=0;Z<G.length;Z++){var X=G[Z].name;if(X===q)return!0;var ne=e.modules[X];if(ne&&ne.categories[q])return!0}return!1},a.cleanPlot=function(q,Z,W,G){var X,ne,V=G._basePlotModules||[];for(X=0;X<V.length;X++){var N=V[X];N.clean&&N.clean(q,Z,W,G)}var U=G._has&&G._has("gl"),ee=Z._has&&Z._has("gl");U&&!ee&&void 0!==G._glcontainer&&(G._glcontainer.selectAll(".gl-canvas").remove(),G._glcontainer.selectAll(".no-webgl").remove(),G._glcanvas=null);var B=!!G._infolayer;e:for(X=0;X<W.length;X++){var K=W[X].uid;for(ne=0;ne<q.length;ne++)if(K===q[ne].uid)continue e;B&&G._infolayer.select(".cb"+K).remove()}},a.linkSubplots=function(q,Z,W,G){var X,ne,V=G._plots||{},N=Z._plots={},U=Z._subplots,ee={_fullData:q,_fullLayout:Z},B=U.cartesian.concat(U.gl2d||[]);for(X=0;X<B.length;X++){var K,J=B[X],te=V[J],ae=p.getFromId(ee,J,"x"),ce=p.getFromId(ee,J,"y");for(te?K=N[J]=te:(K=N[J]={}).id=J,ae._counterAxes.push(ce._id),ce._counterAxes.push(ae._id),ae._subplotsWith.push(J),ce._subplotsWith.push(J),K.xaxis=ae,K.yaxis=ce,K._hasClipOnAxisFalse=!1,ne=0;ne<q.length;ne++){var oe=q[ne];if(oe.xaxis===K.xaxis._id&&oe.yaxis===K.yaxis._id&&!1===oe.cliponaxis){K._hasClipOnAxisFalse=!0;break}}}var ve,fe=p.list(ee,null,!0);for(X=0;X<fe.length;X++){var xe=null;(ve=fe[X]).overlaying&&(xe=p.getFromId(ee,ve.overlaying))&&xe.overlaying&&(ve.overlaying=!1,xe=null),ve._mainAxis=xe||ve,xe&&(ve.domain=xe.domain.slice()),ve._anchorAxis="free"===ve.anchor?null:p.getFromId(ee,ve.anchor)}for(X=0;X<fe.length;X++)if((ve=fe[X])._counterAxes.sort(p.idSort),ve._subplotsWith.sort(c.subplotSort),ve._mainSubplot=T(ve,Z),ve._counterAxes.length&&(ve.spikemode&&-1!==ve.spikemode.indexOf("across")||ve.automargin&&ve.mirror&&"free"!==ve.anchor||e.getComponentMethod("rangeslider","isVisible")(ve))){var Se=1,pe=0;for(ne=0;ne<ve._counterAxes.length;ne++){var ge=p.getFromId(ee,ve._counterAxes[ne]);Se=Math.min(Se,ge.domain[0]),pe=Math.max(pe,ge.domain[1])}Se<pe&&(ve._counterDomainMin=Se,ve._counterDomainMax=pe)}},a.clearExpandedTraceDefaultColors=function(q){var Z,W,G;for(W=[],(Z=q._module._colorAttrs)||(q._module._colorAttrs=Z=[],r.crawl(q._module.attributes,function(X,ne,V,N){W[N]=ne,W.length=N+1,"color"===X.valType&&void 0===X.dflt&&Z.push(W.join("."))})),G=0;G<Z.length;G++)c.nestedProperty(q,"_input."+Z[G]).get()||c.nestedProperty(q,Z[G]).set(null)},a.supplyDataDefaults=function(q,Z,W,G){var X,ne,V,N=G._modules,U=G._visibleModules,ee=G._basePlotModules,B=0,K=0;function J(Te){Z.push(Te);var se=Te._module;se&&(c.pushUnique(N,se),!0===Te.visible&&c.pushUnique(U,se),c.pushUnique(ee,Te._module.basePlotModule),B++,!1!==Te._input.visible&&K++)}G._transformModules=[];var te={},ae=[],oe=i.traceTemplater((W.template||{}).data||{});for(X=0;X<q.length;X++){if((ne=oe.newTrace(V=q[X])).uid=G._traceUids[X],a.supplyTraceDefaults(V,ne,K,G,X),ne.index=X,ne._input=V,ne._expandedIndex=B,ne.transforms&&ne.transforms.length)for(var ve=!1!==V.visible&&!1===ne.visible,fe=M(ne,Z,W,G),xe=0;xe<fe.length;xe++){var Se=fe[xe],pe={_template:ne._template,type:ne.type,uid:ne.uid+xe};ve&&!1===Se.visible&&delete Se.visible,a.supplyTraceDefaults(Se,pe,B,G,X),d(pe,Se),pe.index=X,pe._input=V,pe._fullInput=ne,pe._expandedIndex=B,pe._expandedInput=Se,J(pe)}else ne._fullInput=ne,ne._expandedInput=ne,J(ne);e.traceIs(ne,"carpetAxis")&&(te[ne.carpet]=ne),e.traceIs(ne,"carpetDependent")&&ae.push(X)}for(X=0;X<ae.length;X++)if((ne=Z[ae[X]]).visible){var ge=te[ne.carpet];ne._carpet=ge,ge&&ge.visible?(ne.xaxis=ge.xaxis,ne.yaxis=ge.yaxis):ne.visible=!1}},a.supplyAnimationDefaults=function(q){var Z;q=q||{};var W={};function G(X,ne){return c.coerce(q||{},W,f,X,ne)}if(G("mode"),G("direction"),G("fromcurrent"),Array.isArray(q.frame))for(W.frame=[],Z=0;Z<q.frame.length;Z++)W.frame[Z]=a.supplyAnimationFrameDefaults(q.frame[Z]||{});else W.frame=a.supplyAnimationFrameDefaults(q.frame||{});if(Array.isArray(q.transition))for(W.transition=[],Z=0;Z<q.transition.length;Z++)W.transition[Z]=a.supplyAnimationTransitionDefaults(q.transition[Z]||{});else W.transition=a.supplyAnimationTransitionDefaults(q.transition||{});return W},a.supplyAnimationFrameDefaults=function(q){var Z={};function W(G,X){return c.coerce(q||{},Z,f.frame,G,X)}return W("duration"),W("redraw"),Z},a.supplyAnimationTransitionDefaults=function(q){var Z={};function W(G,X){return c.coerce(q||{},Z,f.transition,G,X)}return W("duration"),W("easing"),Z},a.supplyFrameDefaults=function(q){var Z={};function W(G,X){return c.coerce(q,Z,l,G,X)}return W("group"),W("name"),W("traces"),W("baseframe"),W("data"),W("layout"),Z},a.supplyTraceDefaults=function(q,Z,W,G,X){var ne,V=G.colorway||n.defaults,N=V[W%V.length];function U(fe,xe){return c.coerce(q,Z,a.attributes,fe,xe)}var ee=U("visible");U("type"),U("name",G._traceWord+" "+X),U("uirevision",G.uirevision);var B=a.getModule(Z);if(Z._module=B,B){var K=B.basePlotModule,J=K.attr,te=K.attributes;if(J&&te){var ae=G._subplots,ce="";if(ee||"gl2d"!==K.name){if(Array.isArray(J))for(ne=0;ne<J.length;ne++){var oe=J[ne],ve=c.coerce(q,Z,te,oe);ae[oe]&&c.pushUnique(ae[oe],ve),ce+=ve}else ce=c.coerce(q,Z,te,J);ae[K.name]&&c.pushUnique(ae[K.name],ce)}}}return ee&&(U("customdata"),U("ids"),U("meta"),e.traceIs(Z,"showLegend")?(c.coerce(q,Z,B.attributes.showlegend?B.attributes:a.attributes,"showlegend"),U("legendwidth"),U("legendgroup"),U("legendgrouptitle.text"),U("legendrank"),Z._dfltShowLegend=!0):Z._dfltShowLegend=!1,B&&B.supplyDefaults(q,Z,N,G),e.traceIs(Z,"noOpacity")||U("opacity"),e.traceIs(Z,"notLegendIsolatable")&&(Z.visible=!!Z.visible),e.traceIs(Z,"noHover")||(Z.hovertemplate||c.coerceHoverinfo(q,Z,G),"parcats"!==Z.type&&e.getComponentMethod("fx","supplyDefaults")(q,Z,N,G)),B&&B.selectPoints&&U("selectedpoints"),a.supplyTransformDefaults(q,Z,G)),Z},a.hasMakesDataTransform=L,a.supplyTransformDefaults=function(q,Z,W){if(Z._length||L(q)){var G=W._globalTransforms||[],X=W._transformModules||[];if(Array.isArray(q.transforms)||0!==G.length)for(var V=G.concat(q.transforms||[]),N=Z.transforms=[],U=0;U<V.length;U++){var ee,B=V[U],K=B.type,J=y[K],te=!(B._module&&B._module===J),ae=J&&"function"==typeof J.transform;J||c.warn("Unrecognized transform type "+K+"."),J&&J.supplyDefaults&&(te||ae)?((ee=J.supplyDefaults(B,Z,W,q)).type=K,ee._module=J,c.pushUnique(X,J)):ee=c.extendFlat({},B),N.push(ee)}}},a.supplyLayoutGlobalDefaults=function(q,Z,W){function G(U,ee){return c.coerce(q,Z,a.layoutAttributes,U,ee)}var X=q.template;c.isPlainObject(X)&&(Z.template=X,Z._template=X.layout,Z._dataTemplate=X.data),G("autotypenumbers");var ne=c.coerceFont(G,"font");c.coerceFont(G,"title.font",c.extendFlat({},ne,{size:Math.round(1.4*ne.size)})),G("title.text",Z._dfltTitle.plot),G("title.xref"),G("title.yref"),G("title.x"),G("title.y"),G("title.xanchor"),G("title.yanchor"),G("title.pad.t"),G("title.pad.r"),G("title.pad.b"),G("title.pad.l"),G("uniformtext.mode")&&G("uniformtext.minsize"),G("autosize",!(q.width&&q.height)),G("width"),G("height"),G("minreducedwidth"),G("minreducedheight"),G("margin.l"),G("margin.r"),G("margin.t"),G("margin.b"),G("margin.pad"),G("margin.autoexpand"),q.width&&q.height&&a.sanitizeMargins(Z),e.getComponentMethod("grid","sizeDefaults")(q,Z),G("paper_bgcolor"),G("separators",W.decimal+W.thousands),G("hidesources"),G("colorway"),G("datarevision");var N=G("uirevision");G("editrevision",N),G("selectionrevision",N),e.getComponentMethod("modebar","supplyLayoutDefaults")(q,Z),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(q,Z,G),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(q,Z,G),G("meta"),c.isPlainObject(q.transition)&&(G("transition.duration"),G("transition.easing"),G("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(q,Z,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(q,Z,G)},a.plotAutoSize=function(q,Z,W){var G,X,ne=q._context||{},V=ne.frameMargins,N=c.isPlotDiv(q);if(N&&q.emit("plotly_autosize"),ne.fillFrame)G=window.innerWidth,X=window.innerHeight,document.body.style.overflow="hidden";else{var U=N?window.getComputedStyle(q):{};if(G=P(U.width)||P(U.maxWidth)||W.width,X=P(U.height)||P(U.maxHeight)||W.height,x(V)&&V>0){var ee=1-2*V;G=Math.round(ee*G),X=Math.round(ee*X)}}var B=a.layoutAttributes.width.min,K=a.layoutAttributes.height.min;G<B&&(G=B),X<K&&(X=K);var J=!Z.width&&Math.abs(W.width-G)>1,te=!Z.height&&Math.abs(W.height-X)>1;(te||J)&&(J&&(W.width=G),te&&(W.height=X)),q._initialAutoSize||(q._initialAutoSize={width:G,height:X}),a.sanitizeMargins(W)},a.supplyLayoutModuleDefaults=function(q,Z,W,G){var X,ne,V,N=e.componentsRegistry,U=Z._basePlotModules,ee=e.subplotsRegistry.cartesian;for(X in N)(V=N[X]).includeBasePlot&&V.includeBasePlot(q,Z);for(var B in U.length||U.push(ee),Z._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(q,Z),ee.finalizeSubplots(q,Z)),Z._subplots)Z._subplots[B].sort(c.subplotSort);for(ne=0;ne<U.length;ne++)(V=U[ne]).supplyLayoutDefaults&&V.supplyLayoutDefaults(q,Z,W);var K=Z._modules;for(ne=0;ne<K.length;ne++)(V=K[ne]).supplyLayoutDefaults&&V.supplyLayoutDefaults(q,Z,W);var J=Z._transformModules;for(ne=0;ne<J.length;ne++)(V=J[ne]).supplyLayoutDefaults&&V.supplyLayoutDefaults(q,Z,W,G);for(X in N)(V=N[X]).supplyLayoutDefaults&&V.supplyLayoutDefaults(q,Z,W)},a.purge=function(q){var Z=q._fullLayout||{};void 0!==Z._glcontainer&&(Z._glcontainer.selectAll(".gl-canvas").remove(),Z._glcontainer.remove(),Z._glcanvas=null),Z._modeBar&&Z._modeBar.destroy(),q._transitionData&&(q._transitionData._interruptCallbacks&&(q._transitionData._interruptCallbacks.length=0),q._transitionData._animationRaf&&window.cancelAnimationFrame(q._transitionData._animationRaf)),c.clearThrottle(),c.clearResponsive(q),delete q.data,delete q.layout,delete q._fullData,delete q._fullLayout,delete q.calcdata,delete q.empty,delete q.fid,delete q.undoqueue,delete q.undonum,delete q.autoplay,delete q.changed,delete q._promises,delete q._redrawTimer,delete q._hmlumcount,delete q._hmpixcount,delete q._transitionData,delete q._transitioning,delete q._initialAutoSize,delete q._transitioningWithDuration,delete q._dragging,delete q._dragged,delete q._dragdata,delete q._hoverdata,delete q._snapshotInProgress,delete q._editing,delete q._mouseDownTime,delete q._legendMouseDownTime,q.removeAllListeners&&q.removeAllListeners()},a.style=function(q){var Z,W=q._fullLayout._visibleModules,G=[];for(Z=0;Z<W.length;Z++){var X=W[Z];X.style&&c.pushUnique(G,X.style)}for(Z=0;Z<G.length;Z++)G[Z](q)},a.sanitizeMargins=function(q){if(q&&q.margin){var Z,W=q.width,G=q.height,X=q.margin,V=G-(X.t+X.b);W-(X.l+X.r)<0&&(Z=(W-1)/(X.l+X.r),X.l=Math.floor(Z*X.l),X.r=Math.floor(Z*X.r)),V<0&&(Z=(G-1)/(X.t+X.b),X.t=Math.floor(Z*X.t),X.b=Math.floor(Z*X.b))}},a.clearAutoMarginIds=function(q){q._fullLayout._pushmarginIds={}},a.allowAutoMargin=function(q,Z){q._fullLayout._pushmarginIds[Z]=1},a.autoMargin=function(q,Z,W){var G=q._fullLayout,X=G.width,ne=G.height,V=G.margin,U=G.minreducedheight,ee=c.constrain(X-V.l-V.r,2,G.minreducedwidth),B=c.constrain(ne-V.t-V.b,2,U),K=Math.max(0,X-ee),J=Math.max(0,ne-B),te=G._pushmargin,ae=G._pushmarginIds;if(!1!==V.autoexpand){if(W){var ce=W.pad;if(void 0===ce&&(ce=Math.min(12,V.l,V.r,V.t,V.b)),K){var oe=(W.l+W.r)/K;oe>1&&(W.l/=oe,W.r/=oe)}if(J){var ve=(W.t+W.b)/J;ve>1&&(W.t/=ve,W.b/=ve)}te[Z]={l:{val:void 0!==W.xl?W.xl:W.x,size:W.l+ce},r:{val:void 0!==W.xr?W.xr:W.x,size:W.r+ce},b:{val:void 0!==W.yb?W.yb:W.y,size:W.b+ce},t:{val:void 0!==W.yt?W.yt:W.y,size:W.t+ce}},ae[Z]=1}else delete te[Z],delete ae[Z];if(!G._replotting)return a.doAutoMargin(q)}},a.doAutoMargin=function(q){var Z=q._fullLayout,W=Z.width,G=Z.height;Z._size||(Z._size={}),z(Z);var X=Z._size,ne=Z.margin,V=c.extendFlat({},X),N=ne.l,U=ne.r,ee=ne.t,B=ne.b,K=Z._pushmargin,J=Z._pushmarginIds,te=Z.minreducedwidth,ae=Z.minreducedheight;if(!1!==Z.margin.autoexpand){for(var ce in K)J[ce]||delete K[ce];for(var oe in K.base={l:{val:0,size:N},r:{val:1,size:U},t:{val:1,size:ee},b:{val:0,size:B}},K){var ve=K[oe].l||{},fe=K[oe].b||{},xe=ve.val,Se=ve.size,pe=fe.val,ge=fe.size;for(var Te in K){if(x(Se)&&K[Te].r){var se=K[Te].r.val,de=K[Te].r.size;if(se>xe){var Ae=(Se*se+(de-W)*xe)/(se-xe),Le=(de*(1-xe)+(Se-W)*(1-se))/(se-xe);Ae+Le>N+U&&(N=Ae,U=Le)}}if(x(ge)&&K[Te].t){var Me=K[Te].t.val,De=K[Te].t.size;if(Me>pe){var Oe=(ge*Me+(De-G)*pe)/(Me-pe),Ie=(De*(1-pe)+(ge-G)*(1-Me))/(Me-pe);Oe+Ie>B+ee&&(B=Oe,ee=Ie)}}}}}var kt,Qe=c.constrain(W-ne.l-ne.r,2,te),Ne=c.constrain(G-ne.t-ne.b,2,ae),Pe=Math.max(0,W-Qe),Re=Math.max(0,G-Ne);if(Pe){var Ge=(N+U)/Pe;Ge>1&&(N/=Ge,U/=Ge)}if(Re){var tt=(B+ee)/Re;tt>1&&(B/=tt,ee/=tt)}if(X.l=Math.round(N),X.r=Math.round(U),X.t=Math.round(ee),X.b=Math.round(B),X.p=Math.round(ne.pad),X.w=Math.round(W)-X.l-X.r,X.h=Math.round(G)-X.t-X.b,!Z._replotting&&a.didMarginChange(V,X)){"_redrawFromAutoMarginCount"in Z?Z._redrawFromAutoMarginCount++:Z._redrawFromAutoMarginCount=1;var ct=3*(1+Object.keys(J).length);if(Z._redrawFromAutoMarginCount<ct)return e.call("_doPlot",q);Z._size=V,c.warn("Too many auto-margin redraws.")}kt=p.list(q,"",!0),["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(gt){for(var at=0;at<kt.length;at++){var et=kt[at][gt];et&&et()}})};var S=["l","r","t","b","p","w","h"];function C(q,Z,W){var G=!1,ne=c.syncOrAsync([a.previousPromises,function(){if(q._transitionData)return q._transitioning=!1,function(V){var N=Promise.resolve();if(!V)return N;for(;V.length;)N=N.then(V.shift());return N}(q._transitionData._interruptCallbacks)},W.prepareFn,a.rehover,a.reselect,function(){return q.emit("plotly_transitioning",[]),new Promise(function(V){q._transitioning=!0,Z.duration>0&&(q._transitioningWithDuration=!0),q._transitionData._interruptCallbacks.push(function(){G=!0}),W.redraw&&q._transitionData._interruptCallbacks.push(function(){return e.call("redraw",q)}),q._transitionData._interruptCallbacks.push(function(){q.emit("plotly_transitioninterrupted",[])});var N=0,U=0;function ee(){return N++,function(){var B;U++,G||U!==N||(B=V,!q._transitionData||(function(K){if(K)for(;K.length;)K.shift()}(q._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(W.redraw)return e.call("redraw",q)}).then(function(){q._transitioning=!1,q._transitioningWithDuration=!1,q.emit("plotly_transitioned",[])}).then(B)))}}W.runFn(ee),setTimeout(ee())})}],q);return ne&&ne.then||(ne=Promise.resolve()),ne.then(function(){return q})}a.didMarginChange=function(q,Z){for(var W=0;W<S.length;W++){var G=S[W],X=q[G],ne=Z[G];if(!x(X)||Math.abs(ne-X)>1)return!0}return!1},a.graphJson=function(q,Z,W,G,X,ne){(X&&Z&&!q._fullData||X&&!Z&&!q._fullLayout)&&a.supplyDefaults(q);var N=X?q._fullLayout:q.layout,U=(q._transitionData||{})._frames;function ee(J,te){if("function"==typeof J)return te?"_function_":null;if(c.isPlainObject(J)){var ae,ce={};return Object.keys(J).sort().forEach(function(oe){if(-1===["_","["].indexOf(oe.charAt(0)))if("function"!=typeof J[oe]){if("keepdata"===W){if("src"===oe.substr(oe.length-3))return}else if("keepstream"===W){if("string"==typeof(ae=J[oe+"src"])&&ae.indexOf(":")>0&&!c.isPlainObject(J.stream))return}else if("keepall"!==W&&"string"==typeof(ae=J[oe+"src"])&&ae.indexOf(":")>0)return;ce[oe]=ee(J[oe],te)}else te&&(ce[oe]="_function")}),ce}return Array.isArray(J)?J.map(function(oe){return ee(oe,te)}):c.isTypedArray(J)?c.simpleMap(J,c.identity):c.isJSDate(J)?c.ms2DateTimeLocal(+J):J}var B={data:((X?q._fullData:q.data)||[]).map(function(J){var te=ee(J);return Z&&delete te.fit,te})};if(!Z&&(B.layout=ee(N),X)){var K=N._size;B.layout.computed={margin:{b:K.b,l:K.l,r:K.r,t:K.t}}}return U&&(B.frames=ee(U)),ne&&(B.config=ee(q._context,!0)),"object"===G?B:JSON.stringify(B)},a.modifyFrames=function(q,Z){var W,G,X,ne=q._transitionData._frames,V=q._transitionData._frameHash;for(W=0;W<Z.length;W++)switch((G=Z[W]).type){case"replace":var N=(ne[G.index]||{}).name,U=(X=G.value).name;ne[G.index]=V[U]=X,U!==N&&(delete V[N],V[U]=X);break;case"insert":V[(X=G.value).name]=X,ne.splice(G.index,0,X);break;case"delete":delete V[(X=ne[G.index]).name],ne.splice(G.index,1)}return Promise.resolve()},a.computeFrame=function(q,Z){var W,G,X,ne,V=q._transitionData._frameHash;if(!Z)throw new Error("computeFrame must be given a string frame name");var N=V[Z.toString()];if(!N)return!1;for(var U=[N],ee=[N.name];N.baseframe&&(N=V[N.baseframe.toString()])&&-1===ee.indexOf(N.name);)U.push(N),ee.push(N.name);for(var B={};N=U.pop();)if(N.layout&&(B.layout=a.extendLayout(B.layout,N.layout)),N.data){if(B.data||(B.data=[]),!(G=N.traces))for(G=[],W=0;W<N.data.length;W++)G[W]=W;for(B.traces||(B.traces=[]),W=0;W<N.data.length;W++)null!=(X=G[W])&&(-1===(ne=B.traces.indexOf(X))&&(B.traces[ne=B.data.length]=X),B.data[ne]=a.extendTrace(B.data[ne],N.data[W]))}return B},a.recomputeFrameHash=function(q){for(var Z=q._transitionData._frameHash={},W=q._transitionData._frames,G=0;G<W.length;G++){var X=W[G];X&&X.name&&(Z[X.name]=X)}},a.extendObjectWithContainers=function(q,Z,W){var G,X,ne,V,N,U,ee,B=c.extendDeepNoArrays({},Z||{}),K=c.expandObjectPaths(B),J={};if(W&&W.length)for(ne=0;ne<W.length;ne++)void 0===(X=(G=c.nestedProperty(K,W[ne])).get())?c.nestedProperty(J,W[ne]).set(null):(G.set(null),c.nestedProperty(J,W[ne]).set(X));if(q=c.extendDeepNoArrays(q||{},K),W&&W.length)for(ne=0;ne<W.length;ne++)if(U=c.nestedProperty(J,W[ne]).get()){for(ee=(N=c.nestedProperty(q,W[ne])).get(),Array.isArray(ee)||N.set(ee=[]),V=0;V<U.length;V++){var te=U[V];ee[V]=null===te?null:a.extendObjectWithContainers(ee[V],te)}N.set(ee)}return q},a.dataArrayContainers=["transforms","dimensions"],a.layoutArrayContainers=e.layoutArrayContainers,a.extendTrace=function(q,Z){return a.extendObjectWithContainers(q,Z,a.dataArrayContainers)},a.extendLayout=function(q,Z){return a.extendObjectWithContainers(q,Z,a.layoutArrayContainers)},a.transition=function(q,Z,W,G,X,ne){var V={redraw:X.redraw},N={},U=[];return V.prepareFn=function(){for(var ee=Array.isArray(Z)?Z.length:0,B=G.slice(0,ee),K=0;K<B.length;K++){var J=B[K],te=q._fullData[J]._module;if(te){if(te.animatable){var ae=te.basePlotModule.name;N[ae]||(N[ae]=[]),N[ae].push(J)}q.data[B[K]]=a.extendTrace(q.data[B[K]],Z[K])}}var ce=c.expandObjectPaths(c.extendDeepNoArrays({},W)),oe=/^[xy]axis[0-9]*$/;for(var ve in ce)oe.test(ve)&&delete ce[ve].range;a.extendLayout(q.layout,ce),delete q.calcdata,a.supplyDefaults(q),a.doCalcdata(q);var fe=c.expandObjectPaths(W);if(fe){var xe=q._fullLayout._plots;for(var Se in xe){var pe=xe[Se],ge=pe.xaxis,Te=pe.yaxis,se=ge.range.slice(),de=Te.range.slice(),Ae=null,Le=null,Me=null,De=null;Array.isArray(fe[ge._name+".range"])?Ae=fe[ge._name+".range"].slice():Array.isArray((fe[ge._name]||{}).range)&&(Ae=fe[ge._name].range.slice()),Array.isArray(fe[Te._name+".range"])?Le=fe[Te._name+".range"].slice():Array.isArray((fe[Te._name]||{}).range)&&(Le=fe[Te._name].range.slice()),se&&Ae&&(ge.r2l(se[0])!==ge.r2l(Ae[0])||ge.r2l(se[1])!==ge.r2l(Ae[1]))&&(Me={xr0:se,xr1:Ae}),de&&Le&&(Te.r2l(de[0])!==Te.r2l(Le[0])||Te.r2l(de[1])!==Te.r2l(Le[1]))&&(De={yr0:de,yr1:Le}),(Me||De)&&U.push(c.extendFlat({plotinfo:pe},Me,De))}}return Promise.resolve()},V.runFn=function(ee){var B,K,J=q._fullLayout._basePlotModules,te=U.length;if(W)for(K=0;K<J.length;K++)J[K].transitionAxes&&J[K].transitionAxes(q,U,ne,ee);for(var ae in te?((B=c.extendFlat({},ne)).duration=0,delete N.cartesian):B=ne,N){var ce=N[ae];q._fullData[ce[0]]._module.basePlotModule.plot(q,ce,B,ee)}},C(q,ne,V)},a.transitionFromReact=function(q,Z,W,G){var X=q._fullLayout,ne=X.transition,V={},N=[];return V.prepareFn=function(){var U=X._plots;for(var ee in V.redraw=!1,"some"===Z.anim&&(V.redraw=!0),"some"===W.anim&&(V.redraw=!0),U){var B=U[ee],K=B.xaxis,J=B.yaxis,te=G[K._name].range.slice(),ae=G[J._name].range.slice(),ce=K.range.slice(),oe=J.range.slice();K.setScale(),J.setScale();var ve=null,fe=null;K.r2l(te[0])===K.r2l(ce[0])&&K.r2l(te[1])===K.r2l(ce[1])||(ve={xr0:te,xr1:ce}),J.r2l(ae[0])===J.r2l(oe[0])&&J.r2l(ae[1])===J.r2l(oe[1])||(fe={yr0:ae,yr1:oe}),(ve||fe)&&N.push(c.extendFlat({plotinfo:B},ve,fe))}return Promise.resolve()},V.runFn=function(U){for(var ee,B,K,J=q._fullData,te=q._fullLayout._basePlotModules,ae=[],ce=0;ce<J.length;ce++)ae.push(ce);function oe(){if(q._fullLayout)for(var fe=0;fe<te.length;fe++)te[fe].transitionAxes&&te[fe].transitionAxes(q,N,ee,U)}function ve(){if(q._fullLayout)for(var fe=0;fe<te.length;fe++)te[fe].plot(q,K,B,U)}N.length&&Z.anim?"traces first"===ne.ordering?(ee=c.extendFlat({},ne,{duration:0}),K=ae,B=ne,setTimeout(oe,ne.duration),ve()):(ee=ne,K=null,B=c.extendFlat({},ne,{duration:0}),setTimeout(ve,ee.duration),oe()):N.length?(ee=ne,oe()):Z.anim&&(K=ae,B=ne,ve())},C(q,ne,V)},a.doCalcdata=function(q,Z){var W,G,X,ne,V=p.list(q),N=q._fullData,U=q._fullLayout,ee=new Array(N.length),B=(q.calcdata||[]).slice();for(q.calcdata=ee,U._numBoxes=0,U._numViolins=0,U._violinScaleGroupStats={},q._hmpixcount=0,q._hmlumcount=0,U._piecolormap={},U._sunburstcolormap={},U._treemapcolormap={},U._iciclecolormap={},U._funnelareacolormap={},X=0;X<N.length;X++)Array.isArray(Z)&&-1===Z.indexOf(X)&&(ee[X]=B[X]);for(X=0;X<N.length;X++)(W=N[X])._arrayAttrs=r.findArrayAttributes(W),W._extremes={};var K=U._subplots.polar||[];for(X=0;X<K.length;X++)V.push(U[K[X]].radialaxis,U[K[X]].angularaxis);for(var J in U._colorAxes){var te=U[J];!1!==te.cauto&&(delete te.cmin,delete te.cmax)}var ae=!1;function ce(fe){if(G=(W=N[fe])._module,!0===W.visible&&W.transforms){if(G&&G.calc){var xe=G.calc(q,W);xe[0]&&xe[0].t&&xe[0].t._scene&&delete xe[0].t._scene.dirty}for(ne=0;ne<W.transforms.length;ne++){var Se=W.transforms[ne];(G=y[Se.type])&&G.calcTransform&&(W._hasCalcTransform=!0,ae=!0,G.calcTransform(q,W,Se))}}}function oe(fe,xe){if(!!(G=(W=N[fe])._module).isContainer===xe){var Se=[];if(!0===W.visible&&0!==W._length){delete W._indexToPoints;var pe=W.transforms||[];for(ne=pe.length-1;ne>=0;ne--)if(pe[ne].enabled){W._indexToPoints=pe[ne]._indexToPoints;break}G&&G.calc&&(Se=G.calc(q,W))}Array.isArray(Se)&&Se[0]||(Se=[{x:m,y:m}]),Se[0].t||(Se[0].t={}),Se[0].trace=W,ee[fe]=Se}}for(D(V,N,U),X=0;X<N.length;X++)oe(X,!0);for(X=0;X<N.length;X++)ce(X);for(ae&&D(V,N,U),X=0;X<N.length;X++)oe(X,!0);for(X=0;X<N.length;X++)oe(X,!1);j(q);var ve=function(fe,xe){var Se,pe,ge,Te,se,de=[];function Ae(Rt,je,Ye){var he=je._id.charAt(0);if("histogram2dcontour"===Rt){var be=je._counterAxes[0],Fe=p.getFromId(xe,be),He="x"===he||"x"===be&&"category"===Fe.type,Ke="y"===he||"y"===be&&"category"===Fe.type;return function(Ze,ut){return 0===Ze||0===ut||He&&Ze===Ye[ut].length-1||Ke&&ut===Ye.length-1?-1:("y"===he?ut:Ze)-1}}return function(Ze,ut){return"y"===he?ut:Ze}}var Le={min:function(Rt){return c.aggNums(Math.min,null,Rt)},max:function(Rt){return c.aggNums(Math.max,null,Rt)},sum:function(Rt){return c.aggNums(function(je,Ye){return je+Ye},null,Rt)},total:function(Rt){return c.aggNums(function(je,Ye){return je+Ye},null,Rt)},mean:function(Rt){return c.mean(Rt)},median:function(Rt){return c.median(Rt)}};for(Se=0;Se<fe.length;Se++){var Me=fe[Se];if("category"===Me.type){var De=Me.categoryorder.match(R);if(De){var Oe=De[1],Ie=De[2],Qe=Me._id.charAt(0),Ne="x"===Qe,Pe=[];for(pe=0;pe<Me._categories.length;pe++)Pe.push([Me._categories[pe],[]]);for(pe=0;pe<Me._traceIndices.length;pe++){var Re=Me._traceIndices[pe],Ge=xe._fullData[Re];if(!0===Ge.visible){var tt=Ge.type;e.traceIs(Ge,"histogram")&&(delete Ge._xautoBinFinished,delete Ge._yautoBinFinished);var ct="splom"===tt,wt="scattergl"===tt,kt=xe.calcdata[Re];for(ge=0;ge<kt.length;ge++){var gt,at,et=kt[ge];if(ct){var yt=Ge._axesDim[Me._id];if(!Ne){var Vt=Ge._diag[yt][0];Vt&&(Me=xe._fullLayout[p.id2name(Vt)])}var Gt=et.trace.dimensions[yt].values;for(Te=0;Te<Gt.length;Te++)for(gt=Me._categoriesMap[Gt[Te]],se=0;se<et.trace.dimensions.length;se++)se!==yt&&Pe[gt][1].push(et.trace.dimensions[se].values[Te])}else if(wt){for(Te=0;Te<et.t.x.length;Te++)Ne?(gt=et.t.x[Te],at=et.t.y[Te]):(gt=et.t.y[Te],at=et.t.x[Te]),Pe[gt][1].push(at);et.t&&et.t._scene&&delete et.t._scene.dirty}else if(et.hasOwnProperty("z")){var Jt=Ae(Ge.type,Me,at=et.z);for(Te=0;Te<at.length;Te++)for(se=0;se<at[Te].length;se++)(gt=Jt(se,Te))+1&&Pe[gt][1].push(at[Te][se])}else for(void 0===(gt=et.p)&&(gt=et[Qe]),void 0===(at=et.s)&&(at=et.v),void 0===at&&(at=Ne?et.y:et.x),Array.isArray(at)||(at=void 0===at?[]:[at]),Te=0;Te<at.length;Te++)Pe[gt][1].push(at[Te])}}}Me._categoriesValue=Pe;var cn=[];for(pe=0;pe<Pe.length;pe++)cn.push([Pe[pe][0],Le[Oe](Pe[pe][1])]);cn.sort(function(Rt,je){return Rt[1]-je[1]}),Me._categoriesAggregatedValue=cn,Me._initialCategories=cn.map(function(Rt){return Rt[0]}),"descending"===Ie&&Me._initialCategories.reverse(),de=de.concat(Me.sortByInitialCategories())}}}return de}(V,q);if(ve.length){for(U._numBoxes=0,U._numViolins=0,X=0;X<ve.length;X++)oe(ve[X],!0);for(X=0;X<ve.length;X++)oe(ve[X],!1);j(q)}e.getComponentMethod("fx","calc")(q),e.getComponentMethod("errorbars","calc")(q)};var R=/(total|sum|min|max|mean|median) (ascending|descending)/;function D(q,Z,W){var G={};function X(U){U.clearCalc(),"multicategory"===U.type&&U.setupMultiCategory(Z),G[U._id]=1}c.simpleMap(q,X);for(var ne=W._axisMatchGroups||[],V=0;V<ne.length;V++)for(var N in ne[V])G[N]||X(W[p.id2name(N)])}function j(q){var Z,W,G,X=q._fullLayout,ne=X._visibleModules,V={};for(W=0;W<ne.length;W++){var N=ne[W],U=N.crossTraceCalc;if(U){var ee=N.basePlotModule.name;V[ee]?c.pushUnique(V[ee],U):V[ee]=[U]}}for(G in V){var B=V[G],K=X._subplots[G];if(Array.isArray(K))for(Z=0;Z<K.length;Z++){var J=K[Z],te="cartesian"===G?X._plots[J]:X[J];for(W=0;W<B.length;W++)B[W](q,te,J)}else for(W=0;W<B.length;W++)B[W](q)}}a.rehover=function(q){q._fullLayout._rehover&&q._fullLayout._rehover()},a.redrag=function(q){q._fullLayout._redrag&&q._fullLayout._redrag()},a.reselect=function(q){var Z=q._fullLayout,W=(q.layout||{}).selections,G=Z._previousSelections;Z._previousSelections=W;var X=Z._reselect||JSON.stringify(W)!==JSON.stringify(G);e.getComponentMethod("selections","reselect")(q,X)},a.generalUpdatePerTraceModule=function(q,Z,W,G){var X,ne=Z.traceHash,V={};for(X=0;X<W.length;X++){var N=W[X],U=N[0].trace;U.visible&&(V[U.type]=V[U.type]||[],V[U.type].push(N))}for(var ee in ne)if(!V[ee]){var B=ne[ee][0];B[0].trace.visible=!1,V[ee]=[B]}for(var K in V){var J=V[K];J[0][0].trace._module.plot(q,Z,c.filterVisible(J),G)}Z.traceHash=V},a.plotBasePlot=function(q,Z,W,G,X){var ne=e.getModule(q),V=o(Z.calcdata,ne)[0];ne.plot(Z,V,G,X)},a.cleanBasePlot=function(q,Z,W,G,X){var ne=X._has&&X._has(q),V=W._has&&W._has(q);ne&&!V&&X["_"+q+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(v,Q,$){"use strict";Q.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../lib/polygon").tester,k=g.findIndexOfMin,x=g.isAngleInsideSector,e=g.angleDelta,r=g.angleDist;function i(p,s,f,l){var o,d,u=l[0],a=l[1],y=n(Math.sin(s)-Math.sin(p)),h=n(Math.cos(s)-Math.cos(p)),_=Math.tan(f),b=n(1/_),w=y/h,T=a-w*u;return b?y&&h?d=_*(o=T/(_-w)):h?(o=a*b,d=a):(o=u,d=u*_):y&&h?(o=0,d=T):h?(o=0,d=a):o=d=NaN,[o,d]}function c(p,s,f,l){return g.isFullCircle([s,f])?function(o,d){var u,a=d.length,y=new Array(a+1);for(u=0;u<a;u++){var h=d[u];y[u]=[o*Math.cos(h),o*Math.sin(h)]}return y[u]=y[0].slice(),y}(p,l):function(o,d,u,a){var y,h,_=a.length,b=[];function w(D){return[o*Math.cos(D),o*Math.sin(D)]}function T(D,j,q){return i(D,j,q,w(D))}function L(D){return g.mod(D,_)}function M(D){return x(D,[d,u])}var P=k(a,function(D){return M(D)?r(D,d):1/0}),z=T(a[P],a[L(P-1)],d);for(b.push(z),y=P,h=0;h<_;y++,h++){var S=a[L(y)];if(!M(S))break;b.push(w(S))}var C=k(a,function(D){return M(D)?r(D,u):1/0}),R=T(a[C],a[L(C+1)],u);return b.push(R),b.push([0,0]),b.push(b[0].slice()),b}(p,s,f,l)}function n(p){return Math.abs(p)>1e-10?p:0}function m(p,s,f){s=s||0,f=f||0;for(var l=p.length,o=new Array(l),d=0;d<l;d++){var u=p[d];o[d]=[s+u[0],f-u[1]]}return o}Q.exports={isPtInsidePolygon:function(p,s,f,l,o){if(!x(s,l))return!1;var d,u;f[0]<f[1]?(d=f[0],u=f[1]):(d=f[1],u=f[0]);var a=t(c(d,l[0],l[1],o)),y=t(c(u,l[0],l[1],o)),h=[p*Math.cos(s),p*Math.sin(s)];return y.contains(h)&&!a.contains(h)},findPolygonOffset:function(p,s,f,l){for(var o=1/0,d=1/0,u=c(p,s,f,l),a=0;a<u.length;a++){var y=u[a];o=Math.min(o,y[0]),d=Math.min(d,-y[1])}return[o,d]},findEnclosingVertexAngles:function(p,s){var f=k(s,function(o){var d=e(o,p);return d>0?d:1/0}),l=g.mod(f+1,s.length);return[s[f],s[l]]},findIntersectionXY:i,findXYatLength:function(p,s,f,l){var o=-s*f,d=s*s+1,u=2*(s*o-f),y=Math.sqrt(u*u-4*d*(o*o+f*f-p*p)),h=(-u+y)/(2*d),_=(-u-y)/(2*d);return[[h,s*h+o+l],[_,s*_+o+l]]},clampTiny:n,pathPolygon:function(p,s,f,l,o,d){return"M"+m(c(p,s,f,l),o,d).join("L")},pathPolygonAnnulus:function(p,s,f,l,o,d,u){var a,y;p<s?(a=p,y=s):(a=s,y=p);var h=m(c(a,f,l,o),d,u);return"M"+m(c(y,f,l,o),d,u).reverse().join("L")+"M"+h.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(v,Q,$){"use strict";var g=v("../get_data").getSubplotCalcData,t=v("../../lib").counterRegex,k=v("./polar"),x=v("./constants"),e=x.attr,r=x.name,i=t(r),c={};c[e]={valType:"subplotid",dflt:r,editType:"calc"},Q.exports={attr:e,name:r,idRoot:r,idRegex:i,attrRegex:i,attributes:c,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(n){for(var m=n._fullLayout,p=n.calcdata,s=m._subplots[r],f=0;f<s.length;f++){var l=s[f],o=g(p,r,l),d=m[l]._subplot;d||(d=k(n,l),m[l]._subplot=d),d.plot(o,m,n._promises)}},clean:function(n,m,p,s){for(var f=s._subplots[r]||[],l=s._has&&s._has("gl"),o=m._has&&m._has("gl"),d=l&&!o,u=0;u<f.length;u++){var a=f[u],y=s[a]._subplot;if(!m[a]&&y)for(var h in y.framework.remove(),y.layers["radial-axis-title"].remove(),y.clipPaths)y.clipPaths[h].remove();d&&y._scene&&(y._scene.destroy(),y._scene=null)}},toSVG:v("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(v,Q,$){"use strict";var g=v("../../components/color/attributes"),t=v("../cartesian/layout_attributes"),k=v("../domain").attributes,x=v("../../lib").extendFlat,e=v("../../plot_api/edit_types").overrideAll,r=e({color:t.color,showline:x({},t.showline,{dflt:!0}),linecolor:t.linecolor,linewidth:t.linewidth,showgrid:x({},t.showgrid,{dflt:!0}),gridcolor:t.gridcolor,gridwidth:t.gridwidth,griddash:t.griddash},"plot","from-root"),i=e({tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:t.ticks,ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,ticklabelstep:t.ticklabelstep,showticklabels:t.showticklabels,showtickprefix:t.showtickprefix,tickprefix:t.tickprefix,showticksuffix:t.showticksuffix,ticksuffix:t.ticksuffix,showexponent:t.showexponent,exponentformat:t.exponentformat,minexponent:t.minexponent,separatethousands:t.separatethousands,tickfont:t.tickfont,tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,layer:t.layer},"plot","from-root"),c={visible:x({},t.visible,{dflt:!0}),type:x({},t.type,{values:["-","linear","log","date","category"]}),autotypenumbers:t.autotypenumbers,autorange:x({},t.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:x({},t.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:t.categoryorder,categoryarray:t.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:x({},t.title.text,{editType:"plot",dflt:""}),font:x({},t.title.font,{editType:"plot"}),editType:"plot"},hoverformat:t.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:t._deprecated.title,titlefont:t._deprecated.titlefont}};x(c,r,i);var n={visible:x({},t.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:t.autotypenumbers,categoryorder:t.categoryorder,categoryarray:t.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:t.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};x(n,r,i),Q.exports={domain:k({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:g.background},radialaxis:c,angularaxis:n,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../../plot_api/plot_template"),x=v("../subplot_defaults"),e=v("../get_data").getSubplotData,r=v("../cartesian/tick_value_defaults"),i=v("../cartesian/tick_mark_defaults"),c=v("../cartesian/tick_label_defaults"),n=v("../cartesian/prefix_suffix_defaults"),m=v("../cartesian/category_order_defaults"),p=v("../cartesian/line_grid_defaults"),s=v("../cartesian/axis_autotype"),f=v("./layout_attributes"),l=v("./set_convert"),o=v("./constants"),d=o.axisNames;function u(y,h,_,b){var w=_("bgcolor");b.bgColor=t.combine(w,b.paper_bgcolor);var T=_("sector");_("hole");var L,M=e(b.fullData,o.name,b.id),P=b.layoutOut;function z(ee,B){return _(L+"."+ee,B)}for(var S=0;S<d.length;S++){g.isPlainObject(y[L=d[S]])||(y[L]={});var C=y[L],R=k.newContainer(h,L);R._id=R._name=L,R._attr=b.id+"."+L,R._traceIndices=M.map(function(ee){return ee._expandedIndex});var D=o.axisName2dataArray[L],j=a(C,R,z,M,D,b);m(C,R,z,{axData:M,dataAttr:D});var q=z("visible");switch(l(R,h,P),z("uirevision",h.uirevision),R._m=1,L){case"radialaxis":var Z=z("autorange",!R.isValidRange(C.range));C.autorange=Z,!Z||"linear"!==j&&"-"!==j||z("rangemode"),"reversed"===Z&&(R._m=-1),z("range"),R.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if("date"===j){g.log("Polar plots do not support date angular axes yet.");for(var W=0;W<M.length;W++)M[W].visible=!1;j=C.type=R.type="linear"}z("linear"===j?"thetaunit":"period");var G=z("direction");z("rotation",{counterclockwise:0,clockwise:90}[G])}if(n(C,R,z,R.type,{tickSuffixDflt:"degrees"===R.thetaunit?"\xb0":void 0}),q){var X,ne,V,N,U=b.font||{};ne=(X=z("color"))===C.color?X:U.color,V=U.size,N=U.family,r(C,R,z,R.type),c(C,R,z,R.type,{font:{color:ne,size:V,family:N}}),i(C,R,z,{outerTicks:!0}),p(C,R,z,{dfltColor:X,bgColor:b.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:f[L]}),z("layer"),"radialaxis"===L&&(z("side"),z("angle",T[0]),z("title.text"),g.coerceFont(z,"title.font",{color:ne,size:g.bigFont(V),family:N}))}"category"!==j&&z("hoverformat"),R._input=C}"category"===h.angularaxis.type&&_("gridshape")}function a(y,h,_,b,w,T){var L=_("autotypenumbers",T.autotypenumbersDflt);if("-"===_("type")){for(var M,P=0;P<b.length;P++)if(b[P].visible){M=b[P];break}M&&M[w]&&(h.type=s(M[w],"gregorian",{noMultiCategory:!0,autotypenumbers:L})),"-"===h.type?h.type="linear":y.type=h.type}return h.type}Q.exports=function(y,h,_){x(y,h,_,{type:o.name,attributes:f,handleDefaults:u,font:h.font,autotypenumbersDflt:h.autotypenumbers,paper_bgcolor:h.paper_bgcolor,fullData:_,layoutOut:h})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("tinycolor2"),k=v("../../registry"),x=v("../../lib"),e=x.strRotate,r=x.strTranslate,i=v("../../components/color"),c=v("../../components/drawing"),n=v("../plots"),m=v("../../plots/cartesian/axes"),p=v("../cartesian/set_convert"),s=v("./set_convert"),f=v("../cartesian/autorange").doAutoRange,l=v("../cartesian/dragbox"),o=v("../../components/dragelement"),d=v("../../components/fx"),u=v("../../components/titles"),a=v("../../components/selections").prepSelect,y=v("../../components/selections").selectOnClick,h=v("../../components/selections").clearOutline,_=v("../../lib/setcursor"),b=v("../../lib/clear_gl_canvases"),w=v("../../plot_api/subroutines").redrawReglTraces,T=v("../../constants/alignment").MID_SHIFT,L=v("./constants"),M=v("./helpers"),P=v("../smith/helpers"),z=P.smith,S=P.reactanceArc,C=P.resistanceArc,R=P.smithTransform,D=x._,j=x.mod,q=x.deg2rad,Z=x.rad2deg;function W(N,U,ee){this.isSmith=ee||!1,this.id=U,this.gd=N,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var B=N._fullLayout;this.clipIds.forTraces="clip"+B._uid+U+"-for-traces",this.clipPaths.forTraces=B._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=B["_"+(ee?"smith":"polar")+"layer"].append("g").attr("class",U),this.getHole=function(J){return this.isSmith?0:J.hole},this.getSector=function(J){return this.isSmith?[0,360]:J.sector},this.getRadial=function(J){return this.isSmith?J.realaxis:J.radialaxis},this.getAngular=function(J){return this.isSmith?J.imaginaryaxis:J.angularaxis},ee||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=W.prototype;function X(N){var U=N.ticks+String(N.ticklen)+String(N.showticklabels);return"side"in N&&(U+=N.side),U}function ne(N,U){return U[x.findIndexOfMin(U,function(ee){return x.angleDist(N,ee)})]}function V(N,U,ee){return U?(N.attr("display",null),N.attr(ee)):N&&N.attr("display","none"),N}Q.exports=function(N,U,ee){return new W(N,U,ee)},G.plot=function(N,U){for(var ee=U[this.id],B=!1,K=0;K<N.length;K++)if(!1===N[K][0].trace.cliponaxis){B=!0;break}this._hasClipOnAxisFalse=B,this.updateLayers(U,ee),this.updateLayout(U,ee),n.generalUpdatePerTraceModule(this.gd,this,N,ee),this.updateFx(U,ee),this.isSmith&&(delete ee.realaxis.range,delete ee.imaginaryaxis.range)},G.updateLayers=function(N,U){var ee=this.isSmith,B=this.layers,K=this.getRadial(U),J=this.getAngular(U),te=L.layerNames,ae=te.indexOf("frontplot"),ce=te.slice(0,ae),oe="below traces"===J.layer,ve="below traces"===K.layer;oe&&ce.push("angular-line"),ve&&ce.push("radial-line"),oe&&ce.push("angular-axis"),ve&&ce.push("radial-axis"),ce.push("frontplot"),oe||ce.push("angular-line"),ve||ce.push("radial-line"),oe||ce.push("angular-axis"),ve||ce.push("radial-axis");var fe=(ee?"smith":"polar")+"sublayer",xe=this.framework.selectAll("."+fe).data(ce,String);xe.enter().append("g").attr("class",function(Se){return fe+" "+Se}).each(function(Se){var pe=B[Se]=g.select(this);switch(Se){case"frontplot":ee||pe.append("g").classed("barlayer",!0),pe.append("g").classed("scatterlayer",!0);break;case"backplot":pe.append("g").classed("maplayer",!0);break;case"plotbg":B.bg=pe.append("path");break;case"radial-grid":case"angular-grid":pe.style("fill","none");break;case"radial-line":pe.append("line").style("fill","none");break;case"angular-line":pe.append("path").style("fill","none")}}),xe.order()},G.updateLayout=function(N,U){var ee=this.layers,B=N._size,K=this.getRadial(U),J=this.getAngular(U),te=U.domain.x,ae=U.domain.y;this.xOffset=B.l+B.w*te[0],this.yOffset=B.t+B.h*(1-ae[1]);var ce=this.xLength=B.w*(te[1]-te[0]),oe=this.yLength=B.h*(ae[1]-ae[0]),ve=this.getSector(U);this.sectorInRad=ve.map(q);var fe,xe,Se,pe,ge,wt,et,yt,Vt,Gt,en,Jt,cn,Rt,je,Te=this.sectorBBox=(Vt=(wt=ve)[1]-(yt=wt[0]),en=(Gt=j(yt,360))+Vt,Jt=Math.cos(q(Gt)),cn=Math.sin(q(Gt)),Rt=Math.cos(q(en)),je=Math.sin(q(en)),et=Gt<=90&&en>=90||Gt>90&&en>=450?1:cn<=0&&je<=0?0:Math.max(cn,je),[Gt<=180&&en>=180||Gt>180&&en>=540?-1:Jt>=0&&Rt>=0?0:Math.min(Jt,Rt),Gt<=270&&en>=270||Gt>270&&en>=630?-1:cn>=0&&je>=0?0:Math.min(cn,je),en>=360?1:Jt<=0&&Rt<=0?0:Math.max(Jt,Rt),et]),se=Te[2]-Te[0],Ae=oe/ce,Le=Math.abs((Te[3]-Te[1])/se);Ae>Le?(fe=ce,ge=(oe-(xe=ce*Le))/B.h/2,Se=[te[0],te[1]],pe=[ae[0]+ge,ae[1]-ge]):(xe=oe,ge=(ce-(fe=oe/Le))/B.w/2,Se=[te[0]+ge,te[1]-ge],pe=[ae[0],ae[1]]),this.xLength2=fe,this.yLength2=xe,this.xDomain2=Se,this.yDomain2=pe;var Me,De=this.xOffset2=B.l+B.w*Se[0],Oe=this.yOffset2=B.t+B.h*(1-pe[1]),Ie=this.radius=fe/se,Qe=this.innerRadius=this.getHole(U)*Ie,Ne=this.cx=De-Ie*Te[0],Pe=this.cy=Oe+Ie*Te[3],Re=this.cxx=Ne-De,Ge=this.cyy=Pe-Oe,tt=K.side;"counterclockwise"===tt?(Me=tt,tt="top"):"clockwise"===tt&&(Me=tt,tt="bottom"),this.radialAxis=this.mockAxis(N,U,K,{_id:"x",side:tt,_trueSide:Me,domain:[Qe/B.w,Ie/B.w]}),this.angularAxis=this.mockAxis(N,U,J,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(N,U),this.updateAngularAxis(N,U),this.updateRadialAxis(N,U),this.updateRadialAxisTitle(N,U),this.xaxis=this.mockCartesianAxis(N,U,{_id:"x",domain:Se}),this.yaxis=this.mockCartesianAxis(N,U,{_id:"y",domain:pe});var ct=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",ct).attr("transform",r(Re,Ge)),ee.frontplot.attr("transform",r(De,Oe)).call(c.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),ee.bg.attr("d",ct).attr("transform",r(Ne,Pe)).call(i.fill,U.bgcolor)},G.mockAxis=function(N,U,ee,B){var K=x.extendFlat({},ee,B);return s(K,U,N),K},G.mockCartesianAxis=function(N,U,ee){var B=this,K=B.isSmith,J=ee._id,te=x.extendFlat({type:"linear"},ee);p(te,N);var ae={x:[0,2],y:[1,3]};return te.setRange=function(){var ce=B.sectorBBox,oe=ae[J],ve=B.radialAxis._rl,fe=(ve[1]-ve[0])/(1-B.getHole(U));te.range=[ce[oe[0]]*fe,ce[oe[1]]*fe]},te.isPtWithinRange="x"!==J||K?function(){return!0}:function(ce){return B.isPtInside(ce)},te.setRange(),te.setScale(),te},G.doAutoRange=function(N,U){var ee=this.gd,B=this.radialAxis,K=this.getRadial(U);f(ee,B);var J=B.range;K.range=J.slice(),K._input.range=J.slice(),B._rl=[B.r2l(J[0],null,"gregorian"),B.r2l(J[1],null,"gregorian")]},G.updateRadialAxis=function(N,U){var ee=this,B=ee.gd,K=ee.layers,J=ee.radius,te=ee.innerRadius,ae=ee.cx,ce=ee.cy,oe=ee.getRadial(U),ve=j(ee.getSector(U)[0],360),fe=ee.radialAxis,xe=te<J,Se=ee.isSmith;Se||(ee.fillViewInitialKey("radialaxis.angle",oe.angle),ee.fillViewInitialKey("radialaxis.range",fe.range.slice()),fe.setGeometry()),"auto"===fe.tickangle&&ve>90&&ve<=270&&(fe.tickangle=180);var pe=Se?function(Ie){var Qe=R(ee,z([Ie.x,0]));return r(Qe[0]-ae,Qe[1]-ce)}:function(Ie){return r(fe.l2p(Ie.x)+te,0)},ge=Se?function(Ie){return C(ee,Ie.x,-1/0,1/0)}:function(Ie){return ee.pathArc(fe.r2p(Ie.x)+te)},Te=X(oe);if(ee.radialTickLayout!==Te&&(K["radial-axis"].selectAll(".xtick").remove(),ee.radialTickLayout=Te),xe){fe.setScale();var se=0,de=Se?(fe.tickvals||[]).filter(function(Ie){return Ie>=0}).map(function(Ie){return m.tickText(fe,Ie,!0,!1)}):m.calcTicks(fe),Ae=Se?de:m.clipEnds(fe,de),Le=m.getTickSigns(fe)[2];Se&&(("top"===fe.ticks&&"bottom"===fe.side||"bottom"===fe.ticks&&"top"===fe.side)&&(Le=-Le),"top"===fe.ticks&&"top"===fe.side&&(se=-fe.ticklen),"bottom"===fe.ticks&&"bottom"===fe.side&&(se=fe.ticklen)),m.drawTicks(B,fe,{vals:de,layer:K["radial-axis"],path:m.makeTickPath(fe,0,Le),transFn:pe,crisp:!1}),m.drawGrid(B,fe,{vals:Ae,layer:K["radial-grid"],path:ge,transFn:x.noop,crisp:!1}),m.drawLabels(B,fe,{vals:de,layer:K["radial-axis"],transFn:pe,labelFns:m.makeLabelFns(fe,se)})}var Me=ee.radialAxisAngle=ee.vangles?Z(ne(q(oe.angle),ee.vangles)):oe.angle,De=r(ae,ce),Oe=De+e(-Me);V(K["radial-axis"],xe&&(oe.showticklabels||oe.ticks),{transform:Oe}),V(K["radial-grid"],xe&&oe.showgrid,{transform:Se?"":De}),V(K["radial-line"].select("line"),xe&&oe.showline,{x1:Se?-J:te,y1:0,x2:J,y2:0,transform:Oe}).attr("stroke-width",oe.linewidth).call(i.stroke,oe.linecolor)},G.updateRadialAxisTitle=function(N,U,ee){if(!this.isSmith){var B=this.gd,K=this.radius,J=this.cx,te=this.cy,ae=this.getRadial(U),ce=this.id+"title",oe=0;if(ae.title){var ve=c.bBox(this.layers["radial-axis"].node()).height,fe=ae.title.font.size,xe=ae.side;oe="top"===xe?fe:"counterclockwise"===xe?-(ve+.4*fe):ve+.8*fe}var Se=void 0!==ee?ee:this.radialAxisAngle,pe=q(Se),ge=Math.cos(pe),Te=Math.sin(pe),se=J+K/2*ge+oe*Te,de=te-K/2*Te+oe*ge;this.layers["radial-axis-title"]=u.draw(B,ce,{propContainer:ae,propName:this.id+".radialaxis.title",placeholder:D(B,"Click to enter radial axis title"),attributes:{x:se,y:de,"text-anchor":"middle"},transform:{rotate:-Se}})}},G.updateAngularAxis=function(N,U){var ee=this,B=ee.gd,K=ee.layers,J=ee.radius,te=ee.innerRadius,ae=ee.cx,ce=ee.cy,oe=ee.getAngular(U),ve=ee.angularAxis,fe=ee.isSmith;fe||(ee.fillViewInitialKey("angularaxis.rotation",oe.rotation),ve.setGeometry(),ve.setScale());var xe=fe?function(Ie){var Qe=R(ee,z([0,Ie.x]));return Math.atan2(Qe[0]-ae,Qe[1]-ce)-Math.PI/2}:function(Ie){return ve.t2g(Ie.x)};"linear"===ve.type&&"radians"===ve.thetaunit&&(ve.tick0=Z(ve.tick0),ve.dtick=Z(ve.dtick));var Se=function(Ie){return r(ae+J*Math.cos(Ie),ce-J*Math.sin(Ie))},pe=fe?function(Ie){var Qe=R(ee,z([0,Ie.x]));return r(Qe[0],Qe[1])}:function(Ie){return Se(xe(Ie))},ge=fe?function(Ie){var Qe=R(ee,z([0,Ie.x])),Ne=Math.atan2(Qe[0]-ae,Qe[1]-ce)-Math.PI/2;return r(Qe[0],Qe[1])+e(-Z(Ne))}:function(Ie){var Qe=xe(Ie);return Se(Qe)+e(-Z(Qe))},Te=fe?function(Ie){return S(ee,Ie.x,0,1/0)}:function(Ie){var Qe=xe(Ie),Ne=Math.cos(Qe),Pe=Math.sin(Qe);return"M"+[ae+te*Ne,ce-te*Pe]+"L"+[ae+J*Ne,ce-J*Pe]},se=m.makeLabelFns(ve,0).labelStandoff,de={xFn:function(Ie){var Qe=xe(Ie);return Math.cos(Qe)*se},yFn:function(Ie){var Qe=xe(Ie),Ne=Math.sin(Qe)>0?.2:1;return-Math.sin(Qe)*(se+Ie.fontSize*Ne)+Math.abs(Math.cos(Qe))*(Ie.fontSize*T)},anchorFn:function(Ie){var Qe=xe(Ie),Ne=Math.cos(Qe);return Math.abs(Ne)<.1?"middle":Ne>0?"start":"end"},heightFn:function(Ie,Qe,Ne){var Pe=xe(Ie);return-.5*(1+Math.sin(Pe))*Ne}},Ae=X(oe);ee.angularTickLayout!==Ae&&(K["angular-axis"].selectAll("."+ve._id+"tick").remove(),ee.angularTickLayout=Ae);var Le,Me=fe?[1/0].concat(ve.tickvals||[]).map(function(Ie){return m.tickText(ve,Ie,!0,!1)}):m.calcTicks(ve);if(fe&&(Me[0].text="\u221e",Me[0].fontSize*=1.75),"linear"===U.gridshape?(Le=Me.map(xe),x.angleDelta(Le[0],Le[1])<0&&(Le=Le.slice().reverse())):Le=null,ee.vangles=Le,"category"===ve.type&&(Me=Me.filter(function(Ie){return x.isAngleInsideSector(xe(Ie),ee.sectorInRad)})),ve.visible){var De="inside"===ve.ticks?-1:1;m.drawTicks(B,ve,{vals:Me,layer:K["angular-axis"],path:"M"+De*((ve.linewidth||1)/2)+",0h"+De*ve.ticklen,transFn:ge,crisp:!1}),m.drawGrid(B,ve,{vals:Me,layer:K["angular-grid"],path:Te,transFn:x.noop,crisp:!1}),m.drawLabels(B,ve,{vals:Me,layer:K["angular-axis"],repositionOnUpdate:!0,transFn:pe,labelFns:de})}V(K["angular-line"].select("path"),oe.showline,{d:ee.pathSubplot(),transform:r(ae,ce)}).attr("stroke-width",oe.linewidth).call(i.stroke,oe.linecolor)},G.updateFx=function(N,U){this.gd._context.staticPlot||(!this.isSmith&&(this.updateAngularDrag(N),this.updateRadialDrag(N,U,0),this.updateRadialDrag(N,U,1)),this.updateHoverAndMainDrag(N))},G.updateHoverAndMainDrag=function(N){var U,ee,B=this,K=B.isSmith,J=B.gd,ae=N._zoomlayer,ce=L.MINZOOM,oe=L.OFFEDGE,ve=B.radius,fe=B.innerRadius,xe=B.cx,Se=B.cy,pe=B.cxx,ge=B.cyy,Te=B.sectorInRad,se=B.vangles,de=B.radialAxis,Ae=M.clampTiny,Le=M.findXYatLength,Me=M.findEnclosingVertexAngles,De=L.cornerHalfWidth,Oe=L.cornerLen/2,Ie=l.makeDragger(B.layers,"path","maindrag",!1===N.dragmode?"none":"crosshair");g.select(Ie).attr("d",B.pathSubplot()).attr("transform",r(xe,Se)),Ie.onmousemove=function(He){d.hover(J,He,B.id),J._fullLayout._lasthover=Ie,J._fullLayout._hoversubplot=B.id},Ie.onmouseout=function(He){J._dragging||o.unhover(J,He)};var Qe,Ne,Pe,Re,Ge,tt,ct,wt,kt,gt={element:Ie,gd:J,subplot:B.id,plotinfo:{id:B.id,xaxis:B.xaxis,yaxis:B.yaxis},xaxes:[B.xaxis],yaxes:[B.yaxis]};function at(He,Ke){return Math.sqrt(He*He+Ke*Ke)}function et(He,Ke){return at(He-pe,Ke-ge)}function yt(He,Ke){return Math.atan2(ge-Ke,He-pe)}function Vt(He,Ke){return[He*Math.cos(Ke),He*Math.sin(-Ke)]}function Gt(He,Ke){if(0===He)return B.pathSector(2*De);var Ze=Oe/He,ut=Ke-Ze,lt=Ke+Ze,Lt=Math.max(0,Math.min(He,ve)),Ot=Lt-De,ot=Lt+De;return"M"+Vt(Ot,ut)+"A"+[Ot,Ot]+" 0,0,0 "+Vt(Ot,lt)+"L"+Vt(ot,lt)+"A"+[ot,ot]+" 0,0,1 "+Vt(ot,ut)+"Z"}function en(He,Ke,Ze){if(0===He)return B.pathSector(2*De);var ut,lt,Lt=Vt(He,Ke),Ot=Vt(He,Ze),ot=Ae((Lt[0]+Ot[0])/2),pt=Ae((Lt[1]+Ot[1])/2);if(ot&&pt){var qt=pt/ot,St=-1/qt,Mt=Le(De,qt,ot,pt);ut=Le(Oe,St,Mt[0][0],Mt[0][1]),lt=Le(Oe,St,Mt[1][0],Mt[1][1])}else{var Ce,Xe;pt?(Ce=Oe,Xe=De):(Ce=De,Xe=Oe),ut=[[ot-Ce,pt-Xe],[ot+Ce,pt-Xe]],lt=[[ot-Ce,pt+Xe],[ot+Ce,pt+Xe]]}return"M"+ut.join("L")+"L"+lt.reverse().join("L")+"Z"}function Jt(He,Ke){return Ke=Math.max(Math.min(Ke,ve),fe),He<oe?He=0:ve-He<oe?He=ve:Ke<oe?Ke=0:ve-Ke<oe&&(Ke=ve),Math.abs(Ke-He)>ce?(He<Ke?(Pe=He,Re=Ke):(Pe=Ke,Re=He),!0):(Pe=null,Re=null,!1)}function cn(He,Ke){Ke=Ke||"M0,0Z",wt.attr("d",He=He||Ge),kt.attr("d",Ke),l.transitionZoombox(wt,kt,tt,ct),tt=!0;var Ze={};be(Ze),J.emit("plotly_relayouting",Ze)}function Rt(He,Ke){var Ze,ut,lt=Qe+(He*=U),Lt=Ne+(Ke*=ee),Ot=et(Qe,Ne),ot=Math.min(et(lt,Lt),ve),pt=yt(Qe,Ne);Jt(Ot,ot)&&(Ze=Ge+B.pathSector(Re),Pe&&(Ze+=B.pathSector(Pe)),ut=Gt(Pe,pt)+Gt(Re,pt)),cn(Ze,ut)}function je(He,Ke,Ze,ut){var lt=M.findIntersectionXY(Ze,ut,Ze,[He-pe,ge-Ke]);return at(lt[0],lt[1])}function Ye(He,Ke){var Ze,ut,lt=Qe+He,Lt=Ne+Ke,Ot=yt(Qe,Ne),ot=yt(lt,Lt),pt=Me(Ot,se),qt=Me(ot,se);Jt(je(Qe,Ne,pt[0],pt[1]),Math.min(je(lt,Lt,qt[0],qt[1]),ve))&&(Ze=Ge+B.pathSector(Re),Pe&&(Ze+=B.pathSector(Pe)),ut=[en(Pe,pt[0],pt[1]),en(Re,pt[0],pt[1])].join(" ")),cn(Ze,ut)}function he(){if(l.removeZoombox(J),null!==Pe&&null!==Re){var He={};be(He),l.showDoubleClickNotifier(J),k.call("_guiRelayout",J,He)}}function be(He){var Ke=de._rl,Ze=(Ke[1]-Ke[0])/(1-fe/ve)/ve;He[B.id+".radialaxis.range"]=[Ke[0]+(Pe-fe)*Ze,Ke[0]+(Re-fe)*Ze]}function Fe(He,Ke){var Ze=J._fullLayout.clickmode;if(l.removeZoombox(J),2===He){var ut={};for(var lt in B.viewInitial)ut[B.id+"."+lt]=B.viewInitial[lt];J.emit("plotly_doubleclick",null),k.call("_guiRelayout",J,ut)}Ze.indexOf("select")>-1&&1===He&&y(Ke,J,[B.xaxis],[B.yaxis],B.id,gt),Ze.indexOf("event")>-1&&d.click(J,Ke,B.id)}gt.prepFn=function(He,Ke,Ze){var ut=J._fullLayout.dragmode,lt=Ie.getBoundingClientRect();J._fullLayout._calcInverseTransform(J),U=J._fullLayout._invScaleX,ee=J._fullLayout._invScaleY;var Ot=x.apply3DTransform(J._fullLayout._invTransform)(Ke-lt.left,Ze-lt.top);if(Qe=Ot[0],Ne=Ot[1],se){var ot=M.findPolygonOffset(ve,Te[0],Te[1],se);Qe+=pe+ot[0],Ne+=ge+ot[1]}switch(ut){case"zoom":gt.clickFn=Fe,K||(gt.moveFn=se?Ye:Rt,gt.doneFn=he,Pe=null,Re=null,Ge=B.pathSubplot(),tt=!1,ct=t(J._fullLayout[B.id].bgcolor).getLuminance(),(wt=l.makeZoombox(ae,ct,xe,Se,Ge)).attr("fill-rule","evenodd"),kt=l.makeCorners(ae,xe,Se),h(J));break;case"select":case"lasso":a(He,Ke,Ze,gt,ut)}},o.init(gt)},G.updateRadialDrag=function(N,U,ee){var B=this,K=B.gd,J=B.layers,te=B.radius,ae=B.innerRadius,ce=B.cx,oe=B.cy,ve=B.radialAxis,fe=L.radialDragBoxSize,xe=fe/2;if(ve.visible){var Se,pe,ge,Te=q(B.radialAxisAngle),se=ve._rl,de=se[0],Ae=se[1],Le=se[ee],Me=.75*(se[1]-se[0])/(1-B.getHole(U))/te;ee?(Se=ce+(te+xe)*Math.cos(Te),pe=oe-(te+xe)*Math.sin(Te),ge="radialdrag"):(Se=ce+(ae-xe)*Math.cos(Te),pe=oe-(ae-xe)*Math.sin(Te),ge="radialdrag-inner");var De,Oe,Ie,Qe=l.makeRectDragger(J,ge,"crosshair",-xe,-xe,fe,fe),Ne={element:Qe,gd:K};!1===N.dragmode&&(Ne.dragmode=!1),V(g.select(Qe),ve.visible&&ae<te,{transform:r(Se,pe)}),Ne.prepFn=function(){De=null,Oe=null,Ie=null,Ne.moveFn=Pe,Ne.doneFn=Re,h(K)},Ne.clampFn=function(ct,wt){return Math.sqrt(ct*ct+wt*wt)<L.MINDRAG&&(ct=0,wt=0),[ct,wt]},o.init(Ne)}function Pe(ct,wt){if(De)De(ct,wt);else{var kt=[ct,-wt],gt=[Math.cos(Te),Math.sin(Te)],at=Math.abs(x.dot(kt,gt)/Math.sqrt(x.dot(kt,kt)));isNaN(at)||(De=at<.5?Ge:tt)}var yt,et={};yt=et,null!==Oe?yt[B.id+".radialaxis.angle"]=Oe:null!==Ie&&(yt[B.id+".radialaxis.range["+ee+"]"]=Ie),K.emit("plotly_relayouting",et)}function Re(){null!==Oe?k.call("_guiRelayout",K,B.id+".radialaxis.angle",Oe):null!==Ie&&k.call("_guiRelayout",K,B.id+".radialaxis.range["+ee+"]",Ie)}function Ge(ct,wt){if(0!==ee){Oe=Math.atan2(oe-(pe+wt),Se+ct-ce),B.vangles&&(Oe=ne(Oe,B.vangles)),Oe=Z(Oe);var at=r(ce,oe)+e(-Oe);J["radial-axis"].attr("transform",at),J["radial-line"].select("line").attr("transform",at);var et=B.gd._fullLayout;B.updateRadialAxisTitle(et,et[B.id],Oe)}}function tt(ct,wt){var kt=x.dot([ct,-wt],[Math.cos(Te),Math.sin(Te)]);if(Ie=Le-Me*kt,Me>0==(ee?Ie>de:Ie<Ae)){var gt=K._fullLayout,at=gt[B.id];ve.range[ee]=Ie,ve._rl[ee]=Ie,B.updateRadialAxis(gt,at),B.xaxis.setRange(),B.xaxis.setScale(),B.yaxis.setRange(),B.yaxis.setScale();var et=!1;for(var yt in B.traceHash){var Vt=B.traceHash[yt],Gt=x.filterVisible(Vt);Vt[0][0].trace._module.plot(K,B,Gt,at),k.traceIs(yt,"gl")&&Gt.length&&(et=!0)}et&&(b(K),w(K))}else Ie=null}},G.updateAngularDrag=function(N){var U=this,ee=U.gd,B=U.layers,K=U.radius,J=U.angularAxis,te=U.cx,ae=U.cy,ce=U.cxx,oe=U.cyy,ve=L.angularDragBoxSize,fe=l.makeDragger(B,"path","angulardrag",!1===N.dragmode?"none":"move"),xe={element:fe,gd:ee};function Se(Ne,Pe){return Math.atan2(oe+ve-Pe,Ne-ce-ve)}!1===N.dragmode?xe.dragmode=!1:g.select(fe).attr("d",U.pathAnnulus(K,K+ve)).attr("transform",r(te,ae)).call(_,"move");var pe,ge,Te,se,de,Ae,Le=B.frontplot.select(".scatterlayer").selectAll(".trace"),Me=Le.selectAll(".point"),De=Le.selectAll(".textpoint");function Oe(Ne,Pe){var Re=U.gd._fullLayout,Ge=Re[U.id],tt=Se(pe+Ne*N._invScaleX,ge+Pe*N._invScaleY),ct=Z(tt-Ae);if(se=Te+ct,B.frontplot.attr("transform",r(U.xOffset2,U.yOffset2)+e([-ct,ce,oe])),U.vangles){de=U.radialAxisAngle+ct;var wt=r(te,ae)+e(-ct),kt=r(te,ae)+e(-de);B.bg.attr("transform",wt),B["radial-grid"].attr("transform",wt),B["radial-axis"].attr("transform",kt),B["radial-line"].select("line").attr("transform",kt),U.updateRadialAxisTitle(Re,Ge,de)}else U.clipPaths.forTraces.select("path").attr("transform",r(ce,oe)+e(ct));Me.each(function(){var Gt=g.select(this),en=c.getTranslate(Gt);Gt.attr("transform",r(en.x,en.y)+e([ct]))}),De.each(function(){var Gt=g.select(this),en=Gt.select("text"),Jt=c.getTranslate(Gt);Gt.attr("transform",e([ct,en.attr("x"),en.attr("y")])+r(Jt.x,Jt.y))}),J.rotation=x.modHalf(se,360),U.updateAngularAxis(Re,Ge),U._hasClipOnAxisFalse&&!x.isFullCircle(U.sectorInRad)&&Le.call(c.hideOutsideRangePoints,U);var gt=!1;for(var at in U.traceHash)if(k.traceIs(at,"gl")){var et=U.traceHash[at],yt=x.filterVisible(et);et[0][0].trace._module.plot(ee,U,yt,Ge),yt.length&&(gt=!0)}gt&&(b(ee),w(ee));var Vt={};Ie(Vt),ee.emit("plotly_relayouting",Vt)}function Ie(Ne){Ne[U.id+".angularaxis.rotation"]=se,U.vangles&&(Ne[U.id+".radialaxis.angle"]=de)}function Qe(){De.select("text").attr("transform",null);var Ne={};Ie(Ne),k.call("_guiRelayout",ee,Ne)}xe.prepFn=function(Ne,Pe,Re){Te=N[U.id].angularaxis.rotation;var tt=fe.getBoundingClientRect();pe=Pe-tt.left,ge=Re-tt.top,ee._fullLayout._calcInverseTransform(ee);var ct=x.apply3DTransform(N._invTransform)(pe,ge);Ae=Se(pe=ct[0],ge=ct[1]),xe.moveFn=Oe,xe.doneFn=Qe,h(ee)},U.vangles&&!x.isFullCircle(U.sectorInRad)&&(xe.prepFn=x.noop,_(g.select(fe),null)),o.init(xe)},G.isPtInside=function(N){if(this.isSmith)return!0;var U=this.sectorInRad,ee=this.vangles,B=this.angularAxis.c2g(N.theta),K=this.radialAxis,J=K.c2l(N.r);return(ee?M.isPtInsidePolygon:x.isPtInsideSector)(J,B,K._rl,U,ee)},G.pathArc=function(N){var U=this.sectorInRad,ee=this.vangles;return(ee?M.pathPolygon:x.pathArc)(N,U[0],U[1],ee)},G.pathSector=function(N){var U=this.sectorInRad,ee=this.vangles;return(ee?M.pathPolygon:x.pathSector)(N,U[0],U[1],ee)},G.pathAnnulus=function(N,U){var ee=this.sectorInRad,B=this.vangles;return(B?M.pathPolygonAnnulus:x.pathAnnulus)(N,U,ee[0],ee[1],B)},G.pathSubplot=function(){var N=this.innerRadius,U=this.radius;return N?this.pathAnnulus(N,U):this.pathSector(U)},G.fillViewInitialKey=function(N,U){N in this.viewInitial||(this.viewInitial[N]=U)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../cartesian/set_convert"),k=g.deg2rad,x=g.rad2deg;Q.exports=function(e,r,i){switch(t(e,i),e._id){case"x":case"radialaxis":m=r._subplot,(c=e).setGeometry=function(){var p=c._rl[0],s=c._rl[1],f=m.innerRadius,l=(m.radius-f)/(s-p),o=f/l,d=p>s?function(u){return u<=0}:function(u){return u>=0};c.c2g=function(u){var a=c.c2l(u)-p;return(d(a)?a:0)+o},c.g2c=function(u){return c.l2c(u+p-o)},c.g2p=function(u){return u*l},c.c2p=function(u){return c.g2p(c.c2g(u))}};break;case"angularaxis":!function(c,n){var m=c.type;if("linear"===m){var p=c.d2c,s=c.c2d;c.d2c=function(f,l){return o=p(f),"degrees"===l?k(o):o;var o},c.c2d=function(f,l){return s((o=f,"degrees"===l?x(o):o));var o}}c.makeCalcdata=function(f,l){var o,d,u=f[l],a=f._length,y=function(T){return c.d2c(T,f.thetaunit)};if(u){if(g.isTypedArray(u)&&"linear"===m){if(a===u.length)return u;if(u.subarray)return u.subarray(0,a)}for(o=new Array(a),d=0;d<a;d++)o[d]=y(u[d])}else{var h=l+"0",_="d"+l,b=h in f?y(f[h]):0,w=f[_]?y(f[_]):(c.period||2*Math.PI)/a;for(o=new Array(a),d=0;d<a;d++)o[d]=b+d*w}return o},c.setGeometry=function(){var f,l,o,d,u=n.sector,a=u.map(k),y={clockwise:-1,counterclockwise:1}[c.direction],h=k(c.rotation),_=function(L){return y*L+h},b=function(L){return(L-h)/y};switch(m){case"linear":l=f=g.identity,d=k,o=x,c.range=g.isFullCircle(a)?[u[0],u[0]+360]:a.map(b).map(x);break;case"category":var w=c._categories.length,T=c.period?Math.max(c.period,w):w;0===T&&(T=1),l=d=function(L){return 2*L*Math.PI/T},f=o=function(L){return L*T/Math.PI/2},c.range=[0,T]}c.c2g=function(L){return _(l(L))},c.g2c=function(L){return f(b(L))},c.t2g=function(L){return _(d(L))},c.g2t=function(L){return o(b(L))}}}(e,r)}var c,m}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(v,Q,$){"use strict";Q.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(v,Q,$){"use strict";function g(e){return e<0?-1:e>0?1:0}function t(e){var r=e[0],i=e[1];if(!isFinite(r)||!isFinite(i))return[1,0];var c=(r+1)*(r+1)+i*i;return[(r*r+i*i-1)/c,2*i/c]}function k(e,r){return[r[0]*e.radius+e.cx,-r[1]*e.radius+e.cy]}function x(e,r){return r*e.radius}Q.exports={smith:t,reactanceArc:function(e,r,i,c){var n=k(e,t([i,r])),m=n[0],p=n[1],s=k(e,t([c,r])),f=s[0],l=s[1];if(0===r)return["M"+m+","+p,"L"+f+","+l].join(" ");var o=x(e,1/Math.abs(r));return["M"+m+","+p,"A"+o+","+o+" 0 0,"+(r<0?1:0)+" "+f+","+l].join(" ")},resistanceArc:function(e,r,i,c){var n=x(e,1/(r+1)),m=k(e,t([r,i])),p=m[0],s=m[1],f=k(e,t([r,c])),l=f[0],o=f[1];if(g(i)!==g(c)){var d=k(e,t([r,0]));return["M"+p+","+s,"A"+n+","+n+" 0 0,"+(0<i?0:1)+" "+d[0]+","+d[1],"A"+n+","+n+" 0 0,"+(c<0?0:1)+l+","+o].join(" ")}return["M"+p+","+s,"A"+n+","+n+" 0 0,"+(c<i?0:1)+" "+l+","+o].join(" ")},smithTransform:k}},{}],638:[function(v,Q,$){"use strict";var g=v("../get_data").getSubplotCalcData,t=v("../../lib").counterRegex,k=v("../polar/polar"),x=v("./constants"),e=x.attr,r=x.name,i=t(r),c={};c[e]={valType:"subplotid",dflt:r,editType:"calc"},Q.exports={attr:e,name:r,idRoot:r,idRegex:i,attrRegex:i,attributes:c,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(n){for(var m=n._fullLayout,p=n.calcdata,s=m._subplots[r],f=0;f<s.length;f++){var l=s[f],o=g(p,r,l),d=m[l]._subplot;d||(d=k(n,l,!0),m[l]._subplot=d),d.plot(o,m,n._promises)}},clean:function(n,m,p,s){for(var f=s._subplots[r]||[],l=0;l<f.length;l++){var o=f[l],d=s[o]._subplot;if(!m[o]&&d)for(var u in d.framework.remove(),d.clipPaths)d.clipPaths[u].remove()}},toSVG:v("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(v,Q,$){"use strict";var g=v("../../components/color/attributes"),t=v("../cartesian/layout_attributes"),k=v("../domain").attributes,x=v("../../lib").extendFlat,e=v("../../plot_api/edit_types").overrideAll,r=e({color:t.color,showline:x({},t.showline,{dflt:!0}),linecolor:t.linecolor,linewidth:t.linewidth,showgrid:x({},t.showgrid,{dflt:!0}),gridcolor:t.gridcolor,gridwidth:t.gridwidth,griddash:t.griddash},"plot","from-root"),i=e({ticklen:t.ticklen,tickwidth:x({},t.tickwidth,{dflt:2}),tickcolor:t.tickcolor,showticklabels:t.showticklabels,showtickprefix:t.showtickprefix,tickprefix:t.tickprefix,showticksuffix:t.showticksuffix,ticksuffix:t.ticksuffix,tickfont:t.tickfont,tickformat:t.tickformat,hoverformat:t.hoverformat,layer:t.layer},"plot","from-root"),c=x({visible:x({},t.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:x({},t.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},r,i),n=x({visible:x({},t.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:t.ticks,editType:"calc"},r,i);Q.exports={domain:k({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:g.background},realaxis:c,imaginaryaxis:n,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(v,Q,$){"use strict";var g,t,k,x=v("../../lib"),e=v("../../components/color"),r=v("../../plot_api/plot_template"),i=v("../subplot_defaults"),c=v("../get_data").getSubplotData,n=v("../cartesian/prefix_suffix_defaults"),m=v("../cartesian/tick_label_defaults"),p=v("../cartesian/line_grid_defaults"),s=v("../cartesian/set_convert"),f=v("./layout_attributes"),l=v("./constants"),o=l.axisNames,d=(g=function(a){return a.slice().reverse().map(function(y){return-y}).concat([0]).concat(a)},t=String,k={},function(a){var y=t?t(a):a;if(y in k)return k[y];var h=g(a);return k[y]=h,h});function u(a,y,h,_){var b=h("bgcolor");_.bgColor=e.combine(b,_.paper_bgcolor);var w,T=c(_.fullData,l.name,_.id),L=_.layoutOut;function M(G,X){return h(w+"."+G,X)}for(var P=0;P<o.length;P++){x.isPlainObject(a[w=o[P]])||(a[w]={});var z=a[w],S=r.newContainer(y,w);S._id=S._name=w,S._attr=_.id+"."+w,S._traceIndices=T.map(function(G){return G._expandedIndex});var C=M("visible");if(S.type="linear",s(S,L),n(z,S,M,S.type),C){var R,D,j,q,Z="realaxis"===w;Z&&M("side"),Z?M("tickvals"):M("tickvals",d(y.realaxis.tickvals||f.realaxis.tickvals.dflt));var W=_.font||{};C&&(D=(R=M("color"))===z.color?R:W.color,j=W.size,q=W.family),m(z,S,M,S.type,{noTicklabelstep:!0,noAng:!Z,noExp:!0,font:{color:D,size:j,family:q}}),x.coerce2(a,y,f,w+".ticklen"),x.coerce2(a,y,f,w+".tickwidth"),x.coerce2(a,y,f,w+".tickcolor",y.color),M("ticks")||(delete y[w].ticklen,delete y[w].tickwidth,delete y[w].tickcolor),p(z,S,M,{dfltColor:R,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:f[w]}),M("layer")}M("hoverformat"),delete S.type,S._input=z}}Q.exports=function(a,y,h){i(a,y,h,{noUirevision:!0,type:l.name,attributes:f,handleDefaults:u,font:y.font,paper_bgcolor:y.paper_bgcolor,fullData:h,layoutOut:y})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plot_api/plot_template"),k=v("./domain").defaults;Q.exports=function(x,e,r,i){var c,n,p=i.attributes,s=i.handleDefaults,f=i.partition||"x",l=e._subplots[i.type],o=l.length,d=o&&l[0].replace(/\d+$/,"");function u(_,b){return g.coerce(c,n,p,_,b)}for(var a=0;a<o;a++){var y=l[a];c=x[y]?x[y]:x[y]={},n=t.newContainer(e,y,d),i.noUirevision||u("uirevision",e.uirevision);var h={};h[f]=[a/o,(a+1)/o],k(n,e,u,h),i.id=y,s(c,n,u,i)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(v,Q,$){"use strict";function t(k){var x=k.description?" "+k.description:"",e=k.keys||[];if(e.length>0){for(var r=[],i=0;i<e.length;i++)r[i]="`"+e[i]+"`";x+="Finally, the template string has access to ",x=1===e.length?"variable "+r[0]:"variables "+r.slice(0,-1).join(", ")+" and "+r.slice(-1)+"."}return x}v("../constants/docs"),$.hovertemplateAttrs=function(k,x){k=k||{},t(x=x||{});var e={valType:"string",dflt:"",editType:k.editType||"none"};return!1!==k.arrayOk&&(e.arrayOk=!0),e},$.texttemplateAttrs=function(k,x){k=k||{},t(x=x||{});var e={valType:"string",dflt:"",editType:k.editType||"calc"};return!1!==k.arrayOk&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(v,Q,$){"use strict";var g=v("./ternary"),t=v("../../plots/get_data").getSubplotCalcData,k=v("../../lib").counterRegex;$.name="ternary";var x=$.attr="subplot";$.idRoot="ternary",$.idRegex=$.attrRegex=k("ternary"),($.attributes={})[x]={valType:"subplotid",dflt:"ternary",editType:"calc"},$.layoutAttributes=v("./layout_attributes"),$.supplyLayoutDefaults=v("./layout_defaults"),$.plot=function(e){for(var r=e._fullLayout,i=e.calcdata,c=r._subplots.ternary,n=0;n<c.length;n++){var m=c[n],p=t(i,"ternary",m),s=r[m]._subplot;s||(s=new g({id:m,graphDiv:e,container:r._ternarylayer.node()},r),r[m]._subplot=s),s.plot(p,r,e._promises)}},$.clean=function(e,r,i,c){for(var n=c._subplots.ternary||[],m=0;m<n.length;m++){var p=n[m],s=c[p]._subplot;!r[p]&&s&&(s.plotContainer.remove(),s.clipDef.remove(),s.clipDefRelative.remove(),s.layers["a-title"].remove(),s.layers["b-title"].remove(),s.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(v,Q,$){"use strict";var g=v("../../components/color/attributes"),t=v("../domain").attributes,k=v("../cartesian/layout_attributes"),x=v("../../plot_api/edit_types").overrideAll,e=v("../../lib/extend").extendFlat,r={title:{text:k.title.text,font:k.title.font},color:k.color,tickmode:k.tickmode,nticks:e({},k.nticks,{dflt:6,min:1}),tick0:k.tick0,dtick:k.dtick,tickvals:k.tickvals,ticktext:k.ticktext,ticks:k.ticks,ticklen:k.ticklen,tickwidth:k.tickwidth,tickcolor:k.tickcolor,ticklabelstep:k.ticklabelstep,showticklabels:k.showticklabels,showtickprefix:k.showtickprefix,tickprefix:k.tickprefix,showticksuffix:k.showticksuffix,ticksuffix:k.ticksuffix,showexponent:k.showexponent,exponentformat:k.exponentformat,minexponent:k.minexponent,separatethousands:k.separatethousands,tickfont:k.tickfont,tickangle:k.tickangle,tickformat:k.tickformat,tickformatstops:k.tickformatstops,hoverformat:k.hoverformat,showline:e({},k.showline,{dflt:!0}),linecolor:k.linecolor,linewidth:k.linewidth,showgrid:e({},k.showgrid,{dflt:!0}),gridcolor:k.gridcolor,gridwidth:k.gridwidth,griddash:k.griddash,layer:k.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:k._deprecated.title,titlefont:k._deprecated.titlefont}},i=Q.exports=x({domain:t({name:"ternary"}),bgcolor:{valType:"color",dflt:g.background},sum:{valType:"number",dflt:1,min:0},aaxis:r,baxis:r,caxis:r},"plot","from-root");i.uirevision={valType:"any",editType:"none"},i.aaxis.uirevision=i.baxis.uirevision=i.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../../plot_api/plot_template"),k=v("../../lib"),x=v("../subplot_defaults"),e=v("../cartesian/tick_label_defaults"),r=v("../cartesian/prefix_suffix_defaults"),i=v("../cartesian/tick_mark_defaults"),c=v("../cartesian/tick_value_defaults"),n=v("../cartesian/line_grid_defaults"),m=v("./layout_attributes"),p=["aaxis","baxis","caxis"];function s(l,o,d,u){var a,y,h,_=d("bgcolor"),b=d("sum");u.bgColor=g.combine(_,u.paper_bgcolor);for(var w=0;w<p.length;w++)y=l[a=p[w]]||{},(h=t.newContainer(o,a))._name=a,f(y,h,u,o);var T=o.aaxis,L=o.baxis,M=o.caxis;T.min+L.min+M.min>=b&&(T.min=0,L.min=0,M.min=0,l.aaxis&&delete l.aaxis.min,l.baxis&&delete l.baxis.min,l.caxis&&delete l.caxis.min)}function f(l,o,d,u){var a=m[o._name];function y(L,M){return k.coerce(l,o,a,L,M)}y("uirevision",u.uirevision),o.type="linear";var h=y("color"),_=h!==a.color.dflt?h:d.font.color,b=o._name.charAt(0).toUpperCase(),w="Component "+b,T=y("title.text",w);o._hovertitle=T===w?T:b,k.coerceFont(y,"title.font",{family:d.font.family,size:k.bigFont(d.font.size),color:_}),y("min"),c(l,o,y,"linear"),r(l,o,y,"linear"),e(l,o,y,"linear"),i(l,o,y,{outerTicks:!0}),y("showticklabels")&&(k.coerceFont(y,"tickfont",{family:d.font.family,size:d.font.size,color:_}),y("tickangle"),y("tickformat")),n(l,o,y,{dfltColor:h,bgColor:d.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:a}),y("hoverformat"),y("layer")}Q.exports=function(l,o,d){x(l,o,d,{type:"ternary",attributes:m,handleDefaults:s,font:o.font,paper_bgcolor:o.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("tinycolor2"),k=v("../../registry"),x=v("../../lib"),e=x.strTranslate,r=x._,i=v("../../components/color"),c=v("../../components/drawing"),n=v("../cartesian/set_convert"),m=v("../../lib/extend").extendFlat,p=v("../plots"),s=v("../cartesian/axes"),f=v("../../components/dragelement"),l=v("../../components/fx"),o=v("../../components/dragelement/helpers"),d=o.freeMode,u=o.rectMode,a=v("../../components/titles"),y=v("../../components/selections").prepSelect,h=v("../../components/selections").selectOnClick,_=v("../../components/selections").clearOutline,b=v("../../components/selections").clearSelectionsCache,w=v("../cartesian/constants");function T(j,q){this.id=j.id,this.graphDiv=j.graphDiv,this.init(q),this.makeFramework(q),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}Q.exports=T;var L=T.prototype;L.init=function(j){this.container=j._ternarylayer,this.defs=j._defs,this.layoutId=j._uid,this.traceHash={},this.layers={}},L.plot=function(j,q){var Z=q[this.id],W=q._size;this._hasClipOnAxisFalse=!1;for(var G=0;G<j.length;G++)if(!1===j[G][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Z),this.adjustLayout(Z,W),p.generalUpdatePerTraceModule(this.graphDiv,this,j,Z),this.layers.plotbg.select("path").call(i.fill,Z.bgcolor)},L.makeFramework=function(j){var q=this.graphDiv,Z=j[this.id],W=this.clipId="clip"+this.layoutId+this.id,G=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=x.ensureSingleById(j._clips,"clipPath",W,function(X){X.append("path").attr("d","M0,0Z")}),this.clipDefRelative=x.ensureSingleById(j._clips,"clipPath",G,function(X){X.append("path").attr("d","M0,0Z")}),this.plotContainer=x.ensureSingle(this.container,"g",this.id),this.updateLayers(Z),c.setClipUrl(this.layers.backplot,W,q),c.setClipUrl(this.layers.grids,W,q)},L.updateLayers=function(j){var q=this.layers,Z=["draglayer","plotbg","backplot","grids"];"below traces"===j.aaxis.layer&&Z.push("aaxis","aline"),"below traces"===j.baxis.layer&&Z.push("baxis","bline"),"below traces"===j.caxis.layer&&Z.push("caxis","cline"),Z.push("frontplot"),"above traces"===j.aaxis.layer&&Z.push("aaxis","aline"),"above traces"===j.baxis.layer&&Z.push("baxis","bline"),"above traces"===j.caxis.layer&&Z.push("caxis","cline");var W=this.plotContainer.selectAll("g.toplevel").data(Z,String),G=["agrid","bgrid","cgrid"];W.enter().append("g").attr("class",function(X){return"toplevel "+X}).each(function(X){var ne=g.select(this);q[X]=ne,"frontplot"===X?ne.append("g").classed("scatterlayer",!0):"backplot"===X?ne.append("g").classed("maplayer",!0):"plotbg"===X?ne.append("path").attr("d","M0,0Z"):"aline"===X||"bline"===X||"cline"===X?ne.append("path"):"grids"===X&&G.forEach(function(V){q[V]=ne.append("g").classed("grid "+V,!0)})}),W.order()};var M=Math.sqrt(4/3);L.adjustLayout=function(j,q){var Z,W,G,X,ne,V,N=this,U=j.domain,ee=(U.x[0]+U.x[1])/2,B=(U.y[0]+U.y[1])/2,K=U.x[1]-U.x[0],J=U.y[1]-U.y[0],te=K*q.w,ae=J*q.h,ce=j.sum,oe=j.aaxis.min,ve=j.baxis.min,fe=j.caxis.min;te>M*ae?G=(X=ae)*M:X=(G=te)/M,ne=K*G/te,V=J*X/ae,W=q.t+q.h*(1-B)-X/2,N.x0=Z=q.l+q.w*ee-G/2,N.y0=W,N.w=G,N.h=X,N.sum=ce,N.xaxis={type:"linear",range:[oe+2*fe-ce,ce-oe-2*ve],domain:[ee-ne/2,ee+ne/2],_id:"x"},n(N.xaxis,N.graphDiv._fullLayout),N.xaxis.setScale(),N.xaxis.isPtWithinRange=function(De){return De.a>=N.aaxis.range[0]&&De.a<=N.aaxis.range[1]&&De.b>=N.baxis.range[1]&&De.b<=N.baxis.range[0]&&De.c>=N.caxis.range[1]&&De.c<=N.caxis.range[0]},N.yaxis={type:"linear",range:[oe,ce-ve-fe],domain:[B-V/2,B+V/2],_id:"y"},n(N.yaxis,N.graphDiv._fullLayout),N.yaxis.setScale(),N.yaxis.isPtWithinRange=function(){return!0};var xe=N.yaxis.domain[0],Se=N.aaxis=m({},j.aaxis,{range:[oe,ce-ve-fe],side:"left",tickangle:(+j.aaxis.tickangle||0)-30,domain:[xe,xe+V*M],anchor:"free",position:0,_id:"y",_length:G});n(Se,N.graphDiv._fullLayout),Se.setScale();var pe=N.baxis=m({},j.baxis,{range:[ce-oe-fe,ve],side:"bottom",domain:N.xaxis.domain,anchor:"free",position:0,_id:"x",_length:G});n(pe,N.graphDiv._fullLayout),pe.setScale();var ge=N.caxis=m({},j.caxis,{range:[ce-oe-ve,fe],side:"right",tickangle:(+j.caxis.tickangle||0)+30,domain:[xe,xe+V*M],anchor:"free",position:0,_id:"y",_length:G});n(ge,N.graphDiv._fullLayout),ge.setScale();var Te="M"+Z+","+(W+X)+"h"+G+"l-"+G/2+",-"+X+"Z";N.clipDef.select("path").attr("d",Te),N.layers.plotbg.select("path").attr("d",Te);var se="M0,"+X+"h"+G+"l-"+G/2+",-"+X+"Z";N.clipDefRelative.select("path").attr("d",se);var de=e(Z,W);N.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",de),N.clipDefRelative.select("path").attr("transform",null);var Ae=e(Z-pe._offset,W+X);N.layers.baxis.attr("transform",Ae),N.layers.bgrid.attr("transform",Ae);var Le=e(Z+G/2,W)+"rotate(30)"+e(0,-Se._offset);N.layers.aaxis.attr("transform",Le),N.layers.agrid.attr("transform",Le);var Me=e(Z+G/2,W)+"rotate(-30)"+e(0,-ge._offset);N.layers.caxis.attr("transform",Me),N.layers.cgrid.attr("transform",Me),N.drawAxes(!0),N.layers.aline.select("path").attr("d",Se.showline?"M"+Z+","+(W+X)+"l"+G/2+",-"+X:"M0,0").call(i.stroke,Se.linecolor||"#000").style("stroke-width",(Se.linewidth||0)+"px"),N.layers.bline.select("path").attr("d",pe.showline?"M"+Z+","+(W+X)+"h"+G:"M0,0").call(i.stroke,pe.linecolor||"#000").style("stroke-width",(pe.linewidth||0)+"px"),N.layers.cline.select("path").attr("d",ge.showline?"M"+(Z+G/2)+","+W+"l"+G/2+","+X:"M0,0").call(i.stroke,ge.linecolor||"#000").style("stroke-width",(ge.linewidth||0)+"px"),N.graphDiv._context.staticPlot||N.initInteractions(),c.setClipUrl(N.layers.frontplot,N._hasClipOnAxisFalse?null:N.clipId,N.graphDiv)},L.drawAxes=function(j){var q=this.graphDiv,Z=this.id.substr(7)+"title",W=this.layers,G=this.aaxis,X=this.baxis,ne=this.caxis;if(this.drawAx(G),this.drawAx(X),this.drawAx(ne),j){var V=Math.max(G.showticklabels?G.tickfont.size/2:0,(ne.showticklabels?.75*ne.tickfont.size:0)+("outside"===ne.ticks?.87*ne.ticklen:0)),N=(X.showticklabels?X.tickfont.size:0)+("outside"===X.ticks?X.ticklen:0)+3;W["a-title"]=a.draw(q,"a"+Z,{propContainer:G,propName:this.id+".aaxis.title",placeholder:r(q,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-G.title.font.size/3-V,"text-anchor":"middle"}}),W["b-title"]=a.draw(q,"b"+Z,{propContainer:X,propName:this.id+".baxis.title",placeholder:r(q,"Click to enter Component B title"),attributes:{x:this.x0-N,y:this.y0+this.h+.83*X.title.font.size+N,"text-anchor":"middle"}}),W["c-title"]=a.draw(q,"c"+Z,{propContainer:ne,propName:this.id+".caxis.title",placeholder:r(q,"Click to enter Component C title"),attributes:{x:this.x0+this.w+N,y:this.y0+this.h+.83*ne.title.font.size+N,"text-anchor":"middle"}})}},L.drawAx=function(j){var q,Z=this.graphDiv,W=j._name,G=W.charAt(0),X=j._id,ne=this.layers[W],V=G+"tickLayout",N=(q=j).ticks+String(q.ticklen)+String(q.showticklabels);this[V]!==N&&(ne.selectAll("."+X+"tick").remove(),this[V]=N),j.setScale();var U=s.calcTicks(j),ee=s.clipEnds(j,U),B=s.makeTransTickFn(j),K=s.getTickSigns(j)[2],J=x.deg2rad(30),te=K*(j.linewidth||1)/2,ae=K*j.ticklen,ce=this.w,oe=this.h,ve="b"===G?"M0,"+te+"l"+Math.sin(J)*ae+","+Math.cos(J)*ae:"M"+te+",0l"+Math.cos(J)*ae+","+-Math.sin(J)*ae,fe={a:"M0,0l"+oe+",-"+ce/2,b:"M0,0l-"+ce/2+",-"+oe,c:"M0,0l-"+oe+","+ce/2}[G];s.drawTicks(Z,j,{vals:"inside"===j.ticks?ee:U,layer:ne,path:ve,transFn:B,crisp:!1}),s.drawGrid(Z,j,{vals:ee,layer:this.layers[G+"grid"],path:fe,transFn:B,crisp:!1}),s.drawLabels(Z,j,{vals:U,layer:ne,transFn:B,labelFns:s.makeLabelFns(j,0,30)})};var P=w.MINZOOM/2+.87,z="m-0.87,.5h"+P+"v3h-"+(P+5.2)+"l"+(P/2+2.6)+",-"+(.87*P+4.5)+"l2.6,1.5l-"+P/2+","+.87*P+"Z",S="m0.87,.5h-"+P+"v3h"+(P+5.2)+"l-"+(P/2+2.6)+",-"+(.87*P+4.5)+"l-2.6,1.5l"+P/2+","+.87*P+"Z",C="m0,1l"+P/2+","+.87*P+"l2.6,-1.5l-"+(P/2+2.6)+",-"+(.87*P+4.5)+"l-"+(P/2+2.6)+","+(.87*P+4.5)+"l2.6,1.5l"+P/2+",-"+.87*P+"Z",R=!0;function D(j){g.select(j).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearOutline=function(){b(this.dragOptions),_(this.dragOptions.gd)},L.initInteractions=function(){var j,q,Z,W,G,X,ne,V,N,U,ee,B,K=this,J=K.layers.plotbg.select("path").node(),te=K.graphDiv,ae=te._fullLayout._zoomlayer;function ce(se){var de={};return de[K.id+".aaxis.min"]=se.a,de[K.id+".baxis.min"]=se.b,de[K.id+".caxis.min"]=se.c,de}function oe(se,de){var Ae=te._fullLayout.clickmode;D(te),2===se&&(te.emit("plotly_doubleclick",null),k.call("_guiRelayout",te,ce({a:0,b:0,c:0}))),Ae.indexOf("select")>-1&&1===se&&h(de,te,[K.xaxis],[K.yaxis],K.id,K.dragOptions),Ae.indexOf("event")>-1&&l.click(te,de,K.id)}function ve(se,de){return 1-de/K.h}function fe(se,de){return 1-(se+(K.h-de)/Math.sqrt(3))/K.w}function xe(se,de){return(se-(K.h-de)/Math.sqrt(3))/K.w}function Se(se,de){var Ae=Z+se*j,Le=W+de*q,Me=Math.max(0,Math.min(1,ve(0,W),ve(0,Le))),De=Math.max(0,Math.min(1,fe(Z,W),fe(Ae,Le))),Oe=Math.max(0,Math.min(1,xe(Z,W),xe(Ae,Le))),Ie=(Me/2+Oe)*K.w,Qe=(1-Me/2-De)*K.w,Ne=(Ie+Qe)/2,Pe=Qe-Ie,Re=(1-Me)*K.h,Ge=Re-Pe/M;Pe<w.MINZOOM?(ne=G,ee.attr("d",N),B.attr("d","M0,0Z")):(ne={a:G.a+Me*X,b:G.b+De*X,c:G.c+Oe*X},ee.attr("d",N+"M"+Ie+","+Re+"H"+Qe+"L"+Ne+","+Ge+"L"+Ie+","+Re+"Z"),B.attr("d","M"+Z+","+W+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Ie+","+Re+z+"M"+Qe+","+Re+S+"M"+Ne+","+Ge+C)),U||(ee.transition().style("fill",V>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),B.transition().style("opacity",1).duration(200),U=!0),te.emit("plotly_relayouting",ce(ne))}function pe(){D(te),ne!==G&&(k.call("_guiRelayout",te,ce(ne)),R&&te.data&&te._context.showTips&&(x.notifier(r(te,"Double-click to zoom back out"),"long"),R=!1))}function ge(se,de){var Ae=se/K.xaxis._m,Le=de/K.yaxis._m,Me=[(ne={a:G.a-Le,b:G.b+(Ae+Le)/2,c:G.c-(Ae-Le)/2}).a,ne.b,ne.c].sort(x.sorterAsc),De=Me.indexOf(ne.a),Oe=Me.indexOf(ne.b),Ie=Me.indexOf(ne.c);Me[0]<0&&(Me[1]+Me[0]/2<0?(Me[2]+=Me[0]+Me[1],Me[0]=Me[1]=0):(Me[2]+=Me[0]/2,Me[1]+=Me[0]/2,Me[0]=0),de=(G.a-(ne={a:Me[De],b:Me[Oe],c:Me[Ie]}).a)*K.yaxis._m,se=(G.c-ne.c-G.b+ne.b)*K.xaxis._m);var Qe=e(K.x0+se,K.y0+de);K.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Qe);var Ne=e(-se,-de);K.clipDefRelative.select("path").attr("transform",Ne),K.aaxis.range=[ne.a,K.sum-ne.b-ne.c],K.baxis.range=[K.sum-ne.a-ne.c,ne.b],K.caxis.range=[K.sum-ne.a-ne.b,ne.c],K.drawAxes(!1),K._hasClipOnAxisFalse&&K.plotContainer.select(".scatterlayer").selectAll(".trace").call(c.hideOutsideRangePoints,K),te.emit("plotly_relayouting",ce(ne))}function Te(){k.call("_guiRelayout",te,ce(ne))}this.dragOptions={element:J,gd:te,plotinfo:{id:K.id,domain:te._fullLayout[K.id].domain,xaxis:K.xaxis,yaxis:K.yaxis},subplot:K.id,prepFn:function(se,de,Ae){K.dragOptions.xaxes=[K.xaxis],K.dragOptions.yaxes=[K.yaxis],j=te._fullLayout._invScaleX,q=te._fullLayout._invScaleY;var Le=K.dragOptions.dragmode=te._fullLayout.dragmode;K.dragOptions.minDrag=d(Le)?1:void 0,"zoom"===Le?(K.dragOptions.moveFn=Se,K.dragOptions.clickFn=oe,K.dragOptions.doneFn=pe,function(Me,De,Oe){var Ie=J.getBoundingClientRect();Z=De-Ie.left,W=Oe-Ie.top,te._fullLayout._calcInverseTransform(te);var Ne=x.apply3DTransform(te._fullLayout._invTransform)(Z,W);Z=Ne[0],W=Ne[1],ne=G={a:K.aaxis.range[0],b:K.baxis.range[1],c:K.caxis.range[1]},X=K.aaxis.range[1]-G.a,V=t(K.graphDiv._fullLayout[K.id].bgcolor).getLuminance(),N="M0,"+K.h+"L"+K.w/2+", 0L"+K.w+","+K.h+"Z",U=!1,ee=ae.append("path").attr("class","zoombox").attr("transform",e(K.x0,K.y0)).style({fill:V>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",N),B=ae.append("path").attr("class","zoombox-corners").attr("transform",e(K.x0,K.y0)).style({fill:i.background,stroke:i.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),K.clearOutline(te)}(0,de,Ae)):"pan"===Le?(K.dragOptions.moveFn=ge,K.dragOptions.clickFn=oe,K.dragOptions.doneFn=Te,ne=G={a:K.aaxis.range[0],b:K.baxis.range[1],c:K.caxis.range[1]},K.clearOutline(te)):(u(Le)||d(Le))&&y(se,de,Ae,K.dragOptions,Le)}},J.onmousemove=function(se){l.hover(te,se,K.id),te._fullLayout._lasthover=J,te._fullLayout._hoversubplot=K.id},J.onmouseout=function(se){te._dragging||f.unhover(te,se)},f.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(v,Q,$){"use strict";var g=v("./lib/loggers"),t=v("./lib/noop"),k=v("./lib/push_unique"),x=v("./lib/is_plain_object"),e=v("./lib/dom").addStyleRule,r=v("./lib/extend"),i=v("./plots/attributes"),c=v("./plots/layout_attributes"),n=r.extendFlat,m=r.extendDeepAll;function p(h){var _=h.name,b=h.categories,w=h.meta;if($.modules[_])g.log("Type "+_+" already registered");else{$.subplotsRegistry[h.basePlotModule.name]||function(R){var D=R.name;if($.subplotsRegistry[D])g.log("Plot type "+D+" already registered.");else for(var j in o(R),$.subplotsRegistry[D]=R,$.componentsRegistry)a(j,R.name)}(h.basePlotModule);for(var T={},L=0;L<b.length;L++)T[b[L]]=!0,$.allCategories[b[L]]=!0;for(var M in $.modules[_]={_module:h,categories:T},w&&Object.keys(w).length&&($.modules[_].meta=w),$.allTypes.push(_),$.componentsRegistry)d(M,_);h.layoutAttributes&&n($.traceLayoutAttributes,h.layoutAttributes);var P=h.basePlotModule,z=P.name;if("mapbox"===z){var S=P.constants.styleRules;for(var C in S)e(".js-plotly-plot .plotly .mapboxgl-"+C,S[C])}"geo"!==z&&"mapbox"!==z||void 0!==window.PlotlyGeoAssets||(window.PlotlyGeoAssets={topojson:{}})}}function s(h){if("string"!=typeof h.name)throw new Error("Component module *name* must be a string.");var _=h.name;for(var b in $.componentsRegistry[_]=h,h.layoutAttributes&&(h.layoutAttributes._isLinkedToArray&&k($.layoutArrayContainers,_),o(h)),$.modules)d(_,b);for(var w in $.subplotsRegistry)a(_,w);for(var T in $.transformsRegistry)u(_,T);h.schema&&h.schema.layout&&m(c,h.schema.layout)}function f(h){if("string"!=typeof h.name)throw new Error("Transform module *name* must be a string.");var _="Transform module "+h.name,b="function"==typeof h.transform,w="function"==typeof h.calcTransform;if(!b&&!w)throw new Error(_+" is missing a *transform* or *calcTransform* method.");for(var T in b&&w&&g.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),x(h.attributes)||g.log(_+" registered without an *attributes* object."),"function"!=typeof h.supplyDefaults&&g.log(_+" registered without a *supplyDefaults* method."),$.transformsRegistry[h.name]=h,$.componentsRegistry)u(T,h.name)}function l(h){var _=h.name,b=_.split("-")[0],w=h.dictionary,T=h.format,L=w&&Object.keys(w).length,M=T&&Object.keys(T).length,P=$.localeRegistry,z=P[_];if(z||(P[_]=z={}),b!==_){var S=P[b];S||(P[b]=S={}),L&&S.dictionary===z.dictionary&&(S.dictionary=w),M&&S.format===z.format&&(S.format=T)}L&&(z.dictionary=w),M&&(z.format=T)}function o(h){if(h.layoutAttributes){var _=h.layoutAttributes._arrayAttrRegexps;if(_)for(var b=0;b<_.length;b++)k($.layoutArrayRegexes,_[b])}}function d(h,_){var b=$.componentsRegistry[h].schema;if(b&&b.traces){var w=b.traces[_];w&&m($.modules[_]._module.attributes,w)}}function u(h,_){var b=$.componentsRegistry[h].schema;if(b&&b.transforms){var w=b.transforms[_];w&&m($.transformsRegistry[_].attributes,w)}}function a(h,_){var b=$.componentsRegistry[h].schema;if(b&&b.subplots){var w=$.subplotsRegistry[_],T=w.layoutAttributes,L="subplot"===w.attr?w.name:w.attr;Array.isArray(L)&&(L=L[0]);var M=b.subplots[L];T&&M&&m(T,M)}}function y(h){return"object"==typeof h&&(h=h.type),h}$.modules={},$.allCategories={},$.allTypes=[],$.subplotsRegistry={},$.transformsRegistry={},$.componentsRegistry={},$.layoutArrayContainers=[],$.layoutArrayRegexes=[],$.traceLayoutAttributes={},$.localeRegistry={},$.apiMethodRegistry={},$.collectableSubplotTypes=null,$.register=function(h){if($.collectableSubplotTypes=null,!h)throw new Error("No argument passed to Plotly.register.");h&&!Array.isArray(h)&&(h=[h]);for(var _=0;_<h.length;_++){var b=h[_];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":p(b);break;case"transform":f(b);break;case"component":s(b);break;case"locale":l(b);break;case"apiMethod":$.apiMethodRegistry[b.name]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},$.getModule=function(h){var _=$.modules[y(h)];return!!_&&_._module},$.traceIs=function(h,_){if("various"===(h=y(h)))return!1;var b=$.modules[h];return b||(h&&g.log("Unrecognized trace type "+h+"."),b=$.modules[i.type.dflt]),!!b.categories[_]},$.getTransformIndices=function(h,_){for(var b=[],w=h.transforms||[],T=0;T<w.length;T++)w[T].type===_&&b.push(T);return b},$.hasTransform=function(h,_){for(var b=h.transforms||[],w=0;w<b.length;w++)if(b[w].type===_)return!0;return!1},$.getComponentMethod=function(h,_){var b=$.componentsRegistry[h];return b&&b[_]||t},$.call=function(){var h=arguments[0],_=[].slice.call(arguments,1);return $.apiMethodRegistry[h].apply(null,_)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(v,Q,$){"use strict";var g=v("../registry"),t=v("../lib"),k=t.extendFlat,x=t.extendDeep;function e(r){var i;switch(r){case"themes__thumb":i={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":i={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:i={}}return i}Q.exports=function(r,i){var c,p=r.layout,s=x([],r.data),f=x({},p,e(i.tileClass)),l=r._context||{};if(i.width&&(f.width=i.width),i.height&&(f.height=i.height),"thumbnail"===i.tileClass||"themes__thumb"===i.tileClass){f.annotations=[];var o=Object.keys(f);for(c=0;c<o.length;c++)["xaxis","yaxis","zaxis"].indexOf(o[c].slice(0,5))>-1&&(f[o[c]].title={text:""});for(c=0;c<s.length;c++){var d=s[c];d.showscale=!1,d.marker&&(d.marker.showscale=!1),g.traceIs(d,"pie-like")&&(d.textposition="none")}}if(Array.isArray(i.annotations))for(c=0;c<i.annotations.length;c++)f.annotations.push(i.annotations[c]);var u=Object.keys(f).filter(function(b){return b.match(/^scene\d*$/)});if(u.length){var a={};for("thumbnail"===i.tileClass&&(a={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),c=0;c<u.length;c++){var y=f[u[c]];y.xaxis||(y.xaxis={}),y.yaxis||(y.yaxis={}),y.zaxis||(y.zaxis={}),k(y.xaxis,a),k(y.yaxis,a),k(y.zaxis,a),y._scene=null}}var h=document.createElement("div");i.tileClass&&(h.className=i.tileClass);var _={gd:h,td:h,layout:f,data:s,config:{staticPlot:void 0===i.staticPlot||i.staticPlot,plotGlPixelRatio:void 0===i.plotGlPixelRatio?2:i.plotGlPixelRatio,displaylogo:i.displaylogo||!1,showLink:i.showLink||!1,showTips:i.showTips||!1,mapboxAccessToken:l.mapboxAccessToken}};return"transparent"!==i.setBackground&&(_.config.setBackground=i.setBackground||"opaque"),_.gd.defaultLayout=e(i.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plot_api/to_image"),k=v("./filesaver"),x=v("./helpers");Q.exports=function(e,r){var i;return g.isPlainObject(e)||(i=g.getGraphDiv(e)),(r=r||{}).format=r.format||"png",r.width=r.width||null,r.height=r.height||null,r.imageDataOnly=!0,new Promise(function(c,n){i&&i._snapshotInProgress&&n(new Error("Snapshotting already in progress.")),g.isIE()&&"svg"!==r.format&&n(new Error(x.MSG_IE_BAD_FORMAT)),i&&(i._snapshotInProgress=!0);var m=t(e,r),p=r.filename||e.fn||"newplot";p+="."+r.format.replace("-","."),m.then(function(s){return i&&(i._snapshotInProgress=!1),k(s,p,r.format)}).then(function(s){c(s)}).catch(function(s){i&&(i._snapshotInProgress=!1),n(s)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("./helpers");Q.exports=function(k,x,e){var r=document.createElement("a"),i="download"in r;return new Promise(function(c,n){var m,p;return g.isIE()?(m=t.createBlob(k,"svg"),window.navigator.msSaveBlob(m,x),m=null,c(x)):i?(m=t.createBlob(k,e),p=t.createObjectURL(m),r.href=p,r.download=x,document.body.appendChild(r),r.click(),document.body.removeChild(r),t.revokeObjectURL(p),m=null,c(x)):g.isSafari()?(t.octetStream(("svg"===e?",":";base64,")+encodeURIComponent(k)),c(x)):void n(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(v,Q,$){"use strict";var g=v("../registry");$.getDelay=function(k){return k._has&&(k._has("gl3d")||k._has("gl2d")||k._has("mapbox"))?500:0},$.getRedrawFunc=function(k){return function(){g.getComponentMethod("colorbar","draw")(k)}},$.encodeSVG=function(k){return"data:image/svg+xml,"+encodeURIComponent(k)},$.encodeJSON=function(k){return"data:application/json,"+encodeURIComponent(k)};var t=window.URL||window.webkitURL;$.createObjectURL=function(k){return t.createObjectURL(k)},$.revokeObjectURL=function(k){return t.revokeObjectURL(k)},$.createBlob=function(k,x){if("svg"===x)return new window.Blob([k],{type:"image/svg+xml;charset=utf-8"});if("full-json"===x)return new window.Blob([k],{type:"application/json;charset=utf-8"});var e=function(r){for(var i=r.length,c=new ArrayBuffer(i),n=new Uint8Array(c),m=0;m<i;m++)n[m]=r.charCodeAt(m);return c}(window.atob(k));return new window.Blob([e],{type:"image/"+x})},$.octetStream=function(k){document.location.href="data:application/octet-stream"+k},$.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,$.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(v,Q,$){"use strict";var g=v("./helpers"),t={getDelay:g.getDelay,getRedrawFunc:g.getRedrawFunc,clone:v("./cloneplot"),toSVG:v("./tosvg"),svgToImg:v("./svgtoimg"),toImage:v("./toimage"),downloadImage:v("./download")};Q.exports=t},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("events").EventEmitter,k=v("./helpers");Q.exports=function(x){var e=x.emitter||new t,r=new Promise(function(i,c){var n=window.Image,m=x.svg,p=x.format||"png";if(g.isIE()&&"svg"!==p){var s=new Error(k.MSG_IE_BAD_FORMAT);return c(s),x.promise?r:e.emit("error",s)}var f,l,o=x.canvas,d=x.scale||1,y=d*(x.width||300),h=d*(x.height||150),_=o.getContext("2d",{willReadFrequently:!0}),b=new n;"svg"===p||g.isSafari()?l=k.encodeSVG(m):(f=k.createBlob(m,"svg"),l=k.createObjectURL(f)),o.width=y,o.height=h,b.onload=function(){var w;switch(f=null,k.revokeObjectURL(l),"svg"!==p&&_.drawImage(b,0,0,y,h),p){case"jpeg":w=o.toDataURL("image/jpeg");break;case"png":w=o.toDataURL("image/png");break;case"webp":w=o.toDataURL("image/webp");break;case"svg":w=l;break;default:var T="Image format is not jpeg, png, svg or webp.";if(c(new Error(T)),!x.promise)return e.emit("error",T)}i(w),x.promise||e.emit("success",w)},b.onerror=function(w){if(f=null,k.revokeObjectURL(l),c(w),!x.promise)return e.emit("error",w)},b.src=l});return x.promise?r:e}},{"../lib":515,"./helpers":651,events:84}],654:[function(v,Q,$){"use strict";var g=v("events").EventEmitter,t=v("../registry"),k=v("../lib"),x=v("./helpers"),e=v("./cloneplot"),r=v("./tosvg"),i=v("./svgtoimg");Q.exports=function(c,n){var m=new g,p=e(c,{format:"png"}),s=p.gd;s.style.position="absolute",s.style.left="-5000px",document.body.appendChild(s);var f=x.getRedrawFunc(s);return t.call("_doPlot",s,p.data,p.layout,p.config).then(f).then(function(){var l=x.getDelay(s._fullLayout);setTimeout(function(){var o=r(s),d=document.createElement("canvas");d.id=k.randstr(),(m=i({format:n.format,width:s._fullLayout.width,height:s._fullLayout.height,canvas:d,emitter:m,svg:o})).clean=function(){s&&document.body.removeChild(s)}},l)}).catch(function(l){m.emit("error",l)}),m}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../lib"),k=v("../components/drawing"),x=v("../components/color"),e=v("../constants/xmlns_namespaces"),r=/"/g,i=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");Q.exports=function(c,n,m){var p,s=c._fullLayout,f=s._paper,l=s._toppaper,o=s.width,d=s.height;f.insert("rect",":first-child").call(k.setRect,0,0,o,d).call(x.fill,s.paper_bgcolor);var u=s._basePlotModules||[];for(p=0;p<u.length;p++){var a=u[p];a.toSVG&&a.toSVG(c)}if(l){var y=l.node().childNodes,h=Array.prototype.slice.call(y);for(p=0;p<h.length;p++){var _=h[p];_.childNodes.length&&f.node().appendChild(_)}}s._draggers&&s._draggers.remove(),f.node().style.background="",f.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var w=g.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){w.style({visibility:null,display:null});var T=this.style.fontFamily;T&&-1!==T.indexOf('"')&&w.style("font-family",T.replace(r,"TOBESTRIPPED"))}else w.remove()}),f.selectAll(".gradient_filled,.pattern_filled").each(function(){var w=g.select(this),T=this.style.fill;T&&-1!==T.indexOf("url(")&&w.style("fill",T.replace(r,"TOBESTRIPPED"));var L=this.style.stroke;L&&-1!==L.indexOf("url(")&&w.style("stroke",L.replace(r,"TOBESTRIPPED"))}),"pdf"!==n&&"eps"!==n||f.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),f.node().setAttributeNS(e.xmlns,"xmlns",e.svg),f.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),"svg"===n&&m&&(f.attr("width",m*o),f.attr("height",m*d),f.attr("viewBox","0 0 "+o+" "+d));var w,T,L,b=(new window.XMLSerializer).serializeToString(f.node());return w=b,T=g.select("body").append("div").style({display:"none"}).html(""),L=w.replace(/(&[^;]*;)/gi,function(M){return"&lt;"===M?"&#60;":"&rt;"===M?"&#62;":-1!==M.indexOf("<")||-1!==M.indexOf(">")?"":T.html(M).text()}),T.remove(),b=(b=(b=L).replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(i,"'"),t.isIE()&&(b=(b=(b=b.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),b}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){for(var x=0;x<t.length;x++)t[x].i=x;g.mergeArray(k.text,t,"tx"),g.mergeArray(k.hovertext,t,"htx");var e=k.marker;if(e){g.mergeArray(e.opacity,t,"mo",!0),g.mergeArray(e.color,t,"mc");var r=e.line;r&&(g.mergeArray(r.color,t,"mlc"),g.mergeArrayCastPositive(r.width,t,"mlw"))}}},{"../../lib":515}],657:[function(v,Q,$){"use strict";var g=v("../scatter/attributes"),t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../components/colorscale/attributes"),r=v("../../plots/font_attributes"),i=v("./constants"),c=v("../../components/drawing/attributes").pattern,n=v("../../lib/extend").extendFlat,m=r({editType:"calc",arrayOk:!0,colorEditType:"style"}),p=n({},g.marker.line.width,{dflt:0}),s=n({width:p,editType:"calc"},e("marker.line")),f=n({line:s,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:c});Q.exports={x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:t("x"),yhoverformat:t("y"),text:g.text,texttemplate:x({editType:"plot"},{keys:i.eventDataKeys}),hovertext:g.hovertext,hovertemplate:k({},{keys:i.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:n({},m,{}),insidetextfont:n({},m,{}),outsidetextfont:n({},m,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:n({},g.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:f,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:g.selected.marker.opacity,color:g.selected.marker.color,editType:"style"},textfont:g.selected.textfont,editType:"style"},unselected:{marker:{opacity:g.unselected.marker.opacity,color:g.unselected.marker.color,editType:"style"},textfont:g.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../plots/cartesian/align_period"),k=v("../../components/colorscale/helpers").hasColorscale,x=v("../../components/colorscale/calc"),e=v("./arrays_to_calcdata"),r=v("../scatter/calc_selection");Q.exports=function(i,c){var n,m,p,s,f,l,o=g.getFromId(i,c.xaxis||"x"),d=g.getFromId(i,c.yaxis||"y"),u={msUTC:!(!c.base&&0!==c.base)};"h"===c.orientation?(n=o.makeCalcdata(c,"x",u),p=d.makeCalcdata(c,"y"),s=t(c,d,"y",p),f=!!c.yperiodalignment,l="y"):(n=d.makeCalcdata(c,"y",u),p=o.makeCalcdata(c,"x"),s=t(c,o,"x",p),f=!!c.xperiodalignment,l="x"),m=s.vals;for(var a=Math.min(m.length,n.length),y=new Array(a),h=0;h<a;h++)y[h]={p:m[h],s:n[h]},f&&(y[h].orig_p=p[h],y[h][l+"End"]=s.ends[h],y[h][l+"Start"]=s.starts[h]),c.ids&&(y[h].id=String(c.ids[h]));return k(c,"marker")&&x(i,c,{vals:c.marker.color,containerStr:"marker",cLetter:"c"}),k(c,"marker.line")&&x(i,c,{vals:c.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(y,c),r(y,c),y}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(v,Q,$){"use strict";Q.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib").isArrayOrTypedArray,k=v("../../constants/numerical").BADNUM,x=v("../../registry"),e=v("../../plots/cartesian/axes"),r=v("../../plots/cartesian/constraints").getAxisGroup,i=v("./sieve.js");function c(a,y,h,_,b){if(_.length){var w,T,L,M;switch(function(P,z){var S,C;for(S=0;S<z.length;S++){var R,D=z[S],j=D[0].trace,q="funnel"===j.type?j._base:j.base,Z="h"===j.orientation?j.xcalendar:j.ycalendar,W="category"===P.type||"multicategory"===P.type?function(){return null}:P.d2c;if(t(q)){for(C=0;C<Math.min(q.length,D.length);C++)R=W(q[C],0,Z),g(R)?(D[C].b=+R,D[C].hasB=1):D[C].b=0;for(;C<D.length;C++)D[C].b=0}else{R=W(q,0,Z);var G=g(R);for(R=G?R:0,C=0;C<D.length;C++)D[C].b=R,G&&(D[C].hasB=1)}}}(h,_),b.mode){case"overlay":n(y,h,_,b);break;case"group":for(w=[],T=[],L=0;L<_.length;L++)void 0===(M=_[L])[0].trace.offset?T.push(M):w.push(M);T.length&&(P=a,S=h,D=new i(T,{posAxis:z=y,sepNegVal:!1,overlapNoMerge:!(R=b).norm}),function(j,q,Z,W){for(var G=j._fullLayout,V=Z.minDiff,N=Z.traces,U=N.length,ee=Z.positions.length!==Z.distinctPositions.length,B=V*(1-W.gap),K=r(G,q._id)+N[0][0].trace.orientation,J=G._alignmentOpts[K]||{},te=0;te<U;te++){var ae,ce,oe=N[te],ve=oe[0].trace,xe=Object.keys((J[ve.alignmentgroup]||{}).offsetGroups||{}).length,Se=(ae=xe?B/xe:ee?B/U:B)*(1-(W.groupgap||0));ce=xe?((2*ve._offsetIndex+1-xe)*ae-Se)/2:ee?((2*te+1-U)*ae-Se)/2:-Se/2;var pe=oe[0].t;pe.barwidth=Se,pe.poffset=ce,pe.bargroupwidth=B,pe.bardelta=V}Z.binWidth=N[0][0].t.barwidth/100,p(Z),s(q,Z),f(q,Z,ee)}(P,z,D,R),function(j,q){for(var Z=j.traces,W=0;W<Z.length;W++){var G=Z[W];if(void 0===G[0].trace.base)for(var X=new i([G],{posAxis:q,sepNegVal:!0,overlapNoMerge:!0}),ne=0;ne<G.length;ne++){var V=G[ne];if(V.p!==k){var N=X.put(V.p,V.b+V.s);N&&(V.b=N)}}}}(D,z),R.norm?(o(D),d(S,D,R)):l(S,D)),w.length&&n(y,h,w,b);break;case"stack":case"relative":for(w=[],T=[],L=0;L<_.length;L++)void 0===(M=_[L])[0].trace.base?T.push(M):w.push(M);T.length&&function(P,z,S,C,R){var D=new i(C,{posAxis:z,sepNegVal:"relative"===R.mode,overlapNoMerge:!(R.norm||"stack"===R.mode||"relative"===R.mode)});m(z,D,R),function(G,X,ne){var V,N,U,ee,B,K,J=u(G),te=X.traces;for(ee=0;ee<te.length;ee++)if("funnel"===(N=(V=te[ee])[0].trace).type)for(B=0;B<V.length;B++)(K=V[B]).s!==k&&X.put(K.p,-.5*K.s);for(ee=0;ee<te.length;ee++){U="funnel"===(N=(V=te[ee])[0].trace).type;var ae=[];for(B=0;B<V.length;B++)if((K=V[B]).s!==k){var ce,oe=X.put(K.p,ce=U?K.s:K.s+K.b),ve=oe+ce;K.b=oe,K[J]=ve,ne.norm||(ae.push(ve),K.hasB&&ae.push(oe))}ne.norm||(N._extremes[G._id]=e.findExtremes(G,ae,{tozero:!0,padded:!0}))}}(S,D,R);for(var j=0;j<C.length;j++)for(var q=C[j],Z=0;Z<q.length;Z++){var W=q[Z];W.s!==k&&W.b+W.s===D.get(W.p,W.s)&&(W._outmost=!0)}R.norm&&d(S,D,R)}(0,y,h,T,b),w.length&&n(y,h,w,b)}!function(P,z){var S,C,R,D=u(z),j={},q=1/0,Z=-1/0;for(S=0;S<P.length;S++)for(R=P[S],C=0;C<R.length;C++){var W=R[C].p;g(W)&&(q=Math.min(q,W),Z=Math.max(Z,W))}var G=1e4/(Z-q),X=j.round=function(K){return String(Math.round(G*(K-q)))};for(S=0;S<P.length;S++){(R=P[S])[0].t.extents=j;var ne=R[0].t.poffset,V=Array.isArray(ne);for(C=0;C<R.length;C++){var N=R[C],U=N[D]-N.w/2;if(g(U)){var ee=N[D]+N.w/2,B=X(N.p);j[B]=j[B]?[Math.min(U,j[B][0]),Math.max(ee,j[B][1])]:[U,ee]}N.p0=N.p+(V?ne[C]:ne),N.p1=N.p0+N.w,N.s0=N.b,N.s1=N.s0+N.s}}}(_,y)}var P,z,S,R,D}function n(a,y,h,_){for(var b=0;b<h.length;b++){var T=new i([h[b]],{posAxis:a,sepNegVal:!1,overlapNoMerge:!_.norm});m(a,T,_),_.norm?(o(T),d(y,T,_)):l(y,T)}}function m(a,y,h){for(var _=y.minDiff,b=y.traces,w=_*(1-h.gap),T=w*(1-(h.groupgap||0)),L=-T/2,M=0;M<b.length;M++){var P=b[M][0].t;P.barwidth=T,P.poffset=L,P.bargroupwidth=w,P.bardelta=_}y.binWidth=b[0][0].t.barwidth/100,p(y),s(a,y),f(a,y)}function p(a){var y,h,_=a.traces;for(y=0;y<_.length;y++){var b,w=_[y],T=w[0],L=T.trace,M=T.t,P=L._offset||L.offset,z=M.poffset;if(t(P)){for(b=Array.prototype.slice.call(P,0,w.length),h=0;h<b.length;h++)g(b[h])||(b[h]=z);for(h=b.length;h<w.length;h++)b.push(z);M.poffset=b}else void 0!==P&&(M.poffset=P);var S=L._width||L.width,C=M.barwidth;if(t(S)){var R=Array.prototype.slice.call(S,0,w.length);for(h=0;h<R.length;h++)g(R[h])||(R[h]=C);for(h=R.length;h<w.length;h++)R.push(C);if(M.barwidth=R,void 0===P){for(b=[],h=0;h<w.length;h++)b.push(z+(C-R[h])/2);M.poffset=b}}else void 0!==S&&(M.barwidth=S,void 0===P&&(M.poffset=z+(C-S)/2))}}function s(a,y){for(var h=y.traces,_=u(a),b=0;b<h.length;b++)for(var w=h[b],T=w[0].t,L=T.poffset,M=Array.isArray(L),P=T.barwidth,z=Array.isArray(P),S=0;S<w.length;S++){var C=w[S],R=C.w=z?P[S]:P;C[_]=C.p+(M?L[S]:L)+R/2}}function f(a,y,h){var _=y.traces,b=y.minDiff/2;e.minDtick(a,y.minDiff,y.distinctPositions[0],h);for(var w=0;w<_.length;w++){var T,L,M,P,z=_[w],S=z[0],C=S.trace,R=[];for(P=0;P<z.length;P++)L=(T=z[P]).p-b,R.push(L,M=T.p+b);if(C.width||C.offset){var D=S.t,j=D.poffset,q=D.barwidth,Z=Array.isArray(j),W=Array.isArray(q);for(P=0;P<z.length;P++)M=(L=(T=z[P]).p+(Z?j[P]:j))+(W?q[P]:q),R.push(L,M)}C._extremes[a._id]=e.findExtremes(a,R,{padded:!1})}}function l(a,y){for(var h=y.traces,_=u(a),b=0;b<h.length;b++){for(var w=h[b],T=w[0].trace,L=[],M=!1,P=0;P<w.length;P++){var z=w[P],S=z.b,C=S+z.s;z[_]=C,L.push(C),z.hasB&&L.push(S),z.hasB&&z.b||(M=!0)}T._extremes[a._id]=e.findExtremes(a,L,{tozero:M,padded:!0})}}function o(a){for(var y=a.traces,h=0;h<y.length;h++)for(var _=y[h],b=0;b<_.length;b++){var w=_[b];w.s!==k&&a.put(w.p,w.b+w.s)}}function d(a,y,h){var _=y.traces,b=u(a),w="fraction"===h.norm?1:100,T=w/1e9,L=a.l2c(a.c2l(0)),M="stack"===h.mode?w:L;function P(ne){return g(a.c2l(ne))&&(ne<L-T||ne>M+T||!g(L))}for(var z=0;z<_.length;z++){for(var S=_[z],C=S[0].trace,R=[],D=!1,j=!1,q=0;q<S.length;q++){var Z=S[q];if(Z.s!==k){var W=Math.abs(w/y.get(Z.p,Z.s));Z.b*=W,Z.s*=W;var G=Z.b,X=G+Z.s;Z[b]=X,R.push(X),j=j||P(X),Z.hasB&&(R.push(G),j=j||P(G)),Z.hasB&&Z.b||(D=!0)}}C._extremes[a._id]=e.findExtremes(a,R,{tozero:D,padded:j})}}function u(a){return a._id.charAt(0)}Q.exports={crossTraceCalc:function(a,y){for(var h=y.xaxis,_=y.yaxis,b=a._fullLayout,w=a._fullData,T=a.calcdata,L=[],M=[],P=0;P<w.length;P++){var z=w[P];if(!0===z.visible&&x.traceIs(z,"bar")&&z.xaxis===h._id&&z.yaxis===_._id&&("h"===z.orientation?L.push(T[P]):M.push(T[P]),z._computePh))for(var S=a.calcdata[P],C=0;C<S.length;C++)"function"==typeof S[C].ph0&&(S[C].ph0=S[C].ph0()),"function"==typeof S[C].ph1&&(S[C].ph1=S[C].ph1())}var R={xCat:"category"===h.type||"multicategory"===h.type,yCat:"category"===_.type||"multicategory"===_.type,mode:b.barmode,norm:b.barnorm,gap:b.bargap,groupgap:b.bargroupgap};c(a,h,_,M,R),c(a,_,h,L,R)},setGroupPositions:c}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../../registry"),x=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),r=v("./style_defaults"),i=v("../../plots/cartesian/constraints").getAxisGroup,c=v("./attributes"),n=g.coerceFont;function m(s,f,l,o){var d=f.orientation,a=i(l,f[{v:"x",h:"y"}[d]+"axis"])+d,y=l._alignmentOpts||{},h=o("alignmentgroup"),_=y[a];_||(_=y[a]={});var b=_[h];b?b.traces.push(f):b=_[h]={traces:[f],alignmentIndex:Object.keys(_).length,offsetGroups:{}};var w=o("offsetgroup"),T=b.offsetGroups,L=T[w];w&&(L||(L=T[w]={offsetIndex:Object.keys(T).length}),f._offsetIndex=L.offsetIndex)}function p(s,f,l,o,d,u){var a=!1!==(u=u||{}).moduleHasSelected,y=!1!==u.moduleHasUnselected,h=!1!==u.moduleHasConstrain,_=!1!==u.moduleHasCliponaxis,b=!1!==u.moduleHasTextangle,w=!1!==u.moduleHasInsideanchor,T=!!u.hasPathbar,L=Array.isArray(d)||"auto"===d,M=L||"inside"===d,P=L||"outside"===d;if(M||P){var z=n(o,"textfont",l.font),S=g.extendFlat({},z),C=!(s.textfont&&s.textfont.color);if(C&&delete S.color,n(o,"insidetextfont",S),T){var R=g.extendFlat({},z);C&&delete R.color,n(o,"pathbar.textfont",R)}P&&n(o,"outsidetextfont",z),a&&o("selected.textfont.color"),y&&o("unselected.textfont.color"),h&&o("constraintext"),_&&o("cliponaxis"),b&&o("textangle"),o("texttemplate")}M&&w&&o("insidetextanchor")}Q.exports={supplyDefaults:function(s,f,l,o){function d(h,_){return g.coerce(s,f,c,h,_)}if(x(s,f,o,d)){e(s,f,o,d),d("xhoverformat"),d("yhoverformat"),d("orientation",f.x&&!f.y?"h":"v"),d("base"),d("offset"),d("width"),d("text"),d("hovertext"),d("hovertemplate");var u=d("textposition");p(s,0,o,d,u,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r(s,f,d,l,o);var a=(f.marker.line||{}).color,y=k.getComponentMethod("errorbars","supplyDefaults");y(s,f,a||t.defaultLine,{axis:"y"}),y(s,f,a||t.defaultLine,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(f,d)}else f.visible=!1},crossTraceDefaults:function(s,f){var l;function o(u){return g.coerce(l._input,l,c,u)}if("group"===f.barmode)for(var d=0;d<s.length;d++)"bar"===(l=s[d]).type&&m(0,l,f,o)},handleGroupingDefaults:m,handleText:p}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){return g.x="xVal"in t?t.xVal:t.x,g.y="yVal"in t?t.yVal:t.y,t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),"h"===k.orientation?(g.label=g.y,g.value=g.x):(g.label=g.x,g.value=g.y),g}},{}],663:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("tinycolor2"),k=v("../../lib").isArrayOrTypedArray;$.coerceString=function(x,e,r){if("string"==typeof e){if(e||!x.noBlank)return e}else if(("number"==typeof e||!0===e)&&!x.strict)return String(e);return void 0!==r?r:x.dflt},$.coerceNumber=function(x,e,r){if(g(e)){e=+e;var i=x.min,c=x.max;if(!(void 0!==i&&e<i||void 0!==c&&e>c))return e}return void 0!==r?r:x.dflt},$.coerceColor=function(x,e,r){return t(e).isValid()?e:void 0!==r?r:x.dflt},$.coerceEnumerated=function(x,e,r){return x.coerceNumber&&(e=+e),-1!==x.values.indexOf(e)?e:void 0!==r?r:x.dflt},$.getValue=function(x,e){var r;return Array.isArray(x)?e<x.length&&(r=x[e]):r=x,r},$.getLineWidth=function(x,e){return 0<e.mlw?e.mlw:k(x.marker.line.width)?0:x.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(v,Q,$){"use strict";var g=v("../../components/fx"),t=v("../../registry"),k=v("../../components/color"),x=v("../../lib").fillText,e=v("./helpers").getLineWidth,r=v("../../plots/cartesian/axes").hoverLabelText,i=v("../../constants/numerical").BADNUM;function c(m,p,s,f,l){var o,d,u,a,y,h,_,b=m.cd,w=b[0].trace,T=b[0].t,L="closest"===f,M="waterfall"===w.type,P=m.maxHoverDistance,z=m.maxSpikeDistance;"h"===w.orientation?(o=s,d=p,u="y",a="x",y=V,h=X):(o=p,d=s,u="x",a="y",h=V,y=X);var S=w[u+"period"],C=L||S;function R(ae){return j(ae,-1)}function D(ae){return j(ae,1)}function j(ae,ce){return ae[u]+ce*ae.w/2}function q(ae){return ae[u+"End"]-ae[u+"Start"]}var Z=L?R:S?function(ae){return ae.p-q(ae)/2}:function(ae){return Math.min(R(ae),ae.p-T.bardelta/2)},W=L?D:S?function(ae){return ae.p+q(ae)/2}:function(ae){return Math.max(D(ae),ae.p+T.bardelta/2)};function G(ae,ce,oe){return l.finiteRange&&(oe=0),g.inbox(ae-o,ce-o,oe+Math.min(1,Math.abs(ce-ae)/_)-1)}function X(ae){return G(Z(ae),W(ae),P)}function ne(ae){var ce=ae[a];if(M){var oe=Math.abs(ae.rawS)||0;d>0?ce+=oe:d<0&&(ce-=oe)}return ce}function V(ae){var ce=d,oe=ae.b,ve=ne(ae);return g.inbox(oe-ce,ve-ce,P+(ve-ce)/(ve-oe)-1)}var N=m[u+"a"],U=m[a+"a"];_=Math.abs(N.r2c(N.range[1])-N.r2c(N.range[0]));var ae,ce,oe,ve,ee=g.getDistanceFunction(f,y,h,function(ae){return(y(ae)+h(ae))/2});if(g.getClosest(b,ee,m),!1!==m.index&&b[m.index].p!==i){C||(Z=function(ae){return Math.min(R(ae),ae.p-T.bargroupwidth/2)},W=function(ae){return Math.max(D(ae),ae.p+T.bargroupwidth/2)});var B=b[m.index],K=w.base?B.b+B.s:B.s;m[a+"0"]=m[a+"1"]=U.c2p(B[a],!0),m[a+"LabelVal"]=K;var J=T.extents[T.extents.round(B.p)];return m[u+"0"]=N.c2p(L?Z(B):J[0],!0),m[u+"1"]=N.c2p(L?W(B):J[1],!0),m[u+"LabelVal"]=void 0!==B.orig_p?B.orig_p:B.p,m.labelLabel=r(N,m[u+"LabelVal"],w[u+"hoverformat"]),m.valueLabel=r(U,m[a+"LabelVal"],w[a+"hoverformat"]),m.baseLabel=r(U,B.b,w[a+"hoverformat"]),m.spikeDistance=(ce=d,oe=(ae=B).b,ve=ne(ae),(g.inbox(oe-ce,ve-ce,z+(ve-ce)/(ve-oe)-1)+function(ae){return G(R(ae),D(ae),z)}(B))/2),m[u+"Spike"]=N.c2p(B.p,!0),x(B,w,m),m.hovertemplate=w.hovertemplate,m}}function n(m,p){var s=p.mcc||m.marker.color,f=p.mlcc||m.marker.line.color,l=e(m,p);return k.opacity(s)?s:k.opacity(f)&&l?f:void 0}Q.exports={hoverPoints:function(m,p,s,f,l){var o=c(m,p,s,f,l);if(o){var d=o.cd,u=d[0].trace,a=d[o.index];return o.color=n(u,a),t.getComponentMethod("errorbars","hoverInfo")(a,u,o),[o]}},hoverOnBars:c,getTraceColor:n}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc").crossTraceCalc,colorbar:v("../scatter/marker_colorbar"),arraysToCalcdata:v("./arrays_to_calcdata"),plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"bar",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(v,Q,$){"use strict";Q.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../plots/cartesian/axes"),k=v("../../lib"),x=v("./layout_attributes");Q.exports=function(e,r,i){function c(u,a){return k.coerce(e,r,x,u,a)}for(var n=!1,m=!1,p=!1,s={},f=c("barmode"),l=0;l<i.length;l++){var o=i[l];if(g.traceIs(o,"bar")&&o.visible){if(n=!0,"group"===f){var d=o.xaxis+o.yaxis;s[d]&&(p=!0),s[d]=!0}o.visible&&"histogram"===o.type&&"category"!==t.getFromId({_fullLayout:r},o["v"===o.orientation?"xaxis":"yaxis"]).type&&(m=!0)}}n?("overlay"!==f&&c("barnorm"),c("bargap",m&&!p?0:.2),c("bargroupgap")):delete r.barmode}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../../lib"),x=v("../../lib/svg_text_utils"),e=v("../../components/color"),r=v("../../components/drawing"),i=v("../../registry"),c=v("../../plots/cartesian/axes").tickText,n=v("./uniform_text"),m=n.recordMinTextSize,p=n.clearMinTextSize,s=v("./style"),f=v("./helpers"),l=v("./constants"),o=v("./attributes"),d=o.text,u=o.textposition,a=v("../../components/fx/helpers").appendArrayPointValue,y=l.TEXTPAD;function h(z){return z.id}function b(z,S){return z<S?1:-1}function w(z,S,C,R){var D;return!S.uniformtext.mode&&T(C)?(R&&(D=R()),z.transition().duration(C.duration).ease(C.easing).each("end",function(){D&&D()}).each("interrupt",function(){D&&D()})):z}function T(z){return z&&z.duration>0}function L(z){return"auto"===z?0:z}function M(z,S){var C=Math.PI/180*S,R=Math.abs(Math.sin(C)),D=Math.abs(Math.cos(C));return{x:z.width*D+z.height*R,y:z.width*R+z.height*D}}function P(z,S,C,R,D,j){var q=!!j.isHorizontal,Z=!!j.constrained,W=j.angle||0,G=j.anchor||"end",X="end"===G,ne="start"===G,V=((j.leftToRight||0)+1)/2,N=1-V,U=D.width,ee=D.height,B=Math.abs(S-z),K=Math.abs(R-C),J=B>2*y&&K>2*y?y:0;B-=2*J,K-=2*J;var te=L(W);"auto"!==W||U<=B&&ee<=K||!(U>B||ee>K)||(U>K||ee>B)&&U<ee==B<K||(te+=90);var ae=M(D,te),ce=1;Z&&(ce=Math.min(1,B/ae.x,K/ae.y));var oe=D.left*N+D.right*V,ve=(D.top+D.bottom)/2,fe=(z+y)*N+(S-y)*V,xe=(C+R)/2,Se=0,pe=0;if(ne||X){var ge=(q?ae.x:ae.y)/2,Te=q?b(z,S):b(C,R);q?ne?(fe=z+Te*J,Se=-Te*ge):(fe=S-Te*J,Se=Te*ge):ne?(xe=C+Te*J,pe=-Te*ge):(xe=R-Te*J,pe=Te*ge)}return{textX:oe,textY:ve,targetX:fe,targetY:xe,anchorX:Se,anchorY:pe,scale:ce,rotate:te}}Q.exports={plot:function(z,S,C,R,D,j){var q=S.xaxis,Z=S.yaxis,W=z._fullLayout;D||(D={mode:W.barmode,norm:W.barmode,gap:W.bargap,groupgap:W.bargroupgap},p("bar",W));var G=k.makeTraceGroups(R,C,"trace bars").each(function(X){var ne=g.select(this),V=X[0].trace,ee="bar"===V.type||"funnel"===V.type,B=0;"waterfall"===V.type&&V.connector.visible&&"between"===V.connector.mode&&(B=V.connector.line.width/2);var K="h"===V.orientation,J=T(D),te=k.ensureSingle(ne,"g","points"),ae=function _(z){if(z.ids)return h}(V),ce=te.selectAll("g.point").data(k.identity,ae);ce.enter().append("g").classed("point",!0),ce.exit().remove(),ce.each(function(ve,fe){var xe,Se,Ne,Pe,Re,Ge,tt,ct,wt,kt,pe=g.select(this),ge=(Pe=q,Re=Z,ct=[],kt=(Ge=K)?Re:Pe,(tt=[])[0]=(wt=Ge?Pe:Re).c2p((Ne=ve).s0,!0),ct[0]=kt.c2p(Ne.p0,!0),tt[1]=wt.c2p(Ne.s1,!0),ct[1]=kt.c2p(Ne.p1,!0),Ge?[tt,ct]:[ct,tt]),Te=ge[0][0],se=ge[0][1],de=ge[1][0],Ae=ge[1][1],Le=0==(K?se-Te:Ae-de);if(Le&&ee&&f.getLineWidth(V,ve)&&(Le=!1),Le||(Le=!(t(Te)&&t(se)&&t(de)&&t(Ae))),ve.isBlank=Le,Le&&(K?se=Te:Ae=de),B&&!Le&&(K?(Te-=b(Te,se)*B,se+=b(Te,se)*B):(de-=b(de,Ae)*B,Ae+=b(de,Ae)*B)),"waterfall"===V.type){if(!Le){var Me=V[ve.dir].marker;xe=Me.line.width,Se=Me.color}}else xe=f.getLineWidth(V,ve),Se=ve.mc||V.marker.color;function De(Ne){var Pe=g.round(xe/2%1,2);return 0===D.gap&&0===D.groupgap?g.round(Math.round(Ne)-Pe,2):Ne}if(!z._context.staticPlot){var Oe=e.opacity(Se)<1||xe>.01?De:function(Ne,Pe,Re){return Re&&Ne===Pe?Ne:Math.abs(Ne-Pe)>=2?De(Ne):Ne>Pe?Math.ceil(Ne):Math.floor(Ne)};Te=Oe(Te,se,K),se=Oe(se,Te,K),de=Oe(de,Ae,!K),Ae=Oe(Ae,de,!K)}var Ie=w(k.ensureSingle(pe,"path"),W,D,j);if(Ie.style("vector-effect","non-scaling-stroke").attr("d",isNaN((se-Te)*(Ae-de))||Le&&z._context.staticPlot?"M0,0Z":"M"+Te+","+de+"V"+Ae+"H"+se+"V"+de+"Z").call(r.setClipUrl,S.layerClipId,z),!W.uniformtext.mode&&J){var Qe=r.makePointStyleFns(V);r.singlePointStyle(ve,Ie,V,Qe,z)}(function(Ne,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et){var yt,Vt=Pe.xaxis,Gt=Pe.yaxis,en=Ne._fullLayout;function Jt(Zt,vn,zn){return k.ensureSingle(Zt,"text").text(vn).attr({class:"bartext bartext-"+yt,"text-anchor":"middle","data-notex":1}).call(r.font,zn).call(x.convertToTspans,Ne)}var vn,zn,gn,nn,an,on,cn=Ge[0].trace,Rt="h"===cn.orientation,je=(zn=tt,gn=Vt,nn=Gt,an=(on=(vn=Ge)[0].trace).texttemplate?function(mn,_n,Pn,Rn,qn){var Xn=_n[0].trace,br=k.castOption(Xn,Pn,"texttemplate");if(!br)return"";var fr,Vr,cr,Sr,Cr="histogram"===Xn.type,pi="waterfall"===Xn.type,Yn="funnel"===Xn.type,ar="h"===Xn.orientation;function Ar(sn){return c(Sr,Sr.c2l(sn),!0).text}ar?(fr="y",Vr=qn,cr="x",Sr=Rn):(fr="x",Vr=Rn,cr="y",Sr=qn);var sr=_n[Pn],dr={};dr.label=sr.p,dr.labelLabel=dr[fr+"Label"]=c(Vr,Vr.c2l(sr.p),!0).text;var Lr=k.castOption(Xn,sr.i,"text");(0===Lr||Lr)&&(dr.text=Lr),dr.value=sr.s,dr.valueLabel=dr[cr+"Label"]=Ar(sr.s);var jr={};a(jr,Xn,sr.i),(Cr||void 0===jr.x)&&(jr.x=ar?dr.value:dr.label),(Cr||void 0===jr.y)&&(jr.y=ar?dr.label:dr.value),(Cr||void 0===jr.xLabel)&&(jr.xLabel=ar?dr.valueLabel:dr.labelLabel),(Cr||void 0===jr.yLabel)&&(jr.yLabel=ar?dr.labelLabel:dr.valueLabel),pi&&(dr.delta=+sr.rawS||sr.s,dr.deltaLabel=Ar(dr.delta),dr.final=sr.v,dr.finalLabel=Ar(dr.final),dr.initial=dr.final-dr.delta,dr.initialLabel=Ar(dr.initial)),Yn&&(dr.value=sr.s,dr.valueLabel=Ar(dr.value),dr.percentInitial=sr.begR,dr.percentInitialLabel=k.formatPercent(sr.begR),dr.percentPrevious=sr.difR,dr.percentPreviousLabel=k.formatPercent(sr.difR),dr.percentTotal=sr.sumR,dr.percenTotalLabel=k.formatPercent(sr.sumR));var ri=k.castOption(Xn,sr.i,"customdata");return ri&&(dr.customdata=ri),k.texttemplateString(br,dr,mn._d3locale,jr,dr,Xn._meta||{})}(en,vn,zn,gn,nn):on.textinfo?function(mn,_n,Pn,Rn){var qn=mn[0].trace,Xn="h"===qn.orientation,br="waterfall"===qn.type,fr="funnel"===qn.type;function Vr(ri){return c(Xn?Pn:Rn,+ri,!0).text}var cr,Cr=mn[_n],pi=qn.textinfo.split("+"),Yn=[],ar=function(ri){return-1!==pi.indexOf(ri)};if(ar("label")&&Yn.push(c(Xn?Rn:Pn,mn[_n].p,!0).text),ar("text")&&(0===(cr=k.castOption(qn,Cr.i,"text"))||cr)&&Yn.push(cr),br){var sr=+Cr.rawS||Cr.s,dr=Cr.v,$r=dr-sr;ar("initial")&&Yn.push(Vr($r)),ar("delta")&&Yn.push(Vr(sr)),ar("final")&&Yn.push(Vr(dr))}if(fr){ar("value")&&Yn.push(Vr(Cr.s));var Lr=0;ar("percent initial")&&Lr++,ar("percent previous")&&Lr++,ar("percent total")&&Lr++;var jr=Lr>1;ar("percent initial")&&(cr=k.formatPercent(Cr.begR),jr&&(cr+=" of initial"),Yn.push(cr)),ar("percent previous")&&(cr=k.formatPercent(Cr.difR),jr&&(cr+=" of previous"),Yn.push(cr)),ar("percent total")&&(cr=k.formatPercent(Cr.sumR),jr&&(cr+=" of total"),Yn.push(cr))}return Yn.join("<br>")}(vn,zn,gn,nn):f.getValue(on.text,zn),f.coerceString(d,an));yt=function(Zt,vn){var zn=f.getValue(Zt.textposition,vn);return f.coerceEnumerated(u,zn)}(cn,tt);var he=Ge[tt],be=!("stack"===at.mode||"relative"===at.mode)||he._outmost;if(je&&"none"!==yt&&(!he.isBlank&&ct!==wt&&kt!==gt||"auto"!==yt&&"inside"!==yt)){var Fe=en.font,He=s.getBarColor(Ge[tt],cn),Ke=s.getInsideTextFont(cn,tt,Fe,He),Ze=s.getOutsideTextFont(cn,tt,Fe),ut=Re.datum();Rt?"log"===Vt.type&&ut.s0<=0&&(ct=Vt.range[0]<Vt.range[1]?0:Vt._length):"log"===Gt.type&&ut.s0<=0&&(kt=Gt.range[0]<Gt.range[1]?Gt._length:0);var lt,Lt,Ot,ot,pt,qt=Math.abs(wt-ct)-2*y,St=Math.abs(gt-kt)-2*y;if("outside"===yt&&(be||he.hasB||(yt="inside")),"auto"===yt&&(be?(yt="inside",lt=Jt(Re,je,pt=k.ensureUniformFontSize(Ne,Ke)),ot=(Lt=r.bBox(lt.node())).height,(Ot=Lt.width)>0&&ot>0&&(Ot<=qt&&ot<=St||Ot<=St&&ot<=qt||(Rt?qt>=Ot*(St/ot):St>=ot*(qt/Ot)))?yt="inside":(yt="outside",lt.remove(),lt=null)):yt="inside"),!lt){var st=(lt=Jt(Re,je,pt=k.ensureUniformFontSize(Ne,"outside"===yt?Ze:Ke))).attr("transform");if(lt.attr("transform",""),Ot=(Lt=r.bBox(lt.node())).width,ot=Lt.height,lt.attr("transform",st),Ot<=0||ot<=0)return void lt.remove()}var dt,Ht=cn.textangle;dt="outside"===yt?function(Zt,vn,zn,gn,nn,an){var on,mn=!!an.isHorizontal,_n=!!an.constrained,Pn=an.angle||0,Rn=nn.width,qn=nn.height,Xn=Math.abs(vn-Zt),br=Math.abs(gn-zn);on=mn?br>2*y?y:0:Xn>2*y?y:0;var fr=1;_n&&(fr=mn?Math.min(1,br/qn):Math.min(1,Xn/Rn));var Vr=L(Pn),cr=M(nn,Vr),Sr=(mn?cr.x:cr.y)/2,Cr=(nn.left+nn.right)/2,pi=(nn.top+nn.bottom)/2,Yn=(Zt+vn)/2,ar=(zn+gn)/2,Ar=0,sr=0,dr=mn?b(vn,Zt):b(zn,gn);return mn?(Yn=vn-dr*on,Ar=dr*Sr):(ar=gn+dr*on,sr=-dr*Sr),{textX:Cr,textY:pi,targetX:Yn,targetY:ar,anchorX:Ar,anchorY:sr,scale:fr,rotate:Vr}}(ct,wt,kt,gt,Lt,{isHorizontal:Rt,constrained:"both"===cn.constraintext||"outside"===cn.constraintext,angle:Ht}):P(ct,wt,kt,gt,Lt,{isHorizontal:Rt,constrained:"both"===cn.constraintext||"inside"===cn.constraintext,angle:Ht,anchor:cn.insidetextanchor}),dt.fontSize=pt.size,m("histogram"===cn.type?"bar":cn.type,dt,en),he.transform=dt;var Kt=w(lt,en,at,et);k.setTransormAndDisplay(Kt,dt)}else Re.select("text").remove()})(z,S,pe,X,fe,Te,se,de,Ae,D,j),S.layerClipId&&r.hideOutsideRangePoint(ve,pe.select("text"),q,Z,V.xcalendar,V.ycalendar)}),r.setClipUrl(ne,!1===V.cliponaxis?null:S.layerClipId,z)});i.getComponentMethod("errorbars","plot")(z,G,S,D)},toMoveInsideBar:P}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(v,Q,$){"use strict";function g(t,k,x,e,r){var i=k.c2p(e?t.s0:t.p0,!0),c=k.c2p(e?t.s1:t.p1,!0),n=x.c2p(e?t.p0:t.s0,!0),m=x.c2p(e?t.p1:t.s1,!0);return r?[(i+c)/2,(n+m)/2]:e?[c,(n+m)/2]:[(i+c)/2,m]}Q.exports=function(t,k){var x,e=t.cd,r=t.xaxis,i=t.yaxis,c=e[0].trace,n="funnel"===c.type,m="h"===c.orientation,p=[];if(!1===k)for(x=0;x<e.length;x++)e[x].selected=0;else for(x=0;x<e.length;x++){var s=e[x],f="ct"in s?s.ct:g(s,r,i,m,n);k.contains(f,!1,x,t)?(p.push({pointNumber:x,x:r.c2d(s.x),y:i.c2d(s.y)}),s.selected=1):s.selected=0}return p}},{}],670:[function(v,Q,$){"use strict";Q.exports=k;var g=v("../../lib").distinctVals,t=v("../../constants/numerical").BADNUM;function k(x,e){this.traces=x,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var r=1/0,i=[],c=0;c<x.length;c++){for(var n=x[c],m=0;m<n.length;m++){var p=n[m];p.p!==t&&i.push(p.p)}n[0]&&n[0].width1&&(r=Math.min(n[0].width1,r))}this.positions=i;var s=g(i);this.distinctPositions=s.vals,this.minDiff=1===s.vals.length&&r!==1/0?r:Math.min(s.minDiff,r);var f=(e.posAxis||{}).type;"category"!==f&&"multicategory"!==f||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}k.prototype.put=function(x,e){var r=this.getLabel(x,e),i=this.bins[r]||0;return this.bins[r]=i+e,i},k.prototype.get=function(x,e){var r=this.getLabel(x,e);return this.bins[r]||0},k.prototype.getLabel=function(x,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?x:Math.round(x/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../../components/drawing"),x=v("../../lib"),e=v("../../registry"),r=v("./uniform_text").resizeText,i=v("./attributes"),c=i.textfont,n=i.insidetextfont,m=i.outsidetextfont,p=v("./helpers");function s(h,_,b){k.pointStyle(h.selectAll("path"),_,b),f(h,_,b)}function f(h,_,b){h.selectAll("text").each(function(w){var T=g.select(this),L=x.ensureUniformFontSize(b,l(T,w,_,b));k.font(T,L)})}function l(h,_,b,w){var T=w._fullLayout.font,L=b.textfont;if(h.classed("bartext-inside")){var M=y(_,b);L=d(b,_.i,T,M)}else h.classed("bartext-outside")&&(L=u(b,_.i,T));return L}function o(h,_,b){return a(c,h.textfont,_,b)}function d(h,_,b,w){var T=o(h,_,b);return(void 0===h._input.textfont||void 0===h._input.textfont.color||Array.isArray(h.textfont.color)&&void 0===h.textfont.color[_])&&(T={color:t.contrast(w),family:T.family,size:T.size}),a(n,h.insidetextfont,_,T)}function u(h,_,b){var w=o(h,_,b);return a(m,h.outsidetextfont,_,w)}function a(h,_,b,w){var T=p.getValue((_=_||{}).family,b),L=p.getValue(_.size,b),M=p.getValue(_.color,b);return{family:p.coerceString(h.family,T,w.family),size:p.coerceNumber(h.size,L,w.size),color:p.coerceColor(h.color,M,w.color)}}function y(h,_){return"waterfall"===_.type?_[h.dir].marker.color:h.mcc||h.mc||_.marker.color}Q.exports={style:function(h){var _=g.select(h).selectAll("g.barlayer").selectAll("g.trace");r(h,_,"bar");var b=_.size(),w=h._fullLayout;_.style("opacity",function(T){return T[0].trace.opacity}).each(function(T){("stack"===w.barmode&&b>1||0===w.bargap&&0===w.bargroupgap&&!T[0].trace.marker.line.width)&&g.select(this).attr("shape-rendering","crispEdges")}),_.selectAll("g.points").each(function(T){s(g.select(this),T[0].trace,h)}),e.getComponentMethod("errorbars","style")(_)},styleTextPoints:f,styleOnSelect:function(h,_,b){var T,L,M,P,z,S,w=_[0].trace;w.selectedpoints?(L=w,M=h,k.selectedPointStyle((T=b).selectAll("path"),L),P=T.selectAll("text"),z=L,S=M,P.each(function(C){var R,D=g.select(this);if(C.selected){R=x.ensureUniformFontSize(S,l(D,C,z,S));var j=z.selected.textfont&&z.selected.textfont.color;j&&(R.color=j),k.font(D,R)}else k.selectedTextStyle(D,z)})):(s(b,w,h),e.getComponentMethod("errorbars","style")(b))},getInsideTextFont:d,getOutsideTextFont:u,getBarColor:y,resizeText:r}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("../../lib").coercePattern;Q.exports=function(e,r,i,c,n){var m=i("marker.color",c),p=t(e,"marker");p&&k(e,r,n,i,{prefix:"marker.",cLetter:"c"}),i("marker.line.color",g.defaultLine),t(e,"marker.line")&&k(e,r,n,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width"),i("marker.opacity"),x(i,"marker.pattern",m,p),i("selected.marker.color"),i("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib");function k(x){return"_"+x+"Text_minsize"}Q.exports={recordMinTextSize:function(x,e,r){if(r.uniformtext.mode){var i=k(x),c=r.uniformtext.minsize,n=e.scale*e.fontSize;e.hide=n<c,r[i]=r[i]||1/0,e.hide||(r[i]=Math.min(r[i],Math.max(n,c)))}},clearMinTextSize:function(x,e){e[k(x)]=void 0},resizeText:function(x,e,r){var i=x._fullLayout,c=i["_"+r+"Text_minsize"];if(c){var n,m="hide"===i.uniformtext.mode;switch(r){case"funnelarea":case"pie":case"sunburst":n="g.slice";break;case"treemap":case"icicle":n="g.slice, g.pathbar";break;default:n="g.points > g.point"}e.selectAll(n).each(function(p){var s=p.transform;if(s){s.scale=m&&s.hide?0:c/s.fontSize;var f=g.select(this).select("text");t.setTransormAndDisplay(f,s)}})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../lib/extend").extendFlat,k=v("../scatterpolar/attributes"),x=v("../bar/attributes");Q.exports={r:k.r,theta:k.theta,r0:k.r0,dr:k.dr,theta0:k.theta0,dtheta:k.dtheta,thetaunit:k.thetaunit,base:t({},x.base,{}),offset:t({},x.offset,{}),width:t({},x.width,{}),text:t({},x.text,{}),hovertext:t({},x.hovertext,{}),marker:x.marker,hoverinfo:k.hoverinfo,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/helpers").hasColorscale,t=v("../../components/colorscale/calc"),k=v("../bar/arrays_to_calcdata"),x=v("../bar/cross_trace_calc").setGroupPositions,e=v("../scatter/calc_selection"),r=v("../../registry").traceIs,i=v("../../lib").extendFlat;Q.exports={calc:function(c,n){for(var m=c._fullLayout,p=n.subplot,f=m[p].angularaxis,l=m[p].radialaxis.makeCalcdata(n,"r"),o=f.makeCalcdata(n,"theta"),d=n._length,u=new Array(d),a=l,y=o,h=0;h<d;h++)u[h]={p:y[h],s:a[h]};function _(b){var w=n[b];void 0!==w&&(n["_"+b]=Array.isArray(w)?f.makeCalcdata(n,b):f.d2c(w,n.thetaunit))}return"linear"===f.type&&(_("width"),_("offset")),g(n,"marker")&&t(c,n,{vals:n.marker.color,containerStr:"marker",cLetter:"c"}),g(n,"marker.line")&&t(c,n,{vals:n.marker.line.color,containerStr:"marker.line",cLetter:"c"}),k(u,n),e(u,n),u},crossTraceCalc:function(c,n,m){for(var p=c.calcdata,s=[],f=0;f<p.length;f++){var l=p[f],o=l[0].trace;!0===o.visible&&r(o,"bar")&&o.subplot===m&&s.push(l)}var d=i({},n.radialaxis,{_id:"x"});x(c,n.angularaxis,d,s,{mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatterpolar/defaults").handleRThetaDefaults,k=v("../bar/style_defaults"),x=v("./attributes");Q.exports=function(e,r,i,c){function n(m,p){return g.coerce(e,r,x,m,p)}t(e,r,c,n)?(n("thetaunit"),n("base"),n("offset"),n("width"),n("text"),n("hovertext"),n("hovertemplate"),k(e,r,n,i,c),g.coerceSelectionMarkerOpacity(r,n)):r.visible=!1}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(v,Q,$){"use strict";var g=v("../../components/fx"),t=v("../../lib"),k=v("../bar/hover").getTraceColor,x=t.fillText,e=v("../scatterpolar/hover").makeHoverPointText,r=v("../../plots/polar/helpers").isPtInsidePolygon;Q.exports=function(i,c,n){var m=i.cd,p=m[0].trace,s=i.subplot,f=s.radialAxis,o=s.vangles,d=o?r:t.isPtInsideSector,u=i.maxHoverDistance,a=s.angularAxis._period||2*Math.PI,y=Math.abs(f.g2p(Math.sqrt(c*c+n*n))),h=Math.atan2(n,c);if(f.range[0]>f.range[1]&&(h+=Math.PI),g.getClosest(m,function(w){return d(y,h,[w.rp0,w.rp1],[w.thetag0,w.thetag1],o)?u+Math.min(1,Math.abs(w.thetag1-w.thetag0)/a)-1+(w.rp1-y)/(w.rp1-w.rp0)-1:1/0},i),!1!==i.index){var _=m[i.index];i.x0=i.x1=_.ct[0],i.y0=i.y1=_.ct[1];var b=t.extendFlat({},_,{r:_.s,theta:_.p});return x(_,p,i),e(b,p,s,i),i.hovertemplate=p.hovertemplate,i.color=k(p,_),i.xLabelVal=i.yLabelVal=void 0,_.s<0&&(i.idealAlign="left"),[i]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"barpolar",basePlotModule:v("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("../scatterpolar/format_labels"),style:v("../bar/style").style,styleOnSelect:v("../bar/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(v,Q,$){"use strict";Q.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x,e){var r,i={};function c(p,s){return g.coerce(k[r]||{},x[r],t,p,s)}for(var n=0;n<e.length;n++){var m=e[n];"barpolar"===m.type&&!0===m.visible&&(i[r=m.subplot]||(c("barmode"),c("bargap"),i[r]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("fast-isnumeric"),k=v("../../lib"),x=v("../../components/drawing"),e=v("../../plots/polar/helpers");Q.exports=function(r,i,c){var o,d,u,n=i.xaxis,m=i.yaxis,p=i.radialAxis,s=i.angularAxis,f=(d=(o=i).cxx,u=o.cyy,o.vangles?function(a,y,h,_){var b,w;k.angleDelta(h,_)>0?(b=h,w=_):(b=_,w=h);var T=[e.findEnclosingVertexAngles(b,o.vangles)[0],(b+w)/2,e.findEnclosingVertexAngles(w,o.vangles)[1]];return e.pathPolygonAnnulus(a,y,b,w,T,d,u)}:function(a,y,h,_){return k.pathAnnulus(a,y,h,_,d,u)}),l=i.layers.frontplot.select("g.barlayer");k.makeTraceGroups(l,c,"trace bars").each(function(){var o=g.select(this),d=k.ensureSingle(o,"g","points").selectAll("g.point").data(k.identity);d.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),d.exit().remove(),d.each(function(u){var a,y=g.select(this),h=u.rp0=p.c2p(u.s0),_=u.rp1=p.c2p(u.s1),b=u.thetag0=s.c2g(u.p0),w=u.thetag1=s.c2g(u.p1);if(t(h)&&t(_)&&t(b)&&t(w)&&h!==_&&b!==w){var T=p.c2g(u.s1),L=(b+w)/2;u.ct=[n.c2p(T*Math.cos(L)),m.c2p(T*Math.sin(L))],a=f(h,_,b,w)}else a="M0,0Z";k.ensureSingle(y,"path").attr("d",a)}),x.setClipUrl(o,i._hasClipOnAxisFalse?i.clipIds.forTraces:null,r)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(v,Q,$){"use strict";var g=v("../scatter/attributes"),t=v("../bar/attributes"),k=v("../../components/color/attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../lib/extend").extendFlat,i=g.marker,c=i.line;Q.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:x("x"),yhoverformat:x("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:r({},i.symbol,{arrayOk:!1,editType:"plot"}),opacity:r({},i.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:r({},i.angle,{arrayOk:!1,editType:"calc"}),size:r({},i.size,{arrayOk:!1,editType:"calc"}),color:r({},i.color,{arrayOk:!1,editType:"style"}),line:{color:r({},c.color,{arrayOk:!1,dflt:k.defaultLine,editType:"style"}),width:r({},c.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:g.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:{marker:g.selected.marker,editType:"style"},unselected:{marker:g.unselected.marker,editType:"style"},text:r({},g.text,{}),hovertext:r({},g.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../plots/cartesian/axes"),k=v("../../plots/cartesian/align_period"),x=v("../../lib"),e=v("../../constants/numerical").BADNUM,r=x._;Q.exports=function(d,u){var a,y,h,_,b,w,T,L=d._fullLayout,M=t.getFromId(d,u.xaxis||"x"),P=t.getFromId(d,u.yaxis||"y"),z=[],S="violin"===u.type?"_numViolins":"_numBoxes";"h"===u.orientation?(h=M,_="x",b=P,w="y",T=!!u.yperiodalignment):(h=P,_="y",b=M,w="x",T=!!u.xperiodalignment);var C,R,D,j,q,Z,W=function(Re,Ge,tt,ct){var wt,kt=Ge+"0"in Re;if(Ge in Re||kt&&"d"+Ge in Re){var at=tt.makeCalcdata(Re,Ge);return[k(Re,tt,Ge,at).vals,at]}wt=kt?Re[Ge+"0"]:"name"in Re&&("category"===tt.type||g(Re.name)&&-1!==["linear","log"].indexOf(tt.type)||x.isDateTime(Re.name)&&"date"===tt.type)?Re.name:ct;for(var et="multicategory"===tt.type?tt.r2c_just_indices(wt):tt.d2c(wt,0,Re[Ge+"calendar"]),yt=Re._length,Vt=new Array(yt),Gt=0;Gt<yt;Gt++)Vt[Gt]=et;return[Vt]}(u,w,b,L[S]),G=W[0],X=W[1],ne=x.distinctVals(G,b),V=ne.vals,N=ne.minDiff/2,U="all"===(u.boxpoints||u.points)?x.identity:function(Re){return Re.v<C.lf||Re.v>C.uf};if(u._hasPreCompStats){var ee=u[_],B=function(Re){return h.d2c((u[Re]||[])[a])},K=1/0,J=-1/0;for(a=0;a<u._length;a++){var te=G[a];if(g(te)){if((C={}).pos=C[w]=te,T&&X&&(C.orig_p=X[a]),C.q1=B("q1"),C.med=B("median"),C.q3=B("q3"),R=[],ee&&x.isArrayOrTypedArray(ee[a]))for(y=0;y<ee[a].length;y++)(Z=h.d2c(ee[a][y]))!==e&&(c(q={v:Z,i:[a,y]},u,[a,y]),R.push(q));if(C.pts=R.sort(n),j=(D=C[_]=R.map(m)).length,C.med!==e&&C.q1!==e&&C.q3!==e&&C.med>=C.q1&&C.q3>=C.med){var ae=B("lowerfence");C.lf=ae!==e&&ae<=C.q1?ae:p(C,D,j);var ce=B("upperfence");C.uf=ce!==e&&ce>=C.q3?ce:s(C,D,j);var oe=B("mean");C.mean=oe!==e?oe:j?x.mean(D,j):(C.q1+C.q3)/2;var ve=B("sd");C.sd=oe!==e&&ve>=0?ve:j?x.stdev(D,j,C.mean):C.q3-C.q1,C.lo=f(C),C.uo=l(C);var fe=B("notchspan");fe=fe!==e&&fe>0?fe:o(C,j),C.ln=C.med-fe,C.un=C.med+fe;var xe=C.lf,Se=C.uf;u.boxpoints&&D.length&&(xe=Math.min(xe,D[0]),Se=Math.max(Se,D[j-1])),u.notched&&(xe=Math.min(xe,C.ln),Se=Math.max(Se,C.un)),C.min=xe,C.max=Se}else{var pe;x.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+C.q1,"median = "+C.med,"q3 = "+C.q3].join("\n")),C.med=pe=C.med!==e?C.med:C.q1!==e?C.q3!==e?(C.q1+C.q3)/2:C.q1:C.q3!==e?C.q3:0,C.q1=C.q3=pe,C.lf=C.uf=pe,C.mean=C.sd=pe,C.ln=C.un=pe,C.min=C.max=pe}K=Math.min(K,C.min),J=Math.max(J,C.max),C.pts2=R.filter(U),z.push(C)}}u._extremes[h._id]=t.findExtremes(h,[K,J],{padded:!0})}else{var ge=h.makeCalcdata(u,_),Te=function(Re,Ge){for(var tt=Re.length,ct=new Array(tt+1),wt=0;wt<tt;wt++)ct[wt]=Re[wt]-Ge;return ct[tt]=Re[tt-1]+Ge,ct}(V,N),se=V.length,de=function(Re){for(var Ge=new Array(Re),tt=0;tt<Re;tt++)Ge[tt]=[];return Ge}(se);for(a=0;a<u._length;a++)if(g(Z=ge[a])){var Ae=x.findBin(G[a],Te);Ae>=0&&Ae<se&&(c(q={v:Z,i:a},u,a),de[Ae].push(q))}var Le=1/0,Me=-1/0,De=u.quartilemethod,Oe="exclusive"===De,Ie="inclusive"===De;for(a=0;a<se;a++)if(de[a].length>0){var Qe,Ne;(C={}).pos=C[w]=V[a],R=C.pts=de[a].sort(n),j=(D=C[_]=R.map(m)).length,C.min=D[0],C.max=D[j-1],C.mean=x.mean(D,j),C.sd=x.stdev(D,j,C.mean),C.med=x.interp(D,.5),j%2&&(Oe||Ie)?(Oe?(Qe=D.slice(0,j/2),Ne=D.slice(j/2+1)):Ie&&(Qe=D.slice(0,j/2+1),Ne=D.slice(j/2)),C.q1=x.interp(Qe,.5),C.q3=x.interp(Ne,.5)):(C.q1=x.interp(D,.25),C.q3=x.interp(D,.75)),C.lf=p(C,D,j),C.uf=s(C,D,j),C.lo=f(C),C.uo=l(C);var Pe=o(C,j);C.ln=C.med-Pe,C.un=C.med+Pe,Le=Math.min(Le,C.ln),Me=Math.max(Me,C.un),C.pts2=R.filter(U),z.push(C)}u._extremes[h._id]=t.findExtremes(h,u.notched?ge.concat([Le,Me]):ge,{padded:!0})}return function(Re,Ge){if(x.isArrayOrTypedArray(Ge.selectedpoints))for(var tt=0;tt<Re.length;tt++){for(var ct=Re[tt].pts||[],wt={},kt=0;kt<ct.length;kt++)wt[ct[kt].i]=kt;x.tagSelected(ct,Ge,wt)}}(z,u),z.length>0?(z[0].t={num:L[S],dPos:N,posLetter:w,valLetter:_,labels:{med:r(d,"median:"),min:r(d,"min:"),q1:r(d,"q1:"),q3:r(d,"q3:"),max:r(d,"max:"),mean:r(d,"sd"===u.boxmean?"mean \xb1 \u03c3:":"mean:"),lf:r(d,"lower fence:"),uf:r(d,"upper fence:")}},L[S]++,z):[{t:{empty:!0}}]};var i={text:"tx",hovertext:"htx"};function c(d,u,a){for(var y in i)x.isArrayOrTypedArray(u[y])&&(Array.isArray(a)?x.isArrayOrTypedArray(u[y][a[0]])&&(d[i[y]]=u[y][a[0]][a[1]]):d[i[y]]=u[y][a])}function n(d,u){return d.v-u.v}function m(d){return d.v}function p(d,u,a){return 0===a?d.q1:Math.min(d.q1,u[Math.min(x.findBin(2.5*d.q1-1.5*d.q3,u,!0)+1,a-1)])}function s(d,u,a){return 0===a?d.q3:Math.max(d.q3,u[Math.max(x.findBin(2.5*d.q3-1.5*d.q1,u),0)])}function f(d){return 4*d.q1-3*d.q3}function l(d){return 4*d.q3-3*d.q1}function o(d,u){return 0===u?0:1.57*(d.q3-d.q1)/Math.sqrt(u)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib"),k=v("../../plots/cartesian/constraints").getAxisGroup,x=["v","h"];function e(r,i,c,n){var m,p,s,f=i.calcdata,l=i._fullLayout,o=n._id,d=o.charAt(0),u=[],a=0;for(m=0;m<c.length;m++)for(s=f[c[m]],p=0;p<s.length;p++)u.push(n.c2l(s[p].pos,!0)),a+=(s[p].pts2||[]).length;if(u.length){var y=t.distinctVals(u);"category"!==n.type&&"multicategory"!==n.type||(y.minDiff=1);var h=y.minDiff/2;g.minDtick(n,y.minDiff,y.vals[0],!0);var _=l["violin"===r?"_numViolins":"_numBoxes"],b="group"===l[r+"mode"]&&_>1,w=1-l[r+"gap"],T=1-l[r+"groupgap"];for(m=0;m<c.length;m++){var L,M,P,z,S,C,R=(s=f[c[m]])[0].trace,D=s[0].t,j=R.width,q=R.side;if(j)L=M=z=j/2,P=0;else if(L=h,b){var Z=k(l,n._id)+R.orientation,G=Object.keys(((l._alignmentOpts[Z]||{})[R.alignmentgroup]||{}).offsetGroups||{}).length,X=G||_;M=L*w*T/X,P=2*L*(((G?R._offsetIndex:D.num)+.5)/X-.5)*w,z=L*w/X}else M=L*w*T,P=0,z=L;D.dPos=L,D.bPos=P,D.bdPos=M,D.wHover=z;var ne,V,N,U,ee,B,K=P+M,J=Boolean(j);if("positive"===q?(S=L*(j?1:.5),ne=K,C=ne=P):"negative"===q?(S=ne=P,C=L*(j?1:.5),V=K):(S=C=L,ne=V=K),(R.boxpoints||R.points)&&a>0){var te=R.pointpos,ae=R.jitter,ce=R.marker.size/2,oe=0;te+ae>=0&&((oe=K*(te+ae))>S?(J=!0,ee=ce,N=oe):oe>ne&&(ee=ce,N=S)),oe<=S&&(N=S);var ve=0;te-ae<=0&&((ve=-K*(te-ae))>C?(J=!0,B=ce,U=ve):ve>V&&(B=ce,U=C)),ve<=C&&(U=C)}else N=S,U=C;var fe=new Array(s.length);for(p=0;p<s.length;p++)fe[p]=s[p].pos;R._extremes[o]=g.findExtremes(n,fe,{padded:J,vpadminus:U,vpadplus:N,vpadLinearized:!0,ppadminus:{x:B,y:ee}[d],ppadplus:{x:ee,y:B}[d]})}}}Q.exports={crossTraceCalc:function(r,i){for(var c=r.calcdata,n=i.xaxis,m=i.yaxis,p=0;p<x.length;p++){for(var s=x[p],f="h"===s?m:n,l=[],o=0;o<c.length;o++){var d=c[o],a=d[0].trace;!0!==a.visible||"box"!==a.type&&"candlestick"!==a.type||d[0].t.empty||(a.orientation||"v")!==s||a.xaxis!==n._id||a.yaxis!==m._id||l.push(o)}e("box",r,l,f)}},setPositionOffset:e}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry"),k=v("../../components/color"),x=v("../scatter/period_defaults"),e=v("../bar/defaults").handleGroupingDefaults,r=v("../../plots/cartesian/axis_autotype"),i=v("./attributes");function c(m,p,s,f){function l(q){var Z=0;return q&&q.length&&(Z+=1,g.isArrayOrTypedArray(q[0])&&q[0].length&&(Z+=1)),Z}function o(q){return g.validate(m[q],i[q])}var d,u=s("y"),a=s("x");if("box"===p.type){var y=s("q1"),h=s("median"),_=s("q3");p._hasPreCompStats=y&&y.length&&h&&h.length&&_&&_.length,d=Math.min(g.minRowLength(y),g.minRowLength(h),g.minRowLength(_))}var b,w,T=l(u),L=l(a),M=T&&g.minRowLength(u),P=L&&g.minRowLength(a),z=f.calendar,S={autotypenumbers:f.autotypenumbers};if(p._hasPreCompStats)switch(String(L)+String(T)){case"00":var C=o("x0")||o("dx");b=!o("y0")&&!o("dy")||C?"v":"h",w=d;break;case"10":b="v",w=Math.min(d,P);break;case"20":b="h",w=Math.min(d,a.length);break;case"01":b="h",w=Math.min(d,M);break;case"02":b="v",w=Math.min(d,u.length);break;case"12":b="v",w=Math.min(d,P,u.length);break;case"21":b="h",w=Math.min(d,a.length,M);break;case"11":w=0;break;case"22":var R,D=!1;for(R=0;R<a.length;R++)if("category"===r(a[R],z,S)){D=!0;break}if(D)b="v",w=Math.min(d,P,u.length);else{for(R=0;R<u.length;R++)if("category"===r(u[R],z,S)){D=!0;break}D?(b="h",w=Math.min(d,a.length,M)):(b="v",w=Math.min(d,P,u.length))}}else T>0?(b="v",w=L>0?Math.min(P,M):Math.min(M)):L>0?(b="h",w=Math.min(P)):w=0;if(w){p._length=w;var j=s("orientation",b);p._hasPreCompStats?"v"===j&&0===L?(s("x0",0),s("dx",1)):"h"===j&&0===T&&(s("y0",0),s("dy",1)):"v"===j&&0===L?s("x0"):"h"===j&&0===T&&s("y0"),t.getComponentMethod("calendars","handleTraceDefaults")(m,p,["x","y"],f)}else p.visible=!1}function n(m,p,s,f){var l=f.prefix,o=g.coerce2(m,p,i,"marker.outliercolor"),d=s("marker.line.outliercolor"),u="outliers";p._hasPreCompStats?u="all":(o||d)&&(u="suspectedoutliers");var a=s(l+"points",u);a?(s("jitter","all"===a?.3:0),s("pointpos","all"===a?-1.5:0),s("marker.symbol"),s("marker.opacity"),s("marker.size"),s("marker.angle"),s("marker.color",p.line.color),s("marker.line.color"),s("marker.line.width"),"suspectedoutliers"===a&&(s("marker.line.outliercolor",p.marker.color),s("marker.line.outlierwidth")),s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size"),s("text"),s("hovertext")):delete p.marker;var y=s("hoveron");"all"!==y&&-1===y.indexOf("points")||s("hovertemplate"),g.coerceSelectionMarkerOpacity(p,s)}Q.exports={supplyDefaults:function(m,p,s,f){function l(_,b){return g.coerce(m,p,i,_,b)}if(c(m,p,l,f),!1!==p.visible){x(m,p,f,l),l("xhoverformat"),l("yhoverformat");var o=p._hasPreCompStats;o&&(l("lowerfence"),l("upperfence")),l("line.color",(m.marker||{}).color||s),l("line.width"),l("fillcolor",k.addOpacity(p.line.color,.5));var d=!1;if(o){var u=l("mean"),a=l("sd");u&&u.length&&(d=!0,a&&a.length&&(d="sd"))}l("boxmean",d),l("whiskerwidth"),l("width"),l("quartilemethod");var y=!1;if(o){var h=l("notchspan");h&&h.length&&(y=!0)}else g.validate(m.notchwidth,i.notchwidth)&&(y=!0);l("notched",y)&&l("notchwidth"),n(m,p,l,{prefix:"box"})}},crossTraceDefaults:function(m,p){var f;function l(u){return g.coerce(f._input,f,i,u)}for(var o=0;o<m.length;o++){var d=(f=m[o]).type;"box"!==d&&"violin"!==d||"group"===p[d+"mode"]&&e(f._input,f,p,l)}},handleSampleDefaults:c,handlePointsDefaults:n}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(v,Q,$){"use strict";Q.exports=function(g,t){return t.hoverOnBox&&(g.hoverOnBox=t.hoverOnBox),"xVal"in t&&(g.x=t.xVal),"yVal"in t&&(g.y=t.yVal),t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),g}},{}],687:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib"),k=v("../../components/fx"),x=v("../../components/color"),e=t.fillText;function r(c,n,m,p){var s,f,l,o,d,u,a,y,h,_,b,w,T,L,M=c.cd,P=c.xa,z=c.ya,S=M[0].trace,C=M[0].t,R="violin"===S.type,D=C.bdPos,j=C.wHover,q=function(pe){return l.c2l(pe.pos)+C.bPos-l.c2l(u)};R&&"both"!==S.side?("positive"===S.side&&(h=function(pe){var ge=q(pe);return k.inbox(ge,ge+j,_)},w=D,T=0),"negative"===S.side&&(h=function(pe){var ge=q(pe);return k.inbox(ge-j,ge,_)},w=0,T=D)):(h=function(pe){var ge=q(pe);return k.inbox(ge-j,ge+j,_)},w=T=D),L=R?function(pe){return k.inbox(pe.span[0]-d,pe.span[1]-d,_)}:function(pe){return k.inbox(pe.min-d,pe.max-d,_)},"h"===S.orientation?(d=n,u=m,a=L,y=h,s="y",l=z,f="x",o=P):(d=m,u=n,a=h,y=L,s="x",l=P,f="y",o=z);var Z=Math.min(1,D/Math.abs(l.r2c(l.range[1])-l.r2c(l.range[0])));function W(pe){return(a(pe)+y(pe))/2}_=c.maxHoverDistance-Z,b=c.maxSpikeDistance-Z;var G=k.getDistanceFunction(p,a,y,W);if(k.getClosest(M,G,c),!1===c.index)return[];var X=M[c.index],ne=S.line.color,V=(S.marker||{}).color;c.color=x.opacity(ne)&&S.line.width?ne:x.opacity(V)&&S.boxpoints?V:S.fillcolor,c[s+"0"]=l.c2p(X.pos+C.bPos-T,!0),c[s+"1"]=l.c2p(X.pos+C.bPos+w,!0),c[s+"LabelVal"]=void 0!==X.orig_p?X.orig_p:X.pos;var N=s+"Spike";c.spikeDistance=W(X)*b/_,c[N]=l.c2p(X.pos,!0);var U=S.boxmean||(S.meanline||{}).visible,ee=S.boxpoints||S.points,B=ee&&U?["max","uf","q3","med","mean","q1","lf","min"]:ee&&!U?["max","uf","q3","med","q1","lf","min"]:!ee&&U?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"];S.orientation===(o.range[1]<o.range[0]?"v":"h")&&B.reverse();for(var J=c.spikeDistance,te=c[N],ae=[],ce=0;ce<B.length;ce++){var oe=B[ce];if(oe in X){var ve=X[oe],fe=o.c2p(ve,!0),xe=t.extendFlat({},c);xe.attr=oe,xe[f+"0"]=xe[f+"1"]=fe,xe[f+"LabelVal"]=ve,xe[f+"Label"]=(C.labels?C.labels[oe]+" ":"")+g.hoverLabelText(o,ve,S[f+"hoverformat"]),xe.hoverOnBox=!0,"mean"===oe&&"sd"in X&&"sd"===S.boxmean&&(xe[f+"err"]=X.sd),xe.hovertemplate=!1,ae.push(xe)}}c.name="",c.spikeDistance=void 0,c[N]=void 0;for(var Se=0;Se<ae.length;Se++)"med"!==ae[Se].attr?(ae[Se].name="",ae[Se].spikeDistance=void 0,ae[Se][N]=void 0):(ae[Se].spikeDistance=J,ae[Se][N]=te);return ae}function i(c,n,m){for(var p,s,f,l=c.cd,o=c.xa,d=c.ya,u=l[0].trace,a=o.c2p(n),y=d.c2p(m),h=k.quadrature(function(R){var D=Math.max(3,R.mrc||0);return Math.max(Math.abs(o.c2p(R.x)-a)-D,1-3/D)},function(R){var D=Math.max(3,R.mrc||0);return Math.max(Math.abs(d.c2p(R.y)-y)-D,1-3/D)}),_=!1,b=0;b<l.length;b++){s=l[b];for(var w=0;w<(s.pts||[]).length;w++){var T=h(f=s.pts[w]);T<=c.distance&&(c.distance=T,_=[b,w])}}if(!_)return!1;f=(s=l[_[0]]).pts[_[1]];var L=o.c2p(f.x,!0),M=d.c2p(f.y,!0),P=f.mrc||1;p=t.extendFlat({},c,{index:f.i,color:(u.marker||{}).color,name:u.name,x0:L-P,x1:L+P,y0:M-P,y1:M+P,spikeDistance:c.distance,hovertemplate:u.hovertemplate});var z,S=s.orig_p,C=void 0!==S?S:s.pos;return"h"===u.orientation?(z=d,p.xLabelVal=f.x,p.yLabelVal=C):(z=o,p.xLabelVal=C,p.yLabelVal=f.y),p[z._id.charAt(0)+"Spike"]=z.c2p(s.pos,!0),e(f,u,p),p}Q.exports={hoverPoints:function(c,n,m,p){var s,f=c.cd[0].trace.hoveron,l=[];return-1!==f.indexOf("boxes")&&(l=l.concat(r(c,n,m,p))),-1!==f.indexOf("points")&&(s=i(c,n,m)),"closest"===p?s?[s]:l:(s&&l.push(s),l)},hoverOnBoxes:r,hoverOnPoints:i}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults").supplyLayoutDefaults,calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"box",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(v,Q,$){"use strict";Q.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("./layout_attributes");function x(e,r,i,c,n){for(var m=n+"Layout",p=!1,s=0;s<i.length;s++)if(g.traceIs(i[s],m)){p=!0;break}p&&(c(n+"mode"),c(n+"gap"),c(n+"groupgap"))}Q.exports={supplyLayoutDefaults:function(e,r,i){x(0,0,i,function(c,n){return t.coerce(e,r,k,c,n)},"box")},_supply:x}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing");function x(i,c,n,m){var p,s,f="h"===n.orientation,l=c.val,o=c.pos,d=!!o.rangebreaks,u=m.bPos,a=m.wdPos||0,y=m.bPosPxOffset||0,h=n.whiskerwidth||0,_=n.notched||!1,b=_?1-2*n.notchwidth:1;Array.isArray(m.bdPos)?(p=m.bdPos[0],s=m.bdPos[1]):(p=m.bdPos,s=m.bdPos);var w=i.selectAll("path.box").data("violin"!==n.type||n.box.visible?t.identity:[]);w.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),w.exit().remove(),w.each(function(T){if(T.empty)return"M0,0Z";var L=o.c2l(T.pos+u,!0),M=o.l2p(L-p)+y,P=o.l2p(L+s)+y,z=d?(M+P)/2:o.l2p(L)+y,S=n.whiskerwidth,C=d?M*S+(1-S)*z:o.l2p(L-a)+y,R=d?P*S+(1-S)*z:o.l2p(L+a)+y,D=o.l2p(L-p*b)+y,j=o.l2p(L+s*b)+y,q=l.c2p(T.q1,!0),Z=l.c2p(T.q3,!0),W=t.constrain(l.c2p(T.med,!0),Math.min(q,Z)+1,Math.max(q,Z)-1),G=void 0===T.lf||!1===n.boxpoints,X=l.c2p(G?T.min:T.lf,!0),ne=l.c2p(G?T.max:T.uf,!0),V=l.c2p(T.ln,!0),N=l.c2p(T.un,!0);f?g.select(this).attr("d","M"+W+","+D+"V"+j+"M"+q+","+M+"V"+P+(_?"H"+V+"L"+W+","+j+"L"+N+","+P:"")+"H"+Z+"V"+M+(_?"H"+N+"L"+W+","+D+"L"+V+","+M:"")+"ZM"+q+","+z+"H"+X+"M"+Z+","+z+"H"+ne+(0===h?"":"M"+X+","+C+"V"+R+"M"+ne+","+C+"V"+R)):g.select(this).attr("d","M"+D+","+W+"H"+j+"M"+M+","+q+"H"+P+(_?"V"+V+"L"+j+","+W+"L"+P+","+N:"")+"V"+Z+"H"+M+(_?"V"+N+"L"+D+","+W+"L"+M+","+V:"")+"ZM"+z+","+q+"V"+X+"M"+z+","+Z+"V"+ne+(0===h?"":"M"+C+","+X+"H"+R+"M"+C+","+ne+"H"+R))})}function e(i,c,n,m){var p=c.x,s=c.y,f=m.bdPos,l=m.bPos,o=n.boxpoints||n.points;t.seedPseudoRandom();var d=i.selectAll("g.points").data(o?function(a){return a.forEach(function(y){y.t=m,y.trace=n}),a}:[]);d.enter().append("g").attr("class","points"),d.exit().remove();var u=d.selectAll("path").data(function(a){var y,h,_=a.pts2,b=Math.max((a.max-a.min)/10,a.q3-a.q1),w=1e-9*b,T=.01*b,L=[],M=0;if(n.jitter){if(0===b)for(M=1,L=new Array(_.length),y=0;y<_.length;y++)L[y]=1;else for(y=0;y<_.length;y++){var P=Math.max(0,y-5),z=_[P].v,S=Math.min(_.length-1,y+5),C=_[S].v;"all"!==o&&(_[y].v<a.lf?C=Math.min(C,a.lf):z=Math.max(z,a.uf));var R=Math.sqrt(T*(S-P)/(C-z+w))||0;R=t.constrain(Math.abs(R),0,1),L.push(R),M=Math.max(R,M)}h=2*n.jitter/(M||1)}for(y=0;y<_.length;y++){var D=_[y],j=D.v,q=n.jitter?h*L[y]*(t.pseudoRandom()-.5):0,Z=a.pos+l+f*(n.pointpos+q);"h"===n.orientation?(D.y=Z,D.x=j):(D.x=Z,D.y=j),"suspectedoutliers"===o&&j<a.uo&&j>a.lo&&(D.so=!0)}return _});u.enter().append("path").classed("point",!0),u.exit().remove(),u.call(k.translatePoints,p,s)}function r(i,c,n,m){var p,s,f=c.val,l=c.pos,o=!!l.rangebreaks,d=m.bPos,u=m.bPosPxOffset||0,a=n.boxmean||(n.meanline||{}).visible;Array.isArray(m.bdPos)?(p=m.bdPos[0],s=m.bdPos[1]):(p=m.bdPos,s=m.bdPos);var y=i.selectAll("path.mean").data("box"===n.type&&n.boxmean||"violin"===n.type&&n.box.visible&&n.meanline.visible?t.identity:[]);y.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),y.exit().remove(),y.each(function(h){var _=l.c2l(h.pos+d,!0),b=l.l2p(_-p)+u,w=l.l2p(_+s)+u,T=o?(b+w)/2:l.l2p(_)+u,L=f.c2p(h.mean,!0),M=f.c2p(h.mean-h.sd,!0),P=f.c2p(h.mean+h.sd,!0);"h"===n.orientation?g.select(this).attr("d","M"+L+","+b+"V"+w+("sd"===a?"m0,0L"+M+","+T+"L"+L+","+b+"L"+P+","+T+"Z":"")):g.select(this).attr("d","M"+b+","+L+"H"+w+("sd"===a?"m0,0L"+T+","+M+"L"+b+","+L+"L"+T+","+P+"Z":""))})}Q.exports={plot:function(i,c,n,m){var p=c.xaxis,s=c.yaxis;t.makeTraceGroups(m,n,"trace boxes").each(function(f){var l,o,d=g.select(this),u=f[0],a=u.t,y=u.trace;a.wdPos=a.bdPos*y.whiskerwidth,!0!==y.visible||a.empty?d.remove():("h"===y.orientation?(l=s,o=p):(l=p,o=s),x(d,{pos:l,val:o},y,a),e(d,{x:p,y:s},y,a),r(d,{pos:l,val:o},y,a))})},plotBoxAndWhiskers:x,plotPoints:e,plotBoxMean:r}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(v,Q,$){"use strict";Q.exports=function(g,t){var k,x,e=g.cd,r=g.xaxis,i=g.yaxis,c=[];if(!1===t)for(k=0;k<e.length;k++)for(x=0;x<(e[k].pts||[]).length;x++)e[k].pts[x].selected=0;else for(k=0;k<e.length;k++)for(x=0;x<(e[k].pts||[]).length;x++){var n=e[k].pts[x],m=r.c2p(n.x),p=i.c2p(n.y);t.contains([m,p],null,n.i,g)?(c.push({pointNumber:n.i,x:r.c2d(n.x),y:i.c2d(n.y)}),n.selected=1):n.selected=0}return c}},{}],693:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../../components/drawing");Q.exports={style:function(x,e,r){var i=r||g.select(x).selectAll("g.trace.boxes");i.style("opacity",function(c){return c[0].trace.opacity}),i.each(function(c){var n=g.select(this),m=c[0].trace,p=m.line.width;function s(o,d,u,a){o.style("stroke-width",d+"px").call(t.stroke,u).call(t.fill,a)}var f=n.selectAll("path.box");if("candlestick"===m.type)f.each(function(o){if(!o.empty){var d=g.select(this),u=m[o.dir];s(d,u.line.width,u.line.color,u.fillcolor),d.style("opacity",m.selectedpoints&&!o.selected?.3:1)}});else{s(f,p,m.line.color,m.fillcolor),n.selectAll("path.mean").style({"stroke-width":p,"stroke-dasharray":2*p+"px,"+p+"px"}).call(t.stroke,m.line.color);var l=n.selectAll("path.point");k.pointStyle(l,m,x)}})},styleOnSelect:function(x,e,r){var i=e[0].trace,c=r.selectAll("path.point");i.selectedpoints?k.selectedPointStyle(c,i):k.pointStyle(c,i,x)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(v,Q,$){"use strict";var g=v("../../lib").extendFlat,t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../ohlc/attributes"),x=v("../box/attributes");function e(r){return{line:{color:g({},x.line.color,{dflt:r}),width:x.line.width,editType:"style"},fillcolor:x.fillcolor,editType:"style"}}Q.exports={xperiod:k.xperiod,xperiod0:k.xperiod0,xperiodalignment:k.xperiodalignment,xhoverformat:t("x"),yhoverformat:t("y"),x:k.x,open:k.open,high:k.high,low:k.low,close:k.close,line:{width:g({},x.line.width,{}),editType:"style"},increasing:e(k.increasing.line.color.dflt),decreasing:e(k.decreasing.line.color.dflt),text:k.text,hovertext:k.hovertext,whiskerwidth:g({},x.whiskerwidth,{dflt:0}),hoverlabel:k.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../../plots/cartesian/align_period"),x=v("../ohlc/calc").calcCommon;function e(r,i,c,n){return{min:c,q1:Math.min(r,n),med:n,q3:Math.max(r,n),max:i}}Q.exports=function(r,i){var c=r._fullLayout,n=t.getFromId(r,i.xaxis),m=t.getFromId(r,i.yaxis),p=n.makeCalcdata(i,"x"),s=k(i,n,"x",p).vals,f=x(r,i,p,s,m,e);return f.length?(g.extendFlat(f[0].t,{num:c._numBoxes,dPos:g.distinctVals(s).minDiff/2,posLetter:"x",valLetter:"y"}),c._numBoxes++,f):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../ohlc/ohlc_defaults"),x=v("../scatter/period_defaults"),e=v("./attributes");function r(i,c,n,m){var p=n(m+".line.color");n(m+".line.width",c.line.width),n(m+".fillcolor",t.addOpacity(p,.5))}Q.exports=function(i,c,n,m){function p(s,f){return g.coerce(i,c,e,s,f)}k(i,c,p,m)?(x(i,c,m,p,{x:!0}),p("xhoverformat"),p("yhoverformat"),p("line.width"),r(0,c,p,"increasing"),r(0,c,p,"decreasing"),p("text"),p("hovertext"),p("whiskerwidth"),m._requestRangeslider[c.xaxis]=!0):c.visible=!1}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"candlestick",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:v("./attributes"),layoutAttributes:v("../box/layout_attributes"),supplyLayoutDefaults:v("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:v("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("../box/plot").plot,layerName:"boxlayer",style:v("../box/style").style,hoverPoints:v("../ohlc/hover").hoverPoints,selectPoints:v("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(v,Q,$){"use strict";var g=v("./axis_defaults"),t=v("../../plot_api/plot_template");Q.exports=function(k,x,e,r,i){var c,n,m,p;r("a")||(r("da"),r("a0")),r("b")||(r("db"),r("b0")),c=k,n=x,m=e,p=i,["aaxis","baxis"].forEach(function(s){var f=s.charAt(0),l=c[s]||{},o=t.newContainer(n,s);g(l,o,{noTicklabelstep:!0,tickfont:"x",id:f+"axis",letter:f,font:n.font,name:s,data:c[f],calendar:n.calendar,dfltColor:p,bgColor:m.paper_bgcolor,autotypenumbersDflt:m.autotypenumbers,fullLayout:m}),o._categories=o._categories||[],c[s]||"-"===l.type||(c[s]={type:l.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(v,Q,$){"use strict";var g=v("../../lib").isArrayOrTypedArray;Q.exports=function(t){return function k(x,e){if(!g(x)||e>=10)return null;for(var r=1/0,i=-1/0,c=x.length,n=0;n<c;n++){var m=x[n];if(g(m)){var p=k(m,e+1);p&&(r=Math.min(p[0],r),i=Math.max(p[1],i))}else r=Math.min(m,r),i=Math.max(m,i)}return[r,i]}(t,0)}},{"../../lib":515}],700:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("./axis_attributes"),k=v("../../components/color/attributes"),x=g({editType:"calc"});x.family.dflt='"Open Sans", verdana, arial, sans-serif',x.size.dflt=12,x.color.dflt=k.defaultLine,Q.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:t,baxis:t,font:x,color:{valType:"color",dflt:k.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(v,Q,$){"use strict";var g=v("../../lib").isArrayOrTypedArray;Q.exports=function(t,k,x,e){var r,i,c,n,m,p,s,f,l,o,d,u,a,y=g(x)?"a":"b",h=("a"===y?t.aaxis:t.baxis).smoothing,_="a"===y?t.a2i:t.b2j,b="a"===y?x:e,w="a"===y?e:x,T="a"===y?k.a.length:k.b.length,L="a"===y?k.b.length:k.a.length,M=Math.floor("a"===y?t.b2j(w):t.a2i(w)),P="a"===y?function(ne){return t.evalxy([],ne,M)}:function(ne){return t.evalxy([],M,ne)};h&&(c=Math.max(0,Math.min(L-2,M)),n=M-c,i="a"===y?function(ne,V){return t.dxydi([],ne,c,V,n)}:function(ne,V){return t.dxydj([],c,ne,n,V)});var z=_(b[0]),S=_(b[1]),C=z<S?1:-1,R=1e-8*(S-z),D=C>0?Math.floor:Math.ceil,j=C>0?Math.ceil:Math.floor,q=C>0?Math.min:Math.max,Z=C>0?Math.max:Math.min,W=D(z+R),G=j(S-R),X=[[s=P(z)]];for(r=W;r*C<G*C;r+=C)m=[],d=Z(z,r),a=(u=q(S,r+C))-d,p=Math.max(0,Math.min(T-2,Math.floor(.5*(d+u)))),f=P(u),h&&(l=i(p,d-p),o=i(p,u-p),m.push([s[0]+l[0]/3*a,s[1]+l[1]/3*a]),m.push([f[0]-o[0]/3*a,f[1]-o[1]/3*a])),m.push(f),X.push(m),s=f;return X}},{"../../lib":515}],702:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("../../components/color/attributes"),k=v("../../plots/cartesian/layout_attributes"),x=v("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=v("../../plot_api/edit_types").overrideAll,r=v("../../components/drawing/attributes").dash,i=v("../../lib/extend").extendFlat;Q.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:g({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:k.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:g({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:x("tick label")},tickformatstops:e(k.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:t.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:i({},r,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:i({},r,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:t.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:g({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(v,Q,$){"use strict";var g=v("./attributes"),t=v("../../components/color").addOpacity,k=v("../../registry"),x=v("../../lib"),e=v("../../plots/cartesian/tick_value_defaults"),r=v("../../plots/cartesian/tick_label_defaults"),i=v("../../plots/cartesian/prefix_suffix_defaults"),c=v("../../plots/cartesian/category_order_defaults"),n=v("../../plots/cartesian/set_convert"),m=v("../../plots/cartesian/axis_autotype");Q.exports=function(p,s,f){var l=f.letter,o=f.font||{},d=g[l+"axis"];function u(C,R){return x.coerce(p,s,d,C,R)}function a(C,R){return x.coerce2(p,s,d,C,R)}f.name&&(s._name=f.name,s._id=f.name),u("autotypenumbers",f.autotypenumbersDflt);var y=u("type");"-"===y&&(f.data&&function(C,R){if("-"===C.type){var D=C._id.charAt(0);C.type=m(R,C[D+"calendar"],{autotypenumbers:C.autotypenumbers})}}(s,f.data),"-"===s.type?s.type="linear":y=p.type=s.type),u("smoothing"),u("cheatertype"),u("showticklabels"),u("labelprefix",l+" = "),u("labelsuffix"),u("showtickprefix"),u("showticksuffix"),u("separatethousands"),u("tickformat"),u("exponentformat"),u("minexponent"),u("showexponent"),u("categoryorder"),u("tickmode"),u("tickvals"),u("ticktext"),u("tick0"),u("dtick"),"array"===s.tickmode&&(u("arraytick0"),u("arraydtick")),u("labelpadding"),s._hovertitle=l,"date"===y&&k.getComponentMethod("calendars","handleDefaults")(p,s,"calendar",f.calendar),n(s,f.fullLayout),s.c2p=x.identity;var h=u("color",f.dfltColor),_=h===p.color?h:o.color;u("title.text")&&(x.coerceFont(u,"title.font",{family:o.family,size:x.bigFont(o.size),color:_}),u("title.offset")),u("tickangle"),u("autorange",!s.isValidRange(p.range))&&u("rangemode"),u("range"),s.cleanRange(),u("fixedrange"),e(p,s,u,y),i(p,s,u,y,f),r(p,s,u,y,f),c(p,s,u,{data:f.data,dataAttr:l});var b=a("gridcolor",t(h,.3)),w=a("gridwidth"),T=a("griddash"),L=u("showgrid");L||(delete s.gridcolor,delete s.gridwidth,delete s.griddash);var M=a("startlinecolor",h),P=a("startlinewidth",w);u("startline",s.showgrid||!!M||!!P)||(delete s.startlinecolor,delete s.startlinewidth);var z=a("endlinecolor",h),S=a("endlinewidth",w);return u("endline",s.showgrid||!!z||!!S)||(delete s.endlinecolor,delete s.endlinewidth),L?(u("minorgridcount"),u("minorgridwidth",w),u("minorgriddash",T),u("minorgridcolor",t(b,.06)),s.minorgridcount||(delete s.minorgridwidth,delete s.minorgriddash,delete s.minorgridcolor)):(delete s.gridcolor,delete s.gridwidth,delete s.griddash),"none"===s.showticklabels&&(delete s.tickfont,delete s.tickangle,delete s.showexponent,delete s.exponentformat,delete s.minexponent,delete s.tickformat,delete s.showticksuffix,delete s.showtickprefix),s.showticksuffix||delete s.ticksuffix,s.showtickprefix||delete s.tickprefix,u("tickmode"),s}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib").isArray1D,k=v("./cheater_basis"),x=v("./array_minmax"),e=v("./calc_gridlines"),r=v("./calc_labels"),i=v("./calc_clippath"),c=v("../heatmap/clean_2d_array"),n=v("./smooth_fill_2d_array"),m=v("../heatmap/convert_column_xyz"),p=v("./set_convert");Q.exports=function(s,f){var l=g.getFromId(s,f.xaxis),o=g.getFromId(s,f.yaxis),d=f.aaxis,u=f.baxis,a=f.x,y=f.y,h=[];a&&t(a)&&h.push("x"),y&&t(y)&&h.push("y"),h.length&&m(f,d,u,"a","b",h);var _=f._a=f._a||f.a,b=f._b=f._b||f.b;a=f._x||f.x,y=f._y||f.y;var w={};f._cheater&&(a=k("index"===d.cheatertype?_.length:_,"index"===u.cheatertype?b.length:b,f.cheaterslope)),f._x=a=c(a),f._y=y=c(y),n(a,_,b),n(y,_,b),p(f),f.setScale();var M=x(a),P=x(y),z=.5*(M[1]-M[0]),S=.5*(M[1]+M[0]),C=.5*(P[1]-P[0]),R=.5*(P[1]+P[0]);return P=[R-1.3*C,R+1.3*C],f._extremes[l._id]=g.findExtremes(l,M=[S-1.3*z,S+1.3*z],{padded:!0}),f._extremes[o._id]=g.findExtremes(o,P,{padded:!0}),e(f,"a","b"),e(f,"b","a"),r(f,d),r(f,u),w.clipsegments=i(f._xctrl,f._yctrl,d,u),w.x=a,w.y=y,w.a=_,w.b=b,[w]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x){var e,r,i,c=[],n=!!k.smoothing,m=!!x.smoothing,p=g[0].length-1,s=g.length-1;for(e=0,r=[],i=[];e<=p;e++)r[e]=g[0][e],i[e]=t[0][e];for(c.push({x:r,y:i,bicubic:n}),e=0,r=[],i=[];e<=s;e++)r[e]=g[e][p],i[e]=t[e][p];for(c.push({x:r,y:i,bicubic:m}),e=p,r=[],i=[];e>=0;e--)r[p-e]=g[s][e],i[p-e]=t[s][e];for(c.push({x:r,y:i,bicubic:n}),e=s,r=[],i=[];e>=0;e--)r[s-e]=g[e][0],i[s-e]=t[e][0];return c.push({x:r,y:i,bicubic:m}),c}},{}],706:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib/extend").extendFlat;Q.exports=function(k,x,e){var r,i,c,n,m,p,s,f,l,o,d,u,a,y,h=k["_"+x],_=k[x+"axis"],b=_._gridlines=[],w=_._minorgridlines=[],T=_._boundarylines=[],L=k["_"+e],M=k[e+"axis"];"array"===_.tickmode&&(_.tickvals=h.slice());var P=k._xctrl,z=k._yctrl,S=P[0].length,C=P.length,R=k._a.length,D=k._b.length;g.prepTicks(_),"array"===_.tickmode&&delete _.tickvals;var j=_.smoothing?3:1;function q(W){var G,X,ne,V,N,U,ee,B,K,J,te,ae,ce=[],oe=[],ve={};if("b"===x)for(X=k.b2j(W),ne=Math.floor(Math.max(0,Math.min(D-2,X))),V=X-ne,ve.length=D,ve.crossLength=R,ve.xy=function(fe){return k.evalxy([],fe,X)},ve.dxy=function(fe,xe){return k.dxydi([],fe,ne,xe,V)},G=0;G<R;G++)U=Math.min(R-2,G),ee=G-U,B=k.evalxy([],G,X),M.smoothing&&G>0&&(K=k.dxydi([],G-1,ne,0,V),ce.push(N[0]+K[0]/3),oe.push(N[1]+K[1]/3),J=k.dxydi([],G-1,ne,1,V),ce.push(B[0]-J[0]/3),oe.push(B[1]-J[1]/3)),ce.push(B[0]),oe.push(B[1]),N=B;else for(G=k.a2i(W),U=Math.floor(Math.max(0,Math.min(R-2,G))),ee=G-U,ve.length=R,ve.crossLength=D,ve.xy=function(fe){return k.evalxy([],G,fe)},ve.dxy=function(fe,xe){return k.dxydj([],U,fe,ee,xe)},X=0;X<D;X++)ne=Math.min(D-2,X),V=X-ne,B=k.evalxy([],G,X),M.smoothing&&X>0&&(te=k.dxydj([],U,X-1,ee,0),ce.push(N[0]+te[0]/3),oe.push(N[1]+te[1]/3),ae=k.dxydj([],U,X-1,ee,1),ce.push(B[0]-ae[0]/3),oe.push(B[1]-ae[1]/3)),ce.push(B[0]),oe.push(B[1]),N=B;return ve.axisLetter=x,ve.axis=_,ve.crossAxis=M,ve.value=W,ve.constvar=e,ve.index=f,ve.x=ce,ve.y=oe,ve.smoothing=M.smoothing,ve}function Z(W){var G,X,ne,V,N,U=[],ee=[],B={};if(B.length=h.length,B.crossLength=L.length,"b"===x)for(ne=Math.max(0,Math.min(D-2,W)),N=Math.min(1,Math.max(0,W-ne)),B.xy=function(K){return k.evalxy([],K,W)},B.dxy=function(K,J){return k.dxydi([],K,ne,J,N)},G=0;G<S;G++)U[G]=P[W*j][G],ee[G]=z[W*j][G];else for(X=Math.max(0,Math.min(R-2,W)),V=Math.min(1,Math.max(0,W-X)),B.xy=function(K){return k.evalxy([],W,K)},B.dxy=function(K,J){return k.dxydj([],X,K,V,J)},G=0;G<C;G++)U[G]=P[G][W*j],ee[G]=z[G][W*j];return B.axisLetter=x,B.axis=_,B.crossAxis=M,B.value=h[W],B.constvar=e,B.index=W,B.x=U,B.y=ee,B.smoothing=M.smoothing,B}if("array"===_.tickmode){for(n=5e-15,p=(m=[Math.floor((h.length-1-_.arraytick0)/_.arraydtick*(1+n)),Math.ceil(-_.arraytick0/_.arraydtick/(1+n))].sort(function(W,G){return W-G}))[0]-1,s=m[1]+1,f=p;f<s;f++)(i=_.arraytick0+_.arraydtick*f)<0||i>h.length-1||b.push(t(Z(i),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(f=p;f<s;f++)if(c=_.arraytick0+_.arraydtick*f,d=Math.min(c+_.arraydtick,h.length-1),!(c<0||c>h.length-1||d<0||d>h.length-1))for(u=h[c],a=h[d],r=0;r<_.minorgridcount;r++)(y=d-c)<=0||(o=u+(a-u)*(r+1)/(_.minorgridcount+1)*(_.arraydtick/y))<h[0]||o>h[h.length-1]||w.push(t(q(o),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&T.push(t(Z(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&T.push(t(Z(h.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(n=5e-15,p=(m=[Math.floor((h[h.length-1]-_.tick0)/_.dtick*(1+n)),Math.ceil((h[0]-_.tick0)/_.dtick/(1+n))].sort(function(W,G){return W-G}))[0],s=m[1],f=p;f<=s;f++)b.push(t(q(l=_.tick0+_.dtick*f),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(f=p-1;f<s+1;f++)for(l=_.tick0+_.dtick*f,r=0;r<_.minorgridcount;r++)(o=l+_.dtick*(r+1)/(_.minorgridcount+1))<h[0]||o>h[h.length-1]||w.push(t(q(o),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&T.push(t(q(h[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&T.push(t(q(h[h.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib/extend").extendFlat;Q.exports=function(k,x){var e,r,i,c=x._labels=[],n=x._gridlines;for(e=0;e<n.length;e++)i=n[e],-1!==["start","both"].indexOf(x.showticklabels)&&(r=g.tickText(x,i.value),t(r,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:i.xy(0),dxy:i.dxy(0,0),axis:i.axis,length:i.crossAxis.length,font:i.axis.tickfont,isFirst:0===e,isLast:e===n.length-1}),c.push(r)),-1!==["end","both"].indexOf(x.showticklabels)&&(r=g.tickText(x,i.value),t(r,{endAnchor:!1,xy:i.xy(i.crossLength-1),dxy:i.dxy(i.crossLength-2,1),axis:i.axis,length:i.crossAxis.length,font:i.axis.tickfont,isFirst:0===e,isLast:e===n.length-1}),c.push(r))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x){var e=g[0]-t[0],r=g[1]-t[1],i=k[0]-t[0],c=k[1]-t[1],n=Math.pow(e*e+r*r,.25),m=Math.pow(i*i+c*c,.25),p=(m*m*e-n*n*i)*x,s=(m*m*r-n*n*c)*x,f=m*(n+m)*3,l=n*(n+m)*3;return[[t[0]+(f&&p/f),t[1]+(f&&s/f)],[t[0]-(l&&p/l),t[1]-(l&&s/l)]]}},{}],709:[function(v,Q,$){"use strict";var g=v("../../lib").isArrayOrTypedArray;Q.exports=function(t,k,x){var e,r,i,c,n,m,p=[],s=g(t)?t.length:t,f=g(k)?k.length:k,l=g(t)?t:null,o=g(k)?k:null;l&&(i=(l.length-1)/(l[l.length-1]-l[0])/(s-1)),o&&(c=(o.length-1)/(o[o.length-1]-o[0])/(f-1));var d=1/0,u=-1/0;for(r=0;r<f;r++)for(p[r]=[],n=o?(o[r]-o[0])*c:r/(f-1),e=0;e<s;e++)m=(l?(l[e]-l[0])*i:e/(s-1))-n*x,d=Math.min(m,d),u=Math.max(m,u),p[r][e]=m;var a=1/(u-d),y=-d*a;for(r=0;r<f;r++)for(e=0;e<s;e++)p[r][e]=a*p[r][e]+y;return p}},{"../../lib":515}],710:[function(v,Q,$){"use strict";var g=v("./catmull_rom"),t=v("../../lib").ensureArray;function k(x,e,r){return[(2*(-.5*r[0]+1.5*e[0])+x[0])/3,(2*(-.5*r[1]+1.5*e[1])+x[1])/3]}Q.exports=function(x,e,r,i,c,n){var m,p,s,f,l,o,d,u,a,y,h=r[0].length,_=r.length,b=c?3*h-2:h,w=n?3*_-2:_;for(x=t(x,w),e=t(e,w),s=0;s<w;s++)x[s]=t(x[s],b),e[s]=t(e[s],b);for(p=0,f=0;p<_;p++,f+=n?3:1)for(l=x[f],o=e[f],d=r[p],u=i[p],m=0,s=0;m<h;m++,s+=c?3:1)l[s]=d[m],o[s]=u[m];if(c)for(p=0,f=0;p<_;p++,f+=n?3:1){for(m=1,s=3;m<h-1;m++,s+=3)a=g([r[p][m-1],i[p][m-1]],[r[p][m],i[p][m]],[r[p][m+1],i[p][m+1]],c),x[f][s-1]=a[0][0],e[f][s-1]=a[0][1],x[f][s+1]=a[1][0],e[f][s+1]=a[1][1];y=k([x[f][0],e[f][0]],[x[f][2],e[f][2]],[x[f][3],e[f][3]]),x[f][1]=y[0],e[f][1]=y[1],y=k([x[f][b-1],e[f][b-1]],[x[f][b-3],e[f][b-3]],[x[f][b-4],e[f][b-4]]),x[f][b-2]=y[0],e[f][b-2]=y[1]}if(n)for(s=0;s<b;s++){for(f=3;f<w-3;f+=3)a=g([x[f-3][s],e[f-3][s]],[x[f][s],e[f][s]],[x[f+3][s],e[f+3][s]],n),x[f-1][s]=a[0][0],e[f-1][s]=a[0][1],x[f+1][s]=a[1][0],e[f+1][s]=a[1][1];y=k([x[0][s],e[0][s]],[x[2][s],e[2][s]],[x[3][s],e[3][s]]),x[1][s]=y[0],e[1][s]=y[1],y=k([x[w-1][s],e[w-1][s]],[x[w-3][s],e[w-3][s]],[x[w-4][s],e[w-4][s]]),x[w-2][s]=y[0],e[w-2][s]=y[1]}if(c&&n)for(f=1;f<w;f+=(f+1)%3==0?2:1){for(s=3;s<b-3;s+=3)a=g([x[f][s-3],e[f][s-3]],[x[f][s],e[f][s]],[x[f][s+3],e[f][s+3]],c),x[f][s-1]=.5*(x[f][s-1]+a[0][0]),e[f][s-1]=.5*(e[f][s-1]+a[0][1]),x[f][s+1]=.5*(x[f][s+1]+a[1][0]),e[f][s+1]=.5*(e[f][s+1]+a[1][1]);y=k([x[f][0],e[f][0]],[x[f][2],e[f][2]],[x[f][3],e[f][3]]),x[f][1]=.5*(x[f][1]+y[0]),e[f][1]=.5*(e[f][1]+y[1]),y=k([x[f][b-1],e[f][b-1]],[x[f][b-3],e[f][b-3]],[x[f][b-4],e[f][b-4]]),x[f][b-2]=.5*(x[f][b-2]+y[0]),e[f][b-2]=.5*(e[f][b-2]+y[1])}return[x,e]}},{"../../lib":515,"./catmull_rom":708}],711:[function(v,Q,$){"use strict";Q.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){return t&&k?function(x,e,r,i,c){var n,f,l;x||(x=[]),e*=3,r*=3;var o=i*i,d=1-i,u=d*d,a=d*i*2,y=-3*u,h=3*(u-a),_=3*(a-o),b=3*o,w=c*c,T=w*c,L=1-c,M=L*L,P=M*L;for(l=0;l<g.length;l++)n=y*(f=g[l])[r][e]+h*f[r][e+1]+_*f[r][e+2]+b*f[r][e+3],x[l]=P*n+3*(M*c*(y*f[r+1][e]+h*f[r+1][e+1]+_*f[r+1][e+2]+b*f[r+1][e+3])+L*w*(y*f[r+2][e]+h*f[r+2][e+1]+_*f[r+2][e+2]+b*f[r+2][e+3]))+T*(y*f[r+3][e]+h*f[r+3][e+1]+_*f[r+3][e+2]+b*f[r+3][e+3]);return x}:t?function(x,e,r,i,c){var n,p,s;x||(x=[]),e*=3;var f=i*i,l=1-i,o=l*l,d=l*i*2,u=-3*o,a=3*(o-d),y=3*(d-f),h=3*f,_=1-c;for(p=0;p<g.length;p++)n=u*(s=g[p])[r][e]+a*s[r][e+1]+y*s[r][e+2]+h*s[r][e+3],x[p]=_*n+c*(u*s[r+1][e]+a*s[r+1][e+1]+y*s[r+1][e+2]+h*s[r+1][e+3]);return x}:k?function(x,e,r,i,c){var n,f,l;x||(x=[]),r*=3;var o=c*c,d=o*c,u=1-c,a=u*u,y=a*u;for(f=0;f<g.length;f++)n=(l=g[f])[r][e+1]-l[r][e],x[f]=y*n+3*(a*c*(l[r+1][e+1]-l[r+1][e])+u*o*(l[r+2][e+1]-l[r+2][e]))+d*(l[r+3][e+1]-l[r+3][e]);return x}:function(x,e,r,i,c){var n,p,s;x||(x=[]);var f=1-c;for(p=0;p<g.length;p++)n=(s=g[p])[r][e+1]-s[r][e],x[p]=f*n+c*(s[r+1][e+1]-s[r+1][e]);return x}}},{}],713:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){return t&&k?function(x,e,r,i,c){var n,f,l;x||(x=[]),e*=3,r*=3;var o=i*i,d=o*i,u=1-i,a=u*u,y=a*u,h=c*c,_=1-c,b=_*_,w=_*c*2,T=-3*b,L=3*(b-w),M=3*(w-h),P=3*h;for(l=0;l<g.length;l++)n=T*(f=g[l])[r][e]+L*f[r+1][e]+M*f[r+2][e]+P*f[r+3][e],x[l]=y*n+3*(a*i*(T*f[r][e+1]+L*f[r+1][e+1]+M*f[r+2][e+1]+P*f[r+3][e+1])+u*o*(T*f[r][e+2]+L*f[r+1][e+2]+M*f[r+2][e+2]+P*f[r+3][e+2]))+d*(T*f[r][e+3]+L*f[r+1][e+3]+M*f[r+2][e+3]+P*f[r+3][e+3]);return x}:t?function(x,e,r,i,c){var n,f,l;x||(x=[]),e*=3;var o=c*c,d=o*c,u=1-c,a=u*u,y=a*u;for(f=0;f<g.length;f++)n=(l=g[f])[r+1][e]-l[r][e],x[f]=y*n+3*(a*c*(l[r+1][e+1]-l[r][e+1])+u*o*(l[r+1][e+2]-l[r][e+2]))+d*(l[r+1][e+3]-l[r][e+3]);return x}:k?function(x,e,r,i,c){var n,p,s;x||(x=[]),r*=3;var f=1-i,l=c*c,o=1-c,d=o*o,u=o*c*2,a=-3*d,y=3*(d-u),h=3*(u-l),_=3*l;for(p=0;p<g.length;p++)n=a*(s=g[p])[r][e]+y*s[r+1][e]+h*s[r+2][e]+_*s[r+3][e],x[p]=f*n+i*(a*s[r][e+1]+y*s[r+1][e+1]+h*s[r+2][e+1]+_*s[r+3][e+1]);return x}:function(x,e,r,i,c){var n,p,s;x||(x=[]);var f=1-i;for(p=0;p<g.length;p++)n=(s=g[p])[r+1][e]-s[r][e],x[p]=f*n+i*(s[r+1][e+1]-s[r][e+1]);return x}}},{}],714:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){var r=t-2,i=k-2;return x&&e?function(c,n,m){var p,o,d;c||(c=[]);var u=Math.max(0,Math.min(Math.floor(n),r)),a=Math.max(0,Math.min(Math.floor(m),i)),y=Math.max(0,Math.min(1,n-u)),h=Math.max(0,Math.min(1,m-a));u*=3,a*=3;var _=y*y,b=_*y,w=1-y,T=w*w,L=T*w,M=h*h,P=M*h,z=1-h,S=z*z,C=S*z;for(d=0;d<g.length;d++)p=L*(o=g[d])[a][u]+3*(T*y*o[a][u+1]+w*_*o[a][u+2])+b*o[a][u+3],c[d]=C*p+3*(S*h*(L*o[a+1][u]+3*(T*y*o[a+1][u+1]+w*_*o[a+1][u+2])+b*o[a+1][u+3])+z*M*(L*o[a+2][u]+3*(T*y*o[a+2][u+1]+w*_*o[a+2][u+2])+b*o[a+2][u+3]))+P*(L*o[a+3][u]+3*(T*y*o[a+3][u+1]+w*_*o[a+3][u+2])+b*o[a+3][u+3]);return c}:x?function(c,n,m){c||(c=[]);var p,o,d,u=Math.max(0,Math.min(Math.floor(n),r)),a=Math.max(0,Math.min(Math.floor(m),i)),y=Math.max(0,Math.min(1,n-u)),h=Math.max(0,Math.min(1,m-a));u*=3;var _=y*y,b=_*y,w=1-y,T=w*w,L=T*w,M=1-h;for(o=0;o<g.length;o++)p=M*(d=g[o])[a][u]+h*d[a+1][u],c[o]=L*p+3*(T*y*(M*d[a][u+1]+h*d[a+1][u+1])+w*_*(M*d[a][u+2]+h*d[a+1][u+1]))+b*(M*d[a][u+3]+h*d[a+1][u+1]);return c}:e?function(c,n,m){c||(c=[]);var p,o,d,u=Math.max(0,Math.min(Math.floor(n),r)),a=Math.max(0,Math.min(Math.floor(m),i)),y=Math.max(0,Math.min(1,n-u)),h=Math.max(0,Math.min(1,m-a));a*=3;var _=h*h,b=_*h,w=1-h,T=w*w,L=T*w,M=1-y;for(o=0;o<g.length;o++)p=M*(d=g[o])[a][u]+y*d[a][u+1],c[o]=L*p+3*(T*h*(M*d[a+1][u]+y*d[a+1][u+1])+w*_*(M*d[a+2][u]+y*d[a+2][u+1]))+b*(M*d[a+3][u]+y*d[a+3][u+1]);return c}:function(c,n,m){c||(c=[]);var p,f,l,o=Math.max(0,Math.min(Math.floor(n),r)),d=Math.max(0,Math.min(Math.floor(m),i)),u=Math.max(0,Math.min(1,n-o)),a=Math.max(0,Math.min(1,m-d)),y=1-a,h=1-u;for(f=0;f<g.length;f++)p=h*(l=g[f])[d][o]+u*l[d][o+1],c[f]=y*p+a*(h*l[d+1][o]+u*l[d+1][o+1]);return c}}},{}],715:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./xy_defaults"),k=v("./ab_defaults"),x=v("./attributes"),e=v("../../components/color/attributes");Q.exports=function(r,i,c,n){function m(s,f){return g.coerce(r,i,x,s,f)}i._clipPathId="clip"+i.uid+"carpet";var p=m("color",e.defaultLine);g.coerceFont(m,"font"),m("carpet"),k(r,i,n,m,p),i.a&&i.b?(i.a.length<3&&(i.aaxis.smoothing=0),i.b.length<3&&(i.baxis.smoothing=0),t(r,i,m)||(i.visible=!1),i._cheater&&m("cheaterslope")):i.visible=!1}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),plot:v("./plot"),calc:v("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(v,Q,$){"use strict";Q.exports=function(g,t){for(var k,x=g._fullData.length,e=0;e<x;e++){var r=g._fullData[e];if(r.index!==t.index&&"carpet"===r.type&&(k||(k=r),r.carpet===t.carpet))return r}return k}},{}],718:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){if(0===g.length)return"";var x,e=[],r=k?3:1;for(x=0;x<g.length;x+=r)e.push(g[x]+","+t[x]),k&&x<g.length-r&&(e.push("C"),e.push([g[x+1]+","+t[x+1],g[x+2]+","+t[x+2]+" "].join(" ")));return e.join(k?"":"L")}},{}],719:[function(v,Q,$){"use strict";var g=v("../../lib").isArrayOrTypedArray;Q.exports=function(t,k,x){var e;for(g(t)?t.length>k.length&&(t=t.slice(0,k.length)):t=[],e=0;e<k.length;e++)t[e]=x(k[e]);return t}},{"../../lib":515}],720:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e,r){var i=e[0]*g.dpdx(t),c=e[1]*g.dpdy(k),n=1,m=1;if(r){var p=Math.sqrt(e[0]*e[0]+e[1]*e[1]),s=Math.sqrt(r[0]*r[0]+r[1]*r[1]);m=Math.max(0,(e[0]*r[0]+e[1]*r[1])/p/s)}var l=180*Math.atan2(c,i)/Math.PI;return l<-90?(l+=180,n=-n):l>90&&(l-=180,n=-n),{angle:l,flip:n,p:g.c2p(x,t,k),offsetMultplier:m}}},{}],721:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("./map_1d_array"),x=v("./makepath"),e=v("./orient_text"),r=v("../../lib/svg_text_utils"),i=v("../../lib"),c=i.strRotate,n=i.strTranslate,m=v("../../constants/alignment");function p(d,u,a,y,h,_){var b="const-"+h+"-lines",w=a.selectAll("."+b).data(_);w.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),w.each(function(T){var L=T,P=L.y,z=k([],L.x,d.c2p),S=k([],P,u.c2p),C="M"+x(z,S,L.smoothing);g.select(this).attr("d",C).style("stroke-width",L.width).style("stroke",L.color).style("stroke-dasharray",t.dashStyle(L.dash,L.width)).style("fill","none")}),w.exit().remove()}function s(d,u,a,y,h,_,b,w){var T=_.selectAll("text."+w).data(b);T.enter().append("text").classed(w,!0);var L=0,M={};return T.each(function(P,z){var S;if("auto"===P.axis.tickangle)S=e(y,u,a,P.xy,P.dxy);else{var C=(P.axis.tickangle+180)*Math.PI/180;S=e(y,u,a,P.xy,[Math.cos(C),Math.sin(C)])}z||(M={angle:S.angle,flip:S.flip});var R=(P.endAnchor?-1:1)*S.flip,D=g.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(t.font,P.font).text(P.text).call(r.convertToTspans,d),j=t.bBox(this);D.attr("transform",n(S.p[0],S.p[1])+c(S.angle)+n(P.axis.labelpadding*R,.3*j.height)),L=Math.max(L,j.width+P.axis.labelpadding)}),T.exit().remove(),M.maxExtent=L,M}Q.exports=function(d,u,a,y){var h=u.xaxis,_=u.yaxis,b=d._fullLayout._clips;i.makeTraceGroups(y,a,"trace").each(function(w){var T=g.select(this),L=w[0],M=L.trace,P=M.aaxis,z=M.baxis,S=i.ensureSingle(T,"g","minorlayer"),C=i.ensureSingle(T,"g","majorlayer"),R=i.ensureSingle(T,"g","boundarylayer"),D=i.ensureSingle(T,"g","labellayer");T.style("opacity",M.opacity),p(h,_,C,0,"a",P._gridlines),p(h,_,C,0,"b",z._gridlines),p(h,_,S,0,"a",P._minorgridlines),p(h,_,S,0,"b",z._minorgridlines),p(h,_,R,0,"a-boundary",P._boundarylines),p(h,_,R,0,"b-boundary",z._boundarylines);var Z,W,G,ne,V,N,U,ee,B,K,J,te,ae,ce,oe,j=s(d,h,_,M,0,D,P._labels,"a-label"),q=s(d,h,_,M,0,D,z._labels,"b-label");Z=d,W=D,G=M,ne=h,V=_,N=j,U=q,te=i.aggNums(Math.min,null,G.a),ae=i.aggNums(Math.max,null,G.a),ce=i.aggNums(Math.min,null,G.b),oe=i.aggNums(Math.max,null,G.b),K=G.ab2xy(ee=.5*(te+ae),B=ce,!0),J=G.dxyda_rough(ee,B),void 0===N.angle&&i.extendFlat(N,e(G,ne,V,K,G.dxydb_rough(ee,B))),o(Z,W,G,0,K,J,G.aaxis,ne,V,N,"a-title"),K=G.ab2xy(ee=te,B=.5*(ce+oe),!0),J=G.dxydb_rough(ee,B),void 0===U.angle&&i.extendFlat(U,e(G,ne,V,K,G.dxyda_rough(ee,B))),o(Z,W,G,0,K,J,G.baxis,ne,V,U,"b-title"),function(Z,W,G,X,ne){var V,N,U,ee,B=G.select("#"+Z._clipPathId);B.size()||(B=G.append("clipPath").classed("carpetclip",!0));var K=i.ensureSingle(B,"path","carpetboundary"),J=W.clipsegments,te=[];for(ee=0;ee<J.length;ee++)N=k([],(V=J[ee]).x,X.c2p),U=k([],V.y,ne.c2p),te.push(x(N,U,V.bicubic));var ae="M"+te.join("L")+"Z";B.attr("id",Z._clipPathId),K.attr("d",ae)}(M,L,b,h,_)})};var f=m.LINE_SPACING,l=(1-m.MID_SHIFT)/f+1;function o(d,u,a,y,h,_,b,w,T,L,M){var P=[];b.title.text&&P.push(b.title.text);var z=u.selectAll("text."+M).data(P),S=L.maxExtent;z.enter().append("text").classed(M,!0),z.each(function(){var C=e(a,w,T,h,_);-1===["start","both"].indexOf(b.showticklabels)&&(S=0);var R=b.title.font.size;S+=R+b.title.offset;var D=(L.angle+(L.flip<0?180:0)-C.angle+450)%360,j=D>90&&D<270,q=g.select(this);q.text(b.title.text).call(r.convertToTspans,d),j&&(S=(-r.lineCount(q)+l)*f*R-S),q.attr("transform",n(C.p[0],C.p[1])+c(C.angle)+n(0,S)).attr("text-anchor","middle").call(t.font,b.title.font)}),z.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(v,Q,$){"use strict";var g=v("./constants"),t=v("../../lib/search").findBin,k=v("./compute_control_points"),x=v("./create_spline_evaluator"),e=v("./create_i_derivative_evaluator"),r=v("./create_j_derivative_evaluator");Q.exports=function(i){var c=i._a,n=i._b,m=c.length,p=n.length,s=i.aaxis,f=i.baxis,l=c[0],o=c[m-1],d=n[0],u=n[p-1],a=c[c.length-1]-c[0],y=n[n.length-1]-n[0],h=a*g.RELATIVE_CULL_TOLERANCE,_=y*g.RELATIVE_CULL_TOLERANCE;l-=h,o+=h,d-=_,u+=_,i.isVisible=function(b,w){return b>l&&b<o&&w>d&&w<u},i.isOccluded=function(b,w){return b<l||b>o||w<d||w>u},i.setScale=function(){var T=k(i._xctrl,i._yctrl,i._x,i._y,s.smoothing,f.smoothing);i._xctrl=T[0],i._yctrl=T[1],i.evalxy=x([i._xctrl,i._yctrl],m,p,s.smoothing,f.smoothing),i.dxydi=e([i._xctrl,i._yctrl],s.smoothing,f.smoothing),i.dxydj=r([i._xctrl,i._yctrl],s.smoothing,f.smoothing)},i.i2a=function(b){var w=Math.max(0,Math.floor(b[0]),m-2),T=b[0]-w;return(1-T)*c[w]+T*c[w+1]},i.j2b=function(b){var w=Math.max(0,Math.floor(b[1]),m-2),T=b[1]-w;return(1-T)*n[w]+T*n[w+1]},i.ij2ab=function(b){return[i.i2a(b[0]),i.j2b(b[1])]},i.a2i=function(b){var w=Math.max(0,Math.min(t(b,c),m-2)),T=c[w];return Math.max(0,Math.min(m-1,w+(b-T)/(c[w+1]-T)))},i.b2j=function(b){var w=Math.max(0,Math.min(t(b,n),p-2)),T=n[w];return Math.max(0,Math.min(p-1,w+(b-T)/(n[w+1]-T)))},i.ab2ij=function(b){return[i.a2i(b[0]),i.b2j(b[1])]},i.i2c=function(b,w){return i.evalxy([],b,w)},i.ab2xy=function(b,w,T){if(!T&&(b<c[0]||b>c[m-1]|w<n[0]||w>n[p-1]))return[!1,!1];var L=i.a2i(b),M=i.b2j(w),P=i.evalxy([],L,M);if(T){var z,S,C,R,D=0,j=0,q=[];b<c[0]?(z=0,S=0,D=(b-c[0])/(c[1]-c[0])):b>c[m-1]?(z=m-2,S=1,D=(b-c[m-1])/(c[m-1]-c[m-2])):S=L-(z=Math.max(0,Math.min(m-2,Math.floor(L)))),w<n[0]?(C=0,R=0,j=(w-n[0])/(n[1]-n[0])):w>n[p-1]?(C=p-2,R=1,j=(w-n[p-1])/(n[p-1]-n[p-2])):R=M-(C=Math.max(0,Math.min(p-2,Math.floor(M)))),D&&(i.dxydi(q,z,C,S,R),P[0]+=q[0]*D,P[1]+=q[1]*D),j&&(i.dxydj(q,z,C,S,R),P[0]+=q[0]*j,P[1]+=q[1]*j)}return P},i.c2p=function(b,w,T){return[w.c2p(b[0]),T.c2p(b[1])]},i.p2x=function(b,w,T){return[w.p2c(b[0]),T.p2c(b[1])]},i.dadi=function(b){var w=Math.max(0,Math.min(c.length-2,b));return c[w+1]-c[w]},i.dbdj=function(b){var w=Math.max(0,Math.min(n.length-2,b));return n[w+1]-n[w]},i.dxyda=function(b,w,T,L){var M=i.dxydi(null,b,w,T,L),P=i.dadi(b,T);return[M[0]/P,M[1]/P]},i.dxydb=function(b,w,T,L){var M=i.dxydj(null,b,w,T,L),P=i.dbdj(w,L);return[M[0]/P,M[1]/P]},i.dxyda_rough=function(b,w,T){var L=a*(T||.1),M=i.ab2xy(b+L,w,!0),P=i.ab2xy(b-L,w,!0);return[.5*(M[0]-P[0])/L,.5*(M[1]-P[1])/L]},i.dxydb_rough=function(b,w,T){var L=y*(T||.1),M=i.ab2xy(b,w+L,!0),P=i.ab2xy(b,w-L,!0);return[.5*(M[0]-P[0])/L,.5*(M[1]-P[1])/L]},i.dpdx=function(b){return b._m},i.dpdy=function(b){return b._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k,x){var e,r,i,c=[],n=[],m=t[0].length,p=t.length;var f,l,o,d,u,a,y,h,_,b,W,G,X,ne,V,T=0;for(e=0;e<m;e++)for(r=0;r<p;r++)void 0===t[r][e]&&(c.push(e),n.push(r),t[r][e]=(G=r,X=void 0,ne=void 0,V=void 0,ne=0,V=0,(W=e)>0&&void 0!==(X=t[G][W-1])&&(V++,ne+=X),W<m-1&&void 0!==(X=t[G][W+1])&&(V++,ne+=X),G>0&&void 0!==(X=t[G-1][W])&&(V++,ne+=X),G<p-1&&void 0!==(X=t[G+1][W])&&(V++,ne+=X),ne/Math.max(1,V))),T=Math.max(T,Math.abs(t[r][e]));if(!c.length)return t;var L=0,M=0,P=c.length;do{for(L=0,i=0;i<P;i++){r=n[i];var S,C,R,D,j,q=0,Z=0;0===(e=c[i])?(C=k[D=Math.min(m-1,2)],Z+=(S=t[r][1])+(S-t[r][D])*(k[0]-(R=k[1]))/(R-C),q++):e===m-1&&(C=k[D=Math.max(0,m-3)],Z+=(S=t[r][m-2])+(S-t[r][D])*(k[m-1]-(R=k[m-2]))/(R-C),q++),(0===e||e===m-1)&&r>0&&r<p-1&&(Z+=((l=x[r]-x[r-1])*t[r+1][e]+(f=x[r+1]-x[r])*t[r-1][e])/(l+f),q++),0===r?(C=x[j=Math.min(p-1,2)],Z+=(S=t[1][e])+(S-t[j][e])*(x[0]-(R=x[1]))/(R-C),q++):r===p-1&&(C=x[j=Math.max(0,p-3)],Z+=(S=t[p-2][e])+(S-t[j][e])*(x[p-1]-(R=x[p-2]))/(R-C),q++),(0===r||r===p-1)&&e>0&&e<m-1&&(Z+=((l=k[e]-k[e-1])*t[r][e+1]+(f=k[e+1]-k[e])*t[r][e-1])/(l+f),q++),q?Z/=q:(h=(u=x[r+1]-x[r])*(a=x[r]-x[r-1])*(u+a),Z=((y=(o=k[e+1]-k[e])*(d=k[e]-k[e-1])*(o+d))*(a*t[r+1][e]+u*t[r-1][e])+h*(d*t[r][e+1]+o*t[r][e-1]))/(h*(d+o)+y*(a+u))),L+=(b=(_=Z-t[r][e])/T)*b,t[r][e]+=_*(1+(q?0:.85))}L=Math.sqrt(L)}while(M++<100&&L>1e-5);return g.log("Smoother converged to",L,"after",M,"iterations"),t}},{"../../lib":515}],724:[function(v,Q,$){"use strict";var g=v("../../lib").isArray1D;Q.exports=function(t,k,x){var e=x("x"),r=e&&e.length,i=x("y"),c=i&&i.length;if(!r&&!c)return!1;if(k._cheater=!e,r&&!g(e)||c&&!g(i))k._length=null;else{var n=r?e.length:1/0;c&&(n=Math.min(n,i.length)),k.a&&k.a.length&&(n=Math.min(n,k.a.length)),k.b&&k.b.length&&(n=Math.min(n,k.b.length)),k._length=n}return!0}},{"../../lib":515}],725:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../scattergeo/attributes"),k=v("../../components/colorscale/attributes"),x=v("../../plots/attributes"),e=v("../../components/color/attributes").defaultLine,r=v("../../lib/extend").extendFlat,i=t.marker.line;Q.exports=r({locations:{valType:"data_array",editType:"calc"},locationmode:t.locationmode,z:{valType:"data_array",editType:"calc"},geojson:r({},t.geojson,{}),featureidkey:t.featureidkey,text:r({},t.text,{}),hovertext:r({},t.hovertext,{}),marker:{line:{color:r({},i.color,{dflt:e}),width:r({},i.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:t.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:t.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:r({},x.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:g(),showlegend:r({},x.showlegend,{dflt:!1})},k("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../constants/numerical").BADNUM,k=v("../../components/colorscale/calc"),x=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection");function r(i){return i&&"string"==typeof i}Q.exports=function(i,c){var n,m=c._length,p=new Array(m);n=c.geojson?function(d){return r(d)||g(d)}:r;for(var s=0;s<m;s++){var f=p[s]={},l=c.locations[s],o=c.z[s];n(l)&&g(o)?(f.loc=l,f.z=o):(f.loc=null,f.z=t),f.index=s}return x(p,c),k(i,c,{vals:c.z,containerStr:"",cLetter:"z"}),e(p,c),p}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/defaults"),k=v("./attributes");Q.exports=function(x,e,r,i){function c(f,l){return g.coerce(x,e,k,f,l)}var n=c("locations"),m=c("z");if(n&&n.length&&g.isArrayOrTypedArray(m)&&m.length){e._length=Math.min(n.length,m.length);var p,s=c("geojson");("string"==typeof s&&""!==s||g.isPlainObject(s))&&(p="geojson-id"),"geojson-id"===c("locationmode",p)&&c("featureidkey"),c("text"),c("hovertext"),c("hovertemplate"),c("marker.line.width")&&c("marker.line.color"),c("marker.opacity"),t(x,e,i,c,{prefix:"",cLetter:"z"}),g.coerceSelectionMarkerOpacity(e,c)}else e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){g.location=t.location,g.z=t.z;var r=x[e];return r.fIn&&r.fIn.properties&&(g.properties=r.fIn.properties),g.ct=r.ct,g}},{}],729:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("./attributes"),k=v("../../lib").fillText;Q.exports=function(x,e,r){var i,c,n,m,p=x.cd,s=p[0].trace,f=x.subplot,l=[e,r],o=[e+360,r];for(c=0;c<p.length;c++)if(m=!1,(i=p[c])._polygons){for(n=0;n<i._polygons.length;n++)i._polygons[n].contains(l)&&(m=!m),i._polygons[n].contains(o)&&(m=!m);if(m)break}if(m&&i)return x.x0=x.x1=x.xa.c2p(i.ct),x.y0=x.y1=x.ya.c2p(i.ct),x.index=i.index,x.location=i.loc,x.z=i.z,x.zLabel=g.tickText(f.mockAxis,f.mockAxis.c2l(i.z),"hover").text,x.hovertemplate=i.hovertemplate,function(d,u,a){if(!u.hovertemplate){var y=a.hi||u.hoverinfo,h=String(a.loc),_="all"===y?t.hoverinfo.flags:y.split("+"),b=-1!==_.indexOf("name"),w=-1!==_.indexOf("location"),T=-1!==_.indexOf("z"),L=-1!==_.indexOf("text"),M=[];!b&&w?d.nameOverride=h:(b&&(d.nameOverride=u.name),w&&M.push(h)),T&&M.push(d.zLabel),L&&k(a,u,M),d.extraText=M.join("<br>")}}(x,s,i),[x]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("./calc"),calcGeoJSON:v("./plot").calcGeoJSON,plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"choropleth",basePlotModule:v("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../lib/geo_location_utils"),x=v("../../lib/topojson_utils").getTopojsonFeatures,e=v("../../plots/cartesian/autorange").findExtremes,r=v("./style").style;Q.exports={calcGeoJSON:function(i,c){for(var n=i[0].trace,m=c[n.geo],p=m._subplot,s=n.locationmode,f=n._length,l="geojson-id"===s?k.extractTraceFeature(i):x(n,p.topojson),o=[],d=[],u=0;u<f;u++){var a=i[u],y="geojson-id"===s?a.fOut:k.locationToFeature(s,a.loc,l);if(y){a.geojson=y,a.ct=y.properties.ct,a._polygons=k.feature2polygons(y);var h=k.computeBbox(y);o.push(h[0],h[2]),d.push(h[1],h[3])}else a.geojson=null}if("geojson"===m.fitbounds&&"geojson-id"===s){var _=k.computeBbox(k.getTraceGeojson(n));o=[_[0],_[2]],d=[_[1],_[3]]}var b={padded:!0};n._extremes.lon=e(m.lonaxis._ax,o,b),n._extremes.lat=e(m.lataxis._ax,d,b)},plot:function(i,c,n){var m=c.layers.backplot.select(".choroplethlayer");t.makeTraceGroups(m,n,"trace choropleth").each(function(p){var s=g.select(this).selectAll("path.choroplethlocation").data(t.identity);s.enter().append("path").classed("choroplethlocation",!0),s.exit().remove(),r(i,p)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(v,Q,$){"use strict";Q.exports=function(g,t){var k,x,e,r,i,c=g.cd,n=g.xaxis,m=g.yaxis,p=[];if(!1===t)for(k=0;k<c.length;k++)c[k].selected=0;else for(k=0;k<c.length;k++)(e=(x=c[k]).ct)&&(r=n.c2p(e),i=m.c2p(e),t.contains([r,i],null,k,g)?(p.push({pointNumber:k,lon:e[0],lat:e[1]}),x.selected=1):x.selected=0);return p}},{}],733:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../../components/drawing"),x=v("../../components/colorscale");function e(r,i){var c=i[0].trace,n=i[0].node3.selectAll(".choroplethlocation"),m=c.marker||{},p=m.line||{},s=x.makeColorScaleFuncFromTrace(c);n.each(function(f){g.select(this).attr("fill",s(f.z)).call(t.stroke,f.mlc||p.color).call(k.dashLine,"",f.mlw||p.width||0).style("opacity",m.opacity)}),k.selectedPointStyle(n,c)}Q.exports={style:function(r,i){i&&e(0,i)},styleOnSelect:function(r,i){var n=i[0].trace;n.selectedpoints?k.selectedPointStyle(i[0].node3.selectAll(".choroplethlocation"),n):e(0,i)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(v,Q,$){"use strict";var g=v("../choropleth/attributes"),t=v("../../components/colorscale/attributes"),k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/attributes"),e=v("../../lib/extend").extendFlat;Q.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},g.featureidkey,{}),below:{valType:"string",editType:"plot"},text:g.text,hovertext:g.hovertext,marker:{line:{color:e({},g.marker.line.color,{editType:"plot"}),width:e({},g.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},g.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},g.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},g.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:g.hoverinfo,hovertemplate:k({},{keys:["properties"]}),showlegend:e({},x.showlegend,{dflt:!1})},t("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../components/colorscale"),x=v("../../components/drawing"),e=v("../../lib/geojson_utils").makeBlank,r=v("../../lib/geo_location_utils");function i(c){var n,m=c[0].trace,p=m._opts;if(m.selectedpoints){for(var s=x.makeSelectedPointStyleFns(m),f=0;f<c.length;f++){var l=c[f];l.fOut&&(l.fOut.properties.mo2=s.selectedOpacityFn(l))}n={type:"identity",property:"mo2"}}else n=t.isArrayOrTypedArray(m.marker.opacity)?{type:"identity",property:"mo"}:m.marker.opacity;return t.extendFlat(p.fill.paint,{"fill-opacity":n}),t.extendFlat(p.line.paint,{"line-opacity":n}),p}Q.exports={convert:function(c){var n=c[0].trace,m=!0===n.visible&&0!==n._length,p={layout:{visibility:"none"},paint:{}},s={layout:{visibility:"none"},paint:{}},f=n._opts={fill:p,line:s,geojson:e()};if(!m)return f;var l=r.extractTraceFeature(c);if(!l)return f;var o,d,u,a=k.makeColorScaleFuncFromTrace(n),y=n.marker,h=y.line||{};t.isArrayOrTypedArray(y.opacity)&&(o=function(M){var P=M.mo;return g(P)?+t.constrain(P,0,1):0}),t.isArrayOrTypedArray(h.color)&&(d=function(M){return M.mlc}),t.isArrayOrTypedArray(h.width)&&(u=function(M){return M.mlw});for(var _=0;_<c.length;_++){var b=c[_],w=b.fOut;if(w){var T=w.properties;T.fc=a(b.z),o&&(T.mo=o(b)),d&&(T.mlc=d(b)),u&&(T.mlw=u(b)),b.ct=T.ct,b._polygons=r.feature2polygons(w)}}var L=o?{type:"identity",property:"mo"}:y.opacity;return t.extendFlat(p.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),t.extendFlat(s.paint,{"line-color":d?{type:"identity",property:"mlc"}:h.color,"line-width":u?{type:"identity",property:"mlw"}:h.width,"line-opacity":L}),p.layout.visibility="visible",s.layout.visibility="visible",f.geojson={type:"FeatureCollection",features:l},i(c),f},convertOnSelect:i}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/defaults"),k=v("./attributes");Q.exports=function(x,e,r,i){function c(s,f){return g.coerce(x,e,k,s,f)}var n=c("locations"),m=c("z"),p=c("geojson");g.isArrayOrTypedArray(n)&&n.length&&g.isArrayOrTypedArray(m)&&m.length&&("string"==typeof p&&""!==p||g.isPlainObject(p))?(c("featureidkey"),e._length=Math.min(n.length,m.length),c("below"),c("text"),c("hovertext"),c("hovertemplate"),c("marker.line.width")&&c("marker.line.color"),c("marker.opacity"),t(x,e,i,c,{prefix:"",cLetter:"z"}),g.coerceSelectionMarkerOpacity(e,c)):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("../choropleth/calc"),plot:v("./plot"),hoverPoints:v("../choropleth/hover"),eventData:v("../choropleth/event_data"),selectPoints:v("../choropleth/select"),styleOnSelect:function(g,t){t&&t[0].trace._glTrace.updateOnSelect(t)},getBelow:function(g,t){for(var k=t.getMapLayers(),x=k.length-2;x>=0;x--){var e=k[x].id;if("string"==typeof e&&0===e.indexOf("water"))for(var r=x+1;r<k.length;r++)if("string"==typeof(e=k[r].id)&&-1===e.indexOf("plotly-"))return e}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(v,Q,$){"use strict";var g=v("./convert").convert,t=v("./convert").convertOnSelect,k=v("../../plots/mapbox/constants").traceLayerPrefix;function x(r,i){this.type="choroplethmapbox",this.subplot=r,this.uid=i,this.sourceId="source-"+i,this.layerList=[["fill",k+i+"-fill"],["line",k+i+"-line"]],this.below=null}var e=x.prototype;e.update=function(r){this._update(g(r)),r[0].trace._glTrace=this},e.updateOnSelect=function(r){this._update(t(r))},e._update=function(r){var i=this.subplot,c=this.layerList,n=i.belowLookup["trace-"+this.uid];i.map.getSource(this.sourceId).setData(r.geojson),n!==this.below&&(this._removeLayers(),this._addLayers(r,n),this.below=n);for(var m=0;m<c.length;m++){var p=c[m],f=p[1],l=r[p[0]];i.setOptions(f,"setLayoutProperty",l.layout),"visible"===l.layout.visibility&&i.setOptions(f,"setPaintProperty",l.paint)}},e._addLayers=function(r,i){for(var c=this.subplot,n=this.layerList,m=this.sourceId,p=0;p<n.length;p++){var s=n[p],f=s[0],l=r[f];c.addLayer({type:f,id:s[1],source:m,layout:l.layout,paint:l.paint},i)}},e._removeLayers=function(){for(var r=this.subplot.map,i=this.layerList,c=i.length-1;c>=0;c--)r.removeLayer(i[c][1])},e.dispose=function(){var r=this.subplot.map;this._removeLayers(),r.removeSource(this.sourceId)},Q.exports=function(r,i){var c=i[0].trace,n=new x(r,c.uid),m=n.sourceId,p=g(i),s=n.below=r.belowLookup["trace-"+c.uid];return r.map.addSource(m,{type:"geojson",data:p.geojson}),n._addLayers(p,s),i[0].trace._glTrace=n,n}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../mesh3d/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,i={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:k({editType:"calc"},{keys:["norm"]}),uhoverformat:t("u",1),vhoverformat:t("v",1),whoverformat:t("w",1),xhoverformat:t("x"),yhoverformat:t("y"),zhoverformat:t("z"),showlegend:r({},e.showlegend,{dflt:!1})};r(i,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(c){i[c]=x[c]}),i.hoverinfo=r({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),i.transforms=void 0,Q.exports=i},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/calc");Q.exports=function(t,k){for(var x=k.u,e=k.v,r=k.w,i=Math.min(k.x.length,k.y.length,k.z.length,x.length,e.length,r.length),c=-1/0,n=1/0,m=0;m<i;m++){var p=x[m],s=e[m],f=r[m],l=Math.sqrt(p*p+s*s+f*f);c=Math.max(c,l),n=Math.min(n,l)}k._len=i,k._normMax=c,g(t,k,{vals:[n,c],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_cone3d,t=v("../../../stackgl_modules").gl_cone3d.createConeMesh,k=v("../../lib").simpleMap,x=v("../../lib/gl_format_color").parseColorScale,e=v("../../components/colorscale").extractOpts,r=v("../../plots/gl3d/zip3");function i(f,l){this.scene=f,this.uid=l,this.mesh=null,this.data=null}var c=i.prototype;c.handlePick=function(f){if(f.object===this.mesh){var l=f.index=f.data.index,a=this.data.u[l],y=this.data.v[l],h=this.data.w[l];f.traceCoordinate=[this.data.x[l],this.data.y[l],this.data.z[l],a,y,h,Math.sqrt(a*a+y*y+h*h)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&void 0!==_[l]?f.textLabel=_[l]:_&&(f.textLabel=_),!0}};var n={xaxis:0,yaxis:1,zaxis:2},m={tip:1,tail:0,cm:.25,center:.5},p={tip:1,tail:1,cm:.75,center:.5};function s(f,l){var o=f.fullSceneLayout,d=f.dataScale,u={};function a(b,w){var T=o[w],L=d[n[w]];return k(b,function(M){return T.d2l(M)*L})}u.vectors=r(a(l.u,"xaxis"),a(l.v,"yaxis"),a(l.w,"zaxis"),l._len),u.positions=r(a(l.x,"xaxis"),a(l.y,"yaxis"),a(l.z,"zaxis"),l._len);var y=e(l);u.colormap=x(l),u.vertexIntensityBounds=[y.min/l._normMax,y.max/l._normMax],u.coneOffset=m[l.anchor],u.coneSize="scaled"===l.sizemode?l.sizeref||.5:l.sizeref&&l._normMax?l.sizeref/l._normMax:.5;var h=g(u),_=l.lightposition;return h.lightPosition=[_.x,_.y,_.z],h.ambient=l.lighting.ambient,h.diffuse=l.lighting.diffuse,h.specular=l.lighting.specular,h.roughness=l.lighting.roughness,h.fresnel=l.lighting.fresnel,h.opacity=l.opacity,l._pad=p[l.anchor]*h.vectorScale*h.coneScale*l._normMax,h}c.update=function(f){this.data=f;var l=s(this.scene,f);this.mesh.update(l)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Q.exports=function(f,l){var o=f.glplot.gl,d=s(f,l),u=t(o,d),a=new i(f,l.uid);return a.mesh=u,a.data=l,u._trace=a,f.glplot.add(u),a}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/defaults"),k=v("./attributes");Q.exports=function(x,e,r,i){function c(o,d){return g.coerce(x,e,k,o,d)}var n=c("u"),m=c("v"),p=c("w"),s=c("x"),f=c("y"),l=c("z");n&&n.length&&m&&m.length&&p&&p.length&&s&&s.length&&f&&f.length&&l&&l.length?(c("sizeref"),c("sizemode"),c("anchor"),c("lighting.ambient"),c("lighting.diffuse"),c("lighting.specular"),c("lighting.roughness"),c("lighting.fresnel"),c("lightposition.x"),c("lightposition.y"),c("lightposition.z"),t(x,e,i,c,{prefix:"",cLetter:"c"}),c("text"),c("hovertext"),c("hovertemplate"),c("uhoverformat"),c("vhoverformat"),c("whoverformat"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"cone",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:v("./calc"),plot:v("./convert"),eventData:function(g,t){return g.norm=t.traceCoordinate[6],g},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(v,Q,$){"use strict";var g=v("../heatmap/attributes"),t=v("../scatter/attributes"),k=v("../../plots/cartesian/axis_format_attributes"),x=k.axisHoverFormat,e=k.descriptionOnlyNumbers,r=v("../../components/colorscale/attributes"),i=v("../../components/drawing/attributes").dash,c=v("../../plots/font_attributes"),n=v("../../lib/extend").extendFlat,m=v("../../constants/filter_ops"),p=m.COMPARISON_OPS2,s=m.INTERVAL_OPS,f=t.line;Q.exports=n({z:g.z,x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,text:g.text,hovertext:g.hovertext,transpose:g.transpose,xtype:g.xtype,ytype:g.ytype,xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:g.hovertemplate,texttemplate:n({},g.texttemplate,{}),textfont:n({},g.textfont,{}),hoverongaps:g.hoverongaps,connectgaps:n({},g.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:c({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(p).concat(s),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:n({},f.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:i,smoothing:n({},f.smoothing,{}),editType:"plot"}},r("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(v,Q,$){"use strict";var g=v("../../components/colorscale"),t=v("../heatmap/calc"),k=v("./set_contours"),x=v("./end_plus");Q.exports=function(e,r){var i=t(e,r),c=i[0].z;k(r,c);var n,m=r.contours,p=g.extractOpts(r);if("heatmap"===m.coloring&&p.auto&&!1===r.autocontour){var s=m.start,f=x(m),l=m.size||1,o=Math.floor((f-s)/l)+1;isFinite(l)||(l=1,o=1);var d=s-l/2;n=[d,d+o*l]}else n=c;return g.calc(e,r,{vals:n,cLetter:"z"}),i}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(v,Q,$){"use strict";Q.exports=function(g,t){var k,x=g[0],e=x.z;switch(t.type){case"levels":var r=Math.min(e[0][0],e[0][1]);for(k=0;k<g.length;k++){var i=g[k];i.prefixBoundary=!i.edgepaths.length&&(r>i.level||i.starts.length&&r===i.level)}break;case"constraint":if(x.prefixBoundary=!1,x.edgepaths.length)return;var c=x.x.length,n=x.y.length,m=-1/0,p=1/0;for(k=0;k<n;k++)p=Math.min(p,e[k][0]),p=Math.min(p,e[k][c-1]),m=Math.max(m,e[k][0]),m=Math.max(m,e[k][c-1]);for(k=1;k<c-1;k++)p=Math.min(p,e[0][k]),p=Math.min(p,e[n-1][k]),m=Math.max(m,e[0][k]),m=Math.max(m,e[n-1][k]);var s,f,l=t.value;switch(t._operation){case">":l>m&&(x.prefixBoundary=!0);break;case"<":(l<p||x.starts.length&&l===p)&&(x.prefixBoundary=!0);break;case"[]":s=Math.min(l[0],l[1]),((f=Math.max(l[0],l[1]))<p||s>m||x.starts.length&&f===p)&&(x.prefixBoundary=!0);break;case"][":s=Math.min(l[0],l[1]),f=Math.max(l[0],l[1]),s<p&&f>m&&(x.prefixBoundary=!0)}}}},{}],747:[function(v,Q,$){"use strict";var g=v("../../components/colorscale"),t=v("./make_color_map"),k=v("./end_plus");Q.exports={min:"zmin",max:"zmax",calc:function(x,e,r){var i=e.contours,c=e.line,n=i.size||1,m=i.coloring,p=t(e,{isColorbar:!0});if("heatmap"===m){var s=g.extractOpts(e);r._fillgradient=s.reversescale?g.flipScale(s.colorscale):s.colorscale,r._zrange=[s.min,s.max]}else"fill"===m&&(r._fillcolor=p);r._line={color:"lines"===m?p:c.color,width:!1!==i.showlines?c.width:0,dash:c.dash},r._levels={start:i.start,end:k(i),size:n}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(v,Q,$){"use strict";Q.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("./label_defaults"),k=v("../../components/color"),x=k.addOpacity,e=k.opacity,r=v("../../constants/filter_ops"),i=r.CONSTRAINT_REDUCTION,c=r.COMPARISON_OPS2;Q.exports=function(n,m,p,s,f,l){var o,d,u,h,_,b,a=m.contours,y=p("contours.operation");a._operation=i[y],h=p,-1===c.indexOf((_=a).operation)?(h("contours.value",[0,1]),Array.isArray(_.value)?_.value.length>2?_.value=_.value.slice(2):0===_.length?_.value=[0,1]:_.length<2?(b=parseFloat(_.value[0]),_.value=[b,b+1]):_.value=[parseFloat(_.value[0]),parseFloat(_.value[1])]:g(_.value)&&(b=parseFloat(_.value),_.value=[b,b+1])):(h("contours.value",0),g(_.value)||(_.value=Array.isArray(_.value)?parseFloat(_.value[0]):0)),"="===y?o=a.showlines=!0:(o=p("contours.showlines"),u=p("fillcolor",x((n.line||{}).color||f,.5))),o&&(d=p("line.color",u&&e(u)?x(m.fillcolor,1):f),p("line.width",2),p("line.dash")),p("line.smoothing"),t(p,s,d,l)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(v,Q,$){"use strict";var g=v("../../constants/filter_ops"),t=v("fast-isnumeric");function k(r,i){var c,n=Array.isArray(i);function m(p){return t(p)?+p:null}return-1!==g.COMPARISON_OPS2.indexOf(r)?c=m(n?i[0]:i):-1!==g.INTERVAL_OPS.indexOf(r)?c=n?[m(i[0]),m(i[1])]:[m(i),m(i)]:-1!==g.SET_OPS.indexOf(r)&&(c=n?i.map(m):[m(i)]),c}function x(r){return function(i){i=k(r,i);var c=Math.min(i[0],i[1]),n=Math.max(i[0],i[1]);return{start:c,end:n,size:n-c}}}function e(r){return function(i){return{start:i=k(r,i),end:1/0,size:1/0}}}Q.exports={"[]":x("[]"),"][":x("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x){var e=x("contours.start"),r=x("contours.end"),i=!1===e||!1===r,c=k("contours.size");!(i?t.autocontour=!0:k("autocontour",!1))&&c||k("ncontours")}},{}],752:[function(v,Q,$){"use strict";var g=v("../../lib");function t(k){return g.extendFlat({},k,{edgepaths:g.extendDeep([],k.edgepaths),paths:g.extendDeep([],k.paths),starts:g.extendDeep([],k.starts)})}Q.exports=function(k,x){var e,r,i,c=function(p){return p.reverse()},n=function(p){return p};switch(x){case"=":case"<":return k;case">":for(1!==k.length&&g.warn("Contour data invalid for the specified inequality operation."),r=k[0],e=0;e<r.edgepaths.length;e++)r.edgepaths[e]=c(r.edgepaths[e]);for(e=0;e<r.paths.length;e++)r.paths[e]=c(r.paths[e]);for(e=0;e<r.starts.length;e++)r.starts[e]=c(r.starts[e]);return k;case"][":var m=c;c=n,n=m;case"[]":for(2!==k.length&&g.warn("Contour data invalid for the specified inequality range operation."),r=t(k[0]),i=t(k[1]),e=0;e<r.edgepaths.length;e++)r.edgepaths[e]=c(r.edgepaths[e]);for(e=0;e<r.paths.length;e++)r.paths[e]=c(r.paths[e]);for(e=0;e<r.starts.length;e++)r.starts[e]=c(r.starts[e]);for(;i.edgepaths.length;)r.edgepaths.push(n(i.edgepaths.shift()));for(;i.paths.length;)r.paths.push(n(i.paths.shift()));for(;i.starts.length;)r.starts.push(n(i.starts.shift()));return[r]}}},{"../../lib":515}],753:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../heatmap/xyz_defaults"),k=v("../scatter/period_defaults"),x=v("./constraint_defaults"),e=v("./contours_defaults"),r=v("./style_defaults"),i=v("../heatmap/label_defaults"),c=v("./attributes");Q.exports=function(n,m,p,s){function f(o,d){return g.coerce(n,m,c,o,d)}if(t(n,m,f,s)){k(n,m,s,f),f("xhoverformat"),f("yhoverformat"),f("text"),f("hovertext"),f("hoverongaps"),f("hovertemplate");var l="constraint"===f("contours.type");f("connectgaps",g.isArray1D(m.z)),l?x(n,m,f,s,p):(e(n,m,f,function(o){return g.coerce2(n,m,c,o)}),r(n,m,f,s)),m.contours&&"heatmap"===m.contours.coloring&&i(f,s)}else m.visible=!1}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./constraint_mapping"),k=v("./end_plus");Q.exports=function(x,e,r){for(var i="constraint"===x.type?t[x._operation](x.value):x,c=i.size,n=[],m=k(i),p=r.trace._carpetTrace,s=p?{xaxis:p.aaxis,yaxis:p.baxis,x:r.a,y:r.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:r.x,y:r.y},f=i.start;f<m;f+=c)if(n.push(g.extendFlat({level:f,crossings:{},starts:[],edgepaths:[],paths:[],z:r.z,smoothing:r.trace.line.smoothing},s)),n.length>1e3){g.warn("Too many contours, clipping at 1000",x);break}return n}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(v,Q,$){"use strict";Q.exports=function(g){return g.end+g.size/1e6}},{}],756:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./constants");function k(r,i,c,n){return Math.abs(r[0]-i[0])<c&&Math.abs(r[1]-i[1])<n}function x(r,i,c,n,m){var p,K,te,ae,ce,s=i.join(","),f=r.crossings[s],l=(te=i,ae=0,ce=0,(K=f)>20&&c?208===K||1114===K?ae=0===te[0]?1:-1:ce=0===te[1]?1:-1:-1!==t.BOTTOMSTART.indexOf(K)?ce=1:-1!==t.LEFTSTART.indexOf(K)?ae=1:-1!==t.TOPSTART.indexOf(K)?ce=-1:ae=-1,[ae,ce]),o=[e(r,i,[-l[0],-l[1]])],d=r.z.length,u=r.z[0].length,a=i.slice(),y=l.slice();for(p=0;p<1e4;p++){if(f>20?r.crossings[s]=t.SADDLEREMAINDER[f=t.CHOOSESADDLE[f][(l[0]||l[1])<0?0:1]]:delete r.crossings[s],!(l=t.NEWDELTA[f])){g.log("Found bad marching index:",f,i,r.level);break}if(o.push(e(r,i,l)),i[0]+=l[0],i[1]+=l[1],s=i.join(","),k(o[o.length-1],o[o.length-2],n,m)&&o.pop(),i[0]===a[0]&&i[1]===a[1]&&l[0]===y[0]&&l[1]===y[1]||c&&(l[0]&&(i[0]<0||i[0]>u-2)||l[1]&&(i[1]<0||i[1]>d-2)))break;f=r.crossings[s]}1e4===p&&g.log("Infinite loop in contour?");var _,b,w,T,L,M,P,z,S,C,R,D,j,q,Z,W=k(o[0],o[o.length-1],n,m),G=0,X=.2*r.smoothing,ne=[],V=0;for(p=1;p<o.length;p++)void 0,void 0,q=(D=o[p])[2]-(j=o[p-1])[2],Z=D[3]-j[3],G+=P=Math.sqrt(q*q+Z*Z),ne.push(P);var N=G/ne.length*X;function U(K){return o[K%o.length]}for(p=o.length-2;p>=V;p--)if((_=ne[p])<N){for(w=0,b=p-1;b>=V&&_+ne[b]<N;b--)_+=ne[b];if(W&&p===o.length-2)for(w=0;w<b&&_+ne[w]<N;w++)_+=ne[w];L=p-b+w+1,M=Math.floor((p+b+w+2)/2),T=W||p!==o.length-2?W||-1!==b?L%2?U(M):[(U(M)[0]+U(M+1)[0])/2,(U(M)[1]+U(M+1)[1])/2]:o[0]:o[o.length-1],o.splice(b+1,p-b+1,T),p=b+1,w&&(V=w),W&&(p===o.length-2?o[w]=o[o.length-1]:0===p&&(o[o.length-1]=o[0]))}for(o.splice(0,V),p=0;p<o.length;p++)o[p].length=2;if(!(o.length<2))if(W)o.pop(),r.paths.push(o);else{c||g.log("Unclosed interior contour?",r.level,a.join(","),o.join("L"));var ee=!1;for(z=0;z<r.edgepaths.length;z++)if(C=r.edgepaths[z],!ee&&k(C[0],o[o.length-1],n,m)){o.pop(),ee=!0;var B=!1;for(S=0;S<r.edgepaths.length;S++)if(k((R=r.edgepaths[S])[R.length-1],o[0],n,m)){B=!0,o.shift(),r.edgepaths.splice(z,1),S===z?r.paths.push(o.concat(R)):(S>z&&S--,r.edgepaths[S]=R.concat(o,C));break}B||(r.edgepaths[z]=o.concat(C))}for(z=0;z<r.edgepaths.length&&!ee;z++)k((C=r.edgepaths[z])[C.length-1],o[0],n,m)&&(o.shift(),r.edgepaths[z]=C.concat(o),ee=!0);ee||r.edgepaths.push(o)}}function e(r,i,c){var n=i[0]+Math.max(c[0],0),m=i[1]+Math.max(c[1],0),p=r.z[m][n],s=r.xaxis,f=r.yaxis;if(c[1]){var l=(r.level-p)/(r.z[m][n+1]-p),o=(1!==l?(1-l)*s.c2l(r.x[n]):0)+(0!==l?l*s.c2l(r.x[n+1]):0);return[s.c2p(s.l2c(o),!0),f.c2p(r.y[m],!0),n+l,m]}var d=(r.level-p)/(r.z[m+1][n]-p),u=(1!==d?(1-d)*f.c2l(r.y[m]):0)+(0!==d?d*f.c2l(r.y[m+1]):0);return[s.c2p(r.x[n],!0),f.c2p(f.l2c(u),!0),n,m+d]}Q.exports=function(r,i,c){var n,m,p,s;for(i=i||.01,c=c||.01,m=0;m<r.length;m++){for(p=r[m],s=0;s<p.starts.length;s++)x(p,p.starts[s],"edge",i,c);for(n=0;Object.keys(p.crossings).length&&n<1e4;)n++,x(p,Object.keys(p.crossings)[0].split(",").map(Number),void 0,i,c);1e4===n&&g.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../heatmap/hover");Q.exports=function(k,x,e,r,i){i||(i={}),i.isContour=!0;var c=t(k,x,e,r,i);return c&&c.forEach(function(n){var m=n.trace;"constraint"===m.contours.type&&(m.fillcolor&&g.opacity(m.fillcolor)?n.color=g.addOpacity(m.fillcolor,1):m.contours.showlines&&g.opacity(m.line.color)&&(n.color=g.addOpacity(m.line.color,1)))}),c}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot").plot,style:v("./style"),colorbar:v("./colorbar"),hoverPoints:v("./hover"),moduleType:"trace",name:"contour",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k,x,e){if(e||(e={}),t("contours.showlabels")){var r=k.font;g.coerceFont(t,"contours.labelfont",{family:r.family,size:r.size,color:x}),t("contours.labelformat")}!1!==e.hasHover&&t("zhoverformat")}},{"../../lib":515}],760:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/colorscale"),k=v("./end_plus");Q.exports=function(x){var e=x.contours,r=e.start,i=k(e),c=e.size||1,n=Math.floor((i-r)/c)+1,m="lines"===e.coloring?0:1,p=t.extractOpts(x);isFinite(c)||(c=1,n=1);var s,f,l=p.reversescale?t.flipScale(p.colorscale):p.colorscale,o=l.length,d=new Array(o),u=new Array(o);if("heatmap"===e.coloring){var a=p.min,y=p.max;for(f=0;f<o;f++)d[f]=(s=l[f])[0]*(y-a)+a,u[f]=s[1];var h=g.extent([a,y,e.start,e.start+c*(n-1)]),_=h[a<y?0:1],b=h[a<y?1:0];_!==a&&(d.splice(0,0,_),u.splice(0,0,u[0])),b!==y&&(d.push(b),u.push(u[u.length-1]))}else for(f=0;f<o;f++)d[f]=((s=l[f])[0]*(n+m-1)-m/2)*c+r,u[f]=s[1];return t.makeColorScaleFunc({domain:d,range:u},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(v,Q,$){"use strict";var g=v("./constants");function t(k,x){var e=(x[0][0]>k?0:1)+(x[0][1]>k?0:2)+(x[1][1]>k?0:4)+(x[1][0]>k?0:8);return 5===e||10===e?k>(x[0][0]+x[0][1]+x[1][0]+x[1][1])/4?5===e?713:1114:5===e?104:208:15===e?0:e}Q.exports=function(k){var x,e,r,i,c,n,m,p,s,f=k[0].z,l=f.length,o=f[0].length,d=2===l||2===o;for(e=0;e<l-1;e++)for(i=[],0===e&&(i=i.concat(g.BOTTOMSTART)),e===l-2&&(i=i.concat(g.TOPSTART)),x=0;x<o-1;x++)for(r=i.slice(),0===x&&(r=r.concat(g.LEFTSTART)),x===o-2&&(r=r.concat(g.RIGHTSTART)),c=x+","+e,n=[[f[e][x],f[e][x+1]],[f[e+1][x],f[e+1][x+1]]],s=0;s<k.length;s++)(m=t((p=k[s]).level,n))&&(p.crossings[c]=m,-1!==r.indexOf(m)&&(p.starts.push([x,e]),d&&-1!==r.indexOf(m,r.indexOf(m)+1)&&p.starts.push([x,e])))}},{"./constants":748}],762:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../../components/colorscale"),e=v("../../lib/svg_text_utils"),r=v("../../plots/cartesian/axes"),i=v("../../plots/cartesian/set_convert"),c=v("../heatmap/plot"),n=v("./make_crossings"),m=v("./find_all_paths"),p=v("./empty_pathinfo"),s=v("./convert_to_constraints"),f=v("./close_boundaries"),l=v("./constants"),o=l.LABELOPTIMIZER;function d(y,h){var _,b,w,T,L,M,z="",S=0,C=y.edgepaths.map(function(W,G){return G}),R=!0;function D(W){return Math.abs(W[1]-h[2][1])<.01}function q(W){return Math.abs(W[0]-h[2][0])<.01}for(;C.length;){for(M=k.smoothopen(y.edgepaths[S],y.smoothing),z+=R?M:M.replace(/^M/,"L"),C.splice(C.indexOf(S),1),_=y.edgepaths[S][y.edgepaths[S].length-1],T=-1,w=0;w<4;w++){if(!_){t.log("Missing end?",S,y);break}for(Math.abs(_[1]-h[0][1])<.01&&!q(_)?b=h[1]:Math.abs(_[0]-h[0][0])<.01?b=h[0]:D(_)?b=h[3]:q(_)&&(b=h[2]),L=0;L<y.edgepaths.length;L++){var Z=y.edgepaths[L][0];Math.abs(_[0]-b[0])<.01?Math.abs(_[0]-Z[0])<.01&&(Z[1]-_[1])*(b[1]-Z[1])>=0&&(b=Z,T=L):Math.abs(_[1]-b[1])<.01?Math.abs(_[1]-Z[1])<.01&&(Z[0]-_[0])*(b[0]-Z[0])>=0&&(b=Z,T=L):t.log("endpt to newendpt is not vert. or horz.",_,b,Z)}if(_=b,T>=0)break;z+="L"+b}if(T===y.edgepaths.length){t.log("unclosed perimeter path");break}(R=-1===C.indexOf(S=T))&&(S=C[0],z+="Z")}for(S=0;S<y.paths.length;S++)z+=k.smoothclosed(y.paths[S],y.smoothing);return z}function u(y,h,_,b){var w=h.width/2,T=h.height/2,L=y.x,M=y.y,P=y.theta,z=Math.cos(P)*w,S=Math.sin(P)*w,C=(L>b.center?b.right-L:L-b.left)/(z+Math.abs(Math.sin(P)*T)),R=(M>b.middle?b.bottom-M:M-b.top)/(Math.abs(S)+Math.cos(P)*T);if(C<1||R<1)return 1/0;var D=o.EDGECOST*(1/(C-1)+1/(R-1));D+=o.ANGLECOST*P*P;for(var j=L-z,q=M-S,Z=L+z,W=M+S,G=0;G<_.length;G++){var X=_[G],ne=Math.cos(X.theta)*X.width/2,V=Math.sin(X.theta)*X.width/2,N=2*t.segmentDistance(j,q,Z,W,X.x-ne,X.y-V,X.x+ne,X.y+V)/(h.height+X.height),U=X.level===h.level,ee=U?o.SAMELEVELDISTANCE:1;if(N<=ee)return 1/0;D+=o.NEIGHBORCOST*(U?o.SAMELEVELFACTOR:1)/(N-ee)}return D}function a(y){var h,_,b=y.trace._emptypoints,w=[],T=y.z.length,L=y.z[0].length,M=[];for(h=0;h<L;h++)M.push(1);for(h=0;h<T;h++)w.push(M.slice());for(h=0;h<b.length;h++)w[(_=b[h])[0]][_[1]]=0;return y.zmask=w,w}$.plot=function(y,h,_,b){var w=h.xaxis,T=h.yaxis;t.makeTraceGroups(b,_,"contour").each(function(L){var M=g.select(this),P=L[0],S=P.x,C=P.y,R=P.trace.contours,D=p(R,h,P),j=t.ensureSingle(M,"g","heatmapcoloring"),q=[];"heatmap"===R.coloring&&(q=[L]),c(y,h,q,j),n(D),m(D);var U,ee,B,Z=w.c2p(S[0],!0),W=w.c2p(S[S.length-1],!0),G=T.c2p(C[0],!0),X=T.c2p(C[C.length-1],!0),ne=[[Z,X],[W,X],[W,G],[Z,G]],V=D;"constraint"===R.type&&(V=s(D,R._operation)),U=ne,ee=R,(B=t.ensureSingle(M,"g","contourbg").selectAll("path").data("fill"===ee.coloring?[0]:[])).enter().append("path"),B.exit().remove(),B.attr("d","M"+U.join("L")+"Z").style("stroke","none"),function(N,U,ee,B){var K="fill"===B.coloring||"constraint"===B.type&&"="!==B._operation,J="M"+ee.join("L")+"Z";K&&f(U,B);var te=t.ensureSingle(N,"g","contourfill").selectAll("path").data(K?U:[]);te.enter().append("path"),te.exit().remove(),te.each(function(ae){var ce=(ae.prefixBoundary?J:"")+d(ae,ee);ce?g.select(this).attr("d",ce).style("stroke","none"):g.select(this).remove()})}(M,V,ne,R),function(N,U,ee,B,K){var J=t.ensureSingle(N,"g","contourlines"),te=!1!==K.showlines,ae=K.showlabels,ce=te&&ae,oe=$.createLines(J,te||ae,U),ve=$.createLineClip(J,ce,ee,B.trace.uid),fe=N.selectAll("g.contourlabels").data(ae?[0]:[]);if(fe.exit().remove(),fe.enter().append("g").classed("contourlabels",!0),ae){var xe=[],Se=[];t.clearLocationCache();var pe=$.labelFormatter(ee,B),ge=k.tester.append("text").attr("data-notex",1).call(k.font,K.labelfont),Te=U[0].xaxis,se=U[0].yaxis,de=Te._length,Ae=se._length,Le=Te.range,Me=se.range,De=t.aggNums(Math.min,null,B.x),Oe=t.aggNums(Math.max,null,B.x),Ie=t.aggNums(Math.min,null,B.y),Qe=t.aggNums(Math.max,null,B.y),Ne=Math.max(Te.c2p(De,!0),0),Pe=Math.min(Te.c2p(Oe,!0),de),Re=Math.max(se.c2p(Qe,!0),0),Ge=Math.min(se.c2p(Ie,!0),Ae),tt={};Le[0]<Le[1]?(tt.left=Ne,tt.right=Pe):(tt.left=Pe,tt.right=Ne),Me[0]<Me[1]?(tt.top=Re,tt.bottom=Ge):(tt.top=Ge,tt.bottom=Re),tt.middle=(tt.top+tt.bottom)/2,tt.center=(tt.left+tt.right)/2,xe.push([[tt.left,tt.top],[tt.right,tt.top],[tt.right,tt.bottom],[tt.left,tt.bottom]]);var ct=Math.sqrt(de*de+Ae*Ae),wt=l.LABELDISTANCE*ct/Math.max(1,U.length/l.LABELINCREASE);oe.each(function(kt){var gt=$.calcTextOpts(kt.level,pe,ge,ee);g.select(this).selectAll("path").each(function(){var at=t.getVisibleSegment(this,tt,gt.height/2);if(at&&!(at.len<(gt.width+gt.height)*l.LABELMIN))for(var et=Math.min(Math.ceil(at.len/wt),l.LABELMAX),yt=0;yt<et;yt++){var Vt=$.findBestTextLocation(this,at,gt,Se,tt);if(!Vt)break;$.addLabelData(Vt,gt,Se,xe)}})}),ge.remove(),$.drawLabels(fe,Se,ee,ve,ce?xe:null)}ae&&!te&&oe.remove()}(M,D,y,P,R),function(N,U,ee,B,K){var J=B.trace,ae="clip"+J.uid,ce=ee._fullLayout._clips.selectAll("#"+ae).data(J.connectgaps?[]:[0]);if(ce.enter().append("clipPath").classed("contourclip",!0).attr("id",ae),ce.exit().remove(),!1===J.connectgaps){var oe={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:U.xaxis,yaxis:U.yaxis,x:B.x,y:B.y,z:a(B),smoothing:0};n([oe]),m([oe]),f([oe],{type:"levels"}),t.ensureSingle(ce,"path","").attr("d",(oe.prefixBoundary?"M"+K.join("L")+"Z":"")+d(oe,K))}else ae=null;k.setClipUrl(N,ae,ee)}(M,h,y,P,ne)})},$.createLines=function(y,h,_){var b=_[0].smoothing,w=y.selectAll("g.contourlevel").data(h?_:[]);if(w.exit().remove(),w.enter().append("g").classed("contourlevel",!0),h){var T=w.selectAll("path.openline").data(function(M){return M.pedgepaths||M.edgepaths});T.exit().remove(),T.enter().append("path").classed("openline",!0),T.attr("d",function(M){return k.smoothopen(M,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=w.selectAll("path.closedline").data(function(M){return M.ppaths||M.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(M){return k.smoothclosed(M,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return w},$.createLineClip=function(y,h,_,b){var w=h?"clipline"+b:null,T=_._fullLayout._clips.selectAll("#"+w).data(h?[0]:[]);return T.exit().remove(),T.enter().append("clipPath").classed("contourlineclip",!0).attr("id",w),k.setClipUrl(y,w,_),T},$.labelFormatter=function(y,h){var _=y._fullLayout,b=h.trace,w=b.contours,T={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(w.labelformat)T.tickformat=w.labelformat,i(T,_);else{var L=x.extractOpts(b);if(L&&L.colorbar&&L.colorbar._axis)T=L.colorbar._axis;else{if("constraint"===w.type){var M=w.value;T.range=Array.isArray(M)?[M[0],M[M.length-1]]:[M,M]}else T.range=[w.start,w.end],T.nticks=(w.end-w.start)/w.size;T.range[0]===T.range[1]&&(T.range[1]+=T.range[0]||1),T.nticks||(T.nticks=1e3),i(T,_),r.prepTicks(T),T._tmin=null,T._tmax=null}}return function(P){return r.tickText(T,P).text}},$.calcTextOpts=function(y,h,_,b){var w=h(y);_.text(w).call(e.convertToTspans,b);var T=_.node(),L=k.bBox(T,!0);return{text:w,width:L.width,height:L.height,fontSize:+T.style["font-size"].replace("px",""),level:y,dy:(L.top+L.bottom)/2}},$.findBestTextLocation=function(y,h,_,b,w){var T,L,M,P,z,S=_.width;h.isClosed?(T=h.min+(L=h.len/o.INITIALSEARCHPOINTS)/2,M=h.max):(T=h.min+(L=(h.len-S)/(o.INITIALSEARCHPOINTS+1))+S/2,M=h.max-(L+S)/2);for(var C=1/0,R=0;R<o.ITERATIONS;R++){for(var D=T;D<M;D+=L){var j=t.getTextLocation(y,h.total,D,S),q=u(j,_,b,w);q<C&&(C=q,z=j,P=D)}if(C>2*o.MAXCOST)break;R&&(L/=2),M=(T=P-L/2)+1.5*L}if(C<=o.MAXCOST)return z},$.addLabelData=function(y,h,_,b){var w=h.fontSize,T=h.width+w/3,L=Math.max(0,h.height-w/3),M=y.x,P=y.y,z=y.theta,S=Math.sin(z),C=Math.cos(z),R=function(j,q){return[M+j*C-q*S,P+j*S+q*C]},D=[R(-T/2,-L/2),R(-T/2,L/2),R(T/2,L/2),R(T/2,-L/2)];_.push({text:h.text,x:M,y:P,dy:h.dy,theta:z,level:h.level,width:T,height:L}),b.push(D)},$.drawLabels=function(y,h,_,b,w){var T=y.selectAll("text").data(h,function(P){return P.text+","+P.x+","+P.y+","+P.theta});if(T.exit().remove(),T.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(P){var z=P.x+Math.sin(P.theta)*P.dy,S=P.y-Math.cos(P.theta)*P.dy;g.select(this).text(P.text).attr({x:z,y:S,transform:"rotate("+180*P.theta/Math.PI+" "+z+" "+S+")"}).call(e.convertToTspans,_)}),w){for(var L="",M=0;M<w.length;M++)L+="M"+w[M].join("L")+"Z";t.ensureSingle(b,"path","").attr("d",L)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib");function k(x,e,r){var i={type:"linear",range:[x,e]};return g.autoTicks(i,(e-x)/(r||15)),i}Q.exports=function(x,e){var r=x.contours;if(x.autocontour){var i=x.zmin,c=x.zmax;(x.zauto||void 0===i)&&(i=t.aggNums(Math.min,null,e)),(x.zauto||void 0===c)&&(c=t.aggNums(Math.max,null,e));var n=k(i,c,x.ncontours);r.size=n.dtick,r.start=g.tickFirst(n),n.range.reverse(),r.end=g.tickFirst(n),r.start===i&&(r.start+=r.size),r.end===c&&(r.end-=r.size),r.start>r.end&&(r.start=r.end=(r.start+r.end)/2),x._input.contours||(x._input.contours={}),t.extendFlat(x._input.contours,{start:r.start,end:r.end,size:r.size}),x._input.autocontour=!0}else if("constraint"!==r.type){var m,p=r.start,s=r.end,f=x._input.contours;p>s&&(r.start=f.start=s,s=r.end=f.end=p,p=r.start),!(r.size>0)&&(m=p===s?1:k(p,s,x.ncontours).dtick,f.size=r.size=m)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../heatmap/style"),x=v("./make_color_map");Q.exports=function(e){var r=g.select(e).selectAll("g.contour");r.style("opacity",function(i){return i[0].trace.opacity}),r.each(function(i){var c=g.select(this),n=i[0].trace,m=n.contours,p=n.line,s=m.size||1,f=m.start,l="constraint"===m.type,o=!l&&"lines"===m.coloring,d=!l&&"fill"===m.coloring,u=o||d?x(n):null;c.selectAll("g.contourlevel").each(function(h){g.select(this).selectAll("path").call(t.lineGroupStyle,p.width,o?u(h.level):p.color,p.dash)});var a=m.labelfont;if(c.selectAll("g.contourlabels text").each(function(h){t.font(g.select(this),{family:a.family,size:a.size,color:a.color||(o?u(h.level):p.color)})}),l)c.selectAll("g.contourfill path").style("fill",n.fillcolor);else if(d){var y;c.selectAll("g.contourfill path").style("fill",function(h){return void 0===y&&(y=h.level),u(h.level+.5*s)}),void 0===y&&(y=f),c.selectAll("g.contourbg path").style("fill",u(y-.5*s))}}),k(e)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/defaults"),t=v("./label_defaults");Q.exports=function(k,x,e,r,i){var c,n=e("contours.coloring"),m="";"fill"===n&&(c=e("contours.showlines")),!1!==c&&("lines"!==n&&(m=e("line.color","#000")),e("line.width",.5),e("line.dash")),"none"!==n&&(!0!==k.showlegend&&(x.showlegend=!1),x._dfltShowLegend=!1,g(k,x,r,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),t(e,r,m,i)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(v,Q,$){"use strict";var g=v("../heatmap/attributes"),t=v("../contour/attributes"),k=v("../../components/colorscale/attributes"),x=v("../../lib/extend").extendFlat,e=t.contours;Q.exports=x({carpet:{valType:"string",editType:"calc"},z:g.z,a:g.x,a0:g.x0,da:g.dx,b:g.y,b0:g.y0,db:g.dy,text:g.text,hovertext:g.hovertext,transpose:g.transpose,atype:g.xtype,btype:g.ytype,fillcolor:t.fillcolor,autocontour:t.autocontour,ncontours:t.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t.line.color,width:t.line.width,dash:t.line.dash,smoothing:t.line.smoothing,editType:"plot"},transforms:void 0},k("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/calc"),t=v("../../lib"),k=v("../heatmap/convert_column_xyz"),x=v("../heatmap/clean_2d_array"),e=v("../heatmap/interp2d"),r=v("../heatmap/find_empties"),i=v("../heatmap/make_bound_array"),c=v("./defaults"),n=v("../carpet/lookup_carpetid"),m=v("../contour/set_contours");Q.exports=function(p,s){var f=s._carpetTrace=n(p,s);if(f&&f.visible&&"legendonly"!==f.visible){if(!s.a||!s.b){var l=p.data[f.index],o=p.data[s.index];o.a||(o.a=l.a),o.b||(o.b=l.b),c(o,s,s._defaultColor,p._fullLayout)}var d=function(u,a){var y,h,_,b,w,T,L,M=a._carpetTrace,P=M.aaxis,z=M.baxis;P._minDtick=0,z._minDtick=0,t.isArray1D(a.z)&&k(a,P,z,"a","b",["z"]),y=a._a=a._a||a.a,b=a._b=a._b||a.b,y=y?P.makeCalcdata(a,"_a"):[],b=b?z.makeCalcdata(a,"_b"):[],h=a.a0||0,_=a.da||1,w=a.b0||0,T=a.db||1,L=a._z=x(a._z||a.z,a.transpose),a._emptypoints=r(L),e(L,a._emptypoints);var S=t.maxRowLength(L),q={a:i(a,"scaled"===a.xtype?"":y,h,_,S,P),b:i(a,"scaled"===a.ytype?"":b,w,T,L.length,z),z:L};return"levels"===a.contours.type&&"none"!==a.contours.coloring&&g(u,a,{vals:L,containerStr:"",cLetter:"z"}),[q]}(p,s);return m(s,s._z),d}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../heatmap/xyz_defaults"),k=v("./attributes"),x=v("../contour/constraint_defaults"),e=v("../contour/contours_defaults"),r=v("../contour/style_defaults");Q.exports=function(i,c,n,m){function p(s,f){return g.coerce(i,c,k,s,f)}if(p("carpet"),i.a&&i.b){if(!t(i,c,p,m,"a","b"))return void(c.visible=!1);p("text"),"constraint"===p("contours.type")?x(i,c,p,m,n,{hasHover:!1}):(e(i,c,p,function(s){return g.coerce2(i,c,k,s)}),r(i,c,p,m,{hasHover:!1}))}else c._defaultColor=n,c._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../contour/colorbar"),calc:v("./calc"),plot:v("./plot"),style:v("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../carpet/map_1d_array"),k=v("../carpet/makepath"),x=v("../../components/drawing"),e=v("../../lib"),r=v("../contour/make_crossings"),i=v("../contour/find_all_paths"),c=v("../contour/plot"),n=v("../contour/constants"),m=v("../contour/convert_to_constraints"),p=v("../contour/empty_pathinfo"),s=v("../contour/close_boundaries"),f=v("../carpet/lookup_carpetid"),l=v("../carpet/axis_aligned_line");function o(a,y,h){var _=a.getPointAtLength(y),b=a.getPointAtLength(h),w=b.x-_.x,T=b.y-_.y,L=Math.sqrt(w*w+T*T);return[w/L,T/L]}function d(a){var y=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return[a[0]/y,a[1]/y]}function u(a,y){var h=Math.abs(a[0]*y[0]+a[1]*y[1]);return Math.sqrt(1-h*h)/h}Q.exports=function(a,y,h,_){var b=y.xaxis,w=y.yaxis;e.makeTraceGroups(_,h,"contour").each(function(T){var L=g.select(this),M=T[0],P=M.trace,z=P._carpetTrace=f(a,P),S=a.calcdata[z.index][0];if(z.visible&&"legendonly"!==z.visible){var C=M.a,R=M.b,D=P.contours,j=p(D,y,M),q="constraint"===D.type,Z=D._operation,W=q?"="===Z?"lines":"fill":D.coloring,G=[[C[0],R[R.length-1]],[C[C.length-1],R[R.length-1]],[C[C.length-1],R[0]],[C[0],R[0]]];r(j),i(j,1e-8*(C[C.length-1]-C[0]),1e-8*(R[R.length-1]-R[0]));var V,N,U,ee,B=j;"constraint"===D.type&&(B=m(j,Z)),function(ae,ce){var oe,ve,fe,xe,Se,pe,ge,Te,se;for(oe=0;oe<ae.length;oe++){for(Se=(xe=ae[oe]).pedgepaths=[],pe=xe.ppaths=[],ve=0;ve<xe.edgepaths.length;ve++){for(se=xe.edgepaths[ve],ge=[],fe=0;fe<se.length;fe++)ge[fe]=ce(se[fe]);Se.push(ge)}for(ve=0;ve<xe.paths.length;ve++){for(se=xe.paths[ve],Te=[],fe=0;fe<se.length;fe++)Te[fe]=ce(se[fe]);pe.push(Te)}}}(j,te);var K=[];for(ee=S.clipsegments.length-1;ee>=0;ee--)N=t([],(V=S.clipsegments[ee]).x,b.c2p),U=t([],V.y,w.c2p),N.reverse(),U.reverse(),K.push(k(N,U,V.bicubic));var J="M"+K.join("L")+"Z";(function(ae,ce,oe,ve,fe,xe){var Se,pe,ge,Te,se=e.ensureSingle(ae,"g","contourbg").selectAll("path").data("fill"!==xe||fe?[]:[0]);se.enter().append("path"),se.exit().remove();var de=[];for(Te=0;Te<ce.length;Te++)pe=t([],(Se=ce[Te]).x,oe.c2p),ge=t([],Se.y,ve.c2p),de.push(k(pe,ge,Se.bicubic));se.attr("d","M"+de.join("L")+"Z").style("stroke","none")})(L,S.clipsegments,b,w,q,W),function(ae,ce,oe,ve,fe,xe,Se,pe,ge,Te,se){var de="fill"===Te;de&&s(fe,ae.contours);var Ae=e.ensureSingle(ce,"g","contourfill").selectAll("path").data(de?fe:[]);Ae.enter().append("path"),Ae.exit().remove(),Ae.each(function(Le){var Me=(Le.prefixBoundary?se:"")+function(De,Oe,Ie,Qe,Ne,Pe,Re,Ge){var tt,ct,wt,kt,gt,at,et,yt="",Vt=Oe.edgepaths.map(function(He,Ke){return Ke}),Gt=!0,en=1e-4*Math.abs(Ie[0][0]-Ie[2][0]),Jt=1e-4*Math.abs(Ie[0][1]-Ie[2][1]);function cn(He){return Math.abs(He[1]-Ie[0][1])<Jt}function Rt(He){return Math.abs(He[1]-Ie[2][1])<Jt}function je(He){return Math.abs(He[0]-Ie[0][0])<en}function Ye(He){return Math.abs(He[0]-Ie[2][0])<en}function he(He,Ke){var Ze,ut,lt,Lt,Ot="";for(cn(He)&&!Ye(He)||Rt(He)&&!je(He)?(Lt=Ne.aaxis,lt=l(Ne,Pe,[He[0],Ke[0]],.5*(He[1]+Ke[1]))):(Lt=Ne.baxis,lt=l(Ne,Pe,.5*(He[0]+Ke[0]),[He[1],Ke[1]])),Ze=1;Ze<lt.length;Ze++)for(Ot+=Lt.smoothing?"C":"L",ut=0;ut<lt[Ze].length;ut++){var ot=lt[Ze][ut];Ot+=[Re.c2p(ot[0]),Ge.c2p(ot[1])]+" "}return Ot}for(tt=0,ct=null;Vt.length;){for(ct&&(yt+=he(ct,Oe.edgepaths[tt][0])),et=x.smoothopen(Oe.edgepaths[tt].map(Qe),Oe.smoothing),yt+=Gt?et:et.replace(/^M/,"L"),Vt.splice(Vt.indexOf(tt),1),ct=Oe.edgepaths[tt][Oe.edgepaths[tt].length-1],gt=-1,kt=0;kt<4;kt++){if(!ct){e.log("Missing end?",tt,Oe);break}for(cn(ct)&&!Ye(ct)?wt=Ie[1]:je(ct)?wt=Ie[0]:Rt(ct)?wt=Ie[3]:Ye(ct)&&(wt=Ie[2]),at=0;at<Oe.edgepaths.length;at++){var Fe=Oe.edgepaths[at][0];Math.abs(ct[0]-wt[0])<en?Math.abs(ct[0]-Fe[0])<en&&(Fe[1]-ct[1])*(wt[1]-Fe[1])>=0&&(wt=Fe,gt=at):Math.abs(ct[1]-wt[1])<Jt?Math.abs(ct[1]-Fe[1])<Jt&&(Fe[0]-ct[0])*(wt[0]-Fe[0])>=0&&(wt=Fe,gt=at):e.log("endpt to newendpt is not vert. or horz.",ct,wt,Fe)}if(gt>=0)break;yt+=he(ct,wt),ct=wt}if(gt===Oe.edgepaths.length){e.log("unclosed perimeter path");break}(Gt=-1===Vt.indexOf(tt=gt))&&(tt=Vt[0],yt+=he(ct,wt)+"Z",ct=null)}for(tt=0;tt<Oe.paths.length;tt++)yt+=x.smoothclosed(Oe.paths[tt].map(Qe),Oe.smoothing);return yt}(0,Le,xe,Se,pe,ge,oe,ve);Me?g.select(this).attr("d",Me).style("stroke","none"):g.select(this).remove()})}(P,L,b,w,B,G,te,z,S,W,J),function(ae,ce,oe,ve,fe,xe,Se){var pe=e.ensureSingle(ae,"g","contourlines"),ge=!1!==fe.showlines,Te=fe.showlabels,se=ge&&Te,de=c.createLines(pe,ge||Te,ce),Ae=c.createLineClip(pe,se,oe,ve.trace.uid),Le=ae.selectAll("g.contourlabels").data(Te?[0]:[]);if(Le.exit().remove(),Le.enter().append("g").classed("contourlabels",!0),Te){var Oe=xe.xaxis._length,Ie=xe.yaxis._length,Qe=[[[0,0],[Oe,0],[Oe,Ie],[0,Ie]]],Ne=[];e.clearLocationCache();var Pe=c.labelFormatter(oe,ve),Re=x.tester.append("text").attr("data-notex",1).call(x.font,fe.labelfont),Ge={left:0,right:Oe,center:Oe/2,top:0,bottom:Ie,middle:Ie/2},tt=Math.sqrt(Oe*Oe+Ie*Ie),ct=n.LABELDISTANCE*tt/Math.max(1,ce.length/n.LABELINCREASE);de.each(function(wt){var kt=c.calcTextOpts(wt.level,Pe,Re,oe);g.select(this).selectAll("path").each(function(gt){var at=e.getVisibleSegment(this,Ge,kt.height/2);if(at&&(function(Gt,en,Jt,cn,Rt,je){for(var Ye,he=0;he<Jt.pedgepaths.length;he++)en===Jt.pedgepaths[he]&&(Ye=Jt.edgepaths[he]);if(Ye){var be=Rt.a[0],Fe=Rt.a[Rt.a.length-1],He=Rt.b[0],Ke=Rt.b[Rt.b.length-1],ut=o(Gt,0,1),lt=o(Gt,cn.total,cn.total-1),Lt=Ze(Ye[0],ut),Ot=cn.total-Ze(Ye[Ye.length-1],lt);cn.min<Lt&&(cn.min=Lt),cn.max>Ot&&(cn.max=Ot),cn.len=cn.max-cn.min}function Ze(ot,pt){var qt,St=0;return(Math.abs(ot[0]-be)<.1||Math.abs(ot[0]-Fe)<.1)&&(qt=d(Rt.dxydb_rough(ot[0],ot[1],.1)),St=Math.max(St,je*u(pt,qt)/2)),(Math.abs(ot[1]-He)<.1||Math.abs(ot[1]-Ke)<.1)&&(qt=d(Rt.dxyda_rough(ot[0],ot[1],.1)),St=Math.max(St,je*u(pt,qt)/2)),St}}(this,gt,wt,at,Se,kt.height),!(at.len<(kt.width+kt.height)*n.LABELMIN)))for(var et=Math.min(Math.ceil(at.len/ct),n.LABELMAX),yt=0;yt<et;yt++){var Vt=c.findBestTextLocation(this,at,kt,Ne,Ge);if(!Vt)break;c.addLabelData(Vt,kt,Ne,Qe)}})}),Re.remove(),c.drawLabels(Le,Ne,oe,Ae,se?Qe:null)}Te&&!ge&&de.remove()}(L,j,a,M,D,y,z),x.setClipUrl(L,z._clipPathId,a)}function te(ae){var ce=z.ab2xy(ae[0],ae[1],!0);return[b.c2p(ce[0]),w.c2p(ce[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../../plots/template_attributes").hovertemplateAttrs,k=v("../../plots/attributes"),x=v("../scattermapbox/attributes"),e=v("../../lib/extend").extendFlat;Q.exports=e({lon:x.lon,lat:x.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:x.text,hovertext:x.hovertext,hoverinfo:e({},k.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:t(),showlegend:e({},k.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib").isArrayOrTypedArray,k=v("../../constants/numerical").BADNUM,x=v("../../components/colorscale/calc"),e=v("../../lib")._;Q.exports=function(r,i){for(var c=i._length,n=new Array(c),m=i.z,p=t(m)&&m.length,s=0;s<c;s++){var f=n[s]={},l=i.lon[s],o=i.lat[s];if(f.lonlat=g(l)&&g(o)?[+l,+o]:[k,k],p){var d=m[s];f.z=g(d)?d:k}}return x(r,i,{vals:p?m:[0,1],containerStr:"",cLetter:"z"}),c&&(n[0].t={labels:{lat:e(r,"lat:")+" ",lon:e(r,"lon:")+" "}}),n}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../components/color"),x=v("../../components/colorscale"),e=v("../../constants/numerical").BADNUM,r=v("../../lib/geojson_utils").makeBlank;Q.exports=function(i){var c=i[0].trace,n=!0===c.visible&&0!==c._length,m=c._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:r()};if(!n)return m;var p,s=[],f=c.z,l=c.radius,o=t.isArrayOrTypedArray(f)&&f.length,d=t.isArrayOrTypedArray(l);for(p=0;p<i.length;p++){var u=i[p],a=u.lonlat;if(a[0]!==e){var y={};if(o){var h=u.z;y.z=h!==e?h:0}d&&(y.r=g(l[p])&&l[p]>0?+l[p]:0),s.push({type:"Feature",geometry:{type:"Point",coordinates:a},properties:y})}}var _=x.extractOpts(c),b=_.reversescale?x.flipScale(_.colorscale):_.colorscale,w=b[0][1],T=["interpolate",["linear"],["heatmap-density"],0,k.opacity(w)<1?w:k.addOpacity(w,0)];for(p=1;p<b.length;p++)T.push(b[p][0],b[p][1]);return t.extendFlat(m.heatmap.paint,{"heatmap-weight":o?["interpolate",["linear"],["get","z"],_.min,0,_.max,1]:1/(_.max-_.min),"heatmap-color":T,"heatmap-radius":d?{type:"identity",property:"r"}:c.radius,"heatmap-opacity":c.opacity}),m.geojson={type:"FeatureCollection",features:s},m.heatmap.layout.visibility="visible",m}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/defaults"),k=v("./attributes");Q.exports=function(x,e,r,i){function c(s,f){return g.coerce(x,e,k,s,f)}var n=c("lon")||[],m=c("lat")||[],p=Math.min(n.length,m.length);p?(e._length=p,c("z"),c("radius"),c("below"),c("text"),c("hovertext"),c("hovertemplate"),t(x,e,i,c,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(v,Q,$){"use strict";Q.exports=function(g,t){return g.lon=t.lon,g.lat=t.lat,g.z=t.z,g}},{}],776:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../scattermapbox/hover").hoverPoints,k=v("../scattermapbox/hover").getExtraText;Q.exports=function(x,e,r){var i=t(x,e,r);if(i){var c=i[0],n=c.cd,m=n[0].trace,p=n[c.index];if(delete c.color,"z"in p){var s=c.subplot.mockAxis;c.z=p.z,c.zLabel=g.tickText(s,s.c2l(p.z),"hover").text}return c.extraText=k(m,p,n[0].t.labels),[c]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),formatLabels:v("../scattermapbox/format_labels"),calc:v("./calc"),plot:v("./plot"),hoverPoints:v("./hover"),eventData:v("./event_data"),getBelow:function(g,t){for(var k=t.getMapLayers(),x=0;x<k.length;x++){var e=k[x],r=e.id;if("symbol"===e.type&&"string"==typeof r&&-1===r.indexOf("plotly-"))return r}},moduleType:"trace",name:"densitymapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(v,Q,$){"use strict";var g=v("./convert"),t=v("../../plots/mapbox/constants").traceLayerPrefix;function k(e,r){this.type="densitymapbox",this.subplot=e,this.uid=r,this.sourceId="source-"+r,this.layerList=[["heatmap",t+r+"-heatmap"]],this.below=null}var x=k.prototype;x.update=function(e){var r=this.subplot,i=this.layerList,c=g(e),n=r.belowLookup["trace-"+this.uid];r.map.getSource(this.sourceId).setData(c.geojson),n!==this.below&&(this._removeLayers(),this._addLayers(c,n),this.below=n);for(var m=0;m<i.length;m++){var p=i[m],f=p[1],l=c[p[0]];r.setOptions(f,"setLayoutProperty",l.layout),"visible"===l.layout.visibility&&r.setOptions(f,"setPaintProperty",l.paint)}},x._addLayers=function(e,r){for(var i=this.subplot,c=this.layerList,n=this.sourceId,m=0;m<c.length;m++){var p=c[m],s=p[0],f=e[s];i.addLayer({type:s,id:p[1],source:n,layout:f.layout,paint:f.paint},r)}},x._removeLayers=function(){for(var e=this.subplot.map,r=this.layerList,i=r.length-1;i>=0;i--)e.removeLayer(r[i][1])},x.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},Q.exports=function(e,r){var i=r[0].trace,c=new k(e,i.uid),n=c.sourceId,m=g(r),p=c.below=e.belowLookup["trace-"+i.uid];return e.map.addSource(n,{type:"geojson",data:m.geojson}),c._addLayers(m,p),c}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){for(var x=0;x<t.length;x++)t[x].i=x;g.mergeArray(k.text,t,"tx"),g.mergeArray(k.hovertext,t,"htx");var e=k.marker;if(e){g.mergeArray(e.opacity,t,"mo"),g.mergeArray(e.color,t,"mc");var r=e.line;r&&(g.mergeArray(r.color,t,"mlc"),g.mergeArrayCastPositive(r.width,t,"mlw"))}}},{"../../lib":515}],780:[function(v,Q,$){"use strict";var g,t=v("../bar/attributes"),k=v("../scatter/attributes").line,x=v("../../plots/attributes"),e=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,r=v("../../plots/template_attributes").hovertemplateAttrs,i=v("../../plots/template_attributes").texttemplateAttrs,c=v("./constants"),n=v("../../lib/extend").extendFlat,m=v("../../components/color");Q.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:t.hovertext,hovertemplate:r({},{keys:c.eventDataKeys}),hoverinfo:n({},x.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:i({editType:"plot"},{keys:c.eventDataKeys.concat(["label","value"])}),text:t.text,textposition:t.textposition,insidetextanchor:n({},t.insidetextanchor,{dflt:"middle"}),textangle:n({},t.textangle,{dflt:0}),textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:n({},t.orientation,{}),offset:n({},t.offset,{arrayOk:!1}),width:n({},t.width,{arrayOk:!1}),marker:(g=n({},t.marker),delete g.pattern,g),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:n({},k.color,{dflt:m.defaultLine}),width:n({},k.width,{dflt:0,editType:"plot"}),dash:k.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../plots/cartesian/align_period"),k=v("./arrays_to_calcdata"),x=v("../scatter/calc_selection"),e=v("../../constants/numerical").BADNUM;function r(i){return i===e?0:i}Q.exports=function(i,c){var n,m,p,s,f,l,o,d,u=g.getFromId(i,c.xaxis||"x"),a=g.getFromId(i,c.yaxis||"y");"h"===c.orientation?(n=u.makeCalcdata(c,"x"),p=a.makeCalcdata(c,"y"),s=t(c,a,"y",p),f=!!c.yperiodalignment,l="y"):(n=a.makeCalcdata(c,"y"),p=u.makeCalcdata(c,"x"),s=t(c,u,"x",p),f=!!c.xperiodalignment,l="x"),m=s.vals;var y,h=Math.min(m.length,n.length),_=new Array(h);for(c._base=[],o=0;o<h;o++){n[o]<0&&(n[o]=e);var b=!1;n[o]!==e&&o+1<h&&n[o+1]!==e&&(b=!0),d=_[o]={p:m[o],s:n[o],cNext:b},c._base[o]=-.5*d.s,f&&(_[o].orig_p=p[o],_[o][l+"End"]=s.ends[o],_[o][l+"Start"]=s.starts[o]),c.ids&&(d.id=String(c.ids[o])),0===o&&(_[0].vTotal=0),_[0].vTotal+=r(d.s),d.begR=r(d.s)/r(_[0].s)}for(o=0;o<h;o++)(d=_[o]).s!==e&&(d.sumR=d.s/_[0].vTotal,d.difR=void 0!==y?d.s/y:1,y=d.s);return k(_,c),x(_,c),_}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(v,Q,$){"use strict";Q.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(v,Q,$){"use strict";var g=v("../bar/cross_trace_calc").setGroupPositions;Q.exports=function(t,k){var x,e,r=t._fullLayout,i=t._fullData,c=t.calcdata,n=k.xaxis,m=k.yaxis,p=[],s=[],f=[];for(e=0;e<i.length;e++){var l=i[e];!0===l.visible&&l.xaxis===n._id&&l.yaxis===m._id&&"funnel"===l.type&&(x=c[e],"h"===l.orientation?f.push(x):s.push(x),p.push(x))}var d={mode:r.funnelmode,norm:r.funnelnorm,gap:r.funnelgap,groupgap:r.funnelgroupgap};for(g(t,n,m,s,d),g(t,m,n,f,d),e=0;e<p.length;e++){x=p[e];for(var u=0;u<x.length;u++)u+1<x.length&&(x[u].nextP0=x[u+1].p0,x[u].nextS0=x[u+1].s0,x[u].nextP1=x[u+1].p1,x[u].nextS1=x[u+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../bar/defaults").handleGroupingDefaults,k=v("../bar/defaults").handleText,x=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),r=v("./attributes"),i=v("../../components/color");Q.exports={supplyDefaults:function(c,n,m,p){function s(d,u){return g.coerce(c,n,r,d,u)}if(x(c,n,p,s)){e(c,n,p,s),s("xhoverformat"),s("yhoverformat"),s("orientation",n.y&&!n.x?"v":"h"),s("offset"),s("width");var f=s("text");s("hovertext"),s("hovertemplate");var l=s("textposition");k(c,n,p,s,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===n.textposition||n.texttemplate||s("textinfo",Array.isArray(f)?"text+value":"value");var o=s("marker.color",m);s("marker.line.color",i.defaultLine),s("marker.line.width"),s("connector.visible")&&(s("connector.fillcolor",(u=g.isArrayOrTypedArray(d=o)?"#000":d,i.addOpacity(u,.5*i.opacity(u)))),s("connector.line.width")&&(s("connector.line.color"),s("connector.line.dash")))}else n.visible=!1;var d,u},crossTraceDefaults:function(c,n){var m,p;function s(l){return g.coerce(p._input,p,r,l)}if("group"===n.funnelmode)for(var f=0;f<c.length;f++)m=(p=c[f])._input,t(m,p,n,s)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(v,Q,$){"use strict";Q.exports=function(g,t){return g.x="xVal"in t?t.xVal:t.x,g.y="yVal"in t?t.yVal:t.y,"percentInitial"in t&&(g.percentInitial=t.percentInitial),"percentPrevious"in t&&(g.percentPrevious=t.percentPrevious),"percentTotal"in t&&(g.percentTotal=t.percentTotal),t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),g}},{}],786:[function(v,Q,$){"use strict";var g=v("../../components/color").opacity,t=v("../bar/hover").hoverOnBars,k=v("../../lib").formatPercent;Q.exports=function(x,e,r,i,c){var h,_,b,w,T,n=t(x,e,r,i,c);if(n){var m=n.cd,p=m[0].trace,f=m[n.index];n[("h"===p.orientation?"x":"y")+"LabelVal"]=f.s,n.percentInitial=f.begR,n.percentInitialLabel=k(f.begR,1),n.percentPrevious=f.difR,n.percentPreviousLabel=k(f.difR,1),n.percentTotal=f.sumR,n.percentTotalLabel=k(f.sumR,1);var l=f.hi||p.hoverinfo,o=[];if(l&&"none"!==l&&"skip"!==l){var d="all"===l,u=l.split("+"),a=function(y){return d||-1!==u.indexOf(y)};a("percent initial")&&o.push(n.percentInitialLabel+" of initial"),a("percent previous")&&o.push(n.percentPreviousLabel+" of previous"),a("percent total")&&o.push(n.percentTotalLabel+" of total")}return n.extraText=o.join("<br>"),n.color=(_=p.marker,w=(h=f).mlc||_.line.color,T=h.mlw||_.line.width,g(b=h.mc||_.color)?b:g(w)&&T?w:void 0),[n]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style").style,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(v,Q,$){"use strict";Q.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x,e){var r=!1;function i(m,p){return g.coerce(k,x,t,m,p)}for(var c=0;c<e.length;c++){var n=e[c];if(n.visible&&"funnel"===n.type){r=!0;break}}r&&(i("funnelmode"),i("funnelgap",.2),i("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../../constants/numerical").BADNUM,e=v("../bar/plot"),r=v("../bar/uniform_text").clearMinTextSize;function i(c,n,m,p){var s=[],f=[],l=p?n:m,o=p?m:n;return s[0]=l.c2p(c.s0,!0),f[0]=o.c2p(c.p0,!0),s[1]=l.c2p(c.s1,!0),f[1]=o.c2p(c.p1,!0),s[2]=l.c2p(c.nextS0,!0),f[2]=o.c2p(c.nextP0,!0),s[3]=l.c2p(c.nextS1,!0),f[3]=o.c2p(c.nextP1,!0),p?[s,f]:[f,s]}Q.exports=function(c,n,m,p){var f,l,u,a,s=c._fullLayout;r("funnel",s),f=c,u=(l=n).xaxis,a=l.yaxis,t.makeTraceGroups(p,m,"trace bars").each(function(y){var h=g.select(this),_=y[0].trace,b=t.ensureSingle(h,"g","regions");if(_.connector&&_.connector.visible){var w="h"===_.orientation,T=b.selectAll("g.region").data(t.identity);T.enter().append("g").classed("region",!0),T.exit().remove();var L=T.size();T.each(function(M,P){if(P===L-1||M.cNext){var z=i(M,u,a,w),S=z[0],C=z[1],R="";S[0]!==x&&C[0]!==x&&S[1]!==x&&C[1]!==x&&S[2]!==x&&C[2]!==x&&S[3]!==x&&C[3]!==x&&(R+=w?"M"+S[0]+","+C[1]+"L"+S[2]+","+C[2]+"H"+S[3]+"L"+S[1]+","+C[1]+"Z":"M"+S[1]+","+C[1]+"L"+S[2]+","+C[3]+"V"+C[2]+"L"+S[1]+","+C[0]+"Z"),""===R&&(R="M0,0Z"),t.ensureSingle(g.select(this),"path").attr("d",R).call(k.setClipUrl,l.layerClipId,f)}})}else b.remove()}),function(f,l,o,d){var u=l.xaxis,a=l.yaxis;t.makeTraceGroups(d,o,"trace bars").each(function(y){var h=g.select(this),_=y[0].trace,b=t.ensureSingle(h,"g","lines");if(_.connector&&_.connector.visible&&_.connector.line.width){var w="h"===_.orientation,T=b.selectAll("g.line").data(t.identity);T.enter().append("g").classed("line",!0),T.exit().remove();var L=T.size();T.each(function(M,P){if(P===L-1||M.cNext){var z=i(M,u,a,w),S=z[0],C=z[1],R="";void 0!==S[3]&&void 0!==C[3]&&(w?(R+="M"+S[0]+","+C[1]+"L"+S[2]+","+C[2],R+="M"+S[1]+","+C[1]+"L"+S[3]+","+C[2]):(R+="M"+S[1]+","+C[1]+"L"+S[2]+","+C[3],R+="M"+S[1]+","+C[0]+"L"+S[2]+","+C[2])),""===R&&(R="M0,0Z"),t.ensureSingle(g.select(this),"path").attr("d",R).call(k.setClipUrl,l.layerClipId,f)}})}else b.remove()})}(c,n,m,p),e.plot(c,n,m,p,{mode:s.funnelmode,norm:s.funnelmode,gap:s.funnelgap,groupgap:s.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../../components/color"),x=v("../../constants/interactions").DESELECTDIM,e=v("../bar/style"),r=v("../bar/uniform_text").resizeText,i=e.styleTextPoints;Q.exports={style:function(c,n,m){var p=m||g.select(c).selectAll("g.funnellayer").selectAll("g.trace");r(c,p,"funnel"),p.style("opacity",function(s){return s[0].trace.opacity}),p.each(function(s){var f=g.select(this),l=s[0].trace;f.selectAll(".point > path").each(function(o){if(!o.isBlank){var d=l.marker;g.select(this).call(k.fill,o.mc||d.color).call(k.stroke,o.mlc||d.line.color).call(t.dashLine,d.line.dash,o.mlw||d.line.width).style("opacity",l.selectedpoints&&!o.selected?x:1)}}),i(f,l,c),f.selectAll(".regions").each(function(){g.select(this).selectAll("path").style("stroke-width",0).call(k.fill,l.connector.fillcolor)}),f.selectAll(".lines").each(function(){var o=l.connector.line;t.lineGroupStyle(g.select(this).selectAll("path"),o.width,o.color,o.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(v,Q,$){"use strict";var g=v("../pie/attributes"),t=v("../../plots/attributes"),k=v("../../plots/domain").attributes,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/template_attributes").texttemplateAttrs,r=v("../../lib/extend").extendFlat;Q.exports={labels:g.labels,label0:g.label0,dlabel:g.dlabel,values:g.values,marker:{colors:g.marker.colors,line:{color:r({},g.marker.line.color,{dflt:null}),width:r({},g.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:g.text,hovertext:g.hovertext,scalegroup:r({},g.scalegroup,{}),textinfo:r({},g.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:r({},t.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:x({},{keys:["label","color","value","text","percent"]}),textposition:r({},g.textposition,{values:["inside","none"],dflt:"inside"}),textfont:g.textfont,insidetextfont:g.insidetextfont,title:{text:g.title.text,font:g.title.font,position:r({},g.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:k({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(v,Q,$){"use strict";var g=v("../../plots/plots");$.name="funnelarea",$.plot=function(t,k,x,e){g.plotBasePlot($.name,t,k,x,e)},$.clean=function(t,k,x,e){g.cleanBasePlot($.name,t,k,x,e)}},{"../../plots/plots":628}],794:[function(v,Q,$){"use strict";var g=v("../pie/calc");Q.exports={calc:function(t,k){return g.calc(t,k)},crossTraceCalc:function(t){g.crossTraceCalc(t,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../plots/domain").defaults,x=v("../bar/defaults").handleText,e=v("../pie/defaults").handleLabelsAndValues;Q.exports=function(r,i,c,n){function m(y,h){return g.coerce(r,i,t,y,h)}var p=m("labels"),s=m("values"),f=e(p,s),l=f.len;if(i._hasLabels=f.hasLabels,i._hasValues=f.hasValues,!i._hasLabels&&i._hasValues&&(m("label0"),m("dlabel")),l){i._length=l,m("marker.line.width")&&m("marker.line.color",n.paper_bgcolor),m("marker.colors"),m("scalegroup");var o,d=m("text"),u=m("texttemplate");if(u||(o=m("textinfo",Array.isArray(d)?"text+percent":"percent")),m("hovertext"),m("hovertemplate"),u||o&&"none"!==o){var a=m("textposition");x(r,i,n,m,a,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}k(i,n,m),m("title.text")&&(m("title.position"),g.coerceFont(m,"title.font",n.font)),m("aspectratio"),m("baseratio")}else i.visible=!1}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"funnelarea",basePlotModule:v("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style"),styleOne:v("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(v,Q,$){"use strict";var g=v("../pie/layout_attributes").hiddenlabels;Q.exports={hiddenlabels:g,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x){function e(r,i){return g.coerce(k,x,t,r,i)}e("hiddenlabels"),e("funnelareacolorway",x.colorway),e("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../../lib"),x=k.strScale,e=k.strTranslate,r=v("../../lib/svg_text_utils"),i=v("../bar/plot").toMoveInsideBar,c=v("../bar/uniform_text"),n=c.recordMinTextSize,m=c.clearMinTextSize,p=v("../pie/helpers"),s=v("../pie/plot"),f=s.attachFxHandlers,l=s.determineInsideTextFont,o=s.layoutAreas,d=s.prerenderTitles,u=s.positionTitleOutside,a=s.formatSliceLabel;function y(h,_){return"l"+(_[0]-h[0])+","+(_[1]-h[1])}Q.exports=function(h,_){var b=h._context.staticPlot,w=h._fullLayout;m("funnelarea",w),d(_,h),o(_,w._size),k.makeTraceGroups(w._funnelarealayer,_,"trace").each(function(T){var L=g.select(this),M=T[0],P=M.trace;(function(z){if(z.length){var S=z[0],C=S.trace,R=C.aspectratio,D=C.baseratio;D>.999&&(D=.999);var j,ne,V,q=Math.pow(D,2),Z=S.vTotal,W=Z,G=Z*q/(1-q)/Z,N=[];for(N.push(X()),ne=z.length-1;ne>-1;ne--)(V=z[ne]).hidden||(G+=V.v/W,N.push(X()));var ee=1/0,B=-1/0;for(ne=0;ne<N.length;ne++)j=N[ne],ee=Math.min(ee,j[1]),B=Math.max(B,j[1]);for(ne=0;ne<N.length;ne++)N[ne][1]-=(B+ee)/2;var J=S.r,te=(B-ee)/2,ae=J/N[N.length-1][0],ce=J/te*R;for(S.r=ce*te,ne=0;ne<N.length;ne++)N[ne][0]*=ae,N[ne][1]*=ce;var pe,ge,oe=[-(j=N[0])[0],j[1]],ve=[j[0],j[1]],fe=0;for(ne=z.length-1;ne>-1;ne--)if(!(V=z[ne]).hidden){var xe=N[fe+=1][0],Se=N[fe][1];V.TL=[-xe,Se],V.TR=[xe,Se],V.BL=oe,V.BR=ve,V.pxmid=[.5*((pe=V.TR)[0]+(ge=V.BR)[0]),.5*(pe[1]+ge[1])],oe=V.TL,ve=V.TR}}function X(){var Te,se={x:Te=Math.sqrt(G),y:-Te};return[se.x,se.y]}})(T),L.each(function(){var z=g.select(this).selectAll("g.slice").data(T);z.enter().append("g").classed("slice",!0),z.exit().remove(),z.each(function(C,R){if(C.hidden)g.select(this).selectAll("path,g").remove();else{C.pointNumber=C.i,C.curveNumber=P.index;var D=M.cx,j=M.cy,q=g.select(this),Z=q.selectAll("path.surface").data([C]);Z.enter().append("path").classed("surface",!0).style({"pointer-events":b?"none":"all"}),q.call(f,h,T);var W="M"+(D+C.TR[0])+","+(j+C.TR[1])+y(C.TR,C.BR)+y(C.BR,C.BL)+y(C.BL,C.TL)+"Z";Z.attr("d",W),a(h,C,M);var G=p.castOption(P.textposition,C.pts),X=q.selectAll("g.slicetext").data(C.text&&"none"!==G?[0]:[]);X.enter().append("g").classed("slicetext",!0),X.exit().remove(),X.each(function(){var ne=k.ensureSingle(g.select(this),"text","",function(te){te.attr("data-notex",1)}),V=k.ensureUniformFontSize(h,l(P,C,w.font));ne.text(C.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(t.font,V).call(r.convertToTspans,h);var N,U,ee,B=t.bBox(ne.node()),K=Math.min(C.BL[1],C.BR[1])+j,J=Math.max(C.TL[1],C.TR[1])+j;U=Math.max(C.TL[0],C.BL[0])+D,ee=Math.min(C.TR[0],C.BR[0])+D,(N=i(U,ee,K,J,B,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=V.size,n(P.type,N,w),T[R].transform=N,k.setTransormAndDisplay(ne,N)})}});var S=g.select(this).selectAll("g.titletext").data(P.title.text?[0]:[]);S.enter().append("g").classed("titletext",!0),S.exit().remove(),S.each(function(){var C=k.ensureSingle(g.select(this),"text","",function(j){j.attr("data-notex",1)}),R=P.title.text;P._meta&&(R=k.templateString(R,P._meta)),C.text(R).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(t.font,P.title.font).call(r.convertToTspans,h);var D=u(M,w._size);C.attr("transform",e(D.x,D.y)+x(Math.min(1,D.scale))+e(D.tx,D.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../pie/style_one"),k=v("../bar/uniform_text").resizeText;Q.exports=function(x){var e=x._fullLayout._funnelarealayer.selectAll(".trace");k(x,e,"funnelarea"),e.each(function(r){var i=r[0].trace,c=g.select(this);c.style({opacity:i.opacity}),c.selectAll("path.surface").each(function(n){g.select(this).call(t,n,i)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(v,Q,$){"use strict";var g=v("../scatter/attributes"),t=v("../../plots/attributes"),k=v("../../plots/font_attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/template_attributes").texttemplateAttrs,i=v("../../components/colorscale/attributes"),c=v("../../lib/extend").extendFlat;Q.exports=c({z:{valType:"data_array",editType:"calc"},x:c({},g.x,{impliedEdits:{xtype:"array"}}),x0:c({},g.x0,{impliedEdits:{xtype:"scaled"}}),dx:c({},g.dx,{impliedEdits:{xtype:"scaled"}}),y:c({},g.y,{impliedEdits:{ytype:"array"}}),y0:c({},g.y0,{impliedEdits:{ytype:"scaled"}}),dy:c({},g.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:c({},g.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:c({},g.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:c({},g.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:c({},g.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:c({},g.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:c({},g.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:e(),texttemplate:r({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:k({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:c({},t.showlegend,{dflt:!1})},{transforms:void 0},i("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/align_period"),e=v("../histogram2d/calc"),r=v("../../components/colorscale/calc"),i=v("./convert_column_xyz"),c=v("./clean_2d_array"),n=v("./interp2d"),m=v("./find_empties"),p=v("./make_bound_array"),s=v("../../constants/numerical").BADNUM;function f(l){for(var o=[],d=l.length,u=0;u<d;u++){var a=l[u];a!==s&&o.push(a)}return o}Q.exports=function(l,o){var d,u,a,y,h,_,b,w,T,L,M,P=k.getFromId(l,o.xaxis||"x"),z=k.getFromId(l,o.yaxis||"y"),S=g.traceIs(o,"contour"),C=g.traceIs(o,"histogram"),R=g.traceIs(o,"gl2d"),D=S?"best":o.zsmooth;if(P._minDtick=0,z._minDtick=0,C)y=(M=e(l,o)).orig_x,d=M.x,u=M.x0,a=M.dx,w=M.orig_y,h=M.y,_=M.y0,b=M.dy,T=M.z;else{var j=o.z;t.isArray1D(j)?(i(o,P,z,"x","y",["z"]),d=o._x,h=o._y,j=o._z):(y=o.x?P.makeCalcdata(o,"x"):[],w=o.y?z.makeCalcdata(o,"y"):[],d=x(o,P,"x",y).vals,h=x(o,z,"y",w).vals,o._x=d,o._y=h),u=o.x0,a=o.dx,_=o.y0,b=o.dy,T=c(j,o,P,z)}function q(J){D=o._input.zsmooth=o.zsmooth=!1,t.warn('cannot use zsmooth: "fast": '+J)}if((P.rangebreaks||z.rangebreaks)&&(T=function(J,te,ae){for(var ce=[],oe=-1,ve=0;ve<ae.length;ve++)if(te[ve]!==s){ce[++oe]=[];for(var fe=0;fe<ae[ve].length;fe++)J[fe]!==s&&ce[oe].push(ae[ve][fe])}return ce}(d,h,T),C||(d=f(d),h=f(h),o._x=d,o._y=h)),C||!S&&!o.connectgaps||(o._emptypoints=m(T),n(T,o._emptypoints)),"fast"===D)if("log"===P.type||"log"===z.type)q("log axis found");else if(!C){if(d.length){var Z=(d[d.length-1]-d[0])/(d.length-1),W=Math.abs(Z/100);for(L=0;L<d.length-1;L++)if(Math.abs(d[L+1]-d[L]-Z)>W){q("x scale is not linear");break}}if(h.length&&"fast"===D){var G=(h[h.length-1]-h[0])/(h.length-1),X=Math.abs(G/100);for(L=0;L<h.length-1;L++)if(Math.abs(h[L+1]-h[L]-G)>X){q("y scale is not linear");break}}}var ne=t.maxRowLength(T),V="scaled"===o.xtype?"":d,N=p(o,V,u,a,ne,P),U="scaled"===o.ytype?"":h,ee=p(o,U,_,b,T.length,z);R||(o._extremes[P._id]=k.findExtremes(P,N),o._extremes[z._id]=k.findExtremes(z,ee));var B={x:N,y:ee,z:T,text:o._text||o.text,hovertext:o._hovertext||o.hovertext};if(o.xperiodalignment&&y&&(B.orig_x=y),o.yperiodalignment&&w&&(B.orig_y=w),V&&V.length===N.length-1&&(B.xCenter=V),U&&U.length===ee.length-1&&(B.yCenter=U),C&&(B.xRanges=M.xRanges,B.yRanges=M.yRanges,B.pts=M.pts),S||r(l,o,{vals:T,cLetter:"z"}),S&&o.contours&&"heatmap"===o.contours.coloring){var K={type:"contour"===o.type?"heatmap":"histogram2d",xcalendar:o.xcalendar,ycalendar:o.ycalendar};B.xfill=p(K,V,u,a,ne,P),B.yfill=p(K,U,_,b,T.length,z)}return[B]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../constants/numerical").BADNUM;Q.exports=function(x,e,r,i){var c,n,m,p,s,f;function l(h){if(g(h))return+h}if(e&&e.transpose){for(c=0,s=0;s<x.length;s++)c=Math.max(c,x[s].length);if(0===c)return!1;m=function(h){return h.length},p=function(h,_,b){return(h[b]||[])[_]}}else c=x.length,m=function(h,_){return h[_].length},p=function(h,_,b){return(h[_]||[])[b]};function d(h){if(e&&"carpet"!==e.type&&"contourcarpet"!==e.type&&h&&"category"===h.type&&e["_"+h._id.charAt(0)].length){var _=h._id.charAt(0),b={},w=e["_"+_+"CategoryMap"]||e[_];for(s=0;s<w.length;s++)b[w[s]]=s;return function(T){var L=b[h._categories[T]];return L+1?L:k}}return t.identity}var u=d(r),a=d(i);i&&"category"===i.type&&(c=i._categories.length);var h,_,b,y=new Array(c);for(s=0;s<c;s++)for(n=r&&"category"===r.type?r._categories.length:m(x,s),y[s]=new Array(n),f=0;f<n;f++)y[s][f]=l((h=x,_=a(s),b=u(f),_===k||b===k?k:p(h,_,b)));return y}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(v,Q,$){"use strict";Q.exports={min:"zmin",max:"zmax"}},{}],805:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../constants/numerical").BADNUM,k=v("../../plots/cartesian/align_period");Q.exports=function(x,e,r,i,c,n){var m=x._length,p=e.makeCalcdata(x,i),s=r.makeCalcdata(x,c);p=k(x,e,i,p).vals,s=k(x,r,c,s).vals;var f,l,o,d,u=x.text,a=void 0!==u&&g.isArray1D(u),y=x.hovertext,h=void 0!==y&&g.isArray1D(y),_=g.distinctVals(p),b=_.vals,w=g.distinctVals(s),T=w.vals,L=[],M=T.length,P=b.length;for(f=0;f<n.length;f++)L[f]=g.init2dArray(M,P);a&&(o=g.init2dArray(M,P)),h&&(d=g.init2dArray(M,P));var z=g.init2dArray(M,P);for(f=0;f<m;f++)if(p[f]!==t&&s[f]!==t){var S=g.findBin(p[f]+_.minDiff/2,b),C=g.findBin(s[f]+w.minDiff/2,T);for(l=0;l<n.length;l++)L[l][C][S]=x[n[l]][f],z[C][S]=f;a&&(o[C][S]=u[f]),h&&(d[C][S]=y[f])}for(x["_"+i]=b,x["_"+c]=T,l=0;l<n.length;l++)x["_"+n[l]]=L[l];a&&(x._text=o),h&&(x._hovertext=d),e&&"category"===e.type&&(x["_"+i+"CategoryMap"]=b.map(function(D){return e._categories[D]})),r&&"category"===r.type&&(x["_"+c+"CategoryMap"]=T.map(function(D){return r._categories[D]})),x._after2before=z}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./xyz_defaults"),k=v("./label_defaults"),x=v("../scatter/period_defaults"),e=v("./style_defaults"),r=v("../../components/colorscale/defaults"),i=v("./attributes");Q.exports=function(c,n,m,p){function s(f,l){return g.coerce(c,n,i,f,l)}t(c,n,s,p)?(x(c,n,p,s),s("xhoverformat"),s("yhoverformat"),s("text"),s("hovertext"),s("hovertemplate"),k(s,p),e(c,n,s,p),s("hoverongaps"),s("connectgaps",g.isArray1D(n.z)&&!1!==n.zsmooth),r(c,n,p,s,{prefix:"",cLetter:"z"})):n.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(v,Q,$){"use strict";var g=v("../../lib").maxRowLength;Q.exports=function(t){var k,x,e,r,i,c,n,m,p=[],s={},f=[],l=t[0],o=[],d=[0,0,0],u=g(t);for(x=0;x<t.length;x++)for(k=o,o=l,l=t[x+1]||[],e=0;e<u;e++)void 0===o[e]&&((c=(void 0!==o[e-1]?1:0)+(void 0!==o[e+1]?1:0)+(void 0!==k[e]?1:0)+(void 0!==l[e]?1:0))?(0===x&&c++,0===e&&c++,x===t.length-1&&c++,e===o.length-1&&c++,c<4&&(s[[x,e]]=[x,e,c]),p.push([x,e,c])):f.push([x,e]));for(;f.length;){for(n={},m=!1,i=f.length-1;i>=0;i--)(c=((s[[(x=(r=f[i])[0])-1,e=r[1]]]||d)[2]+(s[[x+1,e]]||d)[2]+(s[[x,e-1]]||d)[2]+(s[[x,e+1]]||d)[2])/20)&&(n[r]=[x,e,c],f.splice(i,1),m=!0);if(!m)throw"findEmpties iterated with no new neighbors";for(r in n)s[r]=n[r],p.push(n[r])}return p.sort(function(a,y){return y[2]-a[2]})}},{"../../lib":515}],808:[function(v,Q,$){"use strict";var g=v("../../components/fx"),t=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../../components/colorscale").extractOpts;Q.exports=function(e,r,i,c,n){n||(n={});var m,p,s,f,l=n.isContour,o=e.cd[0],d=o.trace,u=e.xa,a=e.ya,y=o.x,h=o.y,_=o.z,b=o.xCenter,w=o.yCenter,T=o.zmask,L=d.zhoverformat,M=y,P=h;if(!1!==e.index){try{s=Math.round(e.index[1]),f=Math.round(e.index[0])}catch(V){return void t.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(s<0||s>=_[0].length||f<0||f>_.length)return}else{if(g.inbox(r-y[0],r-y[y.length-1],0)>0||g.inbox(i-h[0],i-h[h.length-1],0)>0)return;if(l){var z;for(M=[2*y[0]-y[1]],z=1;z<y.length;z++)M.push((y[z]+y[z-1])/2);for(M.push([2*y[y.length-1]-y[y.length-2]]),P=[2*h[0]-h[1]],z=1;z<h.length;z++)P.push((h[z]+h[z-1])/2);P.push([2*h[h.length-1]-h[h.length-2]])}s=Math.max(0,Math.min(M.length-2,t.findBin(r,M))),f=Math.max(0,Math.min(P.length-2,t.findBin(i,P)))}var S,C,R=u.c2p(y[s]),D=u.c2p(y[s+1]),j=a.c2p(h[f]),q=a.c2p(h[f+1]);l?(D=R,m=(S=o.orig_x||y)[s],q=j,p=(C=o.orig_y||h)[f]):(S=o.orig_x||b||y,C=o.orig_y||w||h,m=b?S[s]:(S[s]+S[s+1])/2,p=w?C[f]:(C[f]+C[f+1])/2,u&&"category"===u.type&&(m=y[s]),a&&"category"===a.type&&(p=h[f]),d.zsmooth&&(R=D=u.c2p(m),j=q=a.c2p(p)));var Z=_[f][s];if(T&&!T[f][s]&&(Z=void 0),void 0!==Z||d.hoverongaps){var W;Array.isArray(o.hovertext)&&Array.isArray(o.hovertext[f])?W=o.hovertext[f][s]:Array.isArray(o.text)&&Array.isArray(o.text[f])&&(W=o.text[f][s]);var G=x(d),ne=k.tickText({type:"linear",range:[G.min,G.max],hoverformat:L,_separators:u._separators,_numFormat:u._numFormat},Z,"hover").text;return[t.extendFlat(e,{index:d._after2before?d._after2before[f][s]:[f,s],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:R,x1:D,y0:j,y1:q,xLabelVal:m,yLabelVal:p,zLabelVal:Z,zLabel:ne,text:W})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),colorbar:v("./colorbar"),style:v("./style"),hoverPoints:v("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(v,Q,$){"use strict";var g=v("../../lib"),t=[[-1,0],[1,0],[0,-1],[0,1]];function k(e){return.5-.25*Math.min(1,.5*e)}function x(e,r,i){var c,n,m,p,s,f,l,o,d,u,a,y,h,_=0;for(p=0;p<r.length;p++){for(a=e[n=(c=r[p])[0]][m=c[1]],u=0,d=0,s=0;s<4;s++)(l=e[n+(f=t[s])[0]])&&void 0!==(o=l[m+f[1]])&&(0===u?y=h=o:(y=Math.min(y,o),h=Math.max(h,o)),d++,u+=o);if(0===d)throw"iterateInterp2d order is wrong: no defined neighbors";e[n][m]=u/d,void 0===a?d<4&&(_=1):(e[n][m]=(1+i)*e[n][m]-i*a,h>y&&(_=Math.max(_,Math.abs(e[n][m]-a)/(h-y))))}return _}Q.exports=function(e,r){var i,c=1;for(x(e,r),i=0;i<r.length&&!(r[i][2]<4);i++);for(r=r.slice(i),i=0;i<100&&c>.01;i++)c=x(e,r,k(c));return c>.01&&g.log("interp2d didn't converge quickly",c),e}},{"../../lib":515}],811:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){t("texttemplate");var x=g.extendFlat({},k.font,{color:"auto",size:"auto"});g.coerceFont(t,"textfont",x)}},{"../../lib":515}],812:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib").isArrayOrTypedArray;Q.exports=function(k,x,e,r,i,c){var n,m,p,s=[],f=g.traceIs(k,"contour"),l=g.traceIs(k,"histogram"),o=g.traceIs(k,"gl2d");if(t(x)&&x.length>1&&!l&&"category"!==c.type){var d=x.length;if(!(d<=i))return x.slice(0,f?i:i+1);if(f||o)s=x.slice(0,i);else if(1===i)s=[x[0]-.5,x[0]+.5];else{for(s=[1.5*x[0]-.5*x[1]],p=1;p<d;p++)s.push(.5*(x[p-1]+x[p]));s.push(1.5*x[d-1]-.5*x[d-2])}if(d<i){var u=s[s.length-1],a=u-s[s.length-2];for(p=d;p<i;p++)s.push(u+=a)}}else{var y=k[c._id.charAt(0)+"calendar"];for(n=l?c.r2c(e,0,y):t(x)&&1===x.length?x[0]:void 0===e?0:("log"===c.type?c.d2c:c.r2c)(e,0,y),m=r||1,p=f||o?0:-.5;p<i;p++)s.push(n+m*p)}return s}},{"../../lib":515,"../../registry":647}],813:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("tinycolor2"),k=v("../../registry"),x=v("../../components/drawing"),e=v("../../plots/cartesian/axes"),r=v("../../lib"),i=v("../../lib/svg_text_utils"),c=v("../scatter/format_labels"),n=v("../../components/color"),m=v("../../components/colorscale").extractOpts,p=v("../../components/colorscale").makeColorScaleFuncFromTrace,s=v("../../constants/xmlns_namespaces"),f=v("../../constants/alignment").LINE_SPACING;function l(y){return y.selectAll("g.heatmap-label")}function o(y){l(y).remove()}function d(y,h){var _=h.length-2,b=r.constrain(r.findBin(y,h),0,_),w=h[b],L=r.constrain(b+(y-w)/(h[b+1]-w)-.5,0,_),M=Math.round(L),P=Math.abs(L-M);return L&&L!==_&&P?{bin0:M,frac:P,bin1:Math.round(M+P/(L-M))}:{bin0:M,bin1:M,frac:0}}function u(y,h){var _=h.length-1,b=r.constrain(r.findBin(y,h),0,_),w=h[b],T=(y-w)/(h[b+1]-w)||0;return T<=0?{bin0:b,bin1:b,frac:0}:T<.5?{bin0:b,bin1:b+1,frac:T}:{bin0:b+1,bin1:b,frac:1-T}}function a(y,h,_){y[h]=_[0],y[h+1]=_[1],y[h+2]=_[2],y[h+3]=Math.round(255*_[3])}Q.exports=function(y,h,_,b){var w=h.xaxis,T=h.yaxis;r.makeTraceGroups(b,_,"hm").each(function(L){var M,P,z,S,C,R,D,j,q=g.select(this),Z=L[0],W=Z.trace,G=W.xgap||0,X=W.ygap||0,ne=Z.z,V=Z.x,N=Z.y,U=Z.xCenter,ee=Z.yCenter,B=k.traceIs(W,"contour"),K=B?"best":W.zsmooth,J=ne.length,te=r.maxRowLength(ne),ae=!1,ce=!1;for(R=0;void 0===M&&R<V.length-1;)M=w.c2p(V[R]),R++;for(R=V.length-1;void 0===P&&R>0;)P=w.c2p(V[R]),R--;for(P<M&&(z=P,P=M,M=z,ae=!0),R=0;void 0===S&&R<N.length-1;)S=T.c2p(N[R]),R++;for(R=N.length-1;void 0===C&&R>0;)C=T.c2p(N[R]),R--;if(C<S&&(z=S,S=C,C=z,ce=!0),B&&(U=V,ee=N,V=Z.xfill,N=Z.yfill),"fast"!==K){var oe="best"===K?0:.5;M=Math.max(-oe*w._length,M),P=Math.min((1+oe)*w._length,P),S=Math.max(-oe*T._length,S),C=Math.min((1+oe)*T._length,C)}var ve,fe,xe=Math.round(P-M),Se=Math.round(C-S);if(xe<=0||Se<=0)return q.selectAll("image").data([]).exit().remove(),void o(q);"fast"===K?(ve=te,fe=J):(ve=xe,fe=Se);var pe=document.createElement("canvas");pe.width=ve,pe.height=fe;var ge,Te,se=pe.getContext("2d"),de=p(W,{noNumericCheck:!0,returnArray:!0});"fast"===K?(ge=ae?function(cr){return te-1-cr}:r.identity,Te=ce?function(cr){return J-1-cr}:r.identity):(ge=function(cr){return r.constrain(Math.round(w.c2p(V[cr])-M),0,xe)},Te=function(cr){return r.constrain(Math.round(T.c2p(N[cr])-S),0,Se)});var Ae,Le,Me,De,Oe=Te(0),Ie=[Oe,Oe],Qe=ae?0:1,Ne=ce?0:1,Pe=0,Re=0,Ge=0,tt=0;function ct(cr,Sr){if(void 0!==cr){var Cr=de(cr);return Cr[0]=Math.round(Cr[0]),Cr[1]=Math.round(Cr[1]),Cr[2]=Math.round(Cr[2]),Pe+=Sr,Re+=Cr[0]*Sr,Ge+=Cr[1]*Sr,tt+=Cr[2]*Sr,Cr}return[0,0,0,0]}function wt(cr,Sr,Cr,pi){var Yn=cr[Cr.bin0];if(void 0===Yn)return ct(void 0,1);var Ar=cr[Cr.bin1],sr=Sr[Cr.bin0],dr=Sr[Cr.bin1];return ct(Yn+Cr.frac*(Ar-Yn||0)+pi.frac*((sr-Yn||0)+Cr.frac*(void 0===Ar?void 0===dr?0:void 0===sr?2*(dr-Yn):2*(2*dr-sr-Yn)/3:void 0===dr?void 0===sr?0:2*(2*Yn-Ar-sr)/3:void 0===sr?2*(2*dr-Ar-Yn)/3:dr+Yn-Ar-sr)))}if(K){var kt,gt=0;try{kt=new Uint8Array(xe*Se*4)}catch(cr){kt=new Array(xe*Se*4)}if("best"===K){var at,et,yt,Vt=U||V,Gt=ee||N,en=new Array(Vt.length),Jt=new Array(Gt.length),cn=new Array(xe),Rt=U?u:d,je=ee?u:d;for(R=0;R<Vt.length;R++)en[R]=Math.round(w.c2p(Vt[R])-M);for(R=0;R<Gt.length;R++)Jt[R]=Math.round(T.c2p(Gt[R])-S);for(R=0;R<xe;R++)cn[R]=Rt(R,en);for(D=0;D<Se;D++)for(et=ne[(at=je(D,Jt)).bin0],yt=ne[at.bin1],R=0;R<xe;R++,gt+=4)a(kt,gt,De=wt(et,yt,cn[R],at))}else for(D=0;D<J;D++)for(Me=ne[D],Ie=Te(D),R=0;R<xe;R++)De=ct(Me[R],1),a(kt,gt=4*(Ie*xe+ge(R)),De);var Ye=se.createImageData(xe,Se);try{Ye.data.set(kt)}catch(cr){var he=Ye.data,be=he.length;for(D=0;D<be;D++)he[D]=kt[D]}se.putImageData(Ye,0,0)}else{var Fe=Math.floor(G/2),He=Math.floor(X/2);for(D=0;D<J;D++)if(Me=ne[D],Ie.reverse(),Ie[Ne]=Te(D+1),Ie[0]!==Ie[1]&&void 0!==Ie[0]&&void 0!==Ie[1])for(Ae=[Le=ge(0),Le],R=0;R<te;R++)Ae.reverse(),Ae[Qe]=ge(R+1),Ae[0]!==Ae[1]&&void 0!==Ae[0]&&void 0!==Ae[1]&&(De=ct(Me[R],(Ae[1]-Ae[0])*(Ie[1]-Ie[0])),se.fillStyle="rgba("+De.join(",")+")",se.fillRect(Ae[0]+Fe,Ie[0]+He,Ae[1]-Ae[0]-G,Ie[1]-Ie[0]-X))}Re=Math.round(Re/Pe),Ge=Math.round(Ge/Pe),tt=Math.round(tt/Pe);var Ke=t("rgb("+Re+","+Ge+","+tt+")");y._hmpixcount=(y._hmpixcount||0)+Pe,y._hmlumcount=(y._hmlumcount||0)+Pe*Ke.getLuminance();var Ze=q.selectAll("image").data(L);Ze.enter().append("svg:image").attr({xmlns:s.svg,preserveAspectRatio:"none"}),Ze.attr({height:Se,width:xe,x:M,y:S,"xlink:href":pe.toDataURL("image/png")}),o(q);var ut=W.texttemplate;if(ut){var lt=m(W),Lt={type:"linear",range:[lt.min,lt.max],_separators:w._separators,_numFormat:w._numFormat},Ot="histogram2dcontour"===W.type,ot="contour"===W.type,pt=ot?J-1:J,qt=ot?1:0,St=ot?te-1:te,Mt=[];for(R=ot?1:0;R<pt;R++){var Ce;if(ot)Ce=Z.y[R];else if(Ot){if(0===R||R===J-1)continue;Ce=Z.y[R]}else if(Z.yCenter)Ce=Z.yCenter[R];else{if(R+1===J&&void 0===Z.y[R+1])continue;Ce=(Z.y[R]+Z.y[R+1])/2}var Xe=Math.round(T.c2p(Ce));if(!(0>Xe||Xe>T._length))for(D=qt;D<St;D++){var st;if(ot)st=Z.x[D];else if(Ot){if(0===D||D===te-1)continue;st=Z.x[D]}else if(Z.xCenter)st=Z.xCenter[D];else{if(D+1===te&&void 0===Z.x[D+1])continue;st=(Z.x[D]+Z.x[D+1])/2}var dt=Math.round(w.c2p(st));if(!(0>dt||dt>w._length)){var zt=c({x:st,y:Ce},W,y._fullLayout);zt.x=st,zt.y=Ce;var Ht=Z.z[R][D];void 0===Ht?(zt.z="",zt.zLabel=""):(zt.z=Ht,zt.zLabel=e.tickText(Lt,Ht,"hover").text);var Kt=Z.text&&Z.text[R]&&Z.text[R][D];void 0!==Kt&&!1!==Kt||(Kt=""),zt.text=Kt;var Zt=r.texttemplateString(ut,zt,y._fullLayout._d3locale,zt,W._meta||{});if(Zt){var vn=Zt.split("<br>"),zn=vn.length,gn=0;for(j=0;j<zn;j++)gn=Math.max(gn,vn[j].length);Mt.push({l:zn,c:gn,t:Zt,x:dt,y:Xe,z:Ht})}}}}var nn=W.textfont,an=nn.family,on=nn.size,mn=y._fullLayout.font.size;if(!on||"auto"===on){var _n=1/0,Pn=1/0,Rn=0,qn=0;for(j=0;j<Mt.length;j++){var Xn=Mt[j];if(Rn=Math.max(Rn,Xn.l),qn=Math.max(qn,Xn.c),j<Mt.length-1){var br=Mt[j+1],fr=Math.abs(br.x-Xn.x),Vr=Math.abs(br.y-Xn.y);fr&&(_n=Math.min(_n,fr)),Vr&&(Pn=Math.min(Pn,Vr))}}isFinite(_n)&&isFinite(Pn)?(_n-=G,Pn-=X,_n/=qn,Pn/=Rn,_n/=f/2,Pn/=f,on=Math.min(Math.floor(_n),Math.floor(Pn),mn)):on=mn}if(on<=0||!isFinite(on))return;l(q).data(Mt).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(cr){var pi,Sr=g.select(this),Cr=nn.color;Cr&&"auto"!==Cr||(Cr=n.contrast("rgba("+de(cr.z).join()+")")),Sr.attr("data-notex",1).call(i.positionText,(pi=cr,pi.x),function(pi){return pi.y-on*(pi.l*f/2-1)}(cr)).call(x.font,an,on,Cr).text(cr.t).call(i.convertToTspans,y)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(v,Q,$){"use strict";var g=v("@plotly/d3");Q.exports=function(t){g.select(t).selectAll(".hm image").style("opacity",function(k){return k.trace.opacity})}},{"@plotly/d3":58}],815:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){!1===k("zsmooth")&&(k("xgap"),k("ygap")),k("zhoverformat")}},{}],816:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../registry");function x(e,r){var i=r(e);return"scaled"===(i?r(e+"type","array"):"scaled")&&(r(e+"0"),r("d"+e)),i}Q.exports=function(e,r,i,c,n,m){var p,s,f=i("z");if(n=n||"x",m=m||"y",void 0===f||!f.length)return 0;if(t.isArray1D(e.z)){p=i(n),s=i(m);var l=t.minRowLength(p),o=t.minRowLength(s);if(0===l||0===o)return 0;r._length=Math.min(l,o,f.length)}else{if(p=x(n,i),s=x(m,i),!function(d){for(var u,a=!0,y=!1,h=!1,_=0;_<d.length;_++){if(!t.isArrayOrTypedArray(u=d[_])){a=!1;break}u.length>0&&(y=!0);for(var b=0;b<u.length;b++)if(g(u[b])){h=!0;break}}return a&&y&&h}(f))return 0;i("transpose"),r._length=null}return"heatmapgl"===e.type||k.getComponentMethod("calendars","handleTraceDefaults")(e,r,[n,m],c),!0}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(v,Q,$){"use strict";for(var g=v("../heatmap/attributes"),t=v("../../components/colorscale/attributes"),k=v("../../lib/extend").extendFlat,x=v("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],r={},i=0;i<e.length;i++){var c=e[i];r[c]=g[c]}r.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},k(r,t("",{cLetter:"z",autoColorDflt:!1})),Q.exports=x(r,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_heatmap2d,t=v("../../plots/cartesian/axes"),k=v("../../lib/str2rgbarray");function x(r,i){this.scene=r,this.uid=i,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=g(r.glplot,this.options),this.heatmap._trace=this}var e=x.prototype;e.handlePick=function(r){var i=this.options,c=i.shape,n=r.pointId,m=n%c[0],p=Math.floor(n/c[0]);return{trace:this,dataCoord:r.dataCoord,traceCoord:[i.x[m],i.y[p],i.z[n]],textLabel:this.textLabels[n],name:this.name,pointIndex:[p,m],hoverinfo:this.hoverinfo}},e.update=function(r,i){var c=i[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var n=c.z;this.options.z=[].concat.apply([],n),this.options.shape=[n[0].length,n.length],this.options.x=c.x,this.options.y=c.y,this.options.zsmooth=r.zsmooth;var s=function(u){for(var a=u.colorscale,y=u.zmin,h=u.zmax,_=a.length,b=new Array(_),w=new Array(4*_),T=0;T<_;T++){var L=a[T],M=k(L[1]);b[T]=y+L[0]*(h-y);for(var P=0;P<4;P++)w[4*T+P]=M[P]}return{colorLevels:b,colorValues:w}}(r);this.options.colorLevels=s.colorLevels,this.options.colorValues=s.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var f,l,o=this.scene.xaxis,d=this.scene.yaxis;!1===r.zsmooth&&(f={ppad:c.x[1]-c.x[0]},l={ppad:c.y[1]-c.y[0]}),r._extremes[o._id]=t.findExtremes(o,c.x,f),r._extremes[d._id]=t.findExtremes(d,c.y,l)},e.dispose=function(){this.heatmap.dispose()},Q.exports=function(r,i,c){var n=new x(r,i.uid);return n.update(i,c),n}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../heatmap/xyz_defaults"),k=v("../../components/colorscale/defaults"),x=v("./attributes");Q.exports=function(e,r,i,c){function n(m,p){return g.coerce(e,r,x,m,p)}t(e,r,n,c)?(n("text"),n("zsmooth"),k(e,r,c,n,{prefix:"",cLetter:"z"})):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(v,Q,$){"use strict";["*heatmapgl* trace is deprecated!","Please consider switching to the *heatmap* or *image* trace types.","Alternatively you could contribute/sponsor rewriting this trace type","based on cartesian features and using regl framework."].join(" "),Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("../heatmap/calc"),plot:v("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:v("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(v,Q,$){"use strict";var g=v("../bar/attributes"),t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../plots/font_attributes"),r=v("./bin_attributes"),i=v("./constants"),c=v("../../lib/extend").extendFlat;Q.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:t("x"),yhoverformat:t("y"),text:c({},g.text,{}),hovertext:c({},g.hovertext,{}),orientation:g.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:r("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:r("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:k({},{keys:i.eventDataKeys}),texttemplate:x({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:c({},g.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:g.insidetextanchor,textangle:g.textangle,cliponaxis:g.cliponaxis,constraintext:g.constraintext,marker:g.marker,offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:g.selected,unselected:g.unselected,_deprecated:{bardir:g._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(v,Q,$){"use strict";Q.exports=function(g,t){for(var k=g.length,x=0,e=0;e<k;e++)t[e]?(g[e]/=t[e],x+=g[e]):g[e]=null;return x}},{}],823:[function(v,Q,$){"use strict";Q.exports=function(g,t){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(v,Q,$){"use strict";var g=v("fast-isnumeric");Q.exports={count:function(t,k,x){return x[t]++,1},sum:function(t,k,x,e){var r=e[k];return g(r)?(r=Number(r),x[t]+=r,r):0},avg:function(t,k,x,e,r){var i=e[k];return g(i)&&(i=Number(i),x[t]+=i,r[t]++),0},min:function(t,k,x,e){var r=e[k];if(g(r)){if(r=Number(r),!g(x[t]))return x[t]=r,r;if(x[t]>r){var i=r-x[t];return x[t]=r,i}}return 0},max:function(t,k,x,e){var r=e[k];if(g(r)){if(r=Number(r),!g(x[t]))return x[t]=r,r;if(x[t]<r){var i=r-x[t];return x[t]=r,i}}return 0}}},{"fast-isnumeric":190}],825:[function(v,Q,$){"use strict";var g=v("../../constants/numerical"),t=g.ONEAVGYEAR,k=g.ONEAVGMONTH,x=g.ONEDAY,e=g.ONEHOUR,r=g.ONEMIN,i=g.ONESEC,c=v("../../plots/cartesian/axes").tickIncrement;function n(f,l,o,d){if(f*l<=0)return 1/0;for(var u=Math.abs(l-f),a="date"===o.type,y=m(u,a),h=0;h<10;h++){var _=m(80*y,a);if(y===_||!p(_,f,l,a,o,d))break;y=_}return y}function m(f,l){return l&&f>i?f>x?f>1.1*t?t:f>1.1*k?k:x:f>e?e:f>r?r:i:Math.pow(10,Math.floor(Math.log(f)/Math.LN10))}function p(f,l,o,d,u,a){if(d&&f>x){var y=s(l,u,a),h=s(o,u,a),_=f===t?0:1;return y[_]!==h[_]}return Math.floor(o/f)-Math.floor(l/f)>.1}function s(f,l,o){var d=l.c2d(f,t,o).split("-");return""===d[0]&&(d.unshift(),d[0]="-"+d[0]),d}Q.exports=function(f,l,o,d,u){var a,y,h=-1.1*l,_=-.1*l,b=f-_,w=o[0],T=o[1],L=Math.min(n(w+_,w+b,d,u),n(T+_,T+b,d,u)),M=Math.min(n(w+h,w+_,d,u),n(T+h,T+_,d,u));if(L>M&&M<Math.abs(T-w)/4e3?(a=L,y=!1):(a=Math.min(L,M),y=!0),"date"===d.type&&a>x){var P=a===t?1:6,z=a===t?"M12":"M1";return function(S,C){var R=d.c2d(S,t,u),D=R.indexOf("-",P);D>0&&(R=R.substr(0,D));var j=d.d2c(R,0,u);if(j<S){var q=c(j,z,!1,u);(j+q)/2<S+f&&(j=q)}return C&&y?c(j,z,!0,u):j}}return function(S,C){var R=a*Math.round(S/a);return R+a/10<S&&R+.9*a<S+f&&(R+=a),C&&y&&(R-=a),R}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../registry"),x=v("../../plots/cartesian/axes"),e=v("../bar/arrays_to_calcdata"),r=v("./bin_functions"),i=v("./norm_functions"),c=v("./average"),n=v("./bin_label_vals");function m(p,s,f,l,o){var d,u,a,y,h,_,b,w=l+"bins",T=p._fullLayout,M=T._histogramBinOpts[s["_"+l+"bingroup"]],P="overlay"===T.barmode,z=function(fe){return f.r2c(fe,0,y)},S=function(fe){return f.c2r(fe,0,y)},C="date"===f.type?function(fe){return fe||0===fe?t.cleanDate(fe,null,y):null}:function(fe){return g(fe)?Number(fe):null};function R(fe,xe,Se){xe[fe+"Found"]?(xe[fe]=C(xe[fe]),null===xe[fe]&&(xe[fe]=Se[fe])):(_[fe]=xe[fe]=Se[fe],t.nestedProperty(u[0],w+"."+fe).set(Se[fe]))}if(s["_"+l+"autoBinFinished"])delete s["_"+l+"autoBinFinished"];else{u=M.traces;var D=[],j=!0,q=!1,Z=!1;for(d=0;d<u.length;d++)if((a=u[d]).visible){var W=M.dirs[d];h=a["_"+W+"pos0"]=f.makeCalcdata(a,W),D=t.concat(D,h),delete a["_"+l+"autoBinFinished"],!0===s.visible&&(j?j=!1:(delete a._autoBin,a["_"+l+"autoBinFinished"]=1),k.traceIs(a,"2dMap")&&(q=!0),"histogram2dcontour"===a.type&&(Z=!0))}var G=x.autoBin(D,f,M.nbins,q,y=u[0][l+"calendar"],M.sizeFound&&M.size),X=u[0]._autoBin={};if(_=X[M.dirs[0]]={},Z&&(M.size||(G.start=S(x.tickIncrement(z(G.start),G.size,!0,y))),void 0===M.end&&(G.end=S(x.tickIncrement(z(G.end),G.size,!1,y)))),P&&!k.traceIs(s,"2dMap")&&0===G._dataSpan&&"category"!==f.type&&"multicategory"!==f.type){if(o)return[G,h,!0];G=function(fe,xe,Se,pe,ge){var Te,se,de,Ae=fe._fullLayout,Le=function(wt,kt){for(var gt=kt.xaxis,at=kt.yaxis,et=kt.orientation,yt=[],Vt=wt._fullData,Gt=0;Gt<Vt.length;Gt++){var en=Vt[Gt];"histogram"===en.type&&!0===en.visible&&en.orientation===et&&en.xaxis===gt&&en.yaxis===at&&yt.push(en)}return yt}(fe,xe),Me=!1,De=1/0,Oe=[xe];for(Te=0;Te<Le.length;Te++)if((se=Le[Te])===xe)Me=!0;else if(Me){var Ie=m(fe,se,Se,pe,!0),Qe=Ie[0],Ne=Ie[2];se["_"+pe+"autoBinFinished"]=1,se["_"+pe+"pos0"]=Ie[1],Ne?Oe.push(se):De=Math.min(De,Qe.size)}else de=Ae._histogramBinOpts[se["_"+pe+"bingroup"]],De=Math.min(De,de.size||se[ge].size);var Pe=new Array(Oe.length);for(Te=0;Te<Oe.length;Te++)for(var Re=Oe[Te]["_"+pe+"pos0"],Ge=0;Ge<Re.length;Ge++)if(void 0!==Re[Ge]){Pe[Te]=Re[Ge];break}for(isFinite(De)||(De=t.distinctVals(Pe).minDiff),Te=0;Te<Oe.length;Te++){var tt=(se=Oe[Te])[pe+"calendar"],ct={start:Se.c2r(Pe[Te]-De/2,0,tt),end:Se.c2r(Pe[Te]+De/2,0,tt),size:De};se._input[ge]=se[ge]=ct,(de=Ae._histogramBinOpts[se["_"+pe+"bingroup"]])&&t.extendFlat(de,ct)}return xe[ge]}(p,s,f,l,w)}(b=a.cumulative||{}).enabled&&"include"!==b.currentbin&&("decreasing"===b.direction?G.start=S(x.tickIncrement(z(G.start),G.size,!0,y)):G.end=S(x.tickIncrement(z(G.end),G.size,!1,y))),M.size=G.size,M.sizeFound||(_.size=G.size,t.nestedProperty(u[0],w+".size").set(G.size)),R("start",M,G),R("end",M,G)}h=s["_"+l+"pos0"],delete s["_"+l+"pos0"];var ne=s._input[w]||{},V=t.extendFlat({},M),N=M.start,U=f.r2l(ne.start),ee=void 0!==U;if((M.startFound||ee)&&U!==f.r2l(N)){var B=ee?U:t.aggNums(Math.min,null,h),K={type:"category"===f.type||"multicategory"===f.type?"linear":f.type,r2l:f.r2l,dtick:M.size,tick0:N,calendar:y,range:[B,x.tickIncrement(B,M.size,!1,y)].map(f.l2r)},J=x.tickFirst(K);J>f.r2l(B)&&(J=x.tickIncrement(J,M.size,!0,y)),V.start=f.l2r(J),ee||t.nestedProperty(s,w+".start").set(V.start)}var te=M.end,ae=f.r2l(ne.end),ce=void 0!==ae;if((M.endFound||ce)&&ae!==f.r2l(te)){var oe=ce?ae:t.aggNums(Math.max,null,h);V.end=f.l2r(oe),ce||t.nestedProperty(s,w+".start").set(V.end)}var ve="autobin"+l;return!1===s._input[ve]&&(s._input[w]=t.extendFlat({},s[w]||{}),delete s._input[ve],delete s[ve]),[V,h]}Q.exports={calc:function(p,s){var f,l,o,d,u=[],a=[],y="h"===s.orientation,h=x.getFromId(p,y?s.yaxis:s.xaxis),_=y?"y":"x",b={x:"y",y:"x"}[_],w=s[_+"calendar"],T=s.cumulative,L=m(p,s,h,_),M=L[0],P=L[1],z="string"==typeof M.size,S=[],C=z?S:M,R=[],D=[],j=[],q=0,Z=s.histnorm,W=s.histfunc,G=-1!==Z.indexOf("density");T.enabled&&G&&(Z=Z.replace(/ ?density$/,""),G=!1);var X,ne="max"===W||"min"===W?null:0,V=r.count,N=i[Z],U=!1,ee=function(se){return h.r2c(se,0,w)};for(t.isArrayOrTypedArray(s[b])&&"count"!==W&&(X=s[b],U="avg"===W,V=r[W]),f=ee(M.start),o=ee(M.end)+(f-x.tickIncrement(f,M.size,!1,w))/1e6;f<o&&u.length<1e6&&(l=x.tickIncrement(f,M.size,!1,w),u.push((f+l)/2),a.push(ne),j.push([]),S.push(f),G&&R.push(1/(l-f)),U&&D.push(0),!(l<=f));)f=l;S.push(f),z||"date"!==h.type||(C={start:ee(C.start),end:ee(C.end),size:C.size}),p._fullLayout._roundFnOpts||(p._fullLayout._roundFnOpts={});var B=s["_"+_+"bingroup"],K={leftGap:1/0,rightGap:1/0};B&&(p._fullLayout._roundFnOpts[B]||(p._fullLayout._roundFnOpts[B]=K),K=p._fullLayout._roundFnOpts[B]);var J,te=a.length,ae=!0,ce=K.leftGap,oe=K.rightGap,ve={};for(f=0;f<P.length;f++){var fe=P[f];(d=t.findBin(fe,C))>=0&&d<te&&(q+=V(d,f,a,X,D),ae&&j[d].length&&fe!==P[j[d][0]]&&(ae=!1),j[d].push(f),ve[f]=d,ce=Math.min(ce,fe-S[d]),oe=Math.min(oe,S[d+1]-fe))}K.leftGap=ce,K.rightGap=oe,ae||(J=function(se,de){return function(){var Ae=p._fullLayout._roundFnOpts[B];return n(Ae.leftGap,Ae.rightGap,S,h,w)(se,de)}}),U&&(q=c(a,D)),N&&N(a,q,R),T.enabled&&function(se,de,Ae){var Le,Me,De;function Oe(Qe){De=se[Qe],se[Qe]/=2}function Ie(Qe){se[Qe]=De+(Me=se[Qe])/2,De+=Me}if("half"===Ae)if("increasing"===de)for(Oe(0),Le=1;Le<se.length;Le++)Ie(Le);else for(Oe(se.length-1),Le=se.length-2;Le>=0;Le--)Ie(Le);else if("increasing"===de){for(Le=1;Le<se.length;Le++)se[Le]+=se[Le-1];"exclude"===Ae&&(se.unshift(0),se.pop())}else{for(Le=se.length-2;Le>=0;Le--)se[Le]+=se[Le+1];"exclude"===Ae&&(se.push(0),se.shift())}}(a,T.direction,T.currentbin);var xe=Math.min(u.length,a.length),Se=[],pe=0,ge=xe-1;for(f=0;f<xe;f++)if(a[f]){pe=f;break}for(f=xe-1;f>=pe;f--)if(a[f]){ge=f;break}for(f=pe;f<=ge;f++)if(g(u[f])&&g(a[f])){var Te={p:u[f],s:a[f],b:0};T.enabled||(Te.pts=j[f],ae?Te.ph0=Te.ph1=j[f].length?P[j[f][0]]:u[f]:(s._computePh=!0,Te.ph0=J(S[f]),Te.ph1=J(S[f+1],!0))),Se.push(Te)}return 1===Se.length&&(Se[0].width1=x.tickIncrement(Se[0].p,M.size,!1,w)-Se[0].p),e(Se,s),t.isArrayOrTypedArray(s.selectedpoints)&&t.tagSelected(Se,s,ve),Se},calcAllAutoBins:m}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(v,Q,$){"use strict";Q.exports={eventDataKeys:["binNumber"]}},{}],828:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axis_ids"),k=v("../../registry").traceIs,x=v("../bar/defaults").handleGroupingDefaults,e=g.nestedProperty,r=v("../../plots/cartesian/constraints").getAxisGroup,i=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],c=["x","y"];Q.exports=function(n,m){var p,s,f,l,o,d,u,a=m._histogramBinOpts={},y=[],h={},_=[];function b(G,X){return g.coerce(p._input,p,p._module.attributes,G,X)}function w(G){return"v"===G.orientation?"x":"y"}function T(G,X,ne){var V=G.uid+"__"+ne;X||(X=V);var N=t.getFromTrace({_fullLayout:m},G,ne).type,U=G[ne+"calendar"]||"",ee=a[X],B=!0;ee&&(N===ee.axType&&U===ee.calendar?(B=!1,ee.traces.push(G),ee.dirs.push(ne)):(X=V,N!==ee.axType&&g.warn(["Attempted to group the bins of trace",G.index,"set on a","type:"+N,"axis","with bins on","type:"+ee.axType,"axis."].join(" ")),U!==ee.calendar&&g.warn(["Attempted to group the bins of trace",G.index,"set with a",U,"calendar","with bins",ee.calendar?"on a "+ee.calendar+" calendar":"w/o a set calendar"].join(" ")))),B&&(a[X]={traces:[G],dirs:[ne],axType:N,calendar:G[ne+"calendar"]||""}),G["_"+ne+"bingroup"]=X}for(o=0;o<n.length;o++)k(p=n[o],"histogram")&&(y.push(p),delete p._xautoBinFinished,delete p._yautoBinFinished,k(p,"2dMap")||x(p._input,p,m,b));var L=m._alignmentOpts||{};for(o=0;o<y.length;o++){if(f="",!k(p=y[o],"2dMap")){if(l=w(p),"group"===m.barmode&&p.alignmentgroup){var P=r(m,p[l+"axis"])+p.orientation;(L[P]||{})[p.alignmentgroup]&&(f=P)}f||"overlay"===m.barmode||(f=r(m,p.xaxis)+r(m,p.yaxis)+w(p))}f?(h[f]||(h[f]=[]),h[f].push(p)):_.push(p)}for(f in h)if(1!==(s=h[f]).length){var z=!1;for(s.length&&(p=s[0],z=b("bingroup")),f=z||f,o=0;o<s.length;o++){var S=(p=s[o])._input.bingroup;S&&S!==f&&g.warn(["Trace",p.index,"must match","within bingroup",f+".","Ignoring its bingroup:",S,"setting."].join(" ")),p.bingroup=f,T(p,f,w(p))}}else _.push(s[0]);for(o=0;o<_.length;o++){p=_[o];var C=b("bingroup");if(k(p,"2dMap"))for(u=0;u<2;u++){var R=b((l=c[u])+"bingroup",C?C+"__"+l:null);T(p,R,l)}else T(p,C,w(p))}for(f in a){var D=a[f];for(s=D.traces,d=0;d<i.length;d++){var j,q,Z=i[d],W=Z.name;if("nbins"!==W||!D.sizeFound){for(o=0;o<s.length;o++){if(void 0!==e((p=s[o])._input,j=Z.aStr[l=D.dirs[o]]).get()){D[W]=b(j),D[W+"Found"]=!0;break}(q=(p._autoBin||{})[l]||{})[W]&&e(p,j).set(q[W])}if("start"===W||"end"===W)for(;o<s.length;o++)(p=s[o])["_"+l+"bingroup"]&&b(j,(q=(p._autoBin||{})[l]||{})[W]);"nbins"!==W||D.sizeFound||D.nbinsFound||(p=s[0],D[W]=b(j))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../../components/color"),x=v("../bar/defaults").handleText,e=v("../bar/style_defaults"),r=v("./attributes");Q.exports=function(i,c,n,m){function p(_,b){return t.coerce(i,c,r,_,b)}var s=p("x"),f=p("y");p("cumulative.enabled")&&(p("cumulative.direction"),p("cumulative.currentbin")),p("text");var l=p("textposition");x(i,c,m,p,l,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat");var o=p("orientation",f&&!s?"h":"v"),d="v"===o?"x":"y",u="v"===o?"y":"x",a=s&&f?Math.min(t.minRowLength(s)&&t.minRowLength(f)):t.minRowLength(c[d]||[]);if(a){c._length=a,g.getComponentMethod("calendars","handleTraceDefaults")(i,c,["x","y"],m),c[u]&&p("histfunc"),p("histnorm"),p("autobin"+d),e(i,c,p,n,m),t.coerceSelectionMarkerOpacity(c,p);var y=(c.marker.line||{}).color,h=g.getComponentMethod("errorbars","supplyDefaults");h(i,c,y||k.defaultLine,{axis:"y"}),h(i,c,y||k.defaultLine,{axis:"x",inherit:"y"})}else c.visible=!1}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){if(g.x="xVal"in t?t.xVal:t.x,g.y="yVal"in t?t.yVal:t.y,"zLabelVal"in t&&(g.z=t.zLabelVal),t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),!(k.cumulative||{}).enabled){var r,i=Array.isArray(e)?x[0].pts[e[0]][e[1]]:x[e].pts;if(g.pointNumbers=i,g.binNumber=g.pointNumber,delete g.pointNumber,delete g.pointIndex,k._indexToPoints){r=[];for(var c=0;c<i.length;c++)r=r.concat(k._indexToPoints[i[c]])}else r=i;g.pointIndices=r}return g}},{}],831:[function(v,Q,$){"use strict";var g=v("../bar/hover").hoverPoints,t=v("../../plots/cartesian/axes").hoverLabelText;Q.exports=function(k,x,e,r,i){var c=g(k,x,e,r,i);if(c){var n=(k=c[0]).cd[k.index],m=k.cd[0].trace;if(!m.cumulative.enabled){var p="h"===m.orientation?"y":"x";k[p+"Label"]=t(k[p+"a"],[n.ph0,n.ph1],m[p+"hoverformat"])}return c}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),layoutAttributes:v("../bar/layout_attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),supplyLayoutDefaults:v("../bar/layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("../bar/cross_trace_calc").crossTraceCalc,plot:v("../bar/plot").plot,layerName:"barlayer",style:v("../bar/style").style,styleOnSelect:v("../bar/style").styleOnSelect,colorbar:v("../scatter/marker_colorbar"),hoverPoints:v("./hover"),selectPoints:v("../bar/select"),eventData:v("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(v,Q,$){"use strict";Q.exports={percent:function(g,t){for(var k=g.length,x=100/t,e=0;e<k;e++)g[e]*=x},probability:function(g,t){for(var k=g.length,x=0;x<k;x++)g[x]/=t},density:function(g,t,k,x){var e=g.length;x=x||1;for(var r=0;r<e;r++)g[r]*=k[r]*x},"probability density":function(g,t,k,x){var e=g.length;x&&(t/=x);for(var r=0;r<e;r++)g[r]*=k[r]/t}}},{}],834:[function(v,Q,$){"use strict";var g=v("../histogram/attributes"),t=v("../histogram/bin_attributes"),k=v("../heatmap/attributes"),x=v("../../plots/attributes"),e=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,r=v("../../plots/template_attributes").hovertemplateAttrs,i=v("../../plots/template_attributes").texttemplateAttrs,c=v("../../components/colorscale/attributes"),n=v("../../lib/extend").extendFlat;Q.exports=n({x:g.x,y:g.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:g.histnorm,histfunc:g.histfunc,nbinsx:g.nbinsx,xbins:t("x"),nbinsy:g.nbinsy,ybins:t("y"),autobinx:g.autobinx,autobiny:g.autobiny,bingroup:n({},g.bingroup,{}),xbingroup:n({},g.bingroup,{}),ybingroup:n({},g.bingroup,{}),xgap:k.xgap,ygap:k.ygap,zsmooth:k.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:r({},{keys:"z"}),texttemplate:i({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:k.textfont,showlegend:n({},x.showlegend,{dflt:!1})},c("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../histogram/bin_functions"),x=v("../histogram/norm_functions"),e=v("../histogram/average"),r=v("../histogram/bin_label_vals"),i=v("../histogram/calc").calcAllAutoBins;function c(p,s,f,l){var o,d=new Array(p);if(l)for(o=0;o<p;o++)d[o]=1/(s[o+1]-s[o]);else{var u=1/f;for(o=0;o<p;o++)d[o]=u}return d}function n(p,s){return{start:p(s.start),end:p(s.end),size:s.size}}function m(p,s,f,l,o,d){var u,a=p.length-1,y=new Array(a),h=r(f,l,p,o,d);for(u=0;u<a;u++){var _=(s||[])[u];y[u]=void 0===_?[h(p[u]),h(p[u+1],!0)]:[_,_]}return y}Q.exports=function(p,s){var f,l,o,d,u=t.getFromId(p,s.xaxis),a=t.getFromId(p,s.yaxis),y=s.xcalendar,h=s.ycalendar,_=function(at){return u.r2c(at,0,y)},b=function(at){return a.r2c(at,0,h)},w=i(p,s,u,"x"),T=w[0],L=w[1],M=i(p,s,a,"y"),P=M[0],z=M[1],S=s._length;L.length>S&&L.splice(S,L.length-S),z.length>S&&z.splice(S,z.length-S);var C=[],R=[],D=[],j="string"==typeof T.size,q="string"==typeof P.size,Z=[],W=[],G=j?Z:T,X=q?W:P,ne=0,V=[],N=[],U=s.histnorm,ee=s.histfunc,B=-1!==U.indexOf("density"),K="max"===ee||"min"===ee?null:0,J=k.count,te=x[U],ae=!1,ce=[],oe=[],ve="z"in s?s.z:"marker"in s&&Array.isArray(s.marker.color)?s.marker.color:"";ve&&"count"!==ee&&(ae="avg"===ee,J=k[ee]);var fe=T.size,xe=_(T.start),Se=_(T.end)+(xe-t.tickIncrement(xe,fe,!1,y))/1e6;for(f=xe;f<Se;f=t.tickIncrement(f,fe,!1,y))R.push(K),Z.push(f),ae&&D.push(0);Z.push(f);var ge=R.length,Te=(f-xe)/ge,se=u.c2r(xe+Te/2,0,y),de=P.size,Ae=b(P.start),Le=b(P.end)+(Ae-t.tickIncrement(Ae,de,!1,h))/1e6;for(f=Ae;f<Le;f=t.tickIncrement(f,de,!1,h)){C.push(R.slice()),W.push(f);var Me=new Array(ge);for(l=0;l<ge;l++)Me[l]=[];N.push(Me),ae&&V.push(D.slice())}W.push(f);var De=C.length,Oe=(f-Ae)/De,Ie=a.c2r(Ae+Oe/2,0,h);B&&(ce=c(R.length,G,Te,j),oe=c(C.length,X,Oe,q)),j||"date"!==u.type||(G=n(_,G)),q||"date"!==a.type||(X=n(b,X));var Qe=!0,Ne=!0,Pe=new Array(ge),Re=new Array(De),Ge=1/0,tt=1/0,ct=1/0,wt=1/0;for(f=0;f<S;f++){var kt=L[f],gt=z[f];o=g.findBin(kt,G),d=g.findBin(gt,X),o>=0&&o<ge&&d>=0&&d<De&&(ne+=J(o,f,C[d],ve,V[d]),N[d][o].push(f),Qe&&(void 0===Pe[o]?Pe[o]=kt:Pe[o]!==kt&&(Qe=!1)),Ne&&(void 0===Re[d]?Re[d]=gt:Re[d]!==gt&&(Ne=!1)),Ge=Math.min(Ge,kt-Z[o]),tt=Math.min(tt,Z[o+1]-kt),ct=Math.min(ct,gt-W[d]),wt=Math.min(wt,W[d+1]-gt))}if(ae)for(d=0;d<De;d++)ne+=e(C[d],V[d]);if(te)for(d=0;d<De;d++)te(C[d],ne,ce,oe[d]);return{x:L,xRanges:m(Z,Qe&&Pe,Ge,tt,u,y),x0:se,dx:Te,y:z,yRanges:m(W,Ne&&Re,ct,wt,a,h),y0:Ie,dy:Oe,z:C,pts:N}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./sample_defaults"),k=v("../heatmap/style_defaults"),x=v("../../components/colorscale/defaults"),e=v("../heatmap/label_defaults"),r=v("./attributes");Q.exports=function(i,c,n,m){function p(s,f){return g.coerce(i,c,r,s,f)}t(i,c,p,m),!1!==c.visible&&(k(i,c,p,m),x(i,c,m,p,{prefix:"",cLetter:"z"}),p("hovertemplate"),e(p,m),p("xhoverformat"),p("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(v,Q,$){"use strict";var g=v("../heatmap/hover"),t=v("../../plots/cartesian/axes").hoverLabelText;Q.exports=function(k,x,e,r,i){var c=g(k,x,e,r,i);if(c){var n=(k=c[0]).index,s=k.cd[0],f=s.trace,l=s.xRanges[n[1]],o=s.yRanges[n[0]];return k.xLabel=t(k.xa,[l[0],l[1]],f.xhoverformat),k.yLabel=t(k.ya,[o[0],o[1]],f.yhoverformat),c}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../histogram/cross_trace_defaults"),calc:v("../heatmap/calc"),plot:v("../heatmap/plot"),layerName:"heatmaplayer",colorbar:v("../heatmap/colorbar"),style:v("../heatmap/style"),hoverPoints:v("./hover"),eventData:v("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib");Q.exports=function(k,x,e,r){var i=e("x"),c=e("y"),n=t.minRowLength(i),m=t.minRowLength(c);n&&m?(x._length=Math.min(n,m),g.getComponentMethod("calendars","handleTraceDefaults")(k,x,["x","y"],r),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):x.visible=!1}},{"../../lib":515,"../../registry":647}],840:[function(v,Q,$){"use strict";var g=v("../histogram2d/attributes"),t=v("../contour/attributes"),k=v("../../components/colorscale/attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../lib/extend").extendFlat;Q.exports=e({x:g.x,y:g.y,z:g.z,marker:g.marker,histnorm:g.histnorm,histfunc:g.histfunc,nbinsx:g.nbinsx,xbins:g.xbins,nbinsy:g.nbinsy,ybins:g.ybins,autobinx:g.autobinx,autobiny:g.autobiny,bingroup:g.bingroup,xbingroup:g.xbingroup,ybingroup:g.ybingroup,autocontour:t.autocontour,ncontours:t.ncontours,contours:t.contours,line:{color:t.line.color,width:e({},t.line.width,{dflt:.5}),dash:t.line.dash,smoothing:t.line.smoothing,editType:"plot"},xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:g.hovertemplate,texttemplate:t.texttemplate,textfont:t.textfont},k("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../histogram2d/sample_defaults"),k=v("../contour/contours_defaults"),x=v("../contour/style_defaults"),e=v("../heatmap/label_defaults"),r=v("./attributes");Q.exports=function(i,c,n,m){function p(s,f){return g.coerce(i,c,r,s,f)}t(i,c,p,m),!1!==c.visible&&(k(i,c,p,function(s){return g.coerce2(i,c,r,s)}),x(i,c,p,m),p("xhoverformat"),p("yhoverformat"),p("hovertemplate"),c.contours&&"heatmap"===c.contours.coloring&&e(p,m))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../histogram/cross_trace_defaults"),calc:v("../contour/calc"),plot:v("../contour/plot").plot,layerName:"contourlayer",style:v("../contour/style"),colorbar:v("../contour/colorbar"),hoverPoints:v("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../components/colorscale/attributes"),x=v("../../plots/domain").attributes,e=v("../pie/attributes"),r=v("../sunburst/attributes"),i=v("../treemap/attributes"),c=v("../treemap/constants"),n=v("../../lib/extend").extendFlat;Q.exports={labels:r.labels,parents:r.parents,values:r.values,branchvalues:r.branchvalues,count:r.count,level:r.level,maxdepth:r.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:i.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:n({colors:r.marker.colors,line:r.marker.line,editType:"calc"},k("marker",{colorAttr:"colors",anim:!1})),leaf:r.leaf,pathbar:i.pathbar,text:e.text,textinfo:r.textinfo,texttemplate:t({editType:"plot"},{keys:c.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:r.hoverinfo,hovertemplate:g({},{keys:c.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:i.outsidetextfont,textposition:i.textposition,sort:e.sort,root:r.root,domain:x({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(v,Q,$){"use strict";var g=v("../../plots/plots");$.name="icicle",$.plot=function(t,k,x,e){g.plotBasePlot($.name,t,k,x,e)},$.clean=function(t,k,x,e){g.cleanBasePlot($.name,t,k,x,e)}},{"../../plots/plots":628}],845:[function(v,Q,$){"use strict";var g=v("../sunburst/calc");$.calc=function(t,k){return g.calc(t,k)},$.crossTraceCalc=function(t){return g._runCrossTraceCalc("icicle",t)}},{"../sunburst/calc":1060}],846:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../components/color"),x=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText,r=v("../bar/constants").TEXTPAD,i=v("../../components/colorscale"),c=i.hasColorscale,n=i.handleDefaults;Q.exports=function(m,p,s,f){function l(_,b){return g.coerce(m,p,t,_,b)}var o=l("labels"),d=l("parents");if(o&&o.length&&d&&d.length){var u=l("values");l(u&&u.length?"branchvalues":"count"),l("level"),l("maxdepth"),l("tiling.orientation"),l("tiling.flip"),l("tiling.pad");var a=l("text");l("texttemplate"),p.texttemplate||l("textinfo",Array.isArray(a)?"text+label":"label"),l("hovertext"),l("hovertemplate");var y=l("pathbar.visible");e(m,p,f,l,"auto",{hasPathbar:y,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),l("textposition"),l("marker.line.width")&&l("marker.line.color",f.paper_bgcolor),l("marker.colors");var h=p._hasColorscale=c(m,"marker","colors")||(m.marker||{}).coloraxis;h&&n(m,p,f,l,{prefix:"marker.",cLetter:"c"}),l("leaf.opacity",h?1:.7),p._hovered={marker:{line:{width:2,color:k.contrast(f.paper_bgcolor)}}},y&&(l("pathbar.thickness",p.pathbar.textfont.size+2*r),l("pathbar.side"),l("pathbar.edgeshape")),l("sort"),l("root.color"),x(p,f,l),p._length=null}else p.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../../lib/svg_text_utils"),e=v("./partition"),r=v("./style").styleOne,i=v("../treemap/constants"),c=v("../sunburst/helpers"),n=v("../sunburst/fx"),m=v("../sunburst/plot").formatSliceLabel;Q.exports=function(p,s,f,l,o){var d=o.width,u=o.height,a=o.viewX,y=o.viewY,h=o.pathSlice,_=o.toMoveInsideSlice,b=o.strTransform,w=o.hasTransition,T=o.handleSlicesExit,L=o.makeUpdateSliceInterpolator,M=o.makeUpdateTextInterpolator,P=o.prevEntry,z=p._context.staticPlot,S=p._fullLayout,C=s[0].trace,R=-1!==C.textposition.indexOf("left"),D=-1!==C.textposition.indexOf("right"),j=-1!==C.textposition.indexOf("bottom"),q=e(f,[d,u],{flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1,orientation:C.tiling.orientation,pad:{inner:C.tiling.pad},maxDepth:C._maxDepth}).descendants(),Z=1/0,W=-1/0;q.forEach(function(N){var U=N.depth;U>=C._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(Z=Math.min(Z,U),W=Math.max(W,U))}),l=l.data(q,c.getPtId),C._maxVisibleLayers=isFinite(W)?W-Z+1:0,l.enter().append("g").classed("slice",!0),T(l,!1,{},[d,u],h),l.order();var G=null;if(w&&P){var X=c.getPtId(P);l.each(function(N){null===G&&c.getPtId(N)===X&&(G={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var ne=function(){return G||{x0:0,x1:d,y0:0,y1:u}},V=l;return w&&(V=V.transition().each("end",function(){var N=g.select(this);c.setSliceCursor(N,p,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),V.each(function(N){N._x0=a(N.x0),N._x1=a(N.x1),N._y0=y(N.y0),N._y1=y(N.y1),N._hoverX=a(N.x1-C.tiling.pad),N._hoverY=y(j?N.y1-C.tiling.pad/2:N.y0+C.tiling.pad/2);var U=g.select(this),ee=t.ensureSingle(U,"path","surface",function(te){te.style("pointer-events",z?"none":"all")});w?ee.transition().attrTween("d",function(te){var ae=L(te,!1,ne(),[d,u],{orientation:C.tiling.orientation,flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1});return function(ce){return h(ae(ce))}}):ee.attr("d",h),U.call(n,f,p,s,{styleOne:r,eventDataKeys:i.eventDataKeys,transitionTime:i.CLICK_TRANSITION_TIME,transitionEasing:i.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,p,{isTransitioning:p._transitioning}),ee.call(r,N,C,{hovered:!1}),N._text=N.x0===N.x1||N.y0===N.y1?"":m(N,f,C,s,S)||"";var B=t.ensureSingle(U,"g","slicetext"),K=t.ensureSingle(B,"text","",function(te){te.attr("data-notex",1)}),J=t.ensureUniformFontSize(p,c.determineTextFont(C,N,S.font));K.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":R?"start":"middle").call(k.font,J).call(x.convertToTspans,p),N.textBB=k.bBox(K.node()),N.transform=_(N,{fontSize:J.size}),N.transform.fontSize=J.size,w?K.transition().attrTween("transform",function(te){var ae=M(te,!1,ne(),[d,u]);return function(ce){return b(ae(ce))}}):K.attr("transform",b(N))}),G}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"icicle",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(v,Q,$){"use strict";Q.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x){function e(r,i){return g.coerce(k,x,t,r,i)}e("iciclecolorway",x.colorway),e("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(v,Q,$){"use strict";var g=v("d3-hierarchy"),t=v("../treemap/flip_tree");Q.exports=function(k,x,e){var r=e.flipX,i=e.flipY,c="h"===e.orientation,n=e.maxDepth,m=x[0],p=x[1];n&&(m=(k.height+1)*x[0]/Math.min(k.height+1,n),p=(k.height+1)*x[1]/Math.min(k.height+1,n));var s=g.partition().padding(e.pad.inner).size(c?[x[1],m]:[x[0],p])(k);return(c||r||i)&&t(s,x,{swapXY:c,flipX:r,flipY:i}),s}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(v,Q,$){"use strict";var g=v("../treemap/draw"),t=v("./draw_descendants");Q.exports=function(k,x,e,r){return g(k,x,e,r,{type:"icicle",drawDescendants:t})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../../lib"),x=v("../bar/uniform_text").resizeText;function e(r,i,c){var n=i.data.data,m=!i.children,p=n.i,s=k.castOption(c,p,"marker.line.color")||t.defaultLine,f=k.castOption(c,p,"marker.line.width")||0;r.style("stroke-width",f).call(t.fill,n.color).call(t.stroke,s).style("opacity",m?c.leaf.opacity:null)}Q.exports={style:function(r){var i=r._fullLayout._iciclelayer.selectAll(".trace");x(r,i,"icicle"),i.each(function(c){var n=g.select(this),m=c[0].trace;n.style("opacity",m.opacity),n.selectAll("path.surface").each(function(p){g.select(this).call(e,p,m)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(v,Q,$){"use strict";for(var g=v("../../plots/attributes"),t=v("../../plots/template_attributes").hovertemplateAttrs,k=v("../../lib/extend").extendFlat,x=v("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],r=[],i=[],c=0;c<e.length;c++){var n=x[e[c]];r.push("For the `"+e[c]+"` colormodel, it is ["+(n.zminDflt||n.min).join(", ")+"]."),i.push("For the `"+e[c]+"` colormodel, it is ["+(n.zmaxDflt||n.max).join(", ")+"].")}Q.exports=k({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:k({},g.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:t({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./constants"),k=v("fast-isnumeric"),x=v("../../plots/cartesian/axes"),e=v("../../lib").maxRowLength,r=v("./helpers").getImageSize;function i(n,m,p,s){return function(f){return g.constrain((f-n)*m,p,s)}}function c(n,m){return function(p){return g.constrain(p,n,m)}}Q.exports=function(n,m){var p,s;if(m._hasZ)p=m.z.length,s=e(m.z);else if(m._hasSource){var f=r(m.source);p=f.height,s=f.width}var l,o=x.getFromId(n,m.xaxis||"x"),d=x.getFromId(n,m.yaxis||"y"),u=o.d2c(m.x0)-m.dx/2,a=d.d2c(m.y0)-m.dy/2,y=[u,u+s*m.dx],h=[a,a+p*m.dy];if(o&&"log"===o.type)for(l=0;l<s;l++)y.push(u+l*m.dx);if(d&&"log"===d.type)for(l=0;l<p;l++)h.push(a+l*m.dy);return m._extremes[o._id]=x.findExtremes(o,y),m._extremes[d._id]=x.findExtremes(d,h),m._scaler=function(_){var b=t.colormodel[_.colormodel],w=(b.colormodel||_.colormodel).length;_._sArray=[];for(var T=0;T<w;T++)_._sArray.push(b.min[T]!==_.zmin[T]||b.max[T]!==_.zmax[T]?i(_.zmin[T],(b.max[T]-b.min[T])/(_.zmax[T]-_.zmin[T]),b.min[T],b.max[T]):c(b.min[T],b.max[T]));return function(L){for(var M=L.slice(0,w),P=0;P<w;P++){var z=M[P];if(!k(z))return!1;M[P]=_._sArray[P](z)}return M}}(m),[{x0:u,y0:a,z:m.z,w:s,h:p}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(v,Q,$){"use strict";Q.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(g){return g.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(g){return g.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(g){return g.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(g){var t=g.slice(0,3);return t[1]=t[1]+"%",t[2]=t[2]+"%",t},suffix:["\xb0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(g){var t=g.slice(0,4);return t[1]=t[1]+"%",t[2]=t[2]+"%",t},suffix:["\xb0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("./constants"),x=v("../../snapshot/helpers").IMAGE_URL_PREFIX;Q.exports=function(e,r){function i(m,p){return g.coerce(e,r,t,m,p)}i("source"),r.source&&!r.source.match(x)&&delete r.source,r._hasSource=!!r.source;var c,n=i("z");r._hasZ=!(void 0===n||!n.length||!n[0]||!n[0].length),r._hasZ||r._hasSource?(i("x0"),i("y0"),i("dx"),i("dy"),r._hasZ?(i("colormodel","rgb"),i("zmin",(c=k.colormodel[r.colormodel]).zminDflt||c.min),i("zmax",c.zmaxDflt||c.max)):r._hasSource&&(r.colormodel="rgba256",r.zmin=(c=k.colormodel[r.colormodel]).zminDflt,r.zmax=c.zmaxDflt),i("zsmooth"),i("text"),i("hovertext"),i("hovertemplate"),r._length=null):r.visible=!1}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(v,Q,$){"use strict";Q.exports=function(g,t){return"xVal"in t&&(g.x=t.xVal),"yVal"in t&&(g.y=t.yVal),t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),g.color=t.color,g.colormodel=t.trace.colormodel,g.z||(g.z=t.color),g}},{}],859:[function(v,Q,$){"use strict";var g=v("probe-image-size/sync"),t=v("../../snapshot/helpers").IMAGE_URL_PREFIX,k=v("buffer/").Buffer;$.getImageSize=function(x){var e=x.replace(t,""),r=new k(e,"base64");return g(r)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(v,Q,$){"use strict";var g=v("../../components/fx"),t=v("../../lib"),k=v("./constants");Q.exports=function(x,e,r){var i=x.cd[0],c=i.trace,n=x.xa,m=x.ya;if(!(g.inbox(e-i.x0,e-(i.x0+i.w*c.dx),0)>0||g.inbox(r-i.y0,r-(i.y0+i.h*c.dy),0)>0)){var p,s=Math.floor((e-i.x0)/c.dx),f=Math.floor(Math.abs(r-i.y0)/c.dy);if(c._hasZ?p=i.z[f][s]:c._hasSource&&(p=c._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(s,f,1,1).data),p){var l,o=i.hi||c.hoverinfo;if(o){var d=o.split("+");-1!==d.indexOf("all")&&(d=["color"]),-1!==d.indexOf("color")&&(l=!0)}var u,a=k.colormodel[c.colormodel],y=a.colormodel||c.colormodel,h=y.length,_=c._scaler(p),b=a.suffix,w=[];(c.hovertemplate||l)&&(w.push("["+[_[0]+b[0],_[1]+b[1],_[2]+b[2]].join(", ")),4===h&&w.push(", "+_[3]+b[3]),w.push("]"),w=w.join(""),x.extraText=y.toUpperCase()+": "+w),Array.isArray(c.hovertext)&&Array.isArray(c.hovertext[f])?u=c.hovertext[f][s]:Array.isArray(c.text)&&Array.isArray(c.text[f])&&(u=c.text[f][s]);var T=m.c2p(i.y0+(f+.5)*c.dy),L=i.x0+(s+.5)*c.dx,M=i.y0+(f+.5)*c.dy,P="["+p.slice(0,c.colormodel.length).join(", ")+"]";return[t.extendFlat(x,{index:[f,s],x0:n.c2p(i.x0+s*c.dx),x1:n.c2p(i.x0+(s+1)*c.dx),y0:T,y1:T,color:_,xVal:L,xLabelVal:L,yVal:M,yLabelVal:M,zLabelVal:P,text:u,hovertemplateLabels:{zLabel:P,colorLabel:w,"color[0]Label":_[0]+b[0],"color[1]Label":_[1]+b[1],"color[2]Label":_[2]+b[2],"color[3]Label":_[3]+b[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),style:v("./style"),hoverPoints:v("./hover"),eventData:v("./event_data"),moduleType:"trace",name:"image",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=t.strTranslate,x=v("../../constants/xmlns_namespaces"),e=v("./constants"),r=t.isIOS()||t.isSafari()||t.isIE();Q.exports=function(i,c,n,m){var p=c.xaxis,s=c.yaxis,f=!(r||i._context._exportedPlot);t.makeTraceGroups(m,n,"im").each(function(l){var o=g.select(this),d=l[0],u=d.trace,a=("fast"===u.zsmooth||!1===u.zsmooth&&f)&&!u._hasZ&&u._hasSource&&"linear"===p.type&&"linear"===s.type;u._realImage=a;var y,h,_,b,w,T,L=d.z,M=d.x0,P=d.y0,z=d.w,S=d.h,C=u.dx,R=u.dy;for(T=0;void 0===y&&T<z;)y=p.c2p(M+T*C),T++;for(T=z;void 0===h&&T>0;)h=p.c2p(M+T*C),T--;for(T=0;void 0===b&&T<S;)b=s.c2p(P+T*R),T++;for(T=S;void 0===w&&T>0;)w=s.c2p(P+T*R),T--;h<y&&(_=h,h=y,y=_),w<b&&(_=b,b=w,w=_),!a&&(y=Math.max(-.5*p._length,y),h=Math.min(1.5*p._length,h),b=Math.max(-.5*s._length,b),w=Math.min(1.5*s._length,w));var D=Math.round(h-y),j=Math.round(w-b);if(D<=0||j<=0)o.selectAll("image").data([]).exit().remove();else{var q=o.selectAll("image").data([l]);q.enter().append("svg:image").attr({xmlns:x.svg,preserveAspectRatio:"none"}),q.exit().remove();var Z=!1===u.zsmooth?e.pixelatedStyle:"";if(a){var W=t.simpleMap(p.range,p.r2l),G=t.simpleMap(s.range,s.r2l),X=W[1]<W[0],ne=G[1]>G[0];if(X||ne){var V=y+D/2,N=b+j/2;Z+="transform:"+k(V+"px",N+"px")+"scale("+(X?-1:1)+","+(ne?-1:1)+")"+k(-V+"px",-N+"px")+";"}}q.attr("style",Z);var U=new Promise(function(B){if(u._hasZ)B();else if(u._hasSource)if(u._canvas&&u._canvas.el.width===z&&u._canvas.el.height===S&&u._canvas.source===u.source)B();else{var K=document.createElement("canvas");K.width=z,K.height=S;var J=K.getContext("2d",{willReadFrequently:!0});u._image=u._image||new Image;var te=u._image;te.onload=function(){J.drawImage(te,0,0),u._canvas={el:K,source:u.source},B()},te.setAttribute("src",u.source)}}).then(function(){var B;if(u._hasZ)B=ee(function(J,te){return L[te][J]}).toDataURL("image/png");else if(u._hasSource)if(a)B=u.source;else{var K=u._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,z,S).data;B=ee(function(J,te){var ae=4*(te*z+J);return[K[ae],K[ae+1],K[ae+2],K[ae+3]]}).toDataURL("image/png")}q.attr({"xlink:href":B,height:j,width:D,x:y,y:b})});i._promises.push(U)}function ee(B){var K=document.createElement("canvas");K.width=D,K.height=j;var J,te=K.getContext("2d",{willReadFrequently:!0}),ae=function(se){return t.constrain(Math.round(p.c2p(M+se*C)-y),0,D)},ce=function(se){return t.constrain(Math.round(s.c2p(P+se*R)-b),0,j)},oe=e.colormodel[u.colormodel],ve=oe.colormodel||u.colormodel,fe=oe.fmt;for(T=0;T<d.w;T++){var xe=ae(T),Se=ae(T+1);if(Se!==xe&&!isNaN(Se)&&!isNaN(xe))for(var pe=0;pe<d.h;pe++){var ge=ce(pe),Te=ce(pe+1);Te===ge||isNaN(Te)||isNaN(ge)||!B(T,pe)||(J=u._scaler(B(T,pe)),te.fillStyle=J?ve+"("+fe(J).join(",")+")":"rgba(0,0,0,0)",te.fillRect(xe,ge,Se-xe,Te-ge))}}return K}})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(v,Q,$){"use strict";var g=v("@plotly/d3");Q.exports=function(t){g.select(t).selectAll(".im image").style("opacity",function(k){return k[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(v,Q,$){"use strict";var g=v("../../lib/extend").extendFlat,t=v("../../lib/extend").extendDeep,k=v("../../plot_api/edit_types").overrideAll,x=v("../../plots/font_attributes"),e=v("../../components/color/attributes"),r=v("../../plots/domain").attributes,i=v("../../plots/cartesian/layout_attributes"),c=v("../../plot_api/plot_template").templatedArray,n=v("../../constants/delta.js"),m=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,p=x({editType:"plot",colorEditType:"plot"}),s={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},f={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},l=c("step",t({},s,{range:f}));Q.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:r({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:g({},p,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:m("value")},font:g({},p,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:m("value")},increasing:{symbol:{valType:"string",dflt:n.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:n.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:n.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:n.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:g({},p,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:t({},s,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:k({range:f,visible:g({},i.visible,{dflt:!0}),tickmode:i.tickmode,nticks:i.nticks,tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:g({},i.ticks,{dflt:"outside"}),ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,ticklabelstep:i.ticklabelstep,showticklabels:i.showticklabels,tickfont:x({}),tickangle:i.tickangle,tickformat:i.tickformat,tickformatstops:i.tickformatstops,tickprefix:i.tickprefix,showtickprefix:i.showtickprefix,ticksuffix:i.ticksuffix,showticksuffix:i.showticksuffix,separatethousands:i.separatethousands,exponentformat:i.exponentformat,minexponent:i.minexponent,showexponent:i.showexponent,editType:"plot"},"plot"),steps:l,threshold:{line:{color:g({},s.line.color,{}),width:g({},s.line.width,{dflt:1}),editType:"plot"},thickness:g({},s.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(v,Q,$){"use strict";var g=v("../../plots/plots");$.name="indicator",$.plot=function(t,k,x,e){g.plotBasePlot($.name,t,k,x,e)},$.clean=function(t,k,x,e){g.cleanBasePlot($.name,t,k,x,e)}},{"../../plots/plots":628}],866:[function(v,Q,$){"use strict";Q.exports={calc:function(g,t){var k=[],x=t.value;"number"!=typeof t._lastValue&&(t._lastValue=t.value);var e=t._lastValue,r=e;return t._hasDelta&&"number"==typeof t.delta.reference&&(r=t.delta.reference),k[0]={y:x,lastY:e,delta:x-r,relativeDelta:(x-r)/r},k}}},{}],867:[function(v,Q,$){"use strict";Q.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../plots/domain").defaults,x=v("../../plot_api/plot_template"),e=v("../../plots/array_container_defaults"),r=v("./constants.js"),i=v("../../plots/cartesian/tick_value_defaults"),c=v("../../plots/cartesian/tick_mark_defaults"),n=v("../../plots/cartesian/tick_label_defaults"),m=v("../../plots/cartesian/prefix_suffix_defaults");function p(s,f){function l(o,d){return g.coerce(s,f,t.gauge.steps,o,d)}l("color"),l("line.color"),l("line.width"),l("range"),l("thickness")}Q.exports={supplyDefaults:function(s,f,l,o){function d(z,S){return g.coerce(s,f,t,z,S)}k(f,o,d),d("mode"),f._hasNumber=-1!==f.mode.indexOf("number"),f._hasDelta=-1!==f.mode.indexOf("delta"),f._hasGauge=-1!==f.mode.indexOf("gauge");var u=d("value");f._range=[0,"number"==typeof u?1.5*u:1];var a,y,h,_,b,w,T=new Array(2);function L(z,S){return g.coerce(h,_,t.gauge,z,S)}function M(z,S){return g.coerce(b,w,t.gauge.axis,z,S)}if(f._hasNumber&&(d("number.valueformat"),d("number.font.color",o.font.color),d("number.font.family",o.font.family),d("number.font.size"),void 0===f.number.font.size&&(f.number.font.size=r.defaultNumberFontSize,T[0]=!0),d("number.prefix"),d("number.suffix"),a=f.number.font.size),f._hasDelta&&(d("delta.font.color",o.font.color),d("delta.font.family",o.font.family),d("delta.font.size"),void 0===f.delta.font.size&&(f.delta.font.size=(f._hasNumber?.5:1)*(a||r.defaultNumberFontSize),T[1]=!0),d("delta.reference",f.value),d("delta.relative"),d("delta.valueformat",f.delta.relative?"2%":""),d("delta.increasing.symbol"),d("delta.increasing.color"),d("delta.decreasing.symbol"),d("delta.decreasing.color"),d("delta.position"),d("delta.prefix"),d("delta.suffix"),y=f.delta.font.size),f._scaleNumbers=(!f._hasNumber||T[0])&&(!f._hasDelta||T[1])||!1,d("title.font.color",o.font.color),d("title.font.family",o.font.family),d("title.font.size",.25*(a||y||r.defaultNumberFontSize)),d("title.text"),f._hasGauge){(h=s.gauge)||(h={}),_=x.newContainer(f,"gauge"),L("shape"),(f._isBullet="bullet"===f.gauge.shape)||d("title.align","center"),(f._isAngular="angular"===f.gauge.shape)||d("align","center"),L("bgcolor",o.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width"),L("bar.thickness",r.valueThickness*("bullet"===f.gauge.shape?.5:1)),e(h,_,{name:"steps",handleItemDefaults:p}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),b={},h&&(b=h.axis||{}),w=x.newContainer(_,"axis"),M("visible"),f._range=M("range",f._range);var P={outerTicks:!0};i(b,w,M,"linear"),m(b,w,M,"linear",P),n(b,w,M,"linear",P),c(b,w,M,P)}else d("title.align","center"),d("align","center"),f._isAngular=f._isBullet=!1;f._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"indicator",basePlotModule:v("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,calc:v("./calc").calc,plot:v("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-interpolate").interpolate,k=v("d3-interpolate").interpolateNumber,x=v("../../lib"),e=x.strScale,r=x.strTranslate,i=x.rad2deg,c=v("../../constants/alignment").MID_SHIFT,n=v("../../components/drawing"),m=v("./constants"),p=v("../../lib/svg_text_utils"),s=v("../../plots/cartesian/axes"),f=v("../../plots/cartesian/axis_defaults"),l=v("../../plots/cartesian/position_defaults"),o=v("../../plots/cartesian/layout_attributes"),d=v("../../components/color"),u={left:"start",center:"middle",right:"end"},a={left:0,center:.5,right:1},y=/[yzafpn\xb5mkMGTPEZY]/;function h(M){return M&&M.duration>0}function _(M){M.each(function(P){d.stroke(g.select(this),P.line.color)}).each(function(P){d.fill(g.select(this),P.color)}).style("stroke-width",function(P){return P.line.width})}function b(M,P,z){var S=M._fullLayout,C=x.extendFlat({type:"linear",ticks:"outside",range:z,showline:!0},P),R={type:"linear",_id:"x"+P._id},D={letter:"x",font:S.font,noHover:!0,noTickson:!0};function j(q,Z){return x.coerce(C,R,o,q,Z)}return f(C,R,j,D,S),l(C,R,j,D),R}function w(M,P,z){return[Math.min(P/M.width,z/M.height),M,P+"x"+z]}function T(M,P,z,S){var C=document.createElementNS("http://www.w3.org/2000/svg","text"),R=g.select(C);return R.text(M).attr("x",0).attr("y",0).attr("text-anchor",z).attr("data-unformatted",M).call(p.convertToTspans,S).call(n.font,P),n.bBox(R.node())}function L(M,P,z,S,C,R){var D="_cache"+P;M[D]&&M[D].key===C||(M[D]={key:C,value:z});var j=x.aggNums(R,null,[M[D].value,S],2);return M[D].value=j,j}Q.exports=function(M,P,z,S){var C,R=M._fullLayout;h(z)&&S&&(C=S()),x.makeTraceGroups(R._indicatorlayer,P,"trace").each(function(D){var j,q,Z,W,G,X=D[0].trace,ne=g.select(this),V=X._hasGauge,N=X._isAngular,U=X._isBullet,ee=X.domain,B={w:R._size.w*(ee.x[1]-ee.x[0]),h:R._size.h*(ee.y[1]-ee.y[0]),l:R._size.l+R._size.w*ee.x[0],r:R._size.r+R._size.w*(1-ee.x[1]),t:R._size.t+R._size.h*(1-ee.y[1]),b:R._size.b+R._size.h*ee.y[0]},K=B.l+B.w/2,J=B.t+B.h/2,te=Math.min(B.w/2,B.h),ae=m.innerRadius*te,ce=X.align||"center";if(q=J,V){if(N&&(j=K,q=J+te/2,Z=function(Te){return se=Te,[(de=.9*ae)/Math.sqrt(se.width/2*(se.width/2)+se.height*se.height),se,de];var se,de}),U){var oe=m.bulletPadding,ve=1-m.bulletNumberDomainSize+oe;j=B.l+(ve+(1-ve)*a[ce])*B.w,Z=function(Te){return w(Te,(m.bulletNumberDomainSize-oe)*B.w,B.h)}}}else j=B.l+a[ce]*B.w,Z=function(Te){return w(Te,B.w,B.h)};(function(Te,se,de,Ae){var Le,Me,De,Oe=de[0].trace,Ie=Ae.numbersX,Qe=Ae.numbersY,Ne=Oe.align||"center",Pe=u[Ne],Re=Ae.transitionOpts,Ge=Ae.onComplete,tt=x.ensureSingle(se,"g","numbers"),ct=[];Oe._hasNumber&&ct.push("number"),Oe._hasDelta&&(ct.push("delta"),"left"===Oe.delta.position&&ct.reverse());var wt=tt.selectAll("text").data(ct);function kt(Jt,cn,Rt,je){if(!Jt.match("s")||Rt>=0==je>=0||cn(Rt).slice(-1).match(y)||cn(je).slice(-1).match(y))return cn;var Ye=Jt.slice().replace("s","f").replace(/\d+/,function(be){return parseInt(be)-1}),he=b(Te,{tickformat:Ye});return function(be){return Math.abs(be)<1?s.tickText(he,be).text:cn(be)}}wt.enter().append("text"),wt.attr("text-anchor",function(){return Pe}).attr("class",function(Jt){return Jt}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),wt.exit().remove();var gt,at=Oe.mode+Oe.align;if(Oe._hasDelta&&(gt=function(){var Jt=b(Te,{tickformat:Oe.delta.valueformat},Oe._range);Jt.setScale(),s.prepTicks(Jt);var cn=function(Ke){return s.tickText(Jt,Ke).text},Rt=Oe.delta.suffix,je=Oe.delta.prefix,Ye=function(Ke){return Oe.delta.relative?Ke.relativeDelta:Ke.delta},he=function(Ke,Ze){return 0===Ke||"number"!=typeof Ke||isNaN(Ke)?"-":(Ke>0?Oe.delta.increasing.symbol:Oe.delta.decreasing.symbol)+je+Ze(Ke)+Rt},be=function(Ke){return Ke.delta>=0?Oe.delta.increasing.color:Oe.delta.decreasing.color};void 0===Oe._deltaLastValue&&(Oe._deltaLastValue=Ye(de[0]));var Fe=tt.select("text.delta");function He(){Fe.text(he(Ye(de[0]),cn)).call(d.fill,be(de[0])).call(p.convertToTspans,Te)}return Fe.call(n.font,Oe.delta.font).call(d.fill,be({delta:Oe._deltaLastValue})),h(Re)?Fe.transition().duration(Re.duration).ease(Re.easing).tween("text",function(){var Ke=g.select(this),Ze=Ye(de[0]),ut=Oe._deltaLastValue,lt=kt(Oe.delta.valueformat,cn,ut,Ze),Lt=k(ut,Ze);return Oe._deltaLastValue=Ze,function(Ot){Ke.text(he(Lt(Ot),lt)),Ke.call(d.fill,be({delta:Lt(Ot)}))}}).each("end",function(){He(),Ge&&Ge()}).each("interrupt",function(){He(),Ge&&Ge()}):He(),Me=T(he(Ye(de[0]),cn),Oe.delta.font,Pe,Te),Fe}(),at+=Oe.delta.position+Oe.delta.font.size+Oe.delta.font.family+Oe.delta.valueformat,at+=Oe.delta.increasing.symbol+Oe.delta.decreasing.symbol,De=Me),Oe._hasNumber&&(function(){var Jt=b(Te,{tickformat:Oe.number.valueformat},Oe._range);Jt.setScale(),s.prepTicks(Jt);var cn=function(be){return s.tickText(Jt,be).text},Rt=Oe.number.suffix,je=Oe.number.prefix,Ye=tt.select("text.number");function he(){var be="number"==typeof de[0].y?je+cn(de[0].y)+Rt:"-";Ye.text(be).call(n.font,Oe.number.font).call(p.convertToTspans,Te)}h(Re)?Ye.transition().duration(Re.duration).ease(Re.easing).each("end",function(){he(),Ge&&Ge()}).each("interrupt",function(){he(),Ge&&Ge()}).attrTween("text",function(){var be=g.select(this),Fe=k(de[0].lastY,de[0].y);Oe._lastValue=de[0].y;var He=kt(Oe.number.valueformat,cn,de[0].lastY,de[0].y);return function(Ke){be.text(je+He(Fe(Ke))+Rt)}}):he(),Le=T(je+cn(de[0].y)+Rt,Oe.number.font,Pe,Te)}(),at+=Oe.number.font.size+Oe.number.font.family+Oe.number.valueformat+Oe.number.suffix+Oe.number.prefix,De=Le),Oe._hasDelta&&Oe._hasNumber){var et,yt,Vt=[(Le.left+Le.right)/2,(Le.top+Le.bottom)/2],Gt=[(Me.left+Me.right)/2,(Me.top+Me.bottom)/2],en=.75*Oe.delta.font.size;"left"===Oe.delta.position&&(et=L(Oe,"deltaPos",0,-1*(Le.width*a[Oe.align]+Me.width*(1-a[Oe.align])+en),at,Math.min),yt=Vt[1]-Gt[1],De={width:Le.width+Me.width+en,height:Math.max(Le.height,Me.height),left:Me.left+et,right:Le.right,top:Math.min(Le.top,Me.top+yt),bottom:Math.max(Le.bottom,Me.bottom+yt)}),"right"===Oe.delta.position&&(et=L(Oe,"deltaPos",0,Le.width*(1-a[Oe.align])+Me.width*a[Oe.align]+en,at,Math.max),yt=Vt[1]-Gt[1],De={width:Le.width+Me.width+en,height:Math.max(Le.height,Me.height),left:Le.left,right:Me.right+et,top:Math.min(Le.top,Me.top+yt),bottom:Math.max(Le.bottom,Me.bottom+yt)}),"bottom"===Oe.delta.position&&(et=null,yt=Me.height,De={width:Math.max(Le.width,Me.width),height:Le.height+Me.height,left:Math.min(Le.left,Me.left),right:Math.max(Le.right,Me.right),top:Le.bottom-Le.height,bottom:Le.bottom+Me.height}),"top"===Oe.delta.position&&(et=null,yt=Le.top,De={width:Math.max(Le.width,Me.width),height:Le.height+Me.height,left:Math.min(Le.left,Me.left),right:Math.max(Le.right,Me.right),top:Le.bottom-Le.height-Me.height,bottom:Le.bottom}),gt.attr({dx:et,dy:yt})}(Oe._hasNumber||Oe._hasDelta)&&tt.attr("transform",function(){var cn,Jt=Ae.numbersScaler(De),Rt=L(Oe,"numbersScale",1,Jt[0],at+=Jt[2],Math.min);Oe._scaleNumbers||(Rt=1),Oe._numbersTop=Rt*De.top+(cn=Oe._isAngular?Qe-Rt*De.bottom:Qe-Rt*(De.top+De.bottom)/2);var je=De[Ne];"center"===Ne&&(je=(De.left+De.right)/2);var Ye=Ie-Rt*je;return Ye=L(Oe,"numbersTranslate",0,Ye,at,Math.max),r(Ye,cn)+e(Rt)})})(M,ne,D,{numbersX:j,numbersY:q,numbersScaler:Z,transitionOpts:z,onComplete:C}),V&&(W={range:X.gauge.axis.range,color:X.gauge.bgcolor,line:{color:X.gauge.bordercolor,width:0},thickness:1},G={range:X.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:X.gauge.bordercolor,width:X.gauge.borderwidth},thickness:1});var fe=ne.selectAll("g.angular").data(N?D:[]);fe.exit().remove();var xe=ne.selectAll("g.angularaxis").data(N?D:[]);xe.exit().remove(),N&&function(Te,se,de,Ae){var Le,Me,De,Oe,Ie=de[0].trace,Qe=Ae.size,Ne=Ae.radius,Pe=Ae.innerRadius,Re=Ae.gaugeBg,Ge=Ae.gaugeOutline,tt=[Qe.l+Qe.w/2,Qe.t+Qe.h/2+Ne/2],ct=Ae.gauge,wt=Ae.layer,kt=Ae.transitionOpts,gt=Ae.onComplete,at=Math.PI/2;function et(Ot){var ot=Ie.gauge.axis.range[0],pt=(Ot-ot)/(Ie.gauge.axis.range[1]-ot)*Math.PI-at;return pt<-at?-at:pt>at?at:pt}function yt(Ot){return g.svg.arc().innerRadius((Pe+Ne)/2-Ot/2*(Ne-Pe)).outerRadius((Pe+Ne)/2+Ot/2*(Ne-Pe)).startAngle(-at)}function Vt(Ot){Ot.attr("d",function(ot){return yt(ot.thickness).startAngle(et(ot.range[0])).endAngle(et(ot.range[1]))()})}ct.enter().append("g").classed("angular",!0),ct.attr("transform",r(tt[0],tt[1])),wt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),wt.selectAll("g.xangularaxistick,path,text").remove(),(Le=b(Te,Ie.gauge.axis)).type="linear",Le.range=Ie.gauge.axis.range,Le._id="xangularaxis",Le.ticklabeloverflow="allow",Le.setScale();var Gt=function(Ot){return(Le.range[0]-Ot.x)/(Le.range[1]-Le.range[0])*Math.PI+Math.PI},en={},Jt=s.makeLabelFns(Le,0).labelStandoff;en.xFn=function(Ot){var ot=Gt(Ot);return Math.cos(ot)*Jt},en.yFn=function(Ot){var ot=Gt(Ot),pt=Math.sin(ot)>0?.2:1;return-Math.sin(ot)*(Jt+Ot.fontSize*pt)+Math.abs(Math.cos(ot))*(Ot.fontSize*c)},en.anchorFn=function(Ot){var ot=Gt(Ot),pt=Math.cos(ot);return Math.abs(pt)<.1?"middle":pt>0?"start":"end"},en.heightFn=function(Ot,ot,pt){var qt=Gt(Ot);return-.5*(1+Math.sin(qt))*pt};var cn=function(Ot){return r(tt[0]+Ne*Math.cos(Ot),tt[1]-Ne*Math.sin(Ot))};De=function(Ot){return cn(Gt(Ot))},Me=s.calcTicks(Le),Oe=s.getTickSigns(Le)[2],Le.visible&&(s.drawTicks(Te,Le,{vals:Me,layer:wt,path:"M"+(Oe="inside"===Le.ticks?-1:1)*((Le.linewidth||1)/2)+",0h"+Oe*Le.ticklen,transFn:function(Ot){var ot=Gt(Ot);return cn(ot)+"rotate("+-i(ot)+")"}}),s.drawLabels(Te,Le,{vals:Me,layer:wt,transFn:De,labelFns:en}));var je=[Re].concat(Ie.gauge.steps),Ye=ct.selectAll("g.bg-arc").data(je);Ye.enter().append("g").classed("bg-arc",!0).append("path"),Ye.select("path").call(Vt).call(_),Ye.exit().remove();var he=yt(Ie.gauge.bar.thickness),be=ct.selectAll("g.value-arc").data([Ie.gauge.bar]);be.enter().append("g").classed("value-arc",!0).append("path");var He,Ke,Ze,Fe=be.select("path");h(kt)?(Fe.transition().duration(kt.duration).ease(kt.easing).each("end",function(){gt&&gt()}).each("interrupt",function(){gt&&gt()}).attrTween("d",(He=he,Ke=et(de[0].lastY),Ze=et(de[0].y),function(){var Ot=t(Ke,Ze);return function(ot){return He.endAngle(Ot(ot))()}})),Ie._lastValue=de[0].y):Fe.attr("d","number"==typeof de[0].y?he.endAngle(et(de[0].y)):"M0,0Z"),Fe.call(_),be.exit().remove(),je=[];var ut=Ie.gauge.threshold.value;(ut||0===ut)&&je.push({range:[ut,ut],color:Ie.gauge.threshold.color,line:{color:Ie.gauge.threshold.line.color,width:Ie.gauge.threshold.line.width},thickness:Ie.gauge.threshold.thickness});var lt=ct.selectAll("g.threshold-arc").data(je);lt.enter().append("g").classed("threshold-arc",!0).append("path"),lt.select("path").call(Vt).call(_),lt.exit().remove();var Lt=ct.selectAll("g.gauge-outline").data([Ge]);Lt.enter().append("g").classed("gauge-outline",!0).append("path"),Lt.select("path").call(Vt).call(_),Lt.exit().remove()}(M,0,D,{radius:te,innerRadius:ae,gauge:fe,layer:xe,size:B,gaugeBg:W,gaugeOutline:G,transitionOpts:z,onComplete:C});var Se=ne.selectAll("g.bullet").data(U?D:[]);Se.exit().remove();var pe=ne.selectAll("g.bulletaxis").data(U?D:[]);pe.exit().remove(),U&&function(Te,se,de,Ae){var Le,Me,De,Oe,Ie,Qe=de[0].trace,Ne=Ae.gauge,Pe=Ae.layer,Re=Ae.gaugeBg,Ge=Ae.gaugeOutline,tt=Ae.size,ct=Qe.domain,wt=Ae.transitionOpts,kt=Ae.onComplete;Ne.enter().append("g").classed("bullet",!0),Ne.attr("transform",r(tt.l,tt.t)),Pe.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Pe.selectAll("g.xbulletaxistick,path,text").remove();var gt=tt.h,at=Qe.gauge.bar.thickness*gt,et=ct.x[0],yt=ct.x[0]+(ct.x[1]-ct.x[0])*(Qe._hasNumber||Qe._hasDelta?1-m.bulletNumberDomainSize:1);function Vt(Ye){Ye.attr("width",function(he){return Math.max(0,Le.c2p(he.range[1])-Le.c2p(he.range[0]))}).attr("x",function(he){return Le.c2p(he.range[0])}).attr("y",function(he){return.5*(1-he.thickness)*gt}).attr("height",function(he){return he.thickness*gt})}(Le=b(Te,Qe.gauge.axis))._id="xbulletaxis",Le.domain=[et,yt],Le.setScale(),Me=s.calcTicks(Le),De=s.makeTransTickFn(Le),Oe=s.getTickSigns(Le)[2],Ie=tt.t+tt.h,Le.visible&&(s.drawTicks(Te,Le,{vals:"inside"===Le.ticks?s.clipEnds(Le,Me):Me,layer:Pe,path:s.makeTickPath(Le,Ie,Oe),transFn:De}),s.drawLabels(Te,Le,{vals:Me,layer:Pe,transFn:De,labelFns:s.makeLabelFns(Le,Ie)}));var Gt=[Re].concat(Qe.gauge.steps),en=Ne.selectAll("g.bg-bullet").data(Gt);en.enter().append("g").classed("bg-bullet",!0).append("rect"),en.select("rect").call(Vt).call(_),en.exit().remove();var Jt=Ne.selectAll("g.value-bullet").data([Qe.gauge.bar]);Jt.enter().append("g").classed("value-bullet",!0).append("rect"),Jt.select("rect").attr("height",at).attr("y",(gt-at)/2).call(_),h(wt)?Jt.select("rect").transition().duration(wt.duration).ease(wt.easing).each("end",function(){kt&&kt()}).each("interrupt",function(){kt&&kt()}).attr("width",Math.max(0,Le.c2p(Math.min(Qe.gauge.axis.range[1],de[0].y)))):Jt.select("rect").attr("width","number"==typeof de[0].y?Math.max(0,Le.c2p(Math.min(Qe.gauge.axis.range[1],de[0].y))):0),Jt.exit().remove();var cn=de.filter(function(){return Qe.gauge.threshold.value||0===Qe.gauge.threshold.value}),Rt=Ne.selectAll("g.threshold-bullet").data(cn);Rt.enter().append("g").classed("threshold-bullet",!0).append("line"),Rt.select("line").attr("x1",Le.c2p(Qe.gauge.threshold.value)).attr("x2",Le.c2p(Qe.gauge.threshold.value)).attr("y1",(1-Qe.gauge.threshold.thickness)/2*gt).attr("y2",(1-(1-Qe.gauge.threshold.thickness)/2)*gt).call(d.stroke,Qe.gauge.threshold.line.color).style("stroke-width",Qe.gauge.threshold.line.width),Rt.exit().remove();var je=Ne.selectAll("g.gauge-outline").data([Ge]);je.enter().append("g").classed("gauge-outline",!0).append("rect"),je.select("rect").call(Vt).call(_),je.exit().remove()}(M,0,D,{gauge:Se,layer:pe,size:B,gaugeBg:W,gaugeOutline:G,transitionOpts:z,onComplete:C});var ge=ne.selectAll("text.title").data(D);ge.exit().remove(),ge.enter().append("text").classed("title",!0),ge.attr("text-anchor",function(){return U?u.right:u[X.title.align]}).text(X.title.text).call(n.font,X.title.font).call(p.convertToTspans,M),ge.attr("transform",function(){var Te,se=B.l+B.w*a[X.title.align],de=m.titlePadding,Ae=n.bBox(ge.node());return V?(N&&(Te=X.gauge.axis.visible?n.bBox(xe.node()).top-de-Ae.bottom:B.t+B.h/2-te/2-Ae.bottom-de),U&&(Te=q-(Ae.top+Ae.bottom)/2,se=B.l-m.bulletPadding*B.w)):Te=X._numbersTop-de-Ae.bottom,r(se,Te)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../mesh3d/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,i=v("../../plot_api/edit_types").overrideAll,c=Q.exports=i(r({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:k(),xhoverformat:t("x"),yhoverformat:t("y"),zhoverformat:t("z"),valuehoverformat:t("value",1),showlegend:r({},e.showlegend,{dflt:!1})},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:x.opacity,lightposition:x.lightposition,lighting:x.lighting,flatshading:x.flatshading,contour:x.contour,hoverinfo:r({},e.hoverinfo)}),"calc","nested");c.flatshading.dflt=!0,c.lighting.facenormalsepsilon.dflt=0,c.x.editType=c.y.editType=c.z.editType=c.value.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/calc"),t=v("../streamtube/calc").processGrid,k=v("../streamtube/calc").filter;Q.exports=function(x,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=k(e.x,e._len),e._y=k(e.y,e._len),e._z=k(e.z,e._len),e._value=k(e.value,e._len);var r=t(e);e._gridFill=r.fill,e._Xs=r.Xs,e._Ys=r.Ys,e._Zs=r.Zs,e._len=r.len;for(var i=1/0,c=-1/0,n=0;n<e._len;n++){var m=e._value[n];i=Math.min(i,m),c=Math.max(c,m)}e._minValues=i,e._maxValues=c,e._vMin=null==e.isomin?i:e.isomin,e._vMax=void 0===e.isomax||null===e.isomin?c:e.isomax,g(x,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_mesh3d,t=v("../../lib/gl_format_color").parseColorScale,k=v("../../lib/str2rgbarray"),x=v("../../components/colorscale").extractOpts,e=v("../../plots/gl3d/zip3"),r=function(p,s){for(var f=s.length-1;f>0;f--){var l=Math.min(s[f],s[f-1]),o=Math.max(s[f],s[f-1]);if(o>l&&l<p&&p<=o)return{id:f,distRatio:(o-p)/(o-l)}}return{id:0,distRatio:0}};function i(p,s,f){this.scene=p,this.uid=f,this.mesh=s,this.name="",this.data=null,this.showContour=!1}var c=i.prototype;c.handlePick=function(p){if(p.object===this.mesh){var s=p.data.index,l=this.data._meshY[s],o=this.data._meshZ[s],d=this.data._Ys.length,u=this.data._Zs.length,a=r(this.data._meshX[s],this.data._Xs).id,y=r(l,this.data._Ys).id,h=r(o,this.data._Zs).id,_=p.index=h+u*y+u*d*a;p.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&void 0!==b[_]?p.textLabel=b[_]:b&&(p.textLabel=b),!0}},c.update=function(p){var s=this.scene,f=s.fullSceneLayout;function l(u,a,y,h){return a.map(function(_){return u.d2l(_,0,h)*y})}this.data=m(p);var o={positions:e(l(f.xaxis,p._meshX,s.dataScale[0],p.xcalendar),l(f.yaxis,p._meshY,s.dataScale[1],p.ycalendar),l(f.zaxis,p._meshZ,s.dataScale[2],p.zcalendar)),cells:e(p._meshI,p._meshJ,p._meshK),lightPosition:[p.lightposition.x,p.lightposition.y,p.lightposition.z],ambient:p.lighting.ambient,diffuse:p.lighting.diffuse,specular:p.lighting.specular,roughness:p.lighting.roughness,fresnel:p.lighting.fresnel,vertexNormalsEpsilon:p.lighting.vertexnormalsepsilon,faceNormalsEpsilon:p.lighting.facenormalsepsilon,opacity:p.opacity,contourEnable:p.contour.show,contourColor:k(p.contour.color).slice(0,3),contourWidth:p.contour.width,useFacetNormals:p.flatshading},d=x(p);o.vertexIntensity=p._meshIntensity,o.vertexIntensityBounds=[d.min,d.max],o.colormap=t(p),this.mesh.update(o)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var n=["xyz","xzy","yxz","yzx","zxy","zyx"];function m(p){p._meshI=[],p._meshJ=[],p._meshK=[];var s,f,l,o,d,u,a,y=p.surface.show,h=p.spaceframe.show,_=p.surface.fill,b=p.spaceframe.fill,w=!1,T=!1,L=0,M=p._Xs,P=p._Ys,z=p._Zs,S=M.length,C=P.length,R=z.length,D=n.indexOf(p._gridFill.replace(/-/g,"").replace(/\+/g,"")),j=function(Ne,Pe,Re){switch(D){case 5:return Re+R*Pe+R*C*Ne;case 4:return Re+R*Ne+R*S*Pe;case 3:return Pe+C*Re+C*R*Ne;case 2:return Pe+C*Ne+C*S*Re;case 1:return Ne+S*Re+S*R*Pe;default:return Ne+S*Pe+S*C*Re}},q=p._minValues,Z=p._maxValues,W=p._vMin,G=p._vMax;function X(Ne,Pe,Re){for(var Ge=u.length,tt=f;tt<Ge;tt++)if(Ne===l[tt]&&Pe===o[tt]&&Re===d[tt])return tt;return-1}function ne(){f=s}function V(){l=[],o=[],d=[],u=[],s=0,ne()}function N(Ne,Pe,Re,Ge){return l.push(Ne),o.push(Pe),d.push(Re),u.push(Ge),++s-1}function U(Ne,Pe,Re){for(var Ge=[],tt=0;tt<Ne.length;tt++)Ge[tt]=Ne[tt]*(1-Re)+Re*Pe[tt];return Ge}function ee(Ne){a=Ne}function B(Ne,Pe){return"all"===Ne||null===Ne||Ne.indexOf(Pe)>-1}function K(Ne,Pe){return null===Ne?Pe:Ne}function J(Ne,Pe,Re){ne();var tt,ct,Rt,je,Ye,he,be,Fe,He,Ke,Ze,ut,lt,Lt,Ot,wt=[Pe],kt=[Re];if(a>=1)wt=[Pe],kt=[Re];else if(a>0){var gt=(je=Re,Ke=U(Fe=function(ot,pt,qt){for(var St=[],Mt=0;Mt<ot.length;Mt++)St[Mt]=(ot[Mt]+pt[Mt]+qt[Mt])/3;return St}(Ye=(Rt=Pe)[0],he=Rt[1],be=Rt[2]),Ye,He=Math.sqrt(1-a)),{xyzv:[[Ye,he,Ze=U(Fe,he,He)],[Ze,Ke,Ye],[he,be,ut=U(Fe,be,He)],[ut,Ze,he],[be,Ye,Ke],[Ke,ut,be]],abc:[[lt=je[0],Lt=je[1],-1],[-1,-1,lt],[Lt,Ot=je[2],-1],[-1,-1,Lt],[Ot,lt,-1],[-1,-1,Ot]]});wt=gt.xyzv,kt=gt.abc}for(var at=0;at<wt.length;at++){Pe=wt[at],Re=kt[at];for(var et=[],yt=0;yt<3;yt++){var Vt=Pe[yt][0],Gt=Pe[yt][1],en=Pe[yt][2],Jt=Pe[yt][3],cn=Re[yt]>-1?Re[yt]:X(Vt,Gt,en);et[yt]=cn>-1?cn:N(Vt,Gt,en,K(Ne,Jt))}tt=et[1],ct=et[2],p._meshI.push(et[0]),p._meshJ.push(tt),p._meshK.push(ct),++L}}function te(Ne,Pe,Re,Ge){var tt=Ne[3];tt<Re&&(tt=Re),tt>Ge&&(tt=Ge);for(var ct=(Ne[3]-tt)/(Ne[3]-Pe[3]+1e-9),wt=[],kt=0;kt<4;kt++)wt[kt]=(1-ct)*Ne[kt]+ct*Pe[kt];return wt}function ae(Ne,Pe,Re){return Ne>=Pe&&Ne<=Re}function ce(Ne){var Pe=.001*(G-W);return Ne>=W-Pe&&Ne<=G+Pe}function oe(Ne){for(var Pe=[],Re=0;Re<4;Re++){var Ge=Ne[Re];Pe.push([p._x[Ge],p._y[Ge],p._z[Ge],p._value[Ge]])}return Pe}function ve(Ne,Pe,Re,Ge,tt,ct){ct||(ct=1),Re=[-1,-1,-1];var wt=!1,kt=[ae(Pe[0][3],Ge,tt),ae(Pe[1][3],Ge,tt),ae(Pe[2][3],Ge,tt)];if(!kt[0]&&!kt[1]&&!kt[2])return!1;var gt=function(et,yt,Vt){return ce(yt[0][3])&&ce(yt[1][3])&&ce(yt[2][3])?(J(et,yt,Vt),!0):ct<3&&ve(et,yt,Vt,W,G,++ct)};if(kt[0]&&kt[1]&&kt[2])return gt(Ne,Pe,Re)||wt;var at=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(et){if(kt[et[0]]&&kt[et[1]]&&!kt[et[2]]){var yt=Pe[et[0]],Vt=Pe[et[1]],Gt=Pe[et[2]],en=te(Gt,yt,Ge,tt),Jt=te(Gt,Vt,Ge,tt);wt=gt(Ne,[Jt,en,yt],[-1,-1,Re[et[0]]])||wt,wt=gt(Ne,[yt,Vt,Jt],[Re[et[0]],Re[et[1]],-1])||wt,at=!0}}),at||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(et){if(kt[et[0]]&&!kt[et[1]]&&!kt[et[2]]){var yt=Pe[et[0]],Gt=Pe[et[2]],en=te(Pe[et[1]],yt,Ge,tt),Jt=te(Gt,yt,Ge,tt);wt=gt(Ne,[Jt,en,yt],[-1,-1,Re[et[0]]])||wt,at=!0}}),wt}function fe(Ne,Pe,Re,Ge){var gt,at,et,yt,tt=!1,ct=oe(Pe),wt=[ae(ct[0][3],Re,Ge),ae(ct[1][3],Re,Ge),ae(ct[2][3],Re,Ge),ae(ct[3][3],Re,Ge)];if(!(wt[0]||wt[1]||wt[2]||wt[3]))return tt;if(wt[0]&&wt[1]&&wt[2]&&wt[3])return T&&(gt=Ne,at=ct,et=Pe,(yt=function(Vt,Gt,en){J(gt,[at[Vt],at[Gt],at[en]],[et[Vt],et[Gt],et[en]])})(0,1,2),yt(3,0,1),yt(2,3,0),tt=void yt(1,2,3)||tt),tt;var kt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(gt){if(wt[gt[0]]&&wt[gt[1]]&&wt[gt[2]]&&!wt[gt[3]]){var at=ct[gt[0]],et=ct[gt[1]],yt=ct[gt[2]],Vt=ct[gt[3]];if(T)tt=J(Ne,[at,et,yt],[Pe[gt[0]],Pe[gt[1]],Pe[gt[2]]])||tt;else{var Gt=te(Vt,at,Re,Ge),en=te(Vt,et,Re,Ge),Jt=te(Vt,yt,Re,Ge);tt=J(null,[Gt,en,Jt],[-1,-1,-1])||tt}kt=!0}}),kt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(gt){if(wt[gt[0]]&&wt[gt[1]]&&!wt[gt[2]]&&!wt[gt[3]]){var at=ct[gt[0]],et=ct[gt[1]],yt=ct[gt[2]],Vt=ct[gt[3]],Gt=te(yt,at,Re,Ge),en=te(yt,et,Re,Ge),Jt=te(Vt,et,Re,Ge),cn=te(Vt,at,Re,Ge);T?(tt=J(Ne,[at,cn,Gt],[Pe[gt[0]],-1,-1])||tt,tt=J(Ne,[et,en,Jt],[Pe[gt[1]],-1,-1])||tt):(null,je=[Gt,en,Jt,cn],Ye=[-1,-1,-1,-1],(he=function(be,Fe,He){J(null,[je[be],je[Fe],je[He]],[Ye[be],Ye[Fe],Ye[He]])})(0,1,2),tt=void he(2,3,0)||tt),kt=!0}var je,Ye,he}),kt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(gt){if(wt[gt[0]]&&!wt[gt[1]]&&!wt[gt[2]]&&!wt[gt[3]]){var at=ct[gt[0]],yt=ct[gt[2]],Vt=ct[gt[3]],Gt=te(ct[gt[1]],at,Re,Ge),en=te(yt,at,Re,Ge),Jt=te(Vt,at,Re,Ge);T?(tt=J(Ne,[at,Gt,en],[Pe[gt[0]],-1,-1])||tt,tt=J(Ne,[at,en,Jt],[Pe[gt[0]],-1,-1])||tt,tt=J(Ne,[at,Jt,Gt],[Pe[gt[0]],-1,-1])||tt):tt=J(null,[Gt,en,Jt],[-1,-1,-1])||tt,kt=!0}})),tt}function xe(Ne,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et){var yt=!1;return w&&(B(Ne,"A")&&(yt=fe(null,[Pe,Re,Ge,ct],at,et)||yt),B(Ne,"B")&&(yt=fe(null,[Re,Ge,tt,gt],at,et)||yt),B(Ne,"C")&&(yt=fe(null,[Re,ct,wt,gt],at,et)||yt),B(Ne,"D")&&(yt=fe(null,[Ge,ct,kt,gt],at,et)||yt),B(Ne,"E")&&(yt=fe(null,[Re,Ge,ct,gt],at,et)||yt)),T&&(yt=fe(Ne,[Re,Ge,ct,gt],at,et)||yt),yt}function Se(Ne,Pe,Re,Ge,tt,ct,wt,kt){return[!0===kt[0]||ve(Ne,oe([Pe,Re,Ge]),[Pe,Re,Ge],ct,wt),!0===kt[1]||ve(Ne,oe([Ge,tt,Pe]),[Ge,tt,Pe],ct,wt)]}function pe(Ne,Pe,Re,Ge,tt,ct,wt,kt,gt){return kt?Se(Ne,Pe,Re,tt,Ge,ct,wt,gt):Se(Ne,Re,tt,Ge,Pe,ct,wt,gt)}function ge(Ne,Pe,Re,Ge,tt,ct,wt){var kt,gt,at,et,yt=!1,Vt=function(){yt=ve(Ne,[kt,gt,at],[-1,-1,-1],tt,ct)||yt,yt=ve(Ne,[at,et,kt],[-1,-1,-1],tt,ct)||yt},Gt=wt[0],en=wt[1],Jt=wt[2];return Gt&&(kt=U(oe([j(Pe,Re-0,Ge-0)])[0],oe([j(Pe-1,Re-0,Ge-0)])[0],Gt),gt=U(oe([j(Pe,Re-0,Ge-1)])[0],oe([j(Pe-1,Re-0,Ge-1)])[0],Gt),at=U(oe([j(Pe,Re-1,Ge-1)])[0],oe([j(Pe-1,Re-1,Ge-1)])[0],Gt),et=U(oe([j(Pe,Re-1,Ge-0)])[0],oe([j(Pe-1,Re-1,Ge-0)])[0],Gt),Vt()),en&&(kt=U(oe([j(Pe-0,Re,Ge-0)])[0],oe([j(Pe-0,Re-1,Ge-0)])[0],en),gt=U(oe([j(Pe-0,Re,Ge-1)])[0],oe([j(Pe-0,Re-1,Ge-1)])[0],en),at=U(oe([j(Pe-1,Re,Ge-1)])[0],oe([j(Pe-1,Re-1,Ge-1)])[0],en),et=U(oe([j(Pe-1,Re,Ge-0)])[0],oe([j(Pe-1,Re-1,Ge-0)])[0],en),Vt()),Jt&&(kt=U(oe([j(Pe-0,Re-0,Ge)])[0],oe([j(Pe-0,Re-0,Ge-1)])[0],Jt),gt=U(oe([j(Pe-0,Re-1,Ge)])[0],oe([j(Pe-0,Re-1,Ge-1)])[0],Jt),at=U(oe([j(Pe-1,Re-1,Ge)])[0],oe([j(Pe-1,Re-1,Ge-1)])[0],Jt),et=U(oe([j(Pe-1,Re-0,Ge)])[0],oe([j(Pe-1,Re-0,Ge-1)])[0],Jt),Vt()),yt}function Te(Ne,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et,yt){var Vt=Ne;return yt?(w&&"even"===Ne&&(Vt=null),xe(Vt,Pe,Re,Ge,tt,ct,wt,kt,gt,at,et)):(w&&"odd"===Ne&&(Vt=null),xe(Vt,gt,kt,wt,ct,tt,Ge,Re,Pe,at,et))}function se(Ne,Pe,Re,Ge,tt){for(var ct=[],wt=0,kt=0;kt<Pe.length;kt++)for(var gt=Pe[kt],at=1;at<R;at++)for(var et=1;et<C;et++)ct.push(pe(Ne,j(gt,et-1,at-1),j(gt,et-1,at),j(gt,et,at-1),j(gt,et,at),Re,Ge,(gt+et+at)%2,tt&&tt[wt]?tt[wt]:[])),wt++;return ct}function de(Ne,Pe,Re,Ge,tt){for(var ct=[],wt=0,kt=0;kt<Pe.length;kt++)for(var gt=Pe[kt],at=1;at<S;at++)for(var et=1;et<R;et++)ct.push(pe(Ne,j(at-1,gt,et-1),j(at,gt,et-1),j(at-1,gt,et),j(at,gt,et),Re,Ge,(at+gt+et)%2,tt&&tt[wt]?tt[wt]:[])),wt++;return ct}function Ae(Ne,Pe,Re,Ge,tt){for(var ct=[],wt=0,kt=0;kt<Pe.length;kt++)for(var gt=Pe[kt],at=1;at<C;at++)for(var et=1;et<S;et++)ct.push(pe(Ne,j(et-1,at-1,gt),j(et-1,at,gt),j(et,at-1,gt),j(et,at,gt),Re,Ge,(et+at+gt)%2,tt&&tt[wt]?tt[wt]:[])),wt++;return ct}function Le(Ne,Pe,Re){for(var Ge=1;Ge<R;Ge++)for(var tt=1;tt<C;tt++)for(var ct=1;ct<S;ct++)Te(Ne,j(ct-1,tt-1,Ge-1),j(ct-1,tt-1,Ge),j(ct-1,tt,Ge-1),j(ct-1,tt,Ge),j(ct,tt-1,Ge-1),j(ct,tt-1,Ge),j(ct,tt,Ge-1),j(ct,tt,Ge),Pe,Re,(ct+tt+Ge)%2)}function Me(Ne,Pe,Re){w=!0,Le(Ne,Pe,Re),w=!1}function De(Ne,Pe,Re,Ge,tt,ct){for(var wt=[],gt=0;gt<Pe.length;gt++)for(var at=Pe[gt],et=1;et<R;et++)for(var yt=1;yt<C;yt++)wt.push(ge(Ne,at,yt,et,Re,Ge,tt[gt]));return wt}function Oe(Ne,Pe,Re,Ge,tt,ct){for(var wt=[],gt=0;gt<Pe.length;gt++)for(var at=Pe[gt],et=1;et<S;et++)for(var yt=1;yt<R;yt++)wt.push(ge(Ne,et,at,yt,Re,Ge,tt[gt]));return wt}function Ie(Ne,Pe,Re,Ge,tt,ct){for(var wt=[],gt=0;gt<Pe.length;gt++)for(var at=Pe[gt],et=1;et<C;et++)for(var yt=1;yt<S;yt++)wt.push(ge(Ne,yt,et,at,Re,Ge,tt[gt]));return wt}function Qe(Ne,Pe){for(var Re=[],Ge=Ne;Ge<Pe;Ge++)Re.push(Ge);return Re}return function(){if(V(),function(){for(var kt=0;kt<S;kt++)for(var gt=0;gt<C;gt++)for(var at=0;at<R;at++){var et=j(kt,gt,at);N(p._x[et],p._y[et],p._z[et],p._value[et])}}(),h&&b&&(ee(b),T=!0,Le(null,W,G),T=!1),y&&_){ee(_);for(var Ne=p.surface.pattern,Pe=p.surface.count,Re=0;Re<Pe;Re++){var Ge=1===Pe?.5:Re/(Pe-1),tt=(1-Ge)*W+Ge*G,ct=Math.abs(tt-q)>Math.abs(tt-Z)?[q,tt]:[tt,Z];Me(Ne,ct[0],ct[1])}}var wt=[[Math.min(W,Z),Math.max(W,Z)],[Math.min(q,G),Math.max(q,G)]];["x","y","z"].forEach(function(kt){for(var gt=[],at=0;at<wt.length;at++){var et=0,yt=wt[at][0],Vt=wt[at][1],Gt=p.slices[kt];if(Gt.show&&Gt.fill){ee(Gt.fill);var en=[],Jt=[],cn=[];if(Gt.locations.length)for(var Rt=0;Rt<Gt.locations.length;Rt++){var je=r(Gt.locations[Rt],"x"===kt?M:"y"===kt?P:z);0===je.distRatio?en.push(je.id):je.id>0&&(Jt.push(je.id),cn.push("x"===kt?[je.distRatio,0,0]:"y"===kt?[0,je.distRatio,0]:[0,0,je.distRatio]))}else en=Qe(1,"x"===kt?S-1:"y"===kt?C-1:R-1);Jt.length>0&&(gt[et]="x"===kt?De(null,Jt,yt,Vt,cn):"y"===kt?Oe(null,Jt,yt,Vt,cn):Ie(null,Jt,yt,Vt,cn),et++),en.length>0&&(gt[et]="x"===kt?se(null,en,yt,Vt,gt[et]):"y"===kt?de(null,en,yt,Vt,gt[et]):Ae(null,en,yt,Vt,gt[et]),et++)}var Ye=p.caps[kt];Ye.show&&Ye.fill&&(ee(Ye.fill),gt[et]="x"===kt?se(null,[0,S-1],yt,Vt,gt[et]):"y"===kt?de(null,[0,C-1],yt,Vt,gt[et]):Ae(null,[0,R-1],yt,Vt,gt[et]),et++)}}),0===L&&V(),p._meshX=l,p._meshY=o,p._meshZ=d,p._meshIntensity=u,p._Xs=M,p._Ys=P,p._Zs=z}(),p}Q.exports={findNearestOnAxis:r,generateIsoMeshes:m,createIsosurfaceTrace:function(p,s){var l=g({gl:p.glplot.gl}),o=new i(p,l,s.uid);return l._trace=o,o.update(s),p.glplot.add(l),o}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry"),k=v("./attributes"),x=v("../../components/colorscale/defaults");function e(r,i,c,n,m){var p=m("isomin"),s=m("isomax");null!=s&&null!=p&&p>s&&(i.isomin=null,i.isomax=null);var f=m("x"),l=m("y"),o=m("z"),d=m("value");f&&f.length&&l&&l.length&&o&&o.length&&d&&d.length?(t.getComponentMethod("calendars","handleTraceDefaults")(r,i,["x","y","z"],n),m("valuehoverformat"),["x","y","z"].forEach(function(u){m(u+"hoverformat");var a="caps."+u;m(a+".show")&&m(a+".fill");var y="slices."+u;m(y+".show")&&(m(y+".fill"),m(y+".locations"))}),m("spaceframe.show")&&m("spaceframe.fill"),m("surface.show")&&(m("surface.count"),m("surface.fill"),m("surface.pattern")),m("contour.show")&&(m("contour.color"),m("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(u){m(u)}),x(r,i,n,m,{prefix:"",cLetter:"c"}),i._length=null):i.visible=!1}Q.exports={supplyDefaults:function(r,i,c,n){e(r,i,0,n,function(m,p){return g.coerce(r,i,k,m,p)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,calc:v("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../surface/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat;Q.exports=r({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:k({editType:"calc"}),xhoverformat:t("x"),yhoverformat:t("y"),zhoverformat:t("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},g("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:x.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:r({},x.contours.x.show,{}),color:x.contours.x.color,width:x.contours.x.width,editType:"calc"},lightposition:{x:r({},x.lightposition.x,{dflt:1e5}),y:r({},x.lightposition.y,{dflt:1e5}),z:r({},x.lightposition.z,{dflt:0}),editType:"calc"},lighting:r({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},x.lighting),hoverinfo:r({},e.hoverinfo,{editType:"calc"}),showlegend:r({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/calc");Q.exports=function(t,k){k.intensity&&g(t,k,{vals:k.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_mesh3d,t=v("../../../stackgl_modules").delaunay_triangulate,k=v("../../../stackgl_modules").alpha_shape,x=v("../../../stackgl_modules").convex_hull,e=v("../../lib/gl_format_color").parseColorScale,r=v("../../lib/str2rgbarray"),i=v("../../components/colorscale").extractOpts,c=v("../../plots/gl3d/zip3");function n(o,d,u){this.scene=o,this.uid=u,this.mesh=d,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var m=n.prototype;function p(o){for(var d=[],u=o.length,a=0;a<u;a++)d[a]=r(o[a]);return d}function s(o,d,u,a){for(var y=[],h=d.length,_=0;_<h;_++)y[_]=o.d2l(d[_],0,a)*u;return y}function f(o){for(var d=[],u=o.length,a=0;a<u;a++)d[a]=Math.round(o[a]);return d}function l(o,d){for(var u=o.length,a=0;a<u;a++)if(o[a]<=-.5||o[a]>=d-.5)return!1;return!0}m.handlePick=function(o){if(o.object===this.mesh){var d=o.index=o.data.index;o.traceCoordinate=o.data._cellCenter?o.data.dataCoordinate:[this.data.x[d],this.data.y[d],this.data.z[d]];var u=this.data.hovertext||this.data.text;return Array.isArray(u)&&void 0!==u[d]?o.textLabel=u[d]:u&&(o.textLabel=u),!0}},m.update=function(o){var d=this.scene,u=d.fullSceneLayout;this.data=o;var a,y=o.x.length,h=c(s(u.xaxis,o.x,d.dataScale[0],o.xcalendar),s(u.yaxis,o.y,d.dataScale[1],o.ycalendar),s(u.zaxis,o.z,d.dataScale[2],o.zcalendar));if(o.i&&o.j&&o.k){if(o.i.length!==o.j.length||o.j.length!==o.k.length||!l(o.i,y)||!l(o.j,y)||!l(o.k,y))return;a=c(f(o.i),f(o.j),f(o.k))}else a=0===o.alphahull?x(h):o.alphahull>0?k(o.alphahull,h):function(T,L){for(var M=["x","y","z"].indexOf(T),P=[],z=L.length,S=0;S<z;S++)P[S]=[L[S][(M+1)%3],L[S][(M+2)%3]];return t(P)}(o.delaunayaxis,h);var _={positions:h,cells:a,lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,contourEnable:o.contour.show,contourColor:r(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading};if(o.intensity){var b=i(o);this.color="#fff";var w=o.intensitymode;_[w+"Intensity"]=o.intensity,_[w+"IntensityBounds"]=[b.min,b.max],_.colormap=e(o)}else o.vertexcolor?(this.color=o.vertexcolor[0],_.vertexColors=p(o.vertexcolor)):o.facecolor?(this.color=o.facecolor[0],_.cellColors=p(o.facecolor)):(this.color=o.color,_.meshColor=r(o.color));this.mesh.update(_)},m.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Q.exports=function(o,d){var a=g({gl:o.glplot.gl}),y=new n(o,a,d.uid);return a._trace=y,y.update(d),o.glplot.add(a),y}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../../components/colorscale/defaults"),x=v("./attributes");Q.exports=function(e,r,i,c){function n(p,s){return t.coerce(e,r,x,p,s)}function m(p){var s=p.map(function(f){var l=n(f);return l&&t.isArrayOrTypedArray(l)?l:null});return s.every(function(f){return f&&f.length===s[0].length})&&s}m(["x","y","z"])?(m(["i","j","k"]),(!r.i||r.j&&r.k)&&(!r.j||r.k&&r.i)&&(!r.k||r.i&&r.j)?(g.getComponentMethod("calendars","handleTraceDefaults")(e,r,["x","y","z"],c),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(p){n(p)}),n("contour.show")&&(n("contour.color"),n("contour.width")),"intensity"in e?(n("intensity"),n("intensitymode"),k(e,r,c,n,{prefix:"",cLetter:"c"})):(r.showscale=!1,"facecolor"in e?n("facecolor"):"vertexcolor"in e?n("vertexcolor"):n("color",i)),n("text"),n("hovertext"),n("hovertemplate"),n("xhoverformat"),n("yhoverformat"),n("zhoverformat"),r._length=null):r.visible=!1):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(v,Q,$){"use strict";var g=v("../../lib").extendFlat,t=v("../scatter/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../components/drawing/attributes").dash,e=v("../../components/fx/attributes"),r=v("../../constants/delta.js"),i=r.INCREASING.COLOR,c=r.DECREASING.COLOR,n=t.line;function m(p){return{line:{color:g({},n.color,{dflt:p}),width:n.width,dash:x,editType:"style"},editType:"style"}}Q.exports={xperiod:t.xperiod,xperiod0:t.xperiod0,xperiodalignment:t.xperiodalignment,xhoverformat:k("x"),yhoverformat:k("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:g({},n.width,{}),dash:g({},x,{}),editType:"style"},increasing:m(i),decreasing:m(c),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:g({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(v,Q,$){"use strict";var g=v("../../lib"),t=g._,k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/align_period"),e=v("../../constants/numerical").BADNUM;function r(c,n,m,p){return{o:c,h:n,l:m,c:p}}function i(c,n,m,p,s,f){for(var l=s.makeCalcdata(n,"open"),o=s.makeCalcdata(n,"high"),d=s.makeCalcdata(n,"low"),u=s.makeCalcdata(n,"close"),a=Array.isArray(n.text),y=Array.isArray(n.hovertext),h=!0,_=null,b=!!n.xperiodalignment,w=[],T=0;T<p.length;T++){var L=p[T],M=l[T],P=o[T],z=d[T],S=u[T];if(L!==e&&M!==e&&P!==e&&z!==e&&S!==e){S===M?null!==_&&S!==_&&(h=S>_):h=S>M,_=S;var C=f(M,P,z,S);C.pos=L,C.yc=(M+S)/2,C.i=T,C.dir=h?"increasing":"decreasing",C.x=C.pos,C.y=[z,P],b&&(C.orig_p=m[T]),a&&(C.tx=n.text[T]),y&&(C.htx=n.hovertext[T]),w.push(C)}else w.push({pos:L,empty:!0})}return n._extremes[s._id]=k.findExtremes(s,g.concat(d,o),{padded:!0}),w.length&&(w[0].t={labels:{open:t(c,"open:")+" ",high:t(c,"high:")+" ",low:t(c,"low:")+" ",close:t(c,"close:")+" "}}),w}Q.exports={calc:function(c,n){var m=k.getFromId(c,n.xaxis),p=k.getFromId(c,n.yaxis),s=function(u,a,y){var h=y._minDiff;if(!h){var _,b=u._fullData,w=[];for(h=1/0,_=0;_<b.length;_++){var T=b[_];if("ohlc"===T.type&&!0===T.visible&&T.xaxis===a._id){w.push(T);var L=a.makeCalcdata(T,"x");T._origX=L;var M=x(y,a,"x",L).vals;T._xcalc=M;var P=g.distinctVals(M).minDiff;P&&isFinite(P)&&(h=Math.min(h,P))}}for(h===1/0&&(h=1),_=0;_<w.length;_++)w[_]._minDiff=h}return h*y.tickwidth}(c,m,n),f=n._minDiff;n._minDiff=null;var l=n._origX;n._origX=null;var o=n._xcalc;n._xcalc=null;var d=i(c,n,l,o,p,r);return n._extremes[m._id]=k.findExtremes(m,o,{vpad:f/2}),d.length?(g.extendFlat(d[0].t,{wHover:f/2,tickLen:s}),d):[{t:{empty:!0}}]},calcCommon:i}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./ohlc_defaults"),k=v("../scatter/period_defaults"),x=v("./attributes");function e(r,i,c,n){c(n+".line.color"),c(n+".line.width",i.line.width),c(n+".line.dash",i.line.dash)}Q.exports=function(r,i,c,n){function m(p,s){return g.coerce(r,i,x,p,s)}t(r,i,m,n)?(k(r,i,n,m,{x:!0}),m("xhoverformat"),m("yhoverformat"),m("line.width"),m("line.dash"),e(0,i,m,"increasing"),e(0,i,m,"decreasing"),m("text"),m("hovertext"),m("tickwidth"),n._requestRangeslider[i.xaxis]=!0):i.visible=!1}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../lib"),k=v("../../components/fx"),x=v("../../components/color"),e=v("../../lib").fillText,r=v("../../constants/delta.js"),i={increasing:r.INCREASING.SYMBOL,decreasing:r.DECREASING.SYMBOL};function c(p,s,f,l){var o,d,u=p.cd,a=p.xa,y=u[0].trace,h=u[0].t,_=y.type,b="ohlc"===_?"l":"min",w="ohlc"===_?"h":"max",T=h.bPos||0,L=h.bdPos||h.tickLen,M=h.wHover,P=Math.min(1,L/Math.abs(a.r2c(a.range[1])-a.r2c(a.range[0])));function z(Z){var W=Z.pos+T-s;return k.inbox(W-M,W+M,o)}function S(Z){var W=Z[b],G=Z[w];return W===G||k.inbox(W-f,G-f,o)}function C(Z){return(z(Z)+S(Z))/2}o=p.maxHoverDistance-P,d=p.maxSpikeDistance-P;var R=k.getDistanceFunction(l,z,S,C);if(k.getClosest(u,R,p),!1===p.index)return null;var D=u[p.index];if(D.empty)return null;var j=y[D.dir],q=j.line.color;return p.color=x.opacity(q)&&j.line.width?q:j.fillcolor,p.x0=a.c2p(D.pos+T-L,!0),p.x1=a.c2p(D.pos+T+L,!0),p.xLabelVal=void 0!==D.orig_p?D.orig_p:D.pos,p.spikeDistance=C(D)*d/o,p.xSpike=a.c2p(D.pos,!0),p}function n(p,s,f,l){var o=p.cd,d=p.ya,u=o[0].trace,a=o[0].t,y=[],h=c(p,s,f,l);if(!h)return[];var _=o[h.index].hi||u.hoverinfo,b=_.split("+");if("all"!==_&&-1===b.indexOf("y"))return[];for(var w=["high","open","close","low"],T={},L=0;L<w.length;L++){var M,P=w[L],z=u[P][h.index],S=d.c2p(z,!0);z in T?(M=T[z]).yLabel+="<br>"+a.labels[P]+g.hoverLabelText(d,z,u.yhoverformat):((M=t.extendFlat({},h)).y0=M.y1=S,M.yLabelVal=z,M.yLabel=a.labels[P]+g.hoverLabelText(d,z,u.yhoverformat),M.name="",y.push(M),T[z]=M)}return y}function m(p,s,f,l){var o=p.cd,d=p.ya,u=o[0].trace,a=o[0].t,y=c(p,s,f,l);if(!y)return[];var h=o[y.index],_=y.index=h.i,b=h.dir;function w(C){return a.labels[C]+g.hoverLabelText(d,u[C][_],u.yhoverformat)}var T=h.hi||u.hoverinfo,L=T.split("+"),M="all"===T,P=M||-1!==L.indexOf("y"),z=M||-1!==L.indexOf("text"),S=P?[w("open"),w("high"),w("low"),w("close")+"  "+i[b]]:[];return z&&e(h,u,S),y.extraText=S.join("<br>"),y.y0=y.y1=d.c2p(h.yc,!0),[y]}Q.exports={hoverPoints:function(p,s,f,l){return p.cd[0].trace.hoverlabel.split?n(p,s,f,l):m(p,s,f,l)},hoverSplit:n,hoverOnPoints:m}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"ohlc",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc").calc,plot:v("./plot"),style:v("./style"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib");Q.exports=function(k,x,e,r){var i=e("x"),c=e("open"),n=e("high"),m=e("low"),p=e("close");if(e("hoverlabel.split"),g.getComponentMethod("calendars","handleTraceDefaults")(k,x,["x"],r),c&&n&&m&&p){var s=Math.min(c.length,n.length,m.length,p.length);return i&&(s=Math.min(s,t.minRowLength(i))),x._length=s,s}}},{"../../lib":515,"../../registry":647}],887:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib");Q.exports=function(k,x,e,r){var i=x.yaxis,c=x.xaxis,n=!!c.rangebreaks;t.makeTraceGroups(r,e,"trace ohlc").each(function(m){var p=g.select(this),s=m[0],f=s.t;if(!0!==s.trace.visible||f.empty)p.remove();else{var l=f.tickLen,o=p.selectAll("path").data(t.identity);o.enter().append("path"),o.exit().remove(),o.attr("d",function(d){if(d.empty)return"M0,0Z";var u=c.c2p(d.pos-l,!0),a=c.c2p(d.pos+l,!0),y=n?(u+a)/2:c.c2p(d.pos,!0);return"M"+u+","+i.c2p(d.o,!0)+"H"+y+"M"+y+","+i.c2p(d.h,!0)+"V"+i.c2p(d.l,!0)+"M"+a+","+i.c2p(d.c,!0)+"H"+y})}})}},{"../../lib":515,"@plotly/d3":58}],888:[function(v,Q,$){"use strict";Q.exports=function(g,t){var k,x=g.cd,e=g.xaxis,r=g.yaxis,i=[],c=x[0].t.bPos||0;if(!1===t)for(k=0;k<x.length;k++)x[k].selected=0;else for(k=0;k<x.length;k++){var n=x[k];t.contains([e.c2p(n.pos+c),r.c2p(n.yc)],null,n.i,g)?(i.push({pointNumber:n.i,x:e.c2d(n.pos),y:r.c2d(n.yc)}),n.selected=1):n.selected=0}return i}},{}],889:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../../components/color");Q.exports=function(x,e,r){var i=r||g.select(x).selectAll("g.ohlclayer").selectAll("g.trace");i.style("opacity",function(c){return c[0].trace.opacity}),i.each(function(c){var n=c[0].trace;g.select(this).selectAll("path").each(function(m){if(!m.empty){var p=n[m.dir].line;g.select(this).style("fill","none").call(k.stroke,p.color).call(t.dashLine,p.dash,p.width).style("opacity",n.selectedpoints&&!m.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(v,Q,$){"use strict";var g=v("../../lib/extend").extendFlat,t=v("../../plots/attributes"),k=v("../../plots/font_attributes"),x=v("../../components/colorscale/attributes"),e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/domain").attributes,i=g({editType:"calc"},x("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});Q.exports={domain:r({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:g({},t.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:k({editType:"calc"}),tickfont:k({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:i,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(v,Q,$){"use strict";var g=v("../../plots/get_data").getModuleCalcData,t=v("./plot");$.name="parcats",$.plot=function(k,x,e,r){var i=g(k.calcdata,"parcats");i.length&&t(k,i[0],e,r)},$.clean=function(k,x,e,r){var i=r._has&&r._has("parcats"),c=x._has&&x._has("parcats");i&&!c&&r._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(v,Q,$){"use strict";var g=v("../../lib/gup").wrap,t=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/calc"),x=v("../../lib/filter_unique.js"),e=v("../../components/drawing"),r=v("../../lib"),i=v("fast-isnumeric");function c(p,s,f){p.valueInds.push(s),p.count+=f}function n(p,s,f){return{categoryInds:p,color:s,rawColor:f,valueInds:[],count:0}}function m(p,s,f){p.valueInds.push(s),p.count+=f}Q.exports=function(p,s){var f=r.filterVisible(s.dimensions);if(0===f.length)return[];var l,o,d,u=f.map(function(X){var ne;if("trace"===X.categoryorder)ne=null;else if("array"===X.categoryorder)ne=X.categoryarray;else{ne=x(X.values);for(var V=!0,N=0;N<ne.length;N++)if(!i(ne[N])){V=!1;break}ne.sort(V?r.sorterAsc:void 0),"category descending"===X.categoryorder&&(ne=ne.reverse())}return function(U,ee){ee=null==ee?[]:ee.map(function(ve){return ve});var B={},K={},J=[];ee.forEach(function(ve,fe){B[ve]=0,K[ve]=fe});for(var te=0;te<U.length;te++){var ae,ce=U[te];void 0===B[ce]?(B[ce]=1,ae=ee.push(ce)-1,K[ce]=ae):(B[ce]++,ae=K[ce]),J.push(ae)}var oe=ee.map(function(ve){return B[ve]});return{uniqueValues:ee,uniqueCounts:oe,inds:J}}(X.values,ne)});l=r.isArrayOrTypedArray(s.counts)?s.counts:[s.counts],function(X){var ne;if(function(V){for(var N=new Array(V.length),U=0;U<V.length;U++){if(V[U]<0||V[U]>=V.length||void 0!==N[V[U]])return!1;N[V[U]]=!0}return!0}(X.map(function(V){return V.displayindex})))for(ne=0;ne<X.length;ne++)X[ne]._displayindex=X[ne].displayindex;else for(ne=0;ne<X.length;ne++)X[ne]._displayindex=ne}(f),f.forEach(function(X,ne){!function(V,N){V._categoryarray=N.uniqueValues,V._ticktext=null==V.ticktext?[]:V.ticktext.slice();for(var U=V._ticktext.length;U<N.uniqueValues.length;U++)V._ticktext.push(N.uniqueValues[U])}(X,u[ne])});var a,y=s.line;y?(t(s,"line")&&k(p,s,{vals:s.line.color,containerStr:"line",cLetter:"c"}),a=e.tryColorscale(y)):a=r.identity;var h,_,b,w,T,L=f[0].values.length,M={},P=u.map(function(X){return X.inds});for(d=0,h=0;h<L;h++){var z=[];for(_=0;_<P.length;_++)z.push(P[_][h]);d+=o=l[h%l.length];var S=(b=h,w=void 0,T=void 0,r.isArrayOrTypedArray(y.color)?T=w=y.color[b%y.color.length]:w=y.color,{color:a(w),rawColor:T}),C=z+"-"+S.rawColor;void 0===M[C]&&(M[C]=n(z,S.color,S.rawColor)),m(M[C],h,o)}var R,X,ne,V,N,D=f.map(function(X,ne){return{dimensionInd:ne,containerInd:X._index,displayInd:X._displayindex,dimensionLabel:X.label,count:d,categories:[],dragX:null}});for(h=0;h<L;h++)for(o=l[h%l.length],_=0;_<D.length;_++){var j=D[_].containerInd,q=u[_].inds[h],Z=D[_].categories;void 0===Z[q]&&(Z[q]={dimensionInd:_,categoryInd:R=q,categoryValue:s.dimensions[j]._categoryarray[q],displayInd:R,categoryLabel:s.dimensions[j]._ticktext[q],valueInds:[],count:0,dragY:null}),c(Z[q],h,o)}return g((ne=M,V=d,N=(X=D).map(function(U){return U.categories.length}).reduce(function(U,ee){return Math.max(U,ee)}),{dimensions:X,paths:ne,trace:void 0,maxCats:N,count:V}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("../../plots/domain").defaults,e=v("../../plots/array_container_defaults"),r=v("./attributes"),i=v("../parcoords/merge_length");function c(n,m){function p(a,y){return g.coerce(n,m,r.dimensions,a,y)}var s=p("values"),f=p("visible");if(s&&s.length||(f=m.visible=!1),f){p("label"),p("displayindex",m._index);var l,o=n.categoryarray,d=Array.isArray(o)&&o.length>0;d&&(l="array");var u=p("categoryorder",l);"array"===u?(p("categoryarray"),p("ticktext")):(delete n.categoryarray,delete n.ticktext),d||"array"!==u||(m.categoryorder="trace")}}Q.exports=function(n,m,p,s){function f(a,y){return g.coerce(n,m,r,a,y)}var l=e(n,m,{name:"dimensions",handleItemDefaults:c}),o=function(a,y,h,_,b){b("line.shape"),b("line.hovertemplate");var w=b("line.color",_.colorway[0]);if(t(a,"line")&&g.isArrayOrTypedArray(w)){if(w.length)return b("line.colorscale"),k(a,y,_,b,{prefix:"line.",cLetter:"c"}),w.length;y.line.color=h}return 1/0}(n,m,p,s,f);x(m,s,f),Array.isArray(l)&&l.length||(m.visible=!1),i(m,l,"values",o),f("hoveron"),f("hovertemplate"),f("arrangement"),f("bundlecolors"),f("sortpaths"),f("counts");var d={family:s.font.family,size:Math.round(s.font.size),color:s.font.color};g.coerceFont(f,"labelfont",d);var u={family:s.font.family,size:Math.round(s.font.size/1.2),color:s.font.color};g.coerceFont(f,"tickfont",u)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:v("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-interpolate").interpolateNumber,k=v("../../plot_api/plot_api"),x=v("../../components/fx"),e=v("../../lib"),r=e.strTranslate,i=v("../../components/drawing"),c=v("tinycolor2"),n=v("../../lib/svg_text_utils");function m(V,N,U,ee){var B=N._context.staticPlot,K=V.map(Z.bind(0,N,U)),J=ee.selectAll("g.parcatslayer").data([null]);J.enter().append("g").attr("class","parcatslayer").style("pointer-events",B?"none":"all");var te=J.selectAll("g.trace.parcats").data(K,p),ae=te.enter().append("g").attr("class","trace parcats");te.attr("transform",function(Te){return r(Te.x,Te.y)}),ae.append("g").attr("class","paths");var ce=te.select("g.paths").selectAll("path.path").data(function(Te){return Te.paths},p);ce.attr("fill",function(Te){return Te.model.color});var oe=ce.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(Te){return Te.model.color}).attr("fill-opacity",0);y(oe),ce.attr("d",function(Te){return Te.svgD}),oe.empty()||ce.sort(f),ce.exit().remove(),ce.on("mouseover",l).on("mouseout",o).on("click",a),ae.append("g").attr("class","dimensions");var ve=te.select("g.dimensions").selectAll("g.dimension").data(function(Te){return Te.dimensions},p);ve.enter().append("g").attr("class","dimension"),ve.attr("transform",function(Te){return r(Te.x,0)}),ve.exit().remove();var fe=ve.selectAll("g.category").data(function(Te){return Te.categories},p),xe=fe.enter().append("g").attr("class","category");fe.attr("transform",function(Te){return r(0,Te.y)}),xe.append("rect").attr("class","catrect").attr("pointer-events","none"),fe.select("rect.catrect").attr("fill","none").attr("width",function(Te){return Te.width}).attr("height",function(Te){return Te.height}),_(xe);var Se=fe.selectAll("rect.bandrect").data(function(Te){return Te.bands},p);Se.each(function(){e.raiseToTop(this)}),Se.attr("fill",function(Te){return Te.color});var pe=Se.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(Te){return Te.color}).attr("fill-opacity",0);Se.attr("fill",function(Te){return Te.color}).attr("width",function(Te){return Te.width}).attr("height",function(Te){return Te.height}).attr("y",function(Te){return Te.y}).attr("cursor",function(Te){return"fixed"===Te.parcatsViewModel.arrangement?"default":"perpendicular"===Te.parcatsViewModel.arrangement?"ns-resize":"move"}),b(pe),Se.exit().remove(),xe.append("text").attr("class","catlabel").attr("pointer-events","none");var ge=N._fullLayout.paper_bgcolor;fe.select("text.catlabel").attr("text-anchor",function(Te){return s(Te)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",n.makeTextShadow(ge)).style("fill","rgb(0, 0, 0)").attr("x",function(Te){return s(Te)?Te.width+5:-5}).attr("y",function(Te){return Te.height/2}).text(function(Te){return Te.model.categoryLabel}).each(function(Te){i.font(g.select(this),Te.parcatsViewModel.categorylabelfont),n.convertToTspans(g.select(this),N)}),xe.append("text").attr("class","dimlabel"),fe.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(Te){return"fixed"===Te.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(Te){return Te.width/2}).attr("y",-5).text(function(Te,se){return 0===se?Te.parcatsViewModel.model.dimensions[Te.model.dimensionInd].dimensionLabel:null}).each(function(Te){i.font(g.select(this),Te.parcatsViewModel.labelfont)}),fe.selectAll("rect.bandrect").on("mouseover",P).on("mouseout",z),fe.exit().remove(),ve.call(g.behavior.drag().origin(function(Te){return{x:Te.x,y:0}}).on("dragstart",S).on("drag",C).on("dragend",R)),te.each(function(Te){Te.traceSelection=g.select(this),Te.pathSelection=g.select(this).selectAll("g.paths").selectAll("path.path"),Te.dimensionSelection=g.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),te.exit().remove()}function p(V){return V.key}function s(V){return V.model.dimensionInd===V.parcatsViewModel.dimensions[V.parcatsViewModel.dimensions.length-1].model.dimensionInd}function f(V,N){return V.model.rawColor>N.model.rawColor?1:V.model.rawColor<N.model.rawColor?-1:0}function l(V){if(!V.parcatsViewModel.dragDimension&&-1===V.parcatsViewModel.hoverinfoItems.indexOf("skip")){e.raiseToTop(this),h(g.select(this));var N=d(V),U=u(V);if(V.parcatsViewModel.graphDiv.emit("plotly_hover",{points:N,event:g.event,constraints:U}),-1===V.parcatsViewModel.hoverinfoItems.indexOf("none")){var ee,B,K,J=g.mouse(this)[0],te=V.parcatsViewModel.graphDiv,ae=V.parcatsViewModel.trace,ce=te._fullLayout,oe=ce._paperdiv.node().getBoundingClientRect(),ve=V.parcatsViewModel.graphDiv.getBoundingClientRect();for(K=0;K<V.leftXs.length-1;K++)if(V.leftXs[K]+V.dimWidths[K]-2<=J&&J<=V.leftXs[K+1]+2){var fe=V.parcatsViewModel.dimensions[K];ee=(fe.x+fe.width+V.parcatsViewModel.dimensions[K+1].x)/2,B=(V.topYs[K]+V.topYs[K+1]+V.height)/2;break}var Se=V.parcatsViewModel.x+ee,pe=V.parcatsViewModel.y+B,ge=c.mostReadable(V.model.color,["black","white"]),Te=V.model.count,se=Te/V.parcatsViewModel.model.count,de={countLabel:Te,probabilityLabel:se.toFixed(3)},Ae=[];-1!==V.parcatsViewModel.hoverinfoItems.indexOf("count")&&Ae.push(["Count:",de.countLabel].join(" ")),-1!==V.parcatsViewModel.hoverinfoItems.indexOf("probability")&&Ae.push(["P:",de.probabilityLabel].join(" "));var Le=Ae.join("<br>"),Me=g.mouse(te)[0];x.loneHover({trace:ae,x:Se-oe.left+ve.left,y:pe-oe.top+ve.top,text:Le,color:V.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:ge,idealAlign:Me<Se?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:de,eventData:[{data:ae._input,fullData:ae,count:Te,probability:se}]},{container:ce._hoverlayer.node(),outerContainer:ce._paper.node(),gd:te})}}}function o(V){if(!V.parcatsViewModel.dragDimension&&(y(g.select(this)),x.loneUnhover(V.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),V.parcatsViewModel.pathSelection.sort(f),-1===V.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var N=d(V),U=u(V);V.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:N,event:g.event,constraints:U})}}function d(V){for(var N=[],U=D(V.parcatsViewModel),ee=0;ee<V.model.valueInds.length;ee++)N.push({curveNumber:U,pointNumber:V.model.valueInds[ee]});return N}function u(V){for(var N={},U=V.parcatsViewModel.model.dimensions,ee=0;ee<U.length;ee++){var B=U[ee];N[B.containerInd]=B.categories[V.model.categoryInds[ee]].categoryValue}return void 0!==V.model.rawColor&&(N.color=V.model.rawColor),N}function a(V){if(-1===V.parcatsViewModel.hoverinfoItems.indexOf("skip")){var N=d(V),U=u(V);V.parcatsViewModel.graphDiv.emit("plotly_click",{points:N,event:g.event,constraints:U})}}function y(V){V.attr("fill",function(N){return N.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function h(V){V.attr("fill-opacity",.8).attr("stroke",function(N){return c.mostReadable(N.model.color,["black","white"])}).attr("stroke-width",.3)}function _(V){V.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function b(V){V.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function w(V){var U=V.categoryViewModel.model.dimensionInd,ee=V.categoryViewModel.model.categoryInd;return V.parcatsViewModel.pathSelection.filter(function(B){return B.model.categoryInds[U]===ee&&B.model.color===V.color})}function T(V,N,U){var ee=g.select(V).datum(),B=ee.categoryViewModel.model,K=ee.parcatsViewModel.graphDiv,J=g.select(V.parentNode).selectAll("rect.bandrect"),te=[];J.each(function(ce){w(ce).each(function(oe){Array.prototype.push.apply(te,d(oe))})});var ae={};ae[B.dimensionInd]=B.categoryValue,K.emit(N,{points:te,event:U,constraints:ae})}function L(V,N,U){var ee=g.select(V).datum(),B=ee.categoryViewModel.model,K=ee.parcatsViewModel.graphDiv,J=w(ee),te=[];J.each(function(ce){Array.prototype.push.apply(te,d(ce))});var ae={};ae[B.dimensionInd]=B.categoryValue,void 0!==ee.rawColor&&(ae.color=ee.rawColor),K.emit(N,{points:te,event:U,constraints:ae})}function M(V,N,U){V._fullLayout._calcInverseTransform(V);var ee,B,K=V._fullLayout._invScaleX,J=V._fullLayout._invScaleY,te=g.select(U.parentNode).select("rect.catrect"),ae=te.node().getBoundingClientRect(),ce=te.datum(),oe=ce.parcatsViewModel,fe=oe.trace,xe=ae.top+ae.height/2;oe.dimensions.length>1&&oe.model.dimensions[ce.model.dimensionInd].displayInd===oe.dimensions.length-1?(ee=ae.left,B="left"):(ee=ae.left+ae.width,B="right");var Se=ce.model.count,pe=ce.model.categoryLabel,ge=Se/ce.parcatsViewModel.model.count,Te={countLabel:Se,categoryLabel:pe,probabilityLabel:ge.toFixed(3)},se=[];-1!==ce.parcatsViewModel.hoverinfoItems.indexOf("count")&&se.push(["Count:",Te.countLabel].join(" ")),-1!==ce.parcatsViewModel.hoverinfoItems.indexOf("probability")&&se.push(["P("+Te.categoryLabel+"):",Te.probabilityLabel].join(" "));var de=se.join("<br>");return{trace:fe,x:K*(ee-N.left),y:J*(xe-N.top),text:de,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:B,hovertemplate:fe.hovertemplate,hovertemplateLabels:Te,eventData:[{data:fe._input,fullData:fe,count:Se,category:pe,probability:ge}]}}function P(V){if(!V.parcatsViewModel.dragDimension&&-1===V.parcatsViewModel.hoverinfoItems.indexOf("skip")){if(g.mouse(this)[1]<-1)return;var N,U=V.parcatsViewModel.graphDiv,ee=U._fullLayout,B=ee._paperdiv.node().getBoundingClientRect(),K=V.parcatsViewModel.hoveron;"color"===K?(h(ae=w(te=g.select(this).datum())),ae.each(function(){e.raiseToTop(this)}),g.select(this.parentNode).selectAll("rect.bandrect").filter(function(ce){return ce.color===te.color}).each(function(){e.raiseToTop(this),g.select(this).attr("stroke","black").attr("stroke-width",1.5)}),L(this,"plotly_hover",g.event)):(function(J){g.select(J.parentNode).selectAll("rect.bandrect").each(function(te){var ae=w(te);h(ae),ae.each(function(){e.raiseToTop(this)})}),g.select(J.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),T(this,"plotly_hover",g.event)),-1===V.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===K?N=M(U,B,this):"color"===K?N=function(J,te,ae){J._fullLayout._calcInverseTransform(J);var ce,oe,ve=J._fullLayout._invScaleX,fe=J._fullLayout._invScaleY,xe=ae.getBoundingClientRect(),Se=g.select(ae).datum(),pe=Se.categoryViewModel,ge=pe.parcatsViewModel,se=ge.trace,de=xe.y+xe.height/2;ge.dimensions.length>1&&ge.model.dimensions[pe.model.dimensionInd].displayInd===ge.dimensions.length-1?(ce=xe.left,oe="left"):(ce=xe.left+xe.width,oe="right");var Ae=pe.model.categoryLabel,Le=Se.parcatsViewModel.model.count,Me=0;Se.categoryViewModel.bands.forEach(function(ct){ct.color===Se.color&&(Me+=ct.count)});var De=pe.model.count,Oe=0;ge.pathSelection.each(function(ct){ct.model.color===Se.color&&(Oe+=ct.model.count)});var Ie=Me/Le,Qe=Me/Oe,Ne=Me/De,Pe={countLabel:Le,categoryLabel:Ae,probabilityLabel:Ie.toFixed(3)},Re=[];-1!==pe.parcatsViewModel.hoverinfoItems.indexOf("count")&&Re.push(["Count:",Pe.countLabel].join(" ")),-1!==pe.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(Re.push("P(color \u2229 "+Ae+"): "+Pe.probabilityLabel),Re.push("P("+Ae+" | color): "+Qe.toFixed(3)),Re.push("P(color | "+Ae+"): "+Ne.toFixed(3)));var Ge=Re.join("<br>"),tt=c.mostReadable(Se.color,["black","white"]);return{trace:se,x:ve*(ce-te.left),y:fe*(de-te.top),text:Ge,color:Se.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:tt,fontSize:10,idealAlign:oe,hovertemplate:se.hovertemplate,hovertemplateLabels:Pe,eventData:[{data:se._input,fullData:se,category:Ae,count:Le,probability:Ie,categorycount:De,colorcount:Oe,bandcolorcount:Me}]}}(U,B,this):"dimension"===K&&(N=function(J,te,ae){var ce=[];return g.select(ae.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){ce.push(M(J,te,this))}),ce}(U,B,this)),N&&x.loneHover(N,{container:ee._hoverlayer.node(),outerContainer:ee._paper.node(),gd:U}))}var te,ae}function z(V){var N=V.parcatsViewModel;!N.dragDimension&&(y(N.pathSelection),_(N.dimensionSelection.selectAll("g.category")),b(N.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),x.loneUnhover(N.graphDiv._fullLayout._hoverlayer.node()),N.pathSelection.sort(f),-1===N.hoverinfoItems.indexOf("skip"))&&("color"===V.parcatsViewModel.hoveron?L(this,"plotly_unhover",g.event):T(this,"plotly_unhover",g.event))}function S(V){"fixed"!==V.parcatsViewModel.arrangement&&(V.dragDimensionDisplayInd=V.model.displayInd,V.initialDragDimensionDisplayInds=V.parcatsViewModel.model.dimensions.map(function(N){return N.displayInd}),V.dragHasMoved=!1,V.dragCategoryDisplayInd=null,g.select(this).selectAll("g.category").select("rect.catrect").each(function(N){var U=g.mouse(this)[0],ee=g.mouse(this)[1];-2<=U&&U<=N.width+2&&-2<=ee&&ee<=N.height+2&&(V.dragCategoryDisplayInd=N.model.displayInd,V.initialDragCategoryDisplayInds=V.model.categories.map(function(B){return B.displayInd}),N.model.dragY=N.y,e.raiseToTop(this.parentNode),g.select(this.parentNode).selectAll("rect.bandrect").each(function(B){B.y<ee&&ee<=B.y+B.height&&(V.potentialClickBand=this)}))}),V.parcatsViewModel.dragDimension=V,x.loneUnhover(V.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function C(V){if("fixed"!==V.parcatsViewModel.arrangement&&(V.dragHasMoved=!0,null!==V.dragDimensionDisplayInd)){var N=V.dragDimensionDisplayInd,U=N-1,ee=N+1,B=V.parcatsViewModel.dimensions[N];if(null!==V.dragCategoryDisplayInd){var K=B.categories[V.dragCategoryDisplayInd];K.model.dragY+=g.event.dy;var J=K.model.dragY,te=K.model.displayInd,ae=B.categories,ce=ae[te-1],oe=ae[te+1];void 0!==ce&&J<ce.y+ce.height/2&&(K.model.displayInd=ce.model.displayInd,ce.model.displayInd=te),void 0!==oe&&J+K.height>oe.y+oe.height/2&&(K.model.displayInd=oe.model.displayInd,oe.model.displayInd=te),V.dragCategoryDisplayInd=K.model.displayInd}if(null===V.dragCategoryDisplayInd||"freeform"===V.parcatsViewModel.arrangement){B.model.dragX=g.event.x;var ve=V.parcatsViewModel.dimensions[U],fe=V.parcatsViewModel.dimensions[ee];void 0!==ve&&B.model.dragX<ve.x+ve.width&&(B.model.displayInd=ve.model.displayInd,ve.model.displayInd=N),void 0!==fe&&B.model.dragX+B.width>fe.x&&(B.model.displayInd=fe.model.displayInd,fe.model.displayInd=V.dragDimensionDisplayInd),V.dragDimensionDisplayInd=B.model.displayInd}X(V.parcatsViewModel),G(V.parcatsViewModel),q(V.parcatsViewModel),j(V.parcatsViewModel)}}function R(V){if("fixed"!==V.parcatsViewModel.arrangement&&null!==V.dragDimensionDisplayInd){g.select(this).selectAll("text").attr("font-weight","normal");var N={},U=D(V.parcatsViewModel),ee=V.parcatsViewModel.model.dimensions.map(function(oe){return oe.displayInd}),B=V.initialDragDimensionDisplayInds.some(function(oe,ve){return oe!==ee[ve]});B&&ee.forEach(function(oe,ve){N["dimensions["+V.parcatsViewModel.model.dimensions[ve].containerInd+"].displayindex"]=oe});var K=!1;if(null!==V.dragCategoryDisplayInd){var J=V.model.categories.map(function(oe){return oe.displayInd});if(K=V.initialDragCategoryDisplayInds.some(function(oe,ve){return oe!==J[ve]})){var te=V.model.categories.slice().sort(function(oe,ve){return oe.displayInd-ve.displayInd}),ae=te.map(function(oe){return oe.categoryValue}),ce=te.map(function(oe){return oe.categoryLabel});N["dimensions["+V.model.containerInd+"].categoryarray"]=[ae],N["dimensions["+V.model.containerInd+"].ticktext"]=[ce],N["dimensions["+V.model.containerInd+"].categoryorder"]="array"}}-1===V.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!V.dragHasMoved&&V.potentialClickBand&&("color"===V.parcatsViewModel.hoveron?L(V.potentialClickBand,"plotly_click",g.event.sourceEvent):T(V.potentialClickBand,"plotly_click",g.event.sourceEvent)),V.model.dragX=null,null!==V.dragCategoryDisplayInd&&(V.parcatsViewModel.dimensions[V.dragDimensionDisplayInd].categories[V.dragCategoryDisplayInd].model.dragY=null,V.dragCategoryDisplayInd=null),V.dragDimensionDisplayInd=null,V.parcatsViewModel.dragDimension=null,V.dragHasMoved=null,V.potentialClickBand=null,X(V.parcatsViewModel),G(V.parcatsViewModel),g.transition().duration(300).ease("cubic-in-out").each(function(){q(V.parcatsViewModel,!0),j(V.parcatsViewModel,!0)}).each("end",function(){(B||K)&&k.restyle(V.parcatsViewModel.graphDiv,N,[U])})}}function D(V){for(var N,U=V.graphDiv._fullData,ee=0;ee<U.length;ee++)if(V.key===U[ee].uid){N=ee;break}return N}function j(V,N){var U;void 0===N&&(N=!1),V.pathSelection.data(function(ee){return ee.paths},p),(U=V.pathSelection,N?U.transition():U).attr("d",function(ee){return ee.svgD})}function q(V,N){function U(J){return N?J.transition():J}void 0===N&&(N=!1),V.dimensionSelection.data(function(J){return J.dimensions},p);var ee=V.dimensionSelection.selectAll("g.category").data(function(J){return J.categories},p);U(V.dimensionSelection).attr("transform",function(J){return r(J.x,0)}),U(ee).attr("transform",function(J){return r(0,J.y)}),ee.select(".dimlabel").text(function(J,te){return 0===te?J.parcatsViewModel.model.dimensions[J.model.dimensionInd].dimensionLabel:null}),ee.select(".catlabel").attr("text-anchor",function(J){return s(J)?"start":"end"}).attr("x",function(J){return s(J)?J.width+5:-5}).each(function(J){var te,ae;s(J)?(te=J.width+5,ae="start"):(te=-5,ae="end"),g.select(this).selectAll("tspan").attr("x",te).attr("text-anchor",ae)});var B=ee.selectAll("rect.bandrect").data(function(J){return J.bands},p),K=B.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(J){return J.color}).attr("fill-opacity",0);B.attr("fill",function(J){return J.color}).attr("width",function(J){return J.width}).attr("height",function(J){return J.height}).attr("y",function(J){return J.y}),b(K),B.each(function(){e.raiseToTop(this)}),B.exit().remove()}function Z(V,N,U){var ee,B=U[0],K=N.margin||{l:80,r:80,t:100,b:80},J=B.trace,te=J.domain,ae=N.width,ce=N.height,oe=Math.floor(ae*(te.x[1]-te.x[0])),ve=Math.floor(ce*(te.y[1]-te.y[0])),fe=te.x[0]*ae+K.l,xe=N.height-te.y[1]*N.height+K.t,Se=J.line.shape;ee="all"===J.hoverinfo?["count","probability"]:(J.hoverinfo||"").split("+");var pe={trace:J,key:J.uid,model:B,x:fe,y:xe,width:oe,height:ve,hoveron:J.hoveron,hoverinfoItems:ee,arrangement:J.arrangement,bundlecolors:J.bundlecolors,sortpaths:J.sortpaths,labelfont:J.labelfont,categorylabelfont:J.tickfont,pathShape:Se,dragDimension:null,margin:K,paths:[],dimensions:[],graphDiv:V,traceSelection:null,pathSelection:null,dimensionSelection:null};return B.dimensions&&(X(pe),G(pe)),pe}function W(V,N,U,ee,B){var K,J,te=[],ae=[];for(J=0;J<U.length-1;J++)K=t(U[J]+V[J],V[J+1]),te.push(K(B)),ae.push(K(1-B));var ce="M "+V[0]+","+N[0];for(ce+="l"+U[0]+",0 ",J=1;J<U.length;J++)ce+="C"+te[J-1]+","+N[J-1]+" "+ae[J-1]+","+N[J]+" "+V[J]+","+N[J],ce+="l"+U[J]+",0 ";for(ce+="l0,"+ee+" ",ce+="l -"+U[U.length-1]+",0 ",J=U.length-2;J>=0;J--)ce+="C"+ae[J]+","+(N[J+1]+ee)+" "+te[J]+","+(N[J]+ee)+" "+(V[J]+U[J])+","+(N[J]+ee),ce+="l-"+U[J]+",0 ";return ce+"Z"}function G(V){var N=V.dimensions,U=V.model,ee=N.map(function(Re){return Re.categories.map(function(Ge){return Ge.y})}),B=V.model.dimensions.map(function(Re){return Re.categories.map(function(Ge){return Ge.displayInd})}),K=V.model.dimensions.map(function(Re){return Re.displayInd}),J=V.dimensions.map(function(Re){return Re.model.dimensionInd}),te=N.map(function(Re){return Re.x}),ae=N.map(function(Re){return Re.width}),ce=[];for(var oe in U.paths)U.paths.hasOwnProperty(oe)&&ce.push(U.paths[oe]);function ve(Re){var Ge=Re.categoryInds.map(function(tt,ct){return B[ct][tt]});return J.map(function(tt){return Ge[tt]})}ce.sort(function(Re,Ge){var tt=ve(Re),ct=ve(Ge);return"backward"===V.sortpaths&&(tt.reverse(),ct.reverse()),tt.push(Re.valueInds[0]),ct.push(Ge.valueInds[0]),V.bundlecolors&&(tt.unshift(Re.rawColor),ct.unshift(Ge.rawColor)),tt<ct?-1:tt>ct?1:0});for(var fe=new Array(ce.length),xe=N[0].model.count,Se=N[0].categories.map(function(Re){return Re.height}).reduce(function(Re,Ge){return Re+Ge}),pe=0;pe<ce.length;pe++){var ge,Te=ce[pe];ge=xe>0?Se*(Te.count/xe):0;for(var se,de=new Array(ee.length),Ae=0;Ae<Te.categoryInds.length;Ae++){var Me=B[Ae][Te.categoryInds[Ae]],De=K[Ae];de[De]=ee[De][Me],ee[De][Me]+=ge;var Oe=V.dimensions[De].categories[Me],Ie=Oe.bands.length,Qe=Oe.bands[Ie-1];if(void 0===Qe||Te.rawColor!==Qe.rawColor){var Ne=void 0===Qe?0:Qe.y+Qe.height;Oe.bands.push({key:Ne,color:Te.color,rawColor:Te.rawColor,height:ge,width:Oe.width,count:Te.count,y:Ne,categoryViewModel:Oe,parcatsViewModel:V})}else{var Pe=Oe.bands[Ie-1];Pe.height+=ge,Pe.count+=Te.count}}se=W(te,de,ae,ge,"hspline"===V.pathShape?.5:0),fe[pe]={key:Te.valueInds[0],model:Te,height:ge,leftXs:te,topYs:de,dimWidths:ae,svgD:se,parcatsViewModel:V}}V.paths=fe}function X(V){var N=V.model.dimensions.map(function(J){return{displayInd:J.displayInd,dimensionInd:J.dimensionInd}});N.sort(function(J,te){return J.displayInd-te.displayInd});var U=[];for(var ee in N)U.push(ne(V,V.model.dimensions[N[ee].dimensionInd]));V.dimensions=U}function ne(V,N){var U,ee=V.model.dimensions.length;U=40+(ee>1?(V.width-80-16)/(ee-1):0)*N.displayInd;var K,J,te,ce,oe=[],ve=V.model.maxCats,fe=N.categories.length,xe=N.count,Se=V.height-8*(ve-1),pe=8*(ve-fe)/2,ge=N.categories.map(function(Te){return{displayInd:Te.displayInd,categoryInd:Te.categoryInd}});for(ge.sort(function(Te,se){return Te.displayInd-se.displayInd}),ce=0;ce<fe;ce++)te={key:(J=N.categories[ge[ce].categoryInd]).valueInds[0],model:J,width:16,height:K=xe>0?J.count/xe*Se:0,y:null!==J.dragY?J.dragY:pe,bands:[],parcatsViewModel:V},pe=pe+K+8,oe.push(te);return{key:N.dimensionInd,x:null!==N.dragX?N.dragX:U,y:0,width:16,model:N,categories:oe,parcatsViewModel:V,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}Q.exports=function(V,N,U,ee){m(U,V,ee,N)}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(v,Q,$){"use strict";var g=v("./parcats");Q.exports=function(t,k,x,e){var r=t._fullLayout,c=r._size;g(t,r._paper,k,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},x,e)}},{"./parcats":895}],897:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../../plots/cartesian/layout_attributes"),k=v("../../plots/font_attributes"),x=v("../../plots/domain").attributes,e=v("../../lib/extend").extendFlat,r=v("../../plot_api/plot_template").templatedArray;Q.exports={domain:x({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:k({editType:"plot"}),tickfont:k({editType:"plot"}),rangefont:k({editType:"plot"}),dimensions:r("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},t.tickvals,{editType:"plot"}),ticktext:e({},t.ticktext,{editType:"plot"}),tickformat:e({},t.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},g("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(v,Q,$){"use strict";var g=v("./constants"),t=v("@plotly/d3"),k=v("../../lib/gup").keyFun,x=v("../../lib/gup").repeat,e=v("../../lib").sorterAsc,r=v("../../lib").strTranslate,i=g.bar.snapRatio;function c(M,P){return M*(1-i)+P*i}var n=g.bar.snapClose;function m(M,P){return M*(1-n)+P*n}function p(M,P,z,S){if(function(ne,V){for(var N=0;N<V.length;N++)if(ne>=V[N][0]&&ne<=V[N][1])return!0;return!1}(z,S))return z;var C=M?-1:1,R=0,D=P.length-1;if(C<0){var j=R;R=D,D=j}for(var q=P[R],Z=q,W=R;C*W<C*D;W+=C){var G=W+C,X=P[G];if(C*z<C*m(q,X))return c(q,Z);if(C*z<C*X||G===D)return c(X,q);Z=q,q=X}}function s(M){M.attr("x",-g.bar.captureWidth/2).attr("width",g.bar.captureWidth)}function f(M){M.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function l(M){if(!M.brush.filterSpecified)return"0,"+M.height;for(var P,z,S,C=o(M.brush.filter.getConsolidated(),M.height),R=[0],D=C.length?C[0][0]:null,j=0;j<C.length;j++)z=(P=C[j])[1]-P[0],R.push(D),R.push(z),(S=j+1)<C.length&&(D=C[S][0]-P[1]);return R.push(M.height),R}function o(M,P){return M.map(function(z){return z.map(function(S){return Math.max(0,S*P)}).sort(e)})}function d(){t.select(document.body).style("cursor",null)}function u(M){M.attr("stroke-dasharray",l)}function a(M,P){var z=t.select(M).selectAll(".highlight, .highlight-shadow");u(P?z.transition().duration(g.bar.snapDuration).each("end",P):z)}function y(M,P){var z,S=M.brush,C=NaN,R={};if(S.filterSpecified){var D=M.height,j=S.filter.getConsolidated(),q=o(j,D),Z=NaN,W=NaN,G=NaN;for(z=0;z<=q.length;z++){var X=q[z];if(X&&X[0]<=P&&P<=X[1]){Z=z;break}if(W=z?z-1:NaN,X&&X[0]>P){G=z;break}}if(C=Z,isNaN(C)&&(C=isNaN(W)||isNaN(G)?isNaN(W)?G:W:P-q[W][1]<q[G][0]-P?W:G),!isNaN(C)){var ne=q[C],V=function(B,K){var J=g.bar.handleHeight;if(!(K>B[1]+J||K<B[0]-J))return K>=.9*B[1]+.1*B[0]?"n":K<=.9*B[0]+.1*B[1]?"s":"ns"}(ne,P);V&&(R.interval=j[C],R.intervalPix=ne,R.region=V)}}if(M.ordinal&&!R.region){var N=M.unitTickvals,U=M.unitToPaddedPx.invert(P);for(z=0;z<N.length;z++){var ee=[.25*N[Math.max(z-1,0)]+.75*N[z],.25*N[Math.min(z+1,N.length-1)]+.75*N[z]];if(U>=ee[0]&&U<=ee[1]){R.clickableOrdinalRange=ee;break}}}return R}function h(M,P){t.event.sourceEvent.stopPropagation();var z=P.height-t.mouse(M)[1]-2*g.verticalPadding,S=P.brush.svgBrush;S.wasDragged=!0,S._dragging=!0,S.newExtent=S.grabbingBar?[z-S.grabPoint,z+S.barLength-S.grabPoint].map(P.unitToPaddedPx.invert):[S.startExtent,P.unitToPaddedPx.invert(z)].sort(e),P.brush.filterSpecified=!0,S.extent=S.stayingIntervals.concat([S.newExtent]),S.brushCallback(P),a(M.parentNode)}function _(M,P){var z=y(P,P.height-t.mouse(M)[1]-2*g.verticalPadding),S="crosshair";z.clickableOrdinalRange?S="pointer":z.region&&(S=z.region+"-resize"),t.select(document.body).style("cursor",S)}function b(M){M.on("mousemove",function(P){t.event.preventDefault(),P.parent.inBrushDrag||_(this,P)}).on("mouseleave",function(P){P.parent.inBrushDrag||d()}).call(t.behavior.drag().on("dragstart",function(P){!function(z,S){t.event.sourceEvent.stopPropagation();var C=S.height-t.mouse(z)[1]-2*g.verticalPadding,R=S.unitToPaddedPx.invert(C),D=S.brush,j=y(S,C),q=j.interval,Z=D.svgBrush;if(Z.wasDragged=!1,Z.grabbingBar="ns"===j.region,Z.grabbingBar){var W=q.map(S.unitToPaddedPx);Z.grabPoint=C-W[0]-g.verticalPadding,Z.barLength=W[1]-W[0]}Z.clickableOrdinalRange=j.clickableOrdinalRange,Z.stayingIntervals=S.multiselect&&D.filterSpecified?D.filter.getConsolidated():[],q&&(Z.stayingIntervals=Z.stayingIntervals.filter(function(G){return G[0]!==q[0]&&G[1]!==q[1]})),Z.startExtent=j.region?q["s"===j.region?1:0]:R,S.parent.inBrushDrag=!0,Z.brushStartCallback()}(this,P)}).on("drag",function(P){h(this,P)}).on("dragend",function(P){!function(z,S){var C=S.brush,R=C.filter,D=C.svgBrush;D._dragging||(_(z,S),h(z,S),S.brush.svgBrush.wasDragged=!1),D._dragging=!1,t.event.sourceEvent.stopPropagation();var j=D.grabbingBar;if(D.grabbingBar=!1,D.grabLocation=void 0,S.parent.inBrushDrag=!1,d(),!D.wasDragged)return D.wasDragged=void 0,D.clickableOrdinalRange?C.filterSpecified&&S.multiselect?D.extent.push(D.clickableOrdinalRange):(D.extent=[D.clickableOrdinalRange],C.filterSpecified=!0):j?(D.extent=D.stayingIntervals,0===D.extent.length&&T(C)):T(C),D.brushCallback(S),a(z.parentNode),void D.brushEndCallback(C.filterSpecified?R.getConsolidated():[]);var q=function(){R.set(R.getConsolidated())};if(S.ordinal){var Z=S.unitTickvals;Z[Z.length-1]<Z[0]&&Z.reverse(),D.newExtent=[p(0,Z,D.newExtent[0],D.stayingIntervals),p(1,Z,D.newExtent[1],D.stayingIntervals)];var W=D.newExtent[1]>D.newExtent[0];D.extent=D.stayingIntervals.concat(W?[D.newExtent]:[]),D.extent.length||T(C),D.brushCallback(S),W?a(z.parentNode,q):(q(),a(z.parentNode))}else q();D.brushEndCallback(C.filterSpecified?R.getConsolidated():[])}(this,P)}))}function w(M,P){return M[0]-P[0]}function T(M){M.filterSpecified=!1,M.svgBrush.extent=[[-1/0,1/0]]}function L(M){for(var P,z=M.slice(),S=[],C=z.shift();C;){for(P=C.slice();(C=z.shift())&&C[0]<=P[1];)P[1]=Math.max(P[1],C[1]);S.push(P)}return 1===S.length&&S[0][0]>S[0][1]&&(S=[]),S}Q.exports={makeBrush:function(M,P,z,S,C,R){var D,q,Z,W,j=(W=[],{set:function(G){1===(W=G.map(function(X){return X.slice().sort(e)}).sort(w)).length&&W[0][0]===-1/0&&W[0][1]===1/0&&(W=[[0,-1]]),q=L(W),Z=W.reduce(function(X,ne){return[Math.min(X[0],ne[0]),Math.max(X[1],ne[1])]},[1/0,-1/0])},get:function(){return W.slice()},getConsolidated:function(){return q},getBounds:function(){return Z}});return j.set(z),{filter:j,filterSpecified:P,svgBrush:{extent:[],brushStartCallback:S,brushCallback:(D=C,function(q){var G,Z=q.brush,W=(G=Z,G.svgBrush.extent.map(function(X){return X.slice()})).slice();Z.filter.set(W),D()}),brushEndCallback:R}}},ensureAxisBrush:function(M,P,z){var S=M.selectAll("."+g.cn.axisBrush).data(x,k);S.enter().append("g").classed(g.cn.axisBrush,!0),function(C,R,D){var j=D._context.staticPlot,q=C.selectAll(".background").data(x);q.enter().append("rect").classed("background",!0).call(s).call(f).style("pointer-events",j?"none":"auto").attr("transform",r(0,g.verticalPadding)),q.call(b).attr("height",function(G){return G.height-g.verticalPadding});var Z=C.selectAll(".highlight-shadow").data(x);Z.enter().append("line").classed("highlight-shadow",!0).attr("x",-g.bar.width/2).attr("stroke-width",g.bar.width+g.bar.strokeWidth).attr("stroke",R).attr("opacity",g.bar.strokeOpacity).attr("stroke-linecap","butt"),Z.attr("y1",function(G){return G.height}).call(u);var W=C.selectAll(".highlight").data(x);W.enter().append("line").classed("highlight",!0).attr("x",-g.bar.width/2).attr("stroke-width",g.bar.width-g.bar.strokeWidth).attr("stroke",g.bar.fillColor).attr("opacity",g.bar.fillOpacity).attr("stroke-linecap","butt"),W.attr("y1",function(G){return G.height}).call(u)}(S,P,z)},cleanRanges:function(M,P){if(Array.isArray(M[0])?(M=M.map(function(S){return S.sort(e)}),M=P.multiselect?L(M.sort(w)):[M[0]]):M=[M.sort(e)],P.tickvals){var z=P.tickvals.slice().sort(e);if(!(M=M.map(function(S){var C=[p(0,z,S[0],[]),p(1,z,S[1],[])];if(C[1]>C[0])return C}).filter(function(S){return S})).length)return}return M.length>1?M:M[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:v("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../plots/get_data").getModuleCalcData,k=v("./plot"),x=v("../../constants/xmlns_namespaces");$.name="parcoords",$.plot=function(e){var r=t(e.calcdata,"parcoords")[0];r.length&&k(e,r)},$.clean=function(e,r,i,c){var n=c._has&&c._has("parcoords"),m=r._has&&r._has("parcoords");n&&!m&&(c._paperdiv.selectAll(".parcoords").remove(),c._glimages.selectAll("*").remove())},$.toSVG=function(e){var r=e._fullLayout._glimages,i=g.select(e).selectAll(".svg-container");i.filter(function(c,n){return n===i.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var c=this.toDataURL("image/png");r.append("svg:image").attr({xmlns:x.svg,"xlink:href":c,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){g.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(v,Q,$){"use strict";var g=v("../../lib").isArrayOrTypedArray,t=v("../../components/colorscale"),k=v("../../lib/gup").wrap;Q.exports=function(x,e){var r,i;return t.hasColorscale(e,"line")&&g(e.line.color)?(r=e.line.color,i=t.extractOpts(e.line).colorscale,t.calc(x,e,{vals:r,containerStr:"line",cLetter:"c"})):(r=function(c){for(var n=new Array(c),m=0;m<c;m++)n[m]=.5;return n}(e._length),i=[[0,e.line.color],[1,e.line.color]]),k({lineColor:r,cscale:i})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(v,Q,$){"use strict";Q.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("../../plots/domain").defaults,e=v("../../plots/array_container_defaults"),r=v("../../plots/cartesian/axes"),i=v("./attributes"),c=v("./axisbrush"),n=v("./constants").maxDimensionCount,m=v("./merge_length");function p(s,f,l,o){function d(_,b){return g.coerce(s,f,i.dimensions,_,b)}var u=d("values"),a=d("visible");if(u&&u.length||(a=f.visible=!1),a){d("label"),d("tickvals"),d("ticktext"),d("tickformat");var y=d("range");f._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:y},r.setConvert(f._ax,o.layout),d("multiselect");var h=d("constraintrange");h&&(f.constraintrange=c.cleanRanges(h,f))}}Q.exports=function(s,f,l,o){function d(_,b){return g.coerce(s,f,i,_,b)}var u=s.dimensions;Array.isArray(u)&&u.length>n&&(g.log("parcoords traces support up to "+n+" dimensions at the moment"),u.splice(n));var a=e(s,f,{name:"dimensions",layout:o,handleItemDefaults:p}),y=function(_,b,w,T,L){var M=L("line.color",w);if(t(_,"line")&&g.isArrayOrTypedArray(M)){if(M.length)return L("line.colorscale"),k(_,b,T,L,{prefix:"line.",cLetter:"c"}),M.length;b.line.color=w}return 1/0}(s,f,l,o,d);x(f,o,d),Array.isArray(a)&&a.length||(f.visible=!1),m(f,a,"values",y);var h={family:o.font.family,size:Math.round(o.font.size/1.2),color:o.font.color};g.coerceFont(d,"labelfont",h),g.coerceFont(d,"tickfont",h),g.coerceFont(d,"rangefont",h),d("labelangle"),d("labelside"),d("unselected.line.color"),d("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(v,Q,$){"use strict";var g=v("../../lib").isTypedArray;$.convertTypedArray=function(t){return g(t)?Array.prototype.slice.call(t):t},$.isOrdinal=function(t){return!!t.tickvals},$.isVisible=function(t){return t.visible||!("visible"in t)}},{"../../lib":515}],905:[function(v,Q,$){"use strict";var g=v("./base_index");g.plot=v("./plot"),Q.exports=g},{"./base_index":899,"./plot":909}],906:[function(v,Q,$){"use strict";var g=v("glslify"),t=g(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\nuniform sampler2D maskTexture, palette;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(maskTexture,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),k=g(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),x=v("./constants").maxDimensionCount,e=v("../../lib"),r=new Uint8Array(4),i=new Uint8Array(4),c={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function n(a,y,h,_,b){var w=a._gl;w.enable(w.SCISSOR_TEST),w.scissor(y,h,_,b),a.clear({color:[0,0,0,0],depth:1})}function m(a,y,h,_,b,w){var T=w.key;h.drawCompleted||(a.read({x:0,y:0,width:1,height:1,data:r}),h.drawCompleted=!0),function L(M){var P=Math.min(_,b-M*_);0===M&&(window.cancelAnimationFrame(h.currentRafs[T]),delete h.currentRafs[T],n(a,w.scissorX,w.scissorY,w.scissorWidth,w.viewBoxSize[1])),h.clearOnly||(w.count=2*P,w.offset=2*M*_,y(w),M*_+P<b&&(h.currentRafs[T]=window.requestAnimationFrame(function(){L(M+1)})),h.drawCompleted=!1)}(0)}function p(a,y){for(var h=new Array(256),_=0;_<256;_++)h[_]=a(_/255).concat(y);return h}function s(a,y){return(a>>>8*y)%256/255}function f(a,y,h){for(var _=new Array(8*y),b=0,w=0;w<y;w++)for(var T=0;T<2;T++)for(var L=0;L<4;L++){var M=4*a+L,P=h[64*w+M];63===M&&0===T&&(P*=-1),_[b++]=P}return _}function l(a){var y="0"+a;return y.substr(y.length-2)}function o(a){return a<x?"p"+l(a+1)+"_"+l(a+4):"colors"}function d(a,y,h,_,b,w,T,L,M,P,z,S,C,R){for(var D=[[],[]],j=0;j<64;j++)D[0][j]=j===b?1:0,D[1][j]=j===w?1:0;var q=a.lines.canvasOverdrag*R,Z=a.domain,W=a.canvasWidth*R,G=a.canvasHeight*R,X=a.pad.l*R,ne=a.pad.b*R,V=a.layoutHeight*R,N=a.layoutWidth*R,U=a.deselectedLines.color,ee=a.deselectedLines.opacity;return e.extendFlat({key:z,resolution:[W,G],viewBoxPos:[(T*=R)+q,L*=R],viewBoxSize:[M*=R,P*=R],i0:b,i1:w,dim0A:D[0].slice(0,16),dim0B:D[0].slice(16,32),dim0C:D[0].slice(32,48),dim0D:D[0].slice(48,64),dim1A:D[1].slice(0,16),dim1B:D[1].slice(16,32),dim1C:D[1].slice(32,48),dim1D:D[1].slice(48,64),drwLayer:S,contextColor:[U[0]/255,U[1]/255,U[2]/255,"auto"!==ee?U[3]*ee:Math.max(1/255,Math.pow(1/a.lines.color.length,1/3))],scissorX:(_===y?0:T+q)+(X-q)+N*Z.x[0],scissorWidth:(_===h?W-T+q:M+.5)+(_===y?T+q:0),scissorY:L+ne+V*Z.y[0],scissorHeight:P,viewportX:X-q+N*Z.x[0],viewportY:ne+V*Z.y[0],viewportWidth:W,viewportHeight:G},C)}function u(a){var y=Math.max(0,Math.floor(2047*a[0]),0),h=Math.min(2047,Math.ceil(2047*a[1]),2047);return[Math.min(y,h),Math.max(y,h)]}Q.exports=function(a,y){var h,b,w,T,L=y.context,M=y.pick,P=y.regl,z=P._gl,S=z.getParameter(z.ALIASED_LINE_WIDTH_RANGE),C=Math.max(S[0],Math.min(S[1],y.viewModel.plotGlPixelRatio)),R={currentRafs:{},drawCompleted:!0,clearOnly:!1},D=function(G){for(var X={},ne=0;ne<=x;ne+=4)X[o(ne)]=G.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return X}(P),j=P.texture(c),q=[];W(y);var Z=P({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:P.prop("scissorX"),y:P.prop("scissorY"),width:P.prop("scissorWidth"),height:P.prop("scissorHeight")}},viewport:{x:P.prop("viewportX"),y:P.prop("viewportY"),width:P.prop("viewportWidth"),height:P.prop("viewportHeight")},dither:!1,vert:t,frag:k,primitive:"lines",lineWidth:C,attributes:D,uniforms:{resolution:P.prop("resolution"),viewBoxPos:P.prop("viewBoxPos"),viewBoxSize:P.prop("viewBoxSize"),dim0A:P.prop("dim0A"),dim1A:P.prop("dim1A"),dim0B:P.prop("dim0B"),dim1B:P.prop("dim1B"),dim0C:P.prop("dim0C"),dim1C:P.prop("dim1C"),dim0D:P.prop("dim0D"),dim1D:P.prop("dim1D"),loA:P.prop("loA"),hiA:P.prop("hiA"),loB:P.prop("loB"),hiB:P.prop("hiB"),loC:P.prop("loC"),hiC:P.prop("hiC"),loD:P.prop("loD"),hiD:P.prop("hiD"),palette:j,contextColor:P.prop("contextColor"),maskTexture:P.prop("maskTexture"),drwLayer:P.prop("drwLayer"),maskHeight:P.prop("maskHeight")},offset:P.prop("offset"),count:P.prop("count")});function W(G){h=G.model,b=G.viewModel.dimensions.slice(),w=b[0]?b[0].values.length:0;var X=h.lines,ne=M?X.color.map(function(N,U){return U/X.color.length}):X.color,V=function(N,U,ee){for(var K=new Array(N*(x+4)),J=0,te=0;te<N;te++){for(var ae=0;ae<x;ae++)K[J++]=ae<U.length?U[ae].paddedUnitValues[te]:.5;K[J++]=s(te,2),K[J++]=s(te,1),K[J++]=s(te,0),K[J++]=Math.max(1e-6,Math.min(.999999,ee[te]))}return K}(w,b,ne);(function(N,U,ee){for(var B=0;B<=x;B+=4)N[o(B)](f(B/4,U,ee))})(D,w,V),L||M||(j=P.texture(e.extendFlat({data:p(h.unitToColor,255)},c)))}return{render:function(G,X,ne){var V,N,U,ee=G.length,B=1/0,K=-1/0;for(V=0;V<ee;V++)G[V].dim0.canvasX<B&&(B=G[V].dim0.canvasX,N=V),G[V].dim1.canvasX>K&&(K=G[V].dim1.canvasX,U=V);0===ee&&n(P,0,0,h.canvasWidth,h.canvasHeight);var J=function(ge){var Te,se,de,Ae=[[],[]];for(de=0;de<64;de++){var Le=!ge&&de<b.length?b[de].brush.filter.getBounds():[-1/0,1/0];Ae[0][de]=Le[0],Ae[1][de]=Le[1]}var Me=new Array(16384);for(Te=0;Te<16384;Te++)Me[Te]=255;if(!ge)for(Te=0;Te<b.length;Te++){var De=Te%8,Oe=(Te-De)/8,Ie=Math.pow(2,De),Qe=b[Te].brush.filter.get();if(!(Qe.length<2)){var Ne=u(Qe[0])[1];for(se=1;se<Qe.length;se++){var Pe=u(Qe[se]);for(de=Ne+1;de<Pe[0];de++)Me[8*de+Oe]&=~Ie;Ne=Math.max(Ne,Pe[1])}}}var Re={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Me};return T?T(Re):T=P.texture(Re),{maskTexture:T,maskHeight:2048,loA:Ae[0].slice(0,16),loB:Ae[0].slice(16,32),loC:Ae[0].slice(32,48),loD:Ae[0].slice(48,64),hiA:Ae[1].slice(0,16),hiB:Ae[1].slice(16,32),hiC:Ae[1].slice(32,48),hiD:Ae[1].slice(48,64)}}(L);for(V=0;V<ee;V++){var te=G[V],ae=te.dim0.crossfilterDimensionIndex,ce=te.dim1.crossfilterDimensionIndex,oe=te.canvasX,ve=te.canvasY,fe=oe+te.panelSizeX,xe=te.plotGlPixelRatio;if(X||!q[ae]||q[ae][0]!==oe||q[ae][1]!==fe){q[ae]=[oe,fe];var Se=d(h,N,U,V,ae,ce,oe,ve,te.panelSizeX,te.panelSizeY,te.dim0.crossfilterDimensionIndex,L?0:M?2:1,J,xe);R.clearOnly=ne,m(P,Z,R,X?h.lines.blockLineCount:w,w,Se)}}},readPixel:function(G,X){return P.read({x:G,y:X,width:1,height:1,data:i}),i},readPixels:function(G,X,ne,V){var N=new Uint8Array(4*ne*V);return P.read({x:G,y:X,width:ne,height:V,data:N}),N},destroy:function(){for(var G in a.style["pointer-events"]="none",j.destroy(),T&&T.destroy(),D)D[G].destroy()},update:W}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x){var e,r;for(x||(x=1/0),e=0;e<t.length;e++)(r=t[e]).visible&&(x=Math.min(x,r[k].length));for(x===1/0&&(x=0),g._length=x,e=0;e<t.length;e++)(r=t[e]).visible&&(r._length=x);return x}},{}],908:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=t.numberFormat,x=v("color-rgba"),e=v("../../plots/cartesian/axes"),r=t.strRotate,i=t.strTranslate,c=v("../../lib/svg_text_utils"),n=v("../../components/drawing"),m=v("../../components/colorscale"),p=v("../../lib/gup"),s=p.keyFun,f=p.repeat,l=p.unwrap,o=v("./helpers"),d=v("./constants"),u=v("./axisbrush"),a=v("./lines");function y(q,Z,W){return t.aggNums(q,null,Z,W)}function h(q,Z){return b(y(Math.min,q,Z),y(Math.max,q,Z))}function _(q){var Z=q.range;return Z?b(Z[0],Z[1]):h(q.values,q._length)}function b(q,Z){return!isNaN(q)&&isFinite(q)||(q=0),!isNaN(Z)&&isFinite(Z)||(Z=0),q===Z&&(0===q?(q-=1,Z+=1):(q*=.9,Z*=1.1)),[q,Z]}function w(q,Z,W,G,X){var ne,V,N=_(W);return G?g.scale.ordinal().domain(G.map((ne=k(W.tickformat),V=X,V?function(U,ee){var B=V[ee];return null==B?ne(U):B}:ne))).range(G.map(function(U){return q-Z+(U-N[0])/(N[1]-N[0])*(2*Z-q)})):g.scale.linear().domain(N).range([q-Z,Z])}function T(q){if(q.tickvals){var Z=_(q);return g.scale.ordinal().domain(q.tickvals).range(q.tickvals.map(function(W){return(W-Z[0])/(Z[1]-Z[0])}))}}function L(q){var Z=q.map(function(X){return X[0]}),W=q.map(function(X){var ne=x(X[1]);return g.rgb("rgb("+ne[0]+","+ne[1]+","+ne[2]+")")}),G="rgb".split("").map(function(X){return g.scale.linear().clamp(!0).domain(Z).range(W.map((ne=X,function(V){return V[ne]})));var ne});return function(X){return G.map(function(ne){return ne(X)})}}function M(q){return q.dimensions.some(function(Z){return Z.brush.filterSpecified})}function P(q,Z,W){var G=l(Z),X=G.trace,ne=o.convertTypedArray(G.lineColor),V=X.line,N={color:x(X.unselected.line.color),opacity:X.unselected.line.opacity},U=m.extractOpts(V),ee=U.reversescale?m.flipScale(G.cscale):G.cscale,B=X.domain,K=X.dimensions,J=q.width,te=X.labelangle,ae=X.labelside,ce=X.labelfont,oe=X.tickfont,ve=X.rangefont,fe=t.extendDeepNoArrays({},V,{color:ne.map(g.scale.linear().domain(_({values:ne,range:[U.min,U.max],_length:X._length}))),blockLineCount:d.blockLineCount,canvasOverdrag:d.overdrag*d.canvasPixelRatio}),xe=Math.floor(J*(B.x[1]-B.x[0])),Se=Math.floor(q.height*(B.y[1]-B.y[0])),pe=q.margin||{l:80,r:80,t:100,b:80},ge=xe,Te=Se;return{key:W,colCount:K.filter(o.isVisible).length,dimensions:K,tickDistance:d.tickDistance,unitToColor:L(ee),lines:fe,deselectedLines:N,labelAngle:te,labelSide:ae,labelFont:ce,tickFont:oe,rangeFont:ve,layoutWidth:J,layoutHeight:q.height,domain:B,translateX:B.x[0]*J,translateY:q.height-B.y[1]*q.height,pad:pe,canvasWidth:ge*d.canvasPixelRatio+2*fe.canvasOverdrag,canvasHeight:Te*d.canvasPixelRatio,width:ge,height:Te,canvasPixelRatio:d.canvasPixelRatio}}function z(q,Z,W){var J,te,G=W.width,X=W.height,ne=W.dimensions,V=W.canvasPixelRatio,N=function(J){return G*J/Math.max(1,W.colCount-1)},U=d.verticalPadding/X,ee=(J=X,te=d.verticalPadding,g.scale.linear().range([te,J-te])),B={key:W.key,xScale:N,model:W,inBrushDrag:!1},K={};return B.dimensions=ne.filter(o.isVisible).map(function(J,te){var Me,De,ae=(Me=J,De=U,g.scale.linear().domain(_(Me)).range([De,1-De])),ce=K[J.label];K[J.label]=(ce||0)+1;var oe=J.label+(ce?"__"+ce:""),ve=J.constraintrange,fe=ve&&ve.length;fe&&!Array.isArray(ve[0])&&(ve=[ve]);var xe=fe?ve.map(function(Me){return Me.map(ae)}):[[-1/0,1/0]],Se=J.values;Se.length>J._length&&(Se=Se.slice(0,J._length));var pe,ge=J.tickvals;function Te(Me,De){return{val:Me,text:pe[De]}}function se(Me,De){return Me.val-De.val}if(Array.isArray(ge)&&ge.length){pe=J.ticktext,Array.isArray(pe)&&pe.length?pe.length>ge.length?pe=pe.slice(0,ge.length):ge.length>pe.length&&(ge=ge.slice(0,pe.length)):pe=ge.map(k(J.tickformat));for(var de=1;de<ge.length;de++)if(ge[de]<ge[de-1]){for(var Ae=ge.map(Te).sort(se),Le=0;Le<ge.length;Le++)ge[Le]=Ae[Le].val,pe[Le]=Ae[Le].text;break}}else ge=void 0;return Se=o.convertTypedArray(Se),{key:oe,label:J.label,tickFormat:J.tickformat,tickvals:ge,ticktext:pe,ordinal:o.isOrdinal(J),multiselect:J.multiselect,xIndex:te,crossfilterDimensionIndex:te,visibleIndex:J._index,height:X,values:Se,paddedUnitValues:Se.map(ae),unitTickvals:ge&&ge.map(ae),xScale:N,x:N(te),canvasX:N(te)*V,unitToPaddedPx:ee,domainScale:w(X,d.verticalPadding,J,ge,pe),ordinalScale:T(J),parent:B,model:W,brush:u.makeBrush(q,fe,xe,function(){q.linePickActive(!1)},function(){var Me=B;Me.focusLayer&&Me.focusLayer.render(Me.panels,!0);var De=M(Me);!q.contextShown()&&De?(Me.contextLayer&&Me.contextLayer.render(Me.panels,!0),q.contextShown(!0)):q.contextShown()&&!De&&(Me.contextLayer&&Me.contextLayer.render(Me.panels,!0,!0),q.contextShown(!1))},function(Me){if(B.focusLayer.render(B.panels,!0),B.pickLayer&&B.pickLayer.render(B.panels,!0),q.linePickActive(!0),Z&&Z.filterChanged){var De=ae.invert,Oe=Me.map(function(Ie){return Ie.map(De).sort(t.sorterAsc)}).sort(function(Ie,Qe){return Ie[0]-Qe[0]});Z.filterChanged(B.key,J._index,Oe)}})}}),B}function S(q){q.classed(d.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function C(q,Z){var G=q*Math.PI/180;return{dir:"top"===Z?1:-1,dx:Math.sin(G),dy:Math.cos(G),degrees:q}}function R(q,Z,W){for(var G=Z.panels||(Z.panels=[]),X=q.data(),ne=0;ne<X.length-1;ne++){var V=G[ne]||(G[ne]={}),N=X[ne],U=X[ne+1];V.dim0=N,V.dim1=U,V.canvasX=N.canvasX,V.panelSizeX=U.canvasX-N.canvasX,V.panelSizeY=Z.model.canvasHeight,V.y=0,V.canvasY=0,V.plotGlPixelRatio=W}}function D(q,Z){return e.tickText(q._ax,Z,!1).text}function j(q,Z){if(q.ordinal)return"";var W=q.domainScale.domain();return D(q.model.dimensions[q.visibleIndex],W[Z?W.length-1:0])}Q.exports=function(q,Z,W,G){var X=q._context.staticPlot,ne=q._fullLayout,V=ne._toppaper,N=ne._glcontainer,U=q._context.plotGlPixelRatio,ee=q._fullLayout.paper_bgcolor;!function(Me){for(var De=0;De<Me.length;De++)for(var Oe=0;Oe<Me[De].length;Oe++)for(var Ie=Me[De][Oe].trace,Qe=Ie.dimensions,Ne=0;Ne<Qe.length;Ne++){var Pe=Qe[Ne].values,Re=Qe[Ne]._ax;Re&&(Re.range=Re.range?b(Re.range[0],Re.range[1]):h(Pe,Ie._length),Re.dtick||(Re.dtick=.01*(Math.abs(Re.range[1]-Re.range[0])||1)),Re.tickformat=Qe[Ne].tickformat,e.calcTicks(Re),Re.cleanRange())}}(Z);var B,K,J=(B=!0,K=!1,{linePickActive:function(Me){return arguments.length?B=!!Me:B},contextShown:function(Me){return arguments.length?K=!!Me:K}}),te=Z.filter(function(Me){return l(Me).trace.visible}).map(P.bind(0,W)).map(z.bind(0,J,G));N.each(function(Me,De){return t.extendFlat(Me,te[De])});var ae=N.selectAll(".gl-canvas").each(function(Me){Me.viewModel=te[0],Me.viewModel.plotGlPixelRatio=U,Me.viewModel.paperColor=ee,Me.model=Me.viewModel?Me.viewModel.model:null}),ce=null;ae.filter(function(Me){return Me.pick}).style("pointer-events",X?"none":"auto").on("mousemove",function(Me){if(J.linePickActive()&&Me.lineLayer&&G&&G.hover){var De=g.event,Oe=this.width,Ie=this.height,Qe=g.mouse(this),Ne=Qe[0],Pe=Qe[1];if(Ne<0||Pe<0||Ne>=Oe||Pe>=Ie)return;var Re=Me.lineLayer.readPixel(Ne,Ie-1-Pe),Ge=0!==Re[3],tt=Ge?Re[2]+256*(Re[1]+256*Re[0]):null,ct={x:Ne,y:Pe,clientX:De.clientX,clientY:De.clientY,dataIndex:Me.model.key,curveNumber:tt};tt!==ce&&(Ge?G.hover(ct):G.unhover&&G.unhover(ct),ce=tt)}}),ae.style("opacity",function(Me){return Me.pick?0:1}),V.style("background","rgba(255, 255, 255, 0)");var oe=V.selectAll("."+d.cn.parcoords).data(te,s);oe.exit().remove(),oe.enter().append("g").classed(d.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),oe.attr("transform",function(Me){return i(Me.model.translateX,Me.model.translateY)});var ve=oe.selectAll("."+d.cn.parcoordsControlView).data(f,s);ve.enter().append("g").classed(d.cn.parcoordsControlView,!0),ve.attr("transform",function(Me){return i(Me.model.pad.l,Me.model.pad.t)});var fe=ve.selectAll("."+d.cn.yAxis).data(function(Me){return Me.dimensions},s);fe.enter().append("g").classed(d.cn.yAxis,!0),ve.each(function(Me){R(fe,Me,U)}),ae.each(function(Me){Me.viewModel&&(!Me.lineLayer||G?Me.lineLayer=a(this,Me):Me.lineLayer.update(Me),(Me.key||0===Me.key)&&(Me.viewModel[Me.key]=Me.lineLayer),Me.lineLayer.render(Me.viewModel.panels,!Me.context||G))}),fe.attr("transform",function(Me){return i(Me.xScale(Me.xIndex),0)}),fe.call(g.behavior.drag().origin(function(Me){return Me}).on("drag",function(Me){var De=Me.parent;J.linePickActive(!1),Me.x=Math.max(-d.overdrag,Math.min(Me.model.width+d.overdrag,g.event.x)),Me.canvasX=Me.x*Me.model.canvasPixelRatio,fe.sort(function(Oe,Ie){return Oe.x-Ie.x}).each(function(Oe,Ie){Oe.xIndex=Ie,Oe.x=Me===Oe?Oe.x:Oe.xScale(Oe.xIndex),Oe.canvasX=Oe.x*Oe.model.canvasPixelRatio}),R(fe,De,U),fe.filter(function(Oe){return 0!==Math.abs(Me.xIndex-Oe.xIndex)}).attr("transform",function(Oe){return i(Oe.xScale(Oe.xIndex),0)}),g.select(this).attr("transform",i(Me.x,0)),fe.each(function(Oe,Ie,Qe){Qe===Me.parent.key&&(De.dimensions[Ie]=Oe)}),De.contextLayer&&De.contextLayer.render(De.panels,!1,!M(De)),De.focusLayer.render&&De.focusLayer.render(De.panels)}).on("dragend",function(Me){var De=Me.parent;Me.x=Me.xScale(Me.xIndex),Me.canvasX=Me.x*Me.model.canvasPixelRatio,R(fe,De,U),g.select(this).attr("transform",function(Oe){return i(Oe.x,0)}),De.contextLayer&&De.contextLayer.render(De.panels,!1,!M(De)),De.focusLayer&&De.focusLayer.render(De.panels),De.pickLayer&&De.pickLayer.render(De.panels,!0),J.linePickActive(!0),G&&G.axesMoved&&G.axesMoved(De.key,De.dimensions.map(function(Oe){return Oe.crossfilterDimensionIndex}))})),fe.exit().remove();var xe=fe.selectAll("."+d.cn.axisOverlays).data(f,s);xe.enter().append("g").classed(d.cn.axisOverlays,!0),xe.selectAll("."+d.cn.axis).remove();var Se=xe.selectAll("."+d.cn.axis).data(f,s);Se.enter().append("g").classed(d.cn.axis,!0),Se.each(function(Me){var De=Me.model.height/Me.model.tickDistance,Oe=Me.domainScale,Ie=Oe.domain();g.select(this).call(g.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(De,Me.tickFormat).tickValues(Me.ordinal?Ie:null).tickFormat(function(Qe){return o.isOrdinal(Me)?Qe:D(Me.model.dimensions[Me.visibleIndex],Qe)}).scale(Oe)),n.font(Se.selectAll("text"),Me.model.tickFont)}),Se.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),Se.selectAll("text").style("text-shadow",c.makeTextShadow(ee)).style("cursor","default");var pe=xe.selectAll("."+d.cn.axisHeading).data(f,s);pe.enter().append("g").classed(d.cn.axisHeading,!0);var ge=pe.selectAll("."+d.cn.axisTitle).data(f,s);ge.enter().append("text").classed(d.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",X?"none":"auto"),ge.text(function(Me){return Me.label}).each(function(Me){var De=g.select(this);n.font(De,Me.model.labelFont),c.convertToTspans(De,q)}).attr("transform",function(Me){var De=C(Me.model.labelAngle,Me.model.labelSide),Oe=d.axisTitleOffset;return(De.dir>0?"":i(0,2*Oe+Me.model.height))+r(De.degrees)+i(-Oe*De.dx,-Oe*De.dy)}).attr("text-anchor",function(Me){var De=C(Me.model.labelAngle,Me.model.labelSide);return 2*Math.abs(De.dx)>Math.abs(De.dy)?De.dir*De.dx<0?"start":"end":"middle"});var Te=xe.selectAll("."+d.cn.axisExtent).data(f,s);Te.enter().append("g").classed(d.cn.axisExtent,!0);var se=Te.selectAll("."+d.cn.axisExtentTop).data(f,s);se.enter().append("g").classed(d.cn.axisExtentTop,!0),se.attr("transform",i(0,-d.axisExtentOffset));var de=se.selectAll("."+d.cn.axisExtentTopText).data(f,s);de.enter().append("text").classed(d.cn.axisExtentTopText,!0).call(S),de.text(function(Me){return j(Me,!0)}).each(function(Me){n.font(g.select(this),Me.model.rangeFont)});var Ae=Te.selectAll("."+d.cn.axisExtentBottom).data(f,s);Ae.enter().append("g").classed(d.cn.axisExtentBottom,!0),Ae.attr("transform",function(Me){return i(0,Me.model.height+d.axisExtentOffset)});var Le=Ae.selectAll("."+d.cn.axisExtentBottomText).data(f,s);Le.enter().append("text").classed(d.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(S),Le.text(function(Me){return j(Me,!1)}).each(function(Me){n.font(g.select(this),Me.model.rangeFont)}),u.ensureAxisBrush(xe,ee,q)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(v,Q,$){"use strict";var g=v("./parcoords"),t=v("../../lib/prepare_regl"),k=v("./helpers").isVisible,x={};function e(r,i,c){var n=i.indexOf(c),m=r.indexOf(n);return-1===m&&(m+=i.length),m}(Q.exports=function(r,i){var c=r._fullLayout;if(t(r,[],x)){var n={},m={},p={},s={},f=c._size;i.forEach(function(l,o){var d=l[0].trace;p[o]=d.index;var u=s[o]=d._fullInput.index;n[o]=r.data[u].dimensions,m[o]=r.data[u].dimensions.slice()}),g(r,i,{width:f.w,height:f.h,margin:{t:f.t,r:f.r,b:f.b,l:f.l}},{filterChanged:function(l,o,d){var u=m[l][o],a=d.map(function(T){return T.slice()}),y="dimensions["+o+"].constraintrange",h=c._tracePreGUI[r._fullData[p[l]]._fullInput.uid];void 0===h[y]&&(h[y]=u.constraintrange||null);var b=r._fullData[p[l]].dimensions[o];a.length?(1===a.length&&(a=a[0]),u.constraintrange=a,b.constraintrange=a.slice(),a=[a]):(delete u.constraintrange,delete b.constraintrange,a=null);var w={};w[y]=a,r.emit("plotly_restyle",[w,[s[l]]])},hover:function(l){r.emit("plotly_hover",l)},unhover:function(l){r.emit("plotly_unhover",l)},axesMoved:function(l,o){var u,a,d=(u=o,a=m[l].filter(k),function(y,h){return e(u,a,y)-e(u,a,h)});n[l].sort(d),m[l].filter(function(u){return!k(u)}).sort(function(u){return m[l].indexOf(u)}).forEach(function(u){n[l].splice(n[l].indexOf(u),1),n[l].splice(m[l].indexOf(u),0,u)}),r.emit("plotly_restyle",[{dimensions:[n[l]]},[s[l]]])}})}}).reglPrecompiled=x},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(v,Q,$){"use strict";var g=v("../../plots/attributes"),t=v("../../plots/domain").attributes,k=v("../../plots/font_attributes"),x=v("../../components/color/attributes"),e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/template_attributes").texttemplateAttrs,i=v("../../lib/extend").extendFlat,c=k({editType:"plot",arrayOk:!0,colorEditType:"plot"});Q.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:x.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:i({},g.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:r({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:i({},c,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:i({},c,{}),outsidetextfont:i({},c,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:i({},c,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:t({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:i({},c,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(v,Q,$){"use strict";var g=v("../../plots/plots");$.name="pie",$.plot=function(t,k,x,e){g.plotBasePlot($.name,t,k,x,e)},$.clean=function(t,k,x,e){g.cleanBasePlot($.name,t,k,x,e)}},{"../../plots/plots":628}],912:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("tinycolor2"),k=v("../../components/color"),x={};function e(i){return function(c,n){return!!c&&!!(c=t(c)).isValid()&&(c=k.addOpacity(c,c.getAlpha()),i[n]||(i[n]=c),c)}}function r(i,c){var n,m=JSON.stringify(i),p=c[m];if(!p){for(p=i.slice(),n=0;n<i.length;n++)p.push(t(i[n]).lighten(20).toHexString());for(n=0;n<i.length;n++)p.push(t(i[n]).darken(20).toHexString());c[m]=p}return p}Q.exports={calc:function(i,c){var n,m,p=[],s=i._fullLayout,f=s.hiddenlabels||[],l=c.labels,o=c.marker.colors||[],d=c.values,u=c._length,a=c._hasValues&&u;if(c.dlabel)for(l=new Array(u),n=0;n<u;n++)l[n]=String(c.label0+n*c.dlabel);var y={},h=e(s["_"+c.type+"colormap"]),_=0,b=!1;for(n=0;n<u;n++){var w,T,L;if(a){if(!g(w=d[n]))continue;w=+w}else w=1;void 0!==(T=l[n])&&""!==T||(T=n);var M=y[T=String(T)];void 0===M?(y[T]=p.length,(L=-1!==f.indexOf(T))||(_+=w),p.push({v:w,label:T,color:h(o[n],T),i:n,pts:[n],hidden:L})):(b=!0,(m=p[M]).v+=w,m.pts.push(n),m.hidden||(_+=w),!1===m.color&&o[n]&&(m.color=h(o[n],T)))}return p=p.filter(function(P){return P.v>=0}),("funnelarea"===c.type?b:c.sort)&&p.sort(function(P,z){return z.v-P.v}),p[0]&&(p[0].vTotal=_),p},crossTraceCalc:function(i,c){var n=(c||{}).type;n||(n="pie");var m=i._fullLayout,p=i.calcdata,s=m[n+"colorway"],f=m["_"+n+"colormap"];m["extend"+n+"colors"]&&(s=r(s,x));for(var l=0,o=0;o<p.length;o++){var d=p[o];if(d[0].trace.type===n)for(var u=0;u<d.length;u++){var a=d[u];!1===a.color&&(f[a.label]?a.color=f[a.label]:(f[a.label]=a.color=s[l%s.length],l++))}}},makePullColorFn:e,generateExtendedColors:r}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("./attributes"),x=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText;function r(i,c){var n=Array.isArray(i),m=t.isArrayOrTypedArray(c),p=Math.min(n?i.length:1/0,m?c.length:1/0);if(isFinite(p)||(p=0),p&&m){for(var s,f=0;f<p;f++){var l=c[f];if(g(l)&&l>0){s=!0;break}}s||(p=0)}return{hasLabels:n,hasValues:m,len:p}}Q.exports={handleLabelsAndValues:r,supplyDefaults:function(i,c,n,m){function p(h,_){return t.coerce(i,c,k,h,_)}var s=r(p("labels"),p("values")),f=s.len;if(c._hasLabels=s.hasLabels,c._hasValues=s.hasValues,!c._hasLabels&&c._hasValues&&(p("label0"),p("dlabel")),f){c._length=f,p("marker.line.width")&&p("marker.line.color"),p("marker.colors"),p("scalegroup");var l,o=p("text"),d=p("texttemplate");if(d||(l=p("textinfo",Array.isArray(o)?"text+percent":"percent")),p("hovertext"),p("hovertemplate"),d||l&&"none"!==l){var u=p("textposition");e(i,c,m,p,u,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(u)||"auto"===u||"outside"===u)&&p("automargin"),("inside"===u||"auto"===u||Array.isArray(u))&&p("insidetextorientation")}x(c,m,p);var a=p("hole");if(p("title.text")){var y=p("title.position",a?"middle center":"top center");a||"middle center"!==y||(c.title.position="top center"),t.coerceFont(p,"title.font",m.font)}p("sort"),p("direction"),p("rotation"),p("pull")}else c.visible=!1}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(v,Q,$){"use strict";var g=v("../../components/fx/helpers").appendArrayMultiPointValues;Q.exports=function(t,k){var x={curveNumber:k.index,pointNumbers:t.pts,data:k._input,fullData:k,label:t.label,color:t.color,value:t.v,percent:t.percent,text:t.text,bbox:t.bbox,v:t.v};return 1===t.pts.length&&(x.pointNumber=x.i=t.pts[0]),g(x,k,t.pts),"funnelarea"===k.type&&(delete x.v,delete x.i),x}},{"../../components/fx/helpers":403}],915:[function(v,Q,$){"use strict";var g=v("../../lib");function t(k){return-1!==k.indexOf("e")?k.replace(/[.]?0+e/,"e"):-1!==k.indexOf(".")?k.replace(/[.]?0+$/,""):k}$.formatPiePercent=function(k,x){var e=t((100*k).toPrecision(3));return g.numSeparate(e,x)+"%"},$.formatPieValue=function(k,x){var e=t(k.toPrecision(10));return g.numSeparate(e,x)},$.getFirstFilled=function(k,x){if(Array.isArray(k))for(var e=0;e<x.length;e++){var r=k[x[e]];if(r||0===r||""===r)return r}},$.castOption=function(k,x){return Array.isArray(k)?$.getFirstFilled(k,x):k||void 0},$.getRotationAngle=function(k){return("auto"===k?0:k)*Math.PI/180}},{"../../lib":515}],916:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,supplyLayoutDefaults:v("./layout_defaults"),layoutAttributes:v("./layout_attributes"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style"),styleOne:v("./style_one"),moduleType:"trace",name:"pie",basePlotModule:v("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(v,Q,$){"use strict";Q.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x){function e(r,i){return g.coerce(k,x,t,r,i)}e("hiddenlabels"),e("piecolorway",x.colorway),e("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../plots/plots"),k=v("../../components/fx"),x=v("../../components/color"),e=v("../../components/drawing"),r=v("../../lib"),i=r.strScale,c=r.strTranslate,n=v("../../lib/svg_text_utils"),m=v("../bar/uniform_text"),p=m.recordMinTextSize,s=m.clearMinTextSize,f=v("../bar/constants").TEXTPAD,l=v("./helpers"),o=v("./event_data"),d=v("../../lib").isValidTextValue;function u(Z,W,G){var X=G[0],ne=X.cx,V=X.cy,N=X.trace,U="funnelarea"===N.type;"_hasHoverLabel"in N||(N._hasHoverLabel=!1),"_hasHoverEvent"in N||(N._hasHoverEvent=!1),Z.on("mouseover",function(ee){var B=W._fullLayout,K=W._fullData[N.index];if(!W._dragging&&!1!==B.hovermode){var J=K.hoverinfo;if(Array.isArray(J)&&(J=k.castHoverinfo({hoverinfo:[l.castOption(J,ee.pts)],_module:N._module},B,0)),"all"===J&&(J="label+text+value+percent+name"),K.hovertemplate||"none"!==J&&"skip"!==J&&J){var te=ee.rInscribed||0,ae=ne+ee.pxmid[0]*(1-te),ce=V+ee.pxmid[1]*(1-te),oe=B.separators,ve=[];if(J&&-1!==J.indexOf("label")&&ve.push(ee.label),ee.text=l.castOption(K.hovertext||K.text,ee.pts),J&&-1!==J.indexOf("text")){var fe=ee.text;r.isValidTextValue(fe)&&ve.push(fe)}ee.value=ee.v,ee.valueLabel=l.formatPieValue(ee.v,oe),J&&-1!==J.indexOf("value")&&ve.push(ee.valueLabel),ee.percent=ee.v/X.vTotal,ee.percentLabel=l.formatPiePercent(ee.percent,oe),J&&-1!==J.indexOf("percent")&&ve.push(ee.percentLabel);var xe=K.hoverlabel,Se=xe.font,pe=[];k.loneHover({trace:N,x0:ae-te*X.r,x1:ae+te*X.r,y:ce,_x0:U?ne+ee.TL[0]:ae-te*X.r,_x1:U?ne+ee.TR[0]:ae+te*X.r,_y0:U?V+ee.TL[1]:ce-te*X.r,_y1:U?V+ee.BL[1]:ce+te*X.r,text:ve.join("<br>"),name:K.hovertemplate||-1!==J.indexOf("name")?K.name:void 0,idealAlign:ee.pxmid[0]<0?"left":"right",color:l.castOption(xe.bgcolor,ee.pts)||ee.color,borderColor:l.castOption(xe.bordercolor,ee.pts),fontFamily:l.castOption(Se.family,ee.pts),fontSize:l.castOption(Se.size,ee.pts),fontColor:l.castOption(Se.color,ee.pts),nameLength:l.castOption(xe.namelength,ee.pts),textAlign:l.castOption(xe.align,ee.pts),hovertemplate:l.castOption(K.hovertemplate,ee.pts),hovertemplateLabels:ee,eventData:[o(ee,K)]},{container:B._hoverlayer.node(),outerContainer:B._paper.node(),gd:W,inOut_bbox:pe}),ee.bbox=pe[0],N._hasHoverLabel=!0}N._hasHoverEvent=!0,W.emit("plotly_hover",{points:[o(ee,K)],event:g.event})}}),Z.on("mouseout",function(ee){var B=W._fullLayout,K=W._fullData[N.index],J=g.select(this).datum();N._hasHoverEvent&&(ee.originalEvent=g.event,W.emit("plotly_unhover",{points:[o(J,K)],event:g.event}),N._hasHoverEvent=!1),N._hasHoverLabel&&(k.loneUnhover(B._hoverlayer.node()),N._hasHoverLabel=!1)}),Z.on("click",function(ee){W._dragging||!1===W._fullLayout.hovermode||(W._hoverdata=[o(ee,W._fullData[N.index])],k.click(W,g.event))})}function a(Z,W,G){var X=l.castOption(Z.insidetextfont.color,W.pts);!X&&Z._input.textfont&&(X=l.castOption(Z._input.textfont.color,W.pts));var ne=l.castOption(Z.insidetextfont.family,W.pts)||l.castOption(Z.textfont.family,W.pts)||G.family,V=l.castOption(Z.insidetextfont.size,W.pts)||l.castOption(Z.textfont.size,W.pts)||G.size;return{color:X||x.contrast(W.color),family:ne,size:V}}function y(Z,W){for(var G,X,ne=0;ne<Z.length;ne++)if((X=(G=Z[ne][0]).trace).title.text){var V=X.title.text;X._meta&&(V=r.templateString(V,X._meta));var N=e.tester.append("text").attr("data-notex",1).text(V).call(e.font,X.title.font).call(n.convertToTspans,W),U=e.bBox(N.node(),!0);G.titleBox={width:U.width,height:U.height},N.remove()}}function h(Z,W,G){var X=G.r||W.rpx1,ne=W.rInscribed;if(W.startangle===W.stopangle)return{rCenter:1-ne,scale:0,rotate:0,textPosAngle:0};var V,N=W.ring,U=1===N&&Math.abs(W.startangle-W.stopangle)===2*Math.PI,ee=W.halfangle,B=W.midangle,K=G.trace.insidetextorientation,J="horizontal"===K,te="tangential"===K,ae="radial"===K,ce="auto"===K,oe=[];if(!ce){var ve,fe=function(se,de){if(Qe=(De=W).stopangle,(Ie=De.startangle)>(Oe=se)&&Oe>Qe||Ie<Oe&&Oe<Qe){var Ae=Math.abs(se-W.startangle),Le=Math.abs(se-W.stopangle),Me=Ae<Le?Ae:Le;(V="tan"===de?b(Z,X,N,Me,0):_(Z,X,N,Me,Math.PI/2)).textPosAngle=se,oe.push(V)}var De,Oe,Ie,Qe};if(J||te){for(ve=4;ve>=-4;ve-=2)fe(Math.PI*ve,"tan");for(ve=4;ve>=-4;ve-=2)fe(Math.PI*(ve+1),"tan")}if(J||ae){for(ve=4;ve>=-4;ve-=2)fe(Math.PI*(ve+1.5),"rad");for(ve=4;ve>=-4;ve-=2)fe(Math.PI*(ve+.5),"rad")}}if(U||ce||J){var xe=Math.sqrt(Z.width*Z.width+Z.height*Z.height);if((V={scale:ne*X*2/xe,rCenter:1-ne,rotate:0}).textPosAngle=(W.startangle+W.stopangle)/2,V.scale>=1)return V;oe.push(V)}(ce||ae)&&((V=_(Z,X,N,ee,B)).textPosAngle=(W.startangle+W.stopangle)/2,oe.push(V)),(ce||te)&&((V=b(Z,X,N,ee,B)).textPosAngle=(W.startangle+W.stopangle)/2,oe.push(V));for(var Se=0,pe=0,ge=0;ge<oe.length;ge++){var Te=oe[ge].scale;if(pe<Te&&(pe=Te,Se=ge),!ce&&pe>=1)break}return oe[Se]}function _(Z,W,G,X,ne){W=Math.max(0,W-2*f);var V=Z.width/Z.height,N=L(V,X,W,G);return{scale:2*N/Z.height,rCenter:w(V,N/W),rotate:T(ne)}}function b(Z,W,G,X,ne){W=Math.max(0,W-2*f);var V=Z.height/Z.width,N=L(V,X,W,G);return{scale:2*N/Z.width,rCenter:w(V,N/W),rotate:T(ne+Math.PI/2)}}function w(Z,W){return Math.cos(W)-Z*W}function T(Z){return(180/Math.PI*Z+720)%180-90}function L(Z,W,G,X){var ne=Z+1/(2*Math.tan(W));return G*Math.min(1/(Math.sqrt(ne*ne+.5)+ne),X/(Math.sqrt(Z*Z+X/2)+Z))}function M(Z,W){return Z.v!==W.vTotal||W.trace.hole?Math.min(1/(1+1/Math.sin(Z.halfangle)),Z.ring/2):1}function P(Z,W){var G=W.pxmid[0],X=W.pxmid[1],ne=Z.width/2,V=Z.height/2;return G<0&&(ne*=-1),X<0&&(V*=-1),{scale:1,rCenter:1,rotate:0,x:ne+Math.abs(V)*(ne>0?1:-1)/2,y:V/(1+G*G/(X*X)),outside:!0}}function z(Z,W){var G,X,ne,V=Z.trace,N={x:Z.cx,y:Z.cy},U={tx:0,ty:0};U.ty+=V.title.font.size,ne=C(V),-1!==V.title.position.indexOf("top")?(N.y-=(1+ne)*Z.r,U.ty-=Z.titleBox.height):-1!==V.title.position.indexOf("bottom")&&(N.y+=(1+ne)*Z.r);var B,K=Z.r/(void 0===(B=Z.trace.aspectratio)?1:B),J=W.w*(V.domain.x[1]-V.domain.x[0])/2;return-1!==V.title.position.indexOf("left")?(J+=K,N.x-=(1+ne)*K,U.tx+=Z.titleBox.width/2):-1!==V.title.position.indexOf("center")?J*=2:-1!==V.title.position.indexOf("right")&&(J+=K,N.x+=(1+ne)*K,U.tx-=Z.titleBox.width/2),G=J/Z.titleBox.width,X=S(Z,W)/Z.titleBox.height,{x:N.x,y:N.y,scale:Math.min(G,X),tx:U.tx,ty:U.ty}}function S(Z,W){var G=Z.trace;return Math.min(Z.titleBox.height,W.h*(G.domain.y[1]-G.domain.y[0])/2)}function C(Z){var W,G=Z.pull;if(!G)return 0;if(Array.isArray(G))for(G=0,W=0;W<Z.pull.length;W++)Z.pull[W]>G&&(G=Z.pull[W]);return G}function R(Z,W){for(var G=[],X=0;X<Z.length;X++){var ne=Z[X][0],V=ne.trace,N=V.domain,U=W.w*(N.x[1]-N.x[0]),ee=W.h*(N.y[1]-N.y[0]);V.title.text&&"middle center"!==V.title.position&&(ee-=S(ne,W));var K=ee/2;"funnelarea"!==V.type||V.scalegroup||(K/=V.aspectratio),ne.r=Math.min(U/2,K)/(1+C(V)),ne.cx=W.l+W.w*(V.domain.x[1]+V.domain.x[0])/2,ne.cy=W.t+W.h*(1-V.domain.y[0])-ee/2,V.title.text&&-1!==V.title.position.indexOf("bottom")&&(ne.cy-=S(ne,W)),V.scalegroup&&-1===G.indexOf(V.scalegroup)&&G.push(V.scalegroup)}!function(J,te){for(var ae,ce,oe,ve=0;ve<te.length;ve++){var fe=1/0,xe=te[ve];for(ce=0;ce<J.length;ce++)if((oe=(ae=J[ce][0]).trace).scalegroup===xe){var Se;if("pie"===oe.type)Se=ae.r*ae.r;else if("funnelarea"===oe.type){var pe,ge;oe.aspectratio>1?ge=(pe=ae.r)/oe.aspectratio:pe=(ge=ae.r)*oe.aspectratio,Se=(pe*=(1+oe.baseratio)/2)*ge}fe=Math.min(fe,Se/ae.vTotal)}for(ce=0;ce<J.length;ce++)if((oe=(ae=J[ce][0]).trace).scalegroup===xe){var Te=fe*ae.vTotal;"funnelarea"===oe.type&&(Te/=(1+oe.baseratio)/2,Te/=oe.aspectratio),ae.r=Math.sqrt(Te)}}}(Z,G)}function D(Z,W){return[Z*Math.sin(W),-Z*Math.cos(W)]}function j(Z,W,G){var Se,X=Z._fullLayout,ne=G.trace,V=ne.texttemplate,N=ne.textinfo;if(!V&&N&&"none"!==N){var U,ee=N.split("+"),B=function(Se){return-1!==ee.indexOf(Se)},K=B("label"),J=B("text"),te=B("value"),ae=B("percent"),ce=X.separators;if(U=K?[W.label]:[],J){var oe=l.getFirstFilled(ne.text,W.pts);d(oe)&&U.push(oe)}te&&U.push(l.formatPieValue(W.v,ce)),ae&&U.push(l.formatPiePercent(W.v/G.vTotal,ce)),W.text=U.join("<br>")}if(V){var ve=r.castOption(ne,W.i,"texttemplate");if(ve){var fe={label:(Se=W).label,value:Se.v,valueLabel:l.formatPieValue(Se.v,X.separators),percent:Se.v/G.vTotal,percentLabel:l.formatPiePercent(Se.v/G.vTotal,X.separators),color:Se.color,text:Se.text,customdata:r.castOption(ne,Se.i,"customdata")},xe=l.getFirstFilled(ne.text,W.pts);(d(xe)||""===xe)&&(fe.text=xe),W.text=r.texttemplateString(ve,fe,Z._fullLayout._d3locale,fe,ne._meta||{})}else W.text=""}}function q(Z,W){var G=Z.rotate*Math.PI/180,X=Math.cos(G),ne=Math.sin(G),V=(W.left+W.right)/2,N=(W.top+W.bottom)/2;Z.textX=V*X-N*ne,Z.textY=V*ne+N*X,Z.noCenter=!0}Q.exports={plot:function(Z,W){var G=Z._context.staticPlot,X=Z._fullLayout,ne=X._size;s("pie",X),y(W,Z),R(W,ne);var V=r.makeTraceGroups(X._pielayer,W,"trace").each(function(N){var U=g.select(this),ee=N[0],B=ee.trace;(function(K){var J,te,ae,ce=K[0],oe=ce.r,ve=ce.trace,fe=l.getRotationAngle(ve.rotation),xe=2*Math.PI/ce.vTotal,Se="px0",pe="px1";if("counterclockwise"===ve.direction){for(J=0;J<K.length&&K[J].hidden;J++);if(J===K.length)return;fe+=xe*K[J].v,xe*=-1,Se="px1",pe="px0"}for(ae=D(oe,fe),J=0;J<K.length;J++)(te=K[J]).hidden||(te[Se]=ae,te.startangle=fe,te.pxmid=D(oe,fe+=xe*te.v/2),te.midangle=fe,ae=D(oe,fe+=xe*te.v/2),te.stopangle=fe,te[pe]=ae,te.largeArc=te.v>ce.vTotal/2?1:0,te.halfangle=Math.PI*Math.min(te.v/ce.vTotal,.5),te.ring=1-ve.hole,te.rInscribed=M(te,ce))})(N),U.attr("stroke-linejoin","round"),U.each(function(){var K=g.select(this).selectAll("g.slice").data(N);K.enter().append("g").classed("slice",!0),K.exit().remove();var J=[[[],[]],[[],[]]],te=!1;K.each(function(pe,ge){if(pe.hidden)g.select(this).selectAll("path,g").remove();else{pe.pointNumber=pe.i,pe.curveNumber=B.index,J[pe.pxmid[1]<0?0:1][pe.pxmid[0]<0?0:1].push(pe);var Te=ee.cx,se=ee.cy,de=g.select(this),Ae=de.selectAll("path.surface").data([pe]);if(Ae.enter().append("path").classed("surface",!0).style({"pointer-events":G?"none":"all"}),de.call(u,Z,N),B.pull){var Le=+l.castOption(B.pull,pe.pts)||0;Le>0&&(Te+=Le*pe.pxmid[0],se+=Le*pe.pxmid[1])}pe.cxFinal=Te,pe.cyFinal=se;var Me=B.hole;if(pe.v===ee.vTotal){var De="M"+(Te+pe.px0[0])+","+(se+pe.px0[1])+Pe(pe.px0,pe.pxmid,!0,1)+Pe(pe.pxmid,pe.px0,!0,1)+"Z";Ae.attr("d",Me?"M"+(Te+Me*pe.px0[0])+","+(se+Me*pe.px0[1])+Pe(pe.px0,pe.pxmid,!1,Me)+Pe(pe.pxmid,pe.px0,!1,Me)+"Z"+De:De)}else{var Oe=Pe(pe.px0,pe.px1,!0,1);if(Me){var Ie=1-Me;Ae.attr("d","M"+(Te+Me*pe.px1[0])+","+(se+Me*pe.px1[1])+Pe(pe.px1,pe.px0,!1,Me)+"l"+Ie*pe.px0[0]+","+Ie*pe.px0[1]+Oe+"Z")}else Ae.attr("d","M"+Te+","+se+"l"+pe.px0[0]+","+pe.px0[1]+Oe+"Z")}j(Z,pe,ee);var Qe=l.castOption(B.textposition,pe.pts),Ne=de.selectAll("g.slicetext").data(pe.text&&"none"!==Qe?[0]:[]);Ne.enter().append("g").classed("slicetext",!0),Ne.exit().remove(),Ne.each(function(){var et,yt,Vt,Re=r.ensureSingle(g.select(this),"text","",function(et){et.attr("data-notex",1)}),Ge=r.ensureUniformFontSize(Z,"outside"===Qe?(Vt=X.font,{color:l.castOption((et=B).outsidetextfont.color,(yt=pe).pts)||l.castOption(et.textfont.color,yt.pts)||Vt.color,family:l.castOption(et.outsidetextfont.family,yt.pts)||l.castOption(et.textfont.family,yt.pts)||Vt.family,size:l.castOption(et.outsidetextfont.size,yt.pts)||l.castOption(et.textfont.size,yt.pts)||Vt.size}):a(B,pe,X.font));Re.text(pe.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Ge).call(n.convertToTspans,Z);var tt,ct=e.bBox(Re.node());if("outside"===Qe)tt=P(ct,pe);else if(tt=h(ct,pe,ee),"auto"===Qe&&tt.scale<1){var wt=r.ensureUniformFontSize(Z,B.outsidetextfont);Re.call(e.font,wt),tt=P(ct=e.bBox(Re.node()),pe)}var kt=tt.textPosAngle,gt=void 0===kt?pe.pxmid:D(ee.r,kt);if(tt.targetX=Te+gt[0]*tt.rCenter+(tt.x||0),tt.targetY=se+gt[1]*tt.rCenter+(tt.y||0),q(tt,ct),tt.outside){var at=tt.targetY;pe.yLabelMin=at-ct.height/2,pe.yLabelMid=at,pe.yLabelMax=at+ct.height/2,pe.labelExtraX=0,pe.labelExtraY=0,te=!0}tt.fontSize=Ge.size,p(B.type,tt,X),N[ge].transform=tt,r.setTransormAndDisplay(Re,tt)})}function Pe(Re,Ge,tt,ct){return"a"+ct*ee.r+","+ct*ee.r+" 0 "+pe.largeArc+(tt?" 1 ":" 0 ")+ct*(Ge[0]-Re[0])+","+ct*(Ge[1]-Re[1])}});var ge,ae=g.select(this).selectAll("g.titletext").data(B.title.text?[0]:[]);if(ae.enter().append("g").classed("titletext",!0),ae.exit().remove(),ae.each(function(){var pe,se,de,ge=r.ensureSingle(g.select(this),"text","",function(se){se.attr("data-notex",1)}),Te=B.title.text;B._meta&&(Te=r.templateString(Te,B._meta)),ge.text(Te).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,B.title.font).call(n.convertToTspans,Z),pe="middle center"===B.title.position?(se=ee,de=Math.sqrt(se.titleBox.width*se.titleBox.width+se.titleBox.height*se.titleBox.height),{x:se.cx,y:se.cy,scale:se.trace.hole*se.r*2/de,tx:0,ty:-se.titleBox.height/2+se.trace.title.font.size}):z(ee,ne),ge.attr("transform",c(pe.x,pe.y)+i(Math.min(1,pe.scale))+c(pe.tx,pe.ty))}),te&&function(pe,ge){var Te,se,de,Ae,Le,Me,De,Oe,Ie,Qe,Ne,Pe,Re;function Ge(kt,gt){return kt.pxmid[1]-gt.pxmid[1]}function tt(kt,gt){return gt.pxmid[1]-kt.pxmid[1]}function ct(kt,gt){gt||(gt={});var at,et,yt,Vt,Gt=gt.labelExtraY+(se?gt.yLabelMax:gt.yLabelMin),en=se?kt.yLabelMin:kt.yLabelMax,Jt=se?kt.yLabelMax:kt.yLabelMin,cn=kt.cyFinal+Le(kt.px0[1],kt.px1[1]),Rt=Gt-en;if(Rt*De>0&&(kt.labelExtraY=Rt),Array.isArray(ge.pull))for(et=0;et<Qe.length;et++)(yt=Qe[et])===kt||(l.castOption(ge.pull,kt.pts)||0)>=(l.castOption(ge.pull,yt.pts)||0)||((kt.pxmid[1]-yt.pxmid[1])*De>0?(Rt=yt.cyFinal+Le(yt.px0[1],yt.px1[1])-en-kt.labelExtraY)*De>0&&(kt.labelExtraY+=Rt):(Jt+kt.labelExtraY-cn)*De>0&&(at=3*Me*Math.abs(et-Qe.indexOf(kt)),(Vt=yt.cxFinal+Ae(yt.px0[0],yt.px1[0])+at-(kt.cxFinal+kt.pxmid[0])-kt.labelExtraX)*Me>0&&(kt.labelExtraX+=Vt)))}for(se=0;se<2;se++)for(de=se?Ge:tt,Le=se?Math.max:Math.min,De=se?1:-1,Te=0;Te<2;Te++){for(Ae=Te?Math.max:Math.min,Me=Te?1:-1,(Oe=pe[se][Te]).sort(de),Qe=(Ie=pe[1-se][Te]).concat(Oe),Pe=[],Ne=0;Ne<Oe.length;Ne++)void 0!==Oe[Ne].yLabelMid&&Pe.push(Oe[Ne]);for(Re=!1,Ne=0;se&&Ne<Ie.length;Ne++)if(void 0!==Ie[Ne].yLabelMid){Re=Ie[Ne];break}for(Ne=0;Ne<Pe.length;Ne++){var wt=Ne&&Pe[Ne-1];Re&&!Ne&&(wt=Re),ct(Pe[Ne],wt)}}}(J,B),ge=B,K.each(function(Te){var se=g.select(this);if(Te.labelExtraX||Te.labelExtraY){var de=se.select("g.slicetext text");Te.transform.targetX+=Te.labelExtraX,Te.transform.targetY+=Te.labelExtraY,r.setTransormAndDisplay(de,Te.transform);var Ae=Te.cxFinal+Te.pxmid[0],Le="M"+Ae+","+(Te.cyFinal+Te.pxmid[1]),Me=(Te.yLabelMax-Te.yLabelMin)*(Te.pxmid[0]<0?-1:1)/4;if(Te.labelExtraX){var De=Te.labelExtraX*Te.pxmid[1]/Te.pxmid[0],Oe=Te.yLabelMid+Te.labelExtraY-(Te.cyFinal+Te.pxmid[1]);Math.abs(De)>Math.abs(Oe)?Le+="l"+Oe*Te.pxmid[0]/Te.pxmid[1]+","+Oe+"H"+(Ae+Te.labelExtraX+Me):Le+="l"+Te.labelExtraX+","+De+"v"+(Oe-De)+"h"+Me}else Le+="V"+(Te.yLabelMid+Te.labelExtraY)+"h"+Me;r.ensureSingle(se,"path","textline").call(x.stroke,ge.outsidetextfont.color).attr({"stroke-width":Math.min(2,ge.outsidetextfont.size/8),d:Le,fill:"none"})}else se.select("path.textline").remove()}),te&&B.automargin){var ce=e.bBox(U.node()),oe=B.domain,xe=(ne.w*(oe.x[1]-oe.x[0])*.5-ee.r)/ne.w,Se=(ne.h*(oe.y[1]-oe.y[0])*.5-ee.r)/ne.h;t.autoMargin(Z,"pie."+B.uid+".automargin",{xl:oe.x[0]-xe,xr:oe.x[1]+xe,yb:oe.y[0]-Se,yt:oe.y[1]+Se,l:Math.max(ee.cx-ee.r-ce.left,0),r:Math.max(ce.right-(ee.cx+ee.r),0),b:Math.max(ce.bottom-(ee.cy+ee.r),0),t:Math.max(ee.cy-ee.r-ce.top,0),pad:5})}})});setTimeout(function(){V.selectAll("tspan").each(function(){var N=g.select(this);N.attr("dy")&&N.attr("dy",N.attr("dy"))})},0)},formatSliceLabel:j,transformInsideText:h,determineInsideTextFont:a,positionTitleOutside:z,prerenderTitles:y,layoutAreas:R,attachFxHandlers:u,computeTransform:q}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("./style_one"),k=v("../bar/uniform_text").resizeText;Q.exports=function(x){var e=x._fullLayout._pielayer.selectAll(".trace");k(x,e,"pie"),e.each(function(r){var i=r[0].trace,c=g.select(this);c.style({opacity:i.opacity}),c.selectAll("path.surface").each(function(n){g.select(this).call(t,n,i)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("./helpers").castOption;Q.exports=function(k,x,e){var r=e.marker.line,i=t(r.color,x.pts)||g.defaultLine,c=t(r.width,x.pts)||0;k.style("stroke-width",c).call(g.fill,x.color).call(g.stroke,i)}},{"../../components/color":367,"./helpers":915}],922:[function(v,Q,$){"use strict";var g=v("../scatter/attributes");Q.exports={x:g.x,y:g.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:g.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_pointcloud2d,t=v("../../lib/str2rgbarray"),k=v("../../plots/cartesian/autorange").findExtremes,x=v("../scatter/get_trace_color");function e(i,c){this.scene=i,this.uid=c,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=g(i.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var r=e.prototype;r.handlePick=function(i){var c=this.idToIndex[i.pointId];return{trace:this,dataCoord:i.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*c],this.pickXYData[2*c+1]]:[this.pickXData[c],this.pickYData[c]],textLabel:Array.isArray(this.textLabels)?this.textLabels[c]:this.textLabels,color:this.color,name:this.name,pointIndex:c,hoverinfo:this.hoverinfo}},r.update=function(i){this.index=i.index,this.textLabels=i.text,this.name=i.name,this.hoverinfo=i.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(i),this.color=x(i,{})},r.updateFast=function(i){var c,n,m,p,s,f,l=this.xData=this.pickXData=i.x,o=this.yData=this.pickYData=i.y,d=this.pickXYData=i.xy,a=i.indices,y=this.bounds;if(d){if(m=d,c=d.length>>>1,i.xbounds&&i.ybounds)y[0]=i.xbounds[0],y[2]=i.xbounds[1],y[1]=i.ybounds[0],y[3]=i.ybounds[1];else for(f=0;f<c;f++)s=m[2*f+1],(p=m[2*f])<y[0]&&(y[0]=p),p>y[2]&&(y[2]=p),s<y[1]&&(y[1]=s),s>y[3]&&(y[3]=s);if(a)n=a;else for(n=new Int32Array(c),f=0;f<c;f++)n[f]=f}else for(c=l.length,m=new Float32Array(2*c),n=new Int32Array(c),f=0;f<c;f++)p=l[f],s=o[f],n[f]=f,m[2*f]=p,m[2*f+1]=s,p<y[0]&&(y[0]=p),p>y[2]&&(y[2]=p),s<y[1]&&(y[1]=s),s>y[3]&&(y[3]=s);this.idToIndex=n,this.pointcloudOptions.idToIndex=n,this.pointcloudOptions.positions=m;var h=t(i.marker.color),_=t(i.marker.border.color),b=i.opacity*i.marker.opacity;h[3]*=b,this.pointcloudOptions.color=h;var w=i.marker.blend;null===w&&(w=l.length<100||o.length<100),this.pointcloudOptions.blend=w,_[3]*=b,this.pointcloudOptions.borderColor=_;var T=i.marker.sizemin,L=Math.max(i.marker.sizemax,i.marker.sizemin);this.pointcloudOptions.sizeMin=T,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=i.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var M=this.scene.xaxis,P=this.scene.yaxis,z=L/2||.5;i._extremes[M._id]=k(M,[y[0],y[2]],{ppad:z}),i._extremes[P._id]=k(P,[y[1],y[3]],{ppad:z})},r.dispose=function(){this.pointcloud.dispose()},Q.exports=function(i,c){var n=new e(i,c.uid);return n.update(c),n}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes");Q.exports=function(k,x,e){function r(i,c){return g.coerce(k,x,t,i,c)}r("x"),r("y"),r("xbounds"),r("ybounds"),k.xy&&k.xy instanceof Float32Array&&(x.xy=k.xy),k.indices&&k.indices instanceof Int32Array&&(x.indices=k.indices),r("text"),r("marker.color",e),r("marker.opacity"),r("marker.blend"),r("marker.sizemin"),r("marker.sizemax"),r("marker.border.color",e),r("marker.border.arearatio"),x._length=null}},{"../../lib":515,"./attributes":922}],925:[function(v,Q,$){"use strict";["*pointcloud* trace is deprecated!","Please consider switching to the *scattergl* trace type."].join(" "),Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("../scatter3d/calc"),plot:v("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:v("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(v,Q,$){"use strict";var g=v("../../plots/font_attributes"),t=v("../../plots/attributes"),k=v("../../components/color/attributes"),x=v("../../components/fx/attributes"),e=v("../../plots/domain").attributes,r=v("../../plots/template_attributes").hovertemplateAttrs,i=v("../../components/colorscale/attributes"),c=v("../../plot_api/plot_template").templatedArray,n=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,m=v("../../lib/extend").extendFlat,p=v("../../plot_api/edit_types").overrideAll;(Q.exports=p({hoverinfo:m({},t.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:x.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:n("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:g({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:k.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:x.hoverlabel,hovertemplate:r({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:k.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:x.hoverlabel,hovertemplate:r({},{keys:["value","label"]}),colorscales:c("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:m(i().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(v,Q,$){"use strict";var g=v("../../plot_api/edit_types").overrideAll,t=v("../../plots/get_data").getModuleCalcData,k=v("./plot"),x=v("../../components/fx/layout_attributes"),e=v("../../lib/setcursor"),r=v("../../components/dragelement"),i=v("../../components/selections").prepSelect,c=v("../../lib"),n=v("../../registry");function m(p,s){var f=p._fullData[s],l=p._fullLayout,o=l.dragmode,u=f._bgRect;if(u&&"pan"!==o&&"zoom"!==o){e(u,"pan"===l.dragmode?"move":"crosshair");var a={_id:"x",c2p:c.identity,_offset:f._sankey.translateX,_length:f._sankey.width},y={_id:"y",c2p:c.identity,_offset:f._sankey.translateY,_length:f._sankey.height},h={gd:p,element:u.node(),plotinfo:{id:s,xaxis:a,yaxis:y,fillRangeItems:c.noop},subplot:s,xaxes:[a],yaxes:[y],doneFnCompleted:function(_){var b,w=p._fullData[s],T=w.node.groups.slice(),L=[];function M(C){for(var R=w._sankey.graph.nodes,D=0;D<R.length;D++)if(R[D].pointNumber===C)return R[D]}for(var P=0;P<_.length;P++){var z=M(_[P].pointNumber);if(z)if(z.group){for(var S=0;S<z.childrenNodes.length;S++)L.push(z.childrenNodes[S].pointNumber);T[z.pointNumber-w.node._count]=!1}else L.push(z.pointNumber)}b=T.filter(Boolean).concat([L]),n.call("_guiRestyle",p,{"node.groups":[b]},s)},prepFn:function(_,b,w){i(_,b,w,h,o)}};r.init(h)}}$.name="sankey",$.baseLayoutAttrOverrides=g({hoverlabel:x.hoverlabel},"plot","nested"),$.plot=function(p){var s=t(p.calcdata,"sankey")[0];k(p,s),$.updateFx(p)},$.clean=function(p,s,f,l){var o=l._has&&l._has("sankey"),d=s._has&&s._has("sankey");o&&!d&&(l._paperdiv.selectAll(".sankey").remove(),l._paperdiv.selectAll(".bgsankey").remove())},$.updateFx=function(p){for(var s=0;s<p._fullData.length;s++)m(p,s)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(v,Q,$){"use strict";var g=v("strongly-connected-components"),t=v("../../lib"),k=v("../../lib/gup").wrap,x=t.isArrayOrTypedArray,e=t.isIndex,r=v("../../components/colorscale");Q.exports=function(c,n){var m=function i(c){var n,m=c.node,p=c.link,s=[],f=x(p.color),l=x(p.customdata),o={},d={},u=p.colorscales.length;for(n=0;n<u;n++){var a=p.colorscales[n],y=r.extractScale(a,{cLetter:"c"}),h=r.makeColorScaleFunc(y);d[a.label]=h}var _=0;for(n=0;n<p.value.length;n++)p.source[n]>_&&(_=p.source[n]),p.target[n]>_&&(_=p.target[n]);var b,w=_+1;c.node._count=w;var T=c.node.groups,L={};for(n=0;n<T.length;n++){var M=T[n];for(b=0;b<M.length;b++){var P=M[b],z=w+n;L.hasOwnProperty(P)?t.warn("Node "+P+" is already part of a group."):L[P]=z}}var S={source:[],target:[]};for(n=0;n<p.value.length;n++){var C=p.value[n],R=p.source[n],D=p.target[n];if(C>0&&e(R,w)&&e(D,w)&&(!L.hasOwnProperty(R)||!L.hasOwnProperty(D)||L[R]!==L[D])){L.hasOwnProperty(D)&&(D=L[D]),L.hasOwnProperty(R)&&(R=L[R]),o[R=+R]=o[D=+D]=!0;var j="";p.label&&p.label[n]&&(j=p.label[n]);var q=null;j&&d.hasOwnProperty(j)&&(q=d[j]),s.push({pointNumber:n,label:j,color:f?p.color[n]:p.color,customdata:l?p.customdata[n]:p.customdata,concentrationscale:q,source:R,target:D,value:+C}),S.source.push(R),S.target.push(D)}}var Z=w+T.length,W=x(m.color),G=x(m.customdata),X=[];for(n=0;n<Z;n++)o[n]&&X.push({group:n>w-1,childrenNodes:[],pointNumber:n,label:m.label[n],color:W?m.color[n]:m.color,customdata:G?m.customdata[n]:m.customdata});var V=!1;return function(N,U,ee){for(var B=t.init2dArray(N,0),K=0;K<Math.min(U.length,ee.length);K++)if(t.isIndex(U[K],N)&&t.isIndex(ee[K],N)){if(U[K]===ee[K])return!0;B[U[K]].push(ee[K])}return g(B).components.some(function(J){return J.length>1})}(Z,S.source,S.target)&&(V=!0),{circular:V,links:s,nodes:X,groups:T,groupLookup:L}}(n);return k({circular:m.circular,_nodes:m.nodes,_links:m.links,_groups:m.groups,_groupLookup:m.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(v,Q,$){"use strict";Q.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../components/color"),x=v("tinycolor2"),e=v("../../plots/domain").defaults,r=v("../../components/fx/hoverlabel_defaults"),i=v("../../plot_api/plot_template"),c=v("../../plots/array_container_defaults");function n(m,p){function s(f,l){return g.coerce(m,p,t.link.colorscales,f,l)}s("label"),s("cmin"),s("cmax"),s("colorscale")}Q.exports=function(m,p,s,f){function l(L,M){return g.coerce(m,p,t,L,M)}var o=g.extendDeep(f.hoverlabel,m.hoverlabel),d=m.node,u=i.newContainer(p,"node");function a(L,M){return g.coerce(d,u,t.node,L,M)}a("label"),a("groups"),a("x"),a("y"),a("pad"),a("thickness"),a("line.color"),a("line.width"),a("hoverinfo",m.hoverinfo),r(d,u,a,o),a("hovertemplate");var y=f.colorway;a("color",u.label.map(function(L,M){return k.addOpacity(y[M%y.length],.8)})),a("customdata");var h=m.link||{},_=i.newContainer(p,"link");function b(L,M){return g.coerce(h,_,t.link,L,M)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",m.hoverinfo),r(h,_,b,o),b("hovertemplate");var w,T=x(f.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",g.repeat(T,_.value.length)),b("customdata"),c(h,_,{name:"colorscales",handleItemDefaults:n}),e(p,f,l),l("orientation"),l("valueformat"),l("valuesuffix"),u.x.length&&u.y.length&&(w="freeform"),l("arrangement",w),g.coerceFont(l,"textfont",g.extendFlat({},f.font)),p._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),moduleType:"trace",name:"sankey",basePlotModule:v("./base_plot"),selectPoints:v("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=t.numberFormat,x=v("./render"),e=v("../../components/fx"),r=v("../../components/color"),i=v("./constants").cn,c=t._;function n(h){return""!==h}function m(h,_){return h.filter(function(b){return b.key===_.traceId})}function p(h,_){g.select(h).select("path").style("fill-opacity",_),g.select(h).select("rect").style("fill-opacity",_)}function s(h){g.select(h).select("text.name").style("fill","black")}function f(h){return function(_){return-1!==h.node.sourceLinks.indexOf(_.link)||-1!==h.node.targetLinks.indexOf(_.link)}}function l(h){return function(_){return-1!==_.node.sourceLinks.indexOf(h.link)||-1!==_.node.targetLinks.indexOf(h.link)}}function o(h,_,b){_&&b&&m(b,_).selectAll("."+i.sankeyLink).filter(f(_)).call(u.bind(0,_,b,!1))}function d(h,_,b){_&&b&&m(b,_).selectAll("."+i.sankeyLink).filter(f(_)).call(a.bind(0,_,b,!1))}function u(h,_,b,w){var T=w.datum().link.label;w.style("fill-opacity",function(L){if(!L.link.concentrationscale)return.4}),T&&m(_,h).selectAll("."+i.sankeyLink).filter(function(L){return L.link.label===T}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return.4}),b&&m(_,h).selectAll("."+i.sankeyNode).filter(l(h)).call(o)}function a(h,_,b,w){var T=w.datum().link.label;w.style("fill-opacity",function(L){return L.tinyColorAlpha}),T&&m(_,h).selectAll("."+i.sankeyLink).filter(function(L){return L.link.label===T}).style("fill-opacity",function(L){return L.tinyColorAlpha}),b&&m(_,h).selectAll(i.sankeyNode).filter(l(h)).call(d)}function y(h,_){var w=t.nestedProperty(h.hoverlabel||{},_).get();return!Array.isArray(w)&&w}Q.exports=function(h,_){for(var b=h._fullLayout,w=b._paper,T=b._size,L=0;L<h._fullData.length;L++)if(h._fullData[L].visible&&h._fullData[L].type===i.sankey&&!h._fullData[L]._viewInitial){var M=h._fullData[L].node;h._fullData[L]._viewInitial={node:{groups:M.groups.slice(),x:M.x.slice(),y:M.y.slice()}}}var P=c(h,"source:")+" ",z=c(h,"target:")+" ",S=c(h,"concentration:")+" ",C=c(h,"incoming flow count:")+" ",R=c(h,"outgoing flow count:")+" ";x(h,w,_,{width:T.w,height:T.h,margin:{t:T.t,r:T.r,b:T.b,l:T.l}},{linkEvents:{hover:function(D,j,q){!1!==h._fullLayout.hovermode&&(g.select(D).call(u.bind(0,j,q,!0)),"skip"!==j.link.trace.link.hoverinfo&&(j.link.fullData=j.link.trace,h.emit("plotly_hover",{event:g.event,points:[j.link]})))},follow:function(D,j){if(!1!==h._fullLayout.hovermode){var q=j.link.trace.link;if("none"!==q.hoverinfo&&"skip"!==q.hoverinfo){for(var Z=[],W=0,G=0;G<j.flow.links.length;G++){var X=j.flow.links[G];if("closest"!==h._fullLayout.hovermode||j.link.pointNumber===X.pointNumber){j.link.pointNumber===X.pointNumber&&(W=G),X.fullData=X.trace,q=j.link.trace.link;var ne=N(X),V={valueLabel:k(j.valueFormat)(X.value)+j.valueSuffix};Z.push({x:ne[0],y:ne[1],name:V.valueLabel,text:[X.label||"",P+X.source.label,z+X.target.label,X.concentrationscale?S+k("%0.2f")(X.flow.labelConcentration):""].filter(n).join("<br>"),color:y(q,"bgcolor")||r.addOpacity(X.color,1),borderColor:y(q,"bordercolor"),fontFamily:y(q,"font.family"),fontSize:y(q,"font.size"),fontColor:y(q,"font.color"),nameLength:y(q,"namelength"),textAlign:y(q,"align"),idealAlign:g.event.x<ne[0]?"right":"left",hovertemplate:q.hovertemplate,hovertemplateLabels:V,eventData:[X]})}}e.loneHover(Z,{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:h,anchorIndex:W}).each(function(){j.link.concentrationscale||p(this,.65),s(this)})}}function N(U){var ee,B;U.circular?(ee=(U.circularPathData.leftInnerExtent+U.circularPathData.rightInnerExtent)/2,B=U.circularPathData.verticalFullExtent):(ee=(U.source.x1+U.target.x0)/2,B=(U.y0+U.y1)/2);var K=[ee,B];return"v"===U.trace.orientation&&K.reverse(),K[0]+=j.parent.translateX,K[1]+=j.parent.translateY,K}},unhover:function(D,j,q){!1!==h._fullLayout.hovermode&&(g.select(D).call(a.bind(0,j,q,!0)),"skip"!==j.link.trace.link.hoverinfo&&(j.link.fullData=j.link.trace,h.emit("plotly_unhover",{event:g.event,points:[j.link]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j){var q=j.link;q.originalEvent=g.event,h._hoverdata=[q],e.click(h,{target:!0})}},nodeEvents:{hover:function(D,j,q){!1!==h._fullLayout.hovermode&&(g.select(D).call(o,j,q),"skip"!==j.node.trace.node.hoverinfo&&(j.node.fullData=j.node.trace,h.emit("plotly_hover",{event:g.event,points:[j.node]})))},follow:function(D,j){if(!1!==h._fullLayout.hovermode){var q=j.node.trace.node;if("none"!==q.hoverinfo&&"skip"!==q.hoverinfo){var Z=g.select(D).select("."+i.nodeRect),W=h._fullLayout._paperdiv.node().getBoundingClientRect(),G=Z.node().getBoundingClientRect(),X=G.left-2-W.left,ne=G.right+2-W.left,V=G.top+G.height/4-W.top,N={valueLabel:k(j.valueFormat)(j.node.value)+j.valueSuffix};j.node.fullData=j.node.trace,h._fullLayout._calcInverseTransform(h);var U=h._fullLayout._invScaleX,B=e.loneHover({x0:U*X,x1:U*ne,y:h._fullLayout._invScaleY*V,name:k(j.valueFormat)(j.node.value)+j.valueSuffix,text:[j.node.label,C+j.node.targetLinks.length,R+j.node.sourceLinks.length].filter(n).join("<br>"),color:y(q,"bgcolor")||j.tinyColorHue,borderColor:y(q,"bordercolor"),fontFamily:y(q,"font.family"),fontSize:y(q,"font.size"),fontColor:y(q,"font.color"),nameLength:y(q,"namelength"),textAlign:y(q,"align"),idealAlign:"left",hovertemplate:q.hovertemplate,hovertemplateLabels:N,eventData:[j.node]},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:h});p(B,.85),s(B)}}},unhover:function(D,j,q){!1!==h._fullLayout.hovermode&&(g.select(D).call(d,j,q),"skip"!==j.node.trace.node.hoverinfo&&(j.node.fullData=j.node.trace,h.emit("plotly_unhover",{event:g.event,points:[j.node]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j,q){var Z=j.node;Z.originalEvent=g.event,h._hoverdata=[Z],g.select(D).call(d,j,q),e.click(h,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(v,Q,$){"use strict";var g=v("d3-force"),t=v("d3-interpolate").interpolateNumber,k=v("@plotly/d3"),x=v("@plotly/d3-sankey"),e=v("@plotly/d3-sankey-circular"),r=v("./constants"),i=v("tinycolor2"),c=v("../../components/color"),n=v("../../components/drawing"),m=v("../../lib"),p=m.strTranslate,s=m.strRotate,f=v("../../lib/gup"),l=f.keyFun,o=f.repeat,d=f.unwrap,u=v("../../lib/svg_text_utils"),a=v("../../registry"),y=v("../../constants/alignment"),h=y.CAP_SHIFT,_=y.LINE_SPACING;function b(G,X,ne){var V,N=d(X),U=N.trace,ee=U.domain,B="h"===U.orientation,K=U.node.pad,J=U.node.thickness,te=G.width*(ee.x[1]-ee.x[0]),ae=G.height*(ee.y[1]-ee.y[0]),ce=N._nodes,oe=N._links,ve=N.circular;(V=ve?e.sankeyCircular().circularLinkGap(0):x.sankey()).iterations(r.sankeyIterations).size(B?[te,ae]:[ae,te]).nodeWidth(J).nodePadding(K).nodeId(function(Me){return Me.pointNumber}).nodes(ce).links(oe);var fe,xe,Se,pe=V();for(var ge in V.nodePadding()<K&&m.warn("node.pad was reduced to ",V.nodePadding()," to fit within the figure."),N._groupLookup){var Te,se=parseInt(N._groupLookup[ge]);for(fe=0;fe<pe.nodes.length;fe++)if(pe.nodes[fe].pointNumber===se){Te=pe.nodes[fe];break}if(Te){var de={pointNumber:parseInt(ge),x0:Te.x0,x1:Te.x1,y0:Te.y0,y1:Te.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};pe.nodes.unshift(de),Te.childrenNodes.unshift(de)}}if(function(){for(fe=0;fe<pe.nodes.length;fe++){var Me,De,Oe=pe.nodes[fe],Ie={};for(xe=0;xe<Oe.targetLinks.length;xe++)Me=(De=Oe.targetLinks[xe]).source.pointNumber+":"+De.target.pointNumber,Ie.hasOwnProperty(Me)||(Ie[Me]=[]),Ie[Me].push(De);var Qe=Object.keys(Ie);for(xe=0;xe<Qe.length;xe++){var Ne=Ie[Me=Qe[xe]],Pe=0,Re={};for(Se=0;Se<Ne.length;Se++)Re[(De=Ne[Se]).label]||(Re[De.label]=0),Re[De.label]+=De.value,Pe+=De.value;for(Se=0;Se<Ne.length;Se++)(De=Ne[Se]).flow={value:Pe,labelConcentration:Re[De.label]/Pe,concentration:De.value/Pe,links:Ne},De.concentrationscale&&(De.color=i(De.concentrationscale(De.flow.labelConcentration)))}var Ge=0;for(xe=0;xe<Oe.sourceLinks.length;xe++)Ge+=Oe.sourceLinks[xe].value;for(xe=0;xe<Oe.sourceLinks.length;xe++)(De=Oe.sourceLinks[xe]).concentrationOut=De.value/Ge;var tt=0;for(xe=0;xe<Oe.targetLinks.length;xe++)tt+=Oe.targetLinks[xe].value;for(xe=0;xe<Oe.targetLinks.length;xe++)(De=Oe.targetLinks[xe]).concenrationIn=De.value/tt}}(),U.node.x.length&&U.node.y.length){for(fe=0;fe<Math.min(U.node.x.length,U.node.y.length,pe.nodes.length);fe++)if(U.node.x[fe]&&U.node.y[fe]){var Ae=[U.node.x[fe]*te,U.node.y[fe]*ae];pe.nodes[fe].x0=Ae[0]-J/2,pe.nodes[fe].x1=Ae[0]+J/2;var Le=pe.nodes[fe].y1-pe.nodes[fe].y0;pe.nodes[fe].y0=Ae[1]-Le/2,pe.nodes[fe].y1=Ae[1]+Le/2}"snap"===U.arrangement&&function(Me){var De,Oe,Ie=Me.map(function(Ge,tt){return{x0:Ge.x0,index:tt}}).sort(function(Ge,tt){return Ge.x0-tt.x0}),Qe=[],Ne=-1,Pe=-1/0;for(fe=0;fe<Ie.length;fe++){var Re=Me[Ie[fe].index];Re.x0>Pe+J&&(Ne+=1,De=Re.x0),Pe=Re.x0,Qe[Ne]||(Qe[Ne]=[]),Qe[Ne].push(Re),Re.x0+=Oe=De-Re.x0,Re.x1+=Oe}return Qe}(ce=pe.nodes).forEach(function(De){var Oe,Ie,Qe,Ne=0,Pe=De.length;for(De.sort(function(Re,Ge){return Re.y0-Ge.y0}),Qe=0;Qe<Pe;++Qe)(Oe=De[Qe]).y0>=Ne||(Ie=Ne-Oe.y0)>1e-6&&(Oe.y0+=Ie,Oe.y1+=Ie),Ne=Oe.y1+K}),V.update(pe)}return{circular:ve,key:ne,trace:U,guid:m.randstr(),horizontal:B,width:te,height:ae,nodePad:U.node.pad,nodeLineColor:U.node.line.color,nodeLineWidth:U.node.line.width,linkLineColor:U.link.line.color,linkLineWidth:U.link.line.width,linkArrowLength:U.link.arrowlen,valueFormat:U.valueformat,valueSuffix:U.valuesuffix,textFont:U.textfont,translateX:ee.x[0]*G.width+G.margin.l,translateY:G.height-ee.y[1]*G.height+G.margin.t,dragParallel:B?ae:te,dragPerpendicular:B?te:ae,arrangement:U.arrangement,sankey:V,graph:pe,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function w(G,X,ne){var V=i(X.color),N=X.source.label+"|"+X.target.label+"__"+ne;return X.trace=G.trace,X.curveNumber=G.trace.index,{circular:G.circular,key:N,traceId:G.key,pointNumber:X.pointNumber,link:X,tinyColorHue:c.tinyRGB(V),tinyColorAlpha:V.getAlpha(),linkPath:T,linkLineColor:G.linkLineColor,linkLineWidth:G.linkLineWidth,linkArrowLength:G.linkArrowLength,valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,parent:G,interactionState:G.interactionState,flow:X.flow}}function T(){return function(G){var xe,Se,pe,ge,X=G.linkArrowLength;if(G.link.circular)return Se=X,pe=(xe=G.link).width/2,ge=xe.circularPathData,"top"===xe.circularLinkType?"M "+(ge.targetX-Se)+" "+(ge.targetY+pe)+" L"+(ge.rightInnerExtent-Se)+" "+(ge.targetY+pe)+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightSmallArcRadius+pe)+" 0 0 1 "+(ge.rightFullExtent-pe-Se)+" "+(ge.targetY-ge.rightSmallArcRadius)+"L"+(ge.rightFullExtent-pe-Se)+" "+ge.verticalRightInnerExtent+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightLargeArcRadius+pe)+" 0 0 1 "+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent-pe)+"L"+ge.leftInnerExtent+" "+(ge.verticalFullExtent-pe)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftLargeArcRadius+pe)+" 0 0 1 "+(ge.leftFullExtent+pe)+" "+ge.verticalLeftInnerExtent+"L"+(ge.leftFullExtent+pe)+" "+(ge.sourceY-ge.leftSmallArcRadius)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftSmallArcRadius+pe)+" 0 0 1 "+ge.leftInnerExtent+" "+(ge.sourceY+pe)+"L"+ge.sourceX+" "+(ge.sourceY+pe)+"L"+ge.sourceX+" "+(ge.sourceY-pe)+"L"+ge.leftInnerExtent+" "+(ge.sourceY-pe)+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftSmallArcRadius-pe)+" 0 0 0 "+(ge.leftFullExtent-pe)+" "+(ge.sourceY-ge.leftSmallArcRadius)+"L"+(ge.leftFullExtent-pe)+" "+ge.verticalLeftInnerExtent+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftLargeArcRadius-pe)+" 0 0 0 "+ge.leftInnerExtent+" "+(ge.verticalFullExtent+pe)+"L"+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent+pe)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightLargeArcRadius-pe)+" 0 0 0 "+(ge.rightFullExtent+pe-Se)+" "+ge.verticalRightInnerExtent+"L"+(ge.rightFullExtent+pe-Se)+" "+(ge.targetY-ge.rightSmallArcRadius)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightSmallArcRadius-pe)+" 0 0 0 "+(ge.rightInnerExtent-Se)+" "+(ge.targetY-pe)+"L"+(ge.targetX-Se)+" "+(ge.targetY-pe)+(Se>0?"L"+ge.targetX+" "+ge.targetY:"")+"Z":"M "+(ge.targetX-Se)+" "+(ge.targetY-pe)+" L"+(ge.rightInnerExtent-Se)+" "+(ge.targetY-pe)+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightSmallArcRadius+pe)+" 0 0 0 "+(ge.rightFullExtent-pe-Se)+" "+(ge.targetY+ge.rightSmallArcRadius)+"L"+(ge.rightFullExtent-pe-Se)+" "+ge.verticalRightInnerExtent+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightLargeArcRadius+pe)+" 0 0 0 "+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent+pe)+"L"+ge.leftInnerExtent+" "+(ge.verticalFullExtent+pe)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftLargeArcRadius+pe)+" 0 0 0 "+(ge.leftFullExtent+pe)+" "+ge.verticalLeftInnerExtent+"L"+(ge.leftFullExtent+pe)+" "+(ge.sourceY+ge.leftSmallArcRadius)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftSmallArcRadius+pe)+" 0 0 0 "+ge.leftInnerExtent+" "+(ge.sourceY-pe)+"L"+ge.sourceX+" "+(ge.sourceY-pe)+"L"+ge.sourceX+" "+(ge.sourceY+pe)+"L"+ge.leftInnerExtent+" "+(ge.sourceY+pe)+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftSmallArcRadius-pe)+" 0 0 1 "+(ge.leftFullExtent-pe)+" "+(ge.sourceY+ge.leftSmallArcRadius)+"L"+(ge.leftFullExtent-pe)+" "+ge.verticalLeftInnerExtent+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftLargeArcRadius-pe)+" 0 0 1 "+ge.leftInnerExtent+" "+(ge.verticalFullExtent-pe)+"L"+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent-pe)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightLargeArcRadius-pe)+" 0 0 1 "+(ge.rightFullExtent+pe-Se)+" "+ge.verticalRightInnerExtent+"L"+(ge.rightFullExtent+pe-Se)+" "+(ge.targetY+ge.rightSmallArcRadius)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightSmallArcRadius-pe)+" 0 0 1 "+(ge.rightInnerExtent-Se)+" "+(ge.targetY+pe)+"L"+(ge.targetX-Se)+" "+(ge.targetY+pe)+(Se>0?"L"+ge.targetX+" "+ge.targetY:"")+"Z";var ne=Math.abs((G.link.target.x0-G.link.source.x1)/2);X>ne&&(X=ne);var V=G.link.source.x1,N=G.link.target.x0-X,U=t(V,N),ee=U(.5),B=U(.5),K=G.link.y0-G.link.width/2,J=G.link.y0+G.link.width/2,te=G.link.y1-G.link.width/2,ae=G.link.y1+G.link.width/2,fe=X>0?"L"+(N+X)+","+(te+G.link.width/2):"";return"M"+V+","+K+"C"+ee+","+K+" "+B+","+te+" "+N+","+te+(fe+="L"+N+","+ae)+"C"+B+","+ae+" "+ee+","+J+" "+V+","+J+"Z"}}function L(G,X){var ne=i(X.color),V=r.nodePadAcross,N=G.nodePad/2;X.dx=X.x1-X.x0,X.dy=X.y1-X.y0;var U=X.dx,ee=Math.max(.5,X.dy),B="node_"+X.pointNumber;return X.group&&(B=m.randstr()),X.trace=G.trace,X.curveNumber=G.trace.index,{index:X.pointNumber,key:B,partOfGroup:X.partOfGroup||!1,group:X.group,traceId:G.key,trace:G.trace,node:X,nodePad:G.nodePad,nodeLineColor:G.nodeLineColor,nodeLineWidth:G.nodeLineWidth,textFont:G.textFont,size:G.horizontal?G.height:G.width,visibleWidth:Math.ceil(U),visibleHeight:ee,zoneX:-V,zoneY:-N,zoneWidth:U+2*V,zoneHeight:ee+2*N,labelY:G.horizontal?X.dy/2+1:X.dx/2+1,left:1===X.originalLayer,sizeAcross:G.width,forceLayouts:G.forceLayouts,horizontal:G.horizontal,darkBackground:ne.getBrightness()<=128,tinyColorHue:c.tinyRGB(ne),tinyColorAlpha:ne.getAlpha(),valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,graph:G.graph,arrangement:G.arrangement,uniqueNodeLabelPathId:[G.guid,G.key,B].join("_"),interactionState:G.interactionState,figure:G}}function M(G){G.attr("transform",function(X){return p(X.node.x0.toFixed(3),X.node.y0.toFixed(3))})}function P(G){G.call(M)}function z(G,X){G.call(P),X.attr("d",T())}function S(G){G.attr("width",function(X){return X.node.x1-X.node.x0}).attr("height",function(X){return X.visibleHeight})}function C(G){return G.link.width>1||G.linkLineWidth>0}function R(G){return p(G.translateX,G.translateY)+(G.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function D(G,X,ne){G.on(".basic",null).on("mouseover.basic",function(V){V.interactionState.dragInProgress||V.partOfGroup||(ne.hover(this,V,X),V.interactionState.hovered=[this,V])}).on("mousemove.basic",function(V){V.interactionState.dragInProgress||V.partOfGroup||(ne.follow(this,V),V.interactionState.hovered=[this,V])}).on("mouseout.basic",function(V){V.interactionState.dragInProgress||V.partOfGroup||(ne.unhover(this,V,X),V.interactionState.hovered=!1)}).on("click.basic",function(V){V.interactionState.hovered&&(ne.unhover(this,V,X),V.interactionState.hovered=!1),V.interactionState.dragInProgress||V.partOfGroup||ne.select(this,V,X)})}function j(G,X,ne,V){var N=k.behavior.drag().origin(function(U){return{x:U.node.x0+U.visibleWidth/2,y:U.node.y0+U.visibleHeight/2}}).on("dragstart",function(U){if("fixed"!==U.arrangement&&(m.ensureSingle(V._fullLayout._infolayer,"g","dragcover",function(B){V._fullLayout._dragCover=B}),m.raiseToTop(this),U.interactionState.dragInProgress=U.node,Z(U.node),U.interactionState.hovered&&(ne.nodeEvents.unhover.apply(0,U.interactionState.hovered),U.interactionState.hovered=!1),"snap"===U.arrangement)){var ee=U.traceId+"|"+U.key;U.forceLayouts[ee]?U.forceLayouts[ee].alpha(1):function(B,K,J,te){!function(ce){for(var oe=0;oe<ce.length;oe++)ce[oe].y=(ce[oe].y0+ce[oe].y1)/2,ce[oe].x=(ce[oe].x0+ce[oe].x1)/2}(J.graph.nodes);var oe,ve,fe,ae=J.graph.nodes.filter(function(ce){return ce.originalX===J.node.originalX}).filter(function(ce){return!ce.partOfGroup});J.forceLayouts[K]=g.forceSimulation(ae).alphaDecay(0).force("collide",g.forceCollide().radius(function(ce){return ce.dy/2+J.nodePad/2}).strength(1).iterations(r.forceIterations)).force("constrain",(oe=K,ve=ae,fe=J,function(){for(var xe=0,Se=0;Se<ve.length;Se++){var pe=ve[Se];pe===fe.interactionState.dragInProgress?(pe.x=pe.lastDraggedX,pe.y=pe.lastDraggedY):(pe.vx=(pe.originalX-pe.x)/r.forceTicksPerFrame,pe.y=Math.min(fe.size-pe.dy/2,Math.max(pe.dy/2,pe.y))),xe=Math.max(xe,Math.abs(pe.vx),Math.abs(pe.vy))}!fe.interactionState.dragInProgress&&xe<.1&&fe.forceLayouts[oe].alpha()>0&&fe.forceLayouts[oe].alpha(0)})).stop()}(0,ee,U),B=G,K=X,J=U,te=ee,ae=V,window.requestAnimationFrame(function ce(){var oe;for(oe=0;oe<r.forceTicksPerFrame;oe++)J.forceLayouts[te].tick();if(function(fe){for(var xe=0;xe<fe.length;xe++)fe[xe].y0=fe[xe].y-fe[xe].dy/2,fe[xe].y1=fe[xe].y0+fe[xe].dy,fe[xe].x0=fe[xe].x-fe[xe].dx/2,fe[xe].x1=fe[xe].x0+fe[xe].dx}(J.graph.nodes),J.sankey.update(J.graph),z(B.filter(W(J)),K),J.forceLayouts[te].alpha()>0)window.requestAnimationFrame(ce);else{var ve=J.node.originalX;J.node.x0=ve-J.visibleWidth/2,J.node.x1=ve+J.visibleWidth/2,q(J,ae)}})}var B,K,J,te,ae}).on("drag",function(U){if("fixed"!==U.arrangement){var ee=k.event.x,B=k.event.y;"snap"===U.arrangement?(U.node.x0=ee-U.visibleWidth/2,U.node.x1=ee+U.visibleWidth/2,U.node.y0=B-U.visibleHeight/2,U.node.y1=B+U.visibleHeight/2):("freeform"===U.arrangement&&(U.node.x0=ee-U.visibleWidth/2,U.node.x1=ee+U.visibleWidth/2),B=Math.max(0,Math.min(U.size-U.visibleHeight/2,B)),U.node.y0=B-U.visibleHeight/2,U.node.y1=B+U.visibleHeight/2),Z(U.node),"snap"!==U.arrangement&&(U.sankey.update(U.graph),z(G.filter(W(U)),X))}}).on("dragend",function(U){if("fixed"!==U.arrangement){U.interactionState.dragInProgress=!1;for(var ee=0;ee<U.node.childrenNodes.length;ee++)U.node.childrenNodes[ee].x=U.node.x,U.node.childrenNodes[ee].y=U.node.y;"snap"!==U.arrangement&&q(U,V)}});G.on(".drag",null).call(N)}function q(G,X){for(var ne=[],V=[],N=0;N<G.graph.nodes.length;N++){var ee=(G.graph.nodes[N].y0+G.graph.nodes[N].y1)/2;ne.push((G.graph.nodes[N].x0+G.graph.nodes[N].x1)/2/G.figure.width),V.push(ee/G.figure.height)}a.call("_guiRestyle",X,{"node.x":[ne],"node.y":[V]},G.trace.index).then(function(){X._fullLayout._dragCover&&X._fullLayout._dragCover.remove()})}function Z(G){G.lastDraggedX=G.x0+G.dx/2,G.lastDraggedY=G.y0+G.dy/2}function W(G){return function(X){return X.node.originalX===G.node.originalX}}Q.exports=function(G,X,ne,V,N){var U=G._context.staticPlot,ee=!1;m.ensureSingle(G._fullLayout._infolayer,"g","first-render",function(){ee=!0});var B=G._fullLayout._dragCover,K=ne.filter(function(xe){return d(xe).trace.visible}).map(b.bind(null,V)),J=X.selectAll("."+r.cn.sankey).data(K,l);J.exit().remove(),J.enter().append("g").classed(r.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",U?"none":"auto").attr("transform",R),J.each(function(xe,Se){G._fullData[Se]._sankey=xe;var pe="bgsankey-"+xe.trace.uid+"-"+Se;m.ensureSingle(G._fullLayout._draggers,"rect",pe),G._fullData[Se]._bgRect=k.select("."+pe),G._fullData[Se]._bgRect.style("pointer-events",U?"none":"all").attr("width",xe.width).attr("height",xe.height).attr("x",xe.translateX).attr("y",xe.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),J.transition().ease(r.ease).duration(r.duration).attr("transform",R);var te=J.selectAll("."+r.cn.sankeyLinks).data(o,l);te.enter().append("g").classed(r.cn.sankeyLinks,!0).style("fill","none");var ae=te.selectAll("."+r.cn.sankeyLink).data(function(xe){return xe.graph.links.filter(function(Se){return Se.value}).map(w.bind(null,xe))},l);ae.enter().append("path").classed(r.cn.sankeyLink,!0).call(D,J,N.linkEvents),ae.style("stroke",function(xe){return C(xe)?c.tinyRGB(i(xe.linkLineColor)):xe.tinyColorHue}).style("stroke-opacity",function(xe){return C(xe)?c.opacity(xe.linkLineColor):xe.tinyColorAlpha}).style("fill",function(xe){return xe.tinyColorHue}).style("fill-opacity",function(xe){return xe.tinyColorAlpha}).style("stroke-width",function(xe){return C(xe)?xe.linkLineWidth:1}).attr("d",T()),ae.style("opacity",function(){return G._context.staticPlot||ee||B?1:0}).transition().ease(r.ease).duration(r.duration).style("opacity",1),ae.exit().transition().ease(r.ease).duration(r.duration).style("opacity",0).remove();var ce=J.selectAll("."+r.cn.sankeyNodeSet).data(o,l);ce.enter().append("g").classed(r.cn.sankeyNodeSet,!0),ce.style("cursor",function(xe){switch(xe.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var oe=ce.selectAll("."+r.cn.sankeyNode).data(function(xe){var Se=xe.graph.nodes;return function(pe){var ge,Te=[];for(ge=0;ge<pe.length;ge++)pe[ge].originalX=(pe[ge].x0+pe[ge].x1)/2,pe[ge].originalY=(pe[ge].y0+pe[ge].y1)/2,-1===Te.indexOf(pe[ge].originalX)&&Te.push(pe[ge].originalX);for(Te.sort(function(se,de){return se-de}),ge=0;ge<pe.length;ge++)pe[ge].originalLayerIndex=Te.indexOf(pe[ge].originalX),pe[ge].originalLayer=pe[ge].originalLayerIndex/(Te.length-1)}(Se),Se.map(L.bind(null,xe))},l);oe.enter().append("g").classed(r.cn.sankeyNode,!0).call(M).style("opacity",function(xe){return!G._context.staticPlot&&!ee||xe.partOfGroup?0:1}),oe.call(D,J,N.nodeEvents).call(j,ae,N,G),oe.transition().ease(r.ease).duration(r.duration).call(M).style("opacity",function(xe){return xe.partOfGroup?0:1}),oe.exit().transition().ease(r.ease).duration(r.duration).style("opacity",0).remove();var ve=oe.selectAll("."+r.cn.nodeRect).data(o);ve.enter().append("rect").classed(r.cn.nodeRect,!0).call(S),ve.style("stroke-width",function(xe){return xe.nodeLineWidth}).style("stroke",function(xe){return c.tinyRGB(i(xe.nodeLineColor))}).style("stroke-opacity",function(xe){return c.opacity(xe.nodeLineColor)}).style("fill",function(xe){return xe.tinyColorHue}).style("fill-opacity",function(xe){return xe.tinyColorAlpha}),ve.transition().ease(r.ease).duration(r.duration).call(S);var fe=oe.selectAll("."+r.cn.nodeLabel).data(o);fe.enter().append("text").classed(r.cn.nodeLabel,!0).style("cursor","default"),fe.attr("data-notex",1).text(function(xe){return xe.node.label}).each(function(xe){var Se=k.select(this);n.font(Se,xe.textFont),u.convertToTspans(Se,G)}).style("text-shadow",u.makeTextShadow(G._fullLayout.paper_bgcolor)).attr("text-anchor",function(xe){return xe.horizontal&&xe.left?"end":"start"}).attr("transform",function(xe){var Se=k.select(this),pe=u.lineCount(Se),Te=xe.nodeLineWidth/2+3,se=((xe.horizontal?xe.visibleHeight:xe.visibleWidth)-xe.textFont.size*((pe-1)*_-h))/2;xe.horizontal&&(xe.left?Te=-Te:Te+=xe.visibleWidth);var de=xe.horizontal?"":"scale(-1,1)"+s(90);return p(xe.horizontal?Te:se,xe.horizontal?se:Te)+de}),fe.transition().ease(r.ease).duration(r.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(v,Q,$){"use strict";Q.exports=function(g,t){for(var k=[],x=g.cd[0].trace,e=x._sankey.graph.nodes,r=0;r<e.length;r++){var i=e[r];if(!i.partOfGroup){var c=[(i.x0+i.x1)/2,(i.y0+i.y1)/2];"v"===x.orientation&&c.reverse(),t&&t.contains(c,!1,r,g)&&k.push({pointNumber:i.pointNumber})}}return k}},{}],935:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){for(var x=0;x<t.length;x++)t[x].i=x;g.mergeArray(k.text,t,"tx"),g.mergeArray(k.texttemplate,t,"txt"),g.mergeArray(k.hovertext,t,"htx"),g.mergeArray(k.customdata,t,"data"),g.mergeArray(k.textposition,t,"tp"),k.textfont&&(g.mergeArrayCastPositive(k.textfont.size,t,"ts"),g.mergeArray(k.textfont.color,t,"tc"),g.mergeArray(k.textfont.family,t,"tf"));var e=k.marker;if(e){g.mergeArrayCastPositive(e.size,t,"ms"),g.mergeArrayCastPositive(e.opacity,t,"mo"),g.mergeArray(e.symbol,t,"mx"),g.mergeArray(e.angle,t,"ma"),g.mergeArray(e.standoff,t,"mf"),g.mergeArray(e.color,t,"mc");var r=e.line;e.line&&(g.mergeArray(r.color,t,"mlc"),g.mergeArrayCastPositive(r.width,t,"mlw"));var i=e.gradient;i&&"none"!==i.type&&(g.mergeArray(i.type,t,"mgt"),g.mergeArray(i.color,t,"mgc"))}}},{"../../lib":515}],936:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../components/colorscale/attributes"),e=v("../../plots/font_attributes"),r=v("../../components/drawing/attributes").dash,i=v("../../components/drawing/attributes").pattern,c=v("../../components/drawing"),n=v("./constants"),m=v("../../lib/extend").extendFlat;Q.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:g("x"),yhoverformat:g("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:t({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:k({},{keys:n.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:m({},r,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:i,marker:m({symbol:{valType:"enumerated",values:c.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:m({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},x("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},x("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/align_period"),e=v("../../constants/numerical").BADNUM,r=v("./subtypes"),i=v("./colorscale_calc"),c=v("./arrays_to_calcdata"),n=v("./calc_selection");function m(o,d,u,a,y,h,_){var b=d._length,w=o._fullLayout,T=u._id,L=a._id,M=w._firstScatter[f(d)]===d.uid,P=(l(d,w,u,a)||{}).orientation,z=d.fill;u._minDtick=0,a._minDtick=0;var S={padded:!0},C={padded:!0};_&&(S.ppad=C.ppad=_);var R=b<2||y[0]!==y[b-1]||h[0]!==h[b-1];R&&("tozerox"===z||"tonextx"===z&&(M||"h"===P))?S.tozero=!0:(d.error_y||{}).visible||"tonexty"!==z&&"tozeroy"!==z&&(r.hasMarkers(d)||r.hasText(d))||(S.padded=!1,S.ppad=0),R&&("tozeroy"===z||"tonexty"===z&&(M||"v"===P))?C.tozero=!0:"tonextx"!==z&&"tozerox"!==z||(C.padded=!1),T&&(d._extremes[T]=k.findExtremes(u,y,S)),L&&(d._extremes[L]=k.findExtremes(a,h,C))}function p(o,d){if(r.hasMarkers(o)){var u,a=o.marker,y=1.6*(o.marker.sizeref||1);if(u="area"===o.marker.sizemode?function(T){return Math.max(Math.sqrt((T||0)/y),3)}:function(T){return Math.max((T||0)/y,3)},t.isArrayOrTypedArray(a.size)){var h={type:"linear"};k.setConvert(h);for(var _=h.makeCalcdata(o.marker,"size"),b=new Array(d),w=0;w<d;w++)b[w]=u(_[w]);return b}return u(a.size)}}function s(o,d){var u=f(d),a=o._firstScatter;a[u]||(a[u]=d.uid)}function f(o){var d=o.stackgroup;return o.xaxis+o.yaxis+o.type+(d?"-"+d:"")}function l(o,d,u,a){var y=o.stackgroup;if(y){var h=d._scatterStackOpts[u._id+a._id][y],_="v"===h.orientation?a:u;return"linear"===_.type||"log"===_.type?h:void 0}}Q.exports={calc:function(o,d){var u,a,y,h,_,b,w=o._fullLayout,T=d._xA=k.getFromId(o,d.xaxis||"x","x"),L=d._yA=k.getFromId(o,d.yaxis||"y","y"),M=T.makeCalcdata(d,"x"),P=L.makeCalcdata(d,"y"),z=x(d,T,"x",M),S=x(d,L,"y",P),C=z.vals,R=S.vals,D=d._length,j=new Array(D),q=d.ids,Z=l(d,w,T,L),W=!1;s(w,d);var G,X="x",ne="y";Z?(t.pushUnique(Z.traceIndices,d._expandedIndex),(u="v"===Z.orientation)?(ne="s",G="x"):(X="s",G="y"),_="interpolate"===Z.stackgaps):m(o,d,T,L,C,R,p(d,D));var V=!!d.xperiodalignment,N=!!d.yperiodalignment;for(a=0;a<D;a++){var U=j[a]={},ee=g(C[a]),B=g(R[a]);ee&&B?(U[X]=C[a],U[ne]=R[a],V&&(U.orig_x=M[a],U.xEnd=z.ends[a],U.xStart=z.starts[a]),N&&(U.orig_y=P[a],U.yEnd=S.ends[a],U.yStart=S.starts[a])):Z&&(u?ee:B)?(U[G]=u?C[a]:R[a],U.gap=!0,_?(U.s=e,W=!0):U.s=0):U[X]=U[ne]=e,q&&(U.id=String(q[a]))}if(c(j,d),i(o,d),n(j,d),Z){for(a=0;a<j.length;)j[a][G]===e?j.splice(a,1):a++;if(t.sort(j,function(ae,ce){return ae[G]-ce[G]||ae.i-ce.i}),W){for(a=0;a<j.length-1&&j[a].gap;)a++;for((b=j[a].s)||(b=j[a].s=0),y=0;y<a;y++)j[y].s=b;for(h=j.length-1;h>a&&j[h].gap;)h--;for(b=j[h].s,y=j.length-1;y>h;y--)j[y].s=b;for(;a<h;)if(j[++a].gap){for(y=a+1;j[y].gap;)y++;for(var K=j[a-1][G],J=j[a-1].s,te=(j[y].s-J)/(j[y][G]-K);a<y;)j[a].s=J+(j[a][G]-K)*te,a++}}}return j},calcMarkerSize:p,calcAxisExpansion:m,setFirstScatter:s,getStackOpts:l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){g.isArrayOrTypedArray(k.selectedpoints)&&g.tagSelected(t,k)}},{"../../lib":515}],939:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/helpers").hasColorscale,t=v("../../components/colorscale/calc"),k=v("./subtypes");Q.exports=function(x,e){k.hasLines(e)&&g(e,"line")&&t(x,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),k.hasMarkers(e)&&(g(e,"marker")&&t(x,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),g(e,"marker.line")&&t(x,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(v,Q,$){"use strict";Q.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(v,Q,$){"use strict";var g=v("./calc");function t(k,x,e,r,i,c,n){i[r]=!0;var s,f,o,d,u,m={i:null,gap:!0,s:0};if(m[n]=e,k.splice(x,0,m),x&&e===k[x-1][n]){var p=k[x-1];m.s=p.s,m.i=p.i,m.gap=p.gap}else c&&(m.s=(o=n,d=(s=k)[(f=x)-1],(u=s[f+1])?d?d.s+(u.s-d.s)*(e-d[o])/(u[o]-d[o]):u.s:d.s));x||(k[0].t=k[1].t,k[0].trace=k[1].trace,delete k[1].t,delete k[1].trace)}Q.exports=function(k,x){var e=x.xaxis,r=x.yaxis,c=k._fullLayout._scatterStackOpts[e._id+r._id];if(c){var n,m,p,s,f,l,o,d,u,a,y,h,_,b,w,T=k.calcdata;for(var L in c){var M=(a=c[L]).traceIndices;if(M.length){for(y="interpolate"===a.stackgaps,h=a.groupnorm,"v"===a.orientation?(_="x",b="y"):(_="y",b="x"),w=new Array(M.length),n=0;n<w.length;n++)w[n]=!1;l=T[M[0]];var P=new Array(l.length);for(n=0;n<l.length;n++)P[n]=l[n][_];for(n=1;n<M.length;n++){for(f=T[M[n]],m=p=0;m<f.length;m++){for(o=f[m][_];o>P[p]&&p<P.length;p++)t(f,m,P[p],n,w,y,_),m++;if(o!==P[p]){for(s=0;s<n;s++)t(T[M[s]],p,o,s,w,y,_);P.splice(p,0,o)}p++}for(;p<P.length;p++)t(f,m,P[p],n,w,y,_),m++}var z=P.length;for(m=0;m<l.length;m++){for(d=l[m][b]=l[m].s,n=1;n<M.length;n++)(f=T[M[n]])[0].trace._rawLength=f[0].trace._length,f[0].trace._length=z,f[m][b]=d+=f[m].s;if(h)for(u=("fraction"===h?d:d/100)||1,n=0;n<M.length;n++){var S=T[M[n]][m];S[b]/=u,S.sNorm=S.s/u}}for(n=0;n<M.length;n++){var C=(f=T[M[n]])[0].trace,R=g.calcMarkerSize(C,C._rawLength),D=Array.isArray(R);if(R&&w[n]||D){var j=R;for(R=new Array(z),m=0;m<z;m++)R[m]=f[m].gap?0:D?j[f[m].i]:j}var q=new Array(z),Z=new Array(z);for(m=0;m<z;m++)q[m]=f[m].x,Z[m]=f[m].y;g.calcAxisExpansion(k,C,e,r,q,Z,R),f[0].t.orientation=a.orientation}}}}}},{"./calc":937}],942:[function(v,Q,$){"use strict";Q.exports=function(g){for(var t=0;t<g.length;t++){var k=g[t];if("scatter"===k.type){var x=k.fill;if("none"!==x&&"toself"!==x&&(k.opacity=void 0,"tonexty"===x||"tonextx"===x))for(var e=t-1;e>=0;e--){var r=g[e];if("scatter"===r.type&&r.xaxis===k.xaxis&&r.yaxis===k.yaxis){r.opacity=void 0;break}}}}}},{}],943:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry"),k=v("./attributes"),x=v("./constants"),e=v("./subtypes"),r=v("./xy_defaults"),i=v("./period_defaults"),c=v("./stack_defaults"),n=v("./marker_defaults"),m=v("./line_defaults"),p=v("./line_shape_defaults"),s=v("./text_defaults"),f=v("./fillcolor_defaults"),l=v("../../lib").coercePattern;Q.exports=function(o,d,u,a){function y(P,z){return g.coerce(o,d,k,P,z)}var h=r(o,d,a,y);if(h||(d.visible=!1),d.visible){i(o,d,a,y),y("xhoverformat"),y("yhoverformat");var _=c(o,d,a,y),b=!_&&h<x.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("mode",b),e.hasLines(d)&&(m(o,d,u,a,y,{backoff:!0}),p(o,d,y),y("connectgaps"),y("line.simplify")),e.hasMarkers(d)&&n(o,d,u,a,y,{gradient:!0}),e.hasText(d)&&(y("texttemplate"),s(o,d,a,y));var w=[];(e.hasMarkers(d)||e.hasText(d))&&(y("cliponaxis"),y("marker.maxdisplayed"),w.push("points")),y("fill",_?_.fillDflt:"none"),"none"!==d.fill&&(f(o,d,u,y),e.hasLines(d)||p(o,d,y),l(y,"fillpattern",d.fillcolor,!1));var T=(d.line||{}).color,L=(d.marker||{}).color;"tonext"!==d.fill&&"toself"!==d.fill||w.push("fills"),y("hoveron",w.join("+")||"points"),"fills"!==d.hoveron&&y("hovertemplate");var M=t.getComponentMethod("errorbars","supplyDefaults");M(o,d,T||L||u,{axis:"y"}),M(o,d,T||L||u,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(d,y)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../../lib").isArrayOrTypedArray;Q.exports=function(k,x,e,r){var i=!1;if(x.marker){var c=x.marker.color,n=(x.marker.line||{}).color;c&&!t(c)?i=c:n&&!t(n)&&(i=n)}r("fillcolor",g.addOpacity((x.line||{}).color||i||e,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes");Q.exports=function(t,k,x){var e={},r={_fullLayout:x},i=g.getFromTrace(r,k,"x"),c=g.getFromTrace(r,k,"y");return e.xLabel=g.tickText(i,i.c2l(t.x),!0).text,e.yLabel=g.tickText(c,c.c2l(t.y),!0).text,e}},{"../../plots/cartesian/axes":566}],946:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("./subtypes");Q.exports=function(k,x){var e,r;if("lines"===k.mode)return(e=k.line.color)&&g.opacity(e)?e:k.fillcolor;if("none"===k.mode)return k.fill?k.fillcolor:"";var i=x.mcc||(k.marker||{}).color,c=x.mlcc||((k.marker||{}).line||{}).color;return(r=i&&g.opacity(i)?i:c&&g.opacity(c)&&(x.mlw||((k.marker||{}).line||{}).width)?c:"")?g.opacity(r)<.3?g.addOpacity(r,.3):r:(e=(k.line||{}).color)&&g.opacity(e)&&t.hasLines(k)&&k.line.width?e:k.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/fx"),k=v("../../registry"),x=v("./get_trace_color"),e=v("../../components/color"),r=g.fillText;Q.exports=function(i,c,n,m){var p=i.cd,s=p[0].trace,f=i.xa,l=i.ya,o=f.c2p(c),d=l.c2p(n),u=[o,d],a=s.hoveron||"",y=-1!==s.mode.indexOf("markers")?3:.5,h=!!s.xperiodalignment,_=!!s.yperiodalignment;if(-1!==a.indexOf("points")){var b=function(oe){var ve=Math.max(y,oe.mrc||0),fe=f.c2p(oe.x)-o,xe=l.c2p(oe.y)-d;return Math.max(Math.sqrt(fe*fe+xe*xe)-ve,1-y/ve)},w=t.getDistanceFunction(m,function(oe){if(h){var ve=f.c2p(oe.xStart),fe=f.c2p(oe.xEnd);return o>=Math.min(ve,fe)&&o<=Math.max(ve,fe)?0:1/0}var xe=Math.max(3,oe.mrc||0),Se=1-1/xe,pe=Math.abs(f.c2p(oe.x)-o);return pe<xe?Se*pe/xe:pe-xe+Se},function(oe){if(_){var ve=l.c2p(oe.yStart),fe=l.c2p(oe.yEnd);return d>=Math.min(ve,fe)&&d<=Math.max(ve,fe)?0:1/0}var xe=Math.max(3,oe.mrc||0),Se=1-1/xe,pe=Math.abs(l.c2p(oe.y)-d);return pe<xe?Se*pe/xe:pe-xe+Se},b);if(t.getClosest(p,w,i),!1!==i.index){var T=p[i.index],L=f.c2p(T.x,!0),M=l.c2p(T.y,!0),P=T.mrc||1;i.index=T.i;var z=p[0].t.orientation,S=z&&(T.sNorm||T.s),C="h"===z?S:void 0!==T.orig_x?T.orig_x:T.x,R="v"===z?S:void 0!==T.orig_y?T.orig_y:T.y;return g.extendFlat(i,{color:x(s,T),x0:L-P,x1:L+P,xLabelVal:C,y0:M-P,y1:M+P,yLabelVal:R,spikeDistance:b(T),hovertemplate:s.hovertemplate}),r(T,s,i),k.getComponentMethod("errorbars","hoverInfo")(T,s,i),[i]}}if(-1!==a.indexOf("fills")&&s._polygons){var D,j,q,Z,W,G,ne,V,N=s._polygons,U=[],ee=!1,B=1/0,K=-1/0,J=1/0,te=-1/0;for(D=0;D<N.length;D++)(q=N[D]).contains(u)&&(ee=!ee,U.push(q),J=Math.min(J,q.ymin),te=Math.max(te,q.ymax));if(ee){var ae=((J=Math.max(J,0))+(te=Math.min(te,l._length)))/2;for(D=0;D<U.length;D++)for(Z=U[D].pts,j=1;j<Z.length;j++)(ne=Z[j-1][1])>ae!=(V=Z[j][1])>=ae&&(G=Z[j-1][0],V-ne&&(W=G+(Z[j][0]-G)*(ae-ne)/(V-ne),B=Math.min(B,W),K=Math.max(K,W)));B=Math.max(B,0),K=Math.min(K,f._length);var ce=e.defaultLine;return e.opacity(s.fillcolor)?ce=s.fillcolor:e.opacity((s.line||{}).color)&&(ce=s.line.color),g.extendFlat(i,{distance:i.maxHoverDistance,x0:B,x1:K,y0:ae,y1:ae,color:ce,hovertemplate:!1}),delete i.index,i.text=s.text&&!Array.isArray(s.text)?String(s.text):s.name,[i]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(v,Q,$){"use strict";var g=v("./subtypes");Q.exports={hasLines:g.hasLines,hasMarkers:g.hasMarkers,hasText:g.hasText,isBubble:g.isBubble,attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./cross_trace_calc"),arraysToCalcdata:v("./arrays_to_calcdata"),plot:v("./plot"),colorbar:v("./marker_colorbar"),formatLabels:v("./format_labels"),style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(v,Q,$){"use strict";var g=v("../../lib").isArrayOrTypedArray,t=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults");Q.exports=function(x,e,r,i,c,n){n||(n={});var m=(x.marker||{}).color;c("line.color",r),t(x,"line")?k(x,e,i,c,{prefix:"line.",cLetter:"c"}):c("line.color",!g(m)&&m||r),c("line.width"),n.noDash||c("line.dash"),n.backoff&&c("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(v,Q,$){"use strict";var g=v("../../components/drawing"),t=v("../../constants/numerical"),k=t.BADNUM,x=t.LOG_CLIP,e=x+.5,r=x-.5,i=v("../../lib"),c=i.segmentsIntersect,n=i.constrain,m=v("./constants");Q.exports=function(p,s){var f,l,o,d,u,a,y,h,_,b,w,T,L,M,P,z,S,C,R=s.trace||{},D=s.xaxis,j=s.yaxis,q="log"===D.type,Z="log"===j.type,W=D._length,G=j._length,X=s.backoff,ne=R.marker,V=s.connectGaps,N=s.baseTolerance,U=s.shape,ee="linear"===U,B=R.fill&&"none"!==R.fill,K=[],J=m.minTolerance,te=p.length,ae=new Array(te),ce=0;function oe(Rt){var je=p[Rt];if(!je)return!1;var Ye=s.linearized?D.l2p(je.x):D.c2p(je.x),he=s.linearized?j.l2p(je.y):j.c2p(je.y);if(Ye===k){if(q&&(Ye=D.c2p(je.x,!0)),Ye===k)return!1;Z&&he===k&&(Ye*=Math.abs(D._m*G*(D._m>0?e:r)/(j._m*W*(j._m>0?e:r)))),Ye*=1e3}if(he===k){if(Z&&(he=j.c2p(je.y,!0)),he===k)return!1;he*=1e3}return[Ye,he]}function ve(Rt,je,Ye,he){var be=Ye-Rt,Fe=he-je,He=.5-Rt,Ke=.5-je,Ze=be*be+Fe*Fe,ut=be*He+Fe*Ke;if(ut>0&&ut<Ze){var lt=He*Fe-Ke*be;if(lt*lt<Ze)return!0}}function fe(Rt,je){var Ye=Rt[0]/W,he=Rt[1]/G,be=Math.max(0,-Ye,Ye-1,-he,he-1);return be&&void 0!==S&&ve(Ye,he,S,C)&&(be=0),be&&je&&ve(Ye,he,je[0]/W,je[1]/G)&&(be=0),(1+m.toleranceGrowth*be)*N}function xe(Rt,je){var Ye=Rt[0]-je[0],he=Rt[1]-je[1];return Math.sqrt(Ye*Ye+he*he)}var Se,pe,ge,Te,se,de,Ae,Le=m.maxScreensAway,Me=-W*Le,De=W*(1+Le),Oe=-G*Le,Ie=G*(1+Le),Qe=[[Me,Oe,De,Oe],[De,Oe,De,Ie],[De,Ie,Me,Ie],[Me,Ie,Me,Oe]];function Ne(Rt){if(Rt[0]<Me||Rt[0]>De||Rt[1]<Oe||Rt[1]>Ie)return[n(Rt[0],Me,De),n(Rt[1],Oe,Ie)]}function Pe(Rt,je){return Rt[0]===je[0]&&(Rt[0]===Me||Rt[0]===De)||Rt[1]===je[1]&&(Rt[1]===Oe||Rt[1]===Ie)||void 0}function Re(Rt,je,Ye){return function(he,be){var Fe=Ne(he),He=Ne(be),Ke=[];if(Fe&&He&&Pe(Fe,He))return Ke;Fe&&Ke.push(Fe),He&&Ke.push(He);var Ze=2*i.constrain((he[Rt]+be[Rt])/2,je,Ye)-((Fe||he)[Rt]+(He||be)[Rt]);return Ze&&((Fe&&He?Ze>0==Fe[Rt]>He[Rt]?Fe:He:Fe||He)[Rt]+=Ze),Ke}}function Ge(Rt){var je=Rt[0],Ye=Rt[1],he=je===ae[ce-1][0],be=Ye===ae[ce-1][1];if(!he||!be)if(ce>1){var Fe=je===ae[ce-2][0],He=Ye===ae[ce-2][1];he&&(je===Me||je===De)&&Fe?He?ce--:ae[ce-1]=Rt:be&&(Ye===Oe||Ye===Ie)&&He?Fe?ce--:ae[ce-1]=Rt:ae[ce++]=Rt}else ae[ce++]=Rt}function tt(Rt){ae[ce-1][0]!==Rt[0]&&ae[ce-1][1]!==Rt[1]&&Ge([ge,Te]),Ge(Rt),se=null,ge=Te=0}"linear"===U||"spline"===U?Ae=function(Rt,je){for(var Ye=[],he=0,be=0;be<4;be++){var Fe=Qe[be],He=c(Rt[0],Rt[1],je[0],je[1],Fe[0],Fe[1],Fe[2],Fe[3]);He&&(!he||Math.abs(He.x-Ye[0][0])>1||Math.abs(He.y-Ye[0][1])>1)&&(He=[He.x,He.y],he&&xe(He,Rt)<xe(Ye[0],Rt)?Ye.unshift(He):Ye.push(He),he++)}return Ye}:"hv"===U||"vh"===U?Ae=function(Rt,je){var Ye=[],he=Ne(Rt),be=Ne(je);return he&&be&&Pe(he,be)||(he&&Ye.push(he),be&&Ye.push(be)),Ye}:"hvh"===U?Ae=Re(0,Me,De):"vhv"===U&&(Ae=Re(1,Oe,Ie));var ct=i.isArrayOrTypedArray(ne);function wt(Rt){if(Rt&&X&&(Rt.i=f,Rt.d=p,Rt.trace=R,Rt.marker=ct?ne[Rt.i]:ne,Rt.backoff=X),S=Rt[0]/W,C=Rt[1]/G,pe=Rt[1]<Oe?Oe:Rt[1]>Ie?Ie:0,(Se=Rt[0]<Me?Me:Rt[0]>De?De:0)||pe){if(ce)if(se){var je=Ae(se,Rt);je.length>1&&(tt(je[0]),ae[ce++]=je[1])}else de=Ae(ae[ce-1],Rt)[0],ae[ce++]=de;else ae[ce++]=[Se||Rt[0],pe||Rt[1]];var Ye=ae[ce-1];Se&&pe&&(Ye[0]!==Se||Ye[1]!==pe)?(se&&(ge!==Se&&Te!==pe?Ge(ge&&Te?(Fe=(be=Rt)[0]-(he=se)[0],He=(be[1]-he[1])/Fe,(he[1]*be[0]-be[1]*he[0])/Fe>0?[He>0?Me:De,Ie]:[He>0?De:Me,Oe]):[ge||Se,Te||pe]):ge&&Te&&Ge([ge,Te])),Ge([Se,pe])):ge-Se&&Te-pe&&Ge([Se||ge,pe||Te]),se=Rt,ge=Se,Te=pe}else se&&tt(Ae(se,Rt)[0]),ae[ce++]=Rt;var he,be,Fe,He}for(f=0;f<te;f++)if(l=oe(f)){for(ce=0,se=null,wt(l),f++;f<te;f++){if(!(d=oe(f))){if(V)continue;break}if(ee&&s.simplify){var kt=oe(f+1);if(b=xe(d,l),B&&(0===ce||ce===te-1)||!(b<fe(d,kt)*J)){for(h=[(d[0]-l[0])/b,(d[1]-l[1])/b],u=l,w=b,T=M=P=0,y=!1,o=d,f++;f<p.length;f++){if(a=kt,kt=oe(f+1),!a){if(V)continue;break}if(z=(_=[a[0]-l[0],a[1]-l[1]])[0]*h[1]-_[1]*h[0],M=Math.min(M,z),(P=Math.max(P,z))-M>fe(a,kt))break;o=a,(L=_[0]*h[0]+_[1]*h[1])>w?(w=L,d=a,y=!1):L<T&&(T=L,u=a,y=!0)}if(y?(wt(d),o!==u&&wt(u)):(u!==l&&wt(u),o!==d&&wt(d)),wt(o),f>=p.length||!a)break;wt(a),l=a}}else wt(d)}se&&Ge([ge||se[0],Te||se[1]]),K.push(ae.slice(0,ce))}var gt=U.slice(U.length-1);if(X&&"h"!==gt&&"v"!==gt){for(var at=!1,et=-1,yt=[],Vt=0;Vt<K.length;Vt++)for(var Gt=0;Gt<K[Vt].length-1;Gt++){var en=K[Vt][Gt],Jt=K[Vt][Gt+1],cn=g.applyBackoff(Jt,en);cn[0]===Jt[0]&&cn[1]===Jt[1]||(at=!0),yt[et+1]||(yt[++et]=[en,[cn[0],cn[1]]])}return at?yt:K}return K}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(v,Q,$){"use strict";Q.exports=function(g,t,k){"spline"===k("line.shape")&&k("line.smoothing")}},{}],952:[function(v,Q,$){"use strict";var g={tonextx:1,tonexty:1,tonext:1};Q.exports=function(t,k,x){var e,r,i,c,n,m={},p=!1,s=-1,f=0,l=-1;for(r=0;r<x.length;r++)(i=(e=x[r][0].trace).stackgroup||"")?i in m?n=m[i]:(n=m[i]=f,f++):e.fill in g&&l>=0?n=l:(n=l=f,f++),n<s&&(p=!0),e._groupIndex=s=n;var o=x.slice();p&&o.sort(function(u,a){var y=u[0].trace,h=a[0].trace;return y._groupIndex-h._groupIndex||y.index-h.index});var d={};for(r=0;r<o.length;r++)i=(e=o[r][0].trace).stackgroup||"",!0===e.visible?(e._nexttrace=null,e.fill in g&&(e._prevtrace=(c=d[i])||null,c&&(c._nexttrace=e)),e._ownfill=e.fill&&("tozero"===e.fill.substr(0,6)||"toself"===e.fill||"to"===e.fill.substr(0,2)&&!e._prevtrace),d[i]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return o}},{}],953:[function(v,Q,$){"use strict";var g=v("fast-isnumeric");Q.exports=function(t,k){k||(k=2);var x=t.marker,e=x.sizeref||1,r=x.sizemin||0,i="area"===x.sizemode?function(c){return Math.sqrt(c/e)}:function(c){return c/e};return function(c){var n=i(c/k);return g(n)&&n>0?Math.max(n,r):0}}},{"fast-isnumeric":190}],954:[function(v,Q,$){"use strict";Q.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("./subtypes");Q.exports=function(e,r,i,c,n,m){var p=x.isBubble(e),s=(e.line||{}).color;m=m||{},s&&(i=s),n("marker.symbol"),n("marker.opacity",p?.7:1),n("marker.size"),m.noAngle||(n("marker.angle"),m.noAngleRef||n("marker.angleref"),m.noStandOff||n("marker.standoff")),n("marker.color",i),t(e,"marker")&&k(e,r,c,n,{prefix:"marker.",cLetter:"c"}),m.noSelect||(n("selected.marker.color"),n("unselected.marker.color"),n("selected.marker.size"),n("unselected.marker.size")),m.noLine||(n("marker.line.color",s&&!Array.isArray(s)&&r.marker.color!==s?s:p?g.background:g.defaultLine),t(e,"marker.line")&&k(e,r,c,n,{prefix:"marker.line.",cLetter:"c"}),n("marker.line.width",p?1:0)),p&&(n("marker.sizeref"),n("marker.sizemin"),n("marker.sizemode")),m.gradient&&"none"!==n("marker.gradient.type")&&n("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(v,Q,$){"use strict";var g=v("../../lib").dateTick0,t=v("../../constants/numerical").ONEWEEK;function k(x,e){return g(e,x%t==0?1:0)}Q.exports=function(x,e,r,i,c){if(c||(c={x:!0,y:!0}),c.x){var n=i("xperiod");n&&(i("xperiod0",k(n,e.xcalendar)),i("xperiodalignment"))}if(c.y){var m=i("yperiod");m&&(i("yperiod0",k(m,e.ycalendar)),i("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../lib"),x=k.ensureSingle,e=k.identity,r=v("../../components/drawing"),i=v("./subtypes"),c=v("./line_points"),n=v("./link_traces"),m=v("../../lib/polygon").tester;function p(s,f,l,o,d,u,a){var y;!function(de,Ae,Le,Me,De){var Oe=Le.xaxis,Ie=Le.yaxis,Qe=g.extent(k.simpleMap(Oe.range,Oe.r2c)),Ne=g.extent(k.simpleMap(Ie.range,Ie.r2c)),Pe=Me[0].trace;if(i.hasMarkers(Pe)){var Re=Pe.marker.maxdisplayed;if(0!==Re){var Ge=Me.filter(function(kt){return kt.x>=Qe[0]&&kt.x<=Qe[1]&&kt.y>=Ne[0]&&kt.y<=Ne[1]}),tt=Math.ceil(Ge.length/Re),ct=0;De.forEach(function(kt,gt){var at=kt[0].trace;i.hasMarkers(at)&&at.marker.maxdisplayed>0&&gt<Ae&&ct++});var wt=Math.round(ct*tt/3+Math.floor(ct/3)*tt/7.1);Me.forEach(function(kt){delete kt.vis}),Ge.forEach(function(kt,gt){0===Math.round((gt+wt)%tt)&&(kt.vis=!0)})}}}(0,f,l,o,d);var h=!!a&&a.duration>0;function _(de){return h?de.transition():de}var b=l.xaxis,w=l.yaxis,T=o[0].trace,L=T.line,M=g.select(u),P=x(M,"g","errorbars"),z=x(M,"g","lines"),S=x(M,"g","points"),C=x(M,"g","text");if(t.getComponentMethod("errorbars","plot")(s,P,l,a),!0===T.visible){var R,D;_(M).style("opacity",T.opacity);var j=T.fill.charAt(T.fill.length-1);"x"!==j&&"y"!==j&&(j=""),o[0][l.isRangePlot?"nodeRangePlot3":"node3"]=M;var q,Z,W="",G=[],X=T._prevtrace;X&&(W=X._prevRevpath||"",D=X._nextFill,G=X._polygons);var ne,V,N,U,ee,B,K,J="",te="",ae=[],ce=k.noop;if(R=T._ownFill,i.hasLines(T)||"none"!==T.fill){for(D&&D.datum(o),-1!==["hv","vh","hvh","vhv"].indexOf(L.shape)?(ne=r.steps(L.shape),V=r.steps(L.shape.split("").reverse().join(""))):ne=V="spline"===L.shape?function(de){var Ae=de[de.length-1];return de.length>1&&de[0][0]===Ae[0]&&de[0][1]===Ae[1]?r.smoothclosed(de.slice(1),L.smoothing):r.smoothopen(de,L.smoothing)}:function(de){return"M"+de.join("L")},N=function(de){return V(de.reverse())},ae=c(o,{xaxis:b,yaxis:w,trace:T,connectGaps:T.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,backoff:L.backoff,simplify:L.simplify,fill:T.fill}),K=T._polygons=new Array(ae.length),y=0;y<ae.length;y++)T._polygons[y]=m(ae[y]);ae.length&&(U=ae[0][0],B=(ee=ae[ae.length-1])[ee.length-1]),ce=function(de){return function(Ae){if(q=ne(Ae),Z=N(Ae),J?j?(J+="L"+q.substr(1),te=Z+"L"+te.substr(1)):(J+="Z"+q,te=Z+"Z"+te):(J=q,te=Z),i.hasLines(T)&&Ae.length>1){var Le=g.select(this);if(Le.datum(o),de)_(Le.style("opacity",0).attr("d",q).call(r.lineGroupStyle)).style("opacity",1);else{var Me=_(Le);Me.attr("d",q),r.singleLineStyle(o,Me)}}}}}var oe=z.selectAll(".js-line").data(ae);_(oe.exit()).style("opacity",0).remove(),oe.each(ce(!1)),oe.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(r.lineGroupStyle).each(ce(!0)),r.setClipUrl(oe,l.layerClipId,s),ae.length?(R?(R.datum(o),U&&B&&(j?("y"===j?U[1]=B[1]=w.c2p(0,!0):"x"===j&&(U[0]=B[0]=b.c2p(0,!0)),_(R).attr("d","M"+B+"L"+U+"L"+J.substr(1)).call(r.singleFillStyle,s)):_(R).attr("d",J+"Z").call(r.singleFillStyle,s))):D&&("tonext"===T.fill.substr(0,6)&&J&&W?("tonext"===T.fill?_(D).attr("d",J+"Z"+W+"Z").call(r.singleFillStyle,s):_(D).attr("d",J+"L"+W.substr(1)+"Z").call(r.singleFillStyle,s),T._polygons=T._polygons.concat(G)):(fe(D),T._polygons=null)),T._prevRevpath=te,T._prevPolygons=K):(R?fe(R):D&&fe(D),T._polygons=T._prevRevpath=T._prevPolygons=null),S.datum(o),C.datum(o),function(de,Ae,Le){var Me,De=Le[0].trace,Oe=i.hasMarkers(De),Ie=i.hasText(De),Qe=function Te(de){if(de.ids)return ge}(De),Ne=se,Pe=se;if(Oe||Ie){var Re=e,Ge=De.stackgroup,tt=Ge&&"infer zero"===s._fullLayout._scatterStackOpts[b._id+w._id][Ge].stackgaps;De.marker.maxdisplayed||De._needsCull?Re=tt?Se:xe:Ge&&!tt&&(Re=pe),Oe&&(Ne=Re),Ie&&(Pe=Re)}var ct,wt=(Me=de.selectAll("path.point").data(Ne,Qe)).enter().append("path").classed("point",!0);h&&wt.call(r.pointStyle,De,s).call(r.translatePoints,b,w).style("opacity",0).transition().style("opacity",1),Me.order(),Oe&&(ct=r.makePointStyleFns(De)),Me.each(function(kt){var gt=g.select(this),at=_(gt);r.translatePoint(kt,at,b,w)?(r.singlePointStyle(kt,at,De,ct,s),l.layerClipId&&r.hideOutsideRangePoint(kt,at,b,w,De.xcalendar,De.ycalendar),De.customdata&&gt.classed("plotly-customdata",null!=kt.data)):at.remove()}),h?Me.exit().transition().style("opacity",0).remove():Me.exit().remove(),(Me=Ae.selectAll("g").data(Pe,Qe)).enter().append("g").classed("textpoint",!0).append("text"),Me.order(),Me.each(function(kt){var gt=g.select(this),at=_(gt.select("text"));r.translatePoint(kt,at,b,w)?l.layerClipId&&r.hideOutsideRangePoint(kt,gt,b,w,De.xcalendar,De.ycalendar):gt.remove()}),Me.selectAll("text").call(r.textPointStyle,De,s).each(function(kt){var gt=b.c2p(kt.x),at=w.c2p(kt.y);g.select(this).selectAll("tspan.line").each(function(){_(g.select(this)).attr({x:gt,y:at})})}),Me.exit().remove()}(S,C,o);var ve=!1===T.cliponaxis?null:l.layerClipId;r.setClipUrl(S,ve,s),r.setClipUrl(C,ve,s)}function fe(de){_(de).attr("d","M0,0Z")}function xe(de){return de.filter(function(Ae){return!Ae.gap&&Ae.vis})}function Se(de){return de.filter(function(Ae){return Ae.vis})}function pe(de){return de.filter(function(Ae){return!Ae.gap})}function ge(de){return de.id}function se(){return!1}}Q.exports=function(s,f,l,o,d,u){var a,y,w,L,h=!d,_=!!d&&d.duration>0,b=n(s,f,l);(a=o.selectAll("g.trace").data(b,function(w){return w[0].trace.uid})).enter().append("g").attr("class",function(w){return"trace scatter trace"+w[0].trace.uid}).style("stroke-miterlimit",2),a.order(),w=s,L=f,a.each(function(M){var P=x(g.select(this),"g","fills");r.setClipUrl(P,L.layerClipId,w);var z=M[0].trace,S=[];z._ownfill&&S.push("_ownFill"),z._nexttrace&&S.push("_nextFill");var C=P.selectAll("g").data(S,e);C.enter().append("g"),C.exit().each(function(R){z[R]=null}).remove(),C.order().each(function(R){z[R]=x(g.select(this),"path","js-fill")})}),_?(u&&(y=u()),g.transition().duration(d.duration).ease(d.easing).each("end",function(){y&&y()}).each("interrupt",function(){y&&y()}).each(function(){o.selectAll("g.trace").each(function(w,T){p(s,T,f,w,b,this,d)})})):a.each(function(w,T){p(s,T,f,w,b,this,d)}),h&&a.exit().remove(),o.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(v,Q,$){"use strict";var g=v("./subtypes");Q.exports=function(t,k){var x,e,r,i,c=t.cd,n=t.xaxis,m=t.yaxis,p=[],s=c[0].trace;if(!g.hasMarkers(s)&&!g.hasText(s))return[];if(!1===k)for(x=0;x<c.length;x++)c[x].selected=0;else for(x=0;x<c.length;x++)r=n.c2p((e=c[x]).x),i=m.c2p(e.y),null!==e.i&&k.contains([r,i],!1,x,t)?(p.push({pointNumber:e.i,x:n.c2d(e.x),y:m.c2d(e.y)}),e.selected=1):e.selected=0;return p}},{"./subtypes":961}],959:[function(v,Q,$){"use strict";var g=["orientation","groupnorm","stackgaps"];Q.exports=function(t,k,x,e){var r=x._scatterStackOpts,i=e("stackgroup");if(i){var c=k.xaxis+k.yaxis,n=r[c];n||(n=r[c]={});var m=n[i],p=!1;m?m.traces.push(k):(m=n[i]={traceIndices:[],traces:[k]},p=!0);for(var s={orientation:k.x&&!k.y?"h":"v"},f=0;f<g.length;f++){var l=g[f],o=l+"Found";if(!m[o]){var d=void 0!==t[l],u="orientation"===l;if((d||p)&&(m[l]=e(l,s[l]),u&&(m.fillDflt="h"===m[l]?"tonextx":"tonexty"),d&&(m[o]=!0,!p&&(delete m.traces[0][l],u))))for(var a=0;a<m.traces.length-1;a++){var y=m.traces[a];y._input.fill!==y.fill&&(y.fill=m.fillDflt)}}}return m}}},{}],960:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../../registry");function x(r,i,c){t.pointStyle(r.selectAll("path.point"),i,c)}function e(r,i,c){t.textPointStyle(r.selectAll("text"),i,c)}Q.exports={style:function(r){var i=g.select(r).selectAll("g.trace.scatter");i.style("opacity",function(c){return c[0].trace.opacity}),i.selectAll("g.points").each(function(c){x(g.select(this),c.trace||c[0].trace,r)}),i.selectAll("g.text").each(function(c){e(g.select(this),c.trace||c[0].trace,r)}),i.selectAll("g.trace path.js-line").call(t.lineGroupStyle),i.selectAll("g.trace path.js-fill").call(t.fillGroupStyle,r),k.getComponentMethod("errorbars","style")(i)},stylePoints:x,styleText:e,styleOnSelect:function(r,i,c){var n=i[0].trace;n.selectedpoints?(t.selectedPointStyle(c.selectAll("path.point"),n),t.selectedTextStyle(c.selectAll("text"),n)):(x(c,n,r),e(c,n,r))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports={hasLines:function(t){return t.visible&&t.mode&&-1!==t.mode.indexOf("lines")},hasMarkers:function(t){return t.visible&&(t.mode&&-1!==t.mode.indexOf("markers")||"splom"===t.type)},hasText:function(t){return t.visible&&t.mode&&-1!==t.mode.indexOf("text")},isBubble:function(t){return g.isPlainObject(t.marker)&&g.isArrayOrTypedArray(t.marker.size)}}},{"../../lib":515}],962:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k,x,e,r){r=r||{},e("textposition"),g.coerceFont(e,"textfont",x.font),r.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry");Q.exports=function(k,x,e,r){var i,c=r("x"),n=r("y");if(t.getComponentMethod("calendars","handleTraceDefaults")(k,x,["x","y"],e),c){var m=g.minRowLength(c);n?i=Math.min(m,g.minRowLength(n)):(i=m,r("y0"),r("dy"))}else{if(!n)return 0;i=g.minRowLength(n),r("x0"),r("dx")}return x._length=i,i}},{"../../lib":515,"../../registry":647}],964:[function(v,Q,$){"use strict";var g=v("../scatter/attributes"),t=v("../../components/colorscale/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/template_attributes").texttemplateAttrs,r=v("../../plots/attributes"),i=v("../../constants/gl3d_dashes"),c=v("../../constants/gl3d_markers"),n=v("../../lib/extend").extendFlat,m=v("../../plot_api/edit_types").overrideAll,p=v("../../lib/sort_object_keys"),f=g.marker,l=f.line,o=n({width:g.line.width,dash:{valType:"enumerated",values:p(i),dflt:"solid"}},t("line")),d=Q.exports=m({x:g.x,y:g.y,z:{valType:"data_array"},text:n({},g.text,{}),texttemplate:e({},{}),hovertext:n({},g.hovertext,{}),hovertemplate:x(),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),mode:n({},g.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:g.connectgaps,line:o,marker:n({symbol:{valType:"enumerated",values:p(c),dflt:"circle",arrayOk:!0},size:n({},f.size,{dflt:8}),sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,opacity:n({},f.opacity,{arrayOk:!1}),colorbar:f.colorbar,line:n({width:n({},l.width,{arrayOk:!1})},t("marker.line"))},t("marker")),textposition:n({},g.textposition,{dflt:"top center"}),textfont:{color:g.textfont.color,size:g.textfont.size,family:n({},g.textfont.family,{arrayOk:!1})},opacity:r.opacity,hoverinfo:n({},r.hoverinfo)},"calc","nested");d.x.editType=d.y.editType=d.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(v,Q,$){"use strict";var g=v("../scatter/arrays_to_calcdata"),t=v("../scatter/colorscale_calc");Q.exports=function(k,x){var e=[{x:!1,y:!1,trace:x,t:{}}];return g(e,x),t(k,x),e}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(v,Q,$){"use strict";var g=v("../../registry");function t(k,x,e,r){if(!x||!x.visible)return null;for(var i=g.getComponentMethod("errorbars","makeComputeError")(x),c=new Array(k.length),n=0;n<k.length;n++){var m=i(+k[n],n);if("log"===r.type){var p=r.c2l(k[n]),s=k[n]-m[0],f=k[n]+m[1];if(c[n]=[(r.c2l(s,!0)-p)*e,(r.c2l(f,!0)-p)*e],s>0){var l=r.c2l(s);r._lowerLogErrorBound||(r._lowerLogErrorBound=l),r._lowerErrorBound=Math.min(r._lowerLogErrorBound,l)}}else c[n]=[-m[0]*e,m[1]*e]}return c}Q.exports=function(k,x,e){var r=[t(k.x,k.error_x,x[0],e.xaxis),t(k.y,k.error_y,x[1],e.yaxis),t(k.z,k.error_z,x[2],e.zaxis)],i=function(f){for(var l=0;l<f.length;l++)if(f[l])return f[l].length;return 0}(r);if(0===i)return null;for(var c=new Array(i),n=0;n<i;n++){for(var m=[[0,0,0],[0,0,0]],p=0;p<3;p++)if(r[p])for(var s=0;s<2;s++)m[s][p]=r[p][n][s];c[n]=m}return c}},{"../../registry":647}],967:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_line3d,t=v("../../../stackgl_modules").gl_scatter3d,k=v("../../../stackgl_modules").gl_error3d,x=v("../../../stackgl_modules").gl_mesh3d,e=v("../../../stackgl_modules").delaunay_triangulate,r=v("../../lib"),i=v("../../lib/str2rgbarray"),c=v("../../lib/gl_format_color").formatColor,n=v("../scatter/make_bubble_size_func"),m=v("../../constants/gl3d_dashes"),p=v("../../constants/gl3d_markers"),s=v("../../plots/cartesian/axes"),f=v("../../components/fx/helpers").appendArrayPointValue,l=v("./calc_errors");function o(L,M){this.scene=L,this.uid=M,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var d=o.prototype;function u(L){return null==L?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function a(L){return null==L?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function y(L,M){return M(4*L)}function h(L){return p[L]}function _(L,M,P,z,S){var C=null;if(r.isArrayOrTypedArray(L)){C=[];for(var R=0;R<M;R++)C[R]=void 0===L[R]?z:P(L[R],S)}else C=P(L,r.identity);return C}function w(L){if(r.isArrayOrTypedArray(L)){var M=L[0];return r.isArrayOrTypedArray(M)&&(L=M),"rgb("+L.slice(0,3).map(function(P){return Math.round(255*P)})+")"}return null}function T(L){return r.isArrayOrTypedArray(L)?4===L.length&&"number"==typeof L[0]?w(L):L.map(w):null}d.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var M=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[M]||0===this.textLabels[M])&&(L.textLabel=this.textLabels[M]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[M],this.data.y[M],this.data.z[M]],!0}},d.update=function(L){var M,P,z,S,C=this.scene.glplot.gl,R=m.solid;this.data=L;var D=function b(L,M){var P,z,S,C,R,D,j=[],q=L.fullSceneLayout,Z=L.dataScale,W=q.xaxis,G=q.yaxis,X=q.zaxis,ne=M.marker,V=M.line,N=M.x||[],U=M.y||[],ee=M.z||[],B=N.length,K=M.xcalendar,J=M.ycalendar,te=M.zcalendar;for(R=0;R<B;R++)P=W.d2l(N[R],0,K)*Z[0],z=G.d2l(U[R],0,J)*Z[1],S=X.d2l(ee[R],0,te)*Z[2],j[R]=[P,z,S];if(Array.isArray(M.text))D=M.text;else if(void 0!==M.text)for(D=new Array(B),R=0;R<B;R++)D[R]=M.text;function ae(Me,De){var Oe=q[Me];return s.tickText(Oe,Oe.d2l(De),!0).text}var ce=M.texttemplate;if(ce){var oe=L.fullLayout._d3locale,ve=Array.isArray(ce),fe=ve?Math.min(ce.length,B):B,xe=ve?function(Me){return ce[Me]}:function(){return ce};for(D=new Array(fe),R=0;R<fe;R++){var Se={x:N[R],y:U[R],z:ee[R]},pe={xLabel:ae("xaxis",N[R]),yLabel:ae("yaxis",U[R]),zLabel:ae("zaxis",ee[R])},ge={};f(ge,M,R);var Te=M._meta||{};D[R]=r.texttemplateString(xe(R),pe,oe,ge,Se,Te)}}if(C={position:j,mode:M.mode,text:D},"line"in M&&(C.lineColor=c(V,1,B),C.lineWidth=V.width,C.lineDashes=V.dash),"marker"in M){var se=n(M);C.scatterColor=c(ne,1,B),C.scatterSize=_(ne.size,B,y,20,se),C.scatterMarker=_(ne.symbol,B,h,"\u25cf"),C.scatterLineWidth=ne.line.width,C.scatterLineColor=c(ne.line,1,B),C.scatterAngle=0}"textposition"in M&&(C.textOffset=function(Me){var De=[0,0];if(Array.isArray(Me))for(var Oe=0;Oe<Me.length;Oe++)De[Oe]=[0,0],Me[Oe]&&(De[Oe][0]=u(Me[Oe]),De[Oe][1]=a(Me[Oe]));else De[0]=u(Me),De[1]=a(Me);return De}(M.textposition),C.textColor=c(M.textfont,1,B),C.textSize=_(M.textfont.size,B,r.identity,12),C.textFont=M.textfont.family,C.textAngle=0);var de=["x","y","z"];for(C.project=[!1,!1,!1],C.projectScale=[1,1,1],C.projectOpacity=[1,1,1],R=0;R<3;++R){var Ae=M.projection[de[R]];(C.project[R]=Ae.show)&&(C.projectOpacity[R]=Ae.opacity,C.projectScale[R]=Ae.scale)}C.errorBounds=l(M,Z,q);var Le=function(Me){for(var De=[0,0,0],Oe=[[0,0,0],[0,0,0],[0,0,0]],Ie=[1,1,1],Qe=0;Qe<3;Qe++){var Ne=Me[Qe];Ne&&!1!==Ne.copy_zstyle&&!1!==Me[2].visible&&(Ne=Me[2]),Ne&&Ne.visible&&(De[Qe]=Ne.width/2,Oe[Qe]=i(Ne.color),Ie[Qe]=Ne.thickness)}return{capSize:De,color:Oe,lineWidth:Ie}}([M.error_x,M.error_y,M.error_z]);return C.errorColor=Le.color,C.errorLineWidth=Le.lineWidth,C.errorCapSize=Le.capSize,C.delaunayAxis=M.surfaceaxis,C.delaunayColor=i(M.surfacecolor),C}(this.scene,L);"mode"in D&&(this.mode=D.mode),"lineDashes"in D&&D.lineDashes in m&&(R=m[D.lineDashes]),this.color=T(D.scatterColor)||T(D.lineColor),this.dataPoints=D.position,M={gl:this.scene.glplot.gl,position:D.position,color:D.lineColor,lineWidth:D.lineWidth||1,dashes:R[0],dashScale:R[1],opacity:L.opacity,connectGaps:L.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(M):(this.linePlot=g(M),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var j=L.opacity;if(L.marker&&L.marker.opacity&&(j*=L.marker.opacity),P={gl:this.scene.glplot.gl,position:D.position,color:D.scatterColor,size:D.scatterSize,glyph:D.scatterMarker,opacity:j,orthographic:!0,lineWidth:D.scatterLineWidth,lineColor:D.scatterLineColor,project:D.project,projectScale:D.projectScale,projectOpacity:D.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(P):(this.scatterPlot=t(P),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),S={gl:this.scene.glplot.gl,position:D.position,glyph:D.text,color:D.textColor,size:D.textSize,angle:D.textAngle,alignment:D.textOffset,font:D.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(S):(this.textMarkers=t(S),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),z={gl:this.scene.glplot.gl,position:D.position,color:D.errorColor,error:D.errorBounds,lineWidth:D.errorLineWidth,capSize:D.errorCapSize,opacity:L.opacity},this.errorBars?D.errorBounds?this.errorBars.update(z):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):D.errorBounds&&(this.errorBars=k(z),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),D.delaunayAxis>=0){var q=function(Z,W,G){var X,ne=(G+1)%3,V=(G+2)%3,N=[],U=[];for(X=0;X<Z.length;++X){var ee=Z[X];!isNaN(ee[ne])&&isFinite(ee[ne])&&!isNaN(ee[V])&&isFinite(ee[V])&&(N.push([ee[ne],ee[V]]),U.push(X))}var B=e(N);for(X=0;X<B.length;++X)for(var K=B[X],J=0;J<K.length;++J)K[J]=U[K[J]];return{positions:Z,cells:B,meshColor:W}}(D.position,D.delaunayColor,D.delaunayAxis);q.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(q):(q.gl=C,this.delaunayMesh=x(q),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},d.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},Q.exports=function(L,M){var P=new o(L,M.uid);return P.update(M),P}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../scatter/subtypes"),x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/text_defaults"),i=v("./attributes");Q.exports=function(c,n,m,p){function s(y,h){return t.coerce(c,n,i,y,h)}if(y=c,h=n,b=p,w=0,T=(_=s)("x"),L=_("y"),M=_("z"),g.getComponentMethod("calendars","handleTraceDefaults")(y,h,["x","y","z"],b),T&&L&&M&&(w=Math.min(T.length,L.length,M.length),h._length=h._xlength=h._ylength=h._zlength=w),w){s("text"),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"),s("zhoverformat"),s("mode"),k.hasLines(n)&&(s("connectgaps"),e(c,n,m,p,s)),k.hasMarkers(n)&&x(c,n,m,p,s,{noSelect:!0,noAngle:!0}),k.hasText(n)&&(s("texttemplate"),r(c,n,p,s,{noSelect:!0}));var f=(n.line||{}).color,l=(n.marker||{}).color;s("surfaceaxis")>=0&&s("surfacecolor",f||l);for(var o=["x","y","z"],d=0;d<3;++d){var u="projection."+o[d];s(u+".show")&&(s(u+".opacity"),s(u+".scale"))}var a=g.getComponentMethod("errorbars","supplyDefaults");a(c,n,f||l||m,{axis:"z"}),a(c,n,f||l||m,{axis:"y",inherit:"z"}),a(c,n,f||l||m,{axis:"x",inherit:"z"})}else n.visible=!1;var y,h,_,b,w,T,L,M}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(v,Q,$){"use strict";Q.exports={plot:v("./convert"),attributes:v("./attributes"),markerSymbols:v("../../constants/gl3d_markers"),supplyDefaults:v("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:v("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(v,Q,$){"use strict";var g=v("../scatter/attributes"),t=v("../../plots/attributes"),k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../components/colorscale/attributes"),r=v("../../lib/extend").extendFlat,i=g.marker,c=g.line,n=i.line;Q.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:r({},g.mode,{dflt:"markers"}),text:r({},g.text,{}),texttemplate:x({editType:"plot"},{keys:["a","b","text"]}),hovertext:r({},g.hovertext,{}),line:{color:c.color,width:c.width,dash:c.dash,backoff:c.backoff,shape:r({},c.shape,{values:["linear","spline"]}),smoothing:c.smoothing,editType:"calc"},connectgaps:g.connectgaps,fill:r({},g.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:g.fillcolor,marker:r({symbol:i.symbol,opacity:i.opacity,maxdisplayed:i.maxdisplayed,angle:i.angle,angleref:i.angleref,standoff:i.standoff,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,line:r({width:n.width,editType:"calc"},e("marker.line")),gradient:i.gradient,editType:"calc"},e("marker")),textfont:g.textfont,textposition:g.textposition,selected:g.selected,unselected:g.unselected,hoverinfo:r({},t.hoverinfo,{flags:["a","b","text","name"]}),hoveron:g.hoveron,hovertemplate:k()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../scatter/colorscale_calc"),k=v("../scatter/arrays_to_calcdata"),x=v("../scatter/calc_selection"),e=v("../scatter/calc").calcMarkerSize,r=v("../carpet/lookup_carpetid");Q.exports=function(i,c){var n=c._carpetTrace=r(i,c);if(n&&n.visible&&"legendonly"!==n.visible){var m;c.xaxis=n.xaxis,c.yaxis=n.yaxis;var p,s,f=c._length,l=new Array(f),o=!1;for(m=0;m<f;m++)if(s=c.b[m],g(p=c.a[m])&&g(s)){var d=n.ab2xy(+p,+s,!0),u=n.isVisible(+p,+s);u||(o=!0),l[m]={x:d[0],y:d[1],a:p,b:s,vis:u}}else l[m]={x:!1,y:!1};return c._needsCull=o,l[0].carpet=n,l[0].trace=c,e(c,f),t(i,c),k(l,c),x(l,c),l}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/constants"),k=v("../scatter/subtypes"),x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/line_shape_defaults"),i=v("../scatter/text_defaults"),c=v("../scatter/fillcolor_defaults"),n=v("./attributes");Q.exports=function(m,p,s,f){function l(y,h){return g.coerce(m,p,n,y,h)}l("carpet"),p.xaxis="x",p.yaxis="y";var o=l("a"),d=l("b"),u=Math.min(o.length,d.length);if(u){p._length=u,l("text"),l("texttemplate"),l("hovertext"),l("mode",u<t.PTS_LINESONLY?"lines+markers":"lines"),k.hasLines(p)&&(e(m,p,s,f,l,{backoff:!0}),r(m,p,l),l("connectgaps")),k.hasMarkers(p)&&x(m,p,s,f,l,{gradient:!0}),k.hasText(p)&&i(m,p,f,l);var a=[];(k.hasMarkers(p)||k.hasText(p))&&(l("marker.maxdisplayed"),a.push("points")),l("fill"),"none"!==p.fill&&(c(m,p,s,l),k.hasLines(p)||r(m,p,l)),"tonext"!==p.fill&&"toself"!==p.fill||a.push("fills"),"fills"!==l("hoveron",a.join("+")||"points")&&l("hovertemplate"),g.coerceSelectionMarkerOpacity(p,l)}else p.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){var r=x[e];return g.a=r.a,g.b=r.b,g.y=r.y,g}},{}],974:[function(v,Q,$){"use strict";Q.exports=function(g,t){var k={},x=t._carpet,e=x.ab2ij([g.a,g.b]),r=Math.floor(e[0]),i=e[0]-r,c=Math.floor(e[1]),m=x.evalxy([],r,c,i,e[1]-c);return k.yLabel=m[1].toFixed(3),k}},{}],975:[function(v,Q,$){"use strict";var g=v("../scatter/hover"),t=v("../../lib").fillText;Q.exports=function(k,x,e,r){var i=g(k,x,e,r);if(i&&!1!==i[0].index){var c=i[0];if(void 0===c.index){var m=k.xa._length,p=m*(1-c.y0/k.ya._length)/2,s=m-p;return c.x0=Math.max(Math.min(c.x0,s),p),c.x1=Math.max(Math.min(c.x1,s),p),i}var f=c.cd[c.index];c.a=f.a,c.b=f.b,c.xLabelVal=void 0,c.yLabelVal=void 0;var l=c.trace,o=l._carpet,d=l._module.formatLabels(f,l);c.yLabel=d.yLabel,delete c.text;var u=[];if(!l.hovertemplate){var a=(f.hi||l.hoverinfo).split("+");-1!==a.indexOf("all")&&(a=["a","b","text"]),-1!==a.indexOf("a")&&y(o.aaxis,f.a),-1!==a.indexOf("b")&&y(o.baxis,f.b),u.push("y: "+c.yLabel),-1!==a.indexOf("text")&&t(f,l,u),c.extraText=u.join("<br>")}return i}function y(h,_){var b;b=h.labelprefix&&h.labelprefix.length>0?h.labelprefix.replace(/ = $/,""):h._hovertitle,u.push(b+": "+_.toFixed(3)+h.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../scatter/select"),eventData:v("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:v("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(v,Q,$){"use strict";var g=v("../scatter/plot"),t=v("../../plots/cartesian/axes"),k=v("../../components/drawing");Q.exports=function(x,e,r,i){var c,n,m,p=r[0][0].carpet,s=t.getFromId(x,p.xaxis||"x"),f=t.getFromId(x,p.yaxis||"y"),l={xaxis:s,yaxis:f,plot:e.plot};for(c=0;c<r.length;c++)(n=r[c][0].trace)._xA=s,n._yA=f;for(g(x,l,r,i),c=0;c<r.length;c++)m=i.selectAll("g.trace"+(n=r[c][0].trace).uid+" .js-line"),k.setClipUrl(m,r[c][0].carpet._clipPathId,x)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../scatter/attributes"),x=v("../../plots/attributes"),e=v("../../components/colorscale/attributes"),r=v("../../components/drawing/attributes").dash,i=v("../../lib/extend").extendFlat,c=v("../../plot_api/edit_types").overrideAll,n=k.marker,m=k.line,p=n.line;Q.exports=c({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:i({},k.mode,{dflt:"markers"}),text:i({},k.text,{}),texttemplate:t({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:i({},k.hovertext,{}),textfont:k.textfont,textposition:k.textposition,line:{color:m.color,width:m.width,dash:r},connectgaps:k.connectgaps,marker:i({symbol:n.symbol,opacity:n.opacity,angle:n.angle,angleref:i({},n.angleref,{values:["previous","up","north"]}),standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,colorbar:n.colorbar,line:i({width:p.width},e("marker.line")),gradient:n.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:k.fillcolor,selected:k.selected,unselected:k.unselected,hoverinfo:i({},x.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:g()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../constants/numerical").BADNUM,k=v("../scatter/colorscale_calc"),x=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection"),r=v("../../lib")._;function i(c){return c&&"string"==typeof c}Q.exports=function(c,n){var m,p=Array.isArray(n.locations),s=p?n.locations.length:n._length,f=new Array(s);m=n.geojson?function(y){return i(y)||g(y)}:i;for(var l=0;l<s;l++){var o=f[l]={};if(p){var d=n.locations[l];o.loc=m(d)?d:null}else{var u=n.lon[l],a=n.lat[l];o.lonlat=g(u)&&g(a)?[+u,+a]:[t,t]}}return x(f,n),k(c,n),e(f,n),s&&(f[0].t={labels:{lat:r(c,"lat:")+" ",lon:r(c,"lon:")+" "}}),f}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/text_defaults"),r=v("../scatter/fillcolor_defaults"),i=v("./attributes");Q.exports=function(c,n,m,p){function s(y,h){return g.coerce(c,n,i,y,h)}var f,l=s("locations");if(l&&l.length){var o,d=s("geojson");("string"==typeof d&&""!==d||g.isPlainObject(d))&&(o="geojson-id"),"geojson-id"===s("locationmode",o)&&s("featureidkey"),f=l.length}else{var u=s("lon")||[],a=s("lat")||[];f=Math.min(u.length,a.length)}f?(n._length=f,s("text"),s("hovertext"),s("hovertemplate"),s("mode"),t.hasLines(n)&&(x(c,n,m,p,s),s("connectgaps")),t.hasMarkers(n)&&k(c,n,m,p,s,{gradient:!0}),t.hasText(n)&&(s("texttemplate"),e(c,n,p,s)),s("fill"),"none"!==n.fill&&r(c,n,m,s),g.coerceSelectionMarkerOpacity(n,s)):n.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){g.lon=t.lon,g.lat=t.lat,g.location=t.loc?t.loc:null;var r=x[e];return r.fIn&&r.fIn.properties&&(g.properties=r.fIn.properties),g}},{}],982:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes");Q.exports=function(t,k,x){var e={},r=x[k.geo]._subplot.mockAxis,i=t.lonlat;return e.lonLabel=g.tickText(r,r.c2l(i[0]),!0).text,e.latLabel=g.tickText(r,r.c2l(i[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],983:[function(v,Q,$){"use strict";var g=v("../../components/fx"),t=v("../../constants/numerical").BADNUM,k=v("../scatter/get_trace_color"),x=v("../../lib").fillText,e=v("./attributes");Q.exports=function(r,i,c){var n=r.cd,m=n[0].trace,p=r.xa,s=r.ya,f=r.subplot,l=f.projection.isLonLatOverEdges,o=f.project;if(g.getClosest(n,function(b){var w=b.lonlat;if(w[0]===t||l(w))return 1/0;var T=o(w),L=o([i,c]),M=Math.abs(T[0]-L[0]),P=Math.abs(T[1]-L[1]),z=Math.max(3,b.mrc||0);return Math.max(Math.sqrt(M*M+P*P)-z,1-3/z)},r),!1!==r.index){var d=n[r.index],u=d.lonlat,a=[p.c2p(u),s.c2p(u)],y=d.mrc||1;r.x0=a[0]-y,r.x1=a[0]+y,r.y0=a[1]-y,r.y1=a[1]+y,r.loc=d.loc,r.lon=u[0],r.lat=u[1];var h={};h[m.geo]={_subplot:f};var _=m._module.formatLabels(d,m,h);return r.lonLabel=_.lonLabel,r.latLabel=_.latLabel,r.color=k(m,d),r.extraText=function(b,w,T,L){if(!b.hovertemplate){var M=w.hi||b.hoverinfo,P="all"===M?e.hoverinfo.flags:M.split("+"),z=-1!==P.indexOf("location")&&Array.isArray(b.locations),S=-1!==P.indexOf("lon"),C=-1!==P.indexOf("lat"),R=-1!==P.indexOf("text"),D=[];return z?D.push(w.loc):S&&C?D.push("("+j(T.latLabel)+", "+j(T.lonLabel)+")"):S?D.push(L.lon+j(T.lonLabel)):C&&D.push(L.lat+j(T.latLabel)),R&&x(w,b,D),D.join("<br>")}function j(q){return q+"\xb0"}}(m,d,r,n[0].t.labels),r.hovertemplate=m.hovertemplate,[r]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),calcGeoJSON:v("./plot").calcGeoJSON,plot:v("./plot").plot,style:v("./style"),styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:v("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../lib/topojson_utils").getTopojsonFeatures,x=v("../../lib/geojson_utils"),e=v("../../lib/geo_location_utils"),r=v("../../plots/cartesian/autorange").findExtremes,i=v("../../constants/numerical").BADNUM,c=v("../scatter/calc").calcMarkerSize,n=v("../scatter/subtypes"),m=v("./style");Q.exports={calcGeoJSON:function(p,s){var f,l,o=p[0].trace,d=s[o.geo],u=d._subplot,a=o._length;if(Array.isArray(o.locations)){var y=o.locationmode,h="geojson-id"===y?e.extractTraceFeature(p):k(o,u.topojson);for(f=0;f<a;f++){l=p[f];var _="geojson-id"===y?l.fOut:e.locationToFeature(y,l.loc,h);l.lonlat=_?_.properties.ct:[i,i]}}var b,w,T={padded:!0};if("geojson"===d.fitbounds&&"geojson-id"===o.locationmode){var L=e.computeBbox(e.getTraceGeojson(o));b=[L[0],L[2]],w=[L[1],L[3]]}else{for(b=new Array(a),w=new Array(a),f=0;f<a;f++)b[f]=(l=p[f]).lonlat[0],w[f]=l.lonlat[1];T.ppad=c(o,a)}o._extremes.lon=r(d.lonaxis._ax,b,T),o._extremes.lat=r(d.lataxis._ax,w,T)},plot:function(p,s,f){var l=s.layers.frontplot.select(".scatterlayer"),o=t.makeTraceGroups(l,f,"trace scattergeo");function d(u,a){u.lonlat[0]===i&&g.select(a).remove()}o.selectAll("*").remove(),o.each(function(u){var a=g.select(this),y=u[0].trace;if(n.hasLines(y)||"none"!==y.fill){var h=x.calcTraceToLineCoords(u),_="none"!==y.fill?x.makePolygon(h):x.makeLine(h);a.selectAll("path.js-line").data([{geojson:_,trace:y}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}n.hasMarkers(y)&&a.selectAll("path.point").data(t.identity).enter().append("path").classed("point",!0).each(function(b){d(b,this)}),n.hasText(y)&&a.selectAll("g").data(t.identity).enter().append("g").append("text").each(function(b){d(b,this)}),m(p,u)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(v,Q,$){"use strict";var g=v("../scatter/subtypes"),t=v("../../constants/numerical").BADNUM;Q.exports=function(k,x){var e,r,i,c,n,m=k.cd,p=k.xaxis,s=k.yaxis,f=[],l=m[0].trace;if(!g.hasMarkers(l)&&!g.hasText(l))return[];if(!1===x)for(n=0;n<m.length;n++)m[n].selected=0;else for(n=0;n<m.length;n++)(r=(e=m[n]).lonlat)[0]!==t&&(i=p.c2p(r),c=s.c2p(r),x.contains([i,c],null,n,k)?(f.push({pointNumber:n,lon:r[0],lat:r[1]}),e.selected=1):e.selected=0);return f}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../../components/color"),x=v("../scatter/style"),e=x.stylePoints,r=x.styleText;Q.exports=function(i,c){var n,m,p,s;c&&(n=i,p=(m=c)[0].trace,(s=m[0].node3).style("opacity",m[0].trace.opacity),e(s,p,n),r(s,p,n),s.selectAll("path.js-line").style("fill","none").each(function(f){var l=g.select(this),o=f.trace,d=o.line||{};l.call(k.stroke,d.color).call(t.dashLine,d.dash||"",d.width||0),"none"!==o.fill&&l.call(k.fill,o.fillcolor)}))}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(v,Q,$){"use strict";var g=v("../../plots/attributes"),t=v("../scatter/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../components/colorscale/attributes"),e=v("../../lib/sort_object_keys"),r=v("../../lib/extend").extendFlat,i=v("../../plot_api/edit_types").overrideAll,c=v("./constants").DASHES,n=t.line,m=t.marker,p=m.line,s=Q.exports=i({x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:k("x"),yhoverformat:k("y"),text:t.text,hovertext:t.hovertext,textposition:t.textposition,textfont:t.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:n.color,width:n.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(c),dflt:"solid"}},marker:r({},x("marker"),{symbol:m.symbol,angle:m.angle,size:m.size,sizeref:m.sizeref,sizemin:m.sizemin,sizemode:m.sizemode,opacity:m.opacity,colorbar:m.colorbar,line:r({},x("marker.line"),{width:p.width})}),connectgaps:t.connectgaps,fill:r({},t.fill,{dflt:"none"}),fillcolor:t.fillcolor,selected:{marker:t.selected.marker,textfont:t.selected.textfont},unselected:{marker:t.unselected.marker,textfont:t.unselected.textfont},opacity:g.opacity},"calc","nested");s.x.editType=s.y.editType=s.x0.editType=s.y0.editType="calc+clearAxisTypes",s.hovertemplate=t.hovertemplate,s.texttemplate=t.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(v,Q,$){"use strict";var g=v("./hover");Q.exports={moduleType:"trace",name:"scattergl",basePlotModule:v("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../scatter/cross_trace_defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),hoverPoints:g.hoverPoints,selectPoints:v("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(v,Q,$){"use strict";var g=v("@plotly/point-cluster"),t=v("../../lib"),k=v("../../plots/cartesian/axis_ids"),x=v("../../plots/cartesian/autorange").findExtremes,e=v("../../plots/cartesian/align_period"),r=v("../scatter/calc"),i=r.calcMarkerSize,c=r.calcAxisExpansion,n=r.setFirstScatter,m=v("../scatter/colorscale_calc"),p=v("./convert"),s=v("./scene_update"),f=v("../../constants/numerical").BADNUM,l=v("./constants").TOO_MANY_POINTS;function o(d,u,a){var y=d._extremes[u._id],h=x(u,a._bnds,{padded:!0});y.min=y.min.concat(h.min),y.max=y.max.concat(h.max)}Q.exports=function(d,u){var a,y=d._fullLayout,h=u._xA=k.getFromId(d,u.xaxis,"x"),_=u._yA=k.getFromId(d,u.yaxis,"y"),b=y._plots[u.xaxis+u.yaxis],w=u._length,T=w>=l,L=2*w,M={},P=h.makeCalcdata(u,"x"),z=_.makeCalcdata(u,"y"),S=e(u,h,"x",P),C=e(u,_,"y",z),R=S.vals,D=C.vals;u._x=R,u._y=D,u.xperiodalignment&&(u._origX=P,u._xStarts=S.starts,u._xEnds=S.ends),u.yperiodalignment&&(u._origY=z,u._yStarts=C.starts,u._yEnds=C.ends);var j=new Array(L),q=new Array(w);for(a=0;a<w;a++)j[2*a]=R[a]===f?NaN:R[a],j[2*a+1]=D[a]===f?NaN:D[a],q[a]=a;if("log"===h.type)for(a=0;a<L;a+=2)j[a]=h.c2l(j[a]);if("log"===_.type)for(a=1;a<L;a+=2)j[a]=_.c2l(j[a]);T&&"log"!==h.type&&"log"!==_.type?M.tree=g(j):M.ids=q,m(d,u);var Z,W=function(X,ne,V,N,U,ee){var B=p.style(X,V);if(B.marker&&(B.marker.positions=N),B.line&&N.length>1&&t.extendFlat(B.line,p.linePositions(X,V,N)),B.errorX||B.errorY){var K=p.errorBarPositions(X,V,N,U,ee);B.errorX&&t.extendFlat(B.errorX,K.x),B.errorY&&t.extendFlat(B.errorY,K.y)}return B.text&&(t.extendFlat(B.text,{positions:N},p.textPosition(X,V,B.text,B.marker)),t.extendFlat(B.textSel,{positions:N},p.textPosition(X,V,B.text,B.markerSel)),t.extendFlat(B.textUnsel,{positions:N},p.textPosition(X,V,B.text,B.markerUnsel))),B}(d,0,u,j,R,D),G=s(d,b);return n(y,u),T?W.marker&&(Z=W.marker.sizeAvg||Math.max(W.marker.size,3)):Z=i(u,w),c(d,u,h,_,R,D,Z),W.errorX&&o(u,h,W.errorX),W.errorY&&o(u,_,W.errorY),W.fill&&!G.fill2d&&(G.fill2d=!0),W.marker&&!G.scatter2d&&(G.scatter2d=!0),W.line&&!G.line2d&&(G.line2d=!0),!W.errorX&&!W.errorY||G.error2d||(G.error2d=!0),W.text&&!G.glText&&(G.glText=!0),W.marker&&(W.marker.snap=w),G.lineOptions.push(W.line),G.errorXOptions.push(W.errorX),G.errorYOptions.push(W.errorY),G.fillOptions.push(W.fill),G.markerOptions.push(W.marker),G.markerSelectedOptions.push(W.markerSel),G.markerUnselectedOptions.push(W.markerUnsel),G.textOptions.push(W.text),G.textSelectedOptions.push(W.textSel),G.textUnselectedOptions.push(W.textUnsel),G.selectBatch.push([]),G.unselectBatch.push([]),M._scene=G,M.index=G.count,M.x=R,M.y=D,M.positions=j,G.count++,[{x:!1,y:!1,t:M,trace:u}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(v,Q,$){"use strict";Q.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("svg-path-sdf"),k=v("color-normalize"),x=v("../../registry"),e=v("../../lib"),r=v("../../components/drawing"),i=v("../../plots/cartesian/axis_ids"),c=v("../../lib/gl_format_color").formatColor,n=v("../scatter/subtypes"),m=v("../scatter/make_bubble_size_func"),p=v("./helpers"),s=v("./constants"),f=v("../../constants/interactions").DESELECTDIM,l={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},o=v("../../components/fx/helpers").appendArrayPointValue;function d(P,z){var S,C=P._fullLayout,R=z._length,D=z.textfont,j=z.textposition,q=Array.isArray(j)?j:[j],Z=D.color,W=D.size,G=D.family,X={},ne=P._context.plotGlPixelRatio,V=z.texttemplate;if(V){X.text=[];var N=C._d3locale,U=Array.isArray(V),ee=U?Math.min(V.length,R):R,B=U?function(ve){return V[ve]}:function(){return V};for(S=0;S<ee;S++){var K={i:S},J=z._module.formatLabels(K,z,C),te={};o(te,z,S);var ae=z._meta||{};X.text.push(e.texttemplateString(B(S),J,N,te,K,ae))}}else X.text=Array.isArray(z.text)&&z.text.length<R?z.text.slice():z.text;if(Array.isArray(X.text))for(S=X.text.length;S<R;S++)X.text[S]="";for(X.opacity=z.opacity,X.font={},X.align=[],X.baseline=[],S=0;S<q.length;S++){var ce=q[S].split(/\s+/);switch(ce[1]){case"left":X.align.push("right");break;case"right":X.align.push("left");break;default:X.align.push(ce[1])}switch(ce[0]){case"top":X.baseline.push("bottom");break;case"bottom":X.baseline.push("top");break;default:X.baseline.push(ce[0])}}if(Array.isArray(Z))for(X.color=new Array(R),S=0;S<R;S++)X.color[S]=Z[S];else X.color=Z;if(e.isArrayOrTypedArray(W)||Array.isArray(G))for(X.font=new Array(R),S=0;S<R;S++){var oe=X.font[S]={};oe.size=(e.isTypedArray(W)?W[S]:Array.isArray(W)?g(W[S])?W[S]:0:W)*ne,oe.family=Array.isArray(G)?G[S]:G}else X.font={size:W*ne,family:G};return X}function u(P,z){var S,C,R=z._length,D=z.marker,j={},q=e.isArrayOrTypedArray(D.symbol),Z=e.isArrayOrTypedArray(D.angle),W=e.isArrayOrTypedArray(D.color),G=e.isArrayOrTypedArray(D.line.color),X=e.isArrayOrTypedArray(D.opacity),ne=e.isArrayOrTypedArray(D.size),V=e.isArrayOrTypedArray(D.line.width);if(q||(C=p.isOpenSymbol(D.symbol)),q||W||G||X||Z){j.symbols=new Array(R),j.angles=new Array(R),j.colors=new Array(R),j.borderColors=new Array(R);var N=D.symbol,U=D.angle,ee=c(D,D.opacity,R),B=c(D.line,D.opacity,R);if(!Array.isArray(B[0])){var K=B;for(B=Array(R),S=0;S<R;S++)B[S]=K}if(!Array.isArray(ee[0])){var J=ee;for(ee=Array(R),S=0;S<R;S++)ee[S]=J}if(!Array.isArray(N)){var te=N;for(N=Array(R),S=0;S<R;S++)N[S]=te}if(!Array.isArray(U)){var ae=U;for(U=Array(R),S=0;S<R;S++)U[S]=ae}for(j.symbols=N,j.angles=U,j.colors=ee,j.borderColors=B,S=0;S<R;S++)q&&(C=p.isOpenSymbol(D.symbol[S])),C&&(B[S]=ee[S].slice(),ee[S]=ee[S].slice(),ee[S][3]=0);for(j.opacity=z.opacity,j.markers=new Array(R),S=0;S<R;S++)j.markers[S]=M({mx:j.symbols[S],ma:j.angles[S]},z)}else C?(j.color=k(D.color,"uint8"),j.color[3]=0,j.borderColor=k(D.color,"uint8")):(j.color=k(D.color,"uint8"),j.borderColor=k(D.line.color,"uint8")),j.opacity=z.opacity*D.opacity,j.marker=M({mx:D.symbol,ma:D.angle},z);var ce,oe=m(z,1);if(ne||V){var ve,fe=j.sizes=new Array(R),xe=j.borderSizes=new Array(R),Se=0;if(ne){for(S=0;S<R;S++)fe[S]=oe(D.size[S]),Se+=fe[S];ve=Se/R}else for(ce=oe(D.size),S=0;S<R;S++)fe[S]=ce;if(V)for(S=0;S<R;S++)xe[S]=D.line.width[S];else for(ce=D.line.width,S=0;S<R;S++)xe[S]=ce;j.sizeAvg=ve}else j.size=oe(D&&D.size||10),j.borderSizes=oe(D.line.width);return j}function a(P,z,S){var R={};return S&&(S.marker&&S.marker.symbol?R=u(0,e.extendFlat({},z.marker,S.marker)):S.marker&&(S.marker.size&&(R.size=S.marker.size),S.marker.color&&(R.colors=S.marker.color),void 0!==S.marker.opacity&&(R.opacity=S.marker.opacity))),R}function y(P,z,S){var C={};if(!S)return C;if(S.textfont){var R={opacity:1,text:z.text,texttemplate:z.texttemplate,textposition:z.textposition,textfont:e.extendFlat({},z.textfont)};S.textfont&&e.extendFlat(R.textfont,S.textfont),C=d(P,R)}return C}function h(P,z,S){var C={capSize:2*z.width*S,lineWidth:z.thickness*S,color:z.color};return z.copy_ystyle&&(C=P.error_y),C}var _=s.SYMBOL_SDF_SIZE,b=s.SYMBOL_SIZE,w=s.SYMBOL_STROKE,T={},L=r.symbolFuncs[0](.05*b);function M(P,z){var S,C,R=P.mx;if("circle"===R)return null;var D=r.symbolNumber(R),j=r.symbolFuncs[D%100],q=!!r.symbolNoDot[D%100],Z=!!r.symbolNoFill[D%100],W=p.isDotSymbol(R);if(P.ma&&(R+="_"+P.ma),T[R])return T[R];var G=r.getMarkerAngle(P,z);return S=W&&!q?j(1.1*b,G)+L:j(b,G),C=t(S,{w:_,h:_,viewBox:[-b,-b,b,b],stroke:Z?w:-w}),T[R]=C,C||null}Q.exports={style:function(P,z){var S,C={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},R=P._context.plotGlPixelRatio;if(!0!==z.visible)return C;if(n.hasText(z)&&(C.text=d(P,z),C.textSel=y(P,z,z.selected),C.textUnsel=y(P,z,z.unselected)),n.hasMarkers(z)&&(C.marker=u(0,z),C.markerSel=a(0,z,z.selected),C.markerUnsel=a(0,z,z.unselected),!z.unselected&&e.isArrayOrTypedArray(z.marker.opacity))){var D=z.marker.opacity;for(C.markerUnsel.opacity=new Array(D.length),S=0;S<D.length;S++)C.markerUnsel.opacity[S]=f*D[S]}if(n.hasLines(z)){C.line={overlay:!0,thickness:z.line.width*R,color:z.line.color,opacity:z.opacity};var j=(s.DASHES[z.line.dash]||[1]).slice();for(S=0;S<j.length;++S)j[S]*=z.line.width*R;C.line.dashes=j}return z.error_x&&z.error_x.visible&&(C.errorX=h(z,z.error_x,R)),z.error_y&&z.error_y.visible&&(C.errorY=h(z,z.error_y,R)),z.fill&&"none"!==z.fill&&(C.fill={closed:!0,fill:z.fillcolor,thickness:0}),C},markerStyle:u,markerSelection:a,linePositions:function(P,z,S){var C,R,D=S.length,j=D/2;if(n.hasLines(z)&&j)if("hv"===z.line.shape){for(C=[],R=0;R<j-1;R++)isNaN(S[2*R])||isNaN(S[2*R+1])?C.push(NaN,NaN,NaN,NaN):(C.push(S[2*R],S[2*R+1]),isNaN(S[2*R+2])||isNaN(S[2*R+3])?C.push(NaN,NaN):C.push(S[2*R+2],S[2*R+1]));C.push(S[D-2],S[D-1])}else if("hvh"===z.line.shape){for(C=[],R=0;R<j-1;R++)if(isNaN(S[2*R])||isNaN(S[2*R+1])||isNaN(S[2*R+2])||isNaN(S[2*R+3]))isNaN(S[2*R])||isNaN(S[2*R+1])?C.push(NaN,NaN):C.push(S[2*R],S[2*R+1]),C.push(NaN,NaN);else{var q=(S[2*R]+S[2*R+2])/2;C.push(S[2*R],S[2*R+1],q,S[2*R+1],q,S[2*R+3])}C.push(S[D-2],S[D-1])}else if("vhv"===z.line.shape){for(C=[],R=0;R<j-1;R++)if(isNaN(S[2*R])||isNaN(S[2*R+1])||isNaN(S[2*R+2])||isNaN(S[2*R+3]))isNaN(S[2*R])||isNaN(S[2*R+1])?C.push(NaN,NaN):C.push(S[2*R],S[2*R+1]),C.push(NaN,NaN);else{var Z=(S[2*R+1]+S[2*R+3])/2;C.push(S[2*R],S[2*R+1],S[2*R],Z,S[2*R+2],Z)}C.push(S[D-2],S[D-1])}else if("vh"===z.line.shape){for(C=[],R=0;R<j-1;R++)isNaN(S[2*R])||isNaN(S[2*R+1])?C.push(NaN,NaN,NaN,NaN):(C.push(S[2*R],S[2*R+1]),isNaN(S[2*R+2])||isNaN(S[2*R+3])?C.push(NaN,NaN):C.push(S[2*R],S[2*R+3]));C.push(S[D-2],S[D-1])}else C=S;var W=!1;for(R=0;R<C.length;R++)if(isNaN(C[R])){W=!0;break}var G=W||C.length>s.TOO_MANY_POINTS||n.hasMarkers(z)?"rect":"round";if(W&&z.connectgaps){var X=C[0],ne=C[1];for(R=0;R<C.length;R+=2)isNaN(C[R])||isNaN(C[R+1])?(C[R]=X,C[R+1]=ne):(X=C[R],ne=C[R+1])}return{join:G,positions:C}},errorBarPositions:function(P,z,S,C,R){var D=x.getComponentMethod("errorbars","makeComputeError"),j=i.getFromId(P,z.xaxis,"x"),q=i.getFromId(P,z.yaxis,"y"),Z=S.length/2,W={};function G(X,ne){var V=ne._id.charAt(0),N=z["error_"+V];if(N&&N.visible&&("linear"===ne.type||"log"===ne.type)){for(var U=D(N),ee={x:0,y:1}[V],B={x:[0,1,2,3],y:[2,3,0,1]}[V],K=new Float64Array(4*Z),J=1/0,te=-1/0,ae=0,ce=0;ae<Z;ae++,ce+=4){var oe=X[ae];if(g(oe)){var ve=S[2*ae+ee],fe=U(oe,ae),xe=fe[0],Se=fe[1];if(g(xe)&&g(Se)){var ge=oe+Se;K[ce+B[0]]=ve-ne.c2l(oe-xe),K[ce+B[1]]=ne.c2l(ge)-ve,K[ce+B[2]]=0,K[ce+B[3]]=0,J=Math.min(J,oe-xe),te=Math.max(te,oe+Se)}}}W[V]={positions:S,errors:K,_bnds:[J,te]}}}return G(C,j),G(R,q),W},textPosition:function(P,z,S,C){var R,D=z._length,j={};if(n.hasMarkers(z)){var q=S.font,Z=S.align,W=S.baseline;for(j.offset=new Array(D),R=0;R<D;R++){var G=C.sizes?C.sizes[R]:C.size,X=Array.isArray(q)?q[R].size:q.size,ne=Array.isArray(Z)?Z.length>1?Z[R]:Z[0]:Z,V=Array.isArray(W)?W.length>1?W[R]:W[0]:W,U=l[V],ee=G?G/.8+1:0;j.offset[R]=[l[ne]*ee/X,(-U*ee-.5*U)/X]}}return j}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../registry"),k=v("./helpers"),x=v("./attributes"),e=v("../scatter/constants"),r=v("../scatter/subtypes"),i=v("../scatter/xy_defaults"),c=v("../scatter/period_defaults"),n=v("../scatter/marker_defaults"),m=v("../scatter/line_defaults"),p=v("../scatter/fillcolor_defaults"),s=v("../scatter/text_defaults");Q.exports=function(f,l,o,d){function u(L,M){return g.coerce(f,l,x,L,M)}var a=!!f.marker&&k.isOpenSymbol(f.marker.symbol),y=r.isBubble(f),h=i(f,l,d,u);if(h){c(f,l,d,u),u("xhoverformat"),u("yhoverformat");var _=h<e.PTS_LINESONLY?"lines+markers":"lines";u("text"),u("hovertext"),u("hovertemplate"),u("mode",_),r.hasLines(l)&&(u("connectgaps"),m(f,l,o,d,u),u("line.shape")),r.hasMarkers(l)&&(n(f,l,o,d,u,{noAngleRef:!0,noStandOff:!0}),u("marker.line.width",a||y?1:0)),r.hasText(l)&&(u("texttemplate"),s(f,l,d,u));var b=(l.line||{}).color,w=(l.marker||{}).color;u("fill"),"none"!==l.fill&&p(f,l,o,u);var T=t.getComponentMethod("errorbars","supplyDefaults");T(f,l,b||w||o,{axis:"y"}),T(f,l,b||w||o,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(l,u)}else l.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../../constants/interactions").DESELECTDIM;Q.exports={styleTextSelection:function(x){var e,r,i=x[0],c=i.trace,n=i.t,m=n._scene,p=n.index,s=m.selectBatch[p],f=m.unselectBatch[p],l=m.textOptions[p],o=m.textSelectedOptions[p]||{},d=m.textUnselectedOptions[p]||{},u=g.extendFlat({},l);if(s.length||f.length){var a=o.color,y=d.color,h=l.color,_=Array.isArray(h);for(u.color=new Array(c._length),e=0;e<s.length;e++)u.color[r=s[e]]=a||(_?h[r]:h);for(e=0;e<f.length;e++){r=f[e];var b=_?h[r]:h;u.color[r]=y||(a?b:t.addOpacity(b,k))}}m.glText[p].update(u)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(v,Q,$){"use strict";var g=v("../scatter/format_labels");Q.exports=function(t,k,x){var e=t.i;return"x"in t||(t.x=k._x[e]),"y"in t||(t.y=k._y[e]),g(t,k,x)}},{"../scatter/format_labels":945}],996:[function(v,Q,$){"use strict";var g=v("./constants");$.isOpenSymbol=function(t){return"string"==typeof t?g.OPEN_RE.test(t):t%200>100},$.isDotSymbol=function(t){return"string"==typeof t?g.DOT_RE.test(t):t>200}},{"./constants":991}],997:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../scatter/get_trace_color");function x(e,r,i,c){var n=e.xa,m=e.ya,p=e.distance,s=e.dxy,f=e.index,l={pointNumber:f,x:r[f],y:i[f]};l.tx=Array.isArray(c.text)?c.text[f]:c.text,l.htx=Array.isArray(c.hovertext)?c.hovertext[f]:c.hovertext,l.data=Array.isArray(c.customdata)?c.customdata[f]:c.customdata,l.tp=Array.isArray(c.textposition)?c.textposition[f]:c.textposition;var o=c.textfont;o&&(l.ts=t.isArrayOrTypedArray(o.size)?o.size[f]:o.size,l.tc=Array.isArray(o.color)?o.color[f]:o.color,l.tf=Array.isArray(o.family)?o.family[f]:o.family);var d=c.marker;d&&(l.ms=t.isArrayOrTypedArray(d.size)?d.size[f]:d.size,l.mo=t.isArrayOrTypedArray(d.opacity)?d.opacity[f]:d.opacity,l.mx=t.isArrayOrTypedArray(d.symbol)?d.symbol[f]:d.symbol,l.ma=t.isArrayOrTypedArray(d.angle)?d.angle[f]:d.angle,l.mc=t.isArrayOrTypedArray(d.color)?d.color[f]:d.color);var u=d&&d.line;u&&(l.mlc=Array.isArray(u.color)?u.color[f]:u.color,l.mlw=t.isArrayOrTypedArray(u.width)?u.width[f]:u.width);var a=d&&d.gradient;a&&"none"!==a.type&&(l.mgt=Array.isArray(a.type)?a.type[f]:a.type,l.mgc=Array.isArray(a.color)?a.color[f]:a.color);var y=n.c2p(l.x,!0),h=m.c2p(l.y,!0),_=l.mrc||1,b=c.hoverlabel;b&&(l.hbg=Array.isArray(b.bgcolor)?b.bgcolor[f]:b.bgcolor,l.hbc=Array.isArray(b.bordercolor)?b.bordercolor[f]:b.bordercolor,l.hts=t.isArrayOrTypedArray(b.font.size)?b.font.size[f]:b.font.size,l.htc=Array.isArray(b.font.color)?b.font.color[f]:b.font.color,l.htf=Array.isArray(b.font.family)?b.font.family[f]:b.font.family,l.hnl=t.isArrayOrTypedArray(b.namelength)?b.namelength[f]:b.namelength);var w=c.hoverinfo;w&&(l.hi=Array.isArray(w)?w[f]:w);var T=c.hovertemplate;T&&(l.ht=Array.isArray(T)?T[f]:T);var L={};L[e.index]=l;var M=c._origX,P=c._origY,z=t.extendFlat({},e,{color:k(c,l),x0:y-_,x1:y+_,xLabelVal:M?M[f]:l.x,y0:h-_,y1:h+_,yLabelVal:P?P[f]:l.y,cd:L,distance:p,spikeDistance:s,hovertemplate:l.ht});return l.htx?z.text=l.htx:l.tx?z.text=l.tx:c.text&&(z.text=c.text),t.fillText(l,c,z),g.getComponentMethod("errorbars","hoverInfo")(l,c,z),z}Q.exports={hoverPoints:function(e,r,i,c){var n,m,p,s,f,l,o,d,u,a,y=e.cd,h=y[0].t,_=y[0].trace,b=e.xa,w=e.ya,T=h.x,L=h.y,M=b.c2p(r),P=w.c2p(i),z=e.distance;if(h.tree){var S=b.p2c(M-z),C=b.p2c(M+z),R=w.p2c(P-z),D=w.p2c(P+z);n="x"===c?h.tree.range(Math.min(S,C),Math.min(w._rl[0],w._rl[1]),Math.max(S,C),Math.max(w._rl[0],w._rl[1])):h.tree.range(Math.min(S,C),Math.min(R,D),Math.max(S,C),Math.max(R,D))}else n=h.ids;var j=z;if("x"===c){var q=!!_.xperiodalignment,Z=!!_.yperiodalignment;for(l=0;l<n.length;l++){if(s=T[m=n[l]],o=Math.abs(b.c2p(s)-M),q){var W=b.c2p(_._xStarts[m]),G=b.c2p(_._xEnds[m]);o=M>=Math.min(W,G)&&M<=Math.max(W,G)?0:1/0}if(o<j){if(j=o,d=w.c2p(f=L[m])-P,Z){var X=w.c2p(_._yStarts[m]),ne=w.c2p(_._yEnds[m]);d=P>=Math.min(X,ne)&&P<=Math.max(X,ne)?0:1/0}a=Math.sqrt(o*o+d*d),p=n[l]}}}else for(l=n.length-1;l>-1;l--)s=T[m=n[l]],f=L[m],o=b.c2p(s)-M,d=w.c2p(f)-P,(u=Math.sqrt(o*o+d*d))<j&&(j=a=u,p=m);return e.index=p,e.distance=j,e.dxy=a,void 0===p?[e]:[x(e,T,L,_)]},calcHover:x}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(v,Q,$){arguments[4][905][0].apply($,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(v,Q,$){"use strict";var g=v("regl-scatter2d"),t=v("regl-line2d"),k=v("regl-error2d"),x=v("gl-text"),e=v("../../lib"),r=v("../../components/dragelement/helpers").selectMode,i=v("../../lib/prepare_regl"),c=v("../scatter/subtypes"),n=v("../scatter/link_traces"),m=v("./edit_style").styleTextSelection,p={};function s(f,l,o,d){var u=f._size,T=u.w*d,L=u.h*d;return[u.l*d+l.domain[0]*T,u.b*d+o.domain[0]*L,f.width*d-u.r*d-(1-l.domain[1])*T,f.height*d-u.t*d-(1-o.domain[1])*L]}(Q.exports=function(f,l,o){if(o.length){var d,u,a=f._fullLayout,y=l._scene,h=l.xaxis,_=l.yaxis;if(y)if(i(f,["ANGLE_instanced_arrays","OES_element_index_uint"],p)){var b=y.count,w=a._glcanvas.data()[0].regl;if(n(f,l,o),y.dirty){if(!0===y.error2d&&(y.error2d=k(w)),!0===y.line2d&&(y.line2d=t(w)),!0===y.scatter2d&&(y.scatter2d=g(w)),!0===y.fill2d&&(y.fill2d=t(w)),!0===y.glText)for(y.glText=new Array(b),d=0;d<b;d++)y.glText[d]=new x(w);if(y.glText){if(b>y.glText.length){var T=b-y.glText.length;for(d=0;d<T;d++)y.glText.push(new x(w))}else b<y.glText.length&&y.glText.splice(b,y.glText.length-b).forEach(function(K){K.destroy()});for(d=0;d<b;d++)y.glText[d].update(y.textOptions[d])}if(y.line2d&&(y.line2d.update(y.lineOptions),y.lineOptions=y.lineOptions.map(function(K){if(K&&K.positions){for(var J=K.positions,te=0;te<J.length&&(isNaN(J[te])||isNaN(J[te+1]));)te+=2;for(var ae=J.length-2;ae>te&&(isNaN(J[ae])||isNaN(J[ae+1]));)ae-=2;K.positions=J.slice(te,ae+2)}return K}),y.line2d.update(y.lineOptions)),y.error2d){var M=(y.errorXOptions||[]).concat(y.errorYOptions||[]);y.error2d.update(M)}y.scatter2d&&y.scatter2d.update(y.markerOptions),y.fillOrder=e.repeat(null,b),y.fill2d&&(y.fillOptions=y.fillOptions.map(function(K,J){var te=o[J];if(K&&te&&te[0]&&te[0].trace){var ae,ce,oe=te[0],ve=oe.trace,fe=oe.t,xe=y.lineOptions[J],Se=[];ve._ownfill&&Se.push(J),ve._nexttrace&&Se.push(J+1),Se.length&&(y.fillOrder[J]=Se);var pe,ge,Te=[],se=xe&&xe.positions||fe.positions;if("tozeroy"===ve.fill){for(pe=0;pe<se.length&&isNaN(se[pe+1]);)pe+=2;for(ge=se.length-2;ge>pe&&isNaN(se[ge+1]);)ge-=2;0!==se[pe+1]&&(Te=[se[pe],0]),Te=Te.concat(se.slice(pe,ge+2)),0!==se[ge+1]&&(Te=Te.concat([se[ge],0]))}else if("tozerox"===ve.fill){for(pe=0;pe<se.length&&isNaN(se[pe]);)pe+=2;for(ge=se.length-2;ge>pe&&isNaN(se[ge]);)ge-=2;0!==se[pe]&&(Te=[0,se[pe+1]]),Te=Te.concat(se.slice(pe,ge+2)),0!==se[ge]&&(Te=Te.concat([0,se[ge+1]]))}else if("toself"===ve.fill||"tonext"===ve.fill){for(Te=[],ae=0,K.splitNull=!0,ce=0;ce<se.length;ce+=2)(isNaN(se[ce])||isNaN(se[ce+1]))&&((Te=Te.concat(se.slice(ae,ce))).push(se[ae],se[ae+1]),Te.push(null,null),ae=ce+2);Te=Te.concat(se.slice(ae)),ae&&Te.push(se[ae],se[ae+1])}else{var de=ve._nexttrace;if(de){var Ae=y.lineOptions[J+1];if(Ae){var Le=Ae.positions;if("tonexty"===ve.fill){for(Te=se.slice(),J=Math.floor(Le.length/2);J--;){var Me=Le[2*J],De=Le[2*J+1];isNaN(Me)||isNaN(De)||Te.push(Me,De)}K.fill=de.fillcolor}}}}if(ve._prevtrace&&"tonext"===ve._prevtrace.fill){var Oe=y.lineOptions[J-1].positions,Ie=Te.length/2,Qe=[ae=Ie];for(ce=0;ce<Oe.length;ce+=2)(isNaN(Oe[ce])||isNaN(Oe[ce+1]))&&(Qe.push(ce/2+Ie+1),ae=ce+2);Te=Te.concat(Oe),K.hole=Qe}return K.fillmode=ve.fill,K.opacity=ve.opacity,K.positions=Te,K}}),y.fill2d.update(y.fillOptions))}var z=r(a.dragmode),S=a.clickmode.indexOf("select")>-1;for(d=0;d<b;d++){var C=o[d][0],R=C.trace,D=C.t,j=D.index,q=R._length,Z=D.x,W=D.y;if(R.selectedpoints||z||S){if(z||(z=!0),R.selectedpoints){var G=y.selectBatch[j]=e.selIndices2selPoints(R),X={};for(u=0;u<G.length;u++)X[G[u]]=1;var ne=[];for(u=0;u<q;u++)X[u]||ne.push(u);y.unselectBatch[j]=ne}var V=D.xpx=new Array(q),N=D.ypx=new Array(q);for(u=0;u<q;u++)V[u]=h.c2p(Z[u]),N[u]=_.c2p(W[u])}else D.xpx=D.ypx=null}if(z){if(y.select2d||(y.select2d=g(a._glcanvas.data()[1].regl)),y.scatter2d){var U=new Array(b);for(d=0;d<b;d++)U[d]=y.selectBatch[d].length||y.unselectBatch[d].length?y.markerUnselectedOptions[d]:{};y.scatter2d.update(U)}y.select2d&&(y.select2d.update(y.markerOptions),y.select2d.update(y.markerSelectedOptions)),y.glText&&o.forEach(function(K){c.hasText(((K||[])[0]||{}).trace||{})&&m(K)})}else y.scatter2d&&y.scatter2d.update(y.markerOptions);var ee={viewport:s(a,h,_,f._context.plotGlPixelRatio),range:[(h._rl||h.range)[0],(_._rl||_.range)[0],(h._rl||h.range)[1],(_._rl||_.range)[1]]},B=e.repeat(ee,y.count);y.fill2d&&y.fill2d.update(B),y.line2d&&y.line2d.update(B),y.error2d&&y.error2d.update(B.concat(B)),y.scatter2d&&y.scatter2d.update(B),y.select2d&&y.select2d.update(B),y.glText&&y.glText.forEach(function(K){K.update(ee)})}else y.init()}}).reglPrecompiled=p},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){var x=k._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},r={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return k._scene||((x=k._scene={}).init=function(){g.extendFlat(x,r,e)},x.init(),x.update=function(i){var c=g.repeat(i,x.count);if(x.fill2d&&x.fill2d.update(c),x.scatter2d&&x.scatter2d.update(c),x.line2d&&x.line2d.update(c),x.error2d&&x.error2d.update(c.concat(c)),x.select2d&&x.select2d.update(c),x.glText)for(var n=0;n<x.count;n++)x.glText[n].update(i)},x.draw=function(){for(var i=x.count,c=x.fill2d,n=x.error2d,m=x.line2d,p=x.scatter2d,s=x.glText,f=x.select2d,l=x.selectBatch,o=x.unselectBatch,d=0;d<i;d++){if(c&&x.fillOrder[d]&&c.draw(x.fillOrder[d]),m&&x.lineOptions[d]&&m.draw(d),n&&(x.errorXOptions[d]&&n.draw(d),x.errorYOptions[d]&&n.draw(d+i)),p&&x.markerOptions[d])if(o[d].length){var u=g.repeat([],x.count);u[d]=o[d],p.draw(u)}else l[d].length||p.draw(d);s[d]&&x.textOptions[d]&&s[d].render()}f&&f.draw(l),x.dirty=!1},x.destroy=function(){x.fill2d&&x.fill2d.destroy&&x.fill2d.destroy(),x.scatter2d&&x.scatter2d.destroy&&x.scatter2d.destroy(),x.error2d&&x.error2d.destroy&&x.error2d.destroy(),x.line2d&&x.line2d.destroy&&x.line2d.destroy(),x.select2d&&x.select2d.destroy&&x.select2d.destroy(),x.glText&&x.glText.forEach(function(i){i.destroy&&i.destroy()}),x.lineOptions=null,x.fillOptions=null,x.markerOptions=null,x.markerSelectedOptions=null,x.markerUnselectedOptions=null,x.errorXOptions=null,x.errorYOptions=null,x.textOptions=null,x.textSelectedOptions=null,x.textUnselectedOptions=null,x.selectBatch=null,x.unselectBatch=null,k._scene=null}),x.dirty||g.extendFlat(x,e),x}},{"../../lib":515}],1001:[function(v,Q,$){"use strict";var g=v("../scatter/subtypes"),t=v("./edit_style").styleTextSelection;Q.exports=function(k,x){var e=k.cd,r=k.xaxis,i=k.yaxis,c=[],n=e[0].trace,m=e[0].t,p=n._length,s=m.x,f=m.y,l=m._scene,o=m.index;if(!l)return c;var d=g.hasText(n),u=g.hasMarkers(n);if(!0!==n.visible||!u&&!d)return c;var y=[],h=[];if(!1!==x&&!x.degenerate)for(var _=0;_<p;_++)x.contains([m.xpx[_],m.ypx[_]],!1,_,k)?(y.push(_),c.push({pointNumber:_,x:r.c2d(s[_]),y:i.c2d(f[_])})):h.push(_);if(u){var b=l.scatter2d;if(y.length||h.length){if(!l.selectBatch[o].length&&!l.unselectBatch[o].length){var w=new Array(l.count);w[o]=l.markerUnselectedOptions[o],b.update.apply(b,w)}}else{var T=new Array(l.count);T[o]=l.markerOptions[o],b.update.apply(b,T)}}return l.selectBatch[o]=y,l.unselectBatch[o]=h,d&&t(e),c}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../scattergeo/attributes"),x=v("../scatter/attributes"),e=v("../../plots/mapbox/layout_attributes"),r=v("../../plots/attributes"),i=v("../../components/colorscale/attributes"),c=v("../../lib/extend").extendFlat,n=v("../../plot_api/edit_types").overrideAll,m=v("../../plots/mapbox/layout_attributes"),p=k.line,s=k.marker;Q.exports=n({lon:k.lon,lat:k.lat,cluster:{enabled:{valType:"boolean"},maxzoom:c({},m.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:c({},s.opacity,{dflt:1})},mode:c({},x.mode,{dflt:"markers"}),text:c({},x.text,{}),texttemplate:t({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:c({},x.hovertext,{}),line:{color:p.color,width:p.width},connectgaps:x.connectgaps,marker:c({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:s.opacity,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode},i("marker")),fill:k.fill,fillcolor:x.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:x.selected.marker},unselected:{marker:x.unselected.marker},hoverinfo:c({},r.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:g()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../lib"),k=v("../../constants/numerical").BADNUM,x=v("../../lib/geojson_utils"),e=v("../../components/colorscale"),r=v("../../components/drawing"),i=v("../scatter/make_bubble_size_func"),c=v("../scatter/subtypes"),n=v("../../plots/mapbox/convert_text_opts"),m=v("../../components/fx/helpers").appendArrayPointValue,p=v("../../lib/svg_text_utils").NEWLINES,s=v("../../lib/svg_text_utils").BR_TAG_ALL;function f(a){return{type:a,geojson:x.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function l(a,y){return t.isArrayOrTypedArray(a)?y?function(h){return g(a[h])?+a[h]:0}:function(h){return a[h]}:a?function(){return a}:o}function o(){return""}function d(a){return a[0]===k}function u(a,y){var h;if(t.isArrayOrTypedArray(a)&&t.isArrayOrTypedArray(y)){h=["step",["get","point_count"],a[0]];for(var _=1;_<a.length;_++)h.push(y[_-1],a[_])}else h=a;return h}Q.exports=function(a,y){var h,_=y[0].trace,b=!0===_.visible&&0!==_._length,w="none"!==_.fill,T=c.hasLines(_),L=c.hasMarkers(_),M=c.hasText(_),P=L&&"circle"===_.marker.symbol,z=L&&"circle"!==_.marker.symbol,S=_.cluster&&_.cluster.enabled,C=f("fill"),R=f("line"),D=f("circle"),j=f("symbol"),q={fill:C,line:R,circle:D,symbol:j};if(!b)return q;if((w||T)&&(h=x.calcTraceToLineCoords(y)),w&&(C.geojson=x.makePolygon(h),C.layout.visibility="visible",t.extendFlat(C.paint,{"fill-color":_.fillcolor})),T&&(R.geojson=x.makeLine(h),R.layout.visibility="visible",t.extendFlat(R.paint,{"line-width":_.line.width,"line-color":_.line.color,"line-opacity":_.opacity})),P){var Z=function(X){var ne,V,N,U,ee=X[0].trace,B=ee.marker,K=ee.selectedpoints,J=t.isArrayOrTypedArray(B.color),te=t.isArrayOrTypedArray(B.size),ae=t.isArrayOrTypedArray(B.opacity);function ce(Te){return ee.opacity*Te}J&&(V=e.hasColorscale(ee,"marker")?e.makeColorScaleFuncFromTrace(B):t.identity),te&&(N=i(ee)),ae&&(U=function(Te){return ce(g(Te)?+t.constrain(Te,0,1):0)});var oe,ge,ve=[];for(ne=0;ne<X.length;ne++){var fe=X[ne],xe=fe.lonlat;if(!d(xe)){var Se={};V&&(Se.mcc=fe.mcc=V(fe.mc)),N&&(Se.mrc=fe.mrc=N(fe.ms)),U&&(Se.mo=U(fe.mo)),K&&(Se.selected=fe.selected||0),ve.push({type:"Feature",id:ne+1,geometry:{type:"Point",coordinates:xe},properties:Se})}}if(K)for(oe=r.makeSelectedPointStyleFns(ee),ne=0;ne<ve.length;ne++){var pe=ve[ne].properties;oe.selectedOpacityFn&&(pe.mo=ce(oe.selectedOpacityFn(pe))),oe.selectedColorFn&&(pe.mcc=oe.selectedColorFn(pe)),oe.selectedSizeFn&&(pe.mrc=oe.selectedSizeFn(pe))}return{geojson:{type:"FeatureCollection",features:ve},mcc:J||oe&&oe.selectedColorFn?{type:"identity",property:"mcc"}:B.color,mrc:te||oe&&oe.selectedSizeFn?{type:"identity",property:"mrc"}:(ge=B.size,ge/2),mo:ae||oe&&oe.selectedOpacityFn?{type:"identity",property:"mo"}:ce(B.opacity)}}(y);D.geojson=Z.geojson,D.layout.visibility="visible",S&&(D.filter=["!",["has","point_count"]],q.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":u(_.cluster.color,_.cluster.step),"circle-radius":u(_.cluster.size,_.cluster.step),"circle-opacity":u(_.cluster.opacity,_.cluster.step)}},q.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),t.extendFlat(D.paint,{"circle-color":Z.mcc,"circle-radius":Z.mrc,"circle-opacity":Z.mo})}if(P&&S&&(D.filter=["!",["has","point_count"]]),(z||M)&&(j.geojson=function(X,ne){for(var V=ne._fullLayout,N=X[0].trace,U=N.marker||{},ee=U.symbol,B=U.angle,K="circle"!==ee?l(ee):o,J="auto"!==B?l(B,!0):o,te=c.hasText(N)?l(N.text):o,ae=[],ce=0;ce<X.length;ce++){var oe=X[ce];if(!d(oe.lonlat)){var ve,fe=N.texttemplate;if(fe){var xe=Array.isArray(fe)?fe[ce]||"":fe,Se=N._module.formatLabels(oe,N,V),pe={};m(pe,N,oe.i),ve=t.texttemplateString(xe,Se,V._d3locale,pe,oe,N._meta||{})}else ve=te(ce);ve&&(ve=ve.replace(p,"").replace(s,"\n")),ae.push({type:"Feature",geometry:{type:"Point",coordinates:oe.lonlat},properties:{symbol:K(ce),angle:J(ce),text:ve}})}}return{type:"FeatureCollection",features:ae}}(y,a),t.extendFlat(j.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),z&&(t.extendFlat(j.layout,{"icon-size":_.marker.size/10}),"angle"in _.marker&&"auto"!==_.marker.angle&&t.extendFlat(j.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),j.layout["icon-allow-overlap"]=_.marker.allowoverlap,t.extendFlat(j.paint,{"icon-opacity":_.opacity*_.marker.opacity,"icon-color":_.marker.color})),M)){var G=n(_.textposition,(_.marker||{}).size);t.extendFlat(j.layout,{"text-size":_.textfont.size,"text-anchor":G.anchor,"text-offset":G.offset}),t.extendFlat(j.paint,{"text-color":_.textfont.color,"text-opacity":_.opacity})}return q}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/text_defaults"),r=v("../scatter/fillcolor_defaults"),i=v("./attributes");Q.exports=function(c,n,m,p){function s(h,_){return g.coerce(c,n,i,h,_)}function f(h,_){return g.coerce2(c,n,i,h,_)}if(_=n,w=(b=s)("lon")||[],T=b("lat")||[],L=Math.min(w.length,T.length),_._length=L,L){if(s("text"),s("texttemplate"),s("hovertext"),s("hovertemplate"),s("mode"),s("below"),t.hasLines(n)&&(x(c,n,m,p,s,{noDash:!0}),s("connectgaps")),t.hasMarkers(n)){k(c,n,m,p,s,{noLine:!0,noAngle:!0}),s("marker.allowoverlap"),s("marker.angle");var l=n.marker;"circle"!==l.symbol&&(g.isArrayOrTypedArray(l.size)&&(l.size=l.size[0]),g.isArrayOrTypedArray(l.color)&&(l.color=l.color[0]))}var o=f("cluster.maxzoom"),d=f("cluster.step"),u=f("cluster.color",n.marker&&n.marker.color||m),a=f("cluster.size"),y=f("cluster.opacity");s("cluster.enabled",!1!==o||!1!==d||!1!==u||!1!==a||!1!==y),t.hasText(n)&&e(c,n,p,s,{noSelect:!0}),s("fill"),"none"!==n.fill&&r(c,n,m,s),g.coerceSelectionMarkerOpacity(n,s)}else n.visible=!1;var _,b,w,T,L}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(v,Q,$){"use strict";Q.exports=function(g,t){return g.lon=t.lon,g.lat=t.lat,g}},{}],1006:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes");Q.exports=function(t,k,x){var e={},r=x[k.subplot]._subplot.mockAxis,i=t.lonlat;return e.lonLabel=g.tickText(r,r.c2l(i[0]),!0).text,e.latLabel=g.tickText(r,r.c2l(i[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],1007:[function(v,Q,$){"use strict";var g=v("../../components/fx"),t=v("../../lib"),k=v("../scatter/get_trace_color"),x=t.fillText,e=v("../../constants/numerical").BADNUM,r=v("../../plots/mapbox/constants").traceLayerPrefix;function i(c,n,m){if(!c.hovertemplate){var p=(n.hi||c.hoverinfo).split("+"),s=-1!==p.indexOf("all"),f=-1!==p.indexOf("lon"),l=-1!==p.indexOf("lat"),o=n.lonlat,d=[];return s||f&&l?d.push("("+u(o[1])+", "+u(o[0])+")"):f?d.push(m.lon+u(o[0])):l&&d.push(m.lat+u(o[1])),(s||-1!==p.indexOf("text"))&&x(n,c,d),d.join("<br>")}function u(a){return a+"\xb0"}}Q.exports={hoverPoints:function(c,n,m){var p=c.cd,s=p[0].trace,f=c.xa,l=c.ya,o=c.subplot,d=[],a=s.cluster&&s.cluster.enabled;if(a){var y=o.map.queryRenderedFeatures(null,{layers:[r+s.uid+"-circle"]});d=y.map(function(C){return C.id})}var h=360*(n>=0?Math.floor((n+180)/360):Math.ceil((n-180)/360)),_=n-h;if(g.getClosest(p,function(C){var R=C.lonlat;if(R[0]===e||a&&-1===d.indexOf(C.i+1))return 1/0;var D=t.modHalf(R[0],360),j=R[1],q=o.project([D,j]),Z=q.x-f.c2p([_,j]),W=q.y-l.c2p([D,m]),G=Math.max(3,C.mrc||0);return Math.max(Math.sqrt(Z*Z+W*W)-G,1-3/G)},c),!1!==c.index){var b=p[c.index],w=b.lonlat,T=[t.modHalf(w[0],360)+h,w[1]],L=f.c2p(T),M=l.c2p(T),P=b.mrc||1;c.x0=L-P,c.x1=L+P,c.y0=M-P,c.y1=M+P;var z={};z[s.subplot]={_subplot:o};var S=s._module.formatLabels(b,s,z);return c.lonLabel=S.lonLabel,c.latLabel=S.latLabel,c.color=k(s,b),c.extraText=i(s,b,p[0].t.labels),c.hovertemplate=s.hovertemplate,[c]}},getExtraText:i}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("../scattergeo/calc"),plot:v("./plot"),hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),styleOnSelect:function(g,t){t&&t[0].trace._glTrace.update(t)},moduleType:"trace",name:"scattermapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./convert"),k=v("../../plots/mapbox/constants").traceLayerPrefix,x={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(i,c,n){this.type="scattermapbox",this.subplot=i,this.uid=c,this.clusterEnabled=n,this.sourceIds={fill:"source-"+c+"-fill",line:"source-"+c+"-line",circle:"source-"+c+"-circle",symbol:"source-"+c+"-symbol",cluster:"source-"+c+"-circle",clusterCount:"source-"+c+"-circle"},this.layerIds={fill:k+c+"-fill",line:k+c+"-line",circle:k+c+"-circle",symbol:k+c+"-symbol",cluster:k+c+"-cluster",clusterCount:k+c+"-cluster-count"},this.below=null}var r=e.prototype;r.addSource=function(i,c,n){var m={type:"geojson",data:c.geojson};n&&n.enabled&&g.extendFlat(m,{cluster:!0,clusterMaxZoom:n.maxzoom}),this.subplot.map.addSource(this.sourceIds[i],m)},r.setSourceData=function(i,c){this.subplot.map.getSource(this.sourceIds[i]).setData(c.geojson)},r.addLayer=function(i,c,n){var m={type:c.type,id:this.layerIds[i],source:this.sourceIds[i],layout:c.layout,paint:c.paint};c.filter&&(m.filter=c.filter),this.subplot.addLayer(m,n)},r.update=function(i){var c,n,m,p=i[0].trace,s=this.subplot,f=s.map,l=t(s.gd,i),o=s.belowLookup["trace-"+this.uid],d=!(!p.cluster||!p.cluster.enabled),u=!!this.clusterEnabled;if(o!==this.below){var a=x.nonCluster;for(c=a.length-1;c>=0;c--)f.removeLayer(this.layerIds[n=a[c]]);for(c=0;c<a.length;c++)m=l[n=a[c]],this.addLayer(n,m,o);this.below=o}else if(d&&!u){for(c=x.nonCluster.length-1;c>=0;c--)f.removeLayer(this.layerIds[n=x.nonCluster[c]]),f.removeSource(this.sourceIds[n]);for(this.addSource("circle",l.circle,p.cluster),c=0;c<x.cluster.length;c++)m=l[n=x.cluster[c]],this.addLayer(n,m,o);this.clusterEnabled=d}else if(!d&&u){for(c=0;c<x.cluster.length;c++)f.removeLayer(this.layerIds[n=x.cluster[c]]);for(f.removeSource(this.sourceIds.circle),c=0;c<x.nonCluster.length;c++)m=l[n=x.nonCluster[c]],this.addSource(n,m,p.cluster),this.addLayer(n,m,o);this.clusterEnabled=d}i[0].trace._glTrace=this},r.dispose=function(){for(var i=this.subplot.map,c=this.clusterEnabled?x.cluster:x.nonCluster,n=c.length-1;n>=0;n--){var m=c[n];i.removeLayer(this.layerIds[m]),i.removeSource(this.sourceIds[m])}},Q.exports=function(i,c){var n,m,p,s=c[0].trace,f=s.cluster&&s.cluster.enabled,l=new e(i,s.uid,f),o=t(i.gd,c),d=l.below=i.belowLookup["trace-"+s.uid];if(f)for(l.addSource("circle",o.circle,s.cluster),n=0;n<x.cluster.length;n++)p=o[m=x.cluster[n]],l.addLayer(m,p,d);else for(n=0;n<x.nonCluster.length;n++)p=o[m=x.nonCluster[n]],l.addSource(m,p,s.cluster),l.addLayer(m,p,d);return c[0].trace._glTrace=l,l}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/subtypes"),k=v("../../constants/numerical").BADNUM;Q.exports=function(x,e){var r,i=x.cd,c=x.xaxis,n=x.yaxis,m=[];if(!t.hasMarkers(i[0].trace))return[];if(!1===e)for(r=0;r<i.length;r++)i[r].selected=0;else for(r=0;r<i.length;r++){var s=i[r],f=s.lonlat;if(f[0]!==k){var l=[g.modHalf(f[0],360),f[1]],o=[c.c2p(l),n.c2p(l)];e.contains(o,null,r,x)?(m.push({pointNumber:r,lon:f[0],lat:f[1]}),s.selected=1):s.selected=0}}return m}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../lib/extend").extendFlat,x=v("../scatter/attributes"),e=v("../../plots/attributes"),r=x.line;Q.exports={mode:x.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:x.text,texttemplate:t({editType:"plot"},{keys:["r","theta","text"]}),hovertext:x.hovertext,line:{color:r.color,width:r.width,dash:r.dash,backoff:r.backoff,shape:k({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:x.connectgaps,marker:x.marker,cliponaxis:k({},x.cliponaxis,{dflt:!1}),textposition:x.textposition,textfont:x.textfont,fill:k({},x.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:x.fillcolor,hoverinfo:k({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:x.hoveron,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../constants/numerical").BADNUM,k=v("../../plots/cartesian/axes"),x=v("../scatter/colorscale_calc"),e=v("../scatter/arrays_to_calcdata"),r=v("../scatter/calc_selection"),i=v("../scatter/calc").calcMarkerSize;Q.exports=function(c,n){for(var m=c._fullLayout,p=n.subplot,s=m[p].radialaxis,f=m[p].angularaxis,l=s.makeCalcdata(n,"r"),o=f.makeCalcdata(n,"theta"),d=n._length,u=new Array(d),a=0;a<d;a++){var y=l[a],h=o[a],_=u[a]={};g(y)&&g(h)?(_.r=y,_.theta=h):_.r=t}var b=i(n,d);return n._extremes.x=k.findExtremes(s,l,{ppad:b}),x(c,n),e(u,n),r(u,n),u}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/line_shape_defaults"),r=v("../scatter/text_defaults"),i=v("../scatter/fillcolor_defaults"),c=v("../scatter/constants").PTS_LINESONLY,n=v("./attributes");function m(p,s,f,l){var o,d=l("r"),u=l("theta");if(d)u?o=Math.min(d.length,u.length):(o=d.length,l("theta0"),l("dtheta"));else{if(!u)return 0;o=s.theta.length,l("r0"),l("dr")}return s._length=o,o}Q.exports={handleRThetaDefaults:m,supplyDefaults:function(p,s,f,l){function o(a,y){return g.coerce(p,s,n,a,y)}var d=m(0,s,0,o);if(d){o("thetaunit"),o("mode",d<c?"lines+markers":"lines"),o("text"),o("hovertext"),"fills"!==s.hoveron&&o("hovertemplate"),t.hasLines(s)&&(x(p,s,f,l,o,{backoff:!0}),e(p,s,o),o("connectgaps")),t.hasMarkers(s)&&k(p,s,f,l,o,{gradient:!0}),t.hasText(s)&&(o("texttemplate"),r(p,s,l,o));var u=[];(t.hasMarkers(s)||t.hasText(s))&&(o("cliponaxis"),o("marker.maxdisplayed"),u.push("points")),o("fill"),"none"!==s.fill&&(i(p,s,f,o),t.hasLines(s)||e(p,s,o)),"tonext"!==s.fill&&"toself"!==s.fill||u.push("fills"),o("hoveron",u.join("+")||"points"),g.coerceSelectionMarkerOpacity(s,o)}else s.visible=!1}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes");Q.exports=function(k,x,e){var r,i,c={},n=e[x.subplot]._subplot;n?(r=n.radialAxis,i=n.angularAxis):(r=(n=e[x.subplot]).radialaxis,i=n.angularaxis);var m=r.c2l(k.r);c.rLabel=t.tickText(r,m,!0).text;var p="degrees"===i.thetaunit?g.rad2deg(k.theta):k.theta;return c.thetaLabel=t.tickText(i,p,!0).text,c}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(v,Q,$){"use strict";var g=v("../scatter/hover");function t(k,x,e,r){var i=e.radialAxis,c=e.angularAxis;i._hovertitle="r",c._hovertitle="\u03b8";var n={};n[x.subplot]={_subplot:e};var m=x._module.formatLabels(k,x,n);r.rLabel=m.rLabel,r.thetaLabel=m.thetaLabel;var s=[];function f(o,d){s.push(o._hovertitle+": "+d)}if(!x.hovertemplate){var l=(k.hi||x.hoverinfo).split("+");-1!==l.indexOf("all")&&(l=["r","theta","text"]),-1!==l.indexOf("r")&&f(i,r.rLabel),-1!==l.indexOf("theta")&&f(c,r.thetaLabel),-1!==l.indexOf("text")&&r.text&&(s.push(r.text),delete r.text),r.extraText=s.join("<br>")}}Q.exports={hoverPoints:function(k,x,e,r){var i=g(k,x,e,r);if(i&&!1!==i[0].index){var c=i[0];if(void 0===c.index)return i;var n=k.subplot,m=c.cd[c.index],p=c.trace;if(n.isPtInside(m))return c.xLabelVal=void 0,c.yLabelVal=void 0,t(m,p,n,c),c.hovertemplate=p.hovertemplate,i}},makeHoverPointText:t}},{"../scatter/hover":947}],1016:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:v("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(v,Q,$){"use strict";var g=v("../scatter/plot"),t=v("../../constants/numerical").BADNUM;Q.exports=function(k,x,e){for(var r=x.layers.frontplot.select("g.scatterlayer"),i=x.xaxis,c=x.yaxis,n={xaxis:i,yaxis:c,plot:x.framework,layerClipId:x._hasClipOnAxisFalse?x.clipIds.forTraces:null},m=x.radialAxis,p=x.angularAxis,s=0;s<e.length;s++)for(var f=e[s],l=0;l<f.length;l++){0===l&&(f[0].trace._xA=i,f[0].trace._yA=c);var o=f[l],d=o.r;if(d===t)o.x=o.y=t;else{var u=m.c2g(d),a=p.c2g(o.theta);o.x=u*Math.cos(a),o.y=u*Math.sin(a)}}g(k,n,e,r)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(v,Q,$){"use strict";var g=v("../scatterpolar/attributes"),t=v("../scattergl/attributes"),k=v("../../plots/template_attributes").texttemplateAttrs;Q.exports={mode:g.mode,r:g.r,theta:g.theta,r0:g.r0,dr:g.dr,theta0:g.theta0,dtheta:g.dtheta,thetaunit:g.thetaunit,text:g.text,texttemplate:k({editType:"plot"},{keys:["r","theta","text"]}),hovertext:g.hovertext,hovertemplate:g.hovertemplate,line:t.line,connectgaps:t.connectgaps,marker:t.marker,fill:t.fill,fillcolor:t.fillcolor,textposition:t.textposition,textfont:t.textfont,hoverinfo:g.hoverinfo,selected:g.selected,unselected:g.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:v("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(v,Q,$){"use strict";var g=v("../scatter/colorscale_calc"),t=v("../scatter/calc").calcMarkerSize,k=v("../scattergl/convert"),x=v("../../plots/cartesian/axes"),e=v("../scattergl/constants").TOO_MANY_POINTS;Q.exports=function(r,i){var c=r._fullLayout,n=i.subplot,m=c[n].radialaxis,p=c[n].angularaxis,s=i._r=m.makeCalcdata(i,"r"),f=i._theta=p.makeCalcdata(i,"theta"),l=i._length,o={};l<s.length&&(s=s.slice(0,l)),l<f.length&&(f=f.slice(0,l)),o.r=s,o.theta=f,g(r,i);var d,u=o.opts=k.style(r,i);return l<e?d=t(i,l):u.marker&&(d=2*(u.marker.sizeAvg||Math.max(u.marker.size,3))),i._extremes.x=x.findExtremes(m,s,{ppad:d}),[{x:!1,y:!1,t:o,trace:i}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/subtypes"),k=v("../scatterpolar/defaults").handleRThetaDefaults,x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/text_defaults"),i=v("../scatter/fillcolor_defaults"),c=v("../scatter/constants").PTS_LINESONLY,n=v("./attributes");Q.exports=function(m,p,s,f){function l(d,u){return g.coerce(m,p,n,d,u)}var o=k(m,p,f,l);o?(l("thetaunit"),l("mode",o<c?"lines+markers":"lines"),l("text"),l("hovertext"),"fills"!==p.hoveron&&l("hovertemplate"),t.hasLines(p)&&(e(m,p,s,f,l),l("connectgaps")),t.hasMarkers(p)&&x(m,p,s,f,l,{noAngleRef:!0,noStandOff:!0}),t.hasText(p)&&(l("texttemplate"),r(m,p,f,l)),l("fill"),"none"!==p.fill&&i(m,p,s,l),g.coerceSelectionMarkerOpacity(p,l)):p.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(v,Q,$){"use strict";var g=v("../scatterpolar/format_labels");Q.exports=function(t,k,x){var e=t.i;return"r"in t||(t.r=k._r[e]),"theta"in t||(t.theta=k._theta[e]),g(t,k,x)}},{"../scatterpolar/format_labels":1014}],1023:[function(v,Q,$){"use strict";var g=v("../scattergl/hover"),t=v("../scatterpolar/hover").makeHoverPointText;Q.exports={hoverPoints:function(k,x,e,r){var i=k.cd[0].t,c=i.r,n=i.theta,m=g.hoverPoints(k,x,e,r);if(m&&!1!==m[0].index){var p=m[0];if(void 0===p.index)return m;var s=k.subplot,f=p.cd[p.index],l=p.trace;if(f.r=c[p.index],f.theta=n[p.index],s.isPtInside(f))return p.xLabelVal=void 0,p.yLabelVal=void 0,t(f,l,s,p),m}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(v,Q,$){arguments[4][905][0].apply($,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(v,Q,$){"use strict";var g=v("@plotly/point-cluster"),t=v("fast-isnumeric"),k=v("../scattergl/plot"),x=v("../scattergl/scene_update"),e=v("../scattergl/convert"),r=v("../../lib"),i=v("../scattergl/constants").TOO_MANY_POINTS;Q.exports=function(c,n,m){if(m.length){var p=n.radialAxis,s=n.angularAxis,f=x(c,n);return m.forEach(function(l){if(l&&l[0]&&l[0].trace){var o,d=l[0],u=d.trace,a=d.t,y=u._length,h=a.r,_=a.theta,b=a.opts,w=h.slice(),T=_.slice();for(o=0;o<h.length;o++)n.isPtInside({r:h[o],theta:_[o]})||(w[o]=NaN,T[o]=NaN);var L=new Array(2*y),M=Array(y),P=Array(y);for(o=0;o<y;o++){var z,S,C=w[o];if(t(C)){var R=p.c2g(C),D=s.c2g(T[o],u.thetaunit);z=R*Math.cos(D),S=R*Math.sin(D)}else z=S=NaN;M[o]=L[2*o]=z,P[o]=L[2*o+1]=S}a.tree=g(L),b.marker&&y>=i&&(b.marker.cluster=a.tree),b.marker&&(b.markerSel.positions=b.markerUnsel.positions=b.marker.positions=L),b.line&&L.length>1&&r.extendFlat(b.line,e.linePositions(c,u,L)),b.text&&(r.extendFlat(b.text,{positions:L},e.textPosition(c,u,b.text,b.marker)),r.extendFlat(b.textSel,{positions:L},e.textPosition(c,u,b.text,b.markerSel)),r.extendFlat(b.textUnsel,{positions:L},e.textPosition(c,u,b.text,b.markerUnsel))),b.fill&&!f.fill2d&&(f.fill2d=!0),b.marker&&!f.scatter2d&&(f.scatter2d=!0),b.line&&!f.line2d&&(f.line2d=!0),b.text&&!f.glText&&(f.glText=!0),f.lineOptions.push(b.line),f.fillOptions.push(b.fill),f.markerOptions.push(b.marker),f.markerSelectedOptions.push(b.markerSel),f.markerUnselectedOptions.push(b.markerUnsel),f.textOptions.push(b.text),f.textSelectedOptions.push(b.textSel),f.textUnselectedOptions.push(b.textUnsel),f.selectBatch.push([]),f.unselectBatch.push([]),a.x=M,a.y=P,a.rawx=M,a.rawy=P,a.r=h,a.theta=_,a.positions=L,a._scene=f,a.index=f.count,f.count++}}),k(c,n,m)}},Q.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../lib/extend").extendFlat,x=v("../scatter/attributes"),e=v("../../plots/attributes"),r=x.line;Q.exports={mode:x.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:x.text,texttemplate:t({editType:"plot"},{keys:["real","imag","text"]}),hovertext:x.hovertext,line:{color:r.color,width:r.width,dash:r.dash,backoff:r.backoff,shape:k({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:x.connectgaps,marker:x.marker,cliponaxis:k({},x.cliponaxis,{dflt:!1}),textposition:x.textposition,textfont:x.textfont,fill:k({},x.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:x.fillcolor,hoverinfo:k({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:x.hoveron,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../../constants/numerical").BADNUM,k=v("../scatter/colorscale_calc"),x=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection"),r=v("../scatter/calc").calcMarkerSize;Q.exports=function(i,c){for(var n=i._fullLayout,m=c.subplot,s=n[m].imaginaryaxis,f=n[m].realaxis.makeCalcdata(c,"real"),l=s.makeCalcdata(c,"imag"),o=c._length,d=new Array(o),u=0;u<o;u++){var a=f[u],y=l[u],h=d[u]={};g(a)&&g(y)?(h.real=a,h.imag=y):h.real=t}return r(c,o),k(i,c),x(d,c),e(d,c),d}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/line_shape_defaults"),r=v("../scatter/text_defaults"),i=v("../scatter/fillcolor_defaults"),c=v("../scatter/constants").PTS_LINESONLY,n=v("./attributes");Q.exports=function(m,p,s,f){function l(u,a){return g.coerce(m,p,n,u,a)}var a,h,_,b,w,o=(a=p,b=(h=l)("real"),w=h("imag"),b&&w&&(_=Math.min(b.length,w.length)),a._length=_,_);if(o){l("mode",o<c?"lines+markers":"lines"),l("text"),l("hovertext"),"fills"!==p.hoveron&&l("hovertemplate"),t.hasLines(p)&&(x(m,p,s,f,l,{backoff:!0}),e(m,p,l),l("connectgaps")),t.hasMarkers(p)&&k(m,p,s,f,l,{gradient:!0}),t.hasText(p)&&(l("texttemplate"),r(m,p,f,l));var d=[];(t.hasMarkers(p)||t.hasText(p))&&(l("cliponaxis"),l("marker.maxdisplayed"),d.push("points")),l("fill"),"none"!==p.fill&&(i(m,p,s,l),t.hasLines(p)||e(m,p,l)),"tonext"!==p.fill&&"toself"!==p.fill||d.push("fills"),l("hoveron",d.join("+")||"points"),g.coerceSelectionMarkerOpacity(p,l)}else p.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes");Q.exports=function(t,k,x){var e={},r=x[k.subplot]._subplot;return e.realLabel=g.tickText(r.radialAxis,t.real,!0).text,e.imagLabel=g.tickText(r.angularAxis,t.imag,!0).text,e}},{"../../plots/cartesian/axes":566}],1030:[function(v,Q,$){"use strict";var g=v("../scatter/hover");function t(k,x,e,r){var i=e.radialAxis,c=e.angularAxis;i._hovertitle="real",c._hovertitle="imag";var n={};n[x.subplot]={_subplot:e};var m=x._module.formatLabels(k,x,n);r.realLabel=m.realLabel,r.imagLabel=m.imagLabel;var s=[];function f(o,d){s.push(o._hovertitle+": "+d)}if(!x.hovertemplate){var l=(k.hi||x.hoverinfo).split("+");-1!==l.indexOf("all")&&(l=["real","imag","text"]),-1!==l.indexOf("real")&&f(i,r.realLabel),-1!==l.indexOf("imag")&&f(c,r.imagLabel),-1!==l.indexOf("text")&&r.text&&(s.push(r.text),delete r.text),r.extraText=s.join("<br>")}}Q.exports={hoverPoints:function(k,x,e,r){var i=g(k,x,e,r);if(i&&!1!==i[0].index){var c=i[0];if(void 0===c.index)return i;var n=k.subplot,m=c.cd[c.index],p=c.trace;if(n.isPtInside(m))return c.xLabelVal=void 0,c.yLabelVal=void 0,t(m,p,n,c),c.hovertemplate=p.hovertemplate,i}},makeHoverPointText:t}},{"../scatter/hover":947}],1031:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"scattersmith",basePlotModule:v("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(v,Q,$){"use strict";var g=v("../scatter/plot"),t=v("../../constants/numerical").BADNUM,k=v("../../plots/smith/helpers").smith;Q.exports=function(x,e,r){for(var i=e.layers.frontplot.select("g.scatterlayer"),c=e.xaxis,n=e.yaxis,m={xaxis:c,yaxis:n,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},p=0;p<r.length;p++)for(var s=r[p],f=0;f<s.length;f++){0===f&&(s[0].trace._xA=c,s[0].trace._yA=n);var l=s[f],o=l.real;if(o===t)l.x=l.y=t;else{var d=k([o,l.imag]);l.x=d[0],l.y=d[1]}}g(x,m,r,i)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../scatter/attributes"),x=v("../../plots/attributes"),e=v("../../components/colorscale/attributes"),r=v("../../components/drawing/attributes").dash,i=v("../../lib/extend").extendFlat,c=k.marker,n=k.line,m=c.line;Q.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:i({},k.mode,{dflt:"markers"}),text:i({},k.text,{}),texttemplate:t({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:i({},k.hovertext,{}),line:{color:n.color,width:n.width,dash:r,backoff:n.backoff,shape:i({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:k.connectgaps,cliponaxis:k.cliponaxis,fill:i({},k.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:k.fillcolor,marker:i({symbol:c.symbol,opacity:c.opacity,angle:c.angle,angleref:c.angleref,standoff:c.standoff,maxdisplayed:c.maxdisplayed,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,line:i({width:m.width,editType:"calc"},e("marker.line")),gradient:c.gradient,editType:"calc"},e("marker")),textfont:k.textfont,textposition:k.textposition,selected:k.selected,unselected:k.unselected,hoverinfo:i({},x.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:k.hoveron,hovertemplate:g()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(v,Q,$){"use strict";var g=v("fast-isnumeric"),t=v("../scatter/colorscale_calc"),k=v("../scatter/arrays_to_calcdata"),x=v("../scatter/calc_selection"),e=v("../scatter/calc").calcMarkerSize,r=["a","b","c"],i={a:["b","c"],b:["a","c"],c:["a","b"]};Q.exports=function(c,n){var m,p,s,f,l,o,d=c._fullLayout[n.subplot].sum,u=n.sum||d,a={a:n.a,b:n.b,c:n.c};for(m=0;m<r.length;m++)if(!a[s=r[m]]){for(l=a[i[s][0]],o=a[i[s][1]],f=new Array(l.length),p=0;p<l.length;p++)f[p]=u-l[p]-o[p];a[s]=f}var y,h,_,b,L=n._length,M=new Array(L);for(m=0;m<L;m++)h=a.b[m],_=a.c[m],g(y=a.a[m])&&g(h)&&g(_)?(1!=(b=d/((y=+y)+(h=+h)+(_=+_)))&&(y*=b,h*=b,_*=b),M[m]={x:_-h,y,a:y,b:h,c:_}):M[m]={x:!1,y:!1};return e(n,L),t(c,n),k(M,n),x(M,n),M}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/constants"),k=v("../scatter/subtypes"),x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/line_shape_defaults"),i=v("../scatter/text_defaults"),c=v("../scatter/fillcolor_defaults"),n=v("./attributes");Q.exports=function(m,p,s,f){function l(h,_){return g.coerce(m,p,n,h,_)}var o,d=l("a"),u=l("b"),a=l("c");if(d?(o=d.length,u?(o=Math.min(o,u.length),a&&(o=Math.min(o,a.length))):o=a?Math.min(o,a.length):0):u&&a&&(o=Math.min(u.length,a.length)),o){p._length=o,l("sum"),l("text"),l("hovertext"),"fills"!==p.hoveron&&l("hovertemplate"),l("mode",o<t.PTS_LINESONLY?"lines+markers":"lines"),k.hasLines(p)&&(e(m,p,s,f,l,{backoff:!0}),r(m,p,l),l("connectgaps")),k.hasMarkers(p)&&x(m,p,s,f,l,{gradient:!0}),k.hasText(p)&&(l("texttemplate"),i(m,p,f,l));var y=[];(k.hasMarkers(p)||k.hasText(p))&&(l("cliponaxis"),l("marker.maxdisplayed"),y.push("points")),l("fill"),"none"!==p.fill&&(c(m,p,s,l),k.hasLines(p)||r(m,p,l)),"tonext"!==p.fill&&"toself"!==p.fill||y.push("fills"),l("hoveron",y.join("+")||"points"),g.coerceSelectionMarkerOpacity(p,l)}else p.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(v,Q,$){"use strict";Q.exports=function(g,t,k,x,e){if(t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),x[e]){var r=x[e];g.a=r.a,g.b=r.b,g.c=r.c}else g.a=t.a,g.b=t.b,g.c=t.c;return g}},{}],1037:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes");Q.exports=function(t,k,x){var e={},r=x[k.subplot]._subplot;return e.aLabel=g.tickText(r.aaxis,t.a,!0).text,e.bLabel=g.tickText(r.baxis,t.b,!0).text,e.cLabel=g.tickText(r.caxis,t.c,!0).text,e}},{"../../plots/cartesian/axes":566}],1038:[function(v,Q,$){"use strict";var g=v("../scatter/hover");Q.exports=function(t,k,x,e){var r=g(t,k,x,e);if(r&&!1!==r[0].index){var i=r[0];if(void 0===i.index){var n=t.xa._length,m=n*(1-i.y0/t.ya._length)/2,p=n-m;return i.x0=Math.max(Math.min(i.x0,p),m),i.x1=Math.max(Math.min(i.x1,p),m),r}var s=i.cd[i.index],f=i.trace,l=i.subplot;i.a=s.a,i.b=s.b,i.c=s.c,i.xLabelVal=void 0,i.yLabelVal=void 0;var o={};o[f.subplot]={_subplot:l};var d=f._module.formatLabels(s,f,o);i.aLabel=d.aLabel,i.bLabel=d.bLabel,i.cLabel=d.cLabel;var a=[];if(!f.hovertemplate){var y=(s.hi||f.hoverinfo).split("+");-1!==y.indexOf("all")&&(y=["a","b","c"]),-1!==y.indexOf("a")&&h(l.aaxis,i.aLabel),-1!==y.indexOf("b")&&h(l.baxis,i.bLabel),-1!==y.indexOf("c")&&h(l.caxis,i.cLabel)}return i.extraText=a.join("<br>"),i.hovertemplate=f.hovertemplate,r}function h(_,b){a.push(_._hovertitle+": "+b)}}},{"../scatter/hover":947}],1039:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../scatter/select"),eventData:v("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:v("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(v,Q,$){"use strict";var g=v("../scatter/plot");Q.exports=function(t,k,x){var e=k.plotContainer;e.select(".scatterlayer").selectAll("*").remove();for(var r=k.xaxis,i=k.yaxis,c={xaxis:r,yaxis:i,plot:e,layerClipId:k._hasClipOnAxisFalse?k.clipIdRelative:null},n=k.layers.frontplot.select("g.scatterlayer"),m=0;m<x.length;m++){var p=x[m];p.length&&(p[0].trace._xA=r,p[0].trace._yA=i)}g(t,c,x,n)}},{"../scatter/plot":957}],1041:[function(v,Q,$){"use strict";var g=v("../scatter/attributes"),t=v("../../components/colorscale/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../scattergl/attributes"),r=v("../../plots/cartesian/constants").idRegex,i=v("../../plot_api/plot_template").templatedArray,c=v("../../lib/extend").extendFlat,n=g.marker,m=n.line,p=c(t("marker.line",{editTypeOverride:"calc"}),{width:c({},m.width,{editType:"calc"}),editType:"calc"}),s=c(t("marker"),{symbol:n.symbol,angle:n.angle,size:c({},n.size,{editType:"markerSize"}),sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,opacity:n.opacity,colorbar:n.colorbar,line:p,editType:"calc"});function f(l){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:r[l],editType:"plot"}}}s.color.editType=s.cmin.editType=s.cmax.editType="style",Q.exports={dimensions:i("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:c({},e.text,{}),hovertext:c({},e.hovertext,{}),hovertemplate:x(),xhoverformat:k("x"),yhoverformat:k("y"),marker:s,xaxes:f("x"),yaxes:f("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../components/grid");Q.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),calc:v("./calc"),plot:v("./plot"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("./select"),editStyle:v("./edit_style"),meta:{}},g.register(t)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(v,Q,$){"use strict";var g=v("regl-line2d"),t=v("../../registry"),k=v("../../lib/prepare_regl"),x=v("../../plots/get_data").getModuleCalcData,e=v("../../plots/cartesian"),r=v("../../plots/cartesian/axis_ids").getFromId,i=v("../../plots/cartesian/axes").shouldShowZeroLine,c={};function n(p,s,f){for(var o=s._visibleDims,d=f.viewOpts.ranges=new Array(f.matrixOptions.data.length),u=0;u<o.length;u++){var a=o[u],y=d[u]=new Array(4),h=r(p,s._diag[a][0]);h&&(y[0]=h.r2l(h.range[0]),y[2]=h.r2l(h.range[1]));var _=r(p,s._diag[a][1]);_&&(y[1]=_.r2l(_.range[0]),y[3]=_.r2l(_.range[1]))}f.selectBatch.length||f.unselectBatch.length?f.matrix.update({ranges:d},{ranges:d}):f.matrix.update({ranges:d})}function m(p){var s=p._fullLayout,f=s._glcanvas.data()[0].regl,l=s._splomGrid;l||(l=s._splomGrid=g(f)),l.update(function(o){var d,u=o._context.plotGlPixelRatio,a=o._fullLayout,y=a._size,h=[0,0,a.width*u,a.height*u],_={};function b(G,X,ne,V,N,U){ne*=u,V*=u,N*=u,U*=u;var ee=X[G+"color"],B=X[G+"width"],K=String(ee+B);K in _?_[K].data.push(NaN,NaN,ne,V,N,U):_[K]={data:[ne,V,N,U],join:"rect",thickness:B*u,color:ee,viewport:h,range:h,overlay:!1}}for(d in a._splomSubplots){var w,T,L=a._plots[d],M=L.xaxis,P=L.yaxis,z=M._gridVals,S=P._gridVals,C=M._offset,R=M._length,D=P._length,j=y.b+P.domain[0]*y.h,q=-P._m,Z=-q*P.r2l(P.range[0],P.calendar);if(M.showgrid)for(d=0;d<z.length;d++)w=C+M.l2p(z[d].x),b("grid",M,w,j,w,j+D);if(P.showgrid)for(d=0;d<S.length;d++)b("grid",P,C,T=j+Z+q*S[d].x,C+R,T);i(o,M,P)&&(w=C+M.l2p(0),b("zeroline",M,w,j,w,j+D)),i(o,P,M)&&b("zeroline",P,C,T=j+Z+0,C+R,T)}var W=[];for(d in _)W.push(_[d]);return W}(p))}Q.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(p){var s=p._fullLayout,f=t.getModule("splom"),l=x(p.calcdata,f)[0];k(p,["ANGLE_instanced_arrays","OES_element_index_uint"],c)&&(s._hasOnlyLargeSploms&&m(p),f.plot(p,{},l))},drag:function(p){var s=p.calcdata,f=p._fullLayout;f._hasOnlyLargeSploms&&m(p);for(var l=0;l<s.length;l++){var o=s[l][0].trace,d=f._splomScenes[o.uid];"splom"===o.type&&d&&d.matrix&&n(p,o,d)}},updateGrid:m,clean:function(p,s,f,l){var o,d={};if(l._splomScenes){for(o=0;o<p.length;o++){var u=p[o];"splom"===u.type&&(d[u.uid]=1)}for(o=0;o<f.length;o++){var a=f[o];if(!d[a.uid]){var y=l._splomScenes[a.uid];y&&y.destroy&&y.destroy(),l._splomScenes[a.uid]=null,delete l._splomScenes[a.uid]}}}0===Object.keys(l._splomScenes||{}).length&&delete l._splomScenes,l._splomGrid&&!s._hasOnlyLargeSploms&&l._hasOnlyLargeSploms&&(l._splomGrid.destroy(),l._splomGrid=null,delete l._splomGrid),e.clean(p,s,f,l)},updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:c}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axis_ids"),k=v("../scatter/calc").calcMarkerSize,x=v("../scatter/calc").calcAxisExpansion,e=v("../scatter/colorscale_calc"),r=v("../scattergl/convert").markerSelection,i=v("../scattergl/convert").markerStyle,c=v("./scene_update"),n=v("../../constants/numerical").BADNUM,m=v("../scattergl/constants").TOO_MANY_POINTS;Q.exports=function(p,s){var f,l,o,d,u,a,y=s.dimensions,h=s._length,_={},b=_.cdata=[],w=_.data=[],T=s._visibleDims=[];function L(P,z){for(var S=P.makeCalcdata({v:z.values,vcalendar:s.calendar},"v"),C=0;C<S.length;C++)S[C]=S[C]===n?NaN:S[C];b.push(S),w.push("log"===P.type?g.simpleMap(S,P.c2l):S)}for(f=0;f<y.length;f++)if((o=y[f]).visible){if(d=t.getFromId(p,s._diag[f][0]),u=t.getFromId(p,s._diag[f][1]),d&&u&&d.type!==u.type){g.log("Skipping splom dimension "+f+" with conflicting axis types");continue}d?(L(d,o),u&&"category"===u.type&&(u._categories=d._categories.slice())):L(u,o),T.push(f)}for(e(p,s),g.extendFlat(_,i(p,s)),a=b.length*h>m?_.sizeAvg||Math.max(_.size,3):k(s,h),l=0;l<T.length;l++)o=y[f=T[l]],d=t.getFromId(p,s._diag[f][0])||{},u=t.getFromId(p,s._diag[f][1])||{},x(p,s,d,u,b[l],b[l],a);var M=c(p,s);return M.matrix||(M.matrix=!0),M.matrixOptions=_,M.selectedOptions=r(p,s,s.selected),M.unselectedOptions=r(p,s,s.unselected),[{x:!1,y:!1,t:{},trace:s}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/array_container_defaults"),k=v("./attributes"),x=v("../scatter/subtypes"),e=v("../scatter/marker_defaults"),r=v("../parcoords/merge_length"),i=v("../scattergl/helpers").isOpenSymbol;function c(n,m){function p(f,l){return g.coerce(n,m,k.dimensions,f,l)}p("label");var s=p("values");s&&s.length?p("visible"):m.visible=!1,p("axis.type"),p("axis.matches")}Q.exports=function(n,m,p,s){function f(h,_){return g.coerce(n,m,k,h,_)}var l=t(n,m,{name:"dimensions",handleItemDefaults:c}),o=f("diagonal.visible"),d=f("showupperhalf"),u=f("showlowerhalf");if(r(m,l,"values")&&(o||d||u)){f("text"),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat"),e(n,m,p,s,f,{noAngleRef:!0,noStandOff:!0});var a=i(m.marker.symbol),y=x.isBubble(m);f("marker.line.width",a||y?1:0),function(h,_,b,w){var T,L,M=_.dimensions,P=M.length,z=_.showupperhalf,S=_.showlowerhalf,C=_.diagonal.visible,R=new Array(P),D=new Array(P);for(T=0;T<P;T++){var j=T?T+1:"";R[T]="x"+j,D[T]="y"+j}var q=w("xaxes",R),Z=w("yaxes",D),W=_._diag=new Array(P);_._xaxes={},_._yaxes={};var G=[],X=[];function ne(ae,ce,oe,ve){if(ae){var fe=ae.charAt(0),xe=b._splomAxes[fe];if(_["_"+fe+"axes"][ae]=1,ve.push(ae),!(ae in xe)){var Se=xe[ae]={};oe&&(Se.label=oe.label||"",oe.visible&&oe.axis&&(oe.axis.type&&(Se.type=oe.axis.type),oe.axis.matches&&(Se.matches=ce)))}}}var V=!C&&!S,N=!C&&!z;for(_._axesDim={},T=0;T<P;T++){var U=M[T],ee=0===T,B=T===P-1,K=ee&&V||B&&N?void 0:q[T],J=ee&&N||B&&V?void 0:Z[T];ne(K,J,U,G),ne(J,K,U,X),W[T]=[K,J],_._axesDim[K]=T,_._axesDim[J]=T}for(T=0;T<G.length;T++)for(L=0;L<X.length;L++){var te=G[T]+X[L];T>L&&z||T<L&&S?b._splomSubplots[te]=1:T!==L||!C&&S&&z||(b._splomSubplots[te]=1)}(!S||!C&&z&&S)&&(b._splomGridDflt.xside="bottom",b._splomGridDflt.yside="left")}(0,m,s,f),g.coerceSelectionMarkerOpacity(m,f)}else m.visible=!1}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../scatter/colorscale_calc"),k=v("../scattergl/convert").markerStyle;Q.exports=function(x,e){var r=e.trace,i=x._fullLayout._splomScenes[r.uid];if(i){t(x,r),g.extendFlat(i.matrixOptions,k(x,r));var c=g.extendFlat({},i.matrixOptions,i.viewOpts);i.matrix.update(c,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(v,Q,$){"use strict";$.getDimIndex=function(g,t){for(var k=t._id,x={x:0,y:1}[k.charAt(0)],e=g._visibleDims,r=0;r<e.length;r++)if(g._diag[e[r]][x]===k)return r;return!1}},{}],1048:[function(v,Q,$){"use strict";var g=v("./helpers"),t=v("../scattergl/hover").calcHover;Q.exports={hoverPoints:function(k,x,e){var r=k.cd[0].trace,i=k.scene.matrixOptions.cdata,c=k.xa,n=k.ya,m=c.c2p(x),p=n.c2p(e),s=k.distance,f=g.getDimIndex(r,c),l=g.getDimIndex(r,n);if(!1===f||!1===l)return[k];for(var o,d,u=i[f],a=i[l],y=s,h=0;h<u.length;h++){var b=a[h],w=c.c2p(u[h])-m,T=n.c2p(b)-p,L=Math.sqrt(w*w+T*T);L<y&&(y=d=L,o=h)}return k.index=o,k.distance=y,k.dxy=d,void 0===o?[k]:[t(k,u,a,r)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(v,Q,$){"use strict";var g=v("./base_index");g.basePlotModule=v("./base_plot"),Q.exports=g},{"./base_index":1042,"./base_plot":1043}],1050:[function(v,Q,$){"use strict";var g=v("regl-splom"),t=v("../../lib"),k=v("../../plots/cartesian/axis_ids"),x=v("../../components/dragelement/helpers").selectMode;function e(r,i){var c,n,m,p,s,f=r._fullLayout,l=f._size,o=i.trace,d=i.t,u=f._splomScenes[o.uid],a=u.matrixOptions,y=a.cdata,h=f._glcanvas.data()[0].regl,_=f.dragmode;if(0!==y.length){a.lower=o.showupperhalf,a.upper=o.showlowerhalf,a.diagonal=o.diagonal.visible;var b=o._visibleDims,w=y.length,T=u.viewOpts={};for(T.ranges=new Array(w),T.domains=new Array(w),s=0;s<b.length;s++){m=b[s];var L=T.ranges[s]=new Array(4),M=T.domains[s]=new Array(4);(c=k.getFromId(r,o._diag[m][0]))&&(L[0]=c._rl[0],L[2]=c._rl[1],M[0]=c.domain[0],M[2]=c.domain[1]),(n=k.getFromId(r,o._diag[m][1]))&&(L[1]=n._rl[0],L[3]=n._rl[1],M[1]=n.domain[0],M[3]=n.domain[1])}var P=r._context.plotGlPixelRatio,z=l.l*P,S=l.b*P;T.viewport=[z,S,l.w*P+z,l.h*P+S],!0===u.matrix&&(u.matrix=g(h));var D=f.clickmode.indexOf("select")>-1,j=!0;if(x(_)||o.selectedpoints||D){var q=o._length;if(o.selectedpoints){u.selectBatch=o.selectedpoints;var Z=o.selectedpoints,W={};for(m=0;m<Z.length;m++)W[Z[m]]=!0;var G=[];for(m=0;m<q;m++)W[m]||G.push(m);u.unselectBatch=G}var X=d.xpx=new Array(w),ne=d.ypx=new Array(w);for(s=0;s<b.length;s++){if(c=k.getFromId(r,o._diag[m=b[s]][0]))for(X[s]=new Array(q),p=0;p<q;p++)X[s][p]=c.c2p(y[s][p]);if(n=k.getFromId(r,o._diag[m][1]))for(ne[s]=new Array(q),p=0;p<q;p++)ne[s][p]=n.c2p(y[s][p])}if(u.selectBatch.length||u.unselectBatch.length){var V=t.extendFlat({},a,u.unselectedOptions,T),N=t.extendFlat({},a,u.selectedOptions,T);u.matrix.update(V,N),j=!1}}else d.xpx=d.ypx=null;if(j){var U=t.extendFlat({},a,T);u.matrix.update(U,null)}}}Q.exports=function(r,i,c){if(c.length)for(var n=0;n<c.length;n++)e(r,c[n][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(v,Q,$){"use strict";var g=v("../../lib");Q.exports=function(t,k){var x=t._fullLayout,e=k.uid,r=x._splomScenes;r||(r=x._splomScenes={});var i={dirty:!0,selectBatch:[],unselectBatch:[]},c=r[k.uid];return c||((c=r[e]=g.extendFlat({},i,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){c.matrix&&c.matrix.draw&&(c.selectBatch.length||c.unselectBatch.length?c.matrix.draw(c.unselectBatch,c.selectBatch):c.matrix.draw()),c.dirty=!1},c.destroy=function(){c.matrix&&c.matrix.destroy&&c.matrix.destroy(),c.matrixOptions=null,c.selectBatch=null,c.unselectBatch=null,c=null}),c.dirty||g.extendFlat(c,i),c}},{"../../lib":515}],1052:[function(v,Q,$){"use strict";var g=v("../../lib"),t=g.pushUnique,k=v("../scatter/subtypes"),x=v("./helpers");Q.exports=function(e,r){var i=e.cd,c=i[0].trace,n=i[0].t,m=e.scene,p=m.matrixOptions.cdata,s=e.xaxis,f=e.yaxis,l=[];if(!m)return l;var o=!k.hasMarkers(c)&&!k.hasText(c);if(!0!==c.visible||o)return l;var d=x.getDimIndex(c,s),u=x.getDimIndex(c,f);if(!1===d||!1===u)return l;var a=n.xpx[d],y=n.ypx[u],h=p[d],_=p[u],b=(e.scene.selectBatch||[]).slice(),w=[];if(!1!==r&&!r.degenerate)for(var T=0;T<h.length;T++)r.contains([a[T],y[T]],null,T,e)?(l.push({pointNumber:T,x:h[T],y:_[T]}),t(b,T)):-1!==b.indexOf(T)?t(b,T):w.push(T);var L=m.matrixOptions;return b.length||w.length?m.selectBatch.length||m.unselectBatch.length||m.matrix.update(m.unselectedOptions,g.extendFlat({},L,m.selectedOptions,m.viewOpts)):m.matrix.update(L,null),m.selectBatch=b,m.unselectBatch=w,l}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../mesh3d/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,i={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:k({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:t("u",1),vhoverformat:t("v",1),whoverformat:t("w",1),xhoverformat:t("x"),yhoverformat:t("y"),zhoverformat:t("z"),showlegend:r({},e.showlegend,{dflt:!1})};r(i,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(c){i[c]=x[c]}),i.hoverinfo=r({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),i.transforms=void 0,Q.exports=i},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/calc");function k(r){var i,c,n,m,p,s,f,l,o,d,u,a,y=r._x,h=r._y,_=r._z,b=r._len,w=-1/0,T=1/0,L=-1/0,M=1/0,P=-1/0,z=1/0,S="";for(b&&(f=y[0],o=h[0],u=_[0]),b>1&&(l=y[b-1],d=h[b-1],a=_[b-1]),i=0;i<b;i++)w=Math.max(w,y[i]),T=Math.min(T,y[i]),L=Math.max(L,h[i]),M=Math.min(M,h[i]),P=Math.max(P,_[i]),z=Math.min(z,_[i]),m||y[i]===f||(m=!0,S+="x"),p||h[i]===o||(p=!0,S+="y"),s||_[i]===u||(s=!0,S+="z");m||(S+="x"),p||(S+="y"),s||(S+="z");var C=x(r._x),R=x(r._y),D=x(r._z);S=(S=(S=S.replace("x",(f>l?"-":"+")+"x")).replace("y",(o>d?"-":"+")+"y")).replace("z",(u>a?"-":"+")+"z");var j=function(){b=0,C=[],R=[],D=[]};(!b||b<C.length*R.length*D.length)&&j();var q=function(fe){return"x"===fe?y:"y"===fe?h:_},Z=function(fe){return"x"===fe?C:"y"===fe?R:D},W=function(fe){return fe[b-1]<fe[0]?-1:1},G=q(S[1]),X=q(S[3]),ne=q(S[5]),V=Z(S[1]).length,N=Z(S[3]).length,U=Z(S[5]).length,ee=!1,B=function(fe,xe,Se){return V*(N*fe+xe)+Se},K=W(q(S[1])),J=W(q(S[3])),te=W(q(S[5]));for(i=0;i<U-1;i++){for(c=0;c<N-1;c++){for(n=0;n<V-1;n++){var ae=B(i,c,n),ce=B(i,c,n+1),oe=B(i,c+1,n),ve=B(i+1,c,n);if(G[ae]*K<G[ce]*K&&X[ae]*J<X[oe]*J&&ne[ae]*te<ne[ve]*te||(ee=!0),ee)break}if(ee)break}if(ee)break}return ee&&(g.warn("Encountered arbitrary coordinates! Unable to input data grid."),j()),{xMin:T,yMin:M,zMin:z,xMax:w,yMax:L,zMax:P,Xs:C,Ys:R,Zs:D,len:b,fill:S}}function x(r){return g.distinctVals(r).vals}function e(r,i){if(void 0===i&&(i=r.length),g.isTypedArray(r))return r.subarray(0,i);for(var c=[],n=0;n<i;n++)c[n]=+r[n];return c}Q.exports={calc:function(r,i){i._len=Math.min(i.u.length,i.v.length,i.w.length,i.x.length,i.y.length,i.z.length),i._u=e(i.u,i._len),i._v=e(i.v,i._len),i._w=e(i.w,i._len),i._x=e(i.x,i._len),i._y=e(i.y,i._len),i._z=e(i.z,i._len);var c=k(i);i._gridFill=c.fill,i._Xs=c.Xs,i._Ys=c.Ys,i._Zs=c.Zs,i._len=c.len;var n,m,p,s=0;i.starts&&(n=e(i.starts.x||[]),m=e(i.starts.y||[]),p=e(i.starts.z||[]),s=Math.min(n.length,m.length,p.length)),i._startsX=n||[],i._startsY=m||[],i._startsZ=p||[];var f,l=0,o=1/0;for(f=0;f<i._len;f++){var d=i._u[f],u=i._v[f],a=i._w[f],y=Math.sqrt(d*d+u*u+a*a);l=Math.max(l,y),o=Math.min(o,y)}for(t(r,i,{vals:[o,l],containerStr:"",cLetter:"c"}),f=0;f<s;f++){var h=n[f];c.xMax=Math.max(c.xMax,h),c.xMin=Math.min(c.xMin,h);var _=m[f];c.yMax=Math.max(c.yMax,_),c.yMin=Math.min(c.yMin,_);var b=p[f];c.zMax=Math.max(c.zMax,b),c.zMin=Math.min(c.zMin,b)}i._slen=s,i._normMax=l,i._xbnds=[c.xMin,c.xMax],i._ybnds=[c.yMin,c.yMax],i._zbnds=[c.zMin,c.zMax]},filter:e,processGrid:k}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_streamtube3d,t=g.createTubeMesh,k=v("../../lib"),x=v("../../lib/gl_format_color").parseColorScale,e=v("../../components/colorscale").extractOpts,r=v("../../plots/gl3d/zip3"),i={xaxis:0,yaxis:1,zaxis:2};function c(f,l){this.scene=f,this.uid=l,this.mesh=null,this.data=null}var n=c.prototype;function m(f){var l=f.length;return l>2?f.slice(1,l-1):2===l?[(f[0]+f[1])/2]:f}function p(f){var l=f.length;return 1===l?[.5,.5]:[f[1]-f[0],f[l-1]-f[l-2]]}function s(f,l){var o=f.fullSceneLayout,d=f.dataScale,u=l._len,a={};function y(V,N){var U=o[N],ee=d[i[N]];return k.simpleMap(V,function(B){return U.d2l(B)*ee})}if(a.vectors=r(y(l._u,"xaxis"),y(l._v,"yaxis"),y(l._w,"zaxis"),u),!u)return{positions:[],cells:[]};var h=y(l._Xs,"xaxis"),_=y(l._Ys,"yaxis"),b=y(l._Zs,"zaxis");if(a.meshgrid=[h,_,b],a.gridFill=l._gridFill,l._slen)a.startingPositions=r(y(l._startsX,"xaxis"),y(l._startsY,"yaxis"),y(l._startsZ,"zaxis"));else{for(var w=_[0],T=m(h),L=m(b),M=new Array(T.length*L.length),P=0,z=0;z<T.length;z++)for(var S=0;S<L.length;S++)M[P++]=[T[z],w,L[S]];a.startingPositions=M}a.colormap=x(l),a.tubeSize=l.sizeref,a.maxLength=l.maxdisplayed;var C=y(l._xbnds,"xaxis"),R=y(l._ybnds,"yaxis"),D=y(l._zbnds,"zaxis"),j=p(h),q=p(_),Z=p(b),G=g(a,[[C[0]-j[0],R[0]-q[0],D[0]-Z[0]],[C[1]+j[1],R[1]+q[1],D[1]+Z[1]]]),X=e(l);G.vertexIntensityBounds=[X.min/l._normMax,X.max/l._normMax];var ne=l.lightposition;return G.lightPosition=[ne.x,ne.y,ne.z],G.ambient=l.lighting.ambient,G.diffuse=l.lighting.diffuse,G.specular=l.lighting.specular,G.roughness=l.lighting.roughness,G.fresnel=l.lighting.fresnel,G.opacity=l.opacity,l._pad=G.tubeScale*l.sizeref*2,G}n.handlePick=function(f){var l=this.scene.fullSceneLayout,o=this.scene.dataScale;function d(y,h){var b=o[i[h]];return l[h].l2c(y)/b}if(f.object===this.mesh){var u=f.data.position,a=f.data.velocity;return f.traceCoordinate=[d(u[0],"xaxis"),d(u[1],"yaxis"),d(u[2],"zaxis"),d(a[0],"xaxis"),d(a[1],"yaxis"),d(a[2],"zaxis"),f.data.intensity*this.data._normMax,f.data.divergence],f.textLabel=this.data.hovertext||this.data.text,!0}},n.update=function(f){this.data=f;var l=s(this.scene,f);this.mesh.update(l)},n.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Q.exports=function(f,l){var o=f.glplot.gl,d=s(f,l),u=t(o,d),a=new c(f,l.uid);return a.mesh=u,a.data=l,u._trace=a,f.glplot.add(u),a}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/colorscale/defaults"),k=v("./attributes");Q.exports=function(x,e,r,i){function c(o,d){return g.coerce(x,e,k,o,d)}var n=c("u"),m=c("v"),p=c("w"),s=c("x"),f=c("y"),l=c("z");n&&n.length&&m&&m.length&&p&&p.length&&s&&s.length&&f&&f.length&&l&&l.length?(c("starts.x"),c("starts.y"),c("starts.z"),c("maxdisplayed"),c("sizeref"),c("lighting.ambient"),c("lighting.diffuse"),c("lighting.specular"),c("lighting.roughness"),c("lighting.fresnel"),c("lightposition.x"),c("lightposition.y"),c("lightposition.z"),t(x,e,i,c,{prefix:"",cLetter:"c"}),c("text"),c("hovertext"),c("hovertemplate"),c("uhoverformat"),c("vhoverformat"),c("whoverformat"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"streamtube",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:v("./calc").calc,plot:v("./convert"),eventData:function(g,t){return g.tubex=g.x,g.tubey=g.y,g.tubez=g.z,g.tubeu=t.traceCoordinate[3],g.tubev=t.traceCoordinate[4],g.tubew=t.traceCoordinate[5],g.norm=t.traceCoordinate[6],g.divergence=t.traceCoordinate[7],delete g.x,delete g.y,delete g.z,g},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(v,Q,$){"use strict";var g=v("../../plots/attributes"),t=v("../../plots/template_attributes").hovertemplateAttrs,k=v("../../plots/template_attributes").texttemplateAttrs,x=v("../../components/colorscale/attributes"),e=v("../../plots/domain").attributes,r=v("../pie/attributes"),i=v("./constants"),c=v("../../lib/extend").extendFlat;Q.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:c({colors:{valType:"data_array",editType:"calc"},line:{color:c({},r.marker.line.color,{dflt:null}),width:c({},r.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},x("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:r.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:k({editType:"plot"},{keys:i.eventDataKeys.concat(["label","value"])}),hovertext:r.hovertext,hoverinfo:c({},g.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:t({},{keys:i.eventDataKeys}),textfont:r.textfont,insidetextorientation:r.insidetextorientation,insidetextfont:r.insidetextfont,outsidetextfont:c({},r.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:r.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(v,Q,$){"use strict";var g=v("../../plots/plots");$.name="sunburst",$.plot=function(t,k,x,e){g.plotBasePlot($.name,t,k,x,e)},$.clean=function(t,k,x,e){g.cleanBasePlot($.name,t,k,x,e)}},{"../../plots/plots":628}],1060:[function(v,Q,$){"use strict";var g=v("d3-hierarchy"),t=v("fast-isnumeric"),k=v("../../lib"),x=v("../../components/colorscale").makeColorScaleFuncFromTrace,e=v("../pie/calc").makePullColorFn,r=v("../pie/calc").generateExtendedColors,i=v("../../components/colorscale").calc,c=v("../../constants/numerical").ALMOST_EQUAL,n={},m={},p={};$.calc=function(s,f){var l,o,d,u,a,y,h=s._fullLayout,_=f.ids,b=k.isArrayOrTypedArray(_),w=f.labels,T=f.parents,L=f.values,M=k.isArrayOrTypedArray(L),P=[],z={},S={},C=function(J){return J||"number"==typeof J},R=function(J){return!M||t(L[J])&&L[J]>=0};b?(l=Math.min(_.length,T.length),o=function(J){return C(_[J])&&R(J)},d=function(J){return String(_[J])}):(l=Math.min(w.length,T.length),o=function(J){return C(w[J])&&R(J)},d=function(J){return String(w[J])}),M&&(l=Math.min(l,L.length));for(var D=0;D<l;D++)if(o(D)){var j=d(D),q=C(T[D])?String(T[D]):"",Z={i:D,id:j,pid:q,label:C(w[D])?String(w[D]):""};M&&(Z.v=+L[D]),P.push(Z),a=j,z[u=q]?z[u].push(a):z[u]=[a],S[a]=1}if(z[""]){if(z[""].length>1){for(var W=k.randstr(),G=0;G<P.length;G++)""===P[G].pid&&(P[G].pid=W);P.unshift({hasMultipleRoots:!0,id:W,pid:"",label:""})}}else{var X,ne=[];for(X in z)S[X]||ne.push(X);if(1!==ne.length)return k.warn(["Multiple implied roots, cannot build",f.type,"hierarchy of",f.name+".","These roots include:",ne.join(", ")].join(" "));P.unshift({hasImpliedRoot:!0,id:X=ne[0],pid:"",label:X})}try{y=g.stratify().id(function(J){return J.id}).parentId(function(J){return J.pid})(P)}catch(J){return k.warn(["Failed to build",f.type,"hierarchy of",f.name+".","Error:",J.message].join(" "))}var V=g.hierarchy(y),N=!1;if(M)switch(f.branchvalues){case"remainder":V.sum(function(J){return J.data.v});break;case"total":V.each(function(J){var te=J.data.data,ae=te.v;if(J.children){var ce=J.children.reduce(function(oe,ve){return oe+ve.data.data.v},0);if((te.hasImpliedRoot||te.hasMultipleRoots)&&(ae=ce),ae<ce*c)return N=!0,k.warn(["Total value for node",J.data.data.id,"of",f.name,"is smaller than the sum of its children.","\nparent value =",ae,"\nchildren sum =",ce].join(" "))}J.value=ae})}else!function J(te,ae,ce){var oe=0,ve=te.children;if(ve){for(var fe=ve.length,xe=0;xe<fe;xe++)oe+=J(ve[xe],ae,ce);ce.branches&&oe++}else ce.leaves&&oe++;return te.value=te.data.data.value=oe,ae._values||(ae._values=[]),ae._values[te.data.data.i]=oe,oe}(V,f,{branches:-1!==f.count.indexOf("branches"),leaves:-1!==f.count.indexOf("leaves")});if(!N){var U,ee;f.sort&&V.sort(function(J,te){return te.value-J.value});var B=f.marker.colors||[];return f._hasColorscale?(!!B.length||(B=M?f.values:f._values),i(s,f,{vals:B,containerStr:"marker",cLetter:"c"}),ee=x(f.marker)):U=e(h["_"+f.type+"colormap"]),V.each(function(J){var te=J.data.data;te.color=f._hasColorscale?ee(B[te.i]):U(B[te.i],te.id)}),P[0].hierarchy=V,P}},$._runCrossTraceCalc=function(s,f){var l=f._fullLayout,o=f.calcdata,d=l[s+"colorway"],u=l["_"+s+"colormap"];l["extend"+s+"colors"]&&(d=r(d,"icicle"===s?p:"treemap"===s?m:n));var a,y=0;function h(w){var T=w.data.data,L=T.id;!1===T.color&&(u[L]?T.color=u[L]:w.parent?w.parent.parent?T.color=w.parent.data.data.color:(u[L]=T.color=d[y%d.length],y++):T.color=a)}for(var _=0;_<o.length;_++){var b=o[_][0];b.trace.type===s&&b.hierarchy&&(a=b.trace.root.color,b.hierarchy.each(h))}},$.crossTraceCalc=function(s){return $._runCrossTraceCalc("sunburst",s)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(v,Q,$){"use strict";Q.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../plots/domain").defaults,x=v("../bar/defaults").handleText,e=v("../../components/colorscale"),r=e.hasColorscale,i=e.handleDefaults;Q.exports=function(c,n,m,p){function s(a,y){return g.coerce(c,n,t,a,y)}var f=s("labels"),l=s("parents");if(f&&f.length&&l&&l.length){var o=s("values");s(o&&o.length?"branchvalues":"count"),s("level"),s("maxdepth"),s("marker.line.width")&&s("marker.line.color",p.paper_bgcolor),s("marker.colors");var d=n._hasColorscale=r(c,"marker","colors")||(c.marker||{}).coloraxis;d&&i(c,n,p,s,{prefix:"marker.",cLetter:"c"}),s("leaf.opacity",d?1:.7);var u=s("text");s("texttemplate"),n.texttemplate||s("textinfo",Array.isArray(u)?"text+label":"label"),s("hovertext"),s("hovertemplate"),x(c,n,p,s,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),s("insidetextorientation"),s("sort"),s("rotation"),s("root.color"),k(n,p,s),n._length=null}else n.visible=!1}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../registry"),k=v("../../components/fx/helpers").appendArrayPointValue,x=v("../../components/fx"),e=v("../../lib"),r=v("../../lib/events"),i=v("./helpers"),c=v("../pie/helpers").formatPieValue;function n(m,p,s){for(var f=m.data.data,l={curveNumber:p.index,pointNumber:f.i,data:p._input,fullData:p},o=0;o<s.length;o++){var d=s[o];d in m&&(l[d]=m[d])}return"parentString"in m&&!i.isHierarchyRoot(m)&&(l.parent=m.parentString),k(l,p,f.i),l}Q.exports=function(m,p,s,f,l){var o=f[0],d=o.trace,u=o.hierarchy,a="sunburst"===d.type,y="treemap"===d.type||"icicle"===d.type;"_hasHoverLabel"in d||(d._hasHoverLabel=!1),"_hasHoverEvent"in d||(d._hasHoverEvent=!1),m.on("mouseover",function(h){var _=s._fullLayout;if(!s._dragging&&!1!==_.hovermode){var b,w=s._fullData[d.index],T=h.data.data,L=T.i,M=i.isHierarchyRoot(h),P=i.getParent(u,h),z=i.getValue(h),S=function(K){return e.castOption(w,L,K)},C=S("hovertemplate"),R=x.castHoverinfo(w,_,L),D=_.separators;if(C||R&&"none"!==R&&"skip"!==R){var j,q;a&&(j=o.cx+h.pxmid[0]*(1-h.rInscribed),q=o.cy+h.pxmid[1]*(1-h.rInscribed)),y&&(j=h._hoverX,q=h._hoverY);var Z,W={},G=[],X=[],ne=function(K){return-1!==G.indexOf(K)};R&&(G="all"===R?w._module.attributes.hoverinfo.flags:R.split("+")),W.label=T.label,ne("label")&&W.label&&X.push(W.label),T.hasOwnProperty("v")&&(W.value=T.v,W.valueLabel=c(W.value,D),ne("value")&&X.push(W.valueLabel)),W.currentPath=h.currentPath=i.getPath(h.data),ne("current path")&&!M&&X.push(W.currentPath);var V=[],N=function(){-1===V.indexOf(Z)&&(X.push(Z),V.push(Z))};W.percentParent=h.percentParent=z/i.getValue(P),W.parent=h.parentString=i.getPtLabel(P),ne("percent parent")&&(Z=i.formatPercent(W.percentParent,D)+" of "+W.parent,N()),W.percentEntry=h.percentEntry=z/i.getValue(p),W.entry=h.entry=i.getPtLabel(p),!ne("percent entry")||M||h.onPathbar||(Z=i.formatPercent(W.percentEntry,D)+" of "+W.entry,N()),W.percentRoot=h.percentRoot=z/i.getValue(u),W.root=h.root=i.getPtLabel(u),ne("percent root")&&!M&&(Z=i.formatPercent(W.percentRoot,D)+" of "+W.root,N()),W.text=S("hovertext")||S("text"),ne("text")&&e.isValidTextValue(Z=W.text)&&X.push(Z),b=[n(h,w,l.eventDataKeys)];var U={trace:w,y:q,_x0:h._x0,_x1:h._x1,_y0:h._y0,_y1:h._y1,text:X.join("<br>"),name:C||ne("name")?w.name:void 0,color:S("hoverlabel.bgcolor")||T.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:C,hovertemplateLabels:W,eventData:b};a&&(U.x0=j-h.rInscribed*h.rpx1,U.x1=j+h.rInscribed*h.rpx1,U.idealAlign=h.pxmid[0]<0?"left":"right"),y&&(U.x=j,U.idealAlign=j<0?"left":"right");var ee=[];x.loneHover(U,{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:s,inOut_bbox:ee}),b[0].bbox=ee[0],d._hasHoverLabel=!0}if(y){var B=m.select("path.surface");l.styleOne(B,h,w,{hovered:!0})}d._hasHoverEvent=!0,s.emit("plotly_hover",{points:b||[n(h,w,l.eventDataKeys)],event:g.event})}}),m.on("mouseout",function(h){var _=s._fullLayout,b=s._fullData[d.index],w=g.select(this).datum();if(d._hasHoverEvent&&(h.originalEvent=g.event,s.emit("plotly_unhover",{points:[n(w,b,l.eventDataKeys)],event:g.event}),d._hasHoverEvent=!1),d._hasHoverLabel&&(x.loneUnhover(_._hoverlayer.node()),d._hasHoverLabel=!1),y){var T=m.select("path.surface");l.styleOne(T,w,b,{hovered:!1})}}),m.on("click",function(h){var _=s._fullLayout,b=s._fullData[d.index],w=a&&(i.isHierarchyRoot(h)||i.isLeaf(h)),T=i.getPtId(h),L=i.isEntry(h)?i.findEntryWithChild(u,T):i.findEntryWithLevel(u,T),M=i.getPtId(L),P={points:[n(h,b,l.eventDataKeys)],event:g.event};w||(P.nextLevel=M);var z=r.triggerHandler(s,"plotly_"+d.type+"click",P);if(!1!==z&&_.hovermode&&(s._hoverdata=[n(h,b,l.eventDataKeys)],x.click(s,g.event)),!w&&!1!==z&&!s._dragging&&!s._transitioning){t.call("_storeDirectGUIEdit",b,_._tracePreGUI[b.uid],{level:b.level});var S={data:[{level:M}],traces:[d.index]},C={frame:{redraw:!1,duration:l.transitionTime},transition:{duration:l.transitionTime,easing:l.transitionEasing},mode:"immediate",fromcurrent:!0};x.loneUnhover(_._hoverlayer.node()),t.call("animate",s,S,C)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../../lib/setcursor"),x=v("../pie/helpers");function e(r){return r.data.data.pid}$.findEntryWithLevel=function(r,i){var c;return i&&r.eachAfter(function(n){if($.getPtId(n)===i)return c=n.copy()}),c||r},$.findEntryWithChild=function(r,i){var c;return r.eachAfter(function(n){for(var m=n.children||[],p=0;p<m.length;p++)if($.getPtId(m[p])===i)return c=n.copy()}),c||r},$.isEntry=function(r){return!r.parent},$.isLeaf=function(r){return!r.children},$.getPtId=function(r){return r.data.data.id},$.getPtLabel=function(r){return r.data.data.label},$.getValue=function(r){return r.value},$.isHierarchyRoot=function(r){return""===e(r)},$.setSliceCursor=function(r,i,c){var n=c.isTransitioning;if(!n){var m=r.datum();n=c.hideOnRoot&&$.isHierarchyRoot(m)||c.hideOnLeaves&&$.isLeaf(m)}k(r,n?null:"pointer")},$.getInsideTextFontKey=function(r,i,c,n,m){var s=c.data.data.i;return g.castOption(i,s,((m||{}).onPathbar?"pathbar.textfont":"insidetextfont")+"."+r)||g.castOption(i,s,"textfont."+r)||n.size},$.getOutsideTextFontKey=function(r,i,c,n){var m=c.data.data.i;return g.castOption(i,m,"outsidetextfont."+r)||g.castOption(i,m,"textfont."+r)||n.size},$.isOutsideText=function(r,i){return!r._hasColorscale&&$.isHierarchyRoot(i)},$.determineTextFont=function(r,i,c,n){return $.isOutsideText(r,i)?{color:$.getOutsideTextFontKey("color",m=r,p=i,s=c),family:$.getOutsideTextFontKey("family",m,p,s),size:$.getOutsideTextFontKey("size",m,p,s)}:function(m,p,s,f){var o=p.data.data,d=o.i,u=g.castOption(m,d,((f||{}).onPathbar?"pathbar.textfont":"insidetextfont")+".color");return!u&&m._input.textfont&&(u=g.castOption(m._input,d,"textfont.color")),{color:u||t.contrast(o.color),family:$.getInsideTextFontKey("family",m,p,s,f),size:$.getInsideTextFontKey("size",m,p,s,f)}}(r,i,c,n);var m,p,s},$.hasTransition=function(r){return!!(r&&r.duration>0)},$.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},$.isHeader=function(r,i){return!($.isLeaf(r)||r.depth===i._maxDepth-1)},$.getParent=function(r,i){return $.findEntryWithLevel(r,e(i))},$.listPath=function(r,i){var c=r.parent;if(!c)return[];var n=i?[c.data[i]]:[c];return $.listPath(c,i).concat(n)},$.getPath=function(r){return $.listPath(r,"label").join("/")+"/"},$.formatValue=x.formatPieValue,$.formatPercent=function(r,i){var c=g.formatPercent(r,0);return"0%"===c&&(c=x.formatPiePercent(r,i)),c}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"sunburst",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(v,Q,$){"use strict";Q.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x){function e(r,i){return g.coerce(k,x,t,r,i)}e("sunburstcolorway",x.colorway),e("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-hierarchy"),k=v("d3-interpolate").interpolate,x=v("../../components/drawing"),e=v("../../lib"),r=v("../../lib/svg_text_utils"),i=v("../bar/uniform_text"),c=i.recordMinTextSize,n=i.clearMinTextSize,m=v("../pie/plot"),p=v("../pie/helpers").getRotationAngle,s=m.computeTransform,f=m.transformInsideText,l=v("./style").styleOne,o=v("../bar/style").resizeText,d=v("./fx"),u=v("./constants"),a=v("./helpers");function y(_,b,w,T){var L=_._context.staticPlot,M=_._fullLayout,P=!M.uniformtext.mode&&a.hasTransition(T),z=g.select(w).selectAll("g.slice"),S=b[0],C=S.trace,D=a.findEntryWithLevel(S.hierarchy,C.level),j=a.getMaxDepth(C),q=M._size,Z=C.domain,G=q.h*(Z.y[1]-Z.y[0]),X=.5*Math.min(q.w*(Z.x[1]-Z.x[0]),G),ne=S.cx=q.l+q.w*(Z.x[1]+Z.x[0])/2,V=S.cy=q.t+q.h*(1-Z.y[0])-G/2;if(!D)return z.remove();var N=null,U={};P&&z.each(function(se){U[a.getPtId(se)]={rpx0:se.rpx0,rpx1:se.rpx1,x0:se.x0,x1:se.x1,transform:se.transform},!N&&a.isEntry(se)&&(N=se)});var se,ee=(se=D,t.partition().size([2*Math.PI,se.height+1])(se)).descendants(),B=D.height+1,K=0,J=j;S.hasMultipleRoots&&a.isHierarchyRoot(D)&&(ee=ee.slice(1),B-=1,K=1,J+=1),ee=ee.filter(function(se){return se.y1<=J});var te=p(C.rotation);te&&ee.forEach(function(se){se.x0+=te,se.x1+=te});var ae=Math.min(B,j),ce=function(se){return(se-K)/ae*X},oe=function(se,de){return[se*Math.cos(de),-se*Math.sin(de)]},ve=function(se){return e.pathAnnulus(se.rpx0,se.rpx1,se.x0,se.x1,ne,V)},fe=function(se){return ne+h(se)[0]*(se.transform.rCenter||0)+(se.transform.x||0)},xe=function(se){return V+h(se)[1]*(se.transform.rCenter||0)+(se.transform.y||0)};(z=z.data(ee,a.getPtId)).enter().append("g").classed("slice",!0),P?z.exit().transition().each(function(){var se=g.select(this);se.select("path.surface").transition().attrTween("d",function(de){var Ae=function(Le){var Me,De=a.getPtId(Le),Oe=U[De],Ie=U[a.getPtId(D)];if(Ie){var Qe=(Le.x1>Ie.x1?2*Math.PI:0)+te;Me=Le.rpx1<Ie.rpx1?{x0:Le.x0,x1:Le.x1,rpx0:0,rpx1:0}:{x0:Qe,x1:Qe,rpx0:Le.rpx0,rpx1:Le.rpx1}}else{var Ne,Pe=a.getPtId(Le.parent);z.each(function(wt){if(a.getPtId(wt)===Pe)return Ne=wt});var Re,Ge=Ne.children;Ge.forEach(function(wt,kt){if(a.getPtId(wt)===De)return Re=kt});var tt=Ge.length,ct=k(Ne.x0,Ne.x1);Me={rpx0:X,rpx1:X,x0:ct(Re/tt),x1:ct((Re+1)/tt)}}return k(Oe,Me)}(de);return function(Le){return ve(Ae(Le))}}),se.select("g.slicetext").attr("opacity",0)}).remove():z.exit().remove(),z.order();var Se=null;if(P&&N){var pe=a.getPtId(N);z.each(function(se){null===Se&&a.getPtId(se)===pe&&(Se=se.x1)})}var ge=z;function Te(se){var de=se.parent,Ae=U[a.getPtId(de)],Le={};if(Ae){var Me=de.children,De=Me.indexOf(se),Oe=Me.length,Ie=k(Ae.x0,Ae.x1);Le.x0=Ie(De/Oe),Le.x1=Ie(De/Oe)}else Le.x0=Le.x1=0;return Le}P&&(ge=ge.transition().each("end",function(){var se=g.select(this);a.setSliceCursor(se,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),ge.each(function(se){var Qe,de=g.select(this),Ae=e.ensureSingle(de,"path","surface",function(Qe){Qe.style("pointer-events",L?"none":"all")});se.rpx0=ce(se.y0),se.rpx1=ce(se.y1),se.xmid=(se.x0+se.x1)/2,se.pxmid=oe(se.rpx1,se.xmid),se.midangle=-(se.xmid-Math.PI/2),se.startangle=-(se.x0-Math.PI/2),se.stopangle=-(se.x1-Math.PI/2),se.halfangle=.5*Math.min(e.angleDelta(se.x0,se.x1)||Math.PI,Math.PI),se.ring=1-se.rpx0/se.rpx1,se.rInscribed=0===(Qe=se).rpx0&&e.isFullCircle([Qe.x0,Qe.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Qe.halfangle)),Qe.ring/2)),P?Ae.transition().attrTween("d",function(Qe){var Ne=function(Pe){var Re,Ge=U[a.getPtId(Pe)],tt={x0:Pe.x0,x1:Pe.x1,rpx0:Pe.rpx0,rpx1:Pe.rpx1};if(Ge)Re=Ge;else if(N)if(Pe.parent)if(Se){var ct=(Pe.x1>Se?2*Math.PI:0)+te;Re={x0:ct,x1:ct}}else e.extendFlat(Re={rpx0:X,rpx1:X},Te(Pe));else Re={rpx0:0,rpx1:0};else Re={x0:te,x1:te};return k(Re,tt)}(Qe);return function(Pe){return ve(Ne(Pe))}}):Ae.attr("d",ve),de.call(d,D,_,b,{eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:_._transitioning}),Ae.call(l,se,C);var Le=e.ensureSingle(de,"g","slicetext"),Me=e.ensureSingle(Le,"text","",function(Qe){Qe.attr("data-notex",1)}),De=e.ensureUniformFontSize(_,a.determineTextFont(C,se,M.font));Me.text($.formatSliceLabel(se,D,C,b,M)).classed("slicetext",!0).attr("text-anchor","middle").call(x.font,De).call(r.convertToTspans,_);var Oe=x.bBox(Me.node());se.transform=f(Oe,se,S),se.transform.targetX=fe(se),se.transform.targetY=xe(se);var Ie=function(Qe,Ne){var Pe=Qe.transform;return s(Pe,Ne),Pe.fontSize=De.size,c(C.type,Pe,M),e.getTextTransform(Pe)};P?Me.transition().attrTween("transform",function(Qe){var Ne=function(Pe){var Re,Ge=U[a.getPtId(Pe)],tt=Pe.transform;if(Ge)Re=Ge;else if(Re={rpx1:Pe.rpx1,transform:{textPosAngle:tt.textPosAngle,scale:0,rotate:tt.rotate,rCenter:tt.rCenter,x:tt.x,y:tt.y}},N)if(Pe.parent)if(Se){var ct=Pe.x1>Se?2*Math.PI:0;Re.x0=Re.x1=ct}else e.extendFlat(Re,Te(Pe));else Re.x0=Re.x1=te;else Re.x0=Re.x1=te;var wt=k(Re.transform.textPosAngle,Pe.transform.textPosAngle),kt=k(Re.rpx1,Pe.rpx1),gt=k(Re.x0,Pe.x0),at=k(Re.x1,Pe.x1),et=k(Re.transform.scale,tt.scale),yt=k(Re.transform.rotate,tt.rotate),Vt=0===tt.rCenter?3:0===Re.transform.rCenter?1/3:1,Gt=k(Re.transform.rCenter,tt.rCenter);return function(en){var Jt=kt(en),cn=gt(en),Rt=at(en),je=Gt(Math.pow(en,Vt)),Ye={pxmid:oe(Jt,(cn+Rt)/2),rpx1:Jt,transform:{textPosAngle:wt(en),rCenter:je,x:tt.x,y:tt.y}};return c(C.type,tt,M),{transform:{targetX:fe(Ye),targetY:xe(Ye),scale:et(en),rotate:yt(en),rCenter:je}}}}(Qe);return function(Pe){return Ie(Ne(Pe),Oe)}}):Me.attr("transform",Ie(se,Oe))})}function h(_){return w=_.transform.textPosAngle,[(b=_.rpx1)*Math.sin(w),-b*Math.cos(w)];var b,w}$.plot=function(_,b,w,T){var L,M,P=_._fullLayout,z=P._sunburstlayer,S=!w,C=!P.uniformtext.mode&&a.hasTransition(w);n("sunburst",P),(L=z.selectAll("g.trace.sunburst").data(b,function(R){return R[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),C?(T&&(M=T()),g.transition().duration(w.duration).ease(w.easing).each("end",function(){M&&M()}).each("interrupt",function(){M&&M()}).each(function(){z.selectAll("g.trace").each(function(R){y(_,R,this,w)})})):(L.each(function(R){y(_,R,this,w)}),P.uniformtext.mode&&o(_,P._sunburstlayer.selectAll(".trace"),"sunburst")),S&&L.exit().remove()},$.formatSliceLabel=function(_,b,w,T,L){var M=w.texttemplate,P=w.textinfo;if(!(M||P&&"none"!==P))return"";var z=L.separators,C=_.data.data,R=T[0].hierarchy,D=a.isHierarchyRoot(_),j=a.getParent(R,_),q=a.getValue(_);if(!M){var Z,W=P.split("+"),G=function(J){return-1!==W.indexOf(J)},X=[];if(G("label")&&C.label&&X.push(C.label),C.hasOwnProperty("v")&&G("value")&&X.push(a.formatValue(C.v,z)),!D){G("current path")&&X.push(a.getPath(_.data));var ne=0;G("percent parent")&&ne++,G("percent entry")&&ne++,G("percent root")&&ne++;var V=ne>1;if(ne){var N,U=function(J){Z=a.formatPercent(N,z),V&&(Z+=" of "+J),X.push(Z)};G("percent parent")&&!D&&(N=q/a.getValue(j),U("parent")),G("percent entry")&&(N=q/a.getValue(b),U("entry")),G("percent root")&&(N=q/a.getValue(R),U("root"))}}return G("text")&&(Z=e.castOption(w,C.i,"text"),e.isValidTextValue(Z)&&X.push(Z)),X.join("<br>")}var ee=e.castOption(w,C.i,"texttemplate");if(!ee)return"";var B={};C.label&&(B.label=C.label),C.hasOwnProperty("v")&&(B.value=C.v,B.valueLabel=a.formatValue(C.v,z)),B.currentPath=a.getPath(_.data),D||(B.percentParent=q/a.getValue(j),B.percentParentLabel=a.formatPercent(B.percentParent,z),B.parent=a.getPtLabel(j)),B.percentEntry=q/a.getValue(b),B.percentEntryLabel=a.formatPercent(B.percentEntry,z),B.entry=a.getPtLabel(b),B.percentRoot=q/a.getValue(R),B.percentRootLabel=a.formatPercent(B.percentRoot,z),B.root=a.getPtLabel(R),C.hasOwnProperty("color")&&(B.color=C.color);var K=e.castOption(w,C.i,"text");return(e.isValidTextValue(K)||""===K)&&(B.text=K),B.customdata=e.castOption(w,C.i,"customdata"),e.texttemplateString(ee,B,L._d3locale,B,w._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../../lib"),x=v("../bar/uniform_text").resizeText;function e(r,i,c){var n=i.data.data,m=!i.children,p=n.i,s=k.castOption(c,p,"marker.line.color")||t.defaultLine,f=k.castOption(c,p,"marker.line.width")||0;r.style("stroke-width",f).call(t.fill,n.color).call(t.stroke,s).style("opacity",m?c.leaf.opacity:null)}Q.exports={style:function(r){var i=r._fullLayout._sunburstlayer.selectAll(".trace");x(r,i,"sunburst"),i.each(function(c){var n=g.select(this),m=c[0].trace;n.style("opacity",m.opacity),n.selectAll("path.surface").each(function(p){g.select(this).call(e,p,m)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../../components/colorscale/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,i=v("../../plot_api/edit_types").overrideAll;function c(m){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:g.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:g.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var n=Q.exports=i(r({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:x(),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},t("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:c(),y:c(),z:c()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:r({},t.zauto,{}),zmin:r({},t.zmin,{}),zmax:r({},t.zmax,{})},hoverinfo:r({},e.hoverinfo),showlegend:r({},e.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/calc");Q.exports=function(t,k){g(t,k,k.surfacecolor?{vals:k.surfacecolor,containerStr:"",cLetter:"c"}:{vals:k.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_surface3d,t=v("../../../stackgl_modules").ndarray,k=v("../../../stackgl_modules").ndarray_linear_interpolate.d2,x=v("../heatmap/interp2d"),e=v("../heatmap/find_empties"),r=v("../../lib").isArrayOrTypedArray,i=v("../../lib/gl_format_color").parseColorScale,c=v("../../lib/str2rgbarray"),n=v("../../components/colorscale").extractOpts;function m(w,T,L){this.scene=w,this.uid=L,this.surface=T,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var p=m.prototype;p.getXat=function(w,T,L,M){var P=r(this.data.x)?r(this.data.x[0])?this.data.x[T][w]:this.data.x[w]:w;return void 0===L?P:M.d2l(P,0,L)},p.getYat=function(w,T,L,M){var P=r(this.data.y)?r(this.data.y[0])?this.data.y[T][w]:this.data.y[T]:T;return void 0===L?P:M.d2l(P,0,L)},p.getZat=function(w,T,L,M){var P=this.data.z[T][w];return null===P&&this.data.connectgaps&&this.data._interpolatedZ&&(P=this.data._interpolatedZ[T][w]),void 0===L?P:M.d2l(P,0,L)},p.handlePick=function(w){if(w.object===this.surface){var L=(w.data.index[1]-1)/this.dataScaleY-1,M=Math.max(Math.min(Math.round((w.data.index[0]-1)/this.dataScaleX-1),this.data.z[0].length-1),0),P=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);w.index=[M,P],w.traceCoordinate=[this.getXat(M,P),this.getYat(M,P),this.getZat(M,P)],w.dataCoordinate=[this.getXat(M,P,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(M,P,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(M,P,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var z=0;z<3;z++)null!=w.dataCoordinate[z]&&(w.dataCoordinate[z]*=this.scene.dataScale[z]);var C=this.data.hovertext||this.data.text;return w.textLabel=Array.isArray(C)&&C[P]&&void 0!==C[P][M]?C[P][M]:C||"",w.data.dataCoordinate=w.dataCoordinate.slice(),this.surface.highlight(w.data),this.scene.glplot.spikes.position=w.dataCoordinate,!0}};var s=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function f(w,T){if(w<T)return 0;for(var L=0;0===Math.floor(w%T);)w/=T,L++;return L}function l(w){for(var T=[],L=0;L<s.length;L++)T.push(f(w,s[L]));return T}function o(w){for(var T=l(w),L=w,M=0;M<s.length;M++)if(T[M]>0){L=s[M];break}return L}function d(w,T){if(!(w<1||T<1)){for(var L=l(w),M=l(T),P=1,z=0;z<s.length;z++)P*=Math.pow(s[z],Math.max(L[z],M[z]));return P}}p.calcXnums=function(w){var T,L=[];for(T=1;T<w;T++){var M=this.getXat(T-1,0),P=this.getXat(T,0);L[T-1]=P!==M&&null!=M&&null!=P?Math.abs(P-M):0}var z=0;for(T=1;T<w;T++)z+=L[T-1];for(T=1;T<w;T++)L[T-1]=0===L[T-1]?1:Math.round(z/L[T-1]);return L},p.calcYnums=function(w){var T,L=[];for(T=1;T<w;T++){var M=this.getYat(0,T-1),P=this.getYat(0,T);L[T-1]=P!==M&&null!=M&&null!=P?Math.abs(P-M):0}var z=0;for(T=1;T<w;T++)z+=L[T-1];for(T=1;T<w;T++)L[T-1]=0===L[T-1]?1:Math.round(z/L[T-1]);return L};var u=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],a=u[9],y=u[13];function h(w,T,L){var M=L[8]+L[2]*T[0]+L[5]*T[1];return w[0]=(L[6]+L[0]*T[0]+L[3]*T[1])/M,w[1]=(L[7]+L[1]*T[0]+L[4]*T[1])/M,w}function _(w,T,L){return function(M,P,z,S){for(var C=[0,0],R=M.shape[0],D=M.shape[1],j=0;j<R;j++)for(var q=0;q<D;q++)z(C,[j,q],S),M.set(j,q,k(P,C[0],C[1]))}(w,T,h,L),w}function b(w,T){for(var L=!1,M=0;M<w.length;M++)if(T===w[M]){L=!0;break}!1===L&&w.push(T)}p.estimateScale=function(w,T){for(var L=1+function(P){if(0!==P.length){for(var z=1,S=0;S<P.length;S++)z=d(z,P[S]);return z}}(0===T?this.calcXnums(w):this.calcYnums(w));L<a;)L*=2;for(;L>y;)L--,L/=o(L),++L<a&&(L=y);var M=Math.round(L/w);return M>1?M:1},p.refineCoords=function(w){for(var T=this.dataScaleX,L=this.dataScaleY,M=w[0].shape[0],P=w[0].shape[1],z=0|Math.floor(w[0].shape[0]*T+1),S=0|Math.floor(w[0].shape[1]*L+1),C=1+M+1,R=1+P+1,D=t(new Float32Array(C*R),[C,R]),j=[1/T,0,0,0,1/L,0,0,0,1],q=0;q<w.length;++q){this.surface.padField(D,w[q]);var Z=t(new Float32Array(z*S),[z,S]);_(Z,D,j),w[q]=Z}},p.setContourLevels=function(){var w,T,M=[[],[],[]],P=[!1,!1,!1],z=!1;for(w=0;w<3;++w)if(this.showContour[w]&&(z=!0,this.contourSize[w]>0&&null!==this.contourStart[w]&&null!==this.contourEnd[w]&&this.contourEnd[w]>this.contourStart[w]))for(P[w]=!0,T=this.contourStart[w];T<this.contourEnd[w];T+=this.contourSize[w])b(M[w],T*this.scene.dataScale[w]);if(z){var S=[[],[],[]];for(w=0;w<3;++w)this.showContour[w]&&(S[w]=P[w]?M[w]:this.scene.contourLevels[w]);this.surface.update({levels:S})}},p.update=function(w){var T,L,M,P,z=this.scene,S=z.fullSceneLayout,C=this.surface,R=i(w),D=z.dataScale,j=w.z[0].length,q=w._ylength,Z=z.contourLevels;this.data=w;var W=[];for(T=0;T<3;T++)for(W[T]=[],L=0;L<j;L++)W[T][L]=[];for(L=0;L<j;L++)for(M=0;M<q;M++)W[0][L][M]=this.getXat(L,M,w.xcalendar,S.xaxis),W[1][L][M]=this.getYat(L,M,w.ycalendar,S.yaxis),W[2][L][M]=this.getZat(L,M,w.zcalendar,S.zaxis);if(w.connectgaps)for(w._emptypoints=e(W[2]),x(W[2],w._emptypoints),w._interpolatedZ=[],L=0;L<j;L++)for(w._interpolatedZ[L]=[],M=0;M<q;M++)w._interpolatedZ[L][M]=W[2][L][M];for(T=0;T<3;T++)for(L=0;L<j;L++)for(M=0;M<q;M++)null==(P=W[T][L][M])?W[T][L][M]=NaN:P=W[T][L][M]*=D[T];for(T=0;T<3;T++)for(L=0;L<j;L++)for(M=0;M<q;M++)null!=(P=W[T][L][M])&&(this.minValues[T]>P&&(this.minValues[T]=P),this.maxValues[T]<P&&(this.maxValues[T]=P));for(T=0;T<3;T++)this.objectOffset[T]=.5*(this.minValues[T]+this.maxValues[T]);for(T=0;T<3;T++)for(L=0;L<j;L++)for(M=0;M<q;M++)null!=(P=W[T][L][M])&&(W[T][L][M]-=this.objectOffset[T]);var G=[t(new Float32Array(j*q),[j,q]),t(new Float32Array(j*q),[j,q]),t(new Float32Array(j*q),[j,q])];for(T=0;T<3;T++)for(L=0;L<j;L++)for(M=0;M<q;M++)G[T].set(L,M,W[T][L][M]);W=[];var X={colormap:R,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!w.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:w.opacityscale,opacity:w.opacity},ne=n(w);if(X.intensityBounds=[ne.min,ne.max],w.surfacecolor){var V=t(new Float32Array(j*q),[j,q]);for(L=0;L<j;L++)for(M=0;M<q;M++)V.set(L,M,w.surfacecolor[M][L]);G.push(V)}else X.intensityBounds[0]*=D[2],X.intensityBounds[1]*=D[2];(y<G[0].shape[0]||y<G[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(G[0].shape[0],0),this.dataScaleY=this.estimateScale(G[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(G)),w.surfacecolor&&(X.intensity=G.pop());var B,K,J,N=[!0,!0,!0],U=["x","y","z"];for(T=0;T<3;++T){var ee=w.contours[U[T]];N[T]=ee.highlight,X.showContour[T]=ee.show||ee.highlight,X.showContour[T]&&(X.contourProject[T]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[T]=!0,X.levels[T]=Z[T],C.highlightColor[T]=X.contourColor[T]=c(ee.color),C.highlightTint[T]=X.contourTint[T]=ee.usecolormap?0:1,X.contourWidth[T]=ee.width,this.contourStart[T]=ee.start,this.contourEnd[T]=ee.end,this.contourSize[T]=ee.size):(this.showContour[T]=!1,this.contourStart[T]=null,this.contourEnd[T]=null,this.contourSize[T]=0),ee.highlight&&(X.dynamicColor[T]=c(ee.highlightcolor),X.dynamicWidth[T]=ee.highlightwidth))}(K=(B=R)[0].rgb)[0]===(J=B[B.length-1].rgb)[0]&&K[1]===J[1]&&K[2]===J[2]&&K[3]===J[3]&&(X.vertexColor=!0),X.objectOffset=this.objectOffset,X.coords=G,C.update(X),C.visible=w.visible,C.enableDynamic=N,C.enableHighlight=N,C.snapToData=!0,"lighting"in w&&(C.ambientLight=w.lighting.ambient,C.diffuseLight=w.lighting.diffuse,C.specularLight=w.lighting.specular,C.roughness=w.lighting.roughness,C.fresnel=w.lighting.fresnel),"lightposition"in w&&(C.lightPosition=[w.lightposition.x,w.lightposition.y,w.lightposition.z])},p.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},Q.exports=function(w,T){var M=g({gl:w.glplot.gl}),P=new m(w,M,T.uid);return M._trace=P,P.update(T),w.glplot.add(M),P}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(v,Q,$){"use strict";var g=v("../../registry"),t=v("../../lib"),k=v("../../components/colorscale/defaults"),x=v("./attributes");function e(i,c,n,m){var p=m("opacityscale");"max"===p?c.opacityscale=[[0,.1],[1,1]]:"min"===p?c.opacityscale=[[0,1],[1,.1]]:"extremes"===p?c.opacityscale=function(s,f){for(var l=[],o=0;o<32;o++){var d=o/31,u=.1+.9*(1-Math.pow(Math.sin(1*d*Math.PI),2));l.push([d,Math.max(0,Math.min(1,u))])}return l}():function(s){var f=0;if(!Array.isArray(s)||s.length<2||!s[0]||!s[s.length-1]||0!=+s[0][0]||1!=+s[s.length-1][0])return!1;for(var l=0;l<s.length;l++){var o=s[l];if(2!==o.length||+o[0]<f)return!1;f=+o[0]}return!0}(p)||(c.opacityscale=void 0)}function r(i,c,n){c in i&&!(n in i)&&(i[n]=i[c])}Q.exports={supplyDefaults:function(i,c,n,m){var p,s;function f(b,w){return t.coerce(i,c,x,b,w)}var l=f("x"),o=f("y"),d=f("z");if(!d||!d.length||l&&l.length<1||o&&o.length<1)c.visible=!1;else{c._xlength=Array.isArray(l)&&t.isArrayOrTypedArray(l[0])?d.length:d[0].length,c._ylength=d.length,g.getComponentMethod("calendars","handleTraceDefaults")(i,c,["x","y","z"],m),f("text"),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat"),f("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(b){f(b)});var u=f("surfacecolor"),a=["x","y","z"];for(p=0;p<3;++p){var y="contours."+a[p],h=f(y+".show"),_=f(y+".highlight");if(h||_)for(s=0;s<3;++s)f(y+".project."+a[s]);h&&(f(y+".color"),f(y+".width"),f(y+".usecolormap")),_&&(f(y+".highlightcolor"),f(y+".highlightwidth")),f(y+".start"),f(y+".end"),f(y+".size")}u||(r(i,"zmin","cmin"),r(i,"zmax","cmax"),r(i,"zauto","cauto")),k(i,c,m,f,{prefix:"",cLetter:"c"}),e(0,c,0,f),c._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:v("./calc"),plot:v("./convert"),moduleType:"trace",name:"surface",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(v,Q,$){"use strict";var g=v("../../components/annotations/attributes"),t=v("../../lib/extend").extendFlat,k=v("../../plot_api/edit_types").overrideAll,x=v("../../plots/font_attributes"),e=v("../../plots/domain").attributes,r=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(Q.exports=k({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:r("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:t({},g.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:t({},x({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:r("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:t({},g.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:t({},x({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(v,Q,$){"use strict";var g=v("../../plots/get_data").getModuleCalcData,t=v("./plot");$.name="table",$.plot=function(k){var x=g(k.calcdata,"table")[0];x.length&&t(k,x)},$.clean=function(k,x,e,r){var i=r._has&&r._has("table"),c=x._has&&x._has("table");i&&!c&&r._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(v,Q,$){"use strict";var g=v("../../lib/gup").wrap;Q.exports=function(){return g({})}},{"../../lib/gup":512}],1078:[function(v,Q,$){"use strict";Q.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(v,Q,$){"use strict";var g=v("./constants"),t=v("../../lib/extend").extendFlat,k=v("fast-isnumeric");function x(p){if(Array.isArray(p)){for(var s=0,f=0;f<p.length;f++)s=Math.max(s,x(p[f]));return s}return p}function e(p,s){return p+s}function r(p){var s,f=p.slice(),l=1/0,o=0;for(s=0;s<f.length;s++)Array.isArray(f[s])||(f[s]=[f[s]]),l=Math.min(l,f[s].length),o=Math.max(o,f[s].length);if(l!==o)for(s=0;s<f.length;s++){var d=o-f[s].length;d&&(f[s]=f[s].concat(i(d)))}return f}function i(p){for(var s=new Array(p),f=0;f<p;f++)s[f]="";return s}function c(p){return p.calcdata.columns.reduce(function(s,f){return f.xIndex<p.xIndex?s+f.columnWidth:s},0)}function n(p,s){return Object.keys(p).map(function(f){return t({},p[f],{auxiliaryBlocks:s})})}function m(p,s){for(var f,l={},o=0,d=0,u={firstRowIndex:null,lastRowIndex:null,rows:[]},a=0,y=0,h=0;h<p.length;h++)u.rows.push({rowIndex:h,rowHeight:f=p[h]}),((d+=f)>=s||h===p.length-1)&&(l[o]=u,u.key=y++,u.firstRowIndex=a,u.lastRowIndex=h,u={firstRowIndex:null,lastRowIndex:null,rows:[]},o+=d,a=h+1,d=0);return l}Q.exports=function(p,s){var f=r(s.cells.values),l=function(D){return D.slice(s.header.values.length,D.length)},o=r(s.header.values);o.length&&!o[0].length&&(o[0]=[""],o=r(o));var d=o.concat(l(f).map(function(){return i((o[0]||[""]).length)})),u=s.domain,a=Math.floor(p._fullLayout._size.w*(u.x[1]-u.x[0])),y=Math.floor(p._fullLayout._size.h*(u.y[1]-u.y[0])),h=s.header.values.length?d[0].map(function(){return s.header.height}):[g.emptyHeaderHeight],_=f.length?f[0].map(function(){return s.cells.height}):[],b=h.reduce(e,0),w=m(_,y-b+g.uplift),T=n(m(h,b),[]),L=n(w,T),M={},P=s._fullInput.columnorder.concat(l(f.map(function(D,j){return j}))),z=d.map(function(D,j){var q=Array.isArray(s.columnwidth)?s.columnwidth[Math.min(j,s.columnwidth.length-1)]:s.columnwidth;return k(q)?Number(q):1}),S=z.reduce(e,0);z=z.map(function(D){return D/S*a});var C=Math.max(x(s.header.line.width),x(s.cells.line.width)),R={key:s.uid+p._context.staticPlot,translateX:u.x[0]*p._fullLayout._size.w,translateY:p._fullLayout._size.h*(1-u.y[1]),size:p._fullLayout._size,width:a,maxLineWidth:C,height:y,columnOrder:P,groupHeight:y,rowBlocks:L,headerRowBlocks:T,scrollY:0,cells:t({},s.cells,{values:f}),headerCells:t({},s.header,{values:d}),gdColumns:d.map(function(D){return D[0]}),gdColumnsOriginalOrder:d.map(function(D){return D[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:d.map(function(D,j){return M[D]=(M[D]||0)+1,{key:D+"__"+M[D],label:D,specIndex:j,xIndex:P[j],xScale:c,x:void 0,calcdata:void 0,columnWidth:z[j]}})};return R.columns.forEach(function(D){D.calcdata=R,D.x=c(D)}),R}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(v,Q,$){"use strict";var g=v("../../lib/extend").extendFlat;$.splitToPanels=function(t){var k=[0,0],x=g({},t,{key:"header",type:"header",page:0,prevPages:k,currentRepaint:[null,null],dragHandle:!0,values:t.calcdata.headerCells.values[t.specIndex],rowBlocks:t.calcdata.headerRowBlocks,calcdata:g({},t.calcdata,{cells:t.calcdata.headerCells})});return[g({},t,{key:"cells1",type:"cells",page:0,prevPages:k,currentRepaint:[null,null],dragHandle:!1,values:t.calcdata.cells.values[t.specIndex],rowBlocks:t.calcdata.rowBlocks}),g({},t,{key:"cells2",type:"cells",page:1,prevPages:k,currentRepaint:[null,null],dragHandle:!1,values:t.calcdata.cells.values[t.specIndex],rowBlocks:t.calcdata.rowBlocks}),x]},$.splitToCells=function(t){var x,e,r,k=[r=(e=(x=t).rowBlocks[x.page])?e.rows[0].rowIndex:0,e?r+e.rows.length:0];return(t.values||[]).slice(k[0],k[1]).map(function(x,e){return{keyWithinBlock:e+("string"==typeof x&&x.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:k[0]+e,column:t,calcdata:t.calcdata,page:t.page,rowBlocks:t.rowBlocks,value:x}})}},{"../../lib/extend":505}],1081:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../plots/domain").defaults;Q.exports=function(x,e,r,i){function c(n,m){return g.coerce(x,e,t,n,m)}k(e,i,c),c("columnwidth"),c("header.values"),c("header.format"),c("header.align"),c("header.prefix"),c("header.suffix"),c("header.height"),c("header.line.width"),c("header.line.color"),c("header.fill.color"),g.coerceFont(c,"header.font",g.extendFlat({},i.font)),function(n,m){for(var s=n.header.values.length,f=(n.columnorder||[]).slice(0,s),l=f.slice().sort(function(u,a){return u-a}),o=f.map(function(u){return l.indexOf(u)}),d=o.length;d<s;d++)o.push(d);m("columnorder",o)}(e,c),c("cells.values"),c("cells.format"),c("cells.align"),c("cells.prefix"),c("cells.suffix"),c("cells.height"),c("cells.line.width"),c("cells.line.color"),c("cells.fill.color"),g.coerceFont(c,"cells.font",g.extendFlat({},i.font)),e._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),moduleType:"trace",name:"table",basePlotModule:v("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(v,Q,$){"use strict";var g=v("./constants"),t=v("@plotly/d3"),k=v("../../lib").numberFormat,x=v("../../lib/gup"),e=v("../../components/drawing"),r=v("../../lib/svg_text_utils"),i=v("../../lib").raiseToTop,c=v("../../lib").strTranslate,n=v("../../lib").cancelTransition,m=v("./data_preparation_helper"),p=v("./data_split_helpers"),s=v("../../components/color");function f(G){return Math.ceil(G.calcdata.maxLineWidth/2)}function l(G,X){return"clip"+G._fullLayout._uid+"_scrollAreaBottomClip_"+X.key}function o(G,X){return"clip"+G._fullLayout._uid+"_columnBoundaryClippath_"+X.calcdata.key+"_"+X.specIndex}function d(G){return[].concat.apply([],G.map(function(X){return X})).map(function(X){return X.__data__})}function u(G,X,ne){var V=G.selectAll("."+g.cn.scrollbarKit).data(x.repeat,x.keyFun);V.enter().append("g").classed(g.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),V.each(function(K){var ae,J=K.scrollbarState;J.totalHeight=j(ae=K.rowBlocks,ae.length-1)+(ae.length?q(ae[ae.length-1],1/0):1),J.scrollableAreaHeight=K.groupHeight-L(K),J.currentlyVisibleHeight=Math.min(J.totalHeight,J.scrollableAreaHeight),J.ratio=J.currentlyVisibleHeight/J.totalHeight,J.barLength=Math.max(J.ratio*J.currentlyVisibleHeight,g.goldenRatio*g.scrollbarWidth),J.barWiggleRoom=J.currentlyVisibleHeight-J.barLength,J.wiggleRoom=Math.max(0,J.totalHeight-J.scrollableAreaHeight),J.topY=0===J.barWiggleRoom?0:K.scrollY/J.wiggleRoom*J.barWiggleRoom,J.bottomY=J.topY+J.barLength,J.dragMultiplier=J.wiggleRoom/J.barWiggleRoom}).attr("transform",function(K){return c(K.width+g.scrollbarWidth/2+g.scrollbarOffset,L(K))});var N=V.selectAll("."+g.cn.scrollbar).data(x.repeat,x.keyFun);N.enter().append("g").classed(g.cn.scrollbar,!0);var U=N.selectAll("."+g.cn.scrollbarSlider).data(x.repeat,x.keyFun);U.enter().append("g").classed(g.cn.scrollbarSlider,!0),U.attr("transform",function(K){return c(0,K.scrollbarState.topY||0)});var ee=U.selectAll("."+g.cn.scrollbarGlyph).data(x.repeat,x.keyFun);ee.enter().append("line").classed(g.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",g.scrollbarWidth).attr("stroke-linecap","round").attr("y1",g.scrollbarWidth/2),ee.attr("y2",function(K){return K.scrollbarState.barLength-g.scrollbarWidth/2}).attr("stroke-opacity",function(K){return K.columnDragInProgress||!K.scrollbarState.barWiggleRoom||ne?0:.4}),ee.transition().delay(0).duration(0),ee.transition().delay(g.scrollbarHideDelay).duration(g.scrollbarHideDuration).attr("stroke-opacity",0);var B=N.selectAll("."+g.cn.scrollbarCaptureZone).data(x.repeat,x.keyFun);B.enter().append("line").classed(g.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",g.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(K){var J=t.event.y,te=this.getBoundingClientRect(),ae=K.scrollbarState,ce=J-te.top,oe=t.scale.linear().domain([0,ae.scrollableAreaHeight]).range([0,ae.totalHeight]).clamp(!0);ae.topY<=ce&&ce<=ae.bottomY||P(X,G,null,oe(ce-ae.barLength/2))(K)}).call(t.behavior.drag().origin(function(K){return t.event.stopPropagation(),K.scrollbarState.scrollbarScrollInProgress=!0,K}).on("drag",P(X,G)).on("dragend",function(){})),B.attr("y2",function(K){return K.scrollbarState.scrollableAreaHeight}),X._context.staticPlot&&(ee.remove(),B.remove())}function a(G,X,ne,V){var B,N=function(ee){var B=ee.selectAll("."+g.cn.columnCell).data(p.splitToCells,function(K){return K.keyWithinBlock});return B.enter().append("g").classed(g.cn.columnCell,!0),B.exit().remove(),B}(((B=ne.selectAll("."+g.cn.columnCells).data(x.repeat,x.keyFun)).enter().append("g").classed(g.cn.columnCells,!0),B.exit().remove(),B));N.each(function(B,K){var J=B.calcdata.cells.font,te=B.column.specIndex,ae={size:_(J.size,te,K),color:_(J.color,te,K),family:_(J.family,te,K)};B.rowNumber=B.key,B.align=_(B.calcdata.cells.align,te,K),B.cellBorderWidth=_(B.calcdata.cells.line.width,te,K),B.font=ae}),function(ee){ee.attr("width",function(B){return B.column.columnWidth}).attr("stroke-width",function(B){return B.cellBorderWidth}).each(function(B){var K=t.select(this);s.stroke(K,_(B.calcdata.cells.line.color,B.column.specIndex,B.rowNumber)),s.fill(K,_(B.calcdata.cells.fill.color,B.column.specIndex,B.rowNumber))})}(function(ee){var B=ee.selectAll("."+g.cn.cellRect).data(x.repeat,function(K){return K.keyWithinBlock});return B.enter().append("rect").classed(g.cn.cellRect,!0),B}(N));var U=function(ee){var B=ee.selectAll("."+g.cn.cellText).data(x.repeat,function(K){return K.keyWithinBlock});return B.enter().append("text").classed(g.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){t.event.stopPropagation()}),B}(function(ee){var B=ee.selectAll("."+g.cn.cellTextHolder).data(x.repeat,function(K){return K.keyWithinBlock});return B.enter().append("g").classed(g.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),B}(N));(function(ee){ee.each(function(B){e.font(t.select(this),B.font)})})(U),y(U,X,V,G),D(N)}function y(G,X,ne,V){G.text(function(N){var U=N.column.specIndex,ee=N.rowNumber,B=N.value,K="string"==typeof B,J=K&&B.match(/<br>/i),te=!K||J;N.mayHaveMarkup=K&&B.match(/[<&>]/);var ae,ce="string"==typeof(ae=B)&&ae.match(g.latexCheck);N.latex=ce;var oe,ve,fe=ce?"":_(N.calcdata.cells.prefix,U,ee)||"",xe=ce?"":_(N.calcdata.cells.suffix,U,ee)||"",Se=ce?null:_(N.calcdata.cells.format,U,ee)||null,pe=fe+(Se?k(Se)(N.value):N.value)+xe;if(N.wrappingNeeded=!N.wrapped&&!te&&!ce&&(oe=h(pe)),N.cellHeightMayIncrease=J||ce||N.mayHaveMarkup||(void 0===oe?h(pe):oe),N.needsConvertToTspans=N.mayHaveMarkup||N.wrappingNeeded||N.latex,N.wrappingNeeded){var ge=(" "===g.wrapSplitCharacter?pe.replace(/<a href=/gi,"<a_href="):pe).split(g.wrapSplitCharacter),Te=" "===g.wrapSplitCharacter?ge.map(function(se){return se.replace(/<a_href=/gi,"<a href=")}):ge;N.fragments=Te.map(function(se){return{text:se,width:null}}),N.fragments.push({fragment:g.wrapSpacer,width:null}),ve=Te.join(g.lineBreaker)+g.lineBreaker+g.wrapSpacer}else delete N.fragments,ve=pe;return ve}).attr("dy",function(N){return N.needsConvertToTspans?0:"0.75em"}).each(function(N){var U=t.select(this);N.needsConvertToTspans?r.convertToTspans(U,V,(N.wrappingNeeded?S:C)(ne,this,X,V,N)):t.select(this.parentNode).attr("transform",function(B){return c(R(B),g.cellPad)}).attr("text-anchor",function(B){return{left:"start",center:"middle",right:"end"}[B.align]})})}function h(G){return-1!==G.indexOf(g.wrapSplitCharacter)}function _(G,X,ne){if(Array.isArray(G)){var V=G[Math.min(X,G.length-1)];return Array.isArray(V)?V[Math.min(ne,V.length-1)]:V}return G}function b(G,X,ne){G.transition().ease(g.releaseTransitionEase).duration(g.releaseTransitionDuration).attr("transform",c(X.x,ne))}function w(G){return"cells"===G.type}function T(G){return"header"===G.type}function L(G){return(G.rowBlocks.length?G.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(X,ne){return X+q(ne,1/0)},0)}function M(G,X,ne){var V=d(X)[0];if(void 0!==V){var N=V.rowBlocks,U=V.calcdata,ee=j(N,N.length),B=V.calcdata.groupHeight-L(V),K=U.scrollY=Math.max(0,Math.min(ee-B,U.scrollY)),J=function(te,ae,ce){for(var oe=[],ve=0,fe=0;fe<te.length;fe++){for(var xe=te[fe],Se=xe.rows,pe=0,ge=0;ge<Se.length;ge++)pe+=Se[ge].rowHeight;xe.allRowsHeight=pe,ae<ve+pe&&ae+ce>ve&&oe.push(fe),ve+=pe}return oe}(N,K,B);1===J.length&&(J[0]===N.length-1?J.unshift(J[0]-1):J.push(J[0]+1)),J[0]%2&&J.reverse(),X.each(function(te,ae){te.page=J[ae],te.scrollY=K}),X.attr("transform",function(te){var ae=j(te.rowBlocks,te.page)-te.scrollY;return c(0,ae)}),G&&(z(G,ne,X,J,V.prevPages,V,0),z(G,ne,X,J,V.prevPages,V,1),u(ne,G))}}function P(G,X,ne,V){return function(N){var U=N.calcdata?N.calcdata:N,ee=X.filter(function(te){return U.key===te.key}),K=U.scrollY;U.scrollY=void 0===V?U.scrollY+(ne||U.scrollbarState.dragMultiplier)*t.event.dy:V;var J=ee.selectAll("."+g.cn.yColumn).selectAll("."+g.cn.columnBlock).filter(w);return M(G,J,ee),U.scrollY===K}}function z(G,X,ne,V,N,U,ee){V[ee]!==N[ee]&&(clearTimeout(U.currentRepaint[ee]),U.currentRepaint[ee]=setTimeout(function(){var B=ne.filter(function(K,J){return J===ee&&V[J]!==N[J]});a(G,X,B,ne),N[ee]=V[ee]}))}function S(G,X,ne,V){return function(){var N=t.select(X.parentNode);N.each(function(U){var ee=U.fragments;N.selectAll("tspan.line").each(function(ve,fe){ee[fe].width=this.getComputedTextLength()});var B,K,J=ee[ee.length-1].width,te=ee.slice(0,-1),ae=[],ce=0,oe=U.column.columnWidth-2*g.cellPad;for(U.value="";te.length;)ce+(K=(B=te.shift()).width+J)>oe&&(U.value+=ae.join(g.wrapSpacer)+g.lineBreaker,ae=[],ce=0),ae.push(B.text),ce+=K;ce&&(U.value+=ae.join(g.wrapSpacer)),U.wrapped=!0}),N.selectAll("tspan.line").remove(),y(N.select("."+g.cn.cellText),ne,G,V),t.select(X.parentNode.parentNode).call(D)}}function C(G,X,ne,V,N){return function(){if(!N.settledY){var U=t.select(X.parentNode),ee=W(N),B=N.key-ee.firstRowIndex,K=ee.rows[B].rowHeight,J=N.cellHeightMayIncrease?X.parentNode.getBoundingClientRect().height+2*g.cellPad:K,te=Math.max(J,K);te-ee.rows[B].rowHeight&&(ee.rows[B].rowHeight=te,G.selectAll("."+g.cn.columnCell).call(D),M(null,G.filter(w),0),u(ne,V,!0)),U.attr("transform",function(){var ae=this.parentNode.getBoundingClientRect(),ce=t.select(this.parentNode).select("."+g.cn.cellRect).node().getBoundingClientRect(),oe=this.transform.baseVal.consolidate(),ve=ce.top-ae.top+(oe?oe.matrix.f:g.cellPad);return c(R(N,t.select(this.parentNode).select("."+g.cn.cellTextHolder).node().getBoundingClientRect().width),ve)}),N.settledY=!0}}}function R(G,X){switch(G.align){case"left":default:return g.cellPad;case"right":return G.column.columnWidth-(X||0)-g.cellPad;case"center":return(G.column.columnWidth-(X||0))/2}}function D(G){G.attr("transform",function(X){var ne=X.rowBlocks[0].auxiliaryBlocks.reduce(function(N,U){return N+q(U,1/0)},0),V=q(W(X),X.key);return c(0,V+ne)}).selectAll("."+g.cn.cellRect).attr("height",function(X){return(ne=W(X),V=X.key,ne.rows[V-ne.firstRowIndex]).rowHeight;var ne,V})}function j(G,X){for(var ne=0,V=X-1;V>=0;V--)ne+=Z(G[V]);return ne}function q(G,X){for(var ne=0,V=0;V<G.rows.length&&G.rows[V].rowIndex<X;V++)ne+=G.rows[V].rowHeight;return ne}function Z(G){var X=G.allRowsHeight;if(void 0!==X)return X;for(var ne=0,V=0;V<G.rows.length;V++)ne+=G.rows[V].rowHeight;return G.allRowsHeight=ne,ne}function W(G){return G.rowBlocks[G.page]}Q.exports=function(G,X){var ne=!G._context.staticPlot,V=G._fullLayout._paper.selectAll("."+g.cn.table).data(X.map(function(xe){var Se=x.unwrap(xe).trace;return m(G,Se)}),x.keyFun);V.exit().remove(),V.enter().append("g").classed(g.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),V.attr("width",function(xe){return xe.width+xe.size.l+xe.size.r}).attr("height",function(xe){return xe.height+xe.size.t+xe.size.b}).attr("transform",function(xe){return c(xe.translateX,xe.translateY)});var N=V.selectAll("."+g.cn.tableControlView).data(x.repeat,x.keyFun),U=N.enter().append("g").classed(g.cn.tableControlView,!0).style("box-sizing","content-box");if(ne){var ee="onwheel"in document?"wheel":"mousewheel";U.on("mousemove",function(xe){N.filter(function(Se){return xe===Se}).call(u,G)}).on(ee,function(xe){xe.scrollbarState.wheeling||(xe.scrollbarState.wheeling=!0,P(G,N,null,xe.scrollY+t.event.deltaY)(xe)||(t.event.stopPropagation(),t.event.preventDefault()),xe.scrollbarState.wheeling=!1)}).call(u,G,!0)}N.attr("transform",function(xe){return c(xe.size.l,xe.size.t)});var B=N.selectAll("."+g.cn.scrollBackground).data(x.repeat,x.keyFun);B.enter().append("rect").classed(g.cn.scrollBackground,!0).attr("fill","none"),B.attr("width",function(xe){return xe.width}).attr("height",function(xe){return xe.height}),N.each(function(xe){e.setClipUrl(t.select(this),l(G,xe),G)});var K=N.selectAll("."+g.cn.yColumn).data(function(xe){return xe.columns},x.keyFun);K.enter().append("g").classed(g.cn.yColumn,!0),K.exit().remove(),K.attr("transform",function(xe){return c(xe.x,0)}),ne&&K.call(t.behavior.drag().origin(function(xe){return b(t.select(this),xe,-g.uplift),i(this),xe.calcdata.columnDragInProgress=!0,u(N.filter(function(Se){return xe.calcdata.key===Se.key}),G),xe}).on("drag",function(xe){var Se=t.select(this),pe=function(ge){return(xe===ge?t.event.x:ge.x)+ge.columnWidth/2};xe.x=Math.max(-g.overdrag,Math.min(xe.calcdata.width+g.overdrag-xe.columnWidth,t.event.x)),d(K).filter(function(ge){return ge.calcdata.key===xe.calcdata.key}).sort(function(ge,Te){return pe(ge)-pe(Te)}).forEach(function(ge,Te){ge.xIndex=Te,ge.x=xe===ge?ge.x:ge.xScale(ge)}),K.filter(function(ge){return xe!==ge}).transition().ease(g.transitionEase).duration(g.transitionDuration).attr("transform",function(ge){return c(ge.x,0)}),Se.call(n).attr("transform",c(xe.x,-g.uplift))}).on("dragend",function(xe){var ge,Te,se,de,Se=t.select(this),pe=xe.calcdata;xe.x=xe.xScale(xe),xe.calcdata.columnDragInProgress=!1,b(Se,xe,0),ge=G,Te=pe,se=pe.columns.map(function(ge){return ge.xIndex}),de=Te.gdColumnsOriginalOrder,Te.gdColumns.sort(function(Ae,Le){return se[de.indexOf(Ae)]-se[de.indexOf(Le)]}),Te.columnorder=se,ge.emit("plotly_restyle")})),K.each(function(xe){e.setClipUrl(t.select(this),o(G,xe),G)});var J=K.selectAll("."+g.cn.columnBlock).data(p.splitToPanels,x.keyFun);J.enter().append("g").classed(g.cn.columnBlock,!0).attr("id",function(xe){return xe.key}),J.style("cursor",function(xe){return xe.dragHandle?"ew-resize":xe.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var te=J.filter(T),ae=J.filter(w);ne&&ae.call(t.behavior.drag().origin(function(xe){return t.event.stopPropagation(),xe}).on("drag",P(G,N,-1)).on("dragend",function(){})),a(G,N,te,J),a(G,N,ae,J);var ce=N.selectAll("."+g.cn.scrollAreaClip).data(x.repeat,x.keyFun);ce.enter().append("clipPath").classed(g.cn.scrollAreaClip,!0).attr("id",function(xe){return l(G,xe)});var oe=ce.selectAll("."+g.cn.scrollAreaClipRect).data(x.repeat,x.keyFun);oe.enter().append("rect").classed(g.cn.scrollAreaClipRect,!0).attr("x",-g.overdrag).attr("y",-g.uplift).attr("fill","none"),oe.attr("width",function(xe){return xe.width+2*g.overdrag}).attr("height",function(xe){return xe.height+g.uplift}),K.selectAll("."+g.cn.columnBoundary).data(x.repeat,x.keyFun).enter().append("g").classed(g.cn.columnBoundary,!0);var ve=K.selectAll("."+g.cn.columnBoundaryClippath).data(x.repeat,x.keyFun);ve.enter().append("clipPath").classed(g.cn.columnBoundaryClippath,!0),ve.attr("id",function(xe){return o(G,xe)});var fe=ve.selectAll("."+g.cn.columnBoundaryRect).data(x.repeat,x.keyFun);fe.enter().append("rect").classed(g.cn.columnBoundaryRect,!0).attr("fill","none"),fe.attr("width",function(xe){return xe.columnWidth+2*f(xe)}).attr("height",function(xe){return xe.calcdata.height+2*f(xe)+g.uplift}).attr("x",function(xe){return-f(xe)}).attr("y",function(xe){return-f(xe)}),M(null,ae,N)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(v,Q,$){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../components/colorscale/attributes"),x=v("../../plots/domain").attributes,e=v("../pie/attributes"),r=v("../sunburst/attributes"),i=v("./constants"),c=v("../../lib/extend").extendFlat;Q.exports={labels:r.labels,parents:r.parents,values:r.values,branchvalues:r.branchvalues,count:r.count,level:r.level,maxdepth:r.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:c({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:r.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:r.marker.line,editType:"calc"},k("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:c({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:r.textinfo,texttemplate:t({editType:"plot"},{keys:i.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:r.hoverinfo,hovertemplate:g({},{keys:i.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:c({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:r.root,domain:x({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(v,Q,$){"use strict";var g=v("../../plots/plots");$.name="treemap",$.plot=function(t,k,x,e){g.plotBasePlot($.name,t,k,x,e)},$.clean=function(t,k,x,e){g.cleanBasePlot($.name,t,k,x,e)}},{"../../plots/plots":628}],1086:[function(v,Q,$){"use strict";var g=v("../sunburst/calc");$.calc=function(t,k){return g.calc(t,k)},$.crossTraceCalc=function(t){return g._runCrossTraceCalc("treemap",t)}},{"../sunburst/calc":1060}],1087:[function(v,Q,$){"use strict";Q.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../../components/color"),x=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText,r=v("../bar/constants").TEXTPAD,i=v("../../components/colorscale"),c=i.hasColorscale,n=i.handleDefaults;Q.exports=function(m,p,s,f){function l(w,T){return g.coerce(m,p,t,w,T)}var o=l("labels"),d=l("parents");if(o&&o.length&&d&&d.length){var u=l("values");l(u&&u.length?"branchvalues":"count"),l("level"),l("maxdepth"),"squarify"===l("tiling.packing")&&l("tiling.squarifyratio"),l("tiling.flip"),l("tiling.pad");var a=l("text");l("texttemplate"),p.texttemplate||l("textinfo",Array.isArray(a)?"text+label":"label"),l("hovertext"),l("hovertemplate");var y=l("pathbar.visible");e(m,p,f,l,"auto",{hasPathbar:y,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),l("textposition");var h=-1!==p.textposition.indexOf("bottom");l("marker.line.width")&&l("marker.line.color",f.paper_bgcolor);var _=l("marker.colors");(p._hasColorscale=c(m,"marker","colors")||(m.marker||{}).coloraxis)?n(m,p,f,l,{prefix:"marker.",cLetter:"c"}):l("marker.depthfade",!(_||[]).length);var b=2*p.textfont.size;l("marker.pad.t",h?b/4:b),l("marker.pad.l",b/4),l("marker.pad.r",b/4),l("marker.pad.b",h?b:b/4),p._hovered={marker:{line:{width:2,color:k.contrast(f.paper_bgcolor)}}},y&&(l("pathbar.thickness",p.pathbar.textfont.size+2*r),l("pathbar.side"),l("pathbar.edgeshape")),l("sort"),l("root.color"),x(p,f,l),p._length=null}else p.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../sunburst/helpers"),k=v("../bar/uniform_text").clearMinTextSize,x=v("../bar/style").resizeText,e=v("./plot_one");Q.exports=function(r,i,c,n,m){var p,s,f=m.type,l=m.drawDescendants,o=r._fullLayout,d=o["_"+f+"layer"],u=!c;k(f,o),(p=d.selectAll("g.trace."+f).data(i,function(a){return a[0].trace.uid})).enter().append("g").classed("trace",!0).classed(f,!0),p.order(),!o.uniformtext.mode&&t.hasTransition(c)?(n&&(s=n()),g.transition().duration(c.duration).ease(c.easing).each("end",function(){s&&s()}).each("interrupt",function(){s&&s()}).each(function(){d.selectAll("g.trace").each(function(a){e(r,a,this,c,l)})})):(p.each(function(a){e(r,a,this,c,l)}),o.uniformtext.mode&&x(r,d.selectAll(".trace"),f)),u&&p.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../../lib/svg_text_utils"),e=v("./partition"),r=v("./style").styleOne,i=v("./constants"),c=v("../sunburst/helpers"),n=v("../sunburst/fx");Q.exports=function(m,p,s,f,l){var o=l.barDifY,d=l.width,u=l.height,a=l.viewX,y=l.viewY,h=l.pathSlice,_=l.toMoveInsideSlice,b=l.strTransform,w=l.hasTransition,T=l.handleSlicesExit,L=l.makeUpdateSliceInterpolator,M=l.makeUpdateTextInterpolator,P={},z=m._context.staticPlot,S=m._fullLayout,C=p[0],R=C.trace,D=C.hierarchy,j=d/R._entryDepth,q=c.listPath(s.data,"id"),Z=e(D.copy(),[d,u],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(Z=Z.filter(function(G){var X=q.indexOf(G.data.id);return-1!==X&&(G.x0=j*X,G.x1=j*(X+1),G.y0=o,G.y1=o+u,G.onPathbar=!0,!0)})).reverse(),(f=f.data(Z,c.getPtId)).enter().append("g").classed("pathbar",!0),T(f,!0,P,[d,u],h),f.order();var W=f;w&&(W=W.transition().each("end",function(){var G=g.select(this);c.setSliceCursor(G,m,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),W.each(function(G){G._x0=a(G.x0),G._x1=a(G.x1),G._y0=y(G.y0),G._y1=y(G.y1),G._hoverX=a(G.x1-Math.min(d,u)/2),G._hoverY=y(G.y1-u/2);var X=g.select(this),ne=t.ensureSingle(X,"path","surface",function(ee){ee.style("pointer-events",z?"none":"all")});w?ne.transition().attrTween("d",function(ee){var B=L(ee,!0,P,[d,u]);return function(K){return h(B(K))}}):ne.attr("d",h),X.call(n,s,m,p,{styleOne:r,eventDataKeys:i.eventDataKeys,transitionTime:i.CLICK_TRANSITION_TIME,transitionEasing:i.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,m,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:m._transitioning}),ne.call(r,G,R,{hovered:!1}),G._text=(c.getPtLabel(G)||"").split("<br>").join(" ")||"";var V=t.ensureSingle(X,"g","slicetext"),N=t.ensureSingle(V,"text","",function(ee){ee.attr("data-notex",1)}),U=t.ensureUniformFontSize(m,c.determineTextFont(R,G,S.font,{onPathbar:!0}));N.text(G._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(k.font,U).call(x.convertToTspans,m),G.textBB=k.bBox(N.node()),G.transform=_(G,{fontSize:U.size,onPathbar:!0}),G.transform.fontSize=U.size,w?N.transition().attrTween("transform",function(ee){var B=M(ee,!0,P,[d,u]);return function(K){return b(B(K))}}):N.attr("transform",b(G))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../../lib/svg_text_utils"),e=v("./partition"),r=v("./style").styleOne,i=v("./constants"),c=v("../sunburst/helpers"),n=v("../sunburst/fx"),m=v("../sunburst/plot").formatSliceLabel;Q.exports=function(p,s,f,l,o){var d=o.width,u=o.height,a=o.viewX,y=o.viewY,h=o.pathSlice,_=o.toMoveInsideSlice,b=o.strTransform,w=o.hasTransition,T=o.handleSlicesExit,L=o.makeUpdateSliceInterpolator,M=o.makeUpdateTextInterpolator,P=o.prevEntry,z=p._context.staticPlot,S=p._fullLayout,C=s[0].trace,R=-1!==C.textposition.indexOf("left"),D=-1!==C.textposition.indexOf("right"),j=-1!==C.textposition.indexOf("bottom"),q=!j&&!C.marker.pad.t||j&&!C.marker.pad.b,Z=e(f,[d,u],{packing:C.tiling.packing,squarifyratio:C.tiling.squarifyratio,flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1,pad:{inner:C.tiling.pad,top:C.marker.pad.t,left:C.marker.pad.l,right:C.marker.pad.r,bottom:C.marker.pad.b}}).descendants(),W=1/0,G=-1/0;Z.forEach(function(U){var ee=U.depth;ee>=C._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(W=Math.min(W,ee),G=Math.max(G,ee))}),l=l.data(Z,c.getPtId),C._maxVisibleLayers=isFinite(G)?G-W+1:0,l.enter().append("g").classed("slice",!0),T(l,!1,{},[d,u],h),l.order();var X=null;if(w&&P){var ne=c.getPtId(P);l.each(function(U){null===X&&c.getPtId(U)===ne&&(X={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var V=function(){return X||{x0:0,x1:d,y0:0,y1:u}},N=l;return w&&(N=N.transition().each("end",function(){var U=g.select(this);c.setSliceCursor(U,p,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(U){var ee=c.isHeader(U,C);U._x0=a(U.x0),U._x1=a(U.x1),U._y0=y(U.y0),U._y1=y(U.y1),U._hoverX=a(U.x1-C.marker.pad.r),U._hoverY=y(j?U.y1-C.marker.pad.b/2:U.y0+C.marker.pad.t/2);var B=g.select(this),K=t.ensureSingle(B,"path","surface",function(ce){ce.style("pointer-events",z?"none":"all")});w?K.transition().attrTween("d",function(ce){var oe=L(ce,!1,V(),[d,u]);return function(ve){return h(oe(ve))}}):K.attr("d",h),B.call(n,f,p,s,{styleOne:r,eventDataKeys:i.eventDataKeys,transitionTime:i.CLICK_TRANSITION_TIME,transitionEasing:i.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,p,{isTransitioning:p._transitioning}),K.call(r,U,C,{hovered:!1}),U._text=U.x0===U.x1||U.y0===U.y1?"":ee?q?"":c.getPtLabel(U)||"":m(U,f,C,s,S)||"";var J=t.ensureSingle(B,"g","slicetext"),te=t.ensureSingle(J,"text","",function(ce){ce.attr("data-notex",1)}),ae=t.ensureUniformFontSize(p,c.determineTextFont(C,U,S.font));te.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":R||ee?"start":"middle").call(k.font,ae).call(x.convertToTspans,p),U.textBB=k.bBox(te.node()),U.transform=_(U,{fontSize:ae.size,isHeader:ee}),U.transform.fontSize=ae.size,w?te.transition().attrTween("transform",function(ce){var oe=M(ce,!1,V(),[d,u]);return function(ve){return b(oe(ve))}}):te.attr("transform",b(U))}),X}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(v,Q,$){"use strict";Q.exports=function g(t,k,x){var e;x.swapXY&&(e=t.x0,t.x0=t.y0,t.y0=e,e=t.x1,t.x1=t.y1,t.y1=e),x.flipX&&(e=t.x0,t.x0=k[0]-t.x1,t.x1=k[0]-e),x.flipY&&(e=t.y0,t.y0=k[1]-t.y1,t.y1=k[1]-e);var r=t.children;if(r)for(var i=0;i<r.length;i++)g(r[i],k,x)}},{}],1093:[function(v,Q,$){"use strict";Q.exports={moduleType:"trace",name:"treemap",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(v,Q,$){"use strict";Q.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x){function e(r,i){return g.coerce(k,x,t,r,i)}e("treemapcolorway",x.colorway),e("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(v,Q,$){"use strict";var g=v("d3-hierarchy"),t=v("./flip_tree");Q.exports=function(k,x,e){var r,i=e.flipX,c=e.flipY,n="dice-slice"===e.packing,m=e.pad[c?"bottom":"top"],p=e.pad[i?"right":"left"],s=e.pad[i?"left":"right"],f=e.pad[c?"top":"bottom"];n&&(r=p,p=m,m=r,r=s,s=f,f=r);var l=g.treemap().tile(function(o,d){switch(o){case"squarify":return g.treemapSquarify.ratio(d);case"binary":return g.treemapBinary;case"dice":return g.treemapDice;case"slice":return g.treemapSlice;default:return g.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(p).paddingRight(s).paddingTop(m).paddingBottom(f).size(n?[x[1],x[0]]:x)(k);return(n||i||c)&&t(l,x,{swapXY:n,flipX:i,flipY:c}),l}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(v,Q,$){"use strict";var g=v("./draw"),t=v("./draw_descendants");Q.exports=function(k,x,e,r){return g(k,x,e,r,{type:"treemap",drawDescendants:t})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("d3-interpolate").interpolate,k=v("../sunburst/helpers"),x=v("../../lib"),e=v("../bar/constants").TEXTPAD,r=v("../bar/plot").toMoveInsideBar,i=v("../bar/uniform_text").recordMinTextSize,c=v("./constants"),n=v("./draw_ancestors");function m(p){return k.isHierarchyRoot(p)?"":k.getPtId(p)}Q.exports=function(p,s,f,l,o){var d=p._fullLayout,u=s[0],a=u.trace,y="icicle"===a.type,h=u.hierarchy,_=k.findEntryWithLevel(h,a.level),b=g.select(f),w=b.selectAll("g.pathbar"),T=b.selectAll("g.slice");if(!_)return w.remove(),void T.remove();var L=k.isHierarchyRoot(_),M=!d.uniformtext.mode&&k.hasTransition(l),P=k.getMaxDepth(a),z=d._size,S=a.domain,C=z.w*(S.x[1]-S.x[0]),R=z.h*(S.y[1]-S.y[0]),D=C,j=a.pathbar.thickness,q=a.marker.line.width+c.gapWithPathbar,Z=a.pathbar.visible?a.pathbar.side.indexOf("bottom")>-1?R+q:-(j+q):0,W={x0:D,x1:D,y0:Z,y1:Z+j},G=function(Me,De,Oe){var Ie=a.tiling.pad,Qe=function(Ge){return Ge-Ie<=De.x0},Ne=function(Ge){return Ge+Ie>=De.x1},Pe=function(Ge){return Ge-Ie<=De.y0},Re=function(Ge){return Ge+Ie>=De.y1};return Me.x0===De.x0&&Me.x1===De.x1&&Me.y0===De.y0&&Me.y1===De.y1?{x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1}:{x0:Qe(Me.x0-Ie)?0:Ne(Me.x0-Ie)?Oe[0]:Me.x0,x1:Qe(Me.x1+Ie)?0:Ne(Me.x1+Ie)?Oe[0]:Me.x1,y0:Pe(Me.y0-Ie)?0:Re(Me.y0-Ie)?Oe[1]:Me.y0,y1:Pe(Me.y1+Ie)?0:Re(Me.y1+Ie)?Oe[1]:Me.y1}},X=null,ne={},V={},N=null,U=function(Me,De){return De?ne[m(Me)]:V[m(Me)]};u.hasMultipleRoots&&L&&P++,a._maxDepth=P,a._backgroundColor=d.paper_bgcolor,a._entryDepth=_.data.depth,a._atRootLevel=L;var B=-C/2+z.l+z.w*(S.x[1]+S.x[0])/2,K=-R/2+z.t+z.h*(1-(S.y[1]+S.y[0])/2),J=function(Me){return B+Me},te=function(Me){return K+Me},ae=te(0),ce=J(0),oe=function(Me){return ce+Me},ve=function(Me){return ae+Me};function fe(Me,De){return Me+","+De}var xe=oe(0),Se=function(Me){Me.x=Math.max(xe,Me.x)},pe=a.pathbar.edgeshape,ge=function(Me,De){var Oe=Me.x0,Ie=Me.x1,Qe=Me.y0,Ne=Me.y1,Pe=Me.textBB,Re=function(yt){return-1!==a.textposition.indexOf(yt)},Ge=Re("bottom"),tt=Re("top")||De.isHeader&&!Ge?"start":Ge?"end":"middle",ct=Re("right"),wt=Re("left")||De.onPathbar?-1:ct?1:0,kt=a[y?"tiling":"marker"].pad;if(De.isHeader){if((Oe+=(y?kt:kt.l)-e)>=(Ie-=(y?kt:kt.r)-e)){var gt=(Oe+Ie)/2;Oe=gt,Ie=gt}var at;Ge?Qe<(at=Ne-(y?kt:kt.b))&&at<Ne&&(Qe=at):Qe<(at=Qe+(y?kt:kt.t))&&at<Ne&&(Ne=at)}var et=r(Oe,Ie,Qe,Ne,Pe,{isHorizontal:!1,constrained:!0,angle:0,anchor:tt,leftToRight:wt});return et.fontSize=De.fontSize,et.targetX=J(et.targetX),et.targetY=te(et.targetY),isNaN(et.targetX)||isNaN(et.targetY)?{}:(Oe!==Ie&&Qe!==Ne&&i(a.type,et,d),{scale:et.scale,rotate:et.rotate,textX:et.textX,textY:et.textY,anchorX:et.anchorX,anchorY:et.anchorY,targetX:et.targetX,targetY:et.targetY})},Te=function(Me,De){for(var Oe,Ie=0,Qe=Me;!Oe&&Ie<P;)Ie++,(Qe=Qe.parent)?Oe=U(Qe,De):Ie=P;return Oe||{}},se=function(Me,De,Oe,Ie,Qe){var Ne,Pe=U(Me,De);if(Pe)Ne=Pe;else if(De)Ne=W;else if(X)if(Me.parent){var Re=N||Oe;Re&&!De?Ne=G(Me,Re,Ie):x.extendFlat(Ne={},Te(Me,De))}else Ne=x.extendFlat({},Me),y&&("h"===Qe.orientation?Qe.flipX?Ne.x0=Me.x1:Ne.x1=0:Qe.flipY?Ne.y0=Me.y1:Ne.y1=0);else Ne={};return t(Ne,{x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1})},de=function(Me,De,Oe,Ie){var Qe=U(Me,De),Ne={},Pe=function(Me,De,Oe,Ie){return De?ne[m(h)]||W:Me.data.depth-_.data.depth<P?G(Me,V[a.level]||Oe,Ie):{}}(Me,De,Oe,Ie);x.extendFlat(Ne,{transform:ge({x0:Pe.x0,x1:Pe.x1,y0:Pe.y0,y1:Pe.y1,textBB:Me.textBB,_text:Me._text},{isHeader:k.isHeader(Me,a)})}),Qe?Ne=Qe:Me.parent&&x.extendFlat(Ne,Te(Me,De));var Re=Me.transform;return Me.x0!==Me.x1&&Me.y0!==Me.y1&&i(a.type,Re,d),t(Ne,{transform:{scale:Re.scale,rotate:Re.rotate,textX:Re.textX,textY:Re.textY,anchorX:Re.anchorX,anchorY:Re.anchorY,targetX:Re.targetX,targetY:Re.targetY}})},Ae=function(Me,De,Oe,Ie,Qe){var Ne=Ie[0],Pe=Ie[1];M?Me.exit().transition().each(function(){var Re=g.select(this);Re.select("path.surface").transition().attrTween("d",function(Ge){var tt=function(ct,wt,kt,gt){var at,et=U(ct,wt);if(wt)at=W;else{var yt=U(_,wt);at=yt?G(ct,yt,gt):{}}return t(et,at)}(Ge,De,0,[Ne,Pe]);return function(ct){return Qe(tt(ct))}}),Re.select("g.slicetext").attr("opacity",0)}).remove():Me.exit().remove()},Le=function(Me){var De=Me.transform;return Me.x0!==Me.x1&&Me.y0!==Me.y1&&i(a.type,De,d),x.getTextTransform({textX:De.textX,textY:De.textY,anchorX:De.anchorX,anchorY:De.anchorY,targetX:De.targetX,targetY:De.targetY,scale:De.scale,rotate:De.rotate})};M&&(w.each(function(Me){ne[m(Me)]={x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1},Me.transform&&(ne[m(Me)].transform={textX:Me.transform.textX,textY:Me.transform.textY,anchorX:Me.transform.anchorX,anchorY:Me.transform.anchorY,targetX:Me.transform.targetX,targetY:Me.transform.targetY,scale:Me.transform.scale,rotate:Me.transform.rotate})}),T.each(function(Me){V[m(Me)]={x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1},Me.transform&&(V[m(Me)].transform={textX:Me.transform.textX,textY:Me.transform.textY,anchorX:Me.transform.anchorX,anchorY:Me.transform.anchorY,targetX:Me.transform.targetX,targetY:Me.transform.targetY,scale:Me.transform.scale,rotate:Me.transform.rotate}),!X&&k.isEntry(Me)&&(X=Me)})),N=o(p,s,_,T,{width:C,height:R,viewX:J,viewY:te,pathSlice:function(Me){var De=J(Me.x0),Oe=J(Me.x1),Ie=te(Me.y0),Qe=te(Me.y1);return Oe-De&&Qe-Ie?"M"+fe(De,Ie+0)+"L"+fe(Oe-0,Ie)+"L"+fe(Oe,Qe-0)+"L"+fe(De+0,Qe)+"Z":""},toMoveInsideSlice:ge,prevEntry:X,makeUpdateSliceInterpolator:se,makeUpdateTextInterpolator:de,handleSlicesExit:Ae,hasTransition:M,strTransform:Le}),a.pathbar.visible?n(p,s,_,w,{barDifY:Z,width:D,height:j,viewX:oe,viewY:ve,pathSlice:function(Me){var De=oe(Math.max(Math.min(Me.x0,Me.x0),0)),Oe=oe(Math.min(Math.max(Me.x1,Me.x1),D)),Ie=ve(Me.y0),Qe=ve(Me.y1),Ne=j/2,Pe={},Re={};Pe.x=De,Re.x=Oe,Pe.y=Re.y=(Ie+Qe)/2;var Ge={x:De,y:Ie},tt={x:Oe,y:Ie},ct={x:Oe,y:Qe},wt={x:De,y:Qe};return">"===pe?(Ge.x-=Ne,tt.x-=Ne,ct.x-=Ne,wt.x-=Ne):"/"===pe?(ct.x-=Ne,wt.x-=Ne,Pe.x-=Ne/2,Re.x-=Ne/2):"\\"===pe?(Ge.x-=Ne,tt.x-=Ne,Pe.x-=Ne/2,Re.x-=Ne/2):"<"===pe&&(Pe.x-=Ne,Re.x-=Ne),Se(Ge),Se(wt),Se(Pe),Se(tt),Se(ct),Se(Re),"M"+fe(Ge.x,Ge.y)+"L"+fe(tt.x,tt.y)+"L"+fe(Re.x,Re.y)+"L"+fe(ct.x,ct.y)+"L"+fe(wt.x,wt.y)+"L"+fe(Pe.x,Pe.y)+"Z"},toMoveInsideSlice:ge,makeUpdateSliceInterpolator:se,makeUpdateTextInterpolator:de,handleSlicesExit:Ae,hasTransition:M,strTransform:Le}):w.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../../lib"),x=v("../sunburst/helpers"),e=v("../bar/uniform_text").resizeText;function r(i,c,n,m){var p,s,f=(m||{}).hovered,l=c.data.data,o=l.i,d=l.color,u=x.isHierarchyRoot(c),a=1;if(f)p=n._hovered.marker.line.color,s=n._hovered.marker.line.width;else if(u&&d===n.root.color)a=100,p="rgba(0,0,0,0)",s=0;else if(p=k.castOption(n,o,"marker.line.color")||t.defaultLine,s=k.castOption(n,o,"marker.line.width")||0,!n._hasColorscale&&!c.onPathbar){var y=n.marker.depthfade;if(y){var h,_=t.combine(t.addOpacity(n._backgroundColor,.75),d);if(!0===y){var b=x.getMaxDepth(n);h=isFinite(b)?x.isLeaf(c)?0:n._maxVisibleLayers-(c.data.depth-n._entryDepth):c.data.height+1}else h=c.data.depth-n._entryDepth,n._atRootLevel||h++;if(h>0)for(var w=0;w<h;w++)d=t.combine(t.addOpacity(_,.5*w/h),d)}}i.style("stroke-width",s).call(t.fill,d).call(t.stroke,p).style("opacity",a)}Q.exports={style:function(i){var c=i._fullLayout._treemaplayer.selectAll(".trace");e(i,c,"treemap"),c.each(function(n){var m=g.select(this),p=n[0].trace;m.style("opacity",p.opacity),m.selectAll("path.surface").each(function(s){g.select(this).call(r,s,p,{hovered:!1})})})},styleOne:r}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(v,Q,$){"use strict";var g=v("../box/attributes"),t=v("../../lib/extend").extendFlat,k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat;Q.exports={y:g.y,x:g.x,x0:g.x0,y0:g.y0,xhoverformat:k("x"),yhoverformat:k("y"),name:t({},g.name,{}),orientation:t({},g.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:g.fillcolor,points:t({},g.boxpoints,{}),jitter:t({},g.jitter,{}),pointpos:t({},g.pointpos,{}),width:t({},g.width,{}),marker:g.marker,text:g.text,hovertext:g.hovertext,hovertemplate:g.hovertemplate,quartilemethod:g.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:g.selected,unselected:g.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../plots/cartesian/axes"),k=v("../box/calc"),x=v("./helpers"),e=v("../../constants/numerical").BADNUM;function r(c,n,m){var p=n.max-n.min;if(!p)return c.bandwidth?c.bandwidth:0;if(c.bandwidth)return Math.max(c.bandwidth,p/1e4);var l,s=m.length,f=g.stdev(m,s-1,n.mean);return Math.max((l=s,1.059*Math.min(f,(n.q3-n.q1)/1.349)*Math.pow(l,-.2)),p/100)}function i(c,n,m,p){var s,f=c.spanmode,l=c.span||[],d=[n.min-2*p,n.max+2*p];function u(y){var h=l[y],_="multicategory"===m.type?m.r2c(h):m.d2c(h,0,c[n.valLetter+"calendar"]);return _===e?d[y]:_}var a={type:"linear",range:s="soft"===f?d:"hard"===f?[n.min,n.max]:[u(0),u(1)]};return t.setConvert(a),a.cleanRange(),s}Q.exports=function(c,n){var m=k(c,n);if(m[0].t.empty)return m;for(var p=c._fullLayout,s=t.getFromId(c,n["h"===n.orientation?"xaxis":"yaxis"]),f=1/0,l=-1/0,o=0,d=0,u=0;u<m.length;u++){var a=m[u],y=a.pts.map(x.extractVal),h=a.bandwidth=r(n,a,y),_=a.span=i(n,a,s,h);if(a.min===a.max&&0===h)_=a.span=[a.min,a.max],a.density=[{v:1,t:_[0]}],a.bandwidth=h,o=Math.max(o,1);else{var b=_[1]-_[0],w=Math.ceil(b/(h/3)),T=b/w;if(!isFinite(T)||!isFinite(w))return g.error("Something went wrong with computing the violin span"),m[0].t.empty=!0,m;var L=x.makeKDE(a,n,y);a.density=new Array(w);for(var M=0,P=_[0];P<_[1]+T/2;M++,P+=T){var z=L(P);a.density[M]={v:z,t:P},o=Math.max(o,z)}}d=Math.max(d,y.length),f=Math.min(f,_[0]),l=Math.max(l,_[1])}var S=t.findExtremes(s,[f,l],{padded:!0});if(n._extremes[s._id]=S,n.width)m[0].t.maxKDE=o;else{var C=p._violinScaleGroupStats,R=n.scalegroup,D=C[R];D?(D.maxKDE=Math.max(D.maxKDE,o),D.maxCount=Math.max(D.maxCount,d)):C[R]={maxKDE:o,maxCount:d}}return m[0].t.labels.kde=g._(c,"kde:"),m}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(v,Q,$){"use strict";var g=v("../box/cross_trace_calc").setPositionOffset,t=["v","h"];Q.exports=function(k,x){for(var e=k.calcdata,r=x.xaxis,i=x.yaxis,c=0;c<t.length;c++){for(var n=t[c],m="h"===n?i:r,p=[],s=0;s<e.length;s++){var f=e[s],o=f[0].trace;!0!==o.visible||"violin"!==o.type||f[0].t.empty||o.orientation!==n||o.xaxis!==r._id||o.yaxis!==i._id||p.push(s)}g("violin",k,p,m)}}},{"../box/cross_trace_calc":684}],1103:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../../components/color"),k=v("../box/defaults"),x=v("./attributes");Q.exports=function(e,r,i,c){function n(b,w){return g.coerce(e,r,x,b,w)}function m(b,w){return g.coerce2(e,r,x,b,w)}if(k.handleSampleDefaults(e,r,n,c),!1!==r.visible){n("bandwidth"),n("side"),n("width")||(n("scalegroup",r.name),n("scalemode"));var p,s=n("span");Array.isArray(s)&&(p="manual"),n("spanmode",p);var f=n("line.color",(e.marker||{}).color||i),l=n("line.width"),o=n("fillcolor",t.addOpacity(r.line.color,.5));k.handlePointsDefaults(e,r,n,{prefix:""});var d=m("box.width"),u=m("box.fillcolor",o),a=m("box.line.color",f),y=m("box.line.width",l);n("box.visible",Boolean(d||u||a||y))||(r.box={visible:!1});var h=m("meanline.color",f),_=m("meanline.width",l);n("meanline.visible",Boolean(h||_))||(r.meanline={visible:!1}),n("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(v,Q,$){"use strict";var g=v("../../lib"),t=function(k){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*k*k)};$.makeKDE=function(k,x,e){var r=e.length,i=t,c=k.bandwidth,n=1/(r*c);return function(m){for(var p=0,s=0;s<r;s++)p+=i((m-e[s])/c);return n*p}},$.getPositionOnKdePath=function(k,x,e){var r,i;"h"===x.orientation?(r="y",i="x"):(r="x",i="y");var c=g.findPointOnPath(k.path,e,i,{pathLength:k.pathLength}),n=k.posCenterPx,m=c[r];return[m,"both"===x.side?2*n-m:n]},$.getKdeValue=function(k,x,e){var r=k.pts.map($.extractVal);return $.makeKDE(k,x,r)(e)/k.posDensityScale},$.extractVal=function(k){return k.v}},{"../../lib":515}],1105:[function(v,Q,$){"use strict";var g=v("../../components/color"),t=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../box/hover"),e=v("./helpers");Q.exports=function(r,i,c,n,m){m||(m={});var p,s,f=m.hoverLayer,l=r.cd,o=l[0].trace,d=o.hoveron,u=-1!==d.indexOf("violins"),a=-1!==d.indexOf("kde"),y=[];if(u||a){var h=x.hoverOnBoxes(r,i,c,n);if(a&&h.length>0){var _,b,w,T,L,M=r.xa,P=r.ya;"h"===o.orientation?(L=i,_="y",w=P,b="x",T=M):(L=c,_="x",w=M,b="y",T=P);var z=l[r.index];if(L>=z.span[0]&&L<=z.span[1]){var S=t.extendFlat({},r),C=T.c2p(L,!0),R=e.getKdeValue(z,o,L),D=e.getPositionOnKdePath(z,o,C),j=w._offset,q=w._length;S[_+"0"]=D[0],S[_+"1"]=D[1],S[b+"0"]=S[b+"1"]=C,S[b+"Label"]=b+": "+k.hoverLabelText(T,L,o[b+"hoverformat"])+", "+l[0].t.labels.kde+" "+R.toFixed(3);for(var Z=0,W=0;W<h.length;W++)if("med"===h[W].attr){Z=W;break}S.spikeDistance=h[Z].spikeDistance;var G=_+"Spike";S[G]=h[Z][G],h[Z].spikeDistance=void 0,h[Z][G]=void 0,S.hovertemplate=!1,y.push(S),(s={})[_+"1"]=t.constrain(j+D[0],j,j+q),s[_+"2"]=t.constrain(j+D[1],j,j+q),s[b+"1"]=s[b+"2"]=T._offset+C}}u&&(y=y.concat(h))}-1!==d.indexOf("points")&&(p=x.hoverOnPoints(r,i,c));var X=f.selectAll(".violinline-"+o.uid).data(s?[0]:[]);return X.enter().append("line").classed("violinline-"+o.uid,!0).attr("stroke-width",1.5),X.exit().remove(),X.attr(s).call(g.stroke,r.color),"closest"===n?p?[p]:y:(p&&y.push(p),y)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style"),styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../box/select"),moduleType:"trace",name:"violin",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(v,Q,$){"use strict";var g=v("../box/layout_attributes"),t=v("../../lib").extendFlat;Q.exports={violinmode:t({},g.boxmode,{}),violingap:t({},g.boxgap,{}),violingroupgap:t({},g.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes"),k=v("../box/layout_defaults");Q.exports=function(x,e,r){k._supply(x,e,r,function(i,c){return g.coerce(x,e,t,i,c)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../box/plot"),e=v("../scatter/line_points"),r=v("./helpers");Q.exports=function(i,c,n,m){var p=i._fullLayout,s=c.xaxis,f=c.yaxis;function l(o,d){var u=e(o,{xaxis:s,yaxis:f,trace:d,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return k.smoothopen(u[0],1)}t.makeTraceGroups(m,n,"trace violins").each(function(o){var d=g.select(this),u=o[0],a=u.t,y=u.trace;if(!0!==y.visible||a.empty)d.remove();else{var h=a.bPos,_=a.bdPos,b=c[a.valLetter+"axis"],w=c[a.posLetter+"axis"],T="both"===y.side,L=T||"positive"===y.side,M=T||"negative"===y.side,P=d.selectAll("path.violin").data(t.identity);P.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),P.exit().remove(),P.each(function(Z){var W,G,X,ne,V,N,U,ee,B=g.select(this),K=Z.density,J=K.length,te=w.c2l(Z.pos+h,!0),ae=w.l2p(te);if(y.width)W=a.maxKDE/_;else{var ce=p._violinScaleGroupStats[y.scalegroup];W="count"===y.scalemode?ce.maxKDE/_*(ce.maxCount/Z.pts.length):ce.maxKDE/_}if(L){for(U=new Array(J),V=0;V<J;V++)(ee=U[V]={})[a.posLetter]=te+K[V].v/W,ee[a.valLetter]=b.c2l(K[V].t,!0);G=l(U,y)}if(M){for(U=new Array(J),N=0,V=J-1;N<J;N++,V--)(ee=U[N]={})[a.posLetter]=te-K[V].v/W,ee[a.valLetter]=b.c2l(K[V].t,!0);X=l(U,y)}if(T)ne=G+"L"+X.substr(1)+"Z";else{var oe=[ae,b.c2p(K[0].t)],ve=[ae,b.c2p(K[J-1].t)];"h"===y.orientation&&(oe.reverse(),ve.reverse()),ne=L?"M"+oe+"L"+G.substr(1)+"L"+ve:"M"+ve+"L"+X.substr(1)+"L"+oe}B.attr("d",ne),Z.posCenterPx=ae,Z.posDensityScale=W*_,Z.path=B.node(),Z.pathLength=Z.path.getTotalLength()/(T?2:1)});var z,S,C,R=y.box,D=R.width,j=(R.line||{}).width;T?(z=_*D,S=0):L?(z=[0,_*D/2],S=j*{x:1,y:-1}[a.posLetter]):(z=[_*D/2,0],S=j*{x:-1,y:1}[a.posLetter]),x.plotBoxAndWhiskers(d,{pos:w,val:b},y,{bPos:h,bdPos:z,bPosPxOffset:S}),x.plotBoxMean(d,{pos:w,val:b},y,{bPos:h,bdPos:z,bPosPxOffset:S}),!y.box.visible&&y.meanline.visible&&(C=t.identity);var q=d.selectAll("path.meanline").data(C||[]);q.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),q.exit().remove(),q.each(function(Z){var W=b.c2p(Z.mean,!0),G=r.getPositionOnKdePath(Z,y,W);g.select(this).attr("d","h"===y.orientation?"M"+W+","+G[0]+"V"+G[1]:"M"+G[0]+","+W+"H"+G[1])}),x.plotPoints(d,{x:s,y:f},y,a)}})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/color"),k=v("../scatter/style").stylePoints;Q.exports=function(x){var e=g.select(x).selectAll("g.trace.violins");e.style("opacity",function(r){return r[0].trace.opacity}),e.each(function(r){var i=r[0].trace,c=g.select(this),n=i.box||{},m=n.line||{},p=i.meanline||{},s=p.width;c.selectAll("path.violin").style("stroke-width",i.line.width+"px").call(t.stroke,i.line.color).call(t.fill,i.fillcolor),c.selectAll("path.box").style("stroke-width",m.width+"px").call(t.stroke,m.color).call(t.fill,n.fillcolor);var f={"stroke-width":s+"px","stroke-dasharray":2*s+"px,"+s+"px"};c.selectAll("path.mean").style(f).call(t.stroke,p.color),c.selectAll("path.meanline").style(f).call(t.stroke,p.color),k(c,i,x)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(v,Q,$){"use strict";var g=v("../../components/colorscale/attributes"),t=v("../isosurface/attributes"),k=v("../surface/attributes"),x=v("../../plots/attributes"),e=v("../../lib/extend").extendFlat,r=v("../../plot_api/edit_types").overrideAll,i=Q.exports=r(e({x:t.x,y:t.y,z:t.z,value:t.value,isomin:t.isomin,isomax:t.isomax,surface:t.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:t.slices,caps:t.caps,text:t.text,hovertext:t.hovertext,xhoverformat:t.xhoverformat,yhoverformat:t.yhoverformat,zhoverformat:t.zhoverformat,valuehoverformat:t.valuehoverformat,hovertemplate:t.hovertemplate},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:t.colorbar,opacity:t.opacity,opacityscale:k.opacityscale,lightposition:t.lightposition,lighting:t.lighting,flatshading:t.flatshading,contour:t.contour,hoverinfo:e({},x.hoverinfo),showlegend:e({},x.showlegend,{dflt:!1})}),"calc","nested");i.x.editType=i.y.editType=i.z.editType=i.value.editType="calc+clearAxisTypes",i.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(v,Q,$){"use strict";var g=v("../../../stackgl_modules").gl_mesh3d,t=v("../../lib/gl_format_color").parseColorScale,k=v("../../lib/str2rgbarray"),x=v("../../components/colorscale").extractOpts,e=v("../../plots/gl3d/zip3"),r=v("../isosurface/convert").findNearestOnAxis,i=v("../isosurface/convert").generateIsoMeshes;function c(m,p,s){this.scene=m,this.uid=s,this.mesh=p,this.name="",this.data=null,this.showContour=!1}var n=c.prototype;n.handlePick=function(m){if(m.object===this.mesh){var p=m.data.index,f=this.data._meshY[p],l=this.data._meshZ[p],o=this.data._Ys.length,d=this.data._Zs.length,u=r(this.data._meshX[p],this.data._Xs).id,a=r(f,this.data._Ys).id,y=r(l,this.data._Zs).id,h=m.index=y+d*a+d*o*u;m.traceCoordinate=[this.data._meshX[h],this.data._meshY[h],this.data._meshZ[h],this.data._value[h]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&void 0!==_[h]?m.textLabel=_[h]:_&&(m.textLabel=_),!0}},n.update=function(m){var p=this.scene,s=p.fullSceneLayout;function f(d,u,a,y){return u.map(function(h){return d.d2l(h,0,y)*a})}this.data=i(m);var l={positions:e(f(s.xaxis,m._meshX,p.dataScale[0],m.xcalendar),f(s.yaxis,m._meshY,p.dataScale[1],m.ycalendar),f(s.zaxis,m._meshZ,p.dataScale[2],m.zcalendar)),cells:e(m._meshI,m._meshJ,m._meshK),lightPosition:[m.lightposition.x,m.lightposition.y,m.lightposition.z],ambient:m.lighting.ambient,diffuse:m.lighting.diffuse,specular:m.lighting.specular,roughness:m.lighting.roughness,fresnel:m.lighting.fresnel,vertexNormalsEpsilon:m.lighting.vertexnormalsepsilon,faceNormalsEpsilon:m.lighting.facenormalsepsilon,opacity:m.opacity,opacityscale:m.opacityscale,contourEnable:m.contour.show,contourColor:k(m.contour.color).slice(0,3),contourWidth:m.contour.width,useFacetNormals:m.flatshading},o=x(m);l.vertexIntensity=m._meshIntensity,l.vertexIntensityBounds=[o.min,o.max],l.colormap=t(m),this.mesh.update(l)},n.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Q.exports=function(m,p){var f=g({gl:m.glplot.gl}),l=new c(m,f,p.uid);return f._trace=l,l.update(p),m.glplot.add(f),l}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./attributes"),k=v("../isosurface/defaults").supplyIsoDefaults,x=v("../surface/defaults").opacityscaleDefaults;Q.exports=function(e,r,i,c){function n(m,p){return g.coerce(e,r,t,m,p)}k(e,r,i,c,n),x(e,r,c,n)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert"),moduleType:"trace",name:"volume",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(v,Q,$){"use strict";var g=v("../bar/attributes"),t=v("../scatter/attributes").line,k=v("../../plots/attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/template_attributes").texttemplateAttrs,i=v("./constants"),c=v("../../lib/extend").extendFlat,n=v("../../components/color");function m(p){return{marker:{color:c({},g.marker.color,{arrayOk:!1,editType:"style"}),line:{color:c({},g.marker.line.color,{arrayOk:!1,editType:"style"}),width:c({},g.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}Q.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:x("x"),yhoverformat:x("y"),hovertext:g.hovertext,hovertemplate:e({},{keys:i.eventDataKeys}),hoverinfo:c({},k.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:r({editType:"plot"},{keys:i.eventDataKeys.concat(["label"])}),text:g.text,textposition:g.textposition,insidetextanchor:g.insidetextanchor,textangle:g.textangle,textfont:g.textfont,insidetextfont:g.insidetextfont,outsidetextfont:g.outsidetextfont,constraintext:g.constraintext,cliponaxis:g.cliponaxis,orientation:g.orientation,offset:g.offset,width:g.width,increasing:m(),decreasing:m(),totals:m(),connector:{line:{color:c({},t.color,{dflt:n.defaultLine}),width:c({},t.width,{editType:"plot"}),dash:t.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes"),t=v("../../plots/cartesian/align_period"),k=v("../../lib").mergeArray,x=v("../scatter/calc_selection"),e=v("../../constants/numerical").BADNUM;function r(c){return"a"===c||"absolute"===c}function i(c){return"t"===c||"total"===c}Q.exports=function(c,n){var m,p,s,f,l,o,d=g.getFromId(c,n.xaxis||"x"),u=g.getFromId(c,n.yaxis||"y");"h"===n.orientation?(m=d.makeCalcdata(n,"x"),s=u.makeCalcdata(n,"y"),f=t(n,u,"y",s),l=!!n.yperiodalignment,o="y"):(m=u.makeCalcdata(n,"y"),s=d.makeCalcdata(n,"x"),f=t(n,d,"x",s),l=!!n.xperiodalignment,o="x"),p=f.vals;for(var a,y=Math.min(p.length,m.length),h=new Array(y),_=0,b=!1,w=0;w<y;w++){var T=m[w]||0,L=!1;(m[w]!==e||i(n.measure[w])||r(n.measure[w]))&&w+1<y&&(m[w+1]!==e||i(n.measure[w+1])||r(n.measure[w+1]))&&(L=!0);var M=h[w]={i:w,p:p[w],s:T,rawS:T,cNext:L};r(n.measure[w])?(_=M.s,M.isSum=!0,M.dir="totals",M.s=_):i(n.measure[w])?(M.isSum=!0,M.dir="totals",M.s=_):(M.isSum=!1,M.dir=M.rawS<0?"decreasing":"increasing",M.s=_+(a=M.s),_+=a),"totals"===M.dir&&(b=!0),l&&(h[w].orig_p=s[w],h[w][o+"End"]=f.ends[w],h[w][o+"Start"]=f.starts[w]),n.ids&&(M.id=String(n.ids[w])),M.v=(n.base||0)+_}return h.length&&(h[0].hasTotals=b),k(n.text,h,"tx"),k(n.hovertext,h,"htx"),x(h,n),h}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(v,Q,$){"use strict";Q.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(v,Q,$){"use strict";var g=v("../bar/cross_trace_calc").setGroupPositions;Q.exports=function(t,k){var x,e,r=t._fullLayout,i=t._fullData,c=t.calcdata,n=k.xaxis,m=k.yaxis,p=[],s=[],f=[];for(e=0;e<i.length;e++){var l=i[e];!0===l.visible&&l.xaxis===n._id&&l.yaxis===m._id&&"waterfall"===l.type&&(x=c[e],"h"===l.orientation?f.push(x):s.push(x),p.push(x))}var o={mode:r.waterfallmode,norm:r.waterfallnorm,gap:r.waterfallgap,groupgap:r.waterfallgroupgap};for(g(t,n,m,s,o),g(t,m,n,f,o),e=0;e<p.length;e++){x=p[e];for(var d=0;d<x.length;d++){var u=x[d];!1===u.isSum&&(u.s0+=0===d?0:x[d-1].s),d+1<x.length&&(x[d].nextP0=x[d+1].p0,x[d].nextS0=x[d+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("../bar/defaults").handleGroupingDefaults,k=v("../bar/defaults").handleText,x=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),r=v("./attributes"),i=v("../../components/color"),c=v("../../constants/delta.js"),n=c.INCREASING.COLOR,m=c.DECREASING.COLOR;function p(s,f,l){s(f+".marker.color",l),s(f+".marker.line.color",i.defaultLine),s(f+".marker.line.width")}Q.exports={supplyDefaults:function(s,f,l,o){function d(a,y){return g.coerce(s,f,r,a,y)}if(x(s,f,o,d)){e(s,f,o,d),d("xhoverformat"),d("yhoverformat"),d("measure"),d("orientation",f.x&&!f.y?"h":"v"),d("base"),d("offset"),d("width"),d("text"),d("hovertext"),d("hovertemplate");var u=d("textposition");k(s,f,o,d,u,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==f.textposition&&(d("texttemplate"),f.texttemplate||d("textinfo")),p(d,"increasing",n),p(d,"decreasing",m),p(d,"totals","#4499FF"),d("connector.visible")&&(d("connector.mode"),d("connector.line.width")&&(d("connector.line.color"),d("connector.line.dash")))}else f.visible=!1},crossTraceDefaults:function(s,f){var l,o;function d(a){return g.coerce(o._input,o,r,a)}if("group"===f.waterfallmode)for(var u=0;u<s.length;u++)l=(o=s[u])._input,t(l,o,f,d)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(v,Q,$){"use strict";Q.exports=function(g,t){return g.x="xVal"in t?t.xVal:t.x,g.y="yVal"in t?t.yVal:t.y,"initial"in t&&(g.initial=t.initial),"delta"in t&&(g.delta=t.delta),"final"in t&&(g.final=t.final),t.xa&&(g.xaxis=t.xa),t.ya&&(g.yaxis=t.ya),g}},{}],1121:[function(v,Q,$){"use strict";var g=v("../../plots/cartesian/axes").hoverLabelText,t=v("../../components/color").opacity,k=v("../bar/hover").hoverOnBars,x=v("../../constants/delta.js"),e=x.INCREASING.SYMBOL,r=x.DECREASING.SYMBOL;Q.exports=function(i,c,n,m,p){var S,C,R,D,s=k(i,c,n,m,p);if(s){var f=s.cd,l=f[0].trace,o="h"===l.orientation,d=o?"x":"y",u=o?i.xa:i.ya,a=f[s.index],y=a.isSum?a.b+a.s:a.rawS;if(!a.isSum){s.initial=a.b+a.s-y,s.delta=y,s.final=s.initial+s.delta;var h=M(Math.abs(s.delta));s.deltaLabel=y<0?"("+h+")":h,s.finalLabel=M(s.final),s.initialLabel=M(s.initial)}var _=a.hi||l.hoverinfo,b=[];if(_&&"none"!==_&&"skip"!==_){var w="all"===_,T=_.split("+"),L=function(P){return w||-1!==T.indexOf(P)};a.isSum||(!L("final")||L(o?"x":"y")||b.push(s.finalLabel),L("delta")&&b.push(y<0?s.deltaLabel+" "+r:s.deltaLabel+" "+e),L("initial")&&b.push("Initial: "+s.initialLabel))}return b.length&&(s.extraText=b.join("<br>")),s.color=(R=(S=l[a.dir].marker).line.color,D=S.line.width,t(C=S.color)?C:t(R)&&D?R:void 0),[s]}function M(P){return g(u,P,l[d+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(v,Q,$){"use strict";Q.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style").style,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(v,Q,$){"use strict";Q.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(v,Q,$){"use strict";var g=v("../../lib"),t=v("./layout_attributes");Q.exports=function(k,x,e){var r=!1;function i(m,p){return g.coerce(k,x,t,m,p)}for(var c=0;c<e.length;c++){var n=e[c];if(n.visible&&"waterfall"===n.type){r=!0;break}}r&&(i("waterfallmode"),i("waterfallgap",.2),i("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../lib"),k=v("../../components/drawing"),x=v("../../constants/numerical").BADNUM,e=v("../bar/plot"),r=v("../bar/uniform_text").clearMinTextSize;Q.exports=function(i,c,n,m){var s,f,d,u,p=i._fullLayout;r("waterfall",p),e.plot(i,c,n,m,{mode:p.waterfallmode,norm:p.waterfallmode,gap:p.waterfallgap,groupgap:p.waterfallgroupgap}),s=i,d=(f=c).xaxis,u=f.yaxis,t.makeTraceGroups(m,n,"trace bars").each(function(a){var y=g.select(this),h=a[0].trace,_=t.ensureSingle(y,"g","lines");if(h.connector&&h.connector.visible){var b="h"===h.orientation,w=h.connector.mode,T=_.selectAll("g.line").data(t.identity);T.enter().append("g").classed("line",!0),T.exit().remove();var L=T.size();T.each(function(M,P){if(P===L-1||M.cNext){var z=(j=d,q=u,G=[],ne=(Z=b)?q:j,(W=[])[0]=(X=Z?j:q).c2p((D=M).s0,!0),G[0]=ne.c2p(D.p0,!0),W[1]=X.c2p(D.s1,!0),G[1]=ne.c2p(D.p1,!0),W[2]=X.c2p(D.nextS0,!0),G[2]=ne.c2p(D.nextP0,!0),Z?[W,G]:[G,W]),S=z[0],C=z[1],R="";S[0]!==x&&C[0]!==x&&S[1]!==x&&C[1]!==x&&("spanning"===w&&!M.isSum&&P>0&&(R+=b?"M"+S[0]+","+C[1]+"V"+C[0]:"M"+S[1]+","+C[0]+"H"+S[0]),"between"!==w&&(M.isSum||P<L-1)&&(R+=b?"M"+S[1]+","+C[0]+"V"+C[1]:"M"+S[0]+","+C[1]+"H"+S[1]),S[2]!==x&&C[2]!==x&&(R+=b?"M"+S[1]+","+C[1]+"V"+C[2]:"M"+S[1]+","+C[1]+"H"+S[2])),""===R&&(R="M0,0Z"),t.ensureSingle(g.select(this),"path").attr("d",R).call(k.setClipUrl,f.layerClipId,s)}var D,j,q,Z,W,G,X,ne})}else _.remove()})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(v,Q,$){"use strict";var g=v("@plotly/d3"),t=v("../../components/drawing"),k=v("../../components/color"),x=v("../../constants/interactions").DESELECTDIM,e=v("../bar/style"),r=v("../bar/uniform_text").resizeText,i=e.styleTextPoints;Q.exports={style:function(c,n,m){var p=m||g.select(c).selectAll("g.waterfalllayer").selectAll("g.trace");r(c,p,"waterfall"),p.style("opacity",function(s){return s[0].trace.opacity}),p.each(function(s){var f=g.select(this),l=s[0].trace;f.selectAll(".point > path").each(function(o){if(!o.isBlank){var d=l[o.dir].marker;g.select(this).call(k.fill,d.color).call(k.stroke,d.line.color).call(t.dashLine,d.line.dash,d.line.width).style("opacity",l.selectedpoints&&!o.selected?x:1)}}),i(f,l,c),f.selectAll(".lines").each(function(){var o=l.connector.line;t.lineGroupStyle(g.select(this).selectAll("path"),o.width,o.color,o.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(v,Q,$){"use strict";var g=v("../plots/cartesian/axes"),t=v("../lib"),k=v("../plot_api/plot_schema"),x=v("./helpers").pointsAccessorFunction,e=v("../constants/numerical").BADNUM;$.moduleType="transform",$.name="aggregate";var r=$.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},i=r.aggregations;function c(s,f,l,o){if(o.enabled){for(var d=o.target,u=t.nestedProperty(f,d),a=u.get(),y=function(b,w){var L=w.d2c,M=w.c2d;switch(b.func){case"count":return n;case"first":return m;case"last":return p;case"sum":return function(P,z){for(var S=0,C=0;C<z.length;C++){var R=L(P[z[C]]);R!==e&&(S+=R)}return M(S)};case"avg":return function(P,z){for(var S=0,C=0,R=0;R<z.length;R++){var D=L(P[z[R]]);D!==e&&(S+=D,C++)}return C?M(S/C):e};case"min":return function(P,z){for(var S=1/0,C=0;C<z.length;C++){var R=L(P[z[C]]);R!==e&&(S=Math.min(S,R))}return S===1/0?e:M(S)};case"max":return function(P,z){for(var S=-1/0,C=0;C<z.length;C++){var R=L(P[z[C]]);R!==e&&(S=Math.max(S,R))}return S===-1/0?e:M(S)};case"range":return function(P,z){for(var S=1/0,C=-1/0,R=0;R<z.length;R++){var D=L(P[z[R]]);D!==e&&(S=Math.min(S,D),C=Math.max(C,D))}return C===-1/0||S===1/0?e:M(C-S)};case"change":return function(P,z){var S=L(P[z[0]]),C=L(P[z[z.length-1]]);return S===e||C===e?e:M(C-S)};case"median":return function(P,z){for(var S=[],C=0;C<z.length;C++){var R=L(P[z[C]]);R!==e&&S.push(R)}if(!S.length)return e;S.sort(t.sorterAsc);var D=(S.length-1)/2;return M((S[Math.floor(D)]+S[Math.ceil(D)])/2)};case"mode":return function(P,z){for(var S={},C=0,R=e,D=0;D<z.length;D++){var j=L(P[z[D]]);if(j!==e){var q=S[j]=(S[j]||0)+1;q>C&&(C=q,R=j)}}return C?M(R):e};case"rms":return function(P,z){for(var S=0,C=0,R=0;R<z.length;R++){var D=L(P[z[R]]);D!==e&&(S+=D*D,C++)}return C?M(Math.sqrt(S/C)):e};case"stddev":return function(P,z){var S,C=0,R=0,D=1,j=e;for(S=0;S<z.length&&j===e;S++)j=L(P[z[S]]);if(j===e)return e;for(;S<z.length;S++){var q=L(P[z[S]]);if(q!==e){var Z=q-j;C+=Z,R+=Z*Z,D++}}var W="sample"===b.funcmode?D-1:D;return W?Math.sqrt((R-C*C/D)/W):0}}}(o,g.getDataConversions(s,f,d,a)),h=new Array(l.length),_=0;_<l.length;_++)h[_]=y(a,l[_]);u.set(h),"count"===o.func&&t.pushUnique(f._arrayAttrs,d)}}function n(s,f){return f.length}function m(s,f){return s[f[0]]}function p(s,f){return s[f[f.length-1]]}$.supplyDefaults=function(s,f){var l,o={};function d(M,P){return t.coerce(s,o,r,M,P)}if(!d("enabled"))return o;var u=k.findArrayAttributes(f),a={};for(l=0;l<u.length;l++)a[u[l]]=1;var y=d("groups");if(!Array.isArray(y)){if(!a[y])return o.enabled=!1,o;a[y]=0}var h,_=s.aggregations||[],b=o.aggregations=new Array(_.length);function w(M,P){return t.coerce(_[l],h,i,M,P)}for(l=0;l<_.length;l++){h={_index:l};var T=w("target"),L=w("func");w("enabled")&&T&&(a[T]||"count"===L&&void 0===a[T])?("stddev"===L&&w("funcmode"),a[T]=0,b[l]=h):b[l]={enabled:!1,_index:l}}for(l=0;l<u.length;l++)a[u[l]]&&b.push({target:u[l],func:i.func.dflt,enabled:!0,_index:-1});return o},$.calcTransform=function(s,f,l){if(l.enabled){var o=l.groups,d=t.getTargetArray(f,{target:o});if(d){var u,a,y,_={},b={},w=[],T=x(f.transforms,l),L=d.length;for(f._length&&(L=Math.min(L,f._length)),u=0;u<L;u++)void 0===(y=_[a=d[u]])?(_[a]=w.length,w.push([u]),b[_[a]]=T(u)):(w[y].push(u),b[_[a]]=(b[_[a]]||[]).concat(T(u)));l._indexToPoints=b;var M=l.aggregations;for(u=0;u<M.length;u++)c(s,f,w,M[u]);"string"==typeof o&&c(s,f,w,{target:o,func:"first",enabled:!0}),f._length=w.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../registry"),k=v("../plots/cartesian/axes"),x=v("./helpers").pointsAccessorFunction,e=v("../constants/filter_ops"),r=e.COMPARISON_OPS,i=e.INTERVAL_OPS,c=e.SET_OPS;$.moduleType="transform",$.name="filter",$.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(r).concat(i).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},$.supplyDefaults=function(n){var m={};function p(l,o){return g.coerce(n,m,$.attributes,l,o)}if(p("enabled")){var s=p("target");if(g.isArrayOrTypedArray(s)&&0===s.length)return m.enabled=!1,m;p("preservegaps"),p("operation"),p("value");var f=t.getComponentMethod("calendars","handleDefaults");f(n,m,"valuecalendar",null),f(n,m,"targetcalendar",null)}return m},$.calcTransform=function(n,m,p){if(p.enabled){var s=g.getTargetArray(m,p);if(s){var f=p.target,l=s.length;m._length&&(l=Math.min(l,m._length));var o=p.targetcalendar,d=m._arrayAttrs,u=p.preservegaps;if("string"==typeof f){var a=g.nestedProperty(m,f+"calendar").get();a&&(o=a)}var y,h,_=function(z,S,C){var R=z.operation,D=z.value,j=Array.isArray(D);function q(X){return-1!==X.indexOf(R)}var Z,W=function(X){return S(X,0,z.valuecalendar)},G=function(X){return S(X,0,C)};switch(q(r)?Z=W(j?D[0]:D):q(i)?Z=j?[W(D[0]),W(D[1])]:[W(D),W(D)]:q(c)&&(Z=j?D.map(W):[W(D)]),R){case"=":return function(X){return G(X)===Z};case"!=":return function(X){return G(X)!==Z};case"<":return function(X){return G(X)<Z};case"<=":return function(X){return G(X)<=Z};case">":return function(X){return G(X)>Z};case">=":return function(X){return G(X)>=Z};case"[]":return function(X){var ne=G(X);return ne>=Z[0]&&ne<=Z[1]};case"()":return function(X){var ne=G(X);return ne>Z[0]&&ne<Z[1]};case"[)":return function(X){var ne=G(X);return ne>=Z[0]&&ne<Z[1]};case"(]":return function(X){var ne=G(X);return ne>Z[0]&&ne<=Z[1]};case"][":return function(X){var ne=G(X);return ne<=Z[0]||ne>=Z[1]};case")(":return function(X){var ne=G(X);return ne<Z[0]||ne>Z[1]};case"](":return function(X){var ne=G(X);return ne<=Z[0]||ne>Z[1]};case")[":return function(X){var ne=G(X);return ne<Z[0]||ne>=Z[1]};case"{}":return function(X){return-1!==Z.indexOf(G(X))};case"}{":return function(X){return-1===Z.indexOf(G(X))}}}(p,k.getDataToCoordFunc(n,m,f,s),o),b={},w={},T=0;u?(y=function(z){b[z.astr]=g.extendDeep([],z.get()),z.set(new Array(l))},h=function(z,S){var C=b[z.astr][S];z.get()[S]=C}):(y=function(z){b[z.astr]=g.extendDeep([],z.get()),z.set([])},h=function(z,S){var C=b[z.astr][S];z.get().push(C)}),P(y);for(var L=x(m.transforms,p),M=0;M<l;M++)_(s[M])?(P(h,M),w[T++]=L(M)):u&&T++;p._indexToPoints=w,m._length=T}}function P(z,S){for(var C=0;C<d.length;C++)z(g.nestedProperty(m,d[C]),S)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plot_api/plot_schema"),k=v("../plots/plots"),x=v("./helpers").pointsAccessorFunction;function e(r,i){var c,n,m,p,s,f,l,o,d,u,a=i.transform,y=i.transformIndex,h=r.transforms[y].groups,_=x(r.transforms,a);if(!g.isArrayOrTypedArray(h)||0===h.length)return[r];var b=g.filterUnique(h),w=new Array(b.length),T=h.length,L=t.findArrayAttributes(r),M=a.styles||[],P={};for(c=0;c<M.length;c++)P[M[c].target]=M[c].value;a.styles&&(u=g.keyedContainer(a,"styles","target","value.name"));var z={},S={};for(c=0;c<b.length;c++){z[f=b[c]]=c,S[f]=0,(l=w[c]=g.extendDeepNoArrays({},r))._group=f,l.transforms[y]._indexToPoints={};var C=null;for(u&&(C=u.get(f)),l.name=C||""===C?C:g.templateString(a.nameformat,{trace:r.name,group:f}),o=l.transforms,l.transforms=[],n=0;n<o.length;n++)l.transforms[n]=g.extendDeepNoArrays({},o[n]);for(n=0;n<L.length;n++)g.nestedProperty(l,L[n]).set([])}for(m=0;m<L.length;m++){for(p=L[m],n=0,d=[];n<b.length;n++)d[n]=g.nestedProperty(w[n],p).get();for(s=g.nestedProperty(r,p).get(),n=0;n<T;n++)d[z[h[n]]].push(s[n])}for(n=0;n<T;n++)(l=w[z[h[n]]]).transforms[y]._indexToPoints[S[h[n]]]=_(n),S[h[n]]++;for(c=0;c<b.length;c++)f=b[c],k.clearExpandedTraceDefaultColors(l=w[c]),l=g.extendDeepNoArrays(l,P[f]||{});return w}$.moduleType="transform",$.name="groupby",$.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},$.supplyDefaults=function(r,i,c){var n,m={};function p(d,u){return g.coerce(r,m,$.attributes,d,u)}if(!p("enabled"))return m;p("groups"),p("nameformat",c._dataLength>1?"%{group} (%{trace})":"%{group}");var s=r.styles,f=m.styles=[];if(s)for(n=0;n<s.length;n++){var l=f[n]={};g.coerce(s[n],f[n],$.attributes.styles,"target");var o=g.coerce(s[n],f[n],$.attributes.styles,"value");g.isPlainObject(o)?l.value=g.extendDeep({},o):o&&delete l.value}return m},$.transform=function(r,i){var c,n,m,p=[];for(n=0;n<r.length;n++)for(c=e(r[n],i),m=0;m<c.length;m++)p.push(c[m]);return p}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(v,Q,$){"use strict";$.pointsAccessorFunction=function(g,t){for(var k,x,e=0;e<g.length&&(k=g[e])!==t;e++)k._indexToPoints&&!1!==k.enabled&&(x=k._indexToPoints);return x?function(r){return x[r]}:function(r){return[r]}}},{}],1131:[function(v,Q,$){"use strict";var g=v("../lib"),t=v("../plots/cartesian/axes"),k=v("./helpers").pointsAccessorFunction,x=v("../constants/numerical").BADNUM;$.moduleType="transform",$.name="sort",$.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},$.supplyDefaults=function(e){var r={};function i(c,n){return g.coerce(e,r,$.attributes,c,n)}return i("enabled")&&(i("target"),i("order")),r},$.calcTransform=function(e,r,i){if(i.enabled){var c=g.getTargetArray(r,i);if(c){var n=i.target,m=c.length;r._length&&(m=Math.min(m,r._length));var p,s,f=r._arrayAttrs,l=function(h,_,b,w){var T,L=new Array(w),M=new Array(w);for(T=0;T<w;T++)L[T]={v:_[T],i:T};for(L.sort(function(P,z){switch(P.order){case"ascending":return function(S,C){var R=z(S.v),D=z(C.v);return R===x?1:D===x?-1:R-D};case"descending":return function(S,C){var R=z(S.v),D=z(C.v);return R===x?1:D===x?-1:D-R}}}(h,b)),T=0;T<w;T++)M[T]=L[T].i;return M}(i,c,t.getDataToCoordFunc(e,r,n,c),m),o=k(r.transforms,i),d={};for(p=0;p<f.length;p++){var u=g.nestedProperty(r,f[p]),a=u.get(),y=new Array(m);for(s=0;s<m;s++)y[s]=a[l[s]];u.set(y)}for(s=0;s<m;s++)d[s]=o(l[s]);i._indexToPoints=d,r._length=m}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(v,Q,$){"use strict";$.version="2.16.2"},{}],1133:[function(v,Q,$){(function(g){(function(){!function(t){"object"==typeof $&&void 0!==Q?Q.exports=t():("undefined"!=typeof window?window:void 0!==g?g:"undefined"!=typeof self?self:this).stackgl=t()}(function(){return function t(k,x,e){function r(n,m){if(!x[n]){if(!k[n]){var p="function"==typeof v&&v;if(!m&&p)return p(n,!0);if(i)return i(n,!0);var s=new Error("Cannot find module '"+n+"'");throw s.code="MODULE_NOT_FOUND",s}var f=x[n]={exports:{}};k[n][0].call(f.exports,function(l){return r(k[n][1][l]||l)},f,f.exports,t,k,x,e)}return x[n].exports}for(var i="function"==typeof v&&v,c=0;c<e.length;c++)r(e[c]);return r}({1:[function(t,k,x){"use strict";x.byteLength=function(f){var l=p(f),d=l[1];return 3*(l[0]+d)/4-d},x.toByteArray=function(f){var l,o,T,d=p(f),u=d[0],a=d[1],y=new i(3*(u+(T=a))/4-T),h=0,_=a>0?u-4:u;for(o=0;o<_;o+=4)l=r[f.charCodeAt(o)]<<18|r[f.charCodeAt(o+1)]<<12|r[f.charCodeAt(o+2)]<<6|r[f.charCodeAt(o+3)],y[h++]=l>>16&255,y[h++]=l>>8&255,y[h++]=255&l;return 2===a&&(l=r[f.charCodeAt(o)]<<2|r[f.charCodeAt(o+1)]>>4,y[h++]=255&l),1===a&&(l=r[f.charCodeAt(o)]<<10|r[f.charCodeAt(o+1)]<<4|r[f.charCodeAt(o+2)]>>2,y[h++]=l>>8&255,y[h++]=255&l),y},x.fromByteArray=function(f){for(var l,o=f.length,d=o%3,u=[],a=0,y=o-d;a<y;a+=16383)u.push(s(f,a,a+16383>y?y:a+16383));return 1===d?u.push(e[(l=f[o-1])>>2]+e[l<<4&63]+"=="):2===d&&u.push(e[(l=(f[o-2]<<8)+f[o-1])>>10]+e[l>>4&63]+e[l<<2&63]+"="),u.join("")};for(var e=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,m=c.length;n<m;++n)e[n]=c[n],r[c.charCodeAt(n)]=n;function p(f){var l=f.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=f.indexOf("=");return-1===o&&(o=l),[o,o===l?0:4-o%4]}function s(f,l,o){for(var u,a=[],y=l;y<o;y+=3)a.push(e[(u=(f[y]<<16&16711680)+(f[y+1]<<8&65280)+(255&f[y+2]))>>18&63]+e[u>>12&63]+e[u>>6&63]+e[63&u]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},{}],2:[function(t,k,x){},{}],3:[function(t,k,x){(function(e){(function(){"use strict";var r=t("base64-js"),i=t("ieee754");function c(B){if(B>2147483647)throw new RangeError('The value "'+B+'" is invalid for option "size"');var K=new Uint8Array(B);return K.__proto__=n.prototype,K}function n(B,K,J){if("number"==typeof B){if("string"==typeof K)throw new TypeError('The "string" argument must be of type string. Received type number');return s(B)}return m(B,K,J)}function m(B,K,J){if("string"==typeof B)return function(ce,oe){if("string"==typeof oe&&""!==oe||(oe="utf8"),!n.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);var ve=0|o(ce,oe),fe=c(ve),xe=fe.write(ce,oe);return xe!==ve&&(fe=fe.slice(0,xe)),fe}(B,K);if(ArrayBuffer.isView(B))return f(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(U(B,ArrayBuffer)||B&&U(B.buffer,ArrayBuffer))return function(ce,oe,ve){if(oe<0||ce.byteLength<oe)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<oe+(ve||0))throw new RangeError('"length" is outside of buffer bounds');var fe;return(fe=void 0===oe&&void 0===ve?new Uint8Array(ce):void 0===ve?new Uint8Array(ce,oe):new Uint8Array(ce,oe,ve)).__proto__=n.prototype,fe}(B,K,J);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var te=B.valueOf&&B.valueOf();if(null!=te&&te!==B)return n.from(te,K,J);var ae=function(ce){if(n.isBuffer(ce)){var oe=0|l(ce.length),ve=c(oe);return 0===ve.length||ce.copy(ve,0,0,oe),ve}return void 0!==ce.length?"number"!=typeof ce.length||ee(ce.length)?c(0):f(ce):"Buffer"===ce.type&&Array.isArray(ce.data)?f(ce.data):void 0}(B);if(ae)return ae;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return n.from(B[Symbol.toPrimitive]("string"),K,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function p(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function s(B){return p(B),c(B<0?0:0|l(B))}function f(B){for(var K=B.length<0?0:0|l(B.length),J=c(K),te=0;te<K;te+=1)J[te]=255&B[te];return J}function l(B){if(B>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|B}function o(B,K){if(n.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||U(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var J=B.length,te=arguments.length>2&&!0===arguments[2];if(!te&&0===J)return 0;for(var ae=!1;;)switch(K){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return ne(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*J;case"hex":return J>>>1;case"base64":return V(B).length;default:if(ae)return te?-1:ne(B).length;K=(""+K).toLowerCase(),ae=!0}}function d(B,K,J){var te=!1;if((void 0===K||K<0)&&(K=0),K>this.length||((void 0===J||J>this.length)&&(J=this.length),J<=0)||(J>>>=0)<=(K>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return C(this,K,J);case"utf8":case"utf-8":return P(this,K,J);case"ascii":return z(this,K,J);case"latin1":case"binary":return S(this,K,J);case"base64":return M(this,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,K,J);default:if(te)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),te=!0}}function u(B,K,J){var te=B[K];B[K]=B[J],B[J]=te}function a(B,K,J,te,ae){if(0===B.length)return-1;if("string"==typeof J?(te=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),ee(J=+J)&&(J=ae?0:B.length-1),J<0&&(J=B.length+J),J>=B.length){if(ae)return-1;J=B.length-1}else if(J<0){if(!ae)return-1;J=0}if("string"==typeof K&&(K=n.from(K,te)),n.isBuffer(K))return 0===K.length?-1:y(B,K,J,te,ae);if("number"==typeof K)return K&=255,"function"==typeof Uint8Array.prototype.indexOf?ae?Uint8Array.prototype.indexOf.call(B,K,J):Uint8Array.prototype.lastIndexOf.call(B,K,J):y(B,[K],J,te,ae);throw new TypeError("val must be string, number or Buffer")}function y(B,K,J,te,ae){var ce,oe=1,ve=B.length,fe=K.length;if(void 0!==te&&("ucs2"===(te=String(te).toLowerCase())||"ucs-2"===te||"utf16le"===te||"utf-16le"===te)){if(B.length<2||K.length<2)return-1;oe=2,ve/=2,fe/=2,J/=2}function xe(Te,se){return 1===oe?Te[se]:Te.readUInt16BE(se*oe)}if(ae){var Se=-1;for(ce=J;ce<ve;ce++)if(xe(B,ce)===xe(K,-1===Se?0:ce-Se)){if(-1===Se&&(Se=ce),ce-Se+1===fe)return Se*oe}else-1!==Se&&(ce-=ce-Se),Se=-1}else for(J+fe>ve&&(J=ve-fe),ce=J;ce>=0;ce--){for(var pe=!0,ge=0;ge<fe;ge++)if(xe(B,ce+ge)!==xe(K,ge)){pe=!1;break}if(pe)return ce}return-1}function h(B,K,J,te){J=Number(J)||0;var ae=B.length-J;te?(te=Number(te))>ae&&(te=ae):te=ae;var ce=K.length;te>ce/2&&(te=ce/2);for(var oe=0;oe<te;++oe){var ve=parseInt(K.substr(2*oe,2),16);if(ee(ve))return oe;B[J+oe]=ve}return oe}function _(B,K,J,te){return N(ne(K,B.length-J),B,J,te)}function b(B,K,J,te){return N(function(ae){for(var ce=[],oe=0;oe<ae.length;++oe)ce.push(255&ae.charCodeAt(oe));return ce}(K),B,J,te)}function w(B,K,J,te){return b(B,K,J,te)}function T(B,K,J,te){return N(V(K),B,J,te)}function L(B,K,J,te){return N(function(ae,ce){for(var oe,ve,xe=[],Se=0;Se<ae.length&&!((ce-=2)<0);++Se)ve=(oe=ae.charCodeAt(Se))>>8,xe.push(oe%256),xe.push(ve);return xe}(K,B.length-J),B,J,te)}function M(B,K,J){return r.fromByteArray(0===K&&J===B.length?B:B.slice(K,J))}function P(B,K,J){J=Math.min(B.length,J);for(var te=[],ae=K;ae<J;){var ce,oe,ve,fe,xe=B[ae],Se=null,pe=xe>239?4:xe>223?3:xe>191?2:1;if(ae+pe<=J)switch(pe){case 1:xe<128&&(Se=xe);break;case 2:128==(192&(ce=B[ae+1]))&&(fe=(31&xe)<<6|63&ce)>127&&(Se=fe);break;case 3:oe=B[ae+2],128==(192&(ce=B[ae+1]))&&128==(192&oe)&&(fe=(15&xe)<<12|(63&ce)<<6|63&oe)>2047&&(fe<55296||fe>57343)&&(Se=fe);break;case 4:oe=B[ae+2],ve=B[ae+3],128==(192&(ce=B[ae+1]))&&128==(192&oe)&&128==(192&ve)&&(fe=(15&xe)<<18|(63&ce)<<12|(63&oe)<<6|63&ve)>65535&&fe<1114112&&(Se=fe)}null===Se?(Se=65533,pe=1):Se>65535&&(te.push((Se-=65536)>>>10&1023|55296),Se=56320|1023&Se),te.push(Se),ae+=pe}return function(ge){var Te=ge.length;if(Te<=4096)return String.fromCharCode.apply(String,ge);for(var se="",de=0;de<Te;)se+=String.fromCharCode.apply(String,ge.slice(de,de+=4096));return se}(te)}function z(B,K,J){var te="";J=Math.min(B.length,J);for(var ae=K;ae<J;++ae)te+=String.fromCharCode(127&B[ae]);return te}function S(B,K,J){var te="";J=Math.min(B.length,J);for(var ae=K;ae<J;++ae)te+=String.fromCharCode(B[ae]);return te}function C(B,K,J){var te=B.length;(!K||K<0)&&(K=0),(!J||J<0||J>te)&&(J=te);for(var ae="",ce=K;ce<J;++ce)ae+=X(B[ce]);return ae}function R(B,K,J){for(var te=B.slice(K,J),ae="",ce=0;ce<te.length;ce+=2)ae+=String.fromCharCode(te[ce]+256*te[ce+1]);return ae}function D(B,K,J){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+K>J)throw new RangeError("Trying to access beyond buffer length")}function j(B,K,J,te,ae,ce){if(!n.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(K>ae||K<ce)throw new RangeError('"value" argument is out of bounds');if(J+te>B.length)throw new RangeError("Index out of range")}function q(B,K,J,te,ae,ce){if(J+te>B.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function Z(B,K,J,te,ae){return K=+K,J>>>=0,ae||q(B,0,J,4),i.write(B,K,J,te,23,4),J+4}function W(B,K,J,te,ae){return K=+K,J>>>=0,ae||q(B,0,J,8),i.write(B,K,J,te,52,8),J+8}x.Buffer=n,x.SlowBuffer=function(B){return+B!=B&&(B=0),n.alloc(+B)},x.INSPECT_MAX_BYTES=50,x.kMaxLength=2147483647,(n.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(K){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192,n.from=function(B,K,J){return m(B,K,J)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,n.alloc=function(B,K,J){return ae=K,ce=J,p(te=B),te<=0?c(te):void 0!==ae?"string"==typeof ce?c(te).fill(ae,ce):c(te).fill(ae):c(te);var te,ae,ce},n.allocUnsafe=function(B){return s(B)},n.allocUnsafeSlow=function(B){return s(B)},n.isBuffer=function(B){return null!=B&&!0===B._isBuffer&&B!==n.prototype},n.compare=function(B,K){if(U(B,Uint8Array)&&(B=n.from(B,B.offset,B.byteLength)),U(K,Uint8Array)&&(K=n.from(K,K.offset,K.byteLength)),!n.isBuffer(B)||!n.isBuffer(K))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(B===K)return 0;for(var J=B.length,te=K.length,ae=0,ce=Math.min(J,te);ae<ce;++ae)if(B[ae]!==K[ae]){J=B[ae],te=K[ae];break}return J<te?-1:te<J?1:0},n.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(B,K){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(0===B.length)return n.alloc(0);var J;if(void 0===K)for(K=0,J=0;J<B.length;++J)K+=B[J].length;var te=n.allocUnsafe(K),ae=0;for(J=0;J<B.length;++J){var ce=B[J];if(U(ce,Uint8Array)&&(ce=n.from(ce)),!n.isBuffer(ce))throw new TypeError('"list" argument must be an Array of Buffers');ce.copy(te,ae),ae+=ce.length}return te},n.byteLength=o,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var B=this.length;if(B%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var K=0;K<B;K+=2)u(this,K,K+1);return this},n.prototype.swap32=function(){var B=this.length;if(B%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var K=0;K<B;K+=4)u(this,K,K+3),u(this,K+1,K+2);return this},n.prototype.swap64=function(){var B=this.length;if(B%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var K=0;K<B;K+=8)u(this,K,K+7),u(this,K+1,K+6),u(this,K+2,K+5),u(this,K+3,K+4);return this},n.prototype.toLocaleString=n.prototype.toString=function(){var B=this.length;return 0===B?"":0===arguments.length?P(this,0,B):d.apply(this,arguments)},n.prototype.equals=function(B){if(!n.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B||0===n.compare(this,B)},n.prototype.inspect=function(){var B="",K=x.INSPECT_MAX_BYTES;return B=this.toString("hex",0,K).replace(/(.{2})/g,"$1 ").trim(),this.length>K&&(B+=" ... "),"<Buffer "+B+">"},n.prototype.compare=function(B,K,J,te,ae){if(U(B,Uint8Array)&&(B=n.from(B,B.offset,B.byteLength)),!n.isBuffer(B))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof B);if(void 0===K&&(K=0),void 0===J&&(J=B?B.length:0),void 0===te&&(te=0),void 0===ae&&(ae=this.length),K<0||J>B.length||te<0||ae>this.length)throw new RangeError("out of range index");if(te>=ae&&K>=J)return 0;if(te>=ae)return-1;if(K>=J)return 1;if(this===B)return 0;for(var ce=(ae>>>=0)-(te>>>=0),oe=(J>>>=0)-(K>>>=0),ve=Math.min(ce,oe),fe=this.slice(te,ae),xe=B.slice(K,J),Se=0;Se<ve;++Se)if(fe[Se]!==xe[Se]){ce=fe[Se],oe=xe[Se];break}return ce<oe?-1:oe<ce?1:0},n.prototype.includes=function(B,K,J){return-1!==this.indexOf(B,K,J)},n.prototype.indexOf=function(B,K,J){return a(this,B,K,J,!0)},n.prototype.lastIndexOf=function(B,K,J){return a(this,B,K,J,!1)},n.prototype.write=function(B,K,J,te){if(void 0===K)te="utf8",J=this.length,K=0;else if(void 0===J&&"string"==typeof K)te=K,J=this.length,K=0;else{if(!isFinite(K))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");K>>>=0,isFinite(J)?(J>>>=0,void 0===te&&(te="utf8")):(te=J,J=void 0)}var ae=this.length-K;if((void 0===J||J>ae)&&(J=ae),B.length>0&&(J<0||K<0)||K>this.length)throw new RangeError("Attempt to write outside buffer bounds");te||(te="utf8");for(var ce=!1;;)switch(te){case"hex":return h(this,B,K,J);case"utf8":case"utf-8":return _(this,B,K,J);case"ascii":return b(this,B,K,J);case"latin1":case"binary":return w(this,B,K,J);case"base64":return T(this,B,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,B,K,J);default:if(ce)throw new TypeError("Unknown encoding: "+te);te=(""+te).toLowerCase(),ce=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.slice=function(B,K){var J=this.length;(B=~~B)<0?(B+=J)<0&&(B=0):B>J&&(B=J),(K=void 0===K?J:~~K)<0?(K+=J)<0&&(K=0):K>J&&(K=J),K<B&&(K=B);var te=this.subarray(B,K);return te.__proto__=n.prototype,te},n.prototype.readUIntLE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var te=this[B],ae=1,ce=0;++ce<K&&(ae*=256);)te+=this[B+ce]*ae;return te},n.prototype.readUIntBE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var te=this[B+--K],ae=1;K>0&&(ae*=256);)te+=this[B+--K]*ae;return te},n.prototype.readUInt8=function(B,K){return B>>>=0,K||D(B,1,this.length),this[B]},n.prototype.readUInt16LE=function(B,K){return B>>>=0,K||D(B,2,this.length),this[B]|this[B+1]<<8},n.prototype.readUInt16BE=function(B,K){return B>>>=0,K||D(B,2,this.length),this[B]<<8|this[B+1]},n.prototype.readUInt32LE=function(B,K){return B>>>=0,K||D(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+16777216*this[B+3]},n.prototype.readUInt32BE=function(B,K){return B>>>=0,K||D(B,4,this.length),16777216*this[B]+(this[B+1]<<16|this[B+2]<<8|this[B+3])},n.prototype.readIntLE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var te=this[B],ae=1,ce=0;++ce<K&&(ae*=256);)te+=this[B+ce]*ae;return te>=(ae*=128)&&(te-=Math.pow(2,8*K)),te},n.prototype.readIntBE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var te=K,ae=1,ce=this[B+--te];te>0&&(ae*=256);)ce+=this[B+--te]*ae;return ce>=(ae*=128)&&(ce-=Math.pow(2,8*K)),ce},n.prototype.readInt8=function(B,K){return B>>>=0,K||D(B,1,this.length),128&this[B]?-1*(255-this[B]+1):this[B]},n.prototype.readInt16LE=function(B,K){B>>>=0,K||D(B,2,this.length);var J=this[B]|this[B+1]<<8;return 32768&J?4294901760|J:J},n.prototype.readInt16BE=function(B,K){B>>>=0,K||D(B,2,this.length);var J=this[B+1]|this[B]<<8;return 32768&J?4294901760|J:J},n.prototype.readInt32LE=function(B,K){return B>>>=0,K||D(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},n.prototype.readInt32BE=function(B,K){return B>>>=0,K||D(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},n.prototype.readFloatLE=function(B,K){return B>>>=0,K||D(B,4,this.length),i.read(this,B,!0,23,4)},n.prototype.readFloatBE=function(B,K){return B>>>=0,K||D(B,4,this.length),i.read(this,B,!1,23,4)},n.prototype.readDoubleLE=function(B,K){return B>>>=0,K||D(B,8,this.length),i.read(this,B,!0,52,8)},n.prototype.readDoubleBE=function(B,K){return B>>>=0,K||D(B,8,this.length),i.read(this,B,!1,52,8)},n.prototype.writeUIntLE=function(B,K,J,te){B=+B,K>>>=0,J>>>=0,te||j(this,B,K,J,Math.pow(2,8*J)-1,0);var ae=1,ce=0;for(this[K]=255&B;++ce<J&&(ae*=256);)this[K+ce]=B/ae&255;return K+J},n.prototype.writeUIntBE=function(B,K,J,te){B=+B,K>>>=0,J>>>=0,te||j(this,B,K,J,Math.pow(2,8*J)-1,0);var ae=J-1,ce=1;for(this[K+ae]=255&B;--ae>=0&&(ce*=256);)this[K+ae]=B/ce&255;return K+J},n.prototype.writeUInt8=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,1,255,0),this[K]=255&B,K+1},n.prototype.writeUInt16LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,65535,0),this[K]=255&B,this[K+1]=B>>>8,K+2},n.prototype.writeUInt16BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,65535,0),this[K]=B>>>8,this[K+1]=255&B,K+2},n.prototype.writeUInt32LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,4294967295,0),this[K+3]=B>>>24,this[K+2]=B>>>16,this[K+1]=B>>>8,this[K]=255&B,K+4},n.prototype.writeUInt32BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,4294967295,0),this[K]=B>>>24,this[K+1]=B>>>16,this[K+2]=B>>>8,this[K+3]=255&B,K+4},n.prototype.writeIntLE=function(B,K,J,te){if(B=+B,K>>>=0,!te){var ae=Math.pow(2,8*J-1);j(this,B,K,J,ae-1,-ae)}var ce=0,oe=1,ve=0;for(this[K]=255&B;++ce<J&&(oe*=256);)B<0&&0===ve&&0!==this[K+ce-1]&&(ve=1),this[K+ce]=(B/oe>>0)-ve&255;return K+J},n.prototype.writeIntBE=function(B,K,J,te){if(B=+B,K>>>=0,!te){var ae=Math.pow(2,8*J-1);j(this,B,K,J,ae-1,-ae)}var ce=J-1,oe=1,ve=0;for(this[K+ce]=255&B;--ce>=0&&(oe*=256);)B<0&&0===ve&&0!==this[K+ce+1]&&(ve=1),this[K+ce]=(B/oe>>0)-ve&255;return K+J},n.prototype.writeInt8=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,1,127,-128),B<0&&(B=255+B+1),this[K]=255&B,K+1},n.prototype.writeInt16LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,32767,-32768),this[K]=255&B,this[K+1]=B>>>8,K+2},n.prototype.writeInt16BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,32767,-32768),this[K]=B>>>8,this[K+1]=255&B,K+2},n.prototype.writeInt32LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,2147483647,-2147483648),this[K]=255&B,this[K+1]=B>>>8,this[K+2]=B>>>16,this[K+3]=B>>>24,K+4},n.prototype.writeInt32BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[K]=B>>>24,this[K+1]=B>>>16,this[K+2]=B>>>8,this[K+3]=255&B,K+4},n.prototype.writeFloatLE=function(B,K,J){return Z(this,B,K,!0,J)},n.prototype.writeFloatBE=function(B,K,J){return Z(this,B,K,!1,J)},n.prototype.writeDoubleLE=function(B,K,J){return W(this,B,K,!0,J)},n.prototype.writeDoubleBE=function(B,K,J){return W(this,B,K,!1,J)},n.prototype.copy=function(B,K,J,te){if(!n.isBuffer(B))throw new TypeError("argument should be a Buffer");if(J||(J=0),te||0===te||(te=this.length),K>=B.length&&(K=B.length),K||(K=0),te>0&&te<J&&(te=J),te===J||0===B.length||0===this.length)return 0;if(K<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("sourceEnd out of bounds");te>this.length&&(te=this.length),B.length-K<te-J&&(te=B.length-K+J);var ae=te-J;if(this===B&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(K,J,te);else if(this===B&&J<K&&K<te)for(var ce=ae-1;ce>=0;--ce)B[ce+K]=this[ce+J];else Uint8Array.prototype.set.call(B,this.subarray(J,te),K);return ae},n.prototype.fill=function(B,K,J,te){if("string"==typeof B){if("string"==typeof K?(te=K,K=0,J=this.length):"string"==typeof J&&(te=J,J=this.length),void 0!==te&&"string"!=typeof te)throw new TypeError("encoding must be a string");if("string"==typeof te&&!n.isEncoding(te))throw new TypeError("Unknown encoding: "+te);if(1===B.length){var ae=B.charCodeAt(0);("utf8"===te&&ae<128||"latin1"===te)&&(B=ae)}}else"number"==typeof B&&(B&=255);if(K<0||this.length<K||this.length<J)throw new RangeError("Out of range index");if(J<=K)return this;var ce;if(K>>>=0,J=void 0===J?this.length:J>>>0,B||(B=0),"number"==typeof B)for(ce=K;ce<J;++ce)this[ce]=B;else{var oe=n.isBuffer(B)?B:n.from(B,te),ve=oe.length;if(0===ve)throw new TypeError('The value "'+B+'" is invalid for argument "value"');for(ce=0;ce<J-K;++ce)this[ce+K]=oe[ce%ve]}return this};var G=/[^+/0-9A-Za-z-_]/g;function X(B){return B<16?"0"+B.toString(16):B.toString(16)}function ne(B,K){var J;K=K||1/0;for(var te=B.length,ae=null,ce=[],oe=0;oe<te;++oe){if((J=B.charCodeAt(oe))>55295&&J<57344){if(!ae){if(J>56319){(K-=3)>-1&&ce.push(239,191,189);continue}if(oe+1===te){(K-=3)>-1&&ce.push(239,191,189);continue}ae=J;continue}if(J<56320){(K-=3)>-1&&ce.push(239,191,189),ae=J;continue}J=65536+(ae-55296<<10|J-56320)}else ae&&(K-=3)>-1&&ce.push(239,191,189);if(ae=null,J<128){if((K-=1)<0)break;ce.push(J)}else if(J<2048){if((K-=2)<0)break;ce.push(J>>6|192,63&J|128)}else if(J<65536){if((K-=3)<0)break;ce.push(J>>12|224,J>>6&63|128,63&J|128)}else{if(!(J<1114112))throw new Error("Invalid code point");if((K-=4)<0)break;ce.push(J>>18|240,J>>12&63|128,J>>6&63|128,63&J|128)}}return ce}function V(B){return r.toByteArray(function(K){if((K=(K=K.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;K.length%4!=0;)K+="=";return K}(B))}function N(B,K,J,te){for(var ae=0;ae<te&&!(ae+J>=K.length||ae>=B.length);++ae)K[ae+J]=B[ae];return ae}function U(B,K){return B instanceof K||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===K.name}function ee(B){return B!=B}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(t,k,x){x.read=function(e,r,i,c,n){var m,p,s=8*n-c-1,f=(1<<s)-1,l=f>>1,o=-7,d=i?n-1:0,u=i?-1:1,a=e[r+d];for(d+=u,m=a&(1<<-o)-1,a>>=-o,o+=s;o>0;m=256*m+e[r+d],d+=u,o-=8);for(p=m&(1<<-o)-1,m>>=-o,o+=c;o>0;p=256*p+e[r+d],d+=u,o-=8);if(0===m)m=1-l;else{if(m===f)return p?NaN:1/0*(a?-1:1);p+=Math.pow(2,c),m-=l}return(a?-1:1)*p*Math.pow(2,m-c)},x.write=function(e,r,i,c,n,m){var p,s,f,l=8*m-n-1,o=(1<<l)-1,d=o>>1,u=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,a=c?0:m-1,y=c?1:-1,h=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(s=isNaN(r)?1:0,p=o):(p=Math.floor(Math.log(r)/Math.LN2),r*(f=Math.pow(2,-p))<1&&(p--,f*=2),(r+=p+d>=1?u/f:u*Math.pow(2,1-d))*f>=2&&(p++,f/=2),p+d>=o?(s=0,p=o):p+d>=1?(s=(r*f-1)*Math.pow(2,n),p+=d):(s=r*Math.pow(2,d-1)*Math.pow(2,n),p=0));n>=8;e[i+a]=255&s,a+=y,s/=256,n-=8);for(p=p<<n|s,l+=n;l>0;e[i+a]=255&p,a+=y,p/=256,l-=8);e[i+a-y]|=128*h}},{}],5:[function(t,k,x){var e,r,i=k.exports={};function c(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function m(y){if(e===setTimeout)return setTimeout(y,0);if((e===c||!e)&&setTimeout)return e=setTimeout,setTimeout(y,0);try{return e(y,0)}catch(h){try{return e.call(null,y,0)}catch(_){return e.call(this,y,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:c}catch(y){e=c}try{r="function"==typeof clearTimeout?clearTimeout:n}catch(y){r=n}}();var p,s=[],f=!1,l=-1;function o(){f&&p&&(f=!1,p.length?s=p.concat(s):l=-1,s.length&&d())}function d(){if(!f){var y=m(o);f=!0;for(var h=s.length;h;){for(p=s,s=[];++l<h;)p&&p[l].run();l=-1,h=s.length}p=null,f=!1,function(_){if(r===clearTimeout)return clearTimeout(_);if((r===n||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(_);try{r(_)}catch(b){try{return r.call(null,_)}catch(w){return r.call(this,_)}}}(y)}}function u(y,h){this.fun=y,this.array=h}function a(){}i.nextTick=function(y){var h=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)h[_-1]=arguments[_];s.push(new u(y,h)),1!==s.length||f||m(d)},u.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=a,i.addListener=a,i.once=a,i.off=a,i.removeListener=a,i.removeAllListeners=a,i.emit=a,i.prependListener=a,i.prependOnceListener=a,i.listeners=function(y){return[]},i.binding=function(y){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(y){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],6:[function(t,k,x){k.exports={alpha_shape:t("alpha-shape"),convex_hull:t("convex-hull"),delaunay_triangulate:t("delaunay-triangulate"),gl_cone3d:t("gl-cone3d"),gl_error3d:t("gl-error3d"),gl_heatmap2d:t("gl-heatmap2d"),gl_line3d:t("gl-line3d"),gl_mesh3d:t("gl-mesh3d"),gl_plot2d:t("gl-plot2d"),gl_plot3d:t("gl-plot3d"),gl_pointcloud2d:t("gl-pointcloud2d"),gl_scatter3d:t("gl-scatter3d"),gl_select_box:t("gl-select-box"),gl_spikes2d:t("gl-spikes2d"),gl_streamtube3d:t("gl-streamtube3d"),gl_surface3d:t("gl-surface3d"),ndarray:t("ndarray"),ndarray_linear_interpolate:t("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(t,k,x){"use strict";k.exports=function(m){var p=(m=m||{}).eye||[0,0,1],s=m.center||[0,0,0],f=m.up||[0,1,0],l=m.distanceLimits||[0,1/0],o=m.mode||"turntable",d=e(),u=r(),a=i();return d.setDistanceLimits(l[0],l[1]),d.lookAt(0,p,s,f),u.setDistanceLimits(l[0],l[1]),u.lookAt(0,p,s,f),a.setDistanceLimits(l[0],l[1]),a.lookAt(0,p,s,f),new c({turntable:d,orbit:u,matrix:a},o)};var e=t("turntable-camera-controller"),r=t("orbit-camera-controller"),i=t("matrix-camera-controller");function c(m,p){this._controllerNames=Object.keys(m),this._controllerList=this._controllerNames.map(function(s){return m[s]}),this._mode=p,this._active=m[p],this._active||(this._mode="turntable",this._active=m.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var n=c.prototype;n.flush=function(m){for(var p=this._controllerList,s=0;s<p.length;++s)p[s].flush(m)},n.idle=function(m){for(var p=this._controllerList,s=0;s<p.length;++s)p[s].idle(m)},n.lookAt=function(m,p,s,f){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].lookAt(m,p,s,f)},n.rotate=function(m,p,s,f){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].rotate(m,p,s,f)},n.pan=function(m,p,s,f){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].pan(m,p,s,f)},n.translate=function(m,p,s,f){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].translate(m,p,s,f)},n.setMatrix=function(m,p){for(var s=this._controllerList,f=0;f<s.length;++f)s[f].setMatrix(m,p)},n.setDistanceLimits=function(m,p){for(var s=this._controllerList,f=0;f<s.length;++f)s[f].setDistanceLimits(m,p)},n.setDistance=function(m,p){for(var s=this._controllerList,f=0;f<s.length;++f)s[f].setDistance(m,p)},n.recalcMatrix=function(m){this._active.recalcMatrix(m)},n.getDistance=function(m){return this._active.getDistance(m)},n.getDistanceLimits=function(m){return this._active.getDistanceLimits(m)},n.lastT=function(){return this._active.lastT()},n.setMode=function(m){if(m!==this._mode){var p=this._controllerNames.indexOf(m);if(!(p<0)){var s=this._active,f=this._controllerList[p],l=Math.max(s.lastT(),f.lastT());s.recalcMatrix(l),f.setMatrix(l,s.computedMatrix),this._active=f,this._mode=m,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},n.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(t,k,x){"use strict";var e="undefined"==typeof WeakMap?t("weak-map"):WeakMap,r=t("gl-buffer"),i=t("gl-vao"),c=new e;k.exports=function(n){var m=c.get(n),p=m&&(m._triangleBuffer.handle||m._triangleBuffer.buffer);if(!p||!n.isBuffer(p)){var s=r(n,new Float32Array([-1,-1,-1,4,4,-1]));(m=i(n,[{buffer:s,type:n.FLOAT,size:2}]))._triangleBuffer=s,c.set(n,m)}m.bind(),n.drawArrays(n.TRIANGLES,0,3),m.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(t,k,x){var e=t("pad-left");k.exports=function(r,i,c){i="number"==typeof i?i:1,c=c||": ";var n=r.split(/\r?\n/),m=String(n.length+i-1).length;return n.map(function(p,s){var f=s+i,l=String(f).length;return e(f,m-l)+c+p}).join("\n")}},{"pad-left":264}],10:[function(t,k,x){"use strict";k.exports=function(i){var c=i.length;if(0===c)return[];if(1===c)return[0];for(var n=i[0].length,m=[i[0]],p=[0],s=1;s<c;++s)if(m.push(i[s]),r(m,n)){if(p.push(s),p.length===n+1)return p}else m.pop();return p};var e=t("robust-orientation");function r(i,c){for(var n=new Array(c+1),m=0;m<i.length;++m)n[m]=i[m];for(m=0;m<=i.length;++m){for(var p=i.length;p<=c;++p){for(var s=new Array(c),f=0;f<c;++f)s[f]=Math.pow(p+1-m,f);n[p]=s}if(e.apply(void 0,n))return!0}return!1}},{"robust-orientation":284}],11:[function(t,k,x){"use strict";k.exports=function(i,c){return e(c).filter(function(n){for(var m=new Array(n.length),p=0;p<n.length;++p)m[p]=c[n[p]];return r(m)*i<1})};var e=t("delaunay-triangulate"),r=t("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(t,k,x){k.exports=function(i,c){return r(e(i,c))};var e=t("alpha-complex"),r=t("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(t,k,x){k.exports=function(e){return atob(e)}},{}],14:[function(t,k,x){"use strict";k.exports=function(i,c){for(var n=c.length,m=new Array(n+1),p=0;p<n;++p){for(var s=new Array(n+1),f=0;f<=n;++f)s[f]=i[f][p];m[p]=s}for(m[n]=new Array(n+1),p=0;p<=n;++p)m[n][p]=1;var l=new Array(n+1);for(p=0;p<n;++p)l[p]=c[p];l[n]=1;var o=e(m,l),d=r(o[n+1]);0===d&&(d=1);var u=new Array(n+1);for(p=0;p<=n;++p)u[p]=r(o[p])/d;return u};var e=t("robust-linear-solve");function r(i){for(var c=0,n=0;n<i.length;++n)c+=i[n];return c}},{"robust-linear-solve":283}],15:[function(t,k,x){"use strict";var e=t("./lib/rationalize");k.exports=function(r,i){return e(r[0].mul(i[1]).add(i[0].mul(r[1])),r[1].mul(i[1]))}},{"./lib/rationalize":25}],16:[function(t,k,x){"use strict";k.exports=function(e,r){return e[0].mul(r[1]).cmp(r[0].mul(e[1]))}},{}],17:[function(t,k,x){"use strict";var e=t("./lib/rationalize");k.exports=function(r,i){return e(r[0].mul(i[1]),r[1].mul(i[0]))}},{"./lib/rationalize":25}],18:[function(t,k,x){"use strict";var e=t("./is-rat"),r=t("./lib/is-bn"),i=t("./lib/num-to-bn"),c=t("./lib/str-to-bn"),n=t("./lib/rationalize"),m=t("./div");k.exports=function p(s,f){if(e(s))return f?m(s,p(f)):[s[0].clone(),s[1].clone()];var l,o,d=0;if(r(s))l=s.clone();else if("string"==typeof s)l=c(s);else{if(0===s)return[i(0),i(1)];if(s===Math.floor(s))l=i(s);else{for(;s!==Math.floor(s);)s*=Math.pow(2,256),d-=256;l=i(s)}}if(e(f))l.mul(f[1]),o=f[0].clone();else if(r(f))o=f.clone();else if("string"==typeof f)o=c(f);else if(f)if(f===Math.floor(f))o=i(f);else{for(;f!==Math.floor(f);)f*=Math.pow(2,256),d+=256;o=i(f)}else o=i(1);return d>0?l=l.ushln(d):d<0&&(o=o.ushln(-d)),n(l,o)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(t,k,x){"use strict";var e=t("./lib/is-bn");k.exports=function(r){return Array.isArray(r)&&2===r.length&&e(r[0])&&e(r[1])}},{"./lib/is-bn":23}],20:[function(t,k,x){"use strict";var e=t("bn.js");k.exports=function(r){return r.cmp(new e(0))}},{"bn.js":33}],21:[function(t,k,x){"use strict";var e=t("./bn-sign");k.exports=function(r){var i=r.length,c=r.words,n=0;if(1===i)n=c[0];else if(2===i)n=c[0]+67108864*c[1];else for(var m=0;m<i;m++)n+=c[m]*Math.pow(67108864,m);return e(r)*n}},{"./bn-sign":20}],22:[function(t,k,x){"use strict";var e=t("double-bits"),r=t("bit-twiddle").countTrailingZeros;k.exports=function(i){var c=r(e.lo(i));if(c<32)return c;var n=r(e.hi(i));return n>20?52:n+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(t,k,x){"use strict";t("bn.js"),k.exports=function(e){return e&&"object"==typeof e&&Boolean(e.words)}},{"bn.js":33}],24:[function(t,k,x){"use strict";var e=t("bn.js"),r=t("double-bits");k.exports=function(i){var c=r.exponent(i);return c<52?new e(i):new e(i*Math.pow(2,52-c)).ushln(c-52)}},{"bn.js":33,"double-bits":64}],25:[function(t,k,x){"use strict";var e=t("./num-to-bn"),r=t("./bn-sign");k.exports=function(i,c){var n=r(i),m=r(c);if(0===n)return[e(0),e(1)];if(0===m)return[e(0),e(0)];m<0&&(i=i.neg(),c=c.neg());var p=i.gcd(c);return p.cmpn(1)?[i.div(p),c.div(p)]:[i,c]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(t,k,x){"use strict";var e=t("bn.js");k.exports=function(r){return new e(r)}},{"bn.js":33}],27:[function(t,k,x){"use strict";var e=t("./lib/rationalize");k.exports=function(r,i){return e(r[0].mul(i[0]),r[1].mul(i[1]))}},{"./lib/rationalize":25}],28:[function(t,k,x){"use strict";var e=t("./lib/bn-sign");k.exports=function(r){return e(r[0])*e(r[1])}},{"./lib/bn-sign":20}],29:[function(t,k,x){"use strict";var e=t("./lib/rationalize");k.exports=function(r,i){return e(r[0].mul(i[1]).sub(r[1].mul(i[0])),r[1].mul(i[1]))}},{"./lib/rationalize":25}],30:[function(t,k,x){"use strict";var e=t("./lib/bn-to-num"),r=t("./lib/ctz");k.exports=function(i){var c=i[0],n=i[1];if(0===c.cmpn(0))return 0;var m=c.abs().divmod(n.abs()),s=e(m.div),f=m.mod,l=c.negative!==n.negative?-1:1;if(0===f.cmpn(0))return l*s;if(s){var o=r(s)+4,d=e(f.ushln(o).divRound(n));return l*(s+d*Math.pow(2,-o))}var u=n.bitLength()-f.bitLength()+53;return d=e(f.ushln(u).divRound(n)),u<1023?l*d*Math.pow(2,-u):l*(d*=Math.pow(2,-1023))*Math.pow(2,1023-u)}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(t,k,x){"use strict";function e(p,s,f,l,o){for(var d=o+1;l<=o;){var u=l+o>>>1,a=p[u];(void 0!==f?f(a,s):a-s)>=0?(d=u,o=u-1):l=u+1}return d}function r(p,s,f,l,o){for(var d=o+1;l<=o;){var u=l+o>>>1,a=p[u];(void 0!==f?f(a,s):a-s)>0?(d=u,o=u-1):l=u+1}return d}function i(p,s,f,l,o){for(var d=l-1;l<=o;){var u=l+o>>>1,a=p[u];(void 0!==f?f(a,s):a-s)<0?(d=u,l=u+1):o=u-1}return d}function c(p,s,f,l,o){for(var d=l-1;l<=o;){var u=l+o>>>1,a=p[u];(void 0!==f?f(a,s):a-s)<=0?(d=u,l=u+1):o=u-1}return d}function n(p,s,f,l,o){for(;l<=o;){var d=l+o>>>1,u=p[d],a=void 0!==f?f(u,s):u-s;if(0===a)return d;a<=0?l=d+1:o=d-1}return-1}function m(p,s,f,l,o,d){return"function"==typeof f?d(p,s,f,void 0===l?0:0|l,void 0===o?p.length-1:0|o):d(p,s,void 0,void 0===f?0:0|f,void 0===l?p.length-1:0|l)}k.exports={ge:function(p,s,f,l,o){return m(p,s,f,l,o,e)},gt:function(p,s,f,l,o){return m(p,s,f,l,o,r)},lt:function(p,s,f,l,o){return m(p,s,f,l,o,i)},le:function(p,s,f,l,o){return m(p,s,f,l,o,c)},eq:function(p,s,f,l,o){return m(p,s,f,l,o,n)}}},{}],32:[function(t,k,x){"use strict";function e(i){var c=32;return(i&=-i)&&c--,65535&i&&(c-=16),16711935&i&&(c-=8),252645135&i&&(c-=4),858993459&i&&(c-=2),1431655765&i&&(c-=1),c}x.INT_BITS=32,x.INT_MAX=2147483647,x.INT_MIN=-1<<31,x.sign=function(i){return(i>0)-(i<0)},x.abs=function(i){var c=i>>31;return(i^c)-c},x.min=function(i,c){return c^(i^c)&-(i<c)},x.max=function(i,c){return i^(i^c)&-(i<c)},x.isPow2=function(i){return!(i&i-1||!i)},x.log2=function(i){var c,n;return c=(i>65535)<<4,c|=n=((i>>>=c)>255)<<3,c|=n=((i>>>=n)>15)<<2,(c|=n=((i>>>=n)>3)<<1)|(i>>>=n)>>1},x.log10=function(i){return i>=1e9?9:i>=1e8?8:i>=1e7?7:i>=1e6?6:i>=1e5?5:i>=1e4?4:i>=1e3?3:i>=100?2:i>=10?1:0},x.popCount=function(i){return 16843009*((i=(858993459&(i-=i>>>1&1431655765))+(i>>>2&858993459))+(i>>>4)&252645135)>>>24},x.countTrailingZeros=e,x.nextPow2=function(i){return i+=0===i,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,1+((i|=i>>>8)|i>>>16)},x.prevPow2=function(i){return i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,(i|=i>>>16)-(i>>>1)},x.parity=function(i){return i^=i>>>16,i^=i>>>8,i^=i>>>4,27030>>>(i&=15)&1};var r=new Array(256);(function(i){for(var c=0;c<256;++c){var n=c,m=c,p=7;for(n>>>=1;n;n>>>=1)m<<=1,m|=1&n,--p;i[c]=m<<p&255}})(r),x.reverse=function(i){return r[255&i]<<24|r[i>>>8&255]<<16|r[i>>>16&255]<<8|r[i>>>24&255]},x.interleave2=function(i,c){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i&=65535)|i<<8))|i<<4))|i<<2))|i<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c&=65535)|c<<8))|c<<4))|c<<2))|c<<1))<<1},x.deinterleave2=function(i,c){return(i=65535&((i=16711935&((i=252645135&((i=858993459&((i=i>>>c&1431655765)|i>>>1))|i>>>2))|i>>>4))|i>>>16))<<16>>16},x.interleave3=function(i,c,n){return i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2),(i|=(c=1227133513&((c=3272356035&((c=251719695&((c=4278190335&((c&=1023)|c<<16))|c<<8))|c<<4))|c<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},x.deinterleave3=function(i,c){return(i=1023&((i=4278190335&((i=251719695&((i=3272356035&((i=i>>>c&1227133513)|i>>>2))|i>>>4))|i>>>8))|i>>>16))<<22>>22},x.nextCombination=function(i){var c=i|i-1;return c+1|(~c&-~c)-1>>>e(i)+1}},{}],33:[function(t,k,x){!function(e,r){"use strict";function i(S,C){if(!S)throw new Error(C||"Assertion failed")}function c(S,C){S.super_=C;var R=function(){};R.prototype=C.prototype,S.prototype=new R,S.prototype.constructor=S}function n(S,C,R){if(n.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,null!==S&&("le"!==C&&"be"!==C||(R=C,C=10),this._init(S||0,C||10,R||"be"))}var m;"object"==typeof e?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;try{m="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:t("buffer").Buffer}catch(S){}function p(S,C){var R=S.charCodeAt(C);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function s(S,C,R){var D=p(S,R);return R-1>=C&&(D|=p(S,R-1)<<4),D}function f(S,C,R,D){for(var j=0,q=Math.min(S.length,R),Z=C;Z<q;Z++){var W=S.charCodeAt(Z)-48;j*=D,j+=W>=49?W-49+10:W>=17?W-17+10:W}return j}n.isBN=function(S){return S instanceof n||null!==S&&"object"==typeof S&&S.constructor.wordSize===n.wordSize&&Array.isArray(S.words)},n.max=function(S,C){return S.cmp(C)>0?S:C},n.min=function(S,C){return S.cmp(C)<0?S:C},n.prototype._init=function(S,C,R){if("number"==typeof S)return this._initNumber(S,C,R);if("object"==typeof S)return this._initArray(S,C,R);"hex"===C&&(C=16),i(C===(0|C)&&C>=2&&C<=36);var D=0;"-"===(S=S.toString().replace(/\s+/g,""))[0]&&(D++,this.negative=1),D<S.length&&(16===C?this._parseHex(S,D,R):(this._parseBase(S,C,D),"le"===R&&this._initArray(this.toArray(),C,R)))},n.prototype._initNumber=function(S,C,R){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(i(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),"le"===R&&this._initArray(this.toArray(),C,R)},n.prototype._initArray=function(S,C,R){if(i("number"==typeof S.length),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,q,Z=0;if("be"===R)for(D=S.length-1,j=0;D>=0;D-=3)this.words[j]|=(q=S[D]|S[D-1]<<8|S[D-2]<<16)<<Z&67108863,this.words[j+1]=q>>>26-Z&67108863,(Z+=24)>=26&&(Z-=26,j++);else if("le"===R)for(D=0,j=0;D<S.length;D+=3)this.words[j]|=(q=S[D]|S[D+1]<<8|S[D+2]<<16)<<Z&67108863,this.words[j+1]=q>>>26-Z&67108863,(Z+=24)>=26&&(Z-=26,j++);return this.strip()},n.prototype._parseHex=function(S,C,R){this.length=Math.ceil((S.length-C)/6),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,q=0,Z=0;if("be"===R)for(D=S.length-1;D>=C;D-=2)j=s(S,C,D)<<q,this.words[Z]|=67108863&j,q>=18?(q-=18,this.words[Z+=1]|=j>>>26):q+=8;else for(D=(S.length-C)%2==0?C+1:C;D<S.length;D+=2)j=s(S,C,D)<<q,this.words[Z]|=67108863&j,q>=18?(q-=18,this.words[Z+=1]|=j>>>26):q+=8;this.strip()},n.prototype._parseBase=function(S,C,R){this.words=[0],this.length=1;for(var D=0,j=1;j<=67108863;j*=C)D++;D--,j=j/C|0;for(var q=S.length-R,Z=q%D,W=Math.min(q,q-Z)+R,G=0,X=R;X<W;X+=D)G=f(S,X,X+D,C),this.imuln(j),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G);if(0!==Z){var ne=1;for(G=f(S,X,S.length,C),X=0;X<Z;X++)ne*=C;this.imuln(ne),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G)}this.strip()},n.prototype.copy=function(S){S.words=new Array(this.length);for(var C=0;C<this.length;C++)S.words[C]=this.words[C];S.length=this.length,S.negative=this.negative,S.red=this.red},n.prototype.clone=function(){var S=new n(null);return this.copy(S),S},n.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],o=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(S,C,R){R.negative=C.negative^S.negative;var D=S.length+C.length|0;R.length=D,D=D-1|0;var j=0|S.words[0],q=0|C.words[0],Z=j*q,G=Z/67108864|0;R.words[0]=67108863&Z;for(var X=1;X<D;X++){for(var ne=G>>>26,V=67108863&G,N=Math.min(X,C.length-1),U=Math.max(0,X-S.length+1);U<=N;U++)ne+=(Z=(j=0|S.words[X-U|0])*(q=0|C.words[U])+V)/67108864|0,V=67108863&Z;R.words[X]=0|V,G=0|ne}return 0!==G?R.words[X]=0|G:R.length--,R.strip()}n.prototype.toString=function(S,C){var R;if(C=0|C||1,16===(S=S||10)||"hex"===S){R="";for(var D=0,j=0,q=0;q<this.length;q++){var Z=this.words[q],W=(16777215&(Z<<D|j)).toString(16);R=0!=(j=Z>>>24-D&16777215)||q!==this.length-1?l[6-W.length]+W+R:W+R,(D+=2)>=26&&(D-=26,q--)}for(0!==j&&(R=j.toString(16)+R);R.length%C!=0;)R="0"+R;return 0!==this.negative&&(R="-"+R),R}if(S===(0|S)&&S>=2&&S<=36){var G=o[S],X=d[S];R="";var ne=this.clone();for(ne.negative=0;!ne.isZero();){var V=ne.modn(X).toString(S);R=(ne=ne.idivn(X)).isZero()?V+R:l[G-V.length]+V+R}for(this.isZero()&&(R="0"+R);R.length%C!=0;)R="0"+R;return 0!==this.negative&&(R="-"+R),R}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var S=this.words[0];return 2===this.length?S+=67108864*this.words[1]:3===this.length&&1===this.words[2]?S+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-S:S},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(S,C){return i(void 0!==m),this.toArrayLike(m,S,C)},n.prototype.toArray=function(S,C){return this.toArrayLike(Array,S,C)},n.prototype.toArrayLike=function(S,C,R){var D=this.byteLength(),j=R||Math.max(1,D);i(D<=j,"byte array longer than desired length"),i(j>0,"Requested array length <= 0"),this.strip();var q,Z,W="le"===C,G=new S(j),X=this.clone();if(W){for(Z=0;!X.isZero();Z++)q=X.andln(255),X.iushrn(8),G[Z]=q;for(;Z<j;Z++)G[Z]=0}else{for(Z=0;Z<j-D;Z++)G[Z]=0;for(Z=0;!X.isZero();Z++)q=X.andln(255),X.iushrn(8),G[j-Z-1]=q}return G},n.prototype._countBits=Math.clz32?function(S){return 32-Math.clz32(S)}:function(S){var C=S,R=0;return C>=4096&&(R+=13,C>>>=13),C>=64&&(R+=7,C>>>=7),C>=8&&(R+=4,C>>>=4),C>=2&&(R+=2,C>>>=2),R+C},n.prototype._zeroBits=function(S){if(0===S)return 26;var C=S,R=0;return 0==(8191&C)&&(R+=13,C>>>=13),0==(127&C)&&(R+=7,C>>>=7),0==(15&C)&&(R+=4,C>>>=4),0==(3&C)&&(R+=2,C>>>=2),0==(1&C)&&R++,R},n.prototype.bitLength=function(){var C=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+C},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,C=0;C<this.length;C++){var R=this._zeroBits(this.words[C]);if(S+=R,26!==R)break}return S},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(S){return 0!==this.negative?this.abs().inotn(S).iaddn(1):this.clone()},n.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var C=0;C<S.length;C++)this.words[C]=this.words[C]|S.words[C];return this.strip()},n.prototype.ior=function(S){return i(0==(this.negative|S.negative)),this.iuor(S)},n.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},n.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},n.prototype.iuand=function(S){var C;C=this.length>S.length?S:this;for(var R=0;R<C.length;R++)this.words[R]=this.words[R]&S.words[R];return this.length=C.length,this.strip()},n.prototype.iand=function(S){return i(0==(this.negative|S.negative)),this.iuand(S)},n.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},n.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},n.prototype.iuxor=function(S){var C,R;this.length>S.length?(C=this,R=S):(C=S,R=this);for(var D=0;D<R.length;D++)this.words[D]=C.words[D]^R.words[D];if(this!==C)for(;D<C.length;D++)this.words[D]=C.words[D];return this.length=C.length,this.strip()},n.prototype.ixor=function(S){return i(0==(this.negative|S.negative)),this.iuxor(S)},n.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},n.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},n.prototype.inotn=function(S){i("number"==typeof S&&S>=0);var C=0|Math.ceil(S/26),R=S%26;this._expand(C),R>0&&C--;for(var D=0;D<C;D++)this.words[D]=67108863&~this.words[D];return R>0&&(this.words[D]=~this.words[D]&67108863>>26-R),this.strip()},n.prototype.notn=function(S){return this.clone().inotn(S)},n.prototype.setn=function(S,C){i("number"==typeof S&&S>=0);var R=S/26|0,D=S%26;return this._expand(R+1),this.words[R]=C?this.words[R]|1<<D:this.words[R]&~(1<<D),this.strip()},n.prototype.iadd=function(S){var C,R,D;if(0!==this.negative&&0===S.negative)return this.negative=0,C=this.isub(S),this.negative^=1,this._normSign();if(0===this.negative&&0!==S.negative)return S.negative=0,C=this.isub(S),S.negative=1,C._normSign();this.length>S.length?(R=this,D=S):(R=S,D=this);for(var j=0,q=0;q<D.length;q++)this.words[q]=67108863&(C=(0|R.words[q])+(0|D.words[q])+j),j=C>>>26;for(;0!==j&&q<R.length;q++)this.words[q]=67108863&(C=(0|R.words[q])+j),j=C>>>26;if(this.length=R.length,0!==j)this.words[this.length]=j,this.length++;else if(R!==this)for(;q<R.length;q++)this.words[q]=R.words[q];return this},n.prototype.add=function(S){var C;return 0!==S.negative&&0===this.negative?(S.negative=0,C=this.sub(S),S.negative^=1,C):0===S.negative&&0!==this.negative?(this.negative=0,C=S.sub(this),this.negative=1,C):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},n.prototype.isub=function(S){if(0!==S.negative){S.negative=0;var C=this.iadd(S);return S.negative=1,C._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var R,D,j=this.cmp(S);if(0===j)return this.negative=0,this.length=1,this.words[0]=0,this;j>0?(R=this,D=S):(R=S,D=this);for(var q=0,Z=0;Z<D.length;Z++)q=(C=(0|R.words[Z])-(0|D.words[Z])+q)>>26,this.words[Z]=67108863&C;for(;0!==q&&Z<R.length;Z++)q=(C=(0|R.words[Z])+q)>>26,this.words[Z]=67108863&C;if(0===q&&Z<R.length&&R!==this)for(;Z<R.length;Z++)this.words[Z]=R.words[Z];return this.length=Math.max(this.length,Z),R!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(S){return this.clone().isub(S)};var a=function(S,C,R){var D,j,q,Z=S.words,W=C.words,G=R.words,X=0,ne=0|Z[0],V=8191&ne,N=ne>>>13,U=0|Z[1],ee=8191&U,B=U>>>13,K=0|Z[2],J=8191&K,te=K>>>13,ae=0|Z[3],ce=8191&ae,oe=ae>>>13,ve=0|Z[4],fe=8191&ve,xe=ve>>>13,Se=0|Z[5],pe=8191&Se,ge=Se>>>13,Te=0|Z[6],se=8191&Te,de=Te>>>13,Ae=0|Z[7],Le=8191&Ae,Me=Ae>>>13,De=0|Z[8],Oe=8191&De,Ie=De>>>13,Qe=0|Z[9],Ne=8191&Qe,Pe=Qe>>>13,Re=0|W[0],Ge=8191&Re,tt=Re>>>13,ct=0|W[1],wt=8191&ct,kt=ct>>>13,gt=0|W[2],at=8191&gt,et=gt>>>13,yt=0|W[3],Vt=8191&yt,Gt=yt>>>13,en=0|W[4],Jt=8191&en,cn=en>>>13,Rt=0|W[5],je=8191&Rt,Ye=Rt>>>13,he=0|W[6],be=8191&he,Fe=he>>>13,He=0|W[7],Ke=8191&He,Ze=He>>>13,ut=0|W[8],lt=8191&ut,Lt=ut>>>13,Ot=0|W[9],ot=8191&Ot,pt=Ot>>>13;R.negative=S.negative^C.negative,R.length=19;var qt=(X+(D=Math.imul(V,Ge))|0)+((8191&(j=(j=Math.imul(V,tt))+Math.imul(N,Ge)|0))<<13)|0;X=((q=Math.imul(N,tt))+(j>>>13)|0)+(qt>>>26)|0,qt&=67108863,D=Math.imul(ee,Ge),j=(j=Math.imul(ee,tt))+Math.imul(B,Ge)|0,q=Math.imul(B,tt);var St=(X+(D=D+Math.imul(V,wt)|0)|0)+((8191&(j=(j=j+Math.imul(V,kt)|0)+Math.imul(N,wt)|0))<<13)|0;X=((q=q+Math.imul(N,kt)|0)+(j>>>13)|0)+(St>>>26)|0,St&=67108863,D=Math.imul(J,Ge),j=(j=Math.imul(J,tt))+Math.imul(te,Ge)|0,q=Math.imul(te,tt),D=D+Math.imul(ee,wt)|0,j=(j=j+Math.imul(ee,kt)|0)+Math.imul(B,wt)|0,q=q+Math.imul(B,kt)|0;var Mt=(X+(D=D+Math.imul(V,at)|0)|0)+((8191&(j=(j=j+Math.imul(V,et)|0)+Math.imul(N,at)|0))<<13)|0;X=((q=q+Math.imul(N,et)|0)+(j>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,D=Math.imul(ce,Ge),j=(j=Math.imul(ce,tt))+Math.imul(oe,Ge)|0,q=Math.imul(oe,tt),D=D+Math.imul(J,wt)|0,j=(j=j+Math.imul(J,kt)|0)+Math.imul(te,wt)|0,q=q+Math.imul(te,kt)|0,D=D+Math.imul(ee,at)|0,j=(j=j+Math.imul(ee,et)|0)+Math.imul(B,at)|0,q=q+Math.imul(B,et)|0;var Ce=(X+(D=D+Math.imul(V,Vt)|0)|0)+((8191&(j=(j=j+Math.imul(V,Gt)|0)+Math.imul(N,Vt)|0))<<13)|0;X=((q=q+Math.imul(N,Gt)|0)+(j>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,D=Math.imul(fe,Ge),j=(j=Math.imul(fe,tt))+Math.imul(xe,Ge)|0,q=Math.imul(xe,tt),D=D+Math.imul(ce,wt)|0,j=(j=j+Math.imul(ce,kt)|0)+Math.imul(oe,wt)|0,q=q+Math.imul(oe,kt)|0,D=D+Math.imul(J,at)|0,j=(j=j+Math.imul(J,et)|0)+Math.imul(te,at)|0,q=q+Math.imul(te,et)|0,D=D+Math.imul(ee,Vt)|0,j=(j=j+Math.imul(ee,Gt)|0)+Math.imul(B,Vt)|0,q=q+Math.imul(B,Gt)|0;var Xe=(X+(D=D+Math.imul(V,Jt)|0)|0)+((8191&(j=(j=j+Math.imul(V,cn)|0)+Math.imul(N,Jt)|0))<<13)|0;X=((q=q+Math.imul(N,cn)|0)+(j>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,D=Math.imul(pe,Ge),j=(j=Math.imul(pe,tt))+Math.imul(ge,Ge)|0,q=Math.imul(ge,tt),D=D+Math.imul(fe,wt)|0,j=(j=j+Math.imul(fe,kt)|0)+Math.imul(xe,wt)|0,q=q+Math.imul(xe,kt)|0,D=D+Math.imul(ce,at)|0,j=(j=j+Math.imul(ce,et)|0)+Math.imul(oe,at)|0,q=q+Math.imul(oe,et)|0,D=D+Math.imul(J,Vt)|0,j=(j=j+Math.imul(J,Gt)|0)+Math.imul(te,Vt)|0,q=q+Math.imul(te,Gt)|0,D=D+Math.imul(ee,Jt)|0,j=(j=j+Math.imul(ee,cn)|0)+Math.imul(B,Jt)|0,q=q+Math.imul(B,cn)|0;var st=(X+(D=D+Math.imul(V,je)|0)|0)+((8191&(j=(j=j+Math.imul(V,Ye)|0)+Math.imul(N,je)|0))<<13)|0;X=((q=q+Math.imul(N,Ye)|0)+(j>>>13)|0)+(st>>>26)|0,st&=67108863,D=Math.imul(se,Ge),j=(j=Math.imul(se,tt))+Math.imul(de,Ge)|0,q=Math.imul(de,tt),D=D+Math.imul(pe,wt)|0,j=(j=j+Math.imul(pe,kt)|0)+Math.imul(ge,wt)|0,q=q+Math.imul(ge,kt)|0,D=D+Math.imul(fe,at)|0,j=(j=j+Math.imul(fe,et)|0)+Math.imul(xe,at)|0,q=q+Math.imul(xe,et)|0,D=D+Math.imul(ce,Vt)|0,j=(j=j+Math.imul(ce,Gt)|0)+Math.imul(oe,Vt)|0,q=q+Math.imul(oe,Gt)|0,D=D+Math.imul(J,Jt)|0,j=(j=j+Math.imul(J,cn)|0)+Math.imul(te,Jt)|0,q=q+Math.imul(te,cn)|0,D=D+Math.imul(ee,je)|0,j=(j=j+Math.imul(ee,Ye)|0)+Math.imul(B,je)|0,q=q+Math.imul(B,Ye)|0;var dt=(X+(D=D+Math.imul(V,be)|0)|0)+((8191&(j=(j=j+Math.imul(V,Fe)|0)+Math.imul(N,be)|0))<<13)|0;X=((q=q+Math.imul(N,Fe)|0)+(j>>>13)|0)+(dt>>>26)|0,dt&=67108863,D=Math.imul(Le,Ge),j=(j=Math.imul(Le,tt))+Math.imul(Me,Ge)|0,q=Math.imul(Me,tt),D=D+Math.imul(se,wt)|0,j=(j=j+Math.imul(se,kt)|0)+Math.imul(de,wt)|0,q=q+Math.imul(de,kt)|0,D=D+Math.imul(pe,at)|0,j=(j=j+Math.imul(pe,et)|0)+Math.imul(ge,at)|0,q=q+Math.imul(ge,et)|0,D=D+Math.imul(fe,Vt)|0,j=(j=j+Math.imul(fe,Gt)|0)+Math.imul(xe,Vt)|0,q=q+Math.imul(xe,Gt)|0,D=D+Math.imul(ce,Jt)|0,j=(j=j+Math.imul(ce,cn)|0)+Math.imul(oe,Jt)|0,q=q+Math.imul(oe,cn)|0,D=D+Math.imul(J,je)|0,j=(j=j+Math.imul(J,Ye)|0)+Math.imul(te,je)|0,q=q+Math.imul(te,Ye)|0,D=D+Math.imul(ee,be)|0,j=(j=j+Math.imul(ee,Fe)|0)+Math.imul(B,be)|0,q=q+Math.imul(B,Fe)|0;var zt=(X+(D=D+Math.imul(V,Ke)|0)|0)+((8191&(j=(j=j+Math.imul(V,Ze)|0)+Math.imul(N,Ke)|0))<<13)|0;X=((q=q+Math.imul(N,Ze)|0)+(j>>>13)|0)+(zt>>>26)|0,zt&=67108863,D=Math.imul(Oe,Ge),j=(j=Math.imul(Oe,tt))+Math.imul(Ie,Ge)|0,q=Math.imul(Ie,tt),D=D+Math.imul(Le,wt)|0,j=(j=j+Math.imul(Le,kt)|0)+Math.imul(Me,wt)|0,q=q+Math.imul(Me,kt)|0,D=D+Math.imul(se,at)|0,j=(j=j+Math.imul(se,et)|0)+Math.imul(de,at)|0,q=q+Math.imul(de,et)|0,D=D+Math.imul(pe,Vt)|0,j=(j=j+Math.imul(pe,Gt)|0)+Math.imul(ge,Vt)|0,q=q+Math.imul(ge,Gt)|0,D=D+Math.imul(fe,Jt)|0,j=(j=j+Math.imul(fe,cn)|0)+Math.imul(xe,Jt)|0,q=q+Math.imul(xe,cn)|0,D=D+Math.imul(ce,je)|0,j=(j=j+Math.imul(ce,Ye)|0)+Math.imul(oe,je)|0,q=q+Math.imul(oe,Ye)|0,D=D+Math.imul(J,be)|0,j=(j=j+Math.imul(J,Fe)|0)+Math.imul(te,be)|0,q=q+Math.imul(te,Fe)|0,D=D+Math.imul(ee,Ke)|0,j=(j=j+Math.imul(ee,Ze)|0)+Math.imul(B,Ke)|0,q=q+Math.imul(B,Ze)|0;var Ht=(X+(D=D+Math.imul(V,lt)|0)|0)+((8191&(j=(j=j+Math.imul(V,Lt)|0)+Math.imul(N,lt)|0))<<13)|0;X=((q=q+Math.imul(N,Lt)|0)+(j>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,D=Math.imul(Ne,Ge),j=(j=Math.imul(Ne,tt))+Math.imul(Pe,Ge)|0,q=Math.imul(Pe,tt),D=D+Math.imul(Oe,wt)|0,j=(j=j+Math.imul(Oe,kt)|0)+Math.imul(Ie,wt)|0,q=q+Math.imul(Ie,kt)|0,D=D+Math.imul(Le,at)|0,j=(j=j+Math.imul(Le,et)|0)+Math.imul(Me,at)|0,q=q+Math.imul(Me,et)|0,D=D+Math.imul(se,Vt)|0,j=(j=j+Math.imul(se,Gt)|0)+Math.imul(de,Vt)|0,q=q+Math.imul(de,Gt)|0,D=D+Math.imul(pe,Jt)|0,j=(j=j+Math.imul(pe,cn)|0)+Math.imul(ge,Jt)|0,q=q+Math.imul(ge,cn)|0,D=D+Math.imul(fe,je)|0,j=(j=j+Math.imul(fe,Ye)|0)+Math.imul(xe,je)|0,q=q+Math.imul(xe,Ye)|0,D=D+Math.imul(ce,be)|0,j=(j=j+Math.imul(ce,Fe)|0)+Math.imul(oe,be)|0,q=q+Math.imul(oe,Fe)|0,D=D+Math.imul(J,Ke)|0,j=(j=j+Math.imul(J,Ze)|0)+Math.imul(te,Ke)|0,q=q+Math.imul(te,Ze)|0,D=D+Math.imul(ee,lt)|0,j=(j=j+Math.imul(ee,Lt)|0)+Math.imul(B,lt)|0,q=q+Math.imul(B,Lt)|0;var Kt=(X+(D=D+Math.imul(V,ot)|0)|0)+((8191&(j=(j=j+Math.imul(V,pt)|0)+Math.imul(N,ot)|0))<<13)|0;X=((q=q+Math.imul(N,pt)|0)+(j>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,D=Math.imul(Ne,wt),j=(j=Math.imul(Ne,kt))+Math.imul(Pe,wt)|0,q=Math.imul(Pe,kt),D=D+Math.imul(Oe,at)|0,j=(j=j+Math.imul(Oe,et)|0)+Math.imul(Ie,at)|0,q=q+Math.imul(Ie,et)|0,D=D+Math.imul(Le,Vt)|0,j=(j=j+Math.imul(Le,Gt)|0)+Math.imul(Me,Vt)|0,q=q+Math.imul(Me,Gt)|0,D=D+Math.imul(se,Jt)|0,j=(j=j+Math.imul(se,cn)|0)+Math.imul(de,Jt)|0,q=q+Math.imul(de,cn)|0,D=D+Math.imul(pe,je)|0,j=(j=j+Math.imul(pe,Ye)|0)+Math.imul(ge,je)|0,q=q+Math.imul(ge,Ye)|0,D=D+Math.imul(fe,be)|0,j=(j=j+Math.imul(fe,Fe)|0)+Math.imul(xe,be)|0,q=q+Math.imul(xe,Fe)|0,D=D+Math.imul(ce,Ke)|0,j=(j=j+Math.imul(ce,Ze)|0)+Math.imul(oe,Ke)|0,q=q+Math.imul(oe,Ze)|0,D=D+Math.imul(J,lt)|0,j=(j=j+Math.imul(J,Lt)|0)+Math.imul(te,lt)|0,q=q+Math.imul(te,Lt)|0;var Zt=(X+(D=D+Math.imul(ee,ot)|0)|0)+((8191&(j=(j=j+Math.imul(ee,pt)|0)+Math.imul(B,ot)|0))<<13)|0;X=((q=q+Math.imul(B,pt)|0)+(j>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,D=Math.imul(Ne,at),j=(j=Math.imul(Ne,et))+Math.imul(Pe,at)|0,q=Math.imul(Pe,et),D=D+Math.imul(Oe,Vt)|0,j=(j=j+Math.imul(Oe,Gt)|0)+Math.imul(Ie,Vt)|0,q=q+Math.imul(Ie,Gt)|0,D=D+Math.imul(Le,Jt)|0,j=(j=j+Math.imul(Le,cn)|0)+Math.imul(Me,Jt)|0,q=q+Math.imul(Me,cn)|0,D=D+Math.imul(se,je)|0,j=(j=j+Math.imul(se,Ye)|0)+Math.imul(de,je)|0,q=q+Math.imul(de,Ye)|0,D=D+Math.imul(pe,be)|0,j=(j=j+Math.imul(pe,Fe)|0)+Math.imul(ge,be)|0,q=q+Math.imul(ge,Fe)|0,D=D+Math.imul(fe,Ke)|0,j=(j=j+Math.imul(fe,Ze)|0)+Math.imul(xe,Ke)|0,q=q+Math.imul(xe,Ze)|0,D=D+Math.imul(ce,lt)|0,j=(j=j+Math.imul(ce,Lt)|0)+Math.imul(oe,lt)|0,q=q+Math.imul(oe,Lt)|0;var vn=(X+(D=D+Math.imul(J,ot)|0)|0)+((8191&(j=(j=j+Math.imul(J,pt)|0)+Math.imul(te,ot)|0))<<13)|0;X=((q=q+Math.imul(te,pt)|0)+(j>>>13)|0)+(vn>>>26)|0,vn&=67108863,D=Math.imul(Ne,Vt),j=(j=Math.imul(Ne,Gt))+Math.imul(Pe,Vt)|0,q=Math.imul(Pe,Gt),D=D+Math.imul(Oe,Jt)|0,j=(j=j+Math.imul(Oe,cn)|0)+Math.imul(Ie,Jt)|0,q=q+Math.imul(Ie,cn)|0,D=D+Math.imul(Le,je)|0,j=(j=j+Math.imul(Le,Ye)|0)+Math.imul(Me,je)|0,q=q+Math.imul(Me,Ye)|0,D=D+Math.imul(se,be)|0,j=(j=j+Math.imul(se,Fe)|0)+Math.imul(de,be)|0,q=q+Math.imul(de,Fe)|0,D=D+Math.imul(pe,Ke)|0,j=(j=j+Math.imul(pe,Ze)|0)+Math.imul(ge,Ke)|0,q=q+Math.imul(ge,Ze)|0,D=D+Math.imul(fe,lt)|0,j=(j=j+Math.imul(fe,Lt)|0)+Math.imul(xe,lt)|0,q=q+Math.imul(xe,Lt)|0;var zn=(X+(D=D+Math.imul(ce,ot)|0)|0)+((8191&(j=(j=j+Math.imul(ce,pt)|0)+Math.imul(oe,ot)|0))<<13)|0;X=((q=q+Math.imul(oe,pt)|0)+(j>>>13)|0)+(zn>>>26)|0,zn&=67108863,D=Math.imul(Ne,Jt),j=(j=Math.imul(Ne,cn))+Math.imul(Pe,Jt)|0,q=Math.imul(Pe,cn),D=D+Math.imul(Oe,je)|0,j=(j=j+Math.imul(Oe,Ye)|0)+Math.imul(Ie,je)|0,q=q+Math.imul(Ie,Ye)|0,D=D+Math.imul(Le,be)|0,j=(j=j+Math.imul(Le,Fe)|0)+Math.imul(Me,be)|0,q=q+Math.imul(Me,Fe)|0,D=D+Math.imul(se,Ke)|0,j=(j=j+Math.imul(se,Ze)|0)+Math.imul(de,Ke)|0,q=q+Math.imul(de,Ze)|0,D=D+Math.imul(pe,lt)|0,j=(j=j+Math.imul(pe,Lt)|0)+Math.imul(ge,lt)|0,q=q+Math.imul(ge,Lt)|0;var gn=(X+(D=D+Math.imul(fe,ot)|0)|0)+((8191&(j=(j=j+Math.imul(fe,pt)|0)+Math.imul(xe,ot)|0))<<13)|0;X=((q=q+Math.imul(xe,pt)|0)+(j>>>13)|0)+(gn>>>26)|0,gn&=67108863,D=Math.imul(Ne,je),j=(j=Math.imul(Ne,Ye))+Math.imul(Pe,je)|0,q=Math.imul(Pe,Ye),D=D+Math.imul(Oe,be)|0,j=(j=j+Math.imul(Oe,Fe)|0)+Math.imul(Ie,be)|0,q=q+Math.imul(Ie,Fe)|0,D=D+Math.imul(Le,Ke)|0,j=(j=j+Math.imul(Le,Ze)|0)+Math.imul(Me,Ke)|0,q=q+Math.imul(Me,Ze)|0,D=D+Math.imul(se,lt)|0,j=(j=j+Math.imul(se,Lt)|0)+Math.imul(de,lt)|0,q=q+Math.imul(de,Lt)|0;var nn=(X+(D=D+Math.imul(pe,ot)|0)|0)+((8191&(j=(j=j+Math.imul(pe,pt)|0)+Math.imul(ge,ot)|0))<<13)|0;X=((q=q+Math.imul(ge,pt)|0)+(j>>>13)|0)+(nn>>>26)|0,nn&=67108863,D=Math.imul(Ne,be),j=(j=Math.imul(Ne,Fe))+Math.imul(Pe,be)|0,q=Math.imul(Pe,Fe),D=D+Math.imul(Oe,Ke)|0,j=(j=j+Math.imul(Oe,Ze)|0)+Math.imul(Ie,Ke)|0,q=q+Math.imul(Ie,Ze)|0,D=D+Math.imul(Le,lt)|0,j=(j=j+Math.imul(Le,Lt)|0)+Math.imul(Me,lt)|0,q=q+Math.imul(Me,Lt)|0;var an=(X+(D=D+Math.imul(se,ot)|0)|0)+((8191&(j=(j=j+Math.imul(se,pt)|0)+Math.imul(de,ot)|0))<<13)|0;X=((q=q+Math.imul(de,pt)|0)+(j>>>13)|0)+(an>>>26)|0,an&=67108863,D=Math.imul(Ne,Ke),j=(j=Math.imul(Ne,Ze))+Math.imul(Pe,Ke)|0,q=Math.imul(Pe,Ze),D=D+Math.imul(Oe,lt)|0,j=(j=j+Math.imul(Oe,Lt)|0)+Math.imul(Ie,lt)|0,q=q+Math.imul(Ie,Lt)|0;var on=(X+(D=D+Math.imul(Le,ot)|0)|0)+((8191&(j=(j=j+Math.imul(Le,pt)|0)+Math.imul(Me,ot)|0))<<13)|0;X=((q=q+Math.imul(Me,pt)|0)+(j>>>13)|0)+(on>>>26)|0,on&=67108863,D=Math.imul(Ne,lt),j=(j=Math.imul(Ne,Lt))+Math.imul(Pe,lt)|0,q=Math.imul(Pe,Lt);var mn=(X+(D=D+Math.imul(Oe,ot)|0)|0)+((8191&(j=(j=j+Math.imul(Oe,pt)|0)+Math.imul(Ie,ot)|0))<<13)|0;X=((q=q+Math.imul(Ie,pt)|0)+(j>>>13)|0)+(mn>>>26)|0,mn&=67108863;var _n=(X+(D=Math.imul(Ne,ot))|0)+((8191&(j=(j=Math.imul(Ne,pt))+Math.imul(Pe,ot)|0))<<13)|0;return X=((q=Math.imul(Pe,pt))+(j>>>13)|0)+(_n>>>26)|0,_n&=67108863,G[0]=qt,G[1]=St,G[2]=Mt,G[3]=Ce,G[4]=Xe,G[5]=st,G[6]=dt,G[7]=zt,G[8]=Ht,G[9]=Kt,G[10]=Zt,G[11]=vn,G[12]=zn,G[13]=gn,G[14]=nn,G[15]=an,G[16]=on,G[17]=mn,G[18]=_n,0!==X&&(G[19]=X,R.length++),R};function y(S,C,R){return(new h).mulp(S,C,R)}function h(S,C){this.x=S,this.y=C}Math.imul||(a=u),n.prototype.mulTo=function(S,C){var R=this.length+S.length;return 10===this.length&&10===S.length?a(this,S,C):R<63?u(this,S,C):R<1024?function(D,j,q){q.negative=j.negative^D.negative,q.length=D.length+j.length;for(var Z=0,W=0,G=0;G<q.length-1;G++){var X=W;W=0;for(var ne=67108863&Z,V=Math.min(G,j.length-1),N=Math.max(0,G-D.length+1);N<=V;N++){var ee=(0|D.words[G-N])*(0|j.words[N]),B=67108863&ee;ne=67108863&(B=B+ne|0),W+=(X=(X=X+(ee/67108864|0)|0)+(B>>>26)|0)>>>26,X&=67108863}q.words[G]=ne,Z=X,X=W}return 0!==Z?q.words[G]=Z:q.length--,q.strip()}(this,S,C):y(this,S,C)},h.prototype.makeRBT=function(S){for(var C=new Array(S),R=n.prototype._countBits(S)-1,D=0;D<S;D++)C[D]=this.revBin(D,R,S);return C},h.prototype.revBin=function(S,C,R){if(0===S||S===R-1)return S;for(var D=0,j=0;j<C;j++)D|=(1&S)<<C-j-1,S>>=1;return D},h.prototype.permute=function(S,C,R,D,j,q){for(var Z=0;Z<q;Z++)D[Z]=C[S[Z]],j[Z]=R[S[Z]]},h.prototype.transform=function(S,C,R,D,j,q){this.permute(q,S,C,R,D,j);for(var Z=1;Z<j;Z<<=1)for(var W=Z<<1,G=Math.cos(2*Math.PI/W),X=Math.sin(2*Math.PI/W),ne=0;ne<j;ne+=W)for(var V=G,N=X,U=0;U<Z;U++){var ee=R[ne+U],B=D[ne+U],K=R[ne+U+Z],J=D[ne+U+Z],te=V*K-N*J;J=V*J+N*K,R[ne+U]=ee+(K=te),D[ne+U]=B+J,R[ne+U+Z]=ee-K,D[ne+U+Z]=B-J,U!==W&&(te=G*V-X*N,N=G*N+X*V,V=te)}},h.prototype.guessLen13b=function(S,C){var R=1|Math.max(C,S),D=1&R,j=0;for(R=R/2|0;R;R>>>=1)j++;return 1<<j+1+D},h.prototype.conjugate=function(S,C,R){if(!(R<=1))for(var D=0;D<R/2;D++){var j=S[D];S[D]=S[R-D-1],S[R-D-1]=j,j=C[D],C[D]=-C[R-D-1],C[R-D-1]=-j}},h.prototype.normalize13b=function(S,C){for(var R=0,D=0;D<C/2;D++){var j=8192*Math.round(S[2*D+1]/C)+Math.round(S[2*D]/C)+R;S[D]=67108863&j,R=j<67108864?0:j/67108864|0}return S},h.prototype.convert13b=function(S,C,R,D){for(var j=0,q=0;q<C;q++)R[2*q]=8191&(j+=0|S[q]),R[2*q+1]=8191&(j>>>=13),j>>>=13;for(q=2*C;q<D;++q)R[q]=0;i(0===j),i(0==(-8192&j))},h.prototype.stub=function(S){for(var C=new Array(S),R=0;R<S;R++)C[R]=0;return C},h.prototype.mulp=function(S,C,R){var D=2*this.guessLen13b(S.length,C.length),j=this.makeRBT(D),q=this.stub(D),Z=new Array(D),W=new Array(D),G=new Array(D),X=new Array(D),ne=new Array(D),V=new Array(D),N=R.words;N.length=D,this.convert13b(S.words,S.length,Z,D),this.convert13b(C.words,C.length,X,D),this.transform(Z,q,W,G,D,j),this.transform(X,q,ne,V,D,j);for(var U=0;U<D;U++){var ee=W[U]*ne[U]-G[U]*V[U];G[U]=W[U]*V[U]+G[U]*ne[U],W[U]=ee}return this.conjugate(W,G,D),this.transform(W,G,N,q,D,j),this.conjugate(N,q,D),this.normalize13b(N,D),R.negative=S.negative^C.negative,R.length=S.length+C.length,R.strip()},n.prototype.mul=function(S){var C=new n(null);return C.words=new Array(this.length+S.length),this.mulTo(S,C)},n.prototype.mulf=function(S){var C=new n(null);return C.words=new Array(this.length+S.length),y(this,S,C)},n.prototype.imul=function(S){return this.clone().mulTo(S,this)},n.prototype.imuln=function(S){i("number"==typeof S),i(S<67108864);for(var C=0,R=0;R<this.length;R++){var D=(0|this.words[R])*S,j=(67108863&D)+(67108863&C);C>>=26,C+=D/67108864|0,C+=j>>>26,this.words[R]=67108863&j}return 0!==C&&(this.words[R]=C,this.length++),this},n.prototype.muln=function(S){return this.clone().imuln(S)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(S){var C=function(q){for(var Z=new Array(q.bitLength()),W=0;W<Z.length;W++){var X=W%26;Z[W]=(q.words[W/26|0]&1<<X)>>>X}return Z}(S);if(0===C.length)return new n(1);for(var R=this,D=0;D<C.length&&0===C[D];D++,R=R.sqr());if(++D<C.length)for(var j=R.sqr();D<C.length;D++,j=j.sqr())0!==C[D]&&(R=R.mul(j));return R},n.prototype.iushln=function(S){i("number"==typeof S&&S>=0);var C,R=S%26,D=(S-R)/26,j=67108863>>>26-R<<26-R;if(0!==R){var q=0;for(C=0;C<this.length;C++){var Z=this.words[C]&j;this.words[C]=(0|this.words[C])-Z<<R|q,q=Z>>>26-R}q&&(this.words[C]=q,this.length++)}if(0!==D){for(C=this.length-1;C>=0;C--)this.words[C+D]=this.words[C];for(C=0;C<D;C++)this.words[C]=0;this.length+=D}return this.strip()},n.prototype.ishln=function(S){return i(0===this.negative),this.iushln(S)},n.prototype.iushrn=function(S,C,R){var D;i("number"==typeof S&&S>=0),D=C?(C-C%26)/26:0;var j=S%26,q=Math.min((S-j)/26,this.length),Z=67108863^67108863>>>j<<j,W=R;if(D-=q,D=Math.max(0,D),W){for(var G=0;G<q;G++)W.words[G]=this.words[G];W.length=q}if(0!==q)if(this.length>q)for(this.length-=q,G=0;G<this.length;G++)this.words[G]=this.words[G+q];else this.words[0]=0,this.length=1;var X=0;for(G=this.length-1;G>=0&&(0!==X||G>=D);G--){var ne=0|this.words[G];this.words[G]=X<<26-j|ne>>>j,X=ne&Z}return W&&0!==X&&(W.words[W.length++]=X),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(S,C,R){return i(0===this.negative),this.iushrn(S,C,R)},n.prototype.shln=function(S){return this.clone().ishln(S)},n.prototype.ushln=function(S){return this.clone().iushln(S)},n.prototype.shrn=function(S){return this.clone().ishrn(S)},n.prototype.ushrn=function(S){return this.clone().iushrn(S)},n.prototype.testn=function(S){i("number"==typeof S&&S>=0);var C=S%26,R=(S-C)/26;return!(this.length<=R||!(this.words[R]&1<<C))},n.prototype.imaskn=function(S){i("number"==typeof S&&S>=0);var C=S%26,R=(S-C)/26;return i(0===this.negative,"imaskn works only with positive numbers"),this.length<=R?this:(0!==C&&R++,this.length=Math.min(R,this.length),0!==C&&(this.words[this.length-1]&=67108863^67108863>>>C<<C),this.strip())},n.prototype.maskn=function(S){return this.clone().imaskn(S)},n.prototype.iaddn=function(S){return i("number"==typeof S),i(S<67108864),S<0?this.isubn(-S):0!==this.negative?1===this.length&&(0|this.words[0])<S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},n.prototype._iaddn=function(S){this.words[0]+=S;for(var C=0;C<this.length&&this.words[C]>=67108864;C++)this.words[C]-=67108864,C===this.length-1?this.words[C+1]=1:this.words[C+1]++;return this.length=Math.max(this.length,C+1),this},n.prototype.isubn=function(S){if(i("number"==typeof S),i(S<67108864),S<0)return this.iaddn(-S);if(0!==this.negative)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var C=0;C<this.length&&this.words[C]<0;C++)this.words[C]+=67108864,this.words[C+1]-=1;return this.strip()},n.prototype.addn=function(S){return this.clone().iaddn(S)},n.prototype.subn=function(S){return this.clone().isubn(S)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(S,C,R){var D,j;this._expand(S.length+R);var Z=0;for(D=0;D<S.length;D++){j=(0|this.words[D+R])+Z;var W=(0|S.words[D])*C;Z=((j-=67108863&W)>>26)-(W/67108864|0),this.words[D+R]=67108863&j}for(;D<this.length-R;D++)Z=(j=(0|this.words[D+R])+Z)>>26,this.words[D+R]=67108863&j;if(0===Z)return this.strip();for(i(-1===Z),Z=0,D=0;D<this.length;D++)Z=(j=-(0|this.words[D])+Z)>>26,this.words[D]=67108863&j;return this.negative=1,this.strip()},n.prototype._wordDiv=function(S,C){var R,D=this.clone(),j=S,q=0|j.words[j.length-1];0!=(R=26-this._countBits(q))&&(j=j.ushln(R),D.iushln(R),q=0|j.words[j.length-1]);var Z,W=D.length-j.length;if("mod"!==C){(Z=new n(null)).length=W+1,Z.words=new Array(Z.length);for(var G=0;G<Z.length;G++)Z.words[G]=0}var X=D.clone()._ishlnsubmul(j,1,W);0===X.negative&&(D=X,Z&&(Z.words[W]=1));for(var ne=W-1;ne>=0;ne--){var V=67108864*(0|D.words[j.length+ne])+(0|D.words[j.length+ne-1]);for(V=Math.min(V/q|0,67108863),D._ishlnsubmul(j,V,ne);0!==D.negative;)V--,D.negative=0,D._ishlnsubmul(j,1,ne),D.isZero()||(D.negative^=1);Z&&(Z.words[ne]=V)}return Z&&Z.strip(),D.strip(),"div"!==C&&0!==R&&D.iushrn(R),{div:Z||null,mod:D}},n.prototype.divmod=function(S,C,R){return i(!S.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===S.negative?(q=this.neg().divmod(S,C),"mod"!==C&&(D=q.div.neg()),"div"!==C&&(j=q.mod.neg(),R&&0!==j.negative&&j.iadd(S)),{div:D,mod:j}):0===this.negative&&0!==S.negative?(q=this.divmod(S.neg(),C),"mod"!==C&&(D=q.div.neg()),{div:D,mod:q.mod}):0!=(this.negative&S.negative)?(q=this.neg().divmod(S.neg(),C),"div"!==C&&(j=q.mod.neg(),R&&0!==j.negative&&j.isub(S)),{div:q.div,mod:j}):S.length>this.length||this.cmp(S)<0?{div:new n(0),mod:this}:1===S.length?"div"===C?{div:this.divn(S.words[0]),mod:null}:"mod"===C?{div:null,mod:new n(this.modn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new n(this.modn(S.words[0]))}:this._wordDiv(S,C);var D,j,q},n.prototype.div=function(S){return this.divmod(S,"div",!1).div},n.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},n.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},n.prototype.divRound=function(S){var C=this.divmod(S);if(C.mod.isZero())return C.div;var R=0!==C.div.negative?C.mod.isub(S):C.mod,D=S.ushrn(1),j=S.andln(1),q=R.cmp(D);return q<0||1===j&&0===q?C.div:0!==C.div.negative?C.div.isubn(1):C.div.iaddn(1)},n.prototype.modn=function(S){i(S<=67108863);for(var C=(1<<26)%S,R=0,D=this.length-1;D>=0;D--)R=(C*R+(0|this.words[D]))%S;return R},n.prototype.idivn=function(S){i(S<=67108863);for(var C=0,R=this.length-1;R>=0;R--){var D=(0|this.words[R])+67108864*C;this.words[R]=D/S|0,C=D%S}return this.strip()},n.prototype.divn=function(S){return this.clone().idivn(S)},n.prototype.egcd=function(S){i(0===S.negative),i(!S.isZero());var C=this,R=S.clone();C=0!==C.negative?C.umod(S):C.clone();for(var D=new n(1),j=new n(0),q=new n(0),Z=new n(1),W=0;C.isEven()&&R.isEven();)C.iushrn(1),R.iushrn(1),++W;for(var G=R.clone(),X=C.clone();!C.isZero();){for(var ne=0,V=1;0==(C.words[0]&V)&&ne<26;++ne,V<<=1);if(ne>0)for(C.iushrn(ne);ne-- >0;)(D.isOdd()||j.isOdd())&&(D.iadd(G),j.isub(X)),D.iushrn(1),j.iushrn(1);for(var N=0,U=1;0==(R.words[0]&U)&&N<26;++N,U<<=1);if(N>0)for(R.iushrn(N);N-- >0;)(q.isOdd()||Z.isOdd())&&(q.iadd(G),Z.isub(X)),q.iushrn(1),Z.iushrn(1);C.cmp(R)>=0?(C.isub(R),D.isub(q),j.isub(Z)):(R.isub(C),q.isub(D),Z.isub(j))}return{a:q,b:Z,gcd:R.iushln(W)}},n.prototype._invmp=function(S){i(0===S.negative),i(!S.isZero());var C=this,R=S.clone();C=0!==C.negative?C.umod(S):C.clone();for(var D,j=new n(1),q=new n(0),Z=R.clone();C.cmpn(1)>0&&R.cmpn(1)>0;){for(var W=0,G=1;0==(C.words[0]&G)&&W<26;++W,G<<=1);if(W>0)for(C.iushrn(W);W-- >0;)j.isOdd()&&j.iadd(Z),j.iushrn(1);for(var X=0,ne=1;0==(R.words[0]&ne)&&X<26;++X,ne<<=1);if(X>0)for(R.iushrn(X);X-- >0;)q.isOdd()&&q.iadd(Z),q.iushrn(1);C.cmp(R)>=0?(C.isub(R),j.isub(q)):(R.isub(C),q.isub(j))}return(D=0===C.cmpn(1)?j:q).cmpn(0)<0&&D.iadd(S),D},n.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var C=this.clone(),R=S.clone();C.negative=0,R.negative=0;for(var D=0;C.isEven()&&R.isEven();D++)C.iushrn(1),R.iushrn(1);for(;;){for(;C.isEven();)C.iushrn(1);for(;R.isEven();)R.iushrn(1);var j=C.cmp(R);if(j<0){var q=C;C=R,R=q}else if(0===j||0===R.cmpn(1))break;C.isub(R)}return R.iushln(D)},n.prototype.invm=function(S){return this.egcd(S).a.umod(S)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(S){return this.words[0]&S},n.prototype.bincn=function(S){i("number"==typeof S);var C=S%26,R=(S-C)/26,D=1<<C;if(this.length<=R)return this._expand(R+1),this.words[R]|=D,this;for(var j=D,q=R;0!==j&&q<this.length;q++){var Z=0|this.words[q];j=(Z+=j)>>>26,this.words[q]=Z&=67108863}return 0!==j&&(this.words[q]=j,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(S){var C,R=S<0;if(0!==this.negative&&!R)return-1;if(0===this.negative&&R)return 1;if(this.strip(),this.length>1)C=1;else{R&&(S=-S),i(S<=67108863,"Number is too big");var D=0|this.words[0];C=D===S?0:D<S?-1:1}return 0!==this.negative?0|-C:C},n.prototype.cmp=function(S){if(0!==this.negative&&0===S.negative)return-1;if(0===this.negative&&0!==S.negative)return 1;var C=this.ucmp(S);return 0!==this.negative?0|-C:C},n.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var C=0,R=this.length-1;R>=0;R--){var D=0|this.words[R],j=0|S.words[R];if(D!==j){D<j?C=-1:D>j&&(C=1);break}}return C},n.prototype.gtn=function(S){return 1===this.cmpn(S)},n.prototype.gt=function(S){return 1===this.cmp(S)},n.prototype.gten=function(S){return this.cmpn(S)>=0},n.prototype.gte=function(S){return this.cmp(S)>=0},n.prototype.ltn=function(S){return-1===this.cmpn(S)},n.prototype.lt=function(S){return-1===this.cmp(S)},n.prototype.lten=function(S){return this.cmpn(S)<=0},n.prototype.lte=function(S){return this.cmp(S)<=0},n.prototype.eqn=function(S){return 0===this.cmpn(S)},n.prototype.eq=function(S){return 0===this.cmp(S)},n.red=function(S){return new P(S)},n.prototype.toRed=function(S){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),S.convertTo(this)._forceRed(S)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(S){return this.red=S,this},n.prototype.forceRed=function(S){return i(!this.red,"Already a number in reduction context"),this._forceRed(S)},n.prototype.redAdd=function(S){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},n.prototype.redIAdd=function(S){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},n.prototype.redSub=function(S){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},n.prototype.redISub=function(S){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},n.prototype.redShl=function(S){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},n.prototype.redMul=function(S){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},n.prototype.redIMul=function(S){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(S){return i(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var _={k256:null,p224:null,p192:null,p25519:null};function b(S,C){this.name=S,this.p=new n(C,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function M(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function P(S){if("string"==typeof S){var C=n._prime(S);this.m=C.p,this.prime=C}else i(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function z(S){P.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var S=new n(null);return S.words=new Array(Math.ceil(this.n/13)),S},b.prototype.ireduce=function(S){var C,R=S;do{this.split(R,this.tmp),C=(R=(R=this.imulK(R)).iadd(this.tmp)).bitLength()}while(C>this.n);var D=C<this.n?-1:R.ucmp(this.p);return 0===D?(R.words[0]=0,R.length=1):D>0?R.isub(this.p):void 0!==R.strip?R.strip():R._strip(),R},b.prototype.split=function(S,C){S.iushrn(this.n,0,C)},b.prototype.imulK=function(S){return S.imul(this.k)},c(w,b),w.prototype.split=function(S,C){for(var R=Math.min(S.length,9),D=0;D<R;D++)C.words[D]=S.words[D];if(C.length=R,S.length<=9)return S.words[0]=0,void(S.length=1);var j=S.words[9];for(C.words[C.length++]=4194303&j,D=10;D<S.length;D++){var q=0|S.words[D];S.words[D-10]=(4194303&q)<<4|j>>>22,j=q}S.words[D-10]=j>>>=22,S.length-=0===j&&S.length>10?10:9},w.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var C=0,R=0;R<S.length;R++){var D=0|S.words[R];S.words[R]=67108863&(C+=977*D),C=64*D+(C/67108864|0)}return 0===S.words[S.length-1]&&(S.length--,0===S.words[S.length-1]&&S.length--),S},c(T,b),c(L,b),c(M,b),M.prototype.imulK=function(S){for(var C=0,R=0;R<S.length;R++){var D=19*(0|S.words[R])+C,j=67108863&D;D>>>=26,S.words[R]=j,C=D}return 0!==C&&(S.words[S.length++]=C),S},n._prime=function(S){if(_[S])return _[S];var C;if("k256"===S)C=new w;else if("p224"===S)C=new T;else if("p192"===S)C=new L;else{if("p25519"!==S)throw new Error("Unknown prime "+S);C=new M}return _[S]=C,C},P.prototype._verify1=function(S){i(0===S.negative,"red works only with positives"),i(S.red,"red works only with red numbers")},P.prototype._verify2=function(S,C){i(0==(S.negative|C.negative),"red works only with positives"),i(S.red&&S.red===C.red,"red works only with red numbers")},P.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):S.umod(this.m)._forceRed(this)},P.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},P.prototype.add=function(S,C){this._verify2(S,C);var R=S.add(C);return R.cmp(this.m)>=0&&R.isub(this.m),R._forceRed(this)},P.prototype.iadd=function(S,C){this._verify2(S,C);var R=S.iadd(C);return R.cmp(this.m)>=0&&R.isub(this.m),R},P.prototype.sub=function(S,C){this._verify2(S,C);var R=S.sub(C);return R.cmpn(0)<0&&R.iadd(this.m),R._forceRed(this)},P.prototype.isub=function(S,C){this._verify2(S,C);var R=S.isub(C);return R.cmpn(0)<0&&R.iadd(this.m),R},P.prototype.shl=function(S,C){return this._verify1(S),this.imod(S.ushln(C))},P.prototype.imul=function(S,C){return this._verify2(S,C),this.imod(S.imul(C))},P.prototype.mul=function(S,C){return this._verify2(S,C),this.imod(S.mul(C))},P.prototype.isqr=function(S){return this.imul(S,S.clone())},P.prototype.sqr=function(S){return this.mul(S,S)},P.prototype.sqrt=function(S){if(S.isZero())return S.clone();var C=this.m.andln(3);if(i(C%2==1),3===C){var R=this.m.add(new n(1)).iushrn(2);return this.pow(S,R)}for(var D=this.m.subn(1),j=0;!D.isZero()&&0===D.andln(1);)j++,D.iushrn(1);i(!D.isZero());var q=new n(1).toRed(this),Z=q.redNeg(),W=this.m.subn(1).iushrn(1),G=this.m.bitLength();for(G=new n(2*G*G).toRed(this);0!==this.pow(G,W).cmp(Z);)G.redIAdd(Z);for(var X=this.pow(G,D),ne=this.pow(S,D.addn(1).iushrn(1)),V=this.pow(S,D),N=j;0!==V.cmp(q);){for(var U=V,ee=0;0!==U.cmp(q);ee++)U=U.redSqr();i(ee<N);var B=this.pow(X,new n(1).iushln(N-ee-1));ne=ne.redMul(B),X=B.redSqr(),V=V.redMul(X),N=ee}return ne},P.prototype.invm=function(S){var C=S._invmp(this.m);return 0!==C.negative?(C.negative=0,this.imod(C).redNeg()):this.imod(C)},P.prototype.pow=function(S,C){if(C.isZero())return new n(1).toRed(this);if(0===C.cmpn(1))return S.clone();var R=new Array(16);R[0]=new n(1).toRed(this),R[1]=S;for(var D=2;D<R.length;D++)R[D]=this.mul(R[D-1],S);var j=R[0],q=0,Z=0,W=C.bitLength()%26;for(0===W&&(W=26),D=C.length-1;D>=0;D--){for(var G=C.words[D],X=W-1;X>=0;X--){var ne=G>>X&1;j!==R[0]&&(j=this.sqr(j)),0!==ne||0!==q?(q<<=1,q|=ne,(4==++Z||0===D&&0===X)&&(j=this.mul(j,R[q]),Z=0,q=0)):Z=0}W=26}return j},P.prototype.convertTo=function(S){var C=S.umod(this.m);return C===S?C.clone():C},P.prototype.convertFrom=function(S){var C=S.clone();return C.red=null,C},n.mont=function(S){return new z(S)},c(z,P),z.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},z.prototype.convertFrom=function(S){var C=this.imod(S.mul(this.rinv));return C.red=null,C},z.prototype.imul=function(S,C){if(S.isZero()||C.isZero())return S.words[0]=0,S.length=1,S;var R=S.imul(C),D=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=R.isub(D).iushrn(this.shift),q=j;return j.cmp(this.m)>=0?q=j.isub(this.m):j.cmpn(0)<0&&(q=j.iadd(this.m)),q._forceRed(this)},z.prototype.mul=function(S,C){if(S.isZero()||C.isZero())return new n(0)._forceRed(this);var R=S.mul(C),D=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=R.isub(D).iushrn(this.shift),q=j;return j.cmp(this.m)>=0?q=j.isub(this.m):j.cmpn(0)<0&&(q=j.iadd(this.m)),q._forceRed(this)},z.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===k||k,this)},{buffer:2}],34:[function(t,k,x){"use strict";k.exports=function(e){var r,i,c,n=e.length,m=0;for(r=0;r<n;++r)m+=e[r].length;var p=new Array(m),s=0;for(r=0;r<n;++r){var f=e[r],l=f.length;for(i=0;i<l;++i){var o=p[s++]=new Array(l-1),d=0;for(c=0;c<l;++c)c!==i&&(o[d++]=f[c]);if(1&i){var u=o[1];o[1]=o[0],o[0]=u}}}return p}},{}],35:[function(t,k,x){"use strict";k.exports=function(o,d,u){switch(arguments.length){case 1:return f(o);case 2:return"function"==typeof d?p(o,o,d,!0):l(o,d);case 3:return p(o,d,u,!1);default:throw new Error("box-intersect: Invalid arguments")}};var e,r=t("typedarray-pool"),i=t("./lib/sweep"),c=t("./lib/intersect");function n(o,d){for(var u=0;u<o;++u)if(!(d[u]<=d[u+o]))return!0;return!1}function m(o,d,u,a){for(var y=0,h=0,_=0,b=o.length;_<b;++_){var w=o[_];if(!n(d,w)){for(var T=0;T<2*d;++T)u[y++]=w[T];a[h++]=_}}return h}function p(o,d,u,a){var y=o.length,h=d.length;if(!(y<=0||h<=0)){var _=o[0].length>>>1;if(!(_<=0)){var b,w=r.mallocDouble(2*_*y),T=r.mallocInt32(y);if((y=m(o,_,w,T))>0){if(1===_&&a)i.init(y),b=i.sweepComplete(_,u,0,y,w,T,0,y,w,T);else{var L=r.mallocDouble(2*_*h),M=r.mallocInt32(h);(h=m(d,_,L,M))>0&&(i.init(y+h),b=1===_?i.sweepBipartite(_,u,0,y,w,T,0,h,L,M):c(_,u,a,y,w,T,h,L,M),r.free(L),r.free(M))}r.free(w),r.free(T)}return b}}}function s(o,d){e.push([o,d])}function f(o){return e=[],p(o,o,s,!0),e}function l(o,d){return e=[],p(o,d,s,!1),e}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(t,k,x){"use strict";function e(r){return r?function(i,c,n,m,p,s,f,l,o,d,u){return p-m>o-l?function(a,y,h,_,b,w,T,L,M,P,z){for(var S=2*a,C=_,R=S*_;C<b;++C,R+=S){var D=w[y+R],j=w[y+R+a],q=T[C];e:for(var Z=L,W=S*L;Z<M;++Z,W+=S){var ne=z[Z];if(!(P[y+W+a]<D||j<P[y+W])){for(var V=y+1;V<a;++V)if(w[V+a+R]<P[V+W]||P[V+a+W]<w[V+R])continue e;var K=h(q,ne);if(void 0!==K)return K}}}}(i,c,n,m,p,s,f,l,o,d,u):function(a,y,h,_,b,w,T,L,M,P,z){for(var S=2*a,C=L,R=S*L;C<M;++C,R+=S){var D=P[y+R],j=P[y+R+a],q=z[C];e:for(var Z=_,W=S*_;Z<b;++Z,W+=S){var ne=T[Z];if(!(j<w[y+W]||w[y+W+a]<D)){for(var V=y+1;V<a;++V)if(w[V+a+W]<P[V+R]||P[V+a+R]<w[V+W])continue e;var K=h(ne,q);if(void 0!==K)return K}}}}(i,c,n,m,p,s,f,l,o,d,u)}:function(i,c,n,m,p,s,f,l,o,d,u,a){return s-p>d-o?m?function(y,h,_,b,w,T,L,M,P,z,S){for(var C=2*y,R=b,D=C*b;R<w;++R,D+=C){var j=T[h+D],q=T[h+D+y],Z=L[R];e:for(var W=M,G=C*M;W<P;++W,G+=C){var X=z[h+G],ne=S[W];if(!(X<=j||q<X)){for(var V=h+1;V<y;++V)if(T[V+y+D]<z[V+G]||z[V+y+G]<T[V+D])continue e;var K=_(ne,Z);if(void 0!==K)return K}}}}(i,c,n,p,s,f,l,o,d,u,a):function(y,h,_,b,w,T,L,M,P,z,S){for(var C=2*y,R=b,D=C*b;R<w;++R,D+=C){var j=T[h+D],q=T[h+D+y],Z=L[R];e:for(var W=M,G=C*M;W<P;++W,G+=C){var X=z[h+G],ne=S[W];if(!(X<j||q<X)){for(var V=h+1;V<y;++V)if(T[V+y+D]<z[V+G]||z[V+y+G]<T[V+D])continue e;var K=_(Z,ne);if(void 0!==K)return K}}}}(i,c,n,p,s,f,l,o,d,u,a):m?function(y,h,_,b,w,T,L,M,P,z,S){for(var C=2*y,R=M,D=C*M;R<P;++R,D+=C){var j=z[h+D],q=S[R];e:for(var Z=b,W=C*b;Z<w;++Z,W+=C){var ne=L[Z];if(!(j<=T[h+W]||T[h+W+y]<j)){for(var V=h+1;V<y;++V)if(T[V+y+W]<z[V+D]||z[V+y+D]<T[V+W])continue e;var K=_(q,ne);if(void 0!==K)return K}}}}(i,c,n,p,s,f,l,o,d,u,a):function(y,h,_,b,w,T,L,M,P,z,S){for(var C=2*y,R=M,D=C*M;R<P;++R,D+=C){var j=z[h+D],q=S[R];e:for(var Z=b,W=C*b;Z<w;++Z,W+=C){var ne=L[Z];if(!(j<T[h+W]||T[h+W+y]<j)){for(var V=h+1;V<y;++V)if(T[V+y+W]<z[V+D]||z[V+y+D]<T[V+W])continue e;var K=_(ne,q);if(void 0!==K)return K}}}}(i,c,n,p,s,f,l,o,d,u,a)}}x.partial=e(!1),x.full=e(!0)},{}],37:[function(t,k,x){"use strict";k.exports=function(T,L,M,P,z,S,C,R,D){!function(Ae,Le){var Me=8*r.log2(Le+1)*(Ae+1)|0,De=r.nextPow2(6*Me);y.length<De&&(e.free(y),y=e.mallocInt32(De));var Oe=r.nextPow2(2*Me);h.length<Oe&&(e.free(h),h=e.mallocDouble(Oe))}(T,P+C);var j,q=0,Z=2*T;for(_(q++,0,0,P,0,C,M?16:0,-1/0,1/0),M||_(q++,0,0,C,0,P,1,-1/0,1/0);q>0;){var W=6*(q-=1),G=y[W],X=y[W+1],ne=y[W+2],V=y[W+3],N=y[W+4],U=y[W+5],ee=2*q,B=h[ee],K=h[ee+1],J=1&U,te=!!(16&U),ae=z,ce=S,oe=R,ve=D;if(J&&(ae=R,ce=D,oe=z,ve=S),!(2&U&&(ne=o(T,G,X,ne,ae,ce,K),X>=ne)||4&U&&(X=d(T,G,X,ne,ae,ce,B))>=ne)){var fe=ne-X,xe=N-V;if(te){if(T*fe*(fe+xe)<1<<22){if(void 0!==(j=m.scanComplete(T,G,L,X,ne,ae,ce,V,N,oe,ve)))return j;continue}}else{if(T*Math.min(fe,xe)<128){if(void 0!==(j=c(T,G,L,J,X,ne,ae,ce,V,N,oe,ve)))return j;continue}if(T*fe*xe<1<<22){if(void 0!==(j=m.scanBipartite(T,G,L,J,X,ne,ae,ce,V,N,oe,ve)))return j;continue}}var Se=f(T,G,X,ne,ae,ce,B,K);if(X<Se)if(T*(Se-X)<128){if(void 0!==(j=n(T,G+1,L,X,Se,ae,ce,V,N,oe,ve)))return j}else if(G===T-2){if(void 0!==(j=J?m.sweepBipartite(T,L,V,N,oe,ve,X,Se,ae,ce):m.sweepBipartite(T,L,X,Se,ae,ce,V,N,oe,ve)))return j}else _(q++,G+1,X,Se,V,N,J,-1/0,1/0),_(q++,G+1,V,N,X,Se,1^J,-1/0,1/0);if(Se<ne){var pe=p(T,G,V,N,oe,ve),ge=oe[Z*pe+G],Te=l(T,G,pe,N,oe,ve,ge);if(Te<N&&_(q++,G,Se,ne,Te,N,(4|J)+(te?16:0),ge,K),V<pe&&_(q++,G,Se,ne,V,pe,(2|J)+(te?16:0),B,ge),pe+1===Te){if(void 0!==(j=te?w(T,G,L,Se,ne,ae,ce,pe,oe,ve[pe]):b(T,G,L,J,Se,ne,ae,ce,pe,oe,ve[pe])))return j}else if(pe<Te){var se;if(te){if(Se<(se=u(T,G,Se,ne,ae,ce,ge))){var de=l(T,G,Se,se,ae,ce,ge);if(G===T-2){if(Se<de&&void 0!==(j=m.sweepComplete(T,L,Se,de,ae,ce,pe,Te,oe,ve))||de<se&&void 0!==(j=m.sweepBipartite(T,L,de,se,ae,ce,pe,Te,oe,ve)))return j}else Se<de&&_(q++,G+1,Se,de,pe,Te,16,-1/0,1/0),de<se&&(_(q++,G+1,de,se,pe,Te,0,-1/0,1/0),_(q++,G+1,pe,Te,de,se,1,-1/0,1/0))}}else Se<(se=J?a(T,G,Se,ne,ae,ce,ge):u(T,G,Se,ne,ae,ce,ge))&&(G===T-2?j=J?m.sweepBipartite(T,L,pe,Te,oe,ve,Se,se,ae,ce):m.sweepBipartite(T,L,Se,se,ae,ce,pe,Te,oe,ve):(_(q++,G+1,Se,se,pe,Te,J,-1/0,1/0),_(q++,G+1,pe,Te,Se,se,1^J,-1/0,1/0)))}}}}};var e=t("typedarray-pool"),r=t("bit-twiddle"),i=t("./brute"),c=i.partial,n=i.full,m=t("./sweep"),p=t("./median"),s=t("./partition"),f=s("!(lo>=p0)&&!(p1>=hi)"),l=s("lo===p0"),o=s("lo<p0"),d=s("hi<=p0"),u=s("lo<=p0&&p0<=hi"),a=s("lo<p0&&p0<=hi"),y=e.mallocInt32(1024),h=e.mallocDouble(1024);function _(T,L,M,P,z,S,C,R,D){var j=6*T;y[j]=L,y[j+1]=M,y[j+2]=P,y[j+3]=z,y[j+4]=S,y[j+5]=C;var q=2*T;h[q]=R,h[q+1]=D}function b(T,L,M,P,z,S,C,R,D,j,q){var Z=2*T,W=D*Z,G=j[W+L];e:for(var X=z,ne=z*Z;X<S;++X,ne+=Z){var V=C[ne+L],N=C[ne+L+T];if(!(G<V||N<G||P&&G===V)){for(var U,ee=R[X],B=L+1;B<T;++B)if(V=C[ne+B],(N=C[ne+B+T])<j[W+B]||j[W+B+T]<V)continue e;if(void 0!==(U=P?M(q,ee):M(ee,q)))return U}}}function w(T,L,M,P,z,S,C,R,D,j){var q=2*T,Z=R*q,W=D[Z+L];e:for(var G=P,X=P*q;G<z;++G,X+=q){var ne=C[G];if(ne!==j){var V=S[X+L],N=S[X+L+T];if(!(W<V||N<W)){for(var U=L+1;U<T;++U)if(V=S[X+U],(N=S[X+U+T])<D[Z+U]||D[Z+U+T]<V)continue e;var K=M(ne,j);if(void 0!==K)return K}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(t,k,x){"use strict";k.exports=function(i,c,n,m,p,s){if(m<=n+1)return n;for(var f=n,l=m,o=m+n>>>1,d=2*i,u=o,a=p[d*o+c];f<l;){if(l-f<8){r(i,c,f,l,p,s),a=p[d*o+c];break}var y=l-f,h=Math.random()*y+f|0,_=p[d*h+c],b=Math.random()*y+f|0,w=p[d*b+c],T=Math.random()*y+f|0,L=p[d*T+c];_<=w?L>=w?(u=b,a=w):_>=L?(u=h,a=_):(u=T,a=L):w>=L?(u=b,a=w):L>=_?(u=h,a=_):(u=T,a=L);for(var M=d*(l-1),P=d*u,z=0;z<d;++z,++M,++P){var S=p[M];p[M]=p[P],p[P]=S}var C=s[l-1];for(s[l-1]=s[u],s[u]=C,M=d*(l-1),P=d*(u=e(i,c,f,l-1,p,s,a)),z=0;z<d;++z,++M,++P)S=p[M],p[M]=p[P],p[P]=S;if(C=s[l-1],s[l-1]=s[u],s[u]=C,o<u){for(l=u-1;f<l&&p[d*(l-1)+c]===a;)l-=1;l+=1}else{if(!(u<o))break;for(f=u+1;f<l&&p[d*f+c]===a;)f+=1}}return e(i,c,n,o,p,s,p[d*o+c])};var e=t("./partition")("lo<p0");function r(i,c,n,m,p,s){for(var f=2*i,l=f*(n+1)+c,o=n+1;o<m;++o,l+=f)for(var d=p[l],u=o,a=f*(o-1);u>n&&p[a+c]>d;--u,a-=f){for(var y=a,h=a+f,_=0;_<f;++_,++y,++h){var b=p[y];p[y]=p[h],p[h]=b}var w=s[u];s[u]=s[u-1],s[u-1]=w}}},{"./partition":39}],39:[function(t,k,x){"use strict";k.exports=function(r){return e[r]};var e={"lo===p0":function(r,i,c,n,m,p,s){for(var f=2*r,l=f*c,o=l,d=c,u=i,a=c;n>a;++a,l+=f)if(m[l+u]===s)if(d===a)d+=1,o+=f;else{for(var y=0;f>y;++y){var h=m[l+y];m[l+y]=m[o],m[o++]=h}var _=p[a];p[a]=p[d],p[d++]=_}return d},"lo<p0":function(r,i,c,n,m,p,s){for(var f=2*r,l=f*c,o=l,d=c,u=i,a=c;n>a;++a,l+=f)if(m[l+u]<s)if(d===a)d+=1,o+=f;else{for(var y=0;f>y;++y){var h=m[l+y];m[l+y]=m[o],m[o++]=h}var _=p[a];p[a]=p[d],p[d++]=_}return d},"lo<=p0":function(r,i,c,n,m,p,s){for(var f=2*r,l=f*c,o=l,d=c,u=r+i,a=c;n>a;++a,l+=f)if(m[l+u]<=s)if(d===a)d+=1,o+=f;else{for(var y=0;f>y;++y){var h=m[l+y];m[l+y]=m[o],m[o++]=h}var _=p[a];p[a]=p[d],p[d++]=_}return d},"hi<=p0":function(r,i,c,n,m,p,s){for(var f=2*r,l=f*c,o=l,d=c,u=r+i,a=c;n>a;++a,l+=f)if(m[l+u]<=s)if(d===a)d+=1,o+=f;else{for(var y=0;f>y;++y){var h=m[l+y];m[l+y]=m[o],m[o++]=h}var _=p[a];p[a]=p[d],p[d++]=_}return d},"lo<p0&&p0<=hi":function(r,i,c,n,m,p,s){for(var f=2*r,l=f*c,o=l,d=c,u=i,a=r+i,y=c;n>y;++y,l+=f)if(m[l+u]<s&&s<=m[l+a])if(d===y)d+=1,o+=f;else{for(var b=0;f>b;++b){var w=m[l+b];m[l+b]=m[o],m[o++]=w}var T=p[y];p[y]=p[d],p[d++]=T}return d},"lo<=p0&&p0<=hi":function(r,i,c,n,m,p,s){for(var f=2*r,l=f*c,o=l,d=c,u=i,a=r+i,y=c;n>y;++y,l+=f)if(m[l+u]<=s&&s<=m[l+a])if(d===y)d+=1,o+=f;else{for(var b=0;f>b;++b){var w=m[l+b];m[l+b]=m[o],m[o++]=w}var T=p[y];p[y]=p[d],p[d++]=T}return d},"!(lo>=p0)&&!(p1>=hi)":function(r,i,c,n,m,p,s,f){for(var l=2*r,o=l*c,d=o,u=c,a=i,y=r+i,h=c;n>h;++h,o+=l)if(!(m[o+a]>=s||f>=m[o+y]))if(u===h)u+=1,d+=l;else{for(var w=0;l>w;++w){var T=m[o+w];m[o+w]=m[d],m[d++]=T}var L=p[h];p[h]=p[u],p[u++]=L}return u}}},{}],40:[function(t,k,x){"use strict";function e(s,f,l){for(var o=2*(s+1),d=s+1;d<=f;++d){for(var u=l[o++],a=l[o++],y=d,h=o-2;y-- >s;){var _=l[h-2],b=l[h-1];if(_<u||_===u&&b<a)break;l[h]=_,l[h+1]=b,h-=2}l[h]=u,l[h+1]=a}}function r(s,f,l){var o=l[s*=2],d=l[s+1];l[s]=l[f*=2],l[s+1]=l[f+1],l[f]=o,l[f+1]=d}function i(s,f,l){l[s*=2]=l[f*=2],l[s+1]=l[f+1]}function c(s,f,l,o){l*=2;var d=o[s*=2],u=o[s+1];o[s]=o[f*=2],o[s+1]=o[f+1],o[f]=o[l],o[f+1]=o[l+1],o[l]=d,o[l+1]=u}function n(s,f,l,o,d){d[s*=2]=d[f*=2],d[f]=l,d[s+1]=d[f+1],d[f+1]=o}function m(s,f,l){var o=l[s*=2],d=l[f*=2];return!(o<d)&&(o!==d||l[s+1]>l[f+1])}function p(s,f,l,o){var d=o[s*=2];return d<f||d===f&&o[s+1]<l}k.exports=function(s,f){f<=128?e(0,f-1,s):function l(o,d,u){var a=(d-o+1)/6|0,y=o+a,h=d-a,_=o+d>>1,b=_-a,w=_+a,T=y,L=b,M=_,P=w,z=h,S=o+1,C=d-1,R=0;m(T,L,u)&&(R=T,T=L,L=R),m(P,z,u)&&(R=P,P=z,z=R),m(T,M,u)&&(R=T,T=M,M=R),m(L,M,u)&&(R=L,L=M,M=R),m(T,P,u)&&(R=T,T=P,P=R),m(M,P,u)&&(R=M,M=P,P=R),m(L,z,u)&&(R=L,L=z,z=R),m(L,M,u)&&(R=L,L=M,M=R),m(P,z,u)&&(R=P,P=z,z=R);for(var D=u[2*L],j=u[2*L+1],q=u[2*P],Z=u[2*P+1],W=2*T,G=2*M,X=2*z,ne=2*y,V=2*_,N=2*h,U=0;U<2;++U){var B=u[G+U],K=u[X+U];u[ne+U]=u[W+U],u[V+U]=B,u[N+U]=K}i(b,o,u),i(w,d,u);for(var J=S;J<=C;++J)if(p(J,D,j,u))J!==S&&r(J,S,u),++S;else if(!p(J,q,Z,u))for(;;){if(p(C,q,Z,u)){p(C,D,j,u)?(c(J,S,C,u),++S,--C):(r(J,C,u),--C);break}if(--C<J)break}n(o,S-1,D,j,u),n(d,C+1,q,Z,u),S-2-o<=32?e(o,S-2,u):l(o,S-2,u),d-(C+2)<=32?e(C+2,d,u):l(C+2,d,u),C-S<=32?e(S,C,u):l(S,C,u)}(0,f-1,s)}},{}],41:[function(t,k,x){"use strict";k.exports={init:function(u){var a=r.nextPow2(u);c.length<a&&(e.free(c),c=e.mallocInt32(a)),n.length<a&&(e.free(n),n=e.mallocInt32(a)),m.length<a&&(e.free(m),m=e.mallocInt32(a)),p.length<a&&(e.free(p),p=e.mallocInt32(a)),s.length<a&&(e.free(s),s=e.mallocInt32(a)),f.length<a&&(e.free(f),f=e.mallocInt32(a));var y=8*a;l.length<y&&(e.free(l),l=e.mallocDouble(y))},sweepBipartite:function(u,a,y,h,_,b,w,T,L,M){for(var P=0,z=2*u,S=u-1,C=z-1,R=y;R<h;++R){var D=b[R],j=z*R;l[P++]=_[j+S],l[P++]=-(D+1),l[P++]=_[j+C],l[P++]=D}for(R=w;R<T;++R){D=M[R]+(1<<28);var q=z*R;l[P++]=L[q+S],l[P++]=-D,l[P++]=L[q+C],l[P++]=D}var Z=P>>>1;i(l,Z);var W=0,G=0;for(R=0;R<Z;++R){var X=0|l[2*R+1];if(X>=1<<28)o(m,p,G--,X=X-(1<<28)|0);else if(X>=0)o(c,n,W--,X);else if(X<=-(1<<28)){X=-X-(1<<28)|0;for(var ne=0;ne<W;++ne)if(void 0!==(V=a(c[ne],X)))return V;d(m,p,G++,X)}else{for(X=-X-1|0,ne=0;ne<G;++ne){var V;if(void 0!==(V=a(X,m[ne])))return V}d(c,n,W++,X)}}},sweepComplete:function(u,a,y,h,_,b,w,T,L,M){for(var P=0,z=2*u,S=u-1,C=z-1,R=y;R<h;++R){var D=b[R]+1<<1,j=z*R;l[P++]=_[j+S],l[P++]=-D,l[P++]=_[j+C],l[P++]=D}for(R=w;R<T;++R){D=M[R]+1<<1;var q=z*R;l[P++]=L[q+S],l[P++]=1|-D,l[P++]=L[q+C],l[P++]=1|D}var Z=P>>>1;i(l,Z);var W=0,G=0,X=0;for(R=0;R<Z;++R){var ne=0|l[2*R+1],V=1&ne;if(R<Z-1&&ne>>1==l[2*R+3]>>1&&(V=2,R+=1),ne<0){for(var N=-(ne>>1)-1,U=0;U<X;++U)if(void 0!==(ee=a(s[U],N)))return ee;if(0!==V)for(U=0;U<W;++U)if(void 0!==(ee=a(c[U],N)))return ee;if(1!==V)for(U=0;U<G;++U){var ee;if(void 0!==(ee=a(m[U],N)))return ee}0===V?d(c,n,W++,N):1===V?d(m,p,G++,N):2===V&&d(s,f,X++,N)}else N=(ne>>1)-1,0===V?o(c,n,W--,N):1===V?o(m,p,G--,N):2===V&&o(s,f,X--,N)}},scanBipartite:function(u,a,y,h,_,b,w,T,L,M,P,z){var S=0,C=2*u,R=a,D=a+u,j=1,q=1;h?q=1<<28:j=1<<28;for(var Z=_;Z<b;++Z){var W=Z+j,G=C*Z;l[S++]=w[G+R],l[S++]=-W,l[S++]=w[G+D],l[S++]=W}for(Z=L;Z<M;++Z)W=Z+q,l[S++]=P[C*Z+R],l[S++]=-W;var ne=S>>>1;i(l,ne);var V=0;for(Z=0;Z<ne;++Z){var N=0|l[2*Z+1];if(N<0){var U=!1;if((W=-N)>=1<<28?(U=!h,W-=1<<28):(U=!!h,W-=1),U)d(c,n,V++,W);else{var ee=z[W],B=C*W,K=P[B+a+1],J=P[B+a+1+u];e:for(var te=0;te<V;++te){var ae=c[te],ce=C*ae;if(!(J<w[ce+a+1]||w[ce+a+1+u]<K)){for(var oe=a+2;oe<u;++oe)if(P[B+oe+u]<w[ce+oe]||w[ce+oe+u]<P[B+oe])continue e;var ve,fe=T[ae];if(void 0!==(ve=h?y(ee,fe):y(fe,ee)))return ve}}}}else o(c,n,V--,N-j)}},scanComplete:function(u,a,y,h,_,b,w,T,L,M,P){for(var z=0,S=2*u,C=a,R=a+u,D=h;D<_;++D){var j=D+268435456,q=S*D;l[z++]=b[q+C],l[z++]=-j,l[z++]=b[q+R],l[z++]=j}for(D=T;D<L;++D)j=D+1,l[z++]=M[S*D+C],l[z++]=-j;var W=z>>>1;i(l,W);var G=0;for(D=0;D<W;++D){var X=0|l[2*D+1];if(X<0)if((j=-X)>=1<<28)c[G++]=j-(1<<28);else{var ne=P[j-=1],V=S*j,N=M[V+a+1],U=M[V+a+1+u];e:for(var ee=0;ee<G;++ee){var B=c[ee],K=w[B];if(K===ne)break;var J=S*B;if(!(U<b[J+a+1]||b[J+a+1+u]<N)){for(var te=a+2;te<u;++te)if(M[V+te+u]<b[J+te]||b[J+te+u]<M[V+te])continue e;var ae=y(K,ne);if(void 0!==ae)return ae}}}else{for(j=X-(1<<28),ee=G-1;ee>=0;--ee)if(c[ee]===j){for(te=ee+1;te<G;++te)c[te-1]=c[te];break}--G}}}};var e=t("typedarray-pool"),r=t("bit-twiddle"),i=t("./sort"),c=e.mallocInt32(1024),n=e.mallocInt32(1024),m=e.mallocInt32(1024),p=e.mallocInt32(1024),s=e.mallocInt32(1024),f=e.mallocInt32(1024),l=e.mallocDouble(8192);function o(u,a,y,h){var _=a[h],b=u[y-1];u[_]=b,a[b]=_}function d(u,a,y,h){u[y]=h,a[h]=y}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(t,k,x){"use strict";var e=t("./lib/monotone"),r=t("./lib/triangulation"),i=t("./lib/delaunay"),c=t("./lib/filter");function n(s){return[Math.min(s[0],s[1]),Math.max(s[0],s[1])]}function m(s,f){return s[0]-f[0]||s[1]-f[1]}function p(s,f,l){return f in s?s[f]:l}k.exports=function(s,f,l){Array.isArray(f)?(l=l||{},f=f||[]):(l=f||{},f=[]);var o=!!p(l,"delaunay",!0),d=!!p(l,"interior",!0),u=!!p(l,"exterior",!0),a=!!p(l,"infinity",!1);if(!d&&!u||0===s.length)return[];var y=e(s,f);if(o||d!==u||a){for(var h=r(s.length,f.map(n).sort(m)),_=0;_<y.length;++_){var b=y[_];h.addTriangle(b[0],b[1],b[2])}return o&&i(s,h),u?d?a?c(h,0,a):h.cells():c(h,1,a):c(h,-1)}return y}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(t,k,x){"use strict";var e=t("robust-in-sphere")[4];function r(i,c,n,m,p,s){var f=c.opposite(m,p);if(!(f<0)){if(p<m){var l=m;m=p,p=l,l=s,s=f,f=l}c.isConstraint(m,p)||e(i[m],i[p],i[s],i[f])<0&&n.push(m,p)}}t("binary-search-bounds"),k.exports=function(i,c){for(var n=[],m=i.length,p=c.stars,s=0;s<m;++s)for(var f=p[s],l=1;l<f.length;l+=2)if(!((a=f[l])<s||c.isConstraint(s,a))){for(var o=f[l-1],d=-1,u=1;u<f.length;u+=2)if(f[u-1]===a){d=f[u];break}d<0||e(i[s],i[a],i[o],i[d])<0&&n.push(s,a)}for(;n.length>0;){for(var a=n.pop(),y=(o=-1,d=-1,f=p[s=n.pop()],1);y<f.length;y+=2){var h=f[y-1],_=f[y];h===a?d=_:_===a&&(o=h)}o<0||d<0||e(i[s],i[a],i[o],i[d])>=0||(c.flip(s,a),r(i,c,n,o,s,d),r(i,c,n,s,d,o),r(i,c,n,d,a,o),r(i,c,n,a,o,d))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(t,k,x){"use strict";var e,r=t("binary-search-bounds");function i(n,m,p,s,f,l,o){this.cells=n,this.neighbor=m,this.flags=s,this.constraint=p,this.active=f,this.next=l,this.boundary=o}function c(n,m){return n[0]-m[0]||n[1]-m[1]||n[2]-m[2]}k.exports=function(n,m,p){var s=function(L,M){for(var P=L.cells(),z=P.length,S=0;S<z;++S){var C=(V=P[S])[0],R=V[1],D=V[2];R<D?R<C&&(V[0]=R,V[1]=D,V[2]=C):D<C&&(V[0]=D,V[1]=C,V[2]=R)}P.sort(c);var j=new Array(z);for(S=0;S<j.length;++S)j[S]=0;var q=[],Z=[],W=new Array(3*z),G=new Array(3*z),X=null;M&&(X=[]);var ne=new i(P,W,G,j,q,Z,X);for(S=0;S<z;++S)for(var V=P[S],N=0;N<3;++N){var U=W[3*S+N]=ne.locate(R=V[(N+1)%3],C=V[N],L.opposite(R,C)),ee=G[3*S+N]=L.isConstraint(C,R);U<0&&(ee?Z.push(S):(q.push(S),j[S]=1),M&&X.push([R,C,-1]))}return ne}(n,p);if(0===m)return p?s.cells.concat(s.boundary):s.cells;for(var f=1,l=s.active,o=s.next,d=s.flags,u=s.cells,a=s.constraint,y=s.neighbor;l.length>0||o.length>0;){for(;l.length>0;){var h=l.pop();if(d[h]!==-f){d[h]=f;for(var _=0;_<3;++_){var b=y[3*h+_];b>=0&&0===d[b]&&(a[3*h+_]?o.push(b):(l.push(b),d[b]=f))}}}var w=o;o=l,l=w,o.length=0,f=-f}var T=function(L,M,P){for(var z=0,S=0;S<L.length;++S)M[S]===P&&(L[z++]=L[S]);return L.length=z,L}(u,d,m);return p?T.concat(s.boundary):T},i.prototype.locate=(e=[0,0,0],function(n,m,p){var s=n,f=m,l=p;return m<p?m<n&&(s=m,f=p,l=n):p<n&&(s=p,f=n,l=m),s<0?-1:(e[0]=s,e[1]=f,e[2]=l,r.eq(this.cells,e,c))})},{"binary-search-bounds":31}],45:[function(t,k,x){"use strict";var e=t("binary-search-bounds"),r=t("robust-orientation")[3];function i(o,d,u,a,y){this.a=o,this.b=d,this.idx=u,this.lowerIds=a,this.upperIds=y}function c(o,d,u,a){this.a=o,this.b=d,this.type=u,this.idx=a}function n(o,d){var u=o.a[0]-d.a[0]||o.a[1]-d.a[1]||o.type-d.type;return u||(0!==o.type&&(u=r(o.a,o.b,d.b))?u:o.idx-d.idx)}function m(o,d){return r(o.a,o.b,d)}function p(o,d,u,a,y){for(var h=e.lt(d,a,m),_=e.gt(d,a,m),b=h;b<_;++b){for(var w=d[b],T=w.lowerIds,L=T.length;L>1&&r(u[T[L-2]],u[T[L-1]],a)>0;)o.push([T[L-1],T[L-2],y]),L-=1;T.length=L,T.push(y);var M=w.upperIds;for(L=M.length;L>1&&r(u[M[L-2]],u[M[L-1]],a)<0;)o.push([M[L-2],M[L-1],y]),L-=1;M.length=L,M.push(y)}}function s(o,d){var u;return(u=o.a[0]<d.a[0]?r(o.a,o.b,d.a):r(d.b,d.a,o.a))?u:(u=d.b[0]<o.b[0]?r(o.a,o.b,d.b):r(d.b,d.a,o.b))||o.idx-d.idx}function f(o,d,u){var a=e.le(o,u,s),y=o[a],h=y.upperIds,_=h[h.length-1];y.upperIds=[_],o.splice(a+1,0,new i(u.a,u.b,u.idx,[_],h))}function l(o,d,u){var a=u.a;u.a=u.b,u.b=a;var y=e.eq(o,u,s);o[y-1].upperIds=o[y].upperIds,o.splice(y,1)}k.exports=function(o,d){for(var u=o.length,a=d.length,y=[],h=0;h<u;++h)y.push(new c(o[h],null,0,h));for(h=0;h<a;++h){var _=d[h],b=o[_[0]],w=o[_[1]];b[0]<w[0]?y.push(new c(b,w,2,h),new c(w,b,1,h)):b[0]>w[0]&&y.push(new c(w,b,2,h),new c(b,w,1,h))}y.sort(n);for(var T=y[0].a[0]-(1+Math.abs(y[0].a[0]))*Math.pow(2,-52),L=[new i([T,1],[T,0],-1,[],[],[],[])],M=[],P=(h=0,y.length);h<P;++h){var z=y[h],S=z.type;0===S?p(M,L,o,z.a,z.idx):2===S?f(L,0,z):l(L,0,z)}return M}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(t,k,x){"use strict";var e=t("binary-search-bounds");function r(n,m){this.stars=n,this.edges=m}k.exports=function(n,m){for(var p=new Array(n),s=0;s<n;++s)p[s]=[];return new r(p,m)};var i=r.prototype;function c(n,m,p){for(var s=1,f=n.length;s<f;s+=2)if(n[s-1]===m&&n[s]===p)return n[s-1]=n[f-2],n[s]=n[f-1],void(n.length=f-2)}i.isConstraint=function(){var n=[0,0];function m(p,s){return p[0]-s[0]||p[1]-s[1]}return function(p,s){return n[0]=Math.min(p,s),n[1]=Math.max(p,s),e.eq(this.edges,n,m)>=0}}(),i.removeTriangle=function(n,m,p){var s=this.stars;c(s[n],m,p),c(s[m],p,n),c(s[p],n,m)},i.addTriangle=function(n,m,p){var s=this.stars;s[n].push(m,p),s[m].push(p,n),s[p].push(n,m)},i.opposite=function(n,m){for(var p=this.stars[m],s=1,f=p.length;s<f;s+=2)if(p[s]===n)return p[s-1];return-1},i.flip=function(n,m){var p=this.opposite(n,m),s=this.opposite(m,n);this.removeTriangle(n,m,p),this.removeTriangle(m,n,s),this.addTriangle(n,s,p),this.addTriangle(m,p,s)},i.edges=function(){for(var n=this.stars,m=[],p=0,s=n.length;p<s;++p)for(var f=n[p],l=0,o=f.length;l<o;l+=2)m.push([f[l],f[l+1]]);return m},i.cells=function(){for(var n=this.stars,m=[],p=0,s=n.length;p<s;++p)for(var f=n[p],l=0,o=f.length;l<o;l+=2){var d=f[l],u=f[l+1];p<Math.min(d,u)&&m.push([p,d,u])}return m}},{"binary-search-bounds":31}],47:[function(t,k,x){"use strict";k.exports=function(e){for(var r=1,i=1;i<e.length;++i)for(var c=0;c<i;++c)if(e[i]<e[c])r=-r;else if(e[c]===e[i])return 0;return r}},{}],48:[function(t,k,x){"use strict";var e=t("dup"),r=t("robust-linear-solve");function i(m,p){for(var s=0,f=m.length,l=0;l<f;++l)s+=m[l]*p[l];return s}function c(m){var p=m.length;if(0===p)return[];var s=e([m.length+1,m.length+1],1),f=e([m.length+1],1);s[p][p]=0;for(var l=0;l<p;++l){for(var o=0;o<=l;++o)s[o][l]=s[l][o]=2*i(m[l],m[o]);f[l]=i(m[l],m[l])}var d=r(s,f),u=0,a=d[p+1];for(l=0;l<a.length;++l)u+=a[l];var y=new Array(p);for(l=0;l<p;++l){a=d[l];var h=0;for(o=0;o<a.length;++o)h+=a[o];y[l]=h/u}return y}function n(m){if(0===m.length)return[];for(var p=m[0].length,s=e([p]),f=c(m),l=0;l<m.length;++l)for(var o=0;o<p;++o)s[o]+=m[l][o]*f[l];return s}n.barycenetric=c,k.exports=n},{dup:65,"robust-linear-solve":283}],49:[function(t,k,x){k.exports=function(r){for(var i=e(r),c=0,n=0;n<r.length;++n)for(var m=r[n],p=0;p<i.length;++p)c+=Math.pow(m[p]-i[p],2);return Math.sqrt(c/r.length)};var e=t("circumcenter")},{circumcenter:48}],50:[function(t,k,x){"use strict";k.exports=function(_,b,w){var T,S,R,D;if(w){T=b;for(var L=new Array(b.length),M=0;M<b.length;++M){var P=b[M];L[M]=[P[0],P[1],w[M]]}b=L}for(var z=(R=!!w,void 0,y(b,D=d(S=_,[],o(S)),R),!!D);h(_,b,!!w);)z=!0;if(w&&z)for(T.length=0,w.length=0,M=0;M<b.length;++M)T.push([(P=b[M])[0],P[1]]),w.push(P[2]);return z};var e=t("union-find"),r=t("box-intersect"),i=t("robust-segment-intersect"),c=t("big-rat"),n=t("big-rat/cmp"),m=t("big-rat/to-float"),p=t("rat-vec"),s=t("nextafter"),f=t("./lib/rat-seg-intersect");function l(_){var b=m(_);return[s(b,-1/0),s(b,1/0)]}function o(_){for(var b=new Array(_.length),w=0;w<_.length;++w){var T=_[w];b[w]=[s(T[0],-1/0),s(T[1],-1/0),s(T[0],1/0),s(T[1],1/0)]}return b}function d(_,b,w){for(var T=b.length,L=new e(T),M=[],P=0;P<b.length;++P){var z=b[P],S=l(z[0]),C=l(z[1]);M.push([s(S[0],-1/0),s(C[0],-1/0),s(S[1],1/0),s(C[1],1/0)])}r(M,function(Z,W){L.link(Z,W)});var R=!0,D=new Array(T);for(P=0;P<T;++P)(q=L.find(P))!==P&&(R=!1,_[q]=[Math.min(_[P][0],_[q][0]),Math.min(_[P][1],_[q][1])]);if(R)return null;var j=0;for(P=0;P<T;++P){var q;(q=L.find(P))===P?(D[P]=j,_[j++]=_[P]):D[P]=-1}for(_.length=j,P=0;P<T;++P)D[P]<0&&(D[P]=D[L.find(P)]);return D}function u(_,b){return _[0]-b[0]||_[1]-b[1]}function a(_,b){return _[0]-b[0]||_[1]-b[1]||(_[2]<b[2]?-1:_[2]>b[2]?1:0)}function y(_,b,w){if(0!==_.length){if(b)for(var T=0;T<_.length;++T){var L=b[(P=_[T])[0]],M=b[P[1]];P[0]=Math.min(L,M),P[1]=Math.max(L,M)}else for(T=0;T<_.length;++T){var P;L=(P=_[T])[0],M=P[1],P[0]=Math.min(L,M),P[1]=Math.max(L,M)}_.sort(w?a:u);var z=1;for(T=1;T<_.length;++T){var S=_[T-1],C=_[T];(C[0]!==S[0]||C[1]!==S[1]||w&&C[2]!==S[2])&&(_[z++]=C)}_.length=z}}function h(_,b,w){var S,C,D,T=function(S,C){for(var R=new Array(C.length),D=0;D<C.length;++D){var j=C[D],q=S[j[0]],Z=S[j[1]];R[D]=[s(Math.min(q[0],Z[0]),-1/0),s(Math.min(q[1],Z[1]),-1/0),s(Math.max(q[0],Z[0]),1/0),s(Math.max(q[1],Z[1]),1/0)]}return R}(_,b),L=(S=_,C=b,D=[],r(T,function(j,q){var Z=C[j],W=C[q];Z[0]!==W[0]&&Z[0]!==W[1]&&Z[1]!==W[0]&&Z[1]!==W[1]&&i(S[Z[0]],S[Z[1]],S[W[0]],S[W[1]])&&D.push([j,q])}),D),P=function(S,C,R,D){var j=[];return r(R,D,function(q,Z){var W=C[q];if(W[0]!==Z&&W[1]!==Z){var G=S[Z];i(S[W[0]],S[W[1]],G,G)&&j.push([q,Z])}}),j}(_,b,T,o(_)),z=d(_,function(S,C,R,D,j){var q,Z,W=S.map(function(xe){return[c(xe[0]),c(xe[1])]});for(q=0;q<R.length;++q){var G=R[q],X=G[1],ne=C[Z=G[0]],V=C[X],N=f(p(S[ne[0]]),p(S[ne[1]]),p(S[V[0]]),p(S[V[1]]));if(N){var U=S.length;S.push([m(N[0]),m(N[1])]),W.push(N),D.push([Z,U],[X,U])}}for(D.sort(function(xe,Se){if(xe[0]!==Se[0])return xe[0]-Se[0];var pe=W[xe[1]],ge=W[Se[1]];return n(pe[0],ge[0])||n(pe[1],ge[1])}),q=D.length-1;q>=0;--q){var ee=C[Z=(ve=D[q])[0]],B=ee[0],K=ee[1],J=S[B],te=S[K];if((J[0]-te[0]||J[1]-te[1])<0){var ae=B;B=K,K=ae}ee[0]=B;var ce,oe=ee[1]=ve[1];for(j&&(ce=ee[2]);q>0&&D[q-1][0]===Z;){var ve,fe=(ve=D[--q])[1];C.push(j?[oe,fe,ce]:[oe,fe]),oe=fe}C.push(j?[oe,K,ce]:[oe,K])}return W}(_,b,L,P,w));return y(b,z,w),!!z||L.length>0||P.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(t,k,x){"use strict";k.exports=function(f,l,o,d){var u=n(l,f),a=n(d,o),y=s(u,a);if(0===c(y))return null;var _=s(a,n(f,o)),b=r(_,y),w=p(u,b);return m(f,w)};var e=t("big-rat/mul"),r=t("big-rat/div"),i=t("big-rat/sub"),c=t("big-rat/sign"),n=t("rat-vec/sub"),m=t("rat-vec/add"),p=t("rat-vec/muls");function s(f,l){return i(e(f[0],l[1]),e(f[1],l[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(t,k,x){k.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(t,k,x){"use strict";var e=t("./colorScale"),r=t("lerp");function i(m){return[m[0]/255,m[1]/255,m[2]/255,m[3]]}function c(m){for(var p,s="#",f=0;f<3;++f)s+=("00"+(p=(p=m[f]).toString(16))).substr(p.length);return s}function n(m){return"rgba("+m.join(",")+")"}k.exports=function(m){var p,s,f,l,o,d,u,a,y,h;if(m||(m={}),a=(m.nshades||72)-1,u=m.format||"hex",(d=m.colormap)||(d="jet"),"string"==typeof d){if(d=d.toLowerCase(),!e[d])throw Error(d+" not a supported colorscale");o=e[d]}else{if(!Array.isArray(d))throw Error("unsupported colormap option",d);o=d.slice()}if(o.length>a+1)throw new Error(d+" map requires nshades to be at least size "+o.length);y=Array.isArray(m.alpha)?2!==m.alpha.length?[1,1]:m.alpha.slice():"number"==typeof m.alpha?[m.alpha,m.alpha]:[1,1],p=o.map(function(L){return Math.round(L.index*a)}),y[0]=Math.min(Math.max(y[0],0),1),y[1]=Math.min(Math.max(y[1],0),1);var _=o.map(function(L,M){var P=o[M].index,z=o[M].rgb.slice();return 4===z.length&&z[3]>=0&&z[3]<=1||(z[3]=y[0]+(y[1]-y[0])*P),z}),b=[];for(h=0;h<p.length-1;++h){l=p[h+1]-p[h],s=_[h],f=_[h+1];for(var w=0;w<l;w++){var T=w/l;b.push([Math.round(r(s[0],f[0],T)),Math.round(r(s[1],f[1],T)),Math.round(r(s[2],f[2],T)),r(s[3],f[3],T)])}}return b.push(o[o.length-1].rgb.concat(y[1])),"hex"===u?b=b.map(c):"rgbaString"===u?b=b.map(n):"float"===u&&(b=b.map(i)),b}},{"./colorScale":52,lerp:240}],54:[function(t,k,x){"use strict";k.exports=function(p,s,f,l){var o=e(s,f,l);if(0===o){var d=r(e(p,s,f)),u=r(e(p,s,l));if(d===u){if(0===d){var a=m(p,s,f);return a===m(p,s,l)?0:a?1:-1}return 0}return 0===u?d>0||m(p,s,l)?-1:1:0===d?u>0||m(p,s,f)?1:-1:r(u-d)}var h=e(p,s,f);return h>0?o>0&&e(p,s,l)>0?1:-1:h<0?o>0||e(p,s,l)>0?1:-1:e(p,s,l)>0||m(p,s,f)?1:-1};var e=t("robust-orientation"),r=t("signum"),i=t("two-sum"),c=t("robust-product"),n=t("robust-sum");function m(p,s,f){var l=i(p[0],-s[0]),o=i(p[1],-s[1]),d=i(f[0],-s[0]),u=i(f[1],-s[1]),a=n(c(l,d),c(o,u));return a[a.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(t,k,x){"use strict";k.exports=function(e){return e<0?-1:e>0?1:0}},{}],56:[function(t,k,x){k.exports=function(i,c){var n=i.length,m=i.length-c.length;if(m)return m;switch(n){case 0:return 0;case 1:return i[0]-c[0];case 2:return i[0]+i[1]-c[0]-c[1]||e(i[0],i[1])-e(c[0],c[1]);case 3:var p=i[0]+i[1],s=c[0]+c[1];if(m=p+i[2]-(s+c[2]))return m;var f=e(i[0],i[1]),l=e(c[0],c[1]);return e(f,i[2])-e(l,c[2])||e(f+i[2],p)-e(l+c[2],s);case 4:var o=i[0],d=i[1],u=i[2],a=i[3],y=c[0],h=c[1],_=c[2],b=c[3];return o+d+u+a-(y+h+_+b)||e(o,d,u,a)-e(y,h,_,b,y)||e(o+d,o+u,o+a,d+u,d+a,u+a)-e(y+h,y+_,y+b,h+_,h+b,_+b)||e(o+d+u,o+d+a,o+u+a,d+u+a)-e(y+h+_,y+h+b,y+_+b,h+_+b);default:for(var w=i.slice().sort(r),T=c.slice().sort(r),L=0;L<n;++L)if(m=w[L]-T[L])return m;return 0}};var e=Math.min;function r(i,c){return i-c}},{}],57:[function(t,k,x){"use strict";var e=t("compare-cell"),r=t("cell-orientation");k.exports=function(i,c){return e(i,c)||r(i)-r(c)}},{"cell-orientation":47,"compare-cell":56}],58:[function(t,k,x){"use strict";var e=t("./lib/ch1d"),r=t("./lib/ch2d"),i=t("./lib/chnd");k.exports=function(c){var n=c.length;if(0===n)return[];if(1===n)return[[0]];var m=c[0].length;return 0===m?[]:1===m?e(c):2===m?r(c):i(c,m)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(t,k,x){"use strict";k.exports=function(e){for(var r=0,i=0,c=1;c<e.length;++c)e[c][0]<e[r][0]&&(r=c),e[c][0]>e[i][0]&&(i=c);return r<i?[[r],[i]]:r>i?[[i],[r]]:[[r]]}},{}],60:[function(t,k,x){"use strict";k.exports=function(r){var i=e(r),c=i.length;if(c<=2)return[];for(var n=new Array(c),m=i[c-1],p=0;p<c;++p){var s=i[p];n[p]=[m,s],m=s}return n};var e=t("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(t,k,x){"use strict";k.exports=function(i,c){try{return e(i,!0)}catch(p){var n=r(i);if(n.length<=c)return[];var m=function(s,f){for(var l=s.length,o=new Array(l),d=0;d<f.length;++d)o[d]=s[f[d]];var u=f.length;for(d=0;d<l;++d)f.indexOf(d)<0&&(o[u++]=s[d]);return o}(i,n);return function(s,f){for(var l=s.length,o=f.length,d=0;d<l;++d)for(var u=s[d],a=0;a<u.length;++a){var y=u[a];if(y<o)u[a]=f[y];else{y-=o;for(var h=0;h<o;++h)y>=f[h]&&(y+=1);u[a]=y}}return s}(e(m,!0),n)}};var e=t("incremental-convex-hull"),r=t("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(t,k,x){"use strict";k.exports=function(e,r,i,c,n,m){var p=n-1,s=n*n,f=p*p,l=(1+2*n)*f,o=n*f,d=s*(3-2*n),u=s*p;if(e.length){m||(m=new Array(e.length));for(var a=e.length-1;a>=0;--a)m[a]=l*e[a]+o*r[a]+d*i[a]+u*c[a];return m}return l*e+o*r+d*i+u*c},k.exports.derivative=function(e,r,i,c,n,m){var p=6*n*n-6*n,s=3*n*n-4*n+1,f=-6*n*n+6*n,l=3*n*n-2*n;if(e.length){m||(m=new Array(e.length));for(var o=e.length-1;o>=0;--o)m[o]=p*e[o]+s*r[o]+f*i[o]+l*c[o];return m}return p*e+s*r+f*i[o]+l*c}},{}],63:[function(t,k,x){"use strict";var e=t("incremental-convex-hull"),r=t("uniq");function i(n,m){this.point=n,this.index=m}function c(n,m){for(var p=n.point,s=m.point,f=p.length,l=0;l<f;++l){var o=s[l]-p[l];if(o)return o}return 0}k.exports=function(n,m){var p=n.length;if(0===p)return[];var s=n[0].length;if(s<1)return[];if(1===s)return function(P,z,S){if(1===P)return S?[[-1,0]]:[];var C=z.map(function(Z,W){return[Z[0],W]});C.sort(function(Z,W){return Z[0]-W[0]});for(var R=new Array(P-1),D=1;D<P;++D)R[D-1]=[C[D-1][1],C[D][1]];return S&&R.push([-1,R[0][1]],[R[P-1][1],-1]),R}(p,n,m);for(var f=new Array(p),l=1,o=0;o<p;++o){for(var d=n[o],u=new Array(s+1),a=0,y=0;y<s;++y){var h=d[y];u[y]=h,a+=h*h}u[s]=a,f[o]=new i(u,o),l=Math.max(a,l)}r(f,c),p=f.length;var _=new Array(p+s+1),b=new Array(p+s+1),w=(s+1)*(s+1)*l,T=new Array(s+1);for(o=0;o<=s;++o)T[o]=0;for(T[s]=w,_[0]=T.slice(),b[0]=-1,o=0;o<=s;++o)(u=T.slice())[o]=1,_[o+1]=u,b[o+1]=-1;for(o=0;o<p;++o){var L=f[o];_[o+s+1]=L.point,b[o+s+1]=L.index}var M=e(_,!1);if(M=M.filter(m?function(P){for(var z=0,S=0;S<=s;++S){var C=b[P[S]];if(C<0&&++z>=2)return!1;P[S]=C}return!0}:function(P){for(var z=0;z<=s;++z){var S=b[P[z]];if(S<0)return!1;P[z]=S}return!0}),1&s)for(o=0;o<M.length;++o)u=(L=M[o])[0],L[0]=L[1],L[1]=u;return M}},{"incremental-convex-hull":233,uniq:310}],64:[function(t,k,x){(function(e){(function(){var r=!1;if("undefined"!=typeof Float64Array){var i=new Float64Array(1),c=new Uint32Array(i.buffer);i[0]=1,r=!0,1072693248===c[1]?(k.exports=function(m){return i[0]=m,[c[0],c[1]]},k.exports.pack=function(m,p){return c[0]=m,c[1]=p,i[0]},k.exports.lo=function(m){return i[0]=m,c[0]},k.exports.hi=function(m){return i[0]=m,c[1]}):1072693248===c[0]?(k.exports=function(m){return i[0]=m,[c[1],c[0]]},k.exports.pack=function(m,p){return c[1]=m,c[0]=p,i[0]},k.exports.lo=function(m){return i[0]=m,c[1]},k.exports.hi=function(m){return i[0]=m,c[0]}):r=!1}if(!r){var n=new e(8);k.exports=function(m){return n.writeDoubleLE(m,0,!0),[n.readUInt32LE(0,!0),n.readUInt32LE(4,!0)]},k.exports.pack=function(m,p){return n.writeUInt32LE(m,0,!0),n.writeUInt32LE(p,4,!0),n.readDoubleLE(0,!0)},k.exports.lo=function(m){return n.writeDoubleLE(m,0,!0),n.readUInt32LE(0,!0)},k.exports.hi=function(m){return n.writeDoubleLE(m,0,!0),n.readUInt32LE(4,!0)}}k.exports.sign=function(m){return k.exports.hi(m)>>>31},k.exports.exponent=function(m){return(k.exports.hi(m)<<1>>>21)-1023},k.exports.fraction=function(m){var p=k.exports.lo(m),s=k.exports.hi(m),f=1048575&s;return 2146435072&s&&(f+=1<<20),[p,f]},k.exports.denormalized=function(m){return!(2146435072&k.exports.hi(m))}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:3}],65:[function(t,k,x){"use strict";k.exports=function(e,r){switch(void 0===r&&(r=0),typeof e){case"number":if(e>0)return function(i,c){var n,m;for(n=new Array(i),m=0;m<i;++m)n[m]=c;return n}(0|e,r);break;case"object":if("number"==typeof e.length)return function i(c,n,m){var p=0|c[m];if(p<=0)return[];var s,f=new Array(p);if(m===c.length-1)for(s=0;s<p;++s)f[s]=n;else for(s=0;s<p;++s)f[s]=i(c,n,m+1);return f}(e,r,0)}return[]}},{}],66:[function(t,k,x){"use strict";k.exports=function(r,i){var c=r.length;if("number"!=typeof i){i=0;for(var n=0;n<c;++n){var m=r[n];i=Math.max(i,m[0],m[1])}i=1+(0|i)}i|=0;var p=new Array(i);for(n=0;n<i;++n)p[n]=[];for(n=0;n<c;++n)p[(m=r[n])[0]].push(m[1]),p[m[1]].push(m[0]);for(var s=0;s<i;++s)e(p[s],function(f,l){return f-l});return p};var e=t("uniq")},{uniq:310}],67:[function(t,k,x){"use strict";k.exports=function(e,r,i){var c=r||0,n=i||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[c*e[12]+e[8],c*e[13]+e[9],c*e[14]+e[10],c*e[15]+e[11]],[n*e[12]-e[8],n*e[13]-e[9],n*e[14]-e[10],n*e[15]-e[11]]]}},{}],68:[function(t,k,x){"use strict";k.exports=function(p,s,f){switch(arguments.length){case 0:return new c([0],[0],0);case 1:return"number"==typeof p?new c(l=m(p),l,0):new c(p,m(p.length),0);case 2:if("number"==typeof s){var l=m(p.length);return new c(p,l,+s)}f=0;case 3:if(p.length!==s.length)throw new Error("state and velocity lengths must match");return new c(p,s,f)}};var e=t("cubic-hermite"),r=t("binary-search-bounds");function i(p,s,f){return Math.min(s,Math.max(p,f))}function c(p,s,f){this.dimension=p.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var l=0;l<this.dimension;++l)this.bounds[0][l]=-1/0,this.bounds[1][l]=1/0;this._state=p.slice().reverse(),this._velocity=s.slice().reverse(),this._time=[f],this._scratch=[p.slice(),p.slice(),p.slice(),p.slice(),p.slice()]}var n=c.prototype;function m(p){for(var s=new Array(p),f=0;f<p;++f)s[f]=0;return s}n.flush=function(p){var s=r.gt(this._time,p)-1;s<=0||(this._time.splice(0,s),this._state.splice(0,s*this.dimension),this._velocity.splice(0,s*this.dimension))},n.curve=function(p){var s=this._time,f=s.length,l=r.le(s,p),o=this._scratch[0],d=this._state,u=this._velocity,a=this.dimension,y=this.bounds;if(l<0)for(var h=a-1,_=0;_<a;++_,--h)o[_]=d[h];else if(l>=f-1){h=d.length-1;var b=p-s[f-1];for(_=0;_<a;++_,--h)o[_]=d[h]+b*u[h]}else{h=a*(l+1)-1;var w=s[l],T=s[l+1]-w||1,L=this._scratch[1],M=this._scratch[2],P=this._scratch[3],z=this._scratch[4],S=!0;for(_=0;_<a;++_,--h)L[_]=d[h],P[_]=u[h]*T,M[_]=d[h+a],z[_]=u[h+a]*T,S=S&&L[_]===M[_]&&P[_]===z[_]&&0===P[_];if(S)for(_=0;_<a;++_)o[_]=L[_];else e(L,P,M,z,(p-w)/T,o)}var C=y[0],R=y[1];for(_=0;_<a;++_)o[_]=i(C[_],R[_],o[_]);return o},n.dcurve=function(p){var s=this._time,f=s.length,l=r.le(s,p),o=this._scratch[0],d=this._state,u=this._velocity,a=this.dimension;if(l>=f-1)for(var y=d.length-1,h=0;h<a;++h,--y)o[h]=u[y];else{y=a*(l+1)-1;var _=s[l],b=s[l+1]-_||1,w=this._scratch[1],T=this._scratch[2],L=this._scratch[3],M=this._scratch[4],P=!0;for(h=0;h<a;++h,--y)w[h]=d[y],L[h]=u[y]*b,T[h]=d[y+a],M[h]=u[y+a]*b,P=P&&w[h]===T[h]&&L[h]===M[h]&&0===L[h];if(P)for(h=0;h<a;++h)o[h]=0;else for(e.derivative(w,L,T,M,(p-_)/b,o),h=0;h<a;++h)o[h]/=b}return o},n.lastT=function(){var p=this._time;return p[p.length-1]},n.stable=function(){for(var p=this._velocity,s=p.length,f=this.dimension-1;f>=0;--f)if(p[--s])return!1;return!0},n.jump=function(p){var s=this.lastT(),f=this.dimension;if(!(p<s||arguments.length!==f+1)){var l=this._state,o=this._velocity,d=l.length-this.dimension,u=this.bounds,a=u[0],y=u[1];this._time.push(s,p);for(var h=0;h<2;++h)for(var _=0;_<f;++_)l.push(l[d++]),o.push(0);for(this._time.push(p),_=f;_>0;--_)l.push(i(a[_-1],y[_-1],arguments[_])),o.push(0)}},n.push=function(p){var s=this.lastT(),f=this.dimension;if(!(p<s||arguments.length!==f+1)){var l=this._state,o=this._velocity,d=l.length-this.dimension,u=p-s,a=this.bounds,y=a[0],h=a[1],_=u>1e-6?1/u:0;this._time.push(p);for(var b=f;b>0;--b){var w=i(y[b-1],h[b-1],arguments[b]);l.push(w),o.push((w-l[d++])*_)}}},n.set=function(p){var s=this.dimension;if(!(p<this.lastT()||arguments.length!==s+1)){var f=this._state,l=this._velocity,o=this.bounds,d=o[0],u=o[1];this._time.push(p);for(var a=s;a>0;--a)f.push(i(d[a-1],u[a-1],arguments[a])),l.push(0)}},n.move=function(p){var s=this.lastT(),f=this.dimension;if(!(p<=s||arguments.length!==f+1)){var l=this._state,o=this._velocity,d=l.length-this.dimension,u=this.bounds,a=u[0],y=u[1],h=p-s,_=h>1e-6?1/h:0;this._time.push(p);for(var b=f;b>0;--b){var w=arguments[b];l.push(i(a[b-1],y[b-1],l[d++]+w)),o.push(w*_)}}},n.idle=function(p){var s=this.lastT();if(!(p<s)){var f=this.dimension,l=this._state,o=this._velocity,d=l.length-f,u=this.bounds,a=u[0],y=u[1],h=p-s;this._time.push(p);for(var _=f-1;_>=0;--_)l.push(i(a[_],y[_],l[d]+h*o[d])),o.push(0),d+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(t,k,x){"use strict";function e(a,y,h,_,b,w){this._color=a,this.key=y,this.value=h,this.left=_,this.right=b,this._count=w}function r(a){return new e(a._color,a.key,a.value,a.left,a.right,a._count)}function i(a,y){return new e(a,y.key,y.value,y.left,y.right,y._count)}function c(a){a._count=1+(a.left?a.left._count:0)+(a.right?a.right._count:0)}function n(a,y){this._compare=a,this.root=y}k.exports=function(a){return new n(a||u,null)};var m=n.prototype;function p(a,y){var h;return y.left&&(h=p(a,y.left))?h:(h=a(y.key,y.value))||(y.right?p(a,y.right):void 0)}function s(a,y,h,_){var b;return y(a,_.key)<=0&&(_.left&&(b=s(a,y,h,_.left))||(b=h(_.key,_.value)))?b:_.right?s(a,y,h,_.right):void 0}function f(a,y,h,_,b){var w,T=h(a,b.key),L=h(y,b.key);return T<=0&&(b.left&&(w=f(a,y,h,_,b.left))||L>0&&(w=_(b.key,b.value)))?w:L>0&&b.right?f(a,y,h,_,b.right):void 0}function l(a,y){this.tree=a,this._stack=y}Object.defineProperty(m,"keys",{get:function(){var a=[];return this.forEach(function(y,h){a.push(y)}),a}}),Object.defineProperty(m,"values",{get:function(){var a=[];return this.forEach(function(y,h){a.push(h)}),a}}),Object.defineProperty(m,"length",{get:function(){return this.root?this.root._count:0}}),m.insert=function(a,y){for(var h=this._compare,_=this.root,b=[],w=[];_;){var T=h(a,_.key);b.push(_),w.push(T),_=T<=0?_.left:_.right}b.push(new e(0,a,y,null,null,1));for(var L=b.length-2;L>=0;--L)_=b[L],b[L]=w[L]<=0?new e(_._color,_.key,_.value,b[L+1],_.right,_._count+1):new e(_._color,_.key,_.value,_.left,b[L+1],_._count+1);for(L=b.length-1;L>1;--L){var M=b[L-1];if(_=b[L],1===M._color||1===_._color)break;var P=b[L-2];if(P.left===M)if(M.left===_){if(!(z=P.right)||0!==z._color){P._color=0,P.left=M.right,M._color=1,M.right=P,b[L-2]=M,b[L-1]=_,c(P),c(M),L>=3&&((S=b[L-3]).left===P?S.left=M:S.right=M);break}M._color=1,P.right=i(1,z),P._color=0,L-=1}else{if(!(z=P.right)||0!==z._color){M.right=_.left,P._color=0,P.left=_.right,_._color=1,_.left=M,_.right=P,b[L-2]=_,b[L-1]=M,c(P),c(M),c(_),L>=3&&((S=b[L-3]).left===P?S.left=_:S.right=_);break}M._color=1,P.right=i(1,z),P._color=0,L-=1}else if(M.right===_){if(!(z=P.left)||0!==z._color){P._color=0,P.right=M.left,M._color=1,M.left=P,b[L-2]=M,b[L-1]=_,c(P),c(M),L>=3&&((S=b[L-3]).right===P?S.right=M:S.left=M);break}M._color=1,P.left=i(1,z),P._color=0,L-=1}else{var z;if(!(z=P.left)||0!==z._color){var S;M.left=_.right,P._color=0,P.right=_.left,_._color=1,_.right=M,_.left=P,b[L-2]=_,b[L-1]=M,c(P),c(M),c(_),L>=3&&((S=b[L-3]).right===P?S.right=_:S.left=_);break}M._color=1,P.left=i(1,z),P._color=0,L-=1}}return b[0]._color=1,new n(h,b[0])},m.forEach=function(a,y,h){if(this.root)switch(arguments.length){case 1:return p(a,this.root);case 2:return s(y,this._compare,a,this.root);case 3:return this._compare(y,h)>=0?void 0:f(y,h,this._compare,a,this.root)}},Object.defineProperty(m,"begin",{get:function(){for(var a=[],y=this.root;y;)a.push(y),y=y.left;return new l(this,a)}}),Object.defineProperty(m,"end",{get:function(){for(var a=[],y=this.root;y;)a.push(y),y=y.right;return new l(this,a)}}),m.at=function(a){if(a<0)return new l(this,[]);for(var y=this.root,h=[];;){if(h.push(y),y.left){if(a<y.left._count){y=y.left;continue}a-=y.left._count}if(!a)return new l(this,h);if(a-=1,!y.right||a>=y.right._count)break;y=y.right}return new l(this,[])},m.ge=function(a){for(var y=this._compare,h=this.root,_=[],b=0;h;){var w=y(a,h.key);_.push(h),w<=0&&(b=_.length),h=w<=0?h.left:h.right}return _.length=b,new l(this,_)},m.gt=function(a){for(var y=this._compare,h=this.root,_=[],b=0;h;){var w=y(a,h.key);_.push(h),w<0&&(b=_.length),h=w<0?h.left:h.right}return _.length=b,new l(this,_)},m.lt=function(a){for(var y=this._compare,h=this.root,_=[],b=0;h;){var w=y(a,h.key);_.push(h),w>0&&(b=_.length),h=w<=0?h.left:h.right}return _.length=b,new l(this,_)},m.le=function(a){for(var y=this._compare,h=this.root,_=[],b=0;h;){var w=y(a,h.key);_.push(h),w>=0&&(b=_.length),h=w<0?h.left:h.right}return _.length=b,new l(this,_)},m.find=function(a){for(var y=this._compare,h=this.root,_=[];h;){var b=y(a,h.key);if(_.push(h),0===b)return new l(this,_);h=b<=0?h.left:h.right}return new l(this,[])},m.remove=function(a){var y=this.find(a);return y?y.remove():this},m.get=function(a){for(var y=this._compare,h=this.root;h;){var _=y(a,h.key);if(0===_)return h.value;h=_<=0?h.left:h.right}};var o=l.prototype;function d(a,y){a.key=y.key,a.value=y.value,a.left=y.left,a.right=y.right,a._color=y._color,a._count=y._count}function u(a,y){return a<y?-1:a>y?1:0}Object.defineProperty(o,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(o,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),o.clone=function(){return new l(this.tree,this._stack.slice())},o.remove=function(){var a=this._stack;if(0===a.length)return this.tree;var y=new Array(a.length),h=a[a.length-1];y[y.length-1]=new e(h._color,h.key,h.value,h.left,h.right,h._count);for(var _=a.length-2;_>=0;--_)y[_]=(h=a[_]).left===a[_+1]?new e(h._color,h.key,h.value,y[_+1],h.right,h._count):new e(h._color,h.key,h.value,h.left,y[_+1],h._count);if((h=y[y.length-1]).left&&h.right){var b=y.length;for(h=h.left;h.right;)y.push(h),h=h.right;var w=y[b-1];for(y.push(new e(h._color,w.key,w.value,h.left,h.right,h._count)),y[b-1].key=h.key,y[b-1].value=h.value,_=y.length-2;_>=b;--_)y[_]=new e((h=y[_])._color,h.key,h.value,h.left,y[_+1],h._count);y[b-1].left=y[b]}if(0===(h=y[y.length-1])._color){var T=y[y.length-2];for(T.left===h?T.left=null:T.right===h&&(T.right=null),y.pop(),_=0;_<y.length;++_)y[_]._count--;return new n(this.tree._compare,y[0])}if(h.left||h.right){for(h.left?d(h,h.left):h.right&&d(h,h.right),h._color=1,_=0;_<y.length-1;++_)y[_]._count--;return new n(this.tree._compare,y[0])}if(1===y.length)return new n(this.tree._compare,null);for(_=0;_<y.length;++_)y[_]._count--;var L=y[y.length-2];return function(M){for(var P,z,S,C,R=M.length-1;R>=0;--R){if(P=M[R],0===R)return void(P._color=1);if((z=M[R-1]).left===P){if((S=z.right).right&&0===S.right._color)return C=(S=z.right=r(S)).right=r(S.right),z.right=S.left,S.left=z,S.right=C,S._color=z._color,P._color=1,z._color=1,C._color=1,c(z),c(S),R>1&&((D=M[R-2]).left===z?D.left=S:D.right=S),void(M[R-1]=S);if(S.left&&0===S.left._color)return C=(S=z.right=r(S)).left=r(S.left),z.right=C.left,S.left=C.right,C.left=z,C.right=S,C._color=z._color,z._color=1,S._color=1,P._color=1,c(z),c(S),c(C),R>1&&((D=M[R-2]).left===z?D.left=C:D.right=C),void(M[R-1]=C);if(1===S._color){if(0===z._color)return z._color=1,void(z.right=i(0,S));z.right=i(0,S);continue}S=r(S),z.right=S.left,S.left=z,S._color=z._color,z._color=0,c(z),c(S),R>1&&((D=M[R-2]).left===z?D.left=S:D.right=S),M[R-1]=S,M[R]=z,R+1<M.length?M[R+1]=P:M.push(P),R+=2}else{if((S=z.left).left&&0===S.left._color)return C=(S=z.left=r(S)).left=r(S.left),z.left=S.right,S.right=z,S.left=C,S._color=z._color,P._color=1,z._color=1,C._color=1,c(z),c(S),R>1&&((D=M[R-2]).right===z?D.right=S:D.left=S),void(M[R-1]=S);if(S.right&&0===S.right._color)return C=(S=z.left=r(S)).right=r(S.right),z.left=C.right,S.right=C.left,C.right=z,C.left=S,C._color=z._color,z._color=1,S._color=1,P._color=1,c(z),c(S),c(C),R>1&&((D=M[R-2]).right===z?D.right=C:D.left=C),void(M[R-1]=C);if(1===S._color){if(0===z._color)return z._color=1,void(z.left=i(0,S));z.left=i(0,S);continue}var D;S=r(S),z.left=S.right,S.right=z,S._color=z._color,z._color=0,c(z),c(S),R>1&&((D=M[R-2]).right===z?D.right=S:D.left=S),M[R-1]=S,M[R]=z,R+1<M.length?M[R+1]=P:M.push(P),R+=2}}}(y),L.left===h?L.left=null:L.right=null,new n(this.tree._compare,y[0])},Object.defineProperty(o,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(o,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(o,"index",{get:function(){var a=0,y=this._stack;if(0===y.length){var h=this.tree.root;return h?h._count:0}y[y.length-1].left&&(a=y[y.length-1].left._count);for(var _=y.length-2;_>=0;--_)y[_+1]===y[_].right&&(++a,y[_].left&&(a+=y[_].left._count));return a},enumerable:!0}),o.next=function(){var a=this._stack;if(0!==a.length){var y=a[a.length-1];if(y.right)for(y=y.right;y;)a.push(y),y=y.left;else for(a.pop();a.length>0&&a[a.length-1].right===y;)y=a[a.length-1],a.pop()}},Object.defineProperty(o,"hasNext",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].right)return!0;for(var y=a.length-1;y>0;--y)if(a[y-1].left===a[y])return!0;return!1}}),o.update=function(a){var y=this._stack;if(0===y.length)throw new Error("Can't update empty node!");var h=new Array(y.length),_=y[y.length-1];h[h.length-1]=new e(_._color,_.key,a,_.left,_.right,_._count);for(var b=y.length-2;b>=0;--b)h[b]=(_=y[b]).left===y[b+1]?new e(_._color,_.key,_.value,h[b+1],_.right,_._count):new e(_._color,_.key,_.value,_.left,h[b+1],_._count);return new n(this.tree._compare,h[0])},o.prev=function(){var a=this._stack;if(0!==a.length){var y=a[a.length-1];if(y.left)for(y=y.left;y;)a.push(y),y=y.right;else for(a.pop();a.length>0&&a[a.length-1].left===y;)y=a[a.length-1],a.pop()}},Object.defineProperty(o,"hasPrev",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].left)return!0;for(var y=a.length-1;y>0;--y)if(a[y-1].right===a[y])return!0;return!1}})},{}],70:[function(t,k,x){"use strict";k.exports=function(b,w){var T=new s(b);return T.update(w),T};var e=t("./lib/text.js"),r=t("./lib/lines.js"),i=t("./lib/background.js"),c=t("./lib/cube.js"),n=t("./lib/ticks.js"),m=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function p(b,w){return b[0]=w[0],b[1]=w[1],b[2]=w[2],b}function s(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=i(b)}var f=s.prototype;function l(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}f.update=function(b){function w(Z,W,G){if(G in b){var X,ne=b[G],V=this[G];this[G]=X=(Z?Array.isArray(ne)&&Array.isArray(ne[0]):Array.isArray(ne))?[W(ne[0]),W(ne[1]),W(ne[2])]:[W(ne),W(ne),W(ne)];for(var N=0;N<3;++N)if(X[N]!==V[N])return!0}return!1}b=b||{};var T,L=w.bind(this,!1,Number),M=w.bind(this,!1,Boolean),P=w.bind(this,!1,String),z=w.bind(this,!0,function(Z){if(Array.isArray(Z)){if(3===Z.length)return[+Z[0],+Z[1],+Z[2],1];if(4===Z.length)return[+Z[0],+Z[1],+Z[2],+Z[3]]}return[0,0,0,1]}),S=!1,C=!1;if("bounds"in b)for(var R=b.bounds,D=0;D<2;++D)for(var j=0;j<3;++j)R[D][j]!==this.bounds[D][j]&&(C=!0),this.bounds[D][j]=R[D][j];if("ticks"in b)for(T=b.ticks,S=!0,this.autoTicks=!1,D=0;D<3;++D)this.tickSpacing[D]=0;else L("tickSpacing")&&(this.autoTicks=!0,C=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),C=!0,S=!0,this._firstInit=!1),C&&this.autoTicks&&(T=n.create(this.bounds,this.tickSpacing),S=!0),S){for(D=0;D<3;++D)T[D].sort(function(Z,W){return Z.x-W.x});n.equal(T,this.ticks)?S=!1:this.ticks=T}M("tickEnable"),P("tickFont")&&(S=!0),L("tickSize"),L("tickAngle"),L("tickPad"),z("tickColor");var q=P("labels");P("labelFont")&&(q=!0),M("labelEnable"),L("labelSize"),L("labelPad"),z("labelColor"),M("lineEnable"),M("lineMirror"),L("lineWidth"),z("lineColor"),M("lineTickEnable"),M("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),z("lineTickColor"),M("gridEnable"),L("gridWidth"),z("gridColor"),M("zeroEnable"),z("zeroLineColor"),L("zeroLineWidth"),M("backgroundEnable"),z("backgroundColor"),this._text?this._text&&(q||S)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&S&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=r(this.gl,this.bounds,this.ticks))};var o=[new l,new l,new l];function d(b,w,T,L,M){for(var P=b.primalOffset,z=b.primalMinor,S=b.mirrorOffset,C=b.mirrorMinor,R=L[w],D=0;D<3;++D)if(w!==D){var j=P,q=S,Z=z,W=C;R&1<<D&&(j=S,q=P,Z=C,W=z),j[D]=T[0][D],q[D]=T[1][D],M[D]>0?(Z[D]=-1,W[D]=0):(Z[D]=0,W[D]=1)}}var u=[0,0,0],a={model:m,view:m,projection:m,_ortho:!1};f.isOpaque=function(){return!0},f.isTransparent=function(){return!1},f.drawTransparent=function(b){};var y=[0,0,0],h=[0,0,0],_=[0,0,0];f.draw=function(b){for(var w=this.gl,T=(b=b||a).model||m,L=b.view||m,M=b.projection||m,P=this.bounds,z=b._ortho||!1,S=c(T,L,M,P,z),C=S.cubeEdges,R=S.axis,W=(z?2:1)*this.pixelRatio*(M[3]*L[12]+M[7]*L[13]+M[11]*L[14]+M[15]*L[15])/w.drawingBufferHeight,G=0;G<3;++G)this.lastCubeProps.cubeEdges[G]=C[G],this.lastCubeProps.axis[G]=R[G];var X=o;for(G=0;G<3;++G)d(o[G],G,this.bounds,C,R);w=this.gl;var ne,ce,oe,Te,se,de,Ae,Le,Me,De,Oe,Ie,V=u;for(G=0;G<3;++G)V[G]=this.backgroundEnable[G]?R[G]:0;for(this._background.draw(T,L,M,P,V,this.backgroundColor),this._lines.bind(T,L,M,this),G=0;G<3;++G){var N=[0,0,0];N[G]=R[G]>0?P[1][G]:P[0][G];for(var U=0;U<2;++U){var ee=(G+1+U)%3,B=(G+1+(1^U))%3;this.gridEnable[ee]&&this._lines.drawGrid(ee,B,this.bounds,N,this.gridColor[ee],this.gridWidth[ee]*this.pixelRatio)}for(U=0;U<2;++U)ee=(G+1+U)%3,this.zeroEnable[B=(G+1+(1^U))%3]&&Math.min(P[0][B],P[1][B])<=0&&Math.max(P[0][B],P[1][B])>=0&&this._lines.drawZero(ee,B,this.bounds,N,this.zeroLineColor[B],this.zeroLineWidth[B]*this.pixelRatio)}for(G=0;G<3;++G){this.lineEnable[G]&&this._lines.drawAxisLine(G,this.bounds,X[G].primalOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio),this.lineMirror[G]&&this._lines.drawAxisLine(G,this.bounds,X[G].mirrorOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio);var K=p(y,X[G].primalMinor),J=p(h,X[G].mirrorMinor),te=this.lineTickLength;for(U=0;U<3;++U){var ae=W/T[5*U];K[U]*=te[U]*ae,J[U]*=te[U]*ae}this.lineTickEnable[G]&&this._lines.drawAxisTicks(G,X[G].primalOffset,K,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio),this.lineTickMirror[G]&&this._lines.drawAxisTicks(G,X[G].mirrorOffset,J,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio)}function ve(Te){(oe=[0,0,0])[Te]=1}for(this._lines.unbind(),this._text.bind(T,L,M,this.pixelRatio),G=0;G<3;++G){var xe=X[G].primalMinor,Se=X[G].mirrorMinor,pe=p(_,X[G].primalOffset);for(U=0;U<3;++U)this.lineTickEnable[G]&&(pe[U]+=W*xe[U]*Math.max(this.lineTickLength[U],0)/T[5*U]);var ge=[0,0,0];if(ge[G]=1,this.tickEnable[G]){for(-3600===this.tickAngle[G]?(this.tickAngle[G]=0,this.tickAlign[G]="auto"):this.tickAlign[G]=-1,ne[0]="auto"===(ne=[this.tickAlign[G],.5,ce=1])[0]?0:parseInt(""+ne[0]),oe=[0,0,0],Ae=void 0,Le=void 0,Me=void 0,De=void 0,Oe=void 0,Ie=void 0,De=(se=xe)[Le=((Te=G)+2)%3],Oe=(de=Se)[Ae=(Te+1)%3],Ie=de[Le],(Me=se[Ae])>0&&Ie>0||Me>0&&Ie<0||Me<0&&Ie>0||Me<0&&Ie<0?ve(Ae):(De>0&&Oe>0||De>0&&Oe<0||De<0&&Oe>0||De<0&&Oe<0)&&ve(Le),U=0;U<3;++U)pe[U]+=W*xe[U]*this.tickPad[U]/T[5*U];this._text.drawTicks(G,this.tickSize[G],this.tickAngle[G],pe,this.tickColor[G],ge,oe,ne)}if(this.labelEnable[G]){for(ce=0,oe=[0,0,0],this.labels[G].length>4&&(ve(G),ce=1),ne[0]="auto"===(ne=[this.labelAlign[G],.5,ce])[0]?0:parseInt(""+ne[0]),U=0;U<3;++U)pe[U]+=W*xe[U]*this.labelPad[U]/T[5*U];pe[G]+=.5*(P[0][G]+P[1][G]),this._text.drawLabel(G,this.labelSize[G],this.labelAngle[G],pe,this.labelColor[G],[0,0,0],oe,ne)}}this._text.unbind()},f.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(t,k,x){"use strict";k.exports=function(m){for(var p=[],s=[],f=0,l=0;l<3;++l)for(var o=(l+1)%3,d=(l+2)%3,u=[0,0,0],a=[0,0,0],y=-1;y<=1;y+=2){s.push(f,f+2,f+1,f+1,f+2,f+3),u[l]=y,a[l]=y;for(var h=-1;h<=1;h+=2){u[o]=h;for(var _=-1;_<=1;_+=2)u[d]=_,p.push(u[0],u[1],u[2],a[0],a[1],a[2]),f+=1}var b=o;o=d,d=b}var w=e(m,new Float32Array(p)),T=e(m,new Uint16Array(s),m.ELEMENT_ARRAY_BUFFER),L=r(m,[{buffer:w,type:m.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:m.FLOAT,size:3,offset:12,stride:24}],T),M=i(m);return M.attributes.position.location=0,M.attributes.normal.location=1,new c(m,w,L,M)};var e=t("gl-buffer"),r=t("gl-vao"),i=t("./shaders").bg;function c(m,p,s,f){this.gl=m,this.buffer=p,this.vao=s,this.shader=f}var n=c.prototype;n.draw=function(m,p,s,f,l,o){for(var d=!1,u=0;u<3;++u)d=d||l[u];if(d){var a=this.gl;a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:m,view:p,projection:s,bounds:f,enable:l,colors:o},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),a.disable(a.POLYGON_OFFSET_FILL)}},n.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(t,k,x){"use strict";k.exports=function(h,_,b,w,T){r(n,_,h),r(n,b,n);for(var L=0,M=0;M<2;++M){s[2]=w[M][2];for(var P=0;P<2;++P){s[1]=w[P][1];for(var z=0;z<2;++z)s[0]=w[z][0],l(m[L],s,n),L+=1}}var S=-1;for(M=0;M<8;++M){for(var C=m[M][3],R=0;R<3;++R)p[M][R]=m[M][R]/C;T&&(p[M][2]*=-1),C<0&&(S<0||p[M][2]<p[S][2])&&(S=M)}if(S<0){S=0;for(var D=0;D<3;++D){for(var j=(D+2)%3,q=(D+1)%3,Z=-1,W=-1,G=0;G<2;++G){var X=(V=G<<D)+(G<<j)+(1-G<<q),ne=V+(1-G<<j)+(G<<q);c(p[V],p[X],p[ne],f)<0||(G?Z=1:W=1)}if(Z<0||W<0)W>Z&&(S|=1<<D);else{for(G=0;G<2;++G){X=(V=G<<D)+(G<<j)+(1-G<<q);var V,N=d([m[V],m[X],m[ne=V+(1-G<<j)+(G<<q)],m[V+(1<<j)+(1<<q)]]);G?Z=N:W=N}W>Z&&(S|=1<<D)}}}var U=7^S,ee=-1;for(M=0;M<8;++M)M!==S&&M!==U&&(ee<0||p[ee][1]>p[M][1])&&(ee=M);var B=-1;for(M=0;M<3;++M)(J=ee^1<<M)!==S&&J!==U&&(B<0&&(B=J),(q=p[J])[0]<p[B][0]&&(B=J));var K=-1;for(M=0;M<3;++M){var J;(J=ee^1<<M)!==S&&J!==U&&J!==B&&(K<0&&(K=J),(q=p[J])[0]>p[K][0]&&(K=J))}var te=u;te[0]=te[1]=te[2]=0,te[e.log2(B^ee)]=ee&B,te[e.log2(ee^K)]=ee&K;var ae=7^K;ae===S||ae===U?te[e.log2(K^(ae=7^B))]=ae&K:te[e.log2(B^ae)]=ae&B;var ce=a,oe=S;for(D=0;D<3;++D)ce[D]=oe&1<<D?-1:1;return y};var e=t("bit-twiddle"),r=t("gl-mat4/multiply"),i=t("split-polygon"),c=t("robust-orientation"),n=new Array(16),m=new Array(8),p=new Array(8),s=new Array(3),f=[0,0,0];function l(h,_,b){for(var w=0;w<4;++w){h[w]=b[12+w];for(var T=0;T<3;++T)h[w]+=_[T]*b[4*T+w]}}!function(){for(var h=0;h<8;++h)m[h]=[1,1,1,1],p[h]=[1,1,1]}();var o=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function d(h){for(var _=0;_<o.length;++_)if((h=i.positive(h,o[_])).length<3)return 0;var b=h[0],w=b[0]/b[3],T=b[1]/b[3],L=0;for(_=1;_+1<h.length;++_){var M=h[_],P=h[_+1];L+=Math.abs((M[0]/M[3]-w)*(P[1]/P[3]-T)-(M[1]/M[3]-T)*(P[0]/P[3]-w))}return L}var u=[1,1,1],a=[0,0,0],y={cubeEdges:u,axis:a}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(t,k,x){"use strict";k.exports=function(u,a,y){var h=[],_=[0,0,0],b=[0,0,0],w=[0,0,0],T=[0,0,0];h.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var M=h.length/3|0,P=0;P<y[L].length;++P){var z=+y[L][P].x;h.push(z,0,1,z,1,1,z,0,-1,z,0,-1,z,1,1,z,1,-1)}var S=h.length/3|0;_[L]=M,b[L]=S-M,M=h.length/3|0;for(var C=0;C<y[L].length;++C)h.push(z=+y[L][C].x,0,1,z,1,1,z,0,-1,z,0,-1,z,1,1,z,1,-1);S=h.length/3|0,w[L]=M,T[L]=S-M}var R=e(u,new Float32Array(h)),D=r(u,[{buffer:R,type:u.FLOAT,size:3,stride:0,offset:0}]),j=i(u);return j.attributes.position.location=0,new o(u,R,D,j,b,_,T,w)};var e=t("gl-buffer"),r=t("gl-vao"),i=t("./shaders").line,c=[0,0,0],n=[0,0,0],m=[0,0,0],p=[0,0,0],s=[1,1];function f(u){return u[0]=u[1]=u[2]=0,u}function l(u,a){return u[0]=a[0],u[1]=a[1],u[2]=a[2],u}function o(u,a,y,h,_,b,w,T){this.gl=u,this.vertBuffer=a,this.vao=y,this.shader=h,this.tickCount=_,this.tickOffset=b,this.gridCount=w,this.gridOffset=T}var d=o.prototype;d.bind=function(u,a,y){this.shader.bind(),this.shader.uniforms.model=u,this.shader.uniforms.view=a,this.shader.uniforms.projection=y,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=s,this.vao.bind()},d.unbind=function(){this.vao.unbind()},d.drawAxisLine=function(u,a,y,h,_){var b=f(n);this.shader.uniforms.majorAxis=n,b[u]=a[1][u]-a[0][u],this.shader.uniforms.minorAxis=b;var w,T=l(p,y);T[u]+=a[0][u],this.shader.uniforms.offset=T,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=h,(w=f(m))[(u+2)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6),(w=f(m))[(u+1)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6)},d.drawAxisTicks=function(u,a,y,h,_){if(this.tickCount[u]){var b=f(c);b[u]=1,this.shader.uniforms.majorAxis=b,this.shader.uniforms.offset=a,this.shader.uniforms.minorAxis=y,this.shader.uniforms.color=h,this.shader.uniforms.lineWidth=_;var w=f(m);w[u]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,this.tickCount[u],this.tickOffset[u])}},d.drawGrid=function(u,a,y,h,_,b){if(this.gridCount[u]){var w=f(n);w[a]=y[1][a]-y[0][a],this.shader.uniforms.minorAxis=w;var T=l(p,h);T[a]+=y[0][a],this.shader.uniforms.offset=T;var L=f(c);L[u]=1,this.shader.uniforms.majorAxis=L;var M=f(m);M[u]=1,this.shader.uniforms.screenAxis=M,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[u],this.gridOffset[u])}},d.drawZero=function(u,a,y,h,_,b){var w=f(n);this.shader.uniforms.majorAxis=w,w[u]=y[1][u]-y[0][u],this.shader.uniforms.minorAxis=w;var T=l(p,h);T[u]+=y[0][u],this.shader.uniforms.offset=T;var L=f(m);L[a]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},d.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(t,k,x){"use strict";var e=t("glslify"),r=t("gl-shader"),i=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),c=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);x.line=function(f){return r(f,i,c,null,[{name:"position",type:"vec3"}])};var n=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),m=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);x.text=function(f){return r(f,n,m,null,[{name:"position",type:"vec3"}])};var p=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),s=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);x.bg=function(f){return r(f,p,s,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(t,k,x){(function(e){(function(){"use strict";k.exports=function(o,d,u,a,y,h){var _=r(o),b=i(o,[{buffer:_,size:3}]),w=n(o);w.attributes.position.location=0;var T=new s(o,w,_,b);return T.update(d,u,a,y,h),T};var r=t("gl-buffer"),i=t("gl-vao"),c=t("vectorize-text"),n=t("./shaders").text,m=window||e.global||{},p=m.__TEXT_CACHE||{};function s(o,d,u,a){this.gl=o,this.shader=d,this.buffer=u,this.vao=a,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}m.__TEXT_CACHE={};var f=s.prototype,l=[0,0];f.bind=function(o,d,u,a){this.vao.bind(),this.shader.bind();var y=this.shader.uniforms;y.model=o,y.view=d,y.projection=u,y.pixelScale=a,l[0]=this.gl.drawingBufferWidth,l[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=l},f.unbind=function(){this.vao.unbind()},f.update=function(o,d,u,a,y){var h=[];function _(S,C,R,D,j,q){var Z=p[R];Z||(Z=p[R]={});var W=Z[C];W||(W=Z[C]=function(K,J){try{return c(K,J)}catch(te){return console.warn('error vectorizing text:"'+K+'" error:',te),{cells:[],positions:[]}}}(C,{triangles:!0,font:R,textAlign:"center",textBaseline:"middle",lineSpacing:j,styletags:q}));for(var G=(D||12)/12,X=W.positions,ne=W.cells,V=0,N=ne.length;V<N;++V)for(var U=ne[V],ee=2;ee>=0;--ee){var B=X[U[ee]];h.push(G*B[0],-G*B[1],S)}}for(var b=[0,0,0],w=[0,0,0],T=[0,0,0],L=[0,0,0],M={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},P=0;P<3;++P){T[P]=h.length/3|0,_(.5*(o[0][P]+o[1][P]),d[P],u[P],12,1.25,M),L[P]=(h.length/3|0)-T[P],b[P]=h.length/3|0;for(var z=0;z<a[P].length;++z)a[P][z].text&&_(a[P][z].x,a[P][z].text,a[P][z].font||y,a[P][z].fontSize||12,1.25,M);w[P]=(h.length/3|0)-b[P]}this.buffer.update(h),this.tickOffset=b,this.tickCount=w,this.labelOffset=T,this.labelCount=L},f.drawTicks=function(o,d,u,a,y,h,_,b){this.tickCount[o]&&(this.shader.uniforms.axis=h,this.shader.uniforms.color=y,this.shader.uniforms.angle=u,this.shader.uniforms.scale=d,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[o],this.tickOffset[o]))},f.drawLabel=function(o,d,u,a,y,h,_,b){this.labelCount[o]&&(this.shader.uniforms.axis=h,this.shader.uniforms.color=y,this.shader.uniforms.angle=u,this.shader.uniforms.scale=d,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.labelCount[o],this.labelOffset[o]))},f.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,t("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(t,k,x){"use strict";function e(r,i){var c=r+"",n=c.indexOf("."),m=0;n>=0&&(m=c.length-n-1);var p=Math.pow(10,m),s=Math.round(r*i*p),f=s+"";if(f.indexOf("e")>=0)return f;var l=s/p,o=s%p;s<0?(l=0|-Math.ceil(l),o=0|-o):(l=0|Math.floor(l),o|=0);var d=""+l;if(s<0&&(d="-"+d),m){for(var u=""+o;u.length<m;)u="0"+u;return d+"."+u}return d}x.create=function(r,i){for(var c=[],n=0;n<3;++n){for(var m=[],p=0;p*i[n]<=r[1][n];++p)m.push({x:p*i[n],text:e(i[n],p)});for(p=-1;p*i[n]>=r[0][n];--p)m.push({x:p*i[n],text:e(i[n],p)});c.push(m)}return c},x.equal=function(r,i){for(var c=0;c<3;++c){if(r[c].length!==i[c].length)return!1;for(var n=0;n<r[c].length;++n){var m=r[c][n],p=i[c][n];if(m.x!==p.x||m.text!==p.text||m.font!==p.font||m.fontColor!==p.fontColor||m.fontSize!==p.fontSize||m.dx!==p.dx||m.dy!==p.dy)return!1}}return!0}},{}],77:[function(t,k,x){"use strict";k.exports=function(y,h,_,b,w){var T=h.model||p,L=h.view||p,M=h.projection||p,P=h._ortho||!1,z=y.bounds,S=(w=w||i(T,L,M,z,P)).axis;c(s,L,T),c(s,M,s);for(var C=u,R=0;R<3;++R)C[R].lo=1/0,C[R].hi=-1/0,C[R].pixelsPerDataUnit=1/0;var D=e(n(s,s));n(s,s);for(var j=0;j<3;++j){var q=(j+1)%3,Z=(j+2)%3,W=a;e:for(R=0;R<2;++R){var G=[];if(S[j]<0!=!!R){W[j]=z[R][j];for(var X=0;X<2;++X){W[q]=z[X^R][q];for(var ne=0;ne<2;++ne)W[Z]=z[ne^X^R][Z],G.push(W.slice())}var V=P?5:4;for(X=V;X===V;++X){if(0===G.length)continue e;G=r.positive(G,D[X])}for(X=0;X<G.length;++X){var N=d(a,s,Z=G[X],_,b);for(ne=0;ne<3;++ne)C[ne].lo=Math.min(C[ne].lo,Z[ne]),C[ne].hi=Math.max(C[ne].hi,Z[ne]),ne!==j&&(C[ne].pixelsPerDataUnit=Math.min(C[ne].pixelsPerDataUnit,Math.abs(N[ne])))}}}}return C};var e=t("extract-frustum-planes"),r=t("split-polygon"),i=t("./lib/cube.js"),c=t("gl-mat4/multiply"),n=t("gl-mat4/transpose"),m=t("gl-vec4/transformMat4"),p=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),s=new Float32Array(16);function f(y,h,_){this.lo=y,this.hi=h,this.pixelsPerDataUnit=_}var l=[0,0,0,1],o=[0,0,0,1];function d(y,h,_,b,w){for(var T=0;T<3;++T){for(var L=l,M=o,P=0;P<3;++P)M[P]=L[P]=_[P];M[3]=L[3]=1,M[T]+=1,m(M,M,h),M[3]<0&&(y[T]=1/0),L[T]-=1,m(L,L,h),L[3]<0&&(y[T]=1/0);var z=(L[0]/L[3]-M[0]/M[3])*b,S=(L[1]/L[3]-M[1]/M[3])*w;y[T]=.25*Math.sqrt(z*z+S*S)}return y}var u=[new f(1/0,-1/0,1/0),new f(1/0,-1/0,1/0),new f(1/0,-1/0,1/0)],a=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(t,k,x){"use strict";var e=t("typedarray-pool"),r=t("ndarray-ops"),i=t("ndarray"),c=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function n(f,l,o,d,u){this.gl=f,this.type=l,this.handle=o,this.length=d,this.usage=u}var m=n.prototype;function p(f,l,o,d,u,a){var y=u.length*u.BYTES_PER_ELEMENT;if(a<0)return f.bufferData(l,u,d),y;if(y+a>o)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return f.bufferSubData(l,a,u),o}m.bind=function(){this.gl.bindBuffer(this.type,this.handle)},m.unbind=function(){this.gl.bindBuffer(this.type,null)},m.dispose=function(){this.gl.deleteBuffer(this.handle)},m.update=function(f,l){if("number"!=typeof l&&(l=-1),this.bind(),"object"==typeof f&&void 0!==f.shape){var o=f.dtype;if(c.indexOf(o)<0&&(o="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(o=gl.getExtension("OES_element_index_uint")&&"uint16"!==o?"uint32":"uint16"),o===f.dtype&&function(y,h){for(var _=1,b=h.length-1;b>=0;--b){if(h[b]!==_)return!1;_*=y[b]}return!0}(f.shape,f.stride))this.length=p(this.gl,this.type,this.length,this.usage,0===f.offset&&f.data.length===f.shape[0]?f.data:f.data.subarray(f.offset,f.shape[0]),l);else{var d=e.malloc(f.size,o),u=i(d,f.shape);r.assign(u,f),this.length=p(this.gl,this.type,this.length,this.usage,l<0?d:d.subarray(0,f.size),l),e.free(d)}}else if(Array.isArray(f)){var a;a=function s(f,l){for(var o=e.malloc(f.length,l),d=f.length,u=0;u<d;++u)o[u]=f[u];return o}(f,this.type===this.gl.ELEMENT_ARRAY_BUFFER?"uint16":"float32"),this.length=p(this.gl,this.type,this.length,this.usage,l<0?a:a.subarray(0,f.length),l),e.free(a)}else if("object"==typeof f&&"number"==typeof f.length)this.length=p(this.gl,this.type,this.length,this.usage,f,l);else{if("number"!=typeof f&&void 0!==f)throw new Error("gl-buffer: Invalid data type");if(l>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(f|=0)<=0&&(f=1),this.gl.bufferData(this.type,0|f,this.usage),this.length=f}},k.exports=function(f,l,o,d){if(d=d||f.DYNAMIC_DRAW,(o=o||f.ARRAY_BUFFER)!==f.ARRAY_BUFFER&&o!==f.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(d!==f.DYNAMIC_DRAW&&d!==f.STATIC_DRAW&&d!==f.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var u=f.createBuffer(),a=new n(f,o,u,0,d);return a.update(l),a}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(t,k,x){"use strict";var e=t("gl-vec3");k.exports=function(i,c){var n=i.positions,m=i.vectors,p={positions:[],vertexIntensity:[],vertexIntensityBounds:i.vertexIntensityBounds,vectors:[],cells:[],coneOffset:i.coneOffset,colormap:i.colormap};if(0===i.positions.length)return c&&(c[0]=[0,0,0],c[1]=[0,0,0]),p;for(var s=0,f=1/0,l=-1/0,o=1/0,d=-1/0,u=1/0,a=-1/0,y=null,h=null,_=[],b=1/0,w=!1,T=0;T<n.length;T++){var L=n[T];f=Math.min(L[0],f),l=Math.max(L[0],l),o=Math.min(L[1],o),d=Math.max(L[1],d),u=Math.min(L[2],u),a=Math.max(L[2],a);var M=m[T];if(e.length(M)>s&&(s=e.length(M)),T){var P=2*e.distance(y,L)/(e.length(h)+e.length(M));P?(b=Math.min(b,P),w=!1):w=!0}w||(y=L,h=M),_.push(M)}var S=[l,d,a];c&&(c[0]=[f,o,u],c[1]=S),0===s&&(s=1);var C=1/s;isFinite(b)||(b=1),p.vectorScale=b;var R=i.coneSize||.5;i.absoluteConeSize&&(R=i.absoluteConeSize*C),p.coneScale=R,T=0;for(var D=0;T<n.length;T++)for(var j=(L=n[T])[0],q=L[1],Z=L[2],W=_[T],G=e.length(W)*C,X=0;X<8;X++){p.positions.push([j,q,Z,D++]),p.positions.push([j,q,Z,D++]),p.positions.push([j,q,Z,D++]),p.positions.push([j,q,Z,D++]),p.positions.push([j,q,Z,D++]),p.positions.push([j,q,Z,D++]),p.vectors.push(W),p.vectors.push(W),p.vectors.push(W),p.vectors.push(W),p.vectors.push(W),p.vectors.push(W),p.vertexIntensity.push(G,G,G),p.vertexIntensity.push(G,G,G);var ne=p.positions.length;p.cells.push([ne-6,ne-5,ne-4],[ne-3,ne-2,ne-1])}return p};var r=t("./lib/shaders");k.exports.createMesh=t("./create_mesh"),k.exports.createConeMesh=function(i,c){return k.exports.createMesh(i,c,{shaders:r,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(t,k,x){"use strict";var e=t("gl-shader"),r=t("gl-buffer"),i=t("gl-vao"),c=t("gl-texture2d"),n=t("gl-mat4/multiply"),m=t("gl-mat4/invert"),p=t("ndarray"),s=t("colormap"),f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(a,y,h,_,b,w,T,L,M,P,z){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=y,this.dirty=!0,this.triShader=h,this.pickShader=_,this.trianglePositions=b,this.triangleVectors=w,this.triangleColors=L,this.triangleUVs=M,this.triangleIds=T,this.triangleVAO=P,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=z,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=f,this._view=f,this._projection=f,this._resolution=[1,1]}var o=l.prototype;function d(a,y){var h=e(a,y.meshShader.vertex,y.meshShader.fragment,null,y.meshShader.attributes);return h.attributes.position.location=0,h.attributes.color.location=2,h.attributes.uv.location=3,h.attributes.vector.location=4,h}function u(a,y){var h=e(a,y.pickShader.vertex,y.pickShader.fragment,null,y.pickShader.attributes);return h.attributes.position.location=0,h.attributes.id.location=1,h.attributes.vector.location=4,h}o.isOpaque=function(){return this.opacity>=1},o.isTransparent=function(){return this.opacity<1},o.pickSlots=1,o.setPickBase=function(a){this.pickId=a},o.update=function(a){a=a||{};var y=this.gl;this.dirty=!0,"lightPosition"in a&&(this.lightPosition=a.lightPosition),"opacity"in a&&(this.opacity=a.opacity),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),void 0!==a.tubeScale&&(this.tubeScale=a.tubeScale),void 0!==a.vectorScale&&(this.vectorScale=a.vectorScale),void 0!==a.coneScale&&(this.coneScale=a.coneScale),void 0!==a.coneOffset&&(this.coneOffset=a.coneOffset),a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=y.LINEAR,this.texture.setPixels(function(ee){for(var B=s({colormap:ee,nshades:256,format:"rgba"}),K=new Uint8Array(1024),J=0;J<256;++J){for(var te=B[J],ae=0;ae<3;++ae)K[4*J+ae]=te[ae];K[4*J+3]=255*te[3]}return p(K,[256,256,4],[4,0,1])}(a.colormap)),this.texture.generateMipmap());var h=a.cells,_=a.positions,b=a.vectors;if(_&&h&&b){var w=[],T=[],L=[],M=[],P=[];this.cells=h,this.positions=_,this.vectors=b;var z=a.meshColor||[1,1,1,1],S=a.vertexIntensity,C=1/0,R=-1/0;if(S)if(a.vertexIntensityBounds)C=+a.vertexIntensityBounds[0],R=+a.vertexIntensityBounds[1];else for(var D=0;D<S.length;++D){var j=S[D];C=Math.min(C,j),R=Math.max(R,j)}else for(D=0;D<_.length;++D)j=_[D][2],C=Math.min(C,j),R=Math.max(R,j);for(this.intensity=S||function(ee){for(var B=ee.length,K=new Array(B),J=0;J<B;++J)K[J]=ee[J][2];return K}(_),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],D=0;D<_.length;++D)for(var q=_[D],Z=0;Z<3;++Z)!isNaN(q[Z])&&isFinite(q[Z])&&(this.bounds[0][Z]=Math.min(this.bounds[0][Z],q[Z]),this.bounds[1][Z]=Math.max(this.bounds[1][Z],q[Z]));var W=0;e:for(D=0;D<h.length;++D){var G=h[D];if(3===G.length){for(Z=0;Z<3;++Z){q=_[ne=G[Z]];for(var X=0;X<3;++X)if(isNaN(q[X])||!isFinite(q[X]))continue e}for(Z=0;Z<3;++Z){var ne;q=_[ne=G[2-Z]],w.push(q[0],q[1],q[2],q[3]);var V=b[ne];T.push(V[0],V[1],V[2],V[3]||0);var N;L.push(z[0],z[1],z[2],3===z.length?1:z[3]),M.push((N=S?[(S[ne]-C)/(R-C),0]:[(q[2]-C)/(R-C),0])[0],N[1]),P.push(D)}W+=1}}this.triangleCount=W,this.trianglePositions.update(w),this.triangleVectors.update(T),this.triangleColors.update(L),this.triangleUVs.update(M),this.triangleIds.update(new Uint32Array(P))}},o.drawTransparent=o.draw=function(a){for(var y=this.gl,h=(a=a||{}).model||f,_=a.view||f,b=a.projection||f,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)w[0][T]=Math.max(w[0][T],this.clipBounds[0][T]),w[1][T]=Math.min(w[1][T],this.clipBounds[1][T]);var L={model:h,view:_,projection:b,inverseModel:f.slice(),clipBounds:w,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};L.inverseModel=m(L.inverseModel,L.model),y.disable(y.CULL_FACE),this.texture.bind(0);var M=new Array(16);for(n(M,L.view,L.model),n(M,L.projection,M),m(M,M),T=0;T<3;++T)L.eyePosition[T]=M[12+T]/M[15];var P=M[15];for(T=0;T<3;++T)P+=this.lightPosition[T]*M[4*T+3];for(T=0;T<3;++T){for(var z=M[12+T],S=0;S<3;++S)z+=M[4*S+T]*this.lightPosition[S];L.lightPosition[T]=z/P}if(this.triangleCount>0){var C=this.triShader;C.bind(),C.uniforms=L,this.triangleVAO.bind(),y.drawArrays(y.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},o.drawPick=function(a){for(var y=this.gl,h=(a=a||{}).model||f,_=a.view||f,b=a.projection||f,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)w[0][T]=Math.max(w[0][T],this.clipBounds[0][T]),w[1][T]=Math.min(w[1][T],this.clipBounds[1][T]);this._model=[].slice.call(h),this._view=[].slice.call(_),this._projection=[].slice.call(b),this._resolution=[y.drawingBufferWidth,y.drawingBufferHeight];var L={model:h,view:_,projection:b,clipBounds:w,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},M=this.pickShader;M.bind(),M.uniforms=L,this.triangleCount>0&&(this.triangleVAO.bind(),y.drawArrays(y.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},o.pick=function(a){if(!a||a.id!==this.pickId)return null;var y=a.value[0]+256*a.value[1]+65536*a.value[2],h=this.cells[y],_=this.positions[h[1]].slice(0,3),b={position:_,dataCoordinate:_,index:Math.floor(h[1]/48)};return"cone"===this.traceType?b.index=Math.floor(h[1]/48):"streamtube"===this.traceType&&(b.intensity=this.intensity[h[1]],b.velocity=this.vectors[h[1]].slice(0,3),b.divergence=this.vectors[h[1]][3],b.index=y),b},o.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},k.exports=function(a,y,h){var _=h.shaders;1===arguments.length&&(a=(y=a).gl);var b=d(a,_),w=u(a,_),T=c(a,p(new Uint8Array([255,255,255,255]),[1,1,4]));T.generateMipmap(),T.minFilter=a.LINEAR_MIPMAP_LINEAR,T.magFilter=a.LINEAR;var L=r(a),M=r(a),P=r(a),z=r(a),S=r(a),R=new l(a,T,b,w,L,M,S,P,z,i(a,[{buffer:L,type:a.FLOAT,size:4},{buffer:S,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:P,type:a.FLOAT,size:4},{buffer:z,type:a.FLOAT,size:2},{buffer:M,type:a.FLOAT,size:4}]),h.traceType||"cone");return R.update(y),R}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(t,k,x){var e=t("glslify"),r=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),i=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),c=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),n=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);x.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},x.pickShader={vertex:c,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(t,k,x){k.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(t,k,x){var e=t("./1.0/numbers");k.exports=function(r){return e[r]}},{"./1.0/numbers":82}],84:[function(t,k,x){"use strict";k.exports=function(l){var o=l.gl,d=e(o),u=r(o,[{buffer:d,type:o.FLOAT,size:3,offset:0,stride:40},{buffer:d,type:o.FLOAT,size:4,offset:12,stride:40},{buffer:d,type:o.FLOAT,size:3,offset:28,stride:40}]),a=i(o);a.attributes.position.location=0,a.attributes.color.location=1,a.attributes.offset.location=2;var y=new n(o,d,u,a);return y.update(l),y};var e=t("gl-buffer"),r=t("gl-vao"),i=t("./shaders/index"),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function n(l,o,d,u){this.gl=l,this.shader=u,this.buffer=o,this.vao=d,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var m=n.prototype;function p(l,o){for(var d=0;d<3;++d)l[0][d]=Math.min(l[0][d],o[d]),l[1][d]=Math.max(l[1][d],o[d])}m.isOpaque=function(){return!this.hasAlpha},m.isTransparent=function(){return this.hasAlpha},m.drawTransparent=m.draw=function(l){var o=this.gl,d=this.shader.uniforms;this.shader.bind();var u=d.view=l.view||c,a=d.projection=l.projection||c;d.model=l.model||c,d.clipBounds=this.clipBounds,d.opacity=this.opacity;var w=(l._ortho?2:1)*this.pixelRatio*(a[3]*u[12]+a[7]*u[13]+a[11]*u[14]+a[15]*u[15])/o.drawingBufferHeight;this.vao.bind();for(var T=0;T<3;++T)o.lineWidth(this.lineWidth[T]*this.pixelRatio),d.capSize=this.capSize[T]*w,this.lineCount[T]&&o.drawArrays(o.LINES,this.lineOffset[T],this.lineCount[T]);this.vao.unbind()};var s=function(){for(var l=new Array(3),o=0;o<3;++o){for(var d=[],u=1;u<=2;++u)for(var a=-1;a<=1;a+=2){var y=[0,0,0];y[(u+o)%3]=a,d.push(y)}l[o]=d}return l}();function f(l,o,d,u){for(var a=s[u],y=0;y<a.length;++y){var h=a[y];l.push(o[0],o[1],o[2],d[0],d[1],d[2],d[3],h[0],h[1],h[2])}return a.length}m.update=function(l){"lineWidth"in(l=l||{})&&(this.lineWidth=l.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in l&&(this.capSize=l.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in l&&(this.opacity=+l.opacity,this.opacity<1&&(this.hasAlpha=!0));var o=l.color||[[0,0,0],[0,0,0],[0,0,0]],d=l.position,u=l.error;if(Array.isArray(o[0])||(o=[o,o,o]),d&&u){var a=[],y=d.length,h=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=h;e:for(var b=0;b<y;++b){for(var w=d[b],T=0;T<3;++T)if(isNaN(w[T])||!isFinite(w[T]))continue e;var P,L=u[b],M=o[_];Array.isArray(M[0])&&(M=o[b]),3===M.length?M=[M[0],M[1],M[2],1]:4===M.length&&(M=[M[0],M[1],M[2],M[3]],!this.hasAlpha&&M[3]<1&&(this.hasAlpha=!0)),isNaN(L[0][_])||isNaN(L[1][_])||(L[0][_]<0&&((P=w.slice())[_]+=L[0][_],a.push(w[0],w[1],w[2],M[0],M[1],M[2],M[3],0,0,0,P[0],P[1],P[2],M[0],M[1],M[2],M[3],0,0,0),p(this.bounds,P),h+=2+f(a,P,M,_)),L[1][_]>0&&((P=w.slice())[_]+=L[1][_],a.push(w[0],w[1],w[2],M[0],M[1],M[2],M[3],0,0,0,P[0],P[1],P[2],M[0],M[1],M[2],M[3],0,0,0),p(this.bounds,P),h+=2+f(a,P,M,_)))}this.lineCount[_]=h-this.lineOffset[_]}this.buffer.update(a)}},m.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(t,k,x){"use strict";var e=t("glslify"),r=t("gl-shader"),i=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),c=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);k.exports=function(n){return r(n,i,c,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(t,k,x){"use strict";var e=t("gl-texture2d");k.exports=function(y,h,_,b){r||(r=y.FRAMEBUFFER_UNSUPPORTED,i=y.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,c=y.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,n=y.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var w=y.getExtension("WEBGL_draw_buffers");if(!m&&w&&function(C,R){var D=C.getParameter(R.MAX_COLOR_ATTACHMENTS_WEBGL);m=new Array(D+1);for(var j=0;j<=D;++j){for(var q=new Array(D),Z=0;Z<j;++Z)q[Z]=C.COLOR_ATTACHMENT0+Z;for(Z=j;Z<D;++Z)q[Z]=C.NONE;m[j]=q}}(y,w),Array.isArray(h)&&(b=_,_=0|h[1],h=0|h[0]),"number"!=typeof h)throw new Error("gl-fbo: Missing shape parameter");var T=y.getParameter(y.MAX_RENDERBUFFER_SIZE);if(h<0||h>T||_<0||_>T)throw new Error("gl-fbo: Parameters are too large for FBO");var L=1;if("color"in(b=b||{})){if((L=Math.max(0|b.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(L>1){if(!w)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(L>y.getParameter(w.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+L+" draw buffers")}}var M=y.UNSIGNED_BYTE,P=y.getExtension("OES_texture_float");if(b.float&&L>0){if(!P)throw new Error("gl-fbo: Context does not support floating point textures");M=y.FLOAT}else b.preferFloat&&L>0&&P&&(M=y.FLOAT);var z=!0;"depth"in b&&(z=!!b.depth);var S=!1;return"stencil"in b&&(S=!!b.stencil),new d(y,h,_,M,L,z,S,w)};var r,i,c,n,m=null;function p(y){return[y.getParameter(y.FRAMEBUFFER_BINDING),y.getParameter(y.RENDERBUFFER_BINDING),y.getParameter(y.TEXTURE_BINDING_2D)]}function s(y,h){y.bindFramebuffer(y.FRAMEBUFFER,h[0]),y.bindRenderbuffer(y.RENDERBUFFER,h[1]),y.bindTexture(y.TEXTURE_2D,h[2])}function f(y){switch(y){case r:throw new Error("gl-fbo: Framebuffer unsupported");case i:throw new Error("gl-fbo: Framebuffer incomplete attachment");case c:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case n:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function l(y,h,_,b,w,T){if(!b)return null;var L=e(y,h,_,w,b);return L.magFilter=y.NEAREST,L.minFilter=y.NEAREST,L.mipSamples=1,L.bind(),y.framebufferTexture2D(y.FRAMEBUFFER,T,y.TEXTURE_2D,L.handle,0),L}function o(y,h,_,b,w){var T=y.createRenderbuffer();return y.bindRenderbuffer(y.RENDERBUFFER,T),y.renderbufferStorage(y.RENDERBUFFER,b,h,_),y.framebufferRenderbuffer(y.FRAMEBUFFER,w,y.RENDERBUFFER,T),T}function d(y,h,_,b,w,T,L,M){this.gl=y,this._shape=[0|h,0|_],this._destroyed=!1,this._ext=M,this.color=new Array(w);for(var P=0;P<w;++P)this.color[P]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=b,this._useDepth=T,this._useStencil=L;var z=this,S=[0|h,0|_];Object.defineProperties(S,{0:{get:function(){return z._shape[0]},set:function(C){return z.width=C}},1:{get:function(){return z._shape[1]},set:function(C){return z.height=C}}}),this._shapeVector=S,function(C){var R=p(C.gl),D=C.gl,j=C.handle=D.createFramebuffer(),q=C._shape[0],Z=C._shape[1],W=C.color.length,G=C._ext,X=C._useStencil,ne=C._useDepth,V=C._colorType;D.bindFramebuffer(D.FRAMEBUFFER,j);for(var N=0;N<W;++N)C.color[N]=l(D,q,Z,V,D.RGBA,D.COLOR_ATTACHMENT0+N);0===W?(C._color_rb=o(D,q,Z,D.RGBA4,D.COLOR_ATTACHMENT0),G&&G.drawBuffersWEBGL(m[0])):W>1&&G.drawBuffersWEBGL(m[W]);var U=D.getExtension("WEBGL_depth_texture");U?X?C.depth=l(D,q,Z,U.UNSIGNED_INT_24_8_WEBGL,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):ne&&(C.depth=l(D,q,Z,D.UNSIGNED_SHORT,D.DEPTH_COMPONENT,D.DEPTH_ATTACHMENT)):ne&&X?C._depth_rb=o(D,q,Z,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):ne?C._depth_rb=o(D,q,Z,D.DEPTH_COMPONENT16,D.DEPTH_ATTACHMENT):X&&(C._depth_rb=o(D,q,Z,D.STENCIL_INDEX,D.STENCIL_ATTACHMENT));var ee=D.checkFramebufferStatus(D.FRAMEBUFFER);if(ee!==D.FRAMEBUFFER_COMPLETE){for(C._destroyed=!0,D.bindFramebuffer(D.FRAMEBUFFER,null),D.deleteFramebuffer(C.handle),C.handle=null,C.depth&&(C.depth.dispose(),C.depth=null),C._depth_rb&&(D.deleteRenderbuffer(C._depth_rb),C._depth_rb=null),N=0;N<C.color.length;++N)C.color[N].dispose(),C.color[N]=null;C._color_rb&&(D.deleteRenderbuffer(C._color_rb),C._color_rb=null),s(D,R),f(ee)}s(D,R)}(this)}var u=d.prototype;function a(y,h,_){if(y._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(y._shape[0]!==h||y._shape[1]!==_){var b=y.gl,w=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(h<0||h>w||_<0||_>w)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");y._shape[0]=h,y._shape[1]=_;for(var T=p(b),L=0;L<y.color.length;++L)y.color[L].shape=y._shape;y._color_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,y._color_rb),b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,y._shape[0],y._shape[1])),y.depth&&(y.depth.shape=y._shape),y._depth_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,y._depth_rb),y._useDepth&&y._useStencil?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,y._shape[0],y._shape[1]):y._useDepth?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,y._shape[0],y._shape[1]):y._useStencil&&b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX,y._shape[0],y._shape[1])),b.bindFramebuffer(b.FRAMEBUFFER,y.handle);var M=b.checkFramebufferStatus(b.FRAMEBUFFER);M!==b.FRAMEBUFFER_COMPLETE&&(y.dispose(),s(b,T),f(M)),s(b,T)}}Object.defineProperties(u,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(y){if(Array.isArray(y)||(y=[0|y,0|y]),2!==y.length)throw new Error("gl-fbo: Shape vector must be length 2");var h=0|y[0],_=0|y[1];return a(this,h,_),[h,_]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(y){return a(this,y|=0,this._shape[1]),y},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(y){return a(this,this._shape[0],y|=0),y},enumerable:!1}}),u.bind=function(){if(!this._destroyed){var y=this.gl;y.bindFramebuffer(y.FRAMEBUFFER,this.handle),y.viewport(0,0,this._shape[0],this._shape[1])}},u.dispose=function(){if(!this._destroyed){this._destroyed=!0;var y=this.gl;y.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(y.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var h=0;h<this.color.length;++h)this.color[h].dispose(),this.color[h]=null;this._color_rb&&(y.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(t,k,x){var e=t("sprintf-js").sprintf,r=t("gl-constants/lookup"),i=t("glsl-shader-name"),c=t("add-line-numbers");k.exports=function(n,m,p){"use strict";var s=i(m)||"of unknown name (see npm glsl-shader-name)",f="unknown type";void 0!==p&&(f=p===r.FRAGMENT_SHADER?"fragment":"vertex");for(var l=e("Error compiling %s shader %s:\n",f,s),o=e("%s%s",l,n),d=n.split("\n"),u={},a=0;a<d.length;a++){var y=d[a];if(""!==y&&"\0"!==y){var h=parseInt(y.split(":")[2]);if(isNaN(h))throw new Error(e("Could not parse error: %s",y));u[h]=y}}var _=c(m).split("\n");for(a=0;a<_.length;a++)if((u[a+3]||u[a+2]||u[a+1])&&(l+=_[a]+"\n",u[a+1])){var w=u[a+1];w=w.substr(w.split(":",3).join(":").length+1).trim(),l+=e("^^^ %s\n\n",w)}return{long:l.trim(),short:o.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(t,k,x){"use strict";k.exports=function(o,d){var u=o.gl,T=new p(o,c(u,m.vertex,m.fragment),c(u,m.pickVertex,m.pickFragment),n(u),n(u),n(u),n(u));return T.update(d),o.addObject(T),T};var e=t("binary-search-bounds"),r=t("iota-array"),i=t("typedarray-pool"),c=t("gl-shader"),n=t("gl-buffer"),m=t("./lib/shaders");function p(o,d,u,a,y,h,_){this.plot=o,this.shader=d,this.pickShader=u,this.positionBuffer=a,this.weightBuffer=y,this.colorBuffer=h,this.idBuffer=_,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var s,o,d,f=p.prototype,l=[0,0,1,0,0,1,1,0,1,1,0,1];f.draw=(s=[1,0,0,0,1,0,0,0,1],function(){var o=this.plot,d=this.shader,u=this.bounds,a=this.numVertices;if(!(a<=0)){var y=o.gl,h=o.dataBox,b=u[3]-u[1],w=h[2]-h[0],T=h[3]-h[1];s[0]=2*(u[2]-u[0])/w,s[4]=2*b/T,s[6]=2*(u[0]-h[0])/w-1,s[7]=2*(u[1]-h[1])/T-1,d.bind();var L=d.uniforms;L.viewTransform=s,L.shape=this.shape;var M=d.attributes;this.positionBuffer.bind(),M.position.pointer(),this.weightBuffer.bind(),M.weight.pointer(y.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),M.color.pointer(y.UNSIGNED_BYTE,!0),y.drawArrays(y.TRIANGLES,0,a)}}),f.drawPick=(o=[1,0,0,0,1,0,0,0,1],d=[0,0,0,0],function(u){var a=this.plot,y=this.pickShader,h=this.bounds,_=this.numVertices;if(!(_<=0)){var b=a.gl,w=a.dataBox,L=h[3]-h[1],M=w[2]-w[0],P=w[3]-w[1];o[0]=2*(h[2]-h[0])/M,o[4]=2*L/P,o[6]=2*(h[0]-w[0])/M-1,o[7]=2*(h[1]-w[1])/P-1;for(var z=0;z<4;++z)d[z]=u>>8*z&255;this.pickOffset=u,y.bind();var S=y.uniforms;S.viewTransform=o,S.pickOffset=d,S.shape=this.shape;var C=y.attributes;return this.positionBuffer.bind(),C.position.pointer(),this.weightBuffer.bind(),C.weight.pointer(b.UNSIGNED_BYTE,!1),this.idBuffer.bind(),C.pickId.pointer(b.UNSIGNED_BYTE,!1),b.drawArrays(b.TRIANGLES,0,_),u+this.shape[0]*this.shape[1]}}),f.pick=function(o,d,u){var a=this.pickOffset;if(u<a||u>=a+this.shape[0]*this.shape[1])return null;var h=u-a;return{object:this,pointId:h,dataCoord:[this.xData[h%this.shape[0]],this.yData[h/this.shape[0]|0]]}},f.update=function(o){var d=(o=o||{}).shape||[0,0],u=o.x||r(d[0]),a=o.y||r(d[1]),y=o.z||new Float32Array(d[0]*d[1]),h=!1!==o.zsmooth;this.xData=u,this.yData=a;var _,b,w,T,L=o.colorLevels||[0],M=o.colorValues||[0,0,0,1],P=L.length,z=this.bounds;h?(_=z[0]=u[0],b=z[1]=a[0],w=z[2]=u[u.length-1],T=z[3]=a[a.length-1]):(_=z[0]=u[0]+(u[1]-u[0])/2,b=z[1]=a[0]+(a[1]-a[0])/2,w=z[2]=u[u.length-1]+(u[u.length-1]-u[u.length-2])/2,T=z[3]=a[a.length-1]+(a[a.length-1]-a[a.length-2])/2);var S=1/(w-_),C=1/(T-b),R=d[0],D=d[1];this.shape=[R,D];var j=(h?(R-1)*(D-1):R*D)*(l.length>>>1);this.numVertices=j;for(var q=i.mallocUint8(4*j),Z=i.mallocFloat32(2*j),W=i.mallocUint8(2*j),G=i.mallocUint32(j),X=0,ne=h?R-1:R,V=h?D-1:D,N=0;N<V;++N){var U,ee;h?(U=C*(a[N]-b),ee=C*(a[N+1]-b)):(U=N<D-1?C*(a[N]-(a[N+1]-a[N])/2-b):C*(a[N]-(a[N]-a[N-1])/2-b),ee=N<D-1?C*(a[N]+(a[N+1]-a[N])/2-b):C*(a[N]+(a[N]-a[N-1])/2-b));for(var B=0;B<ne;++B){var K,J;h?(K=S*(u[B]-_),J=S*(u[B+1]-_)):(K=B<R-1?S*(u[B]-(u[B+1]-u[B])/2-_):S*(u[B]-(u[B]-u[B-1])/2-_),J=B<R-1?S*(u[B]+(u[B+1]-u[B])/2-_):S*(u[B]+(u[B]-u[B-1])/2-_));for(var te=0;te<l.length;te+=2){var ae,ce,oe,ve,fe=l[te],xe=l[te+1],Se=y[h?(N+xe)*R+(B+fe):N*R+B],pe=e.le(L,Se);if(pe<0)ae=M[0],ce=M[1],oe=M[2],ve=M[3];else if(pe===P-1)ae=M[4*P-4],ce=M[4*P-3],oe=M[4*P-2],ve=M[4*P-1];else{var ge=(Se-L[pe])/(L[pe+1]-L[pe]),Te=1-ge,se=4*pe,de=4*(pe+1);ae=Te*M[se]+ge*M[de],ce=Te*M[se+1]+ge*M[de+1],oe=Te*M[se+2]+ge*M[de+2],ve=Te*M[se+3]+ge*M[de+3]}q[4*X]=255*ae,q[4*X+1]=255*ce,q[4*X+2]=255*oe,q[4*X+3]=255*ve,Z[2*X]=.5*K+.5*J,Z[2*X+1]=.5*U+.5*ee,W[2*X]=fe,W[2*X+1]=xe,G[X]=N*R+B,X+=1}}}this.positionBuffer.update(Z),this.weightBuffer.update(W),this.colorBuffer.update(q),this.idBuffer.update(G),i.free(Z),i.free(q),i.free(W),i.free(G)},f.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(t,k,x){"use strict";var e=t("glslify");k.exports={fragment:e(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:231}],90:[function(t,k,x){var e=t("glslify"),r=t("gl-shader"),i=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),c=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),n=e(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),m=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];x.createShader=function(p){return r(p,i,c,null,m)},x.createPickShader=function(p){return r(p,i,n,null,m)}},{"gl-shader":132,glslify:231}],91:[function(t,k,x){"use strict";k.exports=function(_){var b=_.gl||_.scene&&_.scene.gl,w=f(b);w.attributes.position.location=0,w.attributes.nextPosition.location=1,w.attributes.arcLength.location=2,w.attributes.lineWidth.location=3,w.attributes.color.location=4;var T=l(b);T.attributes.position.location=0,T.attributes.nextPosition.location=1,T.attributes.arcLength.location=2,T.attributes.lineWidth.location=3,T.attributes.color.location=4;for(var L=e(b),M=r(b,[{buffer:L,size:3,offset:0,stride:48},{buffer:L,size:3,offset:12,stride:48},{buffer:L,size:1,offset:24,stride:48},{buffer:L,size:1,offset:28,stride:48},{buffer:L,size:4,offset:32,stride:48}]),P=p(new Array(1024),[256,1,4]),z=0;z<1024;++z)P.data[z]=255;var S=i(b,P);S.wrap=b.REPEAT;var C=new y(b,w,T,L,M,S);return C.update(_),C};var e=t("gl-buffer"),r=t("gl-vao"),i=t("gl-texture2d"),c=new Uint8Array(4),n=new Float32Array(c.buffer),m=t("binary-search-bounds"),p=t("ndarray"),s=t("./lib/shaders"),f=s.createShader,l=s.createPickShader,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(_,b){for(var w=0,T=0;T<3;++T){var L=_[T]-b[T];w+=L*L}return Math.sqrt(w)}function u(_){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],w=0;w<3;++w)b[0][w]=Math.max(_[0][w],b[0][w]),b[1][w]=Math.min(_[1][w],b[1][w]);return b}function a(_,b,w,T){this.arcLength=_,this.position=b,this.index=w,this.dataCoordinate=T}function y(_,b,w,T,L,M){this.gl=_,this.shader=b,this.pickShader=w,this.buffer=T,this.vao=L,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=M,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var h=y.prototype;h.isTransparent=function(){return this.hasAlpha},h.isOpaque=function(){return!this.hasAlpha},h.pickSlots=1,h.setPickBase=function(_){this.pickId=_},h.drawTransparent=h.draw=function(_){if(this.vertexCount){var b=this.gl,w=this.shader,T=this.vao;w.bind(),w.uniforms={model:_.model||o,view:_.view||o,projection:_.projection||o,clipBounds:u(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},T.bind(),T.draw(b.TRIANGLE_STRIP,this.vertexCount),T.unbind()}},h.drawPick=function(_){if(this.vertexCount){var b=this.gl,w=this.pickShader,T=this.vao;w.bind(),w.uniforms={model:_.model||o,view:_.view||o,projection:_.projection||o,pickId:this.pickId,clipBounds:u(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},T.bind(),T.draw(b.TRIANGLE_STRIP,this.vertexCount),T.unbind()}},h.update=function(_){var b,w;this.dirty=!0;var T=!!_.connectGaps;"dashScale"in _&&(this.dashScale=_.dashScale),this.hasAlpha=!1,"opacity"in _&&(this.opacity=+_.opacity,this.opacity<1&&(this.hasAlpha=!0));var L=[],M=[],P=[],z=0,S=0,C=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=_.position||_.positions;if(R){var D=_.color||_.colors||[0,0,0,1],j=_.lineWidth||1,q=!1;e:for(b=1;b<R.length;++b){var Z,W,G,X=R[b-1],ne=R[b];for(M.push(z),P.push(X.slice()),w=0;w<3;++w){if(isNaN(X[w])||isNaN(ne[w])||!isFinite(X[w])||!isFinite(ne[w])){if(!T&&L.length>0){for(var V=0;V<24;++V)L.push(L[L.length-12]);S+=2,q=!0}continue e}C[0][w]=Math.min(C[0][w],X[w],ne[w]),C[1][w]=Math.max(C[1][w],X[w],ne[w])}Array.isArray(D[0])?(Z=D.length>b-1?D[b-1]:D.length>0?D[D.length-1]:[0,0,0,1],W=D.length>b?D[b]:D.length>0?D[D.length-1]:[0,0,0,1]):Z=W=D,3===Z.length&&(Z=[Z[0],Z[1],Z[2],1]),3===W.length&&(W=[W[0],W[1],W[2],1]),!this.hasAlpha&&Z[3]<1&&(this.hasAlpha=!0),G=Array.isArray(j)?j.length>b-1?j[b-1]:j.length>0?j[j.length-1]:[0,0,0,1]:j;var N=z;if(z+=d(X,ne),q){for(w=0;w<2;++w)L.push(X[0],X[1],X[2],ne[0],ne[1],ne[2],N,G,Z[0],Z[1],Z[2],Z[3]);S+=2,q=!1}L.push(X[0],X[1],X[2],ne[0],ne[1],ne[2],N,G,Z[0],Z[1],Z[2],Z[3],X[0],X[1],X[2],ne[0],ne[1],ne[2],N,-G,Z[0],Z[1],Z[2],Z[3],ne[0],ne[1],ne[2],X[0],X[1],X[2],z,-G,W[0],W[1],W[2],W[3],ne[0],ne[1],ne[2],X[0],X[1],X[2],z,G,W[0],W[1],W[2],W[3]),S+=4}}if(this.buffer.update(L),M.push(z),P.push(R[R.length-1].slice()),this.bounds=C,this.vertexCount=S,this.points=P,this.arcLength=M,"dashes"in _){var U=_.dashes.slice();for(U.unshift(0),b=1;b<U.length;++b)U[b]=U[b-1]+U[b];var ee=p(new Array(1024),[256,1,4]);for(b=0;b<256;++b){for(w=0;w<4;++w)ee.set(b,0,w,0);1&m.le(U,U[U.length-1]*b/255)?ee.set(b,0,0,0):ee.set(b,0,0,255)}this.texture.setPixels(ee)}},h.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},h.pick=function(_){if(!_||_.id!==this.pickId)return null;var R,D,j,b=(R=_.value[0],D=_.value[1],j=_.value[2],c[0]=0,c[1]=j,c[2]=D,c[3]=R,n[0]),w=m.le(this.arcLength,b);if(w<0)return null;if(w===this.arcLength.length-1)return new a(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),w);for(var T=this.points[w],L=this.points[Math.min(w+1,this.points.length-1)],M=(b-this.arcLength[w])/(this.arcLength[w+1]-this.arcLength[w]),P=1-M,z=[0,0,0],S=0;S<3;++S)z[S]=P*T[S]+M*L[S];var C=Math.min(M<.5?w:w+1,this.points.length-1);return new a(b,z,C,this.points[C])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(t,k,x){k.exports=function(e){var r=new Float32Array(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}},{}],93:[function(t,k,x){k.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],94:[function(t,k,x){k.exports=function(e){var r=e[0],i=e[1],c=e[2],n=e[3],m=e[4],p=e[5],s=e[6],f=e[7],l=e[8],o=e[9],d=e[10],u=e[11],a=e[12],y=e[13],h=e[14],_=e[15];return(r*p-i*m)*(d*_-u*h)-(r*s-c*m)*(o*_-u*y)+(r*f-n*m)*(o*h-d*y)+(i*s-c*p)*(l*_-u*a)-(i*f-n*p)*(l*h-d*a)+(c*f-n*s)*(l*y-o*a)}},{}],95:[function(t,k,x){k.exports=function(e,r){var i=r[0],c=r[1],n=r[2],m=r[3],p=i+i,s=c+c,f=n+n,l=i*p,o=c*p,d=c*s,u=n*p,a=n*s,y=n*f,h=m*p,_=m*s,b=m*f;return e[0]=1-d-y,e[1]=o+b,e[2]=u-_,e[3]=0,e[4]=o-b,e[5]=1-l-y,e[6]=a+h,e[7]=0,e[8]=u+_,e[9]=a-h,e[10]=1-l-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],96:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=r[3],s=c+c,f=n+n,l=m+m,o=c*s,d=c*f,u=c*l,a=n*f,y=n*l,h=m*l,_=p*s,b=p*f,w=p*l;return e[0]=1-(a+h),e[1]=d+w,e[2]=u-b,e[3]=0,e[4]=d-w,e[5]=1-(o+h),e[6]=y+_,e[7]=0,e[8]=u+b,e[9]=y-_,e[10]=1-(o+a),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}},{}],97:[function(t,k,x){k.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],98:[function(t,k,x){k.exports=function(e,r){var i=r[0],c=r[1],n=r[2],m=r[3],p=r[4],s=r[5],f=r[6],l=r[7],o=r[8],d=r[9],u=r[10],a=r[11],y=r[12],h=r[13],_=r[14],b=r[15],w=i*s-c*p,T=i*f-n*p,L=i*l-m*p,M=c*f-n*s,P=c*l-m*s,z=n*l-m*f,S=o*h-d*y,C=o*_-u*y,R=o*b-a*y,D=d*_-u*h,j=d*b-a*h,q=u*b-a*_,Z=w*q-T*j+L*D+M*R-P*C+z*S;return Z?(e[0]=(s*q-f*j+l*D)*(Z=1/Z),e[1]=(n*j-c*q-m*D)*Z,e[2]=(h*z-_*P+b*M)*Z,e[3]=(u*P-d*z-a*M)*Z,e[4]=(f*R-p*q-l*C)*Z,e[5]=(i*q-n*R+m*C)*Z,e[6]=(_*L-y*z-b*T)*Z,e[7]=(o*z-u*L+a*T)*Z,e[8]=(p*j-s*R+l*S)*Z,e[9]=(c*R-i*j-m*S)*Z,e[10]=(y*P-h*L+b*w)*Z,e[11]=(d*L-o*P-a*w)*Z,e[12]=(s*C-p*D-f*S)*Z,e[13]=(i*D-c*C+n*S)*Z,e[14]=(h*T-y*M-_*w)*Z,e[15]=(o*M-d*T+u*w)*Z,e):null}},{}],99:[function(t,k,x){var e=t("./identity");k.exports=function(r,i,c,n){var m,p,s,f,l,o,d,u,a,y,h=i[0],_=i[1],b=i[2],w=n[0],T=n[1],L=n[2],M=c[0],P=c[1],z=c[2];return Math.abs(h-M)<1e-6&&Math.abs(_-P)<1e-6&&Math.abs(b-z)<1e-6?e(r):(d=h-M,u=_-P,a=b-z,m=T*(a*=y=1/Math.sqrt(d*d+u*u+a*a))-L*(u*=y),p=L*(d*=y)-w*a,s=w*u-T*d,(y=Math.sqrt(m*m+p*p+s*s))?(m*=y=1/y,p*=y,s*=y):(m=0,p=0,s=0),f=u*s-a*p,l=a*m-d*s,o=d*p-u*m,(y=Math.sqrt(f*f+l*l+o*o))?(f*=y=1/y,l*=y,o*=y):(f=0,l=0,o=0),r[0]=m,r[1]=f,r[2]=d,r[3]=0,r[4]=p,r[5]=l,r[6]=u,r[7]=0,r[8]=s,r[9]=o,r[10]=a,r[11]=0,r[12]=-(m*h+p*_+s*b),r[13]=-(f*h+l*_+o*b),r[14]=-(d*h+u*_+a*b),r[15]=1,r)}},{"./identity":97}],100:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=r[3],s=r[4],f=r[5],l=r[6],o=r[7],d=r[8],u=r[9],a=r[10],y=r[11],h=r[12],_=r[13],b=r[14],w=r[15],T=i[0],L=i[1],M=i[2],P=i[3];return e[0]=T*c+L*s+M*d+P*h,e[1]=T*n+L*f+M*u+P*_,e[2]=T*m+L*l+M*a+P*b,e[3]=T*p+L*o+M*y+P*w,e[4]=(T=i[4])*c+(L=i[5])*s+(M=i[6])*d+(P=i[7])*h,e[5]=T*n+L*f+M*u+P*_,e[6]=T*m+L*l+M*a+P*b,e[7]=T*p+L*o+M*y+P*w,e[8]=(T=i[8])*c+(L=i[9])*s+(M=i[10])*d+(P=i[11])*h,e[9]=T*n+L*f+M*u+P*_,e[10]=T*m+L*l+M*a+P*b,e[11]=T*p+L*o+M*y+P*w,e[12]=(T=i[12])*c+(L=i[13])*s+(M=i[14])*d+(P=i[15])*h,e[13]=T*n+L*f+M*u+P*_,e[14]=T*m+L*l+M*a+P*b,e[15]=T*p+L*o+M*y+P*w,e}},{}],101:[function(t,k,x){k.exports=function(e,r,i,c,n,m,p){var s=1/(r-i),f=1/(c-n),l=1/(m-p);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(r+i)*s,e[13]=(n+c)*f,e[14]=(p+m)*l,e[15]=1,e}},{}],102:[function(t,k,x){k.exports=function(e,r,i,c,n){var m=1/Math.tan(r/2),p=1/(c-n);return e[0]=m/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=m,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+c)*p,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*c*p,e[15]=0,e}},{}],103:[function(t,k,x){k.exports=function(e,r,i,c){var n,m,p,s,f,l,o,d,u,a,y,h,_,b,w,T,L,M,P,z,S,C,R,D,j=c[0],q=c[1],Z=c[2],W=Math.sqrt(j*j+q*q+Z*Z);return Math.abs(W)<1e-6?null:(j*=W=1/W,q*=W,Z*=W,n=Math.sin(i),m=Math.cos(i),f=r[1],l=r[2],o=r[3],u=r[5],a=r[6],y=r[7],_=r[9],b=r[10],w=r[11],P=j*q*(p=1-m)-Z*n,z=q*q*p+m,S=Z*q*p+j*n,C=j*Z*p+q*n,R=q*Z*p-j*n,D=Z*Z*p+m,e[0]=(s=r[0])*(T=j*j*p+m)+(d=r[4])*(L=q*j*p+Z*n)+(h=r[8])*(M=Z*j*p-q*n),e[1]=f*T+u*L+_*M,e[2]=l*T+a*L+b*M,e[3]=o*T+y*L+w*M,e[4]=s*P+d*z+h*S,e[5]=f*P+u*z+_*S,e[6]=l*P+a*z+b*S,e[7]=o*P+y*z+w*S,e[8]=s*C+d*R+h*D,e[9]=f*C+u*R+_*D,e[10]=l*C+a*R+b*D,e[11]=o*C+y*R+w*D,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}},{}],104:[function(t,k,x){k.exports=function(e,r,i){var c=Math.sin(i),n=Math.cos(i),m=r[4],p=r[5],s=r[6],f=r[7],l=r[8],o=r[9],d=r[10],u=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=m*n+l*c,e[5]=p*n+o*c,e[6]=s*n+d*c,e[7]=f*n+u*c,e[8]=l*n-m*c,e[9]=o*n-p*c,e[10]=d*n-s*c,e[11]=u*n-f*c,e}},{}],105:[function(t,k,x){k.exports=function(e,r,i){var c=Math.sin(i),n=Math.cos(i),m=r[0],p=r[1],s=r[2],f=r[3],l=r[8],o=r[9],d=r[10],u=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=m*n-l*c,e[1]=p*n-o*c,e[2]=s*n-d*c,e[3]=f*n-u*c,e[8]=m*c+l*n,e[9]=p*c+o*n,e[10]=s*c+d*n,e[11]=f*c+u*n,e}},{}],106:[function(t,k,x){k.exports=function(e,r,i){var c=Math.sin(i),n=Math.cos(i),m=r[0],p=r[1],s=r[2],f=r[3],l=r[4],o=r[5],d=r[6],u=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=m*n+l*c,e[1]=p*n+o*c,e[2]=s*n+d*c,e[3]=f*n+u*c,e[4]=l*n-m*c,e[5]=o*n-p*c,e[6]=d*n-s*c,e[7]=u*n-f*c,e}},{}],107:[function(t,k,x){k.exports=function(e,r,i){var c=i[0],n=i[1],m=i[2];return e[0]=r[0]*c,e[1]=r[1]*c,e[2]=r[2]*c,e[3]=r[3]*c,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=r[7]*n,e[8]=r[8]*m,e[9]=r[9]*m,e[10]=r[10]*m,e[11]=r[11]*m,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}},{}],108:[function(t,k,x){k.exports=function(e,r,i){var c,n,m,p,s,f,l,o,d,u,a,y,h=i[0],_=i[1],b=i[2];return r===e?(e[12]=r[0]*h+r[4]*_+r[8]*b+r[12],e[13]=r[1]*h+r[5]*_+r[9]*b+r[13],e[14]=r[2]*h+r[6]*_+r[10]*b+r[14],e[15]=r[3]*h+r[7]*_+r[11]*b+r[15]):(n=r[1],m=r[2],p=r[3],s=r[4],f=r[5],l=r[6],o=r[7],d=r[8],u=r[9],a=r[10],y=r[11],e[0]=c=r[0],e[1]=n,e[2]=m,e[3]=p,e[4]=s,e[5]=f,e[6]=l,e[7]=o,e[8]=d,e[9]=u,e[10]=a,e[11]=y,e[12]=c*h+s*_+d*b+r[12],e[13]=n*h+f*_+u*b+r[13],e[14]=m*h+l*_+a*b+r[14],e[15]=p*h+o*_+y*b+r[15]),e}},{}],109:[function(t,k,x){k.exports=function(e,r){if(e===r){var i=r[1],c=r[2],n=r[3],m=r[6],p=r[7],s=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=i,e[6]=r[9],e[7]=r[13],e[8]=c,e[9]=m,e[11]=r[14],e[12]=n,e[13]=p,e[14]=s}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}},{}],110:[function(t,k,x){"use strict";var e=t("barycentric"),r=t("polytope-closest-point/lib/closest_point_2d.js");function i(m,p){for(var s=[0,0,0,0],f=0;f<4;++f)for(var l=0;l<4;++l)s[l]+=m[4*f+l]*p[f];return s}function c(m,p,s,f,l){for(var o=i(f,i(s,i(p,[m[0],m[1],m[2],1]))),d=0;d<3;++d)o[d]/=o[3];return[.5*l[0]*(1+o[0]),.5*l[1]*(1-o[1])]}function n(m,p){for(var s=[0,0,0],f=0;f<m.length;++f)for(var l=m[f],o=p[f],d=0;d<3;++d)s[d]+=o*l[d];return s}k.exports=function(m,p,s,f,l,o){if(1===m.length)return[0,m[0].slice()];for(var d=new Array(m.length),u=0;u<m.length;++u)d[u]=c(m[u],s,f,l,o);var a=0,y=1/0;for(u=0;u<d.length;++u){for(var h=0,_=0;_<2;++_)h+=Math.pow(d[u][_]-p[_],2);h<y&&(y=h,a=u)}var b=function(T,L){if(2===T.length){for(var M=0,P=0,z=0;z<2;++z)M+=Math.pow(L[z]-T[0][z],2),P+=Math.pow(L[z]-T[1][z],2);return(M=Math.sqrt(M))+(P=Math.sqrt(P))<1e-6?[1,0]:[P/(M+P),M/(P+M)]}if(3===T.length){var S=[0,0];return r(T[0],T[1],T[2],L,S),e(T,S)}return[]}(d,p),w=0;for(u=0;u<3;++u){if(b[u]<-.001||b[u]>1.0001)return null;w+=b[u]}return Math.abs(w-1)>.001?null:[a,n(m,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(t,k,x){var e=t("glslify"),r=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),i=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),c=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),n=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),m=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),p=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),s=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),f=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),l=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),o=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),d=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);x.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},x.wireShader={vertex:c,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},x.pointShader={vertex:m,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},x.pickShader={vertex:s,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},x.pointPickShader={vertex:l,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},x.contourShader={vertex:o,fragment:d,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(t,k,x){"use strict";var e=t("gl-shader"),r=t("gl-buffer"),i=t("gl-vao"),c=t("gl-texture2d"),n=t("normals"),m=t("gl-mat4/multiply"),p=t("gl-mat4/invert"),s=t("ndarray"),f=t("colormap"),l=t("simplicial-complex-contour"),o=t("typedarray-pool"),d=t("./lib/shaders"),u=t("./lib/closest-point"),a=d.meshShader,y=d.wireShader,h=d.pointShader,_=d.pickShader,b=d.pointPickShader,w=d.contourShader,T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function L(q,Z,W,G,X,ne,V,N,U,ee,B,K,J,te,ae,ce,oe,ve,fe,xe,Se,pe,ge,Te,se,de,Ae){this.gl=q,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Z,this.dirty=!0,this.triShader=W,this.lineShader=G,this.pointShader=X,this.pickShader=ne,this.pointPickShader=V,this.contourShader=N,this.trianglePositions=U,this.triangleColors=B,this.triangleNormals=J,this.triangleUVs=K,this.triangleIds=ee,this.triangleVAO=te,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ae,this.edgeColors=oe,this.edgeUVs=ve,this.edgeIds=ce,this.edgeVAO=fe,this.edgeCount=0,this.pointPositions=xe,this.pointColors=pe,this.pointUVs=ge,this.pointSizes=Te,this.pointIds=Se,this.pointVAO=se,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=de,this.contourVAO=Ae,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=T,this._view=T,this._projection=T,this._resolution=[1,1]}var M=L.prototype;function P(q,Z){if(!Z||!Z.length)return 1;for(var W=0;W<Z.length;++W){if(Z.length<2)return 1;if(Z[W][0]===q)return Z[W][1];if(Z[W][0]>q&&W>0){var G=(Z[W][0]-q)/(Z[W][0]-Z[W-1][0]);return Z[W][1]*(1-G)+G*Z[W-1][1]}}return 1}function z(q){var Z=e(q,a.vertex,a.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z.attributes.normal.location=4,Z}function S(q){var Z=e(q,y.vertex,y.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z}function C(q){var Z=e(q,h.vertex,h.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z.attributes.pointSize.location=4,Z}function R(q){var Z=e(q,_.vertex,_.fragment);return Z.attributes.position.location=0,Z.attributes.id.location=1,Z}function D(q){var Z=e(q,b.vertex,b.fragment);return Z.attributes.position.location=0,Z.attributes.id.location=1,Z.attributes.pointSize.location=4,Z}function j(q){var Z=e(q,w.vertex,w.fragment);return Z.attributes.position.location=0,Z}M.isOpaque=function(){return!this.hasAlpha},M.isTransparent=function(){return this.hasAlpha},M.pickSlots=1,M.setPickBase=function(q){this.pickId=q},M.highlight=function(q){if(q&&this.contourEnable){for(var Z=l(this.cells,this.intensity,q.intensity),W=Z.cells,G=Z.vertexIds,X=Z.vertexWeights,ne=W.length,V=o.mallocFloat32(6*ne),N=0,U=0;U<ne;++U)for(var ee=W[U],B=0;B<2;++B){var K=ee[0];2===ee.length&&(K=ee[B]);for(var ae=X[K],ce=1-ae,oe=this.positions[G[K][0]],ve=this.positions[G[K][1]],fe=0;fe<3;++fe)V[N++]=ae*oe[fe]+ce*ve[fe]}this.contourCount=N/3|0,this.contourPositions.update(V.subarray(0,N)),o.free(V)}else this.contourCount=0},M.update=function(q){q=q||{};var Z=this.gl;this.dirty=!0,"contourEnable"in q&&(this.contourEnable=q.contourEnable),"contourColor"in q&&(this.contourColor=q.contourColor),"lineWidth"in q&&(this.lineWidth=q.lineWidth),"lightPosition"in q&&(this.lightPosition=q.lightPosition),this.hasAlpha=!1,"opacity"in q&&(this.opacity=q.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in q&&(this.opacityscale=q.opacityscale,this.hasAlpha=!0),"ambient"in q&&(this.ambientLight=q.ambient),"diffuse"in q&&(this.diffuseLight=q.diffuse),"specular"in q&&(this.specularLight=q.specular),"roughness"in q&&(this.roughness=q.roughness),"fresnel"in q&&(this.fresnel=q.fresnel),q.texture?(this.texture.dispose(),this.texture=c(Z,q.texture)):q.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Z.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Z.LINEAR,this.texture.setPixels(function(Gt,en){for(var Jt=f({colormap:Gt,nshades:256,format:"rgba"}),cn=new Uint8Array(1024),Rt=0;Rt<256;++Rt){for(var je=Jt[Rt],Ye=0;Ye<3;++Ye)cn[4*Rt+Ye]=je[Ye];cn[4*Rt+3]=en?255*P(Rt/255,en):255*je[3]}return s(cn,[256,256,4],[4,0,1])}(q.colormap,this.opacityscale)),this.texture.generateMipmap());var W=q.cells,G=q.positions;if(G&&W){var X=[],ne=[],V=[],N=[],U=[],ee=[],B=[],K=[],J=[],te=[],ae=[],ce=[],oe=[],ve=[];this.cells=W,this.positions=G;var fe=q.vertexNormals,xe=q.cellNormals,Se=void 0===q.vertexNormalsEpsilon?1e-6:q.vertexNormalsEpsilon;q.useFacetNormals&&!xe&&(xe=n.faceNormals(W,G,void 0===q.faceNormalsEpsilon?1e-6:q.faceNormalsEpsilon)),xe||fe||(fe=n.vertexNormals(W,G,Se));var ge=q.vertexColors,Te=q.cellColors,se=q.meshColor||[1,1,1,1],de=q.vertexUVs,Ae=q.vertexIntensity,Le=q.cellUVs,Me=q.cellIntensity,De=1/0,Oe=-1/0;if(!de&&!Le)if(Ae)if(q.vertexIntensityBounds)De=+q.vertexIntensityBounds[0],Oe=+q.vertexIntensityBounds[1];else for(var Ie=0;Ie<Ae.length;++Ie){var Qe=Ae[Ie];De=Math.min(De,Qe),Oe=Math.max(Oe,Qe)}else if(Me)if(q.cellIntensityBounds)De=+q.cellIntensityBounds[0],Oe=+q.cellIntensityBounds[1];else for(Ie=0;Ie<Me.length;++Ie)Qe=Me[Ie],De=Math.min(De,Qe),Oe=Math.max(Oe,Qe);else for(Ie=0;Ie<G.length;++Ie)Qe=G[Ie][2],De=Math.min(De,Qe),Oe=Math.max(Oe,Qe);this.intensity=Ae||Me||function(Gt){for(var en=Gt.length,Jt=new Array(en),cn=0;cn<en;++cn)Jt[cn]=Gt[cn][2];return Jt}(G),this.pickVertex=!(Me||Te);var Ne=q.pointSizes,Pe=q.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Ie=0;Ie<G.length;++Ie)for(var Re=G[Ie],Ge=0;Ge<3;++Ge)!isNaN(Re[Ge])&&isFinite(Re[Ge])&&(this.bounds[0][Ge]=Math.min(this.bounds[0][Ge],Re[Ge]),this.bounds[1][Ge]=Math.max(this.bounds[1][Ge],Re[Ge]));var tt=0,ct=0,wt=0;e:for(Ie=0;Ie<W.length;++Ie){var kt=W[Ie];switch(kt.length){case 1:for(Re=G[at=kt[0]],Ge=0;Ge<3;++Ge)if(isNaN(Re[Ge])||!isFinite(Re[Ge]))continue e;te.push(Re[0],Re[1],Re[2]),et=ge?ge[at]:Te?Te[Ie]:se,this.opacityscale&&Ae?ne.push(et[0],et[1],et[2],this.opacity*P((Ae[at]-De)/(Oe-De),this.opacityscale)):3===et.length?ae.push(et[0],et[1],et[2],this.opacity):(ae.push(et[0],et[1],et[2],et[3]*this.opacity),et[3]<1&&(this.hasAlpha=!0)),ce.push((yt=de?de[at]:Ae?[(Ae[at]-De)/(Oe-De),0]:Le?Le[Ie]:Me?[(Me[Ie]-De)/(Oe-De),0]:[(Re[2]-De)/(Oe-De),0])[0],yt[1]),oe.push(Ne?Ne[at]:Pe),ve.push(Ie),wt+=1;break;case 2:for(Ge=0;Ge<2;++Ge){Re=G[at=kt[Ge]];for(var gt=0;gt<3;++gt)if(isNaN(Re[gt])||!isFinite(Re[gt]))continue e}for(Ge=0;Ge<2;++Ge)Re=G[at=kt[Ge]],ee.push(Re[0],Re[1],Re[2]),et=ge?ge[at]:Te?Te[Ie]:se,this.opacityscale&&Ae?ne.push(et[0],et[1],et[2],this.opacity*P((Ae[at]-De)/(Oe-De),this.opacityscale)):3===et.length?B.push(et[0],et[1],et[2],this.opacity):(B.push(et[0],et[1],et[2],et[3]*this.opacity),et[3]<1&&(this.hasAlpha=!0)),K.push((yt=de?de[at]:Ae?[(Ae[at]-De)/(Oe-De),0]:Le?Le[Ie]:Me?[(Me[Ie]-De)/(Oe-De),0]:[(Re[2]-De)/(Oe-De),0])[0],yt[1]),J.push(Ie);ct+=1;break;case 3:for(Ge=0;Ge<3;++Ge)for(Re=G[at=kt[Ge]],gt=0;gt<3;++gt)if(isNaN(Re[gt])||!isFinite(Re[gt]))continue e;for(Ge=0;Ge<3;++Ge){var at,et,yt,Vt;Re=G[at=kt[2-Ge]],X.push(Re[0],Re[1],Re[2]),(et=ge?ge[at]:Te?Te[Ie]:se)?this.opacityscale&&Ae?ne.push(et[0],et[1],et[2],this.opacity*P((Ae[at]-De)/(Oe-De),this.opacityscale)):3===et.length?ne.push(et[0],et[1],et[2],this.opacity):(ne.push(et[0],et[1],et[2],et[3]*this.opacity),et[3]<1&&(this.hasAlpha=!0)):ne.push(.5,.5,.5,1),N.push((yt=de?de[at]:Ae?[(Ae[at]-De)/(Oe-De),0]:Le?Le[Ie]:Me?[(Me[Ie]-De)/(Oe-De),0]:[(Re[2]-De)/(Oe-De),0])[0],yt[1]),V.push((Vt=fe?fe[at]:xe[Ie])[0],Vt[1],Vt[2]),U.push(Ie)}tt+=1}}this.pointCount=wt,this.edgeCount=ct,this.triangleCount=tt,this.pointPositions.update(te),this.pointColors.update(ae),this.pointUVs.update(ce),this.pointSizes.update(oe),this.pointIds.update(new Uint32Array(ve)),this.edgePositions.update(ee),this.edgeColors.update(B),this.edgeUVs.update(K),this.edgeIds.update(new Uint32Array(J)),this.trianglePositions.update(X),this.triangleColors.update(ne),this.triangleUVs.update(N),this.triangleNormals.update(V),this.triangleIds.update(new Uint32Array(U))}},M.drawTransparent=M.draw=function(q){for(var Z=this.gl,W=(q=q||{}).model||T,G=q.view||T,X=q.projection||T,ne=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],V=0;V<3;++V)ne[0][V]=Math.max(ne[0][V],this.clipBounds[0][V]),ne[1][V]=Math.min(ne[1][V],this.clipBounds[1][V]);var N={model:W,view:G,projection:X,inverseModel:T.slice(),clipBounds:ne,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};N.inverseModel=p(N.inverseModel,N.model),Z.disable(Z.CULL_FACE),this.texture.bind(0);var U=new Array(16);for(m(U,N.view,N.model),m(U,N.projection,U),p(U,U),V=0;V<3;++V)N.eyePosition[V]=U[12+V]/U[15];var ee,B=U[15];for(V=0;V<3;++V)B+=this.lightPosition[V]*U[4*V+3];for(V=0;V<3;++V){for(var K=U[12+V],J=0;J<3;++J)K+=U[4*J+V]*this.lightPosition[J];N.lightPosition[V]=K/B}this.triangleCount>0&&((ee=this.triShader).bind(),ee.uniforms=N,this.triangleVAO.bind(),Z.drawArrays(Z.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((ee=this.lineShader).bind(),ee.uniforms=N,this.edgeVAO.bind(),Z.lineWidth(this.lineWidth*this.pixelRatio),Z.drawArrays(Z.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((ee=this.pointShader).bind(),ee.uniforms=N,this.pointVAO.bind(),Z.drawArrays(Z.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((ee=this.contourShader).bind(),ee.uniforms=N,this.contourVAO.bind(),Z.drawArrays(Z.LINES,0,this.contourCount),this.contourVAO.unbind())},M.drawPick=function(q){for(var Z=this.gl,W=(q=q||{}).model||T,G=q.view||T,X=q.projection||T,ne=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],V=0;V<3;++V)ne[0][V]=Math.max(ne[0][V],this.clipBounds[0][V]),ne[1][V]=Math.min(ne[1][V],this.clipBounds[1][V]);this._model=[].slice.call(W),this._view=[].slice.call(G),this._projection=[].slice.call(X),this._resolution=[Z.drawingBufferWidth,Z.drawingBufferHeight];var N,U={model:W,view:G,projection:X,clipBounds:ne,pickId:this.pickId/255};(N=this.pickShader).bind(),N.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Z.drawArrays(Z.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Z.lineWidth(this.lineWidth*this.pixelRatio),Z.drawArrays(Z.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((N=this.pointPickShader).bind(),N.uniforms=U,this.pointVAO.bind(),Z.drawArrays(Z.POINTS,0,this.pointCount),this.pointVAO.unbind())},M.pick=function(q){if(!q||q.id!==this.pickId)return null;for(var Z=q.value[0]+256*q.value[1]+65536*q.value[2],W=this.cells[Z],G=this.positions,X=new Array(W.length),ne=0;ne<W.length;++ne)X[ne]=G[W[ne]];var V=q.coord[0],N=q.coord[1];if(!this.pickVertex){var U=this.positions[W[0]],ee=this.positions[W[1]],B=this.positions[W[2]];return{_cellCenter:!0,position:[V,N],index:Z,cell:W,cellId:Z,intensity:this.intensity[Z],dataCoordinate:[(U[0]+ee[0]+B[0])/3,(U[1]+ee[1]+B[1])/3,(U[2]+ee[2]+B[2])/3]}}var J=u(X,[V*this.pixelRatio,this._resolution[1]-N*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!J)return null;var te=J[2],ae=0;for(ne=0;ne<W.length;++ne)ae+=te[ne]*this.intensity[W[ne]];return{position:J[1],index:W[J[0]],cell:W,cellId:Z,intensity:ae,dataCoordinate:this.positions[W[J[0]]]}},M.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},k.exports=function(q,Z){if(1===arguments.length&&(q=(Z=q).gl),!(q.getExtension("OES_standard_derivatives")||q.getExtension("MOZ_OES_standard_derivatives")||q.getExtension("WEBKIT_OES_standard_derivatives")))throw new Error("derivatives not supported");var G=z(q),X=S(q),ne=C(q),V=R(q),N=D(q),U=j(q),ee=c(q,s(new Uint8Array([255,255,255,255]),[1,1,4]));ee.generateMipmap(),ee.minFilter=q.LINEAR_MIPMAP_LINEAR,ee.magFilter=q.LINEAR;var B=r(q),K=r(q),J=r(q),te=r(q),ae=r(q),ce=i(q,[{buffer:B,type:q.FLOAT,size:3},{buffer:ae,type:q.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:K,type:q.FLOAT,size:4},{buffer:J,type:q.FLOAT,size:2},{buffer:te,type:q.FLOAT,size:3}]),oe=r(q),ve=r(q),fe=r(q),xe=r(q),Se=i(q,[{buffer:oe,type:q.FLOAT,size:3},{buffer:xe,type:q.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ve,type:q.FLOAT,size:4},{buffer:fe,type:q.FLOAT,size:2}]),pe=r(q),ge=r(q),Te=r(q),se=r(q),de=r(q),Ae=i(q,[{buffer:pe,type:q.FLOAT,size:3},{buffer:de,type:q.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ge,type:q.FLOAT,size:4},{buffer:Te,type:q.FLOAT,size:2},{buffer:se,type:q.FLOAT,size:1}]),Le=r(q),De=new L(q,ee,G,X,ne,V,N,U,B,ae,K,J,te,ce,oe,xe,ve,fe,Se,pe,de,ge,Te,se,Ae,Le,i(q,[{buffer:Le,type:q.FLOAT,size:3}]));return De.update(Z),De}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(t,k,x){"use strict";k.exports=function(s){var f=s.gl;return new c(s,e(f,[0,0,0,1,1,0,1,1]),r(f,i.boxVert,i.lineFrag))};var e=t("gl-buffer"),r=t("gl-shader"),i=t("./shaders");function c(s,f,l){this.plot=s,this.vbo=f,this.shader=l}var n,m,p=c.prototype;p.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},p.drawBox=(n=[0,0],m=[0,0],function(s,f,l,o,d){var a=this.shader,y=this.plot.gl;n[0]=s,n[1]=f,m[0]=l,m[1]=o,a.uniforms.lo=n,a.uniforms.hi=m,a.uniforms.color=d,y.drawArrays(y.TRIANGLE_STRIP,0,4)}),p.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(t,k,x){"use strict";k.exports=function(u){var a=u.gl;return new n(u,e(a),r(a,c.gridVert,c.gridFrag),r(a,c.tickVert,c.gridFrag))};var e=t("gl-buffer"),r=t("gl-shader"),i=t("binary-search-bounds"),c=t("./shaders");function n(u,a,y,h){this.plot=u,this.vbo=a,this.shader=y,this.tickShader=h,this.ticks=[[],[]]}function m(u,a){return u-a}var p,s,f,l,o,u,a,y,h,_,b,d=n.prototype;d.draw=(p=[0,0],s=[0,0],f=[0,0],function(){for(var u=this.plot,a=this.vbo,y=this.shader,h=this.ticks,_=u.gl,b=u._tickBounds,w=u.dataBox,T=u.viewBox,L=u.gridLineWidth,M=u.gridLineColor,P=u.gridLineEnable,z=u.pixelRatio,S=0;S<2;++S){var C=b[S],D=.5*(w[S+2]+w[S]),j=w[S+2]-w[S];s[S]=2*(b[S+2]-C)/j,p[S]=2*(C-D)/j}y.bind(),a.bind(),y.attributes.dataCoord.pointer(),y.uniforms.dataShift=p,y.uniforms.dataScale=s;var q=0;for(S=0;S<2;++S){f[0]=f[1]=0,f[S]=1,y.uniforms.dataAxis=f,y.uniforms.lineWidth=L[S]/(T[S+2]-T[S])*z,y.uniforms.color=M[S];var Z=6*h[S].length;P[S]&&Z&&_.drawArrays(_.TRIANGLES,q,Z),q+=Z}}),d.drawTickMarks=(u=[0,0],a=[0,0],y=[1,0],h=[0,1],_=[0,0],b=[0,0],function(){for(var w=this.plot,T=this.vbo,L=this.tickShader,M=this.ticks,P=w.gl,z=w._tickBounds,S=w.dataBox,C=w.viewBox,R=w.pixelRatio,D=w.screenBox,j=D[2]-D[0],q=D[3]-D[1],Z=C[2]-C[0],W=C[3]-C[1],G=0;G<2;++G){var X=z[G],V=.5*(S[G+2]+S[G]),N=S[G+2]-S[G];a[G]=2*(z[G+2]-X)/N,u[G]=2*(X-V)/N}a[0]*=Z/j,u[0]*=Z/j,a[1]*=W/q,u[1]*=W/q,L.bind(),T.bind(),L.attributes.dataCoord.pointer();var U=L.uniforms;U.dataShift=u,U.dataScale=a;var ee=w.tickMarkLength,B=w.tickMarkWidth,K=w.tickMarkColor,J=6*M[0].length,te=Math.min(i.ge(M[0],(S[0]-z[0])/(z[2]-z[0]),m),M[0].length),ae=Math.min(i.gt(M[0],(S[2]-z[0])/(z[2]-z[0]),m),M[0].length),ce=0+6*te,oe=6*Math.max(0,ae-te),ve=Math.min(i.ge(M[1],(S[1]-z[1])/(z[3]-z[1]),m),M[1].length),fe=Math.min(i.gt(M[1],(S[3]-z[1])/(z[3]-z[1]),m),M[1].length),xe=J+6*ve,Se=6*Math.max(0,fe-ve);_[0]=2*(C[0]-ee[1])/j-1,_[1]=(C[3]+C[1])/q-1,b[0]=ee[1]*R/j,b[1]=B[1]*R/q,Se&&(U.color=K[1],U.tickScale=b,U.dataAxis=h,U.screenOffset=_,P.drawArrays(P.TRIANGLES,xe,Se)),_[0]=(C[2]+C[0])/j-1,_[1]=2*(C[1]-ee[0])/q-1,b[0]=B[0]*R/j,b[1]=ee[0]*R/q,oe&&(U.color=K[0],U.tickScale=b,U.dataAxis=y,U.screenOffset=_,P.drawArrays(P.TRIANGLES,ce,oe)),_[0]=2*(C[2]+ee[3])/j-1,_[1]=(C[3]+C[1])/q-1,b[0]=ee[3]*R/j,b[1]=B[3]*R/q,Se&&(U.color=K[3],U.tickScale=b,U.dataAxis=h,U.screenOffset=_,P.drawArrays(P.TRIANGLES,xe,Se)),_[0]=(C[2]+C[0])/j-1,_[1]=2*(C[3]+ee[2])/q-1,b[0]=B[2]*R/j,b[1]=ee[2]*R/q,oe&&(U.color=K[2],U.tickScale=b,U.dataAxis=y,U.screenOffset=_,P.drawArrays(P.TRIANGLES,ce,oe))}),d.update=(l=[1,1,-1,-1,1,-1],o=[1,-1,1,1,-1,-1],function(u){for(var a=u.ticks,y=u.bounds,h=new Float32Array(18*(a[0].length+a[1].length)),_=0,b=[[],[]],w=0;w<2;++w)for(var T=b[w],L=a[w],M=y[w],P=y[w+2],z=0;z<L.length;++z){var S=(L[z].x-M)/(P-M);T.push(S);for(var C=0;C<6;++C)h[_++]=S,h[_++]=l[C],h[_++]=o[C]}this.ticks=b,this.vbo.update(h)}),d.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(t,k,x){"use strict";k.exports=function(s){var f=s.gl;return new c(s,e(f,[-1,-1,-1,1,1,-1,1,1]),r(f,i.lineVert,i.lineFrag))};var e=t("gl-buffer"),r=t("gl-shader"),i=t("./shaders");function c(s,f,l){this.plot=s,this.vbo=f,this.shader=l}var n,m,p=c.prototype;p.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},p.drawLine=(n=[0,0],m=[0,0],function(s,f,l,o,d,u){var a=this.plot,y=this.shader,h=a.gl;n[0]=s,n[1]=f,m[0]=l,m[1]=o,y.uniforms.start=n,y.uniforms.end=m,y.uniforms.width=d*a.pixelRatio,y.uniforms.color=u,h.drawArrays(h.TRIANGLE_STRIP,0,4)}),p.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(t,k,x){"use strict";var e=t("glslify"),r=e(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);k.exports={lineVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:r,textVert:e(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:r,gridVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:r,boxVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:231}],117:[function(t,k,x){"use strict";k.exports=function(a){var y=a.gl;return new m(a,e(y),r(y,n.textVert,n.textFrag))};var e=t("gl-buffer"),r=t("gl-shader"),i=t("text-cache"),c=t("binary-search-bounds"),n=t("./shaders");function m(a,y,h){this.plot=a,this.vbo=y,this.shader=h,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var p,s,f,l,o,d,a,y,u=m.prototype;u.drawTicks=(p=[0,0],s=[0,0],f=[0,0],function(a){var y=this.plot,h=this.shader,_=this.tickX[a],b=this.tickOffset[a],w=y.gl,T=y.viewBox,L=y.dataBox,M=y.screenBox,P=y.pixelRatio,z=y.tickEnable,S=y.tickPad,C=y.tickColor,R=y.tickAngle,D=y.labelEnable,j=y.labelPad,q=y.labelColor,Z=y.labelAngle,W=this.labelOffset[a],G=this.labelCount[a],X=c.lt(_,L[a]),ne=c.le(_,L[a+2]);p[0]=p[1]=0,p[a]=1,s[a]=(T[2+a]+T[a])/(M[2+a]-M[a])-1;var V=2/M[2+(1^a)]-M[1^a];s[1^a]=V*T[1^a]-1,z[a]&&(s[1^a]-=V*P*S[a],X<ne&&b[ne]>b[X]&&(h.uniforms.dataAxis=p,h.uniforms.screenOffset=s,h.uniforms.color=C[a],h.uniforms.angle=R[a],w.drawArrays(w.TRIANGLES,b[X],b[ne]-b[X]))),D[a]&&G&&(s[1^a]-=V*P*j[a],h.uniforms.dataAxis=f,h.uniforms.screenOffset=s,h.uniforms.color=q[a],h.uniforms.angle=Z[a],w.drawArrays(w.TRIANGLES,W,G)),s[1^a]=V*T[2+(1^a)]-1,z[a+2]&&(s[1^a]+=V*P*S[a+2],X<ne&&b[ne]>b[X]&&(h.uniforms.dataAxis=p,h.uniforms.screenOffset=s,h.uniforms.color=C[a+2],h.uniforms.angle=R[a+2],w.drawArrays(w.TRIANGLES,b[X],b[ne]-b[X]))),D[a+2]&&G&&(s[1^a]+=V*P*j[a+2],h.uniforms.dataAxis=f,h.uniforms.screenOffset=s,h.uniforms.color=q[a+2],h.uniforms.angle=Z[a+2],w.drawArrays(w.TRIANGLES,W,G))}),u.drawTitle=(a=[0,0],y=[0,0],function(){var h=this.plot,_=this.shader,b=h.gl,w=h.screenBox,T=h.titleCenter,L=h.titleAngle,M=h.titleColor,P=h.pixelRatio;if(this.titleCount){for(var z=0;z<2;++z)y[z]=2*(T[z]*P-w[z])/(w[2+z]-w[z])-1;_.bind(),_.uniforms.dataAxis=a,_.uniforms.screenOffset=y,_.uniforms.angle=L,_.uniforms.color=M,b.drawArrays(b.TRIANGLES,this.titleOffset,this.titleCount)}}),u.bind=(l=[0,0],o=[0,0],d=[0,0],function(){var a=this.plot,y=this.shader,h=a._tickBounds,_=a.dataBox,b=a.screenBox,w=a.viewBox;y.bind();for(var T=0;T<2;++T){var L=h[T],P=.5*(_[T+2]+_[T]),z=_[T+2]-_[T],C=w[T+2]-w[T],D=b[T+2]-b[T];o[T]=2*(h[T+2]-L)/z*C/D,l[T]=2*(L-P)/z*C/D}d[1]=2*a.pixelRatio/(b[3]-b[1]),d[0]=d[1]*(b[3]-b[1])/(b[2]-b[0]),y.uniforms.dataScale=o,y.uniforms.dataShift=l,y.uniforms.textScale=d,this.vbo.bind(),y.attributes.textCoordinate.pointer()}),u.update=function(a){var y,h,_,b,w,T=[],L=a.ticks,M=a.bounds;for(w=0;w<2;++w){var P=[Math.floor(T.length/3)],z=[-1/0],S=L[w];for(y=0;y<S.length;++y){var C=S[y],R=C.x,j=C.font||"sans-serif";b=C.fontSize||12;for(var q=1/(M[w+2]-M[w]),Z=M[w],W=C.text.split("\n"),G=0;G<W.length;G++)for(_=i(j,W[G]).data,h=0;h<_.length;h+=2)T.push(_[h]*b,-_[h+1]*b-G*b*1.2,(R-Z)*q);P.push(Math.floor(T.length/3)),z.push(R)}this.tickOffset[w]=P,this.tickX[w]=z}for(w=0;w<2;++w){for(this.labelOffset[w]=Math.floor(T.length/3),_=i(a.labelFont[w],a.labels[w],{textAlign:"center"}).data,b=a.labelSize[w],y=0;y<_.length;y+=2)T.push(_[y]*b,-_[y+1]*b,0);this.labelCount[w]=Math.floor(T.length/3)-this.labelOffset[w]}for(this.titleOffset=Math.floor(T.length/3),_=i(a.titleFont,a.title).data,b=a.titleSize,y=0;y<_.length;y+=2)T.push(_[y]*b,-_[y+1]*b,0);this.titleCount=Math.floor(T.length/3)-this.titleOffset,this.vbo.update(T)},u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(t,k,x){"use strict";k.exports=function(l){var o=l.gl,u=new m(o,e(o,[o.drawingBufferWidth,o.drawingBufferHeight]));return u.grid=r(u),u.text=i(u),u.line=c(u),u.box=n(u),u.update(l),u};var e=t("gl-select-static"),r=t("./lib/grid"),i=t("./lib/text"),c=t("./lib/line"),n=t("./lib/box");function m(l,o){this.gl=l,this.pickBuffer=o,this.screenBox=[0,0,l.drawingBufferWidth,l.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var p=m.prototype;function s(l){for(var o=l.slice(),d=0;d<o.length;++d)o[d]=o[d].slice();return o}function f(l,o){return l.x-o.x}p.setDirty=function(){this.dirty=this.pickDirty=!0},p.setOverlayDirty=function(){this.dirty=!0},p.nextDepthValue=function(){return this._depthCounter++/65536},p.draw=function(){var l=this.gl,o=this.screenBox,d=this.viewBox,u=this.dataBox,a=this.pixelRatio,y=this.grid,h=this.line,_=this.text,b=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,l.bindFramebuffer(l.FRAMEBUFFER,null),l.enable(l.SCISSOR_TEST),l.disable(l.DEPTH_TEST),l.depthFunc(l.LESS),l.depthMask(!1),l.enable(l.BLEND),l.blendEquation(l.FUNC_ADD,l.FUNC_ADD),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),this.borderColor){l.scissor(o[0],o[1],o[2]-o[0],o[3]-o[1]);var w=this.borderColor;l.clearColor(w[0]*w[3],w[1]*w[3],w[2]*w[3],w[3]),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)}l.scissor(d[0],d[1],d[2]-d[0],d[3]-d[1]),l.viewport(d[0],d[1],d[2]-d[0],d[3]-d[1]);var T=this.backgroundColor;l.clearColor(T[0]*T[3],T[1]*T[3],T[2]*T[3],T[3]),l.clear(l.COLOR_BUFFER_BIT),y.draw();var L=this.zeroLineEnable,M=this.zeroLineColor,P=this.zeroLineWidth;if(L[0]||L[1]){h.bind();for(var z=0;z<2;++z)if(L[z]&&u[z]<=0&&u[z+2]>=0){var S=o[z]-u[z]*(o[z+2]-o[z])/(u[z+2]-u[z]);0===z?h.drawLine(S,o[1],S,o[3],P[z],M[z]):h.drawLine(o[0],S,o[2],S,P[z],M[z])}}for(z=0;z<b.length;++z)b[z].draw();l.viewport(o[0],o[1],o[2]-o[0],o[3]-o[1]),l.scissor(o[0],o[1],o[2]-o[0],o[3]-o[1]),this.grid.drawTickMarks(),h.bind();var C=this.borderLineEnable,R=this.borderLineWidth,D=this.borderLineColor;for(C[1]&&h.drawLine(d[0],d[1]-.5*R[1]*a,d[0],d[3]+.5*R[3]*a,R[1],D[1]),C[0]&&h.drawLine(d[0]-.5*R[0]*a,d[1],d[2]+.5*R[2]*a,d[1],R[0],D[0]),C[3]&&h.drawLine(d[2],d[1]-.5*R[1]*a,d[2],d[3]+.5*R[3]*a,R[3],D[3]),C[2]&&h.drawLine(d[0]-.5*R[0]*a,d[3],d[2]+.5*R[2]*a,d[3],R[2],D[2]),_.bind(),z=0;z<2;++z)_.drawTicks(z);this.titleEnable&&_.drawTitle();var j=this.overlays;for(z=0;z<j.length;++z)j[z].draw();l.disable(l.SCISSOR_TEST),l.disable(l.BLEND),l.depthMask(!0)}},p.drawPick=function(){if(!this.static){var l=this.pickBuffer;this._pickTimeout=null,l.begin();for(var o=1,d=this.objects,u=0;u<d.length;++u)o=d[u].drawPick(o);l.end()}},p.pick=function(l,o){if(!this.static){var d=this.pixelRatio,u=this.pickPixelRatio,a=this.viewBox,y=0|Math.round((l-a[0]/d)*u),h=0|Math.round((o-a[1]/d)*u),_=this.pickBuffer.query(y,h,this.pickRadius);if(!_)return null;for(var b=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),w=this.objects,T=0;T<w.length;++T){var L=w[T].pick(y,h,b);if(L)return L}return null}},p.setScreenBox=function(l){var o=this.screenBox,d=this.pixelRatio;o[0]=0|Math.round(l[0]*d),o[1]=0|Math.round(l[1]*d),o[2]=0|Math.round(l[2]*d),o[3]=0|Math.round(l[3]*d),this.setDirty()},p.setDataBox=function(l){var o=this.dataBox;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3])&&(o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3],this.setDirty())},p.setViewBox=function(l){var o=this.pixelRatio,d=this.viewBox;d[0]=0|Math.round(l[0]*o),d[1]=0|Math.round(l[1]*o),d[2]=0|Math.round(l[2]*o),d[3]=0|Math.round(l[3]*o);var u=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((l[2]-l[0])*u),0|Math.round((l[3]-l[1])*u)],this.setDirty()},p.update=function(l){var o=this.gl;this.pixelRatio=(l=l||{}).pixelRatio||1;var d=this.pixelRatio;this.pickPixelRatio=Math.max(d,1),this.setScreenBox(l.screenBox||[0,0,o.drawingBufferWidth/d,o.drawingBufferHeight/d]),this.setViewBox(l.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/d,.125*(this.screenBox[3]-this.screenBox[1])/d,.875*(this.screenBox[2]-this.screenBox[0])/d,.875*(this.screenBox[3]-this.screenBox[1])/d]);var u=this.viewBox,a=(u[2]-u[0])/(u[3]-u[1]);this.setDataBox(l.dataBox||[-10,-10/a,10,10/a]),this.borderColor=!1!==l.borderColor&&(l.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(l.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(l.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(l.gridLineWidth||[1,1]).slice(),this.gridLineColor=s(l.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(l.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(l.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=s(l.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(l.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(l.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=s(l.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(l.titleCenter||[.5*(u[0]+u[2])/d,(u[3]+120)/d]).slice(),this.titleEnable=!("titleEnable"in l)||!!l.titleEnable,this.titleAngle=l.titleAngle||0,this.titleColor=(l.titleColor||[0,0,0,1]).slice(),this.labelPad=(l.labelPad||[15,15,15,15]).slice(),this.labelAngle=(l.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(l.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=s(l.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(l.tickPad||[15,15,15,15]).slice(),this.tickAngle=(l.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(l.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=s(l.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(l.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(l.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=s(l.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var y=l.ticks||[[],[]],h=this._tickBounds;h[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var _=0;_<2;++_){var b=y[_].slice(0);0!==b.length&&(b.sort(f),h[_]=Math.min(h[_],b[0].x),h[_+2]=Math.max(h[_+2],b[b.length-1].x))}this.grid.update({bounds:h,ticks:y}),this.text.update({bounds:h,ticks:y,labels:l.labels||["x","y"],labelSize:l.labelSize||[12,12],labelFont:l.labelFont||["sans-serif","sans-serif"],title:l.title||"",titleSize:l.titleSize||18,titleFont:l.titleFont||"sans-serif"}),this.static=!!l.static,this.setDirty()},p.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var l=this.objects.length-1;l>=0;--l)this.objects[l].dispose();for(this.objects.length=0,l=this.overlays.length-1;l>=0;--l)this.overlays[l].dispose();this.overlays.length=0,this.gl=null},p.addObject=function(l){this.objects.indexOf(l)<0&&(this.objects.push(l),this.setDirty())},p.removeObject=function(l){for(var o=this.objects,d=0;d<o.length;++d)if(o[d]===l){o.splice(d,1),this.setDirty();break}},p.addOverlay=function(l){this.overlays.indexOf(l)<0&&(this.overlays.push(l),this.setOverlayDirty())},p.removeOverlay=function(l){for(var o=this.overlays,d=0;d<o.length;++d)if(o[d]===l){o.splice(d,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(t,k,x){"use strict";k.exports=function(p,s){p=p||document.body;var f=[.01,1/0];"distanceLimits"in(s=s||{})&&(f[0]=s.distanceLimits[0],f[1]=s.distanceLimits[1]),"zoomMin"in s&&(f[0]=s.zoomMin),"zoomMax"in s&&(f[1]=s.zoomMax);var l=r({center:s.center||[0,0,0],up:s.up||[0,1,0],eye:s.eye||[0,0,10],mode:s.mode||"orbit",distanceLimits:f}),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=0,u=p.clientWidth,a=p.clientHeight,y={keyBindingMode:"rotate",enableWheel:!0,view:l,element:p,delay:s.delay||16,rotateSpeed:s.rotateSpeed||1,zoomSpeed:s.zoomSpeed||1,translateSpeed:s.translateSpeed||1,flipX:!!s.flipX,flipY:!!s.flipY,modes:l.modes,_ortho:s._ortho||s.projection&&"orthographic"===s.projection.type||!1,tick:function(){var h=e(),_=this.delay,b=h-2*_;l.idle(h-_),l.recalcMatrix(b),l.flush(h-(100+2*_));for(var w=!0,T=l.computedMatrix,L=0;L<16;++L)w=w&&o[L]===T[L],o[L]=T[L];var M=p.clientWidth===u&&p.clientHeight===a;return u=p.clientWidth,a=p.clientHeight,w?!M:(d=Math.exp(l.computedRadius[0]),!0)},lookAt:function(h,_,b){l.lookAt(l.lastT(),h,_,b)},rotate:function(h,_,b){l.rotate(l.lastT(),h,_,b)},pan:function(h,_,b){l.pan(l.lastT(),h,_,b)},translate:function(h,_,b){l.translate(l.lastT(),h,_,b)}};return Object.defineProperties(y,{matrix:{get:function(){return l.computedMatrix},set:function(h){return l.setMatrix(l.lastT(),h),l.computedMatrix},enumerable:!0},mode:{get:function(){return l.getMode()},set:function(h){var _=l.computedUp.slice(),b=l.computedEye.slice(),w=l.computedCenter.slice();if(l.setMode(h),"turntable"===h){var T=e();l._active.lookAt(T,b,w,_),l._active.lookAt(T+500,b,w,[0,0,1]),l._active.flush(T)}return l.getMode()},enumerable:!0},center:{get:function(){return l.computedCenter},set:function(h){return l.lookAt(l.lastT(),null,h),l.computedCenter},enumerable:!0},eye:{get:function(){return l.computedEye},set:function(h){return l.lookAt(l.lastT(),h),l.computedEye},enumerable:!0},up:{get:function(){return l.computedUp},set:function(h){return l.lookAt(l.lastT(),null,null,h),l.computedUp},enumerable:!0},distance:{get:function(){return d},set:function(h){return l.setDistance(l.lastT(),h),h},enumerable:!0},distanceLimits:{get:function(){return l.getDistanceLimits(f)},set:function(h){return l.setDistanceLimits(h),h},enumerable:!0}}),p.addEventListener("contextmenu",function(h){return h.preventDefault(),!1}),y._lastX=-1,y._lastY=-1,y._lastMods={shift:!1,control:!1,alt:!1,meta:!1},y.enableMouseListeners=function(){function h(_,b,w,T){var L=y.keyBindingMode;if(!1!==L){var M="rotate"===L,P="pan"===L,z="zoom"===L,S=!!T.control,C=!!T.alt,R=!!T.shift,D=!!(1&_),j=!!(2&_),q=!!(4&_),Z=1/p.clientHeight,W=Z*(b-y._lastX),G=Z*(w-y._lastY),X=y.flipX?1:-1,ne=y.flipY?1:-1,V=Math.PI*y.rotateSpeed,N=e();if(-1!==y._lastX&&-1!==y._lastY&&((M&&D&&!S&&!C&&!R||D&&!S&&!C&&R)&&l.rotate(N,X*V*W,-ne*V*G,0),(P&&D&&!S&&!C&&!R||j||D&&S&&!C&&!R)&&l.pan(N,-y.translateSpeed*W*d,y.translateSpeed*G*d,0),z&&D&&!S&&!C&&!R||q||D&&!S&&C&&!R)){var U=-y.zoomSpeed*G/window.innerHeight*(N-l.lastT())*100;l.pan(N,0,0,d*(Math.exp(U)-1))}return y._lastX=b,y._lastY=w,y._lastMods=T,!0}}y.mouseListener=i(p,h),p.addEventListener("touchstart",function(_){var b=n(_.changedTouches[0],p);h(0,b[0],b[1],y._lastMods),h(1,b[0],b[1],y._lastMods)},!!m&&{passive:!0}),p.addEventListener("touchmove",function(_){var b=n(_.changedTouches[0],p);h(1,b[0],b[1],y._lastMods),_.preventDefault()},!!m&&{passive:!1}),p.addEventListener("touchend",function(_){h(0,y._lastX,y._lastY,y._lastMods)},!!m&&{passive:!0}),y.wheelListener=c(p,function(_,b){if(!1!==y.keyBindingMode&&y.enableWheel){var w=y.flipX?1:-1,T=y.flipY?1:-1,L=e();if(Math.abs(_)>Math.abs(b))l.rotate(L,0,0,-_*w*Math.PI*y.rotateSpeed/window.innerWidth);else if(!y._ortho){var M=-y.zoomSpeed*T*b/window.innerHeight*(L-l.lastT())/20;l.pan(L,0,0,d*(Math.exp(M)-1))}}},!0)},y.enableMouseListeners(),y};var e=t("right-now"),r=t("3d-view"),i=t("mouse-change"),c=t("mouse-wheel"),n=t("mouse-event-offset"),m=t("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(t,k,x){var e=t("glslify"),r=t("gl-shader"),i=e(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),c=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);k.exports=function(n){return r(n,i,c,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(t,k,x){"use strict";var e=t("./camera.js"),r=t("gl-axes3d"),i=t("gl-axes3d/properties"),c=t("gl-spikes3d"),n=t("gl-select-static"),m=t("gl-fbo"),p=t("a-big-triangle"),s=t("mouse-change"),f=t("gl-mat4/perspective"),l=t("gl-mat4/ortho"),o=t("./lib/shader"),d=t("is-mobile")({tablet:!0,featureDetect:!0});function u(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function a(h){var _=Math.round(Math.log(Math.abs(h))/Math.log(10));if(_<0){var b=Math.round(Math.pow(10,-_));return Math.ceil(h*b)/b}return _>0?(b=Math.round(Math.pow(10,_)),Math.ceil(h/b)*b):Math.ceil(h)}function y(h){return"boolean"!=typeof h||h}k.exports={createScene:function(h){(h=h||{}).camera=h.camera||{};var _=h.canvas;_||(_=document.createElement("canvas"),h.container?h.container.appendChild(_):document.body.appendChild(_));var b=h.gl;if(b||(h.glOptions&&(d=!!h.glOptions.preserveDrawingBuffer),b=function(fe,xe){var Se=null;try{(Se=fe.getContext("webgl",xe))||(Se=fe.getContext("experimental-webgl",xe))}catch(pe){return null}return Se}(_,h.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:d})),!b)throw new Error("webgl not supported");var w=h.bounds||[[-10,-10,-10],[10,10,10]],T=new u,L=m(b,b.drawingBufferWidth,b.drawingBufferHeight,{preferFloat:!d}),M=o(b),P=h.cameraObject&&!0===h.cameraObject._ortho||h.camera.projection&&"orthographic"===h.camera.projection.type||!1,z={eye:h.camera.eye||[2,0,0],center:h.camera.center||[0,0,0],up:h.camera.up||[0,1,0],zoomMin:h.camera.zoomMax||.1,zoomMax:h.camera.zoomMin||100,mode:h.camera.mode||"turntable",_ortho:P},S=h.axes||{},C=r(b,S);C.enable=!S.disable;var D=c(b,h.spikes||{}),j=[],q=[],Z=[],W=[],G=!0,X=!0,N={view:null,projection:new Array(16),model:new Array(16),_ortho:!1},U=(X=!0,[b.drawingBufferWidth,b.drawingBufferHeight]),ee=h.cameraObject||e(_,z),B={gl:b,contextLost:!1,pixelRatio:h.pixelRatio||1,canvas:_,selection:T,camera:ee,axes:C,axesPixels:null,spikes:D,bounds:w,objects:j,shape:U,aspect:h.aspectRatio||[1,1,1],pickRadius:h.pickRadius||10,zNear:h.zNear||.01,zFar:h.zFar||1e3,fovy:h.fovy||Math.PI/4,clearColor:h.clearColor||[0,0,0,0],autoResize:y(h.autoResize),autoBounds:y(h.autoBounds),autoScale:!!h.autoScale,autoCenter:y(h.autoCenter),clipToBounds:y(h.clipToBounds),snapToData:!!h.snapToData,onselect:h.onselect||null,onrender:h.onrender||null,onclick:h.onclick||null,cameraParams:N,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(fe){this.aspect[0]=fe.x,this.aspect[1]=fe.y,this.aspect[2]=fe.z,X=!0},setBounds:function(fe,xe){this.bounds[0][fe]=xe.min,this.bounds[1][fe]=xe.max},setClearColor:function(fe){this.clearColor=fe},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},K=[b.drawingBufferWidth/B.pixelRatio|0,b.drawingBufferHeight/B.pixelRatio|0];function J(){if(!B._stopped&&B.autoResize){var fe=_.parentNode,xe=1,Se=1;fe&&fe!==document.body?(xe=fe.clientWidth,Se=fe.clientHeight):(xe=window.innerWidth,Se=window.innerHeight);var pe=0|Math.ceil(xe*B.pixelRatio),ge=0|Math.ceil(Se*B.pixelRatio);if(pe!==_.width||ge!==_.height){_.width=pe,_.height=ge;var Te=_.style;Te.position=Te.position||"absolute",Te.left="0px",Te.top="0px",Te.width=xe+"px",Te.height=Se+"px",G=!0}}}function te(){for(var fe=j.length,xe=W.length,Se=0;Se<xe;++Se)Z[Se]=0;e:for(Se=0;Se<fe;++Se){var pe=j[Se],ge=pe.pickSlots;if(ge){for(var Te=0;Te<xe;++Te)if(Z[Te]+ge<255){q[Se]=Te,pe.setPickBase(Z[Te]+1),Z[Te]+=ge;continue e}var se=n(b,U);q[Se]=xe,W.push(se),Z.push(ge),pe.setPickBase(1),xe+=1}else q[Se]=-1}for(;xe>0&&0===Z[xe-1];)Z.pop(),W.pop().dispose()}function ae(){if(B.contextLost)return!0;b.isContextLost()&&(B.contextLost=!0,B.mouseListener.enabled=!1,B.selection.object=null,B.oncontextloss&&B.oncontextloss())}B.autoResize&&J(),window.addEventListener("resize",J),B.update=function(fe){B._stopped||(fe=fe||{},G=!0,X=!0)},B.add=function(fe){B._stopped||(fe.axes=C,j.push(fe),q.push(-1),G=!0,X=!0,te())},B.remove=function(fe){if(!B._stopped){var xe=j.indexOf(fe);xe<0||(j.splice(xe,1),q.pop(),G=!0,X=!0,te())}},B.dispose=function(){if(!B._stopped&&(B._stopped=!0,window.removeEventListener("resize",J),_.removeEventListener("webglcontextlost",ae),B.mouseListener.enabled=!1,!B.contextLost)){C.dispose(),D.dispose();for(var fe=0;fe<j.length;++fe)j[fe].dispose();for(L.dispose(),fe=0;fe<W.length;++fe)W[fe].dispose();M.dispose(),b=null,C=null,D=null,j=[]}},B._mouseRotating=!1,B._prevButtons=0,B.enableMouseListeners=function(){B.mouseListener=s(_,function(fe,xe,Se){if(!B._stopped){var pe=W.length,ge=j.length,Te=T.object;T.distance=1/0,T.mouse[0]=xe,T.mouse[1]=Se,T.object=null,T.screen=null,T.dataCoordinate=T.dataPosition=null;var se=!1;if(fe&&B._prevButtons)B._mouseRotating=!0;else{B._mouseRotating&&(X=!0),B._mouseRotating=!1;for(var de=0;de<pe;++de){var Ae=W[de].query(xe,K[1]-Se-1,B.pickRadius);if(Ae){if(Ae.distance>T.distance)continue;for(var Le=0;Le<ge;++Le){var Me=j[Le];if(q[Le]===de){var De=Me.pick(Ae);De&&(T.buttons=fe,T.screen=Ae.coord,T.distance=Ae.distance,T.object=Me,T.index=De.distance,T.dataPosition=De.position,T.dataCoordinate=De.dataCoordinate,T.data=De,se=!0)}}}}}Te&&Te!==T.object&&(Te.highlight&&Te.highlight(null),G=!0),T.object&&(T.object.highlight&&T.object.highlight(T.data),G=!0),(se=se||T.object!==Te)&&B.onselect&&B.onselect(T),1&fe&&!(1&B._prevButtons)&&B.onclick&&B.onclick(T),B._prevButtons=fe}})},_.addEventListener("webglcontextlost",ae);var ce=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],oe=[ce[0].slice(),ce[1].slice()];function ve(){if(!ae()){J();var fe=B.camera.tick();N.view=B.camera.matrix,G=G||fe,X=X||fe,C.pixelRatio=B.pixelRatio,D.pixelRatio=B.pixelRatio;var xe=j.length,Se=ce[0],pe=ce[1];Se[0]=Se[1]=Se[2]=1/0,pe[0]=pe[1]=pe[2]=-1/0;for(var ge=0;ge<xe;++ge){(Pe=j[ge]).pixelRatio=B.pixelRatio,Pe.axes=B.axes,G=G||!!Pe.dirty,X=X||!!Pe.dirty;var Te=Pe.bounds;if(Te)for(var se=Te[0],de=Te[1],Ae=0;Ae<3;++Ae)Se[Ae]=Math.min(Se[Ae],se[Ae]),pe[Ae]=Math.max(pe[Ae],de[Ae])}var Le=B.bounds;if(B.autoBounds)for(Ae=0;Ae<3;++Ae){if(pe[Ae]<Se[Ae])Se[Ae]=-1,pe[Ae]=1;else{Se[Ae]===pe[Ae]&&(Se[Ae]-=1,pe[Ae]+=1);var Me=.05*(pe[Ae]-Se[Ae]);Se[Ae]=Se[Ae]-Me,pe[Ae]=pe[Ae]+Me}Le[0][Ae]=Se[Ae],Le[1][Ae]=pe[Ae]}var De=!1;for(Ae=0;Ae<3;++Ae)De=De||oe[0][Ae]!==Le[0][Ae]||oe[1][Ae]!==Le[1][Ae],oe[0][Ae]=Le[0][Ae],oe[1][Ae]=Le[1][Ae];if(X=X||De,G=G||De){if(De){var Oe=[0,0,0];for(ge=0;ge<3;++ge)Oe[ge]=a((Le[1][ge]-Le[0][ge])/10);C.update(C.autoTicks?{bounds:Le,tickSpacing:Oe}:{bounds:Le})}var Ie=b.drawingBufferWidth,Qe=b.drawingBufferHeight;for(U[0]=Ie,U[1]=Qe,K[0]=0|Math.max(Ie/B.pixelRatio,1),K[1]=0|Math.max(Qe/B.pixelRatio,1),function(Re,Ge){var tt=Re.bounds,ct=Re.cameraParams,wt=ct.projection,kt=ct.model,et=Re.zNear,yt=Re.zFar,Vt=Re.fovy,Gt=Re.gl.drawingBufferWidth/Re.gl.drawingBufferHeight;Ge?(l(wt,-Gt,Gt,-1,1,et,yt),ct._ortho=!0):(f(wt,Vt,Gt,et,yt),ct._ortho=!1);for(var en=0;en<16;++en)kt[en]=0;kt[15]=1;var Jt=0;for(en=0;en<3;++en)Jt=Math.max(Jt,tt[1][en]-tt[0][en]);for(en=0;en<3;++en)kt[5*en]=Re.autoScale?Re.aspect[en]/(tt[1][en]-tt[0][en]):1/Jt,Re.autoCenter&&(kt[12+en]=.5*-kt[5*en]*(tt[0][en]+tt[1][en]))}(B,P),ge=0;ge<xe;++ge)(Pe=j[ge]).axesBounds=Le,B.clipToBounds&&(Pe.clipBounds=Le);T.object&&(D.position=B.snapToData?T.dataCoordinate:T.dataPosition,D.bounds=Le),X&&(X=!1,function(){if(!ae()){b.colorMask(!0,!0,!0,!0),b.depthMask(!0),b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL);for(var Re=j.length,Ge=W.length,tt=0;tt<Ge;++tt){var ct=W[tt];ct.shape=K,ct.begin();for(var wt=0;wt<Re;++wt)if(q[wt]===tt){var kt=j[wt];kt.drawPick&&(kt.pixelRatio=1,kt.drawPick(N))}ct.end()}}}()),B.axesPixels=i(B.axes,N,Ie,Qe),B.onrender&&B.onrender(),b.bindFramebuffer(b.FRAMEBUFFER,null),b.viewport(0,0,Ie,Qe),B.clearRGBA(),b.depthMask(!0),b.colorMask(!0,!0,!0,!0),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.disable(b.BLEND),b.disable(b.CULL_FACE);var Ne=!1;for(C.enable&&(Ne=Ne||C.isTransparent(),C.draw(N)),D.axes=C,T.object&&D.draw(N),b.disable(b.CULL_FACE),ge=0;ge<xe;++ge)(Pe=j[ge]).axes=C,Pe.pixelRatio=B.pixelRatio,Pe.isOpaque&&Pe.isOpaque()&&Pe.draw(N),Pe.isTransparent&&Pe.isTransparent()&&(Ne=!0);if(Ne){for(L.shape=U,L.bind(),b.clear(b.DEPTH_BUFFER_BIT),b.colorMask(!1,!1,!1,!1),b.depthMask(!0),b.depthFunc(b.LESS),C.enable&&C.isTransparent()&&C.drawTransparent(N),ge=0;ge<xe;++ge)(Pe=j[ge]).isOpaque&&Pe.isOpaque()&&Pe.draw(N);for(b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.colorMask(!0,!0,!0,!0),b.depthMask(!1),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),C.isTransparent()&&C.drawTransparent(N),ge=0;ge<xe;++ge){var Pe;(Pe=j[ge]).isTransparent&&Pe.isTransparent()&&Pe.drawTransparent(N)}b.bindFramebuffer(b.FRAMEBUFFER,null),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),M.bind(),L.color[0].bind(0),M.uniforms.accumBuffer=0,p(b),b.disable(b.BLEND)}for(G=!1,ge=0;ge<xe;++ge)j[ge].dirty=!1}}}return B.enableMouseListeners(),function fe(){B._stopped||B.contextLost||(ve(),requestAnimationFrame(fe))}(),B.redraw=function(){B._stopped||(G=!0,ve())},B},createCamera:e}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(t,k,x){var e=t("glslify");x.pointVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),x.pointFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),x.pickVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),x.pickFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:231}],123:[function(t,k,x){"use strict";var e=t("gl-shader"),r=t("gl-buffer"),i=t("typedarray-pool"),c=t("./lib/shader");function n(f,l,o,d,u){this.plot=f,this.offsetBuffer=l,this.pickBuffer=o,this.shader=d,this.pickShader=u,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}k.exports=function(f,l){var o=f.gl,h=new n(f,r(o),r(o),e(o,c.pointVertex,c.pointFragment),e(o,c.pickVertex,c.pickFragment));return h.update(l),f.addObject(h),h};var m,p,s=n.prototype;s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},s.update=function(f){var l;function o(b,w){return b in f?f[b]:w}f=f||{},this.sizeMin=o("sizeMin",.5),this.sizeMax=o("sizeMax",20),this.color=o("color",[1,0,0,1]).slice(),this.areaRatio=o("areaRatio",1),this.borderColor=o("borderColor",[0,0,0,1]).slice(),this.blend=o("blend",!1);var d=f.positions.length>>>1,u=f.positions instanceof Float32Array,a=f.idToIndex instanceof Int32Array&&f.idToIndex.length>=d,y=f.positions,h=u?y:i.mallocFloat32(y.length),_=a?f.idToIndex:i.mallocInt32(d);if(u||h.set(y),!a)for(h.set(y),l=0;l<d;l++)_[l]=l;this.points=y,this.offsetBuffer.update(h),this.pickBuffer.update(_),u||i.free(h),a||i.free(_),this.pointCount=d,this.pickOffset=0},s.unifiedDraw=(m=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0],function(f){var l=void 0!==f,o=l?this.pickShader:this.shader,d=this.plot.gl,u=this.plot.dataBox;if(0===this.pointCount)return f;var a=u[2]-u[0],y=u[3]-u[1],h=function(T,L){var M,P=0,z=T.length>>>1;for(M=0;M<z;M++){var S=T[2*M],C=T[2*M+1];S>=L[0]&&S<=L[2]&&C>=L[1]&&C<=L[3]&&P++}return P}(this.points,u),_=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(h,.33333)));m[0]=2/a,m[4]=2/y,m[6]=-2*u[0]/a-1,m[7]=-2*u[1]/y-1,this.offsetBuffer.bind(),o.bind(),o.attributes.position.pointer(),o.uniforms.matrix=m,o.uniforms.color=this.color,o.uniforms.borderColor=this.borderColor,o.uniforms.pointCloud=_<5,o.uniforms.pointSize=_,o.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),l&&(p[0]=255&f,p[1]=f>>8&255,p[2]=f>>16&255,p[3]=f>>24&255,this.pickBuffer.bind(),o.attributes.pickId.pointer(d.UNSIGNED_BYTE),o.uniforms.pickOffset=p,this.pickOffset=f);var b=d.getParameter(d.BLEND),w=d.getParameter(d.DITHER);return b&&!this.blend&&d.disable(d.BLEND),w&&d.disable(d.DITHER),d.drawArrays(d.POINTS,0,this.pointCount),b&&!this.blend&&d.enable(d.BLEND),w&&d.enable(d.DITHER),f+this.pointCount}),s.draw=s.unifiedDraw,s.drawPick=s.unifiedDraw,s.pick=function(f,l,o){var d=this.pickOffset;if(o<d||o>=d+this.pointCount)return null;var a=o-d,y=this.points;return{object:this,pointId:a,dataCoord:[y[2*a],y[2*a+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(t,k,x){k.exports=function(e,r,i,c){var n,m,p,s,f,l=r[0],o=r[1],d=r[2],u=r[3],a=i[0],y=i[1],h=i[2],_=i[3];return(m=l*a+o*y+d*h+u*_)<0&&(m=-m,a=-a,y=-y,h=-h,_=-_),1-m>1e-6?(n=Math.acos(m),p=Math.sin(n),s=Math.sin((1-c)*n)/p,f=Math.sin(c*n)/p):(s=1-c,f=c),e[0]=s*l+f*a,e[1]=s*o+f*y,e[2]=s*d+f*h,e[3]=s*u+f*_,e}},{}],125:[function(t,k,x){"use strict";k.exports=function(e){return e||0===e?e.toString():""}},{}],126:[function(t,k,x){"use strict";var e=t("vectorize-text");k.exports=function(i,c,n){var m=r[c];if(m||(m=r[c]={}),i in m)return m[i];var p={textAlign:"center",textBaseline:"middle",lineHeight:1,font:c,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},s=e(i,p);p.triangles=!1;var f,l,o=e(i,p);if(n&&1!==n){for(f=0;f<s.positions.length;++f)for(l=0;l<s.positions[f].length;++l)s.positions[f][l]/=n;for(f=0;f<o.positions.length;++f)for(l=0;l<o.positions[f].length;++l)o.positions[f][l]/=n}var d=[[1/0,1/0],[-1/0,-1/0]],u=o.positions.length;for(f=0;f<u;++f){var a=o.positions[f];for(l=0;l<2;++l)d[0][l]=Math.min(d[0][l],a[l]),d[1][l]=Math.max(d[1][l],a[l])}return m[i]=[s,o,d]};var r={}},{"vectorize-text":311}],127:[function(t,k,x){var e=t("gl-shader"),r=t("glslify"),i=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),c=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),n=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),m=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),p=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),s=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],f={vertex:i,fragment:m,attributes:s},l={vertex:c,fragment:m,attributes:s},o={vertex:n,fragment:m,attributes:s},d={vertex:i,fragment:p,attributes:s},u={vertex:c,fragment:p,attributes:s},a={vertex:n,fragment:p,attributes:s};function y(h,_){var b=e(h,_),w=b.attributes;return w.position.location=0,w.color.location=1,w.glyph.location=2,w.id.location=3,b}x.createPerspective=function(h){return y(h,f)},x.createOrtho=function(h){return y(h,l)},x.createProject=function(h){return y(h,o)},x.createPickPerspective=function(h){return y(h,d)},x.createPickOrtho=function(h){return y(h,u)},x.createPickProject=function(h){return y(h,a)}},{"gl-shader":132,glslify:231}],128:[function(t,k,x){"use strict";var e=t("is-string-blank"),r=t("gl-buffer"),i=t("gl-vao"),c=t("typedarray-pool"),n=t("gl-mat4/multiply"),m=t("./lib/shaders"),p=t("./lib/glyphs"),s=t("./lib/get-simple-string"),f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(Z,W){var G=Z[0],X=Z[1],ne=Z[2],V=Z[3];return Z[0]=W[0]*G+W[4]*X+W[8]*ne+W[12]*V,Z[1]=W[1]*G+W[5]*X+W[9]*ne+W[13]*V,Z[2]=W[2]*G+W[6]*X+W[10]*ne+W[14]*V,Z[3]=W[3]*G+W[7]*X+W[11]*ne+W[15]*V,Z}function o(Z,W,G,X){return l(X,X),l(X,X),l(X,X)}function d(Z,W){this.index=Z,this.dataCoordinate=this.position=W}function u(Z){return!0===Z||Z>1?1:Z}function a(Z,W,G,X,ne,V,N,U,ee,B,K,J){this.gl=Z,this.pixelRatio=1,this.shader=W,this.orthoShader=G,this.projectShader=X,this.pointBuffer=ne,this.colorBuffer=V,this.glyphBuffer=N,this.idBuffer=U,this.vao=ee,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=B,this.pickOrthoShader=K,this.pickProjectShader=J,this.points=[],this._selectResult=new d(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}k.exports=function(Z){var W=Z.gl,G=m.createPerspective(W),X=m.createOrtho(W),ne=m.createProject(W),V=m.createPickPerspective(W),N=m.createPickOrtho(W),U=m.createPickProject(W),ee=r(W),B=r(W),K=r(W),J=r(W),ae=new a(W,G,X,ne,ee,B,K,J,i(W,[{buffer:ee,size:3,type:W.FLOAT},{buffer:B,size:4,type:W.FLOAT},{buffer:K,size:2,type:W.FLOAT},{buffer:J,size:4,type:W.UNSIGNED_BYTE,normalized:!0}]),V,N,U);return ae.update(Z),ae};var y=a.prototype;y.pickSlots=1,y.setPickBase=function(Z){this.pickId=Z},y.isTransparent=function(){if(this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&this.projectHasAlpha)return!0;return!1},y.isOpaque=function(){if(!this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&!this.projectHasAlpha)return!0;return!1};var h=[0,0],_=[0,0,0],b=[0,0,0],w=[0,0,0,1],T=[0,0,0,1],L=f.slice(),M=[0,0,0],P=[[0,0,0],[0,0,0]];function z(Z){return Z[0]=Z[1]=Z[2]=0,Z}function S(Z,W){return Z[0]=W[0],Z[1]=W[1],Z[2]=W[2],Z[3]=1,Z}function C(Z,W,G,X){return Z[0]=W[0],Z[1]=W[1],Z[2]=W[2],Z[G]=X,Z}var D=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function j(Z,W,G,X,ne,V,N){var U=G.gl;if((V===G.projectHasAlpha||N)&&function R(Z,W,G,X){var ne,V=W.axesProject,N=W.gl,U=Z.uniforms,ee=G.model||f,B=G.view||f,K=G.projection||f,J=W.axesBounds,te=function(Le){for(var Me=P,De=0;De<2;++De)for(var Oe=0;Oe<3;++Oe)Me[De][Oe]=Math.max(Math.min(Le[De][Oe],1e8),-1e8);return Me}(W.clipBounds);ne=W.axes&&W.axes.lastCubeProps?W.axes.lastCubeProps.axis:[1,1,1],h[0]=2/N.drawingBufferWidth,h[1]=2/N.drawingBufferHeight,Z.bind(),U.view=B,U.projection=K,U.screenSize=h,U.highlightId=W.highlightId,U.highlightScale=W.highlightScale,U.clipBounds=te,U.pickGroup=W.pickId/255,U.pixelRatio=X;for(var ae=0;ae<3;++ae)if(V[ae]){U.scale=W.projectScale[ae],U.opacity=W.projectOpacity[ae];for(var ce=L,oe=0;oe<16;++oe)ce[oe]=0;for(oe=0;oe<4;++oe)ce[5*oe]=1;ce[5*ae]=0,ce[12+ae]=ne[ae]<0?J[0][ae]:J[1][ae],n(ce,ee,ce),U.model=ce;var ve=(ae+1)%3,fe=(ae+2)%3,xe=z(_),Se=z(b);xe[ve]=1,Se[fe]=1;var pe=o(0,0,0,S(w,xe)),ge=o(0,0,0,S(T,Se));if(Math.abs(pe[1])>Math.abs(ge[1])){var Te=pe;pe=ge,ge=Te,Te=xe,xe=Se,Se=Te;var se=ve;ve=fe,fe=se}pe[0]<0&&(xe[ve]=-1),ge[1]>0&&(Se[fe]=-1);var de=0,Ae=0;for(oe=0;oe<4;++oe)de+=Math.pow(ee[4*ve+oe],2),Ae+=Math.pow(ee[4*fe+oe],2);xe[ve]/=Math.sqrt(de),Se[fe]/=Math.sqrt(Ae),U.axes[0]=xe,U.axes[1]=Se,U.fragClipBounds[0]=C(M,te[0],ae,-1e8),U.fragClipBounds[1]=C(M,te[1],ae,1e8),W.vao.bind(),W.vao.draw(N.TRIANGLES,W.vertexCount),W.lineWidth>0&&(N.lineWidth(W.lineWidth*X),W.vao.draw(N.LINES,W.lineVertexCount,W.vertexCount)),W.vao.unbind()}}(W,G,X,ne),V===G.hasAlpha||N){Z.bind();var ee=Z.uniforms;ee.model=X.model||f,ee.view=X.view||f,ee.projection=X.projection||f,h[0]=2/U.drawingBufferWidth,h[1]=2/U.drawingBufferHeight,ee.screenSize=h,ee.highlightId=G.highlightId,ee.highlightScale=G.highlightScale,ee.fragClipBounds=D,ee.clipBounds=G.axes.bounds,ee.opacity=G.opacity,ee.pickGroup=G.pickId/255,ee.pixelRatio=ne,G.vao.bind(),G.vao.draw(U.TRIANGLES,G.vertexCount),G.lineWidth>0&&(U.lineWidth(G.lineWidth*ne),G.vao.draw(U.LINES,G.lineVertexCount,G.vertexCount)),G.vao.unbind()}}function q(Z,W,G,X){var ne;ne=Array.isArray(Z)?W<Z.length?Z[W]:void 0:Z,ne=s(ne);var V=!0;e(ne)&&(ne="\u25bc",V=!1);var N=p(ne,G,X);return{mesh:N[0],lines:N[1],bounds:N[2],visible:V}}y.draw=function(Z){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Z,this.pixelRatio,!1,!1)},y.drawTransparent=function(Z){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Z,this.pixelRatio,!0,!1)},y.drawPick=function(Z){j(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,Z,1,!0,!0)},y.pick=function(Z){if(!Z||Z.id!==this.pickId)return null;var W=Z.value[2]+(Z.value[1]<<8)+(Z.value[0]<<16);if(W>=this.pointCount||W<0)return null;var G=this.points[W],X=this._selectResult;X.index=W;for(var ne=0;ne<3;++ne)X.position[ne]=X.dataCoordinate[ne]=G[ne];return X},y.highlight=function(Z){if(Z){var W=Z.index;this.highlightId=[(255&W)/255,(W>>8&255)/255,(W>>16&255)/255,0]}else this.highlightId=[1,1,1,1]},y.update=function(Z){if("perspective"in(Z=Z||{})&&(this.useOrtho=!Z.perspective),"orthographic"in Z&&(this.useOrtho=!!Z.orthographic),"lineWidth"in Z&&(this.lineWidth=Z.lineWidth),"project"in Z)if(Array.isArray(Z.project))this.axesProject=Z.project;else{var W=!!Z.project;this.axesProject=[W,W,W]}if("projectScale"in Z)if(Array.isArray(Z.projectScale))this.projectScale=Z.projectScale.slice();else{var G=+Z.projectScale;this.projectScale=[G,G,G]}if(this.projectHasAlpha=!1,"projectOpacity"in Z){this.projectOpacity=Array.isArray(Z.projectOpacity)?Z.projectOpacity.slice():[G=+Z.projectOpacity,G,G];for(var X=0;X<3;++X)this.projectOpacity[X]=u(this.projectOpacity[X]),this.projectOpacity[X]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in Z&&(this.opacity=u(Z.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var ne,V,N=Z.position,U=Z.font||"normal",ee=Z.alignment||[0,0];if(2===ee.length)ne=ee[0],V=ee[1];else for(ne=[],V=[],X=0;X<ee.length;++X)ne[X]=ee[X][0],V[X]=ee[X][1];var B=[1/0,1/0,1/0],K=[-1/0,-1/0,-1/0],J=Z.glyph,te=Z.color,ae=Z.size,ce=Z.angle,oe=Z.lineColor,ve=-1,fe=0,xe=0,Se=0;if(N.length){Se=N.length;e:for(X=0;X<Se;++X){for(var pe=N[X],ge=0;ge<3;++ge)if(isNaN(pe[ge])||!isFinite(pe[ge]))continue e;var Te=(tt=q(J,X,U,this.pixelRatio)).mesh,se=tt.lines,de=tt.bounds;fe+=3*Te.cells.length,xe+=2*se.edges.length}}var Ae=fe+xe,Le=c.mallocFloat(3*Ae),Me=c.mallocFloat(4*Ae),De=c.mallocFloat(2*Ae),Oe=c.mallocUint32(Ae);if(Ae>0){var Ie=0,Qe=fe,Ne=[0,0,0,1],Pe=[0,0,0,1],Re=Array.isArray(te)&&Array.isArray(te[0]),Ge=Array.isArray(oe)&&Array.isArray(oe[0]);e:for(X=0;X<Se;++X){for(ve+=1,pe=N[X],ge=0;ge<3;++ge){if(isNaN(pe[ge])||!isFinite(pe[ge]))continue e;K[ge]=Math.max(K[ge],pe[ge]),B[ge]=Math.min(B[ge],pe[ge])}Te=(tt=q(J,X,U,this.pixelRatio)).mesh,se=tt.lines,de=tt.bounds;var tt,ct=tt.visible;if(ct)if(Array.isArray(te)){if(3===(wt=Re?X<te.length?te[X]:[0,0,0,0]:te).length){for(ge=0;ge<3;++ge)Ne[ge]=wt[ge];Ne[3]=1}else if(4===wt.length){for(ge=0;ge<4;++ge)Ne[ge]=wt[ge];!this.hasAlpha&&wt[3]<1&&(this.hasAlpha=!0)}}else Ne[0]=Ne[1]=Ne[2]=0,Ne[3]=1;else Ne=[1,1,1,0];if(ct)if(Array.isArray(oe)){var wt;if(3===(wt=Ge?X<oe.length?oe[X]:[0,0,0,0]:oe).length){for(ge=0;ge<3;++ge)Pe[ge]=wt[ge];Pe[ge]=1}else if(4===wt.length){for(ge=0;ge<4;++ge)Pe[ge]=wt[ge];!this.hasAlpha&&wt[3]<1&&(this.hasAlpha=!0)}}else Pe[0]=Pe[1]=Pe[2]=0,Pe[3]=1;else Pe=[1,1,1,0];var kt=.5;ct?Array.isArray(ae)?kt=X<ae.length?+ae[X]:12:ae?kt=+ae:this.useOrtho&&(kt=12):kt=0;var gt=0;Array.isArray(ce)?gt=X<ce.length?+ce[X]:0:ce&&(gt=+ce);var at=Math.cos(gt),et=Math.sin(gt);for(pe=N[X],ge=0;ge<3;++ge)K[ge]=Math.max(K[ge],pe[ge]),B[ge]=Math.min(B[ge],pe[ge]);var yt=ne,Vt=V;yt=0,Array.isArray(ne)?yt=X<ne.length?ne[X]:0:ne&&(yt=ne),Vt=0,Array.isArray(V)?Vt=X<V.length?V[X]:0:V&&(Vt=V);var Gt=[yt*=yt>0?1-de[0][0]:yt<0?1+de[1][0]:1,Vt*=Vt>0?1-de[0][1]:Vt<0?1+de[1][1]:1],en=Te.cells||[],Jt=Te.positions||[];for(ge=0;ge<en.length;++ge)for(var cn=en[ge],Rt=0;Rt<3;++Rt){for(var je=0;je<3;++je)Le[3*Ie+je]=pe[je];for(je=0;je<4;++je)Me[4*Ie+je]=Ne[je];Oe[Ie]=ve;var Ye=Jt[cn[Rt]];De[2*Ie]=kt*(at*Ye[0]-et*Ye[1]+Gt[0]),De[2*Ie+1]=kt*(et*Ye[0]+at*Ye[1]+Gt[1]),Ie+=1}for(en=se.edges,Jt=se.positions,ge=0;ge<en.length;++ge)for(cn=en[ge],Rt=0;Rt<2;++Rt){for(je=0;je<3;++je)Le[3*Qe+je]=pe[je];for(je=0;je<4;++je)Me[4*Qe+je]=Pe[je];Oe[Qe]=ve,De[2*Qe]=kt*(at*(Ye=Jt[cn[Rt]])[0]-et*Ye[1]+Gt[0]),De[2*Qe+1]=kt*(et*Ye[0]+at*Ye[1]+Gt[1]),Qe+=1}}}this.bounds=[B,K],this.points=N,this.pointCount=N.length,this.vertexCount=fe,this.lineVertexCount=xe,this.pointBuffer.update(Le),this.colorBuffer.update(Me),this.glyphBuffer.update(De),this.idBuffer.update(Oe),c.free(Le),c.free(Me),c.free(De),c.free(Oe)},y.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(t,k,x){"use strict";var e=t("glslify");x.boxVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),x.boxFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:231}],130:[function(t,k,x){"use strict";var e=t("gl-shader"),r=t("gl-buffer"),i=t("./lib/shaders");function c(m,p,s){this.plot=m,this.boxBuffer=p,this.boxShader=s,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}k.exports=function(m,p){var s=m.gl,o=new c(m,r(s,[0,0,0,1,1,0,1,1]),e(s,i.boxVertex,i.boxFragment));return o.update(p),m.addOverlay(o),o};var n=c.prototype;n.draw=function(){if(this.enabled){var m=this.plot,p=this.selectBox,s=this.borderWidth,f=this.innerColor,l=this.outerColor,o=this.borderColor,d=m.box,u=m.screenBox,a=m.dataBox,y=m.viewBox,h=m.pixelRatio,_=(p[0]-a[0])*(y[2]-y[0])/(a[2]-a[0])+y[0],b=(p[1]-a[1])*(y[3]-y[1])/(a[3]-a[1])+y[1],w=(p[2]-a[0])*(y[2]-y[0])/(a[2]-a[0])+y[0],T=(p[3]-a[1])*(y[3]-y[1])/(a[3]-a[1])+y[1];if(_=Math.max(_,y[0]),b=Math.max(b,y[1]),w=Math.min(w,y[2]),T=Math.min(T,y[3]),!(w<_||T<b)){d.bind();var L=u[2]-u[0],M=u[3]-u[1];if(this.outerFill&&(d.drawBox(0,0,L,b,l),d.drawBox(0,b,_,T,l),d.drawBox(0,T,L,M,l),d.drawBox(w,b,L,T,l)),this.innerFill&&d.drawBox(_,b,w,T,f),s>0){var P=s*h;d.drawBox(_-P,b-P,w+P,b+P,o),d.drawBox(_-P,T-P,w+P,T+P,o),d.drawBox(_-P,b-P,_+P,T+P,o),d.drawBox(w-P,b-P,w+P,T+P,o)}}}},n.update=function(m){this.innerFill=!!(m=m||{}).innerFill,this.outerFill=!!m.outerFill,this.innerColor=(m.innerColor||[0,0,0,.5]).slice(),this.outerColor=(m.outerColor||[0,0,0,.5]).slice(),this.borderColor=(m.borderColor||[0,0,0,1]).slice(),this.borderWidth=m.borderWidth||0,this.selectBox=(m.selectBox||this.selectBox).slice()},n.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(t,k,x){"use strict";k.exports=function(s,f){var l=f[0],o=f[1];return new m(s,e(s,l,o,{}),r.mallocUint8(l*o*4))};var e=t("gl-fbo"),r=t("typedarray-pool"),i=t("ndarray"),c=t("bit-twiddle").nextPow2;function n(s,f,l,o,d){this.coord=[s,f],this.id=l,this.value=o,this.distance=d}function m(s,f,l){this.gl=s,this.fbo=f,this.buffer=l,this._readTimeout=null;var o=this;this._readCallback=function(){o.gl&&(f.bind(),s.readPixels(0,0,f.shape[0],f.shape[1],s.RGBA,s.UNSIGNED_BYTE,o.buffer),o._readTimeout=null)}}var p=m.prototype;Object.defineProperty(p,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(s){if(this.gl){this.fbo.shape=s;var f=this.fbo.shape[0],l=this.fbo.shape[1];if(l*f*4>this.buffer.length){r.free(this.buffer);for(var o=this.buffer=r.mallocUint8(c(l*f*4)),d=0;d<l*f*4;++d)o[d]=255}return s}}}),p.begin=function(){var s=this.gl;s&&(this.fbo.bind(),s.clearColor(1,1,1,1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT))},p.end=function(){var s=this.gl;s&&(s.bindFramebuffer(s.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},p.query=function(s,f,l){if(!this.gl)return null;var o=this.fbo.shape.slice();s|=0,f|=0,"number"!=typeof l&&(l=1);var d=0|Math.min(Math.max(s-l,0),o[0]),u=0|Math.min(Math.max(s+l,0),o[0]),a=0|Math.min(Math.max(f-l,0),o[1]),y=0|Math.min(Math.max(f+l,0),o[1]);if(u<=d||y<=a)return null;var h=[u-d,y-a],_=i(this.buffer,[h[0],h[1],4],[4,4*o[0],1],4*(d+o[0]*a)),b=function(L,M,P){for(var z=1e8,S=-1,C=-1,R=L.shape[0],D=L.shape[1],j=0;j<R;j++)for(var q=0;q<D;q++){var Z=L.get(j,q,0),W=L.get(j,q,1),G=L.get(j,q,2),X=L.get(j,q,3);if(Z<255||W<255||G<255||X<255){var ne=M-j,V=P-q,N=ne*ne+V*V;N<z&&(z=N,S=j,C=q)}}return[S,C,z]}(_.hi(h[0],h[1],1),l,l),w=b[0],T=b[1];return w<0||Math.pow(this.radius,2)<b[2]?null:new n(w+d|0,T+a|0,_.get(w,T,0),[_.get(w,T,1),_.get(w,T,2),_.get(w,T,3)],Math.sqrt(b[2]))},p.dispose=function(){this.gl&&(this.fbo.dispose(),r.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(t,k,x){"use strict";var e=t("./lib/create-uniforms"),r=t("./lib/create-attributes"),i=t("./lib/reflect"),c=t("./lib/shader-cache"),n=t("./lib/runtime-reflect"),m=t("./lib/GLError");function p(l){this.gl=l,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var s=p.prototype;function f(l,o){return l.name<o.name?-1:1}s.bind=function(){var l;this.program||this._relink();var o=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),d=this.gl.lastAttribCount;if(o>d)for(l=d;l<o;l++)this.gl.enableVertexAttribArray(l);else if(d>o)for(l=o;l<d;l++)this.gl.disableVertexAttribArray(l);this.gl.lastAttribCount=o,this.gl.useProgram(this.program)},s.dispose=function(){for(var l=this.gl.lastAttribCount,o=0;o<l;o++)this.gl.disableVertexAttribArray(o);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},s.update=function(l,o,d,u){if(!o||1===arguments.length){var a=l;l=a.vertex,o=a.fragment,d=a.uniforms,u=a.attributes}var y=this,h=y.gl,_=y._vref;y._vref=c.shader(h,h.VERTEX_SHADER,l),_&&_.dispose(),y.vertShader=y._vref.shader;var b=this._fref;if(y._fref=c.shader(h,h.FRAGMENT_SHADER,o),b&&b.dispose(),y.fragShader=y._fref.shader,!d||!u){var w=h.createProgram();if(h.attachShader(w,y.fragShader),h.attachShader(w,y.vertShader),h.linkProgram(w),!h.getProgramParameter(w,h.LINK_STATUS)){var T=h.getProgramInfoLog(w);throw new m(T,"Error linking program:"+T)}d=d||n.uniforms(h,w),u=u||n.attributes(h,w),h.deleteProgram(w)}(u=u.slice()).sort(f);var L,M=[],P=[],z=[];for(L=0;L<u.length;++L){var S=u[L];if(S.type.indexOf("mat")>=0){for(var C=0|S.type.charAt(S.type.length-1),R=new Array(C),D=0;D<C;++D)R[D]=z.length,P.push(S.name+"["+D+"]"),"number"==typeof S.location?z.push(S.location+D):Array.isArray(S.location)&&S.location.length===C&&"number"==typeof S.location[D]?z.push(0|S.location[D]):z.push(-1);M.push({name:S.name,type:S.type,locations:R})}else M.push({name:S.name,type:S.type,locations:[z.length]}),P.push(S.name),z.push("number"==typeof S.location?0|S.location:-1)}var j=0;for(L=0;L<z.length;++L)if(z[L]<0){for(;z.indexOf(j)>=0;)j+=1;z[L]=j}var q=new Array(d.length);function Z(){y.program=c.program(h,y._vref,y._fref,P,z);for(var W=0;W<d.length;++W)q[W]=h.getUniformLocation(y.program,d[W].name)}Z(),y._relink=Z,y.types={uniforms:i(d),attributes:i(u)},y.attributes=r(h,y,M,z),Object.defineProperty(y,"uniforms",e(h,y,d,q))},k.exports=function(l,o,d,u,a){var y=new p(l);return y.update(o,d,u,a),y}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(t,k,x){function e(r,i,c){this.shortMessage=i||"",this.longMessage=c||"",this.rawError=r||"",this.message="gl-shader: "+(i||r||"")+(c?"\n"+c:""),this.stack=(new Error).stack}(e.prototype=new Error).name="GLError",e.prototype.constructor=e,k.exports=e},{}],134:[function(t,k,x){"use strict";k.exports=function(p,s,f,l){for(var o={},d=0,u=f.length;d<u;++d){var a=f[d],y=a.name,h=a.type,_=a.locations;switch(h){case"bool":case"int":case"float":n(p,s,_[0],l,1,o,y);break;default:if(h.indexOf("vec")>=0){if((b=h.charCodeAt(h.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+y+": "+h);n(p,s,_[0],l,b,o,y)}else{if(!(h.indexOf("mat")>=0))throw new e("","Unknown data type for attribute "+y+": "+h);var b;if((b=h.charCodeAt(h.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+y+": "+h);m(p,s,_,l,b,o,y)}}}return o};var e=t("./GLError");function r(p,s,f,l,o,d){this._gl=p,this._wrapper=s,this._index=f,this._locations=l,this._dimension=o,this._constFunc=d}var i=r.prototype;i.pointer=function(p,s,f,l){var o=this._gl,d=this._locations[this._index];o.vertexAttribPointer(d,this._dimension,p||o.FLOAT,!!s,f||0,l||0),o.enableVertexAttribArray(d)},i.set=function(p,s,f,l){return this._constFunc(this._locations[this._index],p,s,f,l)},Object.defineProperty(i,"location",{get:function(){return this._locations[this._index]},set:function(p){return p!==this._locations[this._index]&&(this._locations[this._index]=0|p,this._wrapper.program=null),0|p}});var c=[function(p,s,f){return void 0===f.length?p.vertexAttrib1f(s,f):p.vertexAttrib1fv(s,f)},function(p,s,f,l){return void 0===f.length?p.vertexAttrib2f(s,f,l):p.vertexAttrib2fv(s,f)},function(p,s,f,l,o){return void 0===f.length?p.vertexAttrib3f(s,f,l,o):p.vertexAttrib3fv(s,f)},function(p,s,f,l,o,d){return void 0===f.length?p.vertexAttrib4f(s,f,l,o,d):p.vertexAttrib4fv(s,f)}];function n(p,s,f,l,o,d,u){var a=c[o],y=new r(p,s,f,l,o,a);Object.defineProperty(d,u,{set:function(h){return p.disableVertexAttribArray(l[f]),a(p,l[f],h),h},get:function(){return y},enumerable:!0})}function m(p,s,f,l,o,d,u){for(var a=new Array(o),y=new Array(o),h=0;h<o;++h)n(p,s,f[h],l,o,a,h),y[h]=a[h];Object.defineProperty(a,"location",{set:function(w){if(Array.isArray(w))for(var T=0;T<o;++T)y[T].location=w[T];else for(T=0;T<o;++T)y[T].location=w+T;return w},get:function(){for(var w=new Array(o),T=0;T<o;++T)w[T]=l[f[T]];return w},enumerable:!0}),a.pointer=function(w,T,L,M){w=w||p.FLOAT,T=!!T,L=L||o*o,M=M||0;for(var P=0;P<o;++P){var z=l[f[P]];p.vertexAttribPointer(z,o,w,T,L,M+P*o),p.enableVertexAttribArray(z)}};var _=new Array(o),b=p["vertexAttrib"+o+"fv"];Object.defineProperty(d,u,{set:function(w){for(var T=0;T<o;++T){var L=l[f[T]];if(p.disableVertexAttribArray(L),Array.isArray(w[0]))b.call(p,L,w[T]);else{for(var M=0;M<o;++M)_[M]=w[o*T+M];b.call(p,L,_)}}return w},get:function(){return a},enumerable:!0})}},{"./GLError":133}],135:[function(t,k,x){"use strict";var e=t("./reflect"),r=t("./GLError");function i(n){return function(){return n}}function c(n,m){for(var p=new Array(n),s=0;s<n;++s)p[s]=m;return p}k.exports=function(n,m,p,s){function f(u){return function(a){for(var y=function D(j,q){if("object"!=typeof q)return[[j,q]];var Z=[];for(var W in q){var G=q[W],X=j;parseInt(W)+""===W?X+="["+W+"]":X+="."+W,"object"==typeof G?Z.push.apply(Z,D(X,G)):Z.push([X,G])}return Z}("",u),h=0;h<y.length;++h){var _=y[h],b=_[0],w=_[1];if(s[w]){var T=a;if("string"==typeof b&&(0===b.indexOf(".")||0===b.indexOf("["))){var L=b;if(0===b.indexOf(".")&&(L=b.slice(1)),L.indexOf("]")===L.length-1){var M=L.indexOf("["),P=L.slice(0,M),z=L.slice(M+1,L.length-1);T=P?a[P][z]:a[z]}else T=a[L]}var S,C=p[w].type;switch(C){case"bool":case"int":case"sampler2D":case"samplerCube":n.uniform1i(s[w],T);break;case"float":n.uniform1f(s[w],T);break;default:var R=C.indexOf("vec");if(!(0<=R&&R<=1&&C.length===4+R)){if(0===C.indexOf("mat")&&4===C.length){if((S=C.charCodeAt(C.length-1)-48)<2||S>4)throw new r("","Invalid uniform dimension type for matrix "+name+": "+C);n["uniformMatrix"+S+"fv"](s[w],!1,T);break}throw new r("","Unknown uniform data type for "+name+": "+C)}if((S=C.charCodeAt(C.length-1)-48)<2||S>4)throw new r("","Invalid data type");switch(C.charAt(0)){case"b":case"i":n["uniform"+S+"iv"](s[w],T);break;case"v":n["uniform"+S+"fv"](s[w],T);break;default:throw new r("","Unrecognized data type for vector "+name+": "+C)}}}}}}function l(u,a,y){if("object"==typeof y){var h=o(y);Object.defineProperty(u,a,{get:i(h),set:f(y),enumerable:!0,configurable:!1})}else s[y]?Object.defineProperty(u,a,{get:(_=y,function(b,w,T){return b.getUniform(w.program,T[_])}),set:f(y),enumerable:!0,configurable:!1}):u[a]=function(b){switch(b){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var w=b.indexOf("vec");if(0<=w&&w<=1&&b.length===4+w){if((T=b.charCodeAt(b.length-1)-48)<2||T>4)throw new r("","Invalid data type");return"b"===b.charAt(0)?c(T,!1):c(T,0)}if(0===b.indexOf("mat")&&4===b.length){var T;if((T=b.charCodeAt(b.length-1)-48)<2||T>4)throw new r("","Invalid uniform dimension type for matrix "+name+": "+b);return c(T*T,0)}throw new r("","Unknown uniform data type for "+name+": "+b)}}(p[y].type);var _}function o(u){var a;if(Array.isArray(u)){a=new Array(u.length);for(var y=0;y<u.length;++y)l(a,y,u[y])}else for(var h in a={},u)l(a,h,u[h]);return a}var d=e(p,!0);return{get:i(o(d)),set:f(d),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(t,k,x){"use strict";k.exports=function(e,r){for(var i={},c=0;c<e.length;++c)for(var n=e[c].name.split("."),m=i,p=0;p<n.length;++p){var s=n[p].split("[");if(s.length>1){s[0]in m||(m[s[0]]=[]),m=m[s[0]];for(var f=1;f<s.length;++f){var l=parseInt(s[f]);f<s.length-1||p<n.length-1?(l in m||(m[l]=f<s.length-1?[]:{}),m=m[l]):m[l]=r?c:e[c].type}}else p<n.length-1?(s[0]in m||(m[s[0]]={}),m=m[s[0]]):m[s[0]]=r?c:e[c].type}return i}},{}],137:[function(t,k,x){"use strict";x.uniforms=function(c,n){for(var m=c.getProgramParameter(n,c.ACTIVE_UNIFORMS),p=[],s=0;s<m;++s){var f=c.getActiveUniform(n,s);if(f){var l=i(c,f.type);if(f.size>1)for(var o=0;o<f.size;++o)p.push({name:f.name.replace("[0]","["+o+"]"),type:l});else p.push({name:f.name,type:l})}}return p},x.attributes=function(c,n){for(var m=c.getProgramParameter(n,c.ACTIVE_ATTRIBUTES),p=[],s=0;s<m;++s){var f=c.getActiveAttrib(n,s);f&&p.push({name:f.name,type:i(c,f.type)})}return p};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},r=null;function i(c,n){if(!r){var m=Object.keys(e);r={};for(var p=0;p<m.length;++p){var s=m[p];r[c[s]]=e[s]}}return r[n]}},{}],138:[function(t,k,x){"use strict";x.shader=function(f,l,o){return s(f).getShaderReference(l,o)},x.program=function(f,l,o,d,u){return s(f).getProgram(l,o,d,u)};var e=t("./GLError"),r=t("gl-format-compiler-error"),i=new("undefined"==typeof WeakMap?t("weakmap-shim"):WeakMap),c=0;function n(f,l,o,d,u,a,y){this.id=f,this.src=l,this.type=o,this.shader=d,this.count=a,this.programs=[],this.cache=y}function m(f){this.gl=f,this.shaders=[{},{}],this.programs={}}n.prototype.dispose=function(){if(0==--this.count){for(var f=this.cache,l=f.gl,o=this.programs,d=0,u=o.length;d<u;++d){var a=f.programs[o[d]];a&&(delete f.programs[d],l.deleteProgram(a))}l.deleteShader(this.shader),delete f.shaders[this.type===l.FRAGMENT_SHADER|0][this.src]}};var p=m.prototype;function s(f){var l=i.get(f);return l||(l=new m(f),i.set(f,l)),l}p.getShaderReference=function(f,l){var o=this.gl,d=this.shaders[f===o.FRAGMENT_SHADER|0],u=d[l];if(u&&o.isShader(u.shader))u.count+=1;else{var a=function(y,h,_){var b=y.createShader(h);if(y.shaderSource(b,_),y.compileShader(b),!y.getShaderParameter(b,y.COMPILE_STATUS)){var w=y.getShaderInfoLog(b);try{var T=r(w,_,h)}catch(L){throw console.warn("Failed to format compiler error: "+L),new e(w,"Error compiling shader:\n"+w)}throw new e(w,T.short,T.long)}return b}(o,f,l);u=d[l]=new n(c++,l,f,a,[],1,this)}return u},p.getProgram=function(f,l,o,d){var u=[f.id,l.id,o.join(":"),d.join(":")].join("@"),a=this.programs[u];return a&&this.gl.isProgram(a)||(this.programs[u]=a=function(y,h,_,b,w){var T=y.createProgram();y.attachShader(T,h),y.attachShader(T,_);for(var L=0;L<b.length;++L)y.bindAttribLocation(T,w[L],b[L]);if(y.linkProgram(T),!y.getProgramParameter(T,y.LINK_STATUS)){var M=y.getProgramInfoLog(T);throw new e(M,"Error linking program: "+M)}return T}(this.gl,f.shader,l.shader,o,d),f.programs.push(u),l.programs.push(u)),a}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(t,k,x){"use strict";function e(i){this.plot=i,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}k.exports=function(i,c){var n=new e(i);return n.update(c),i.addOverlay(n),n};var r=e.prototype;r.update=function(i){this.enable=((i=i||{}).enable||[!0,!0,!1,!1]).slice(),this.width=(i.width||[1,1,1,1]).slice(),this.color=(i.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(c){return c.slice()}),this.center=(i.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},r.draw=function(){var i=this.enable,c=this.width,n=this.color,m=this.center,p=this.plot,s=p.line,f=p.dataBox,l=p.viewBox;if(s.bind(),f[0]<=m[0]&&m[0]<=f[2]&&f[1]<=m[1]&&m[1]<=f[3]){var o=l[0]+(m[0]-f[0])/(f[2]-f[0])*(l[2]-l[0]),d=l[1]+(m[1]-f[1])/(f[3]-f[1])*(l[3]-l[1]);i[0]&&s.drawLine(o,d,l[0],d,c[0],n[0]),i[1]&&s.drawLine(o,d,o,l[1],c[1],n[1]),i[2]&&s.drawLine(o,d,l[2],d,c[2],n[2]),i[3]&&s.drawLine(o,d,o,l[3],c[3],n[3])}},r.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(t,k,x){"use strict";var e=t("glslify"),r=t("gl-shader"),i=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),c=e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);k.exports=function(n){return r(n,i,c,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(t,k,x){"use strict";var e=t("gl-buffer"),r=t("gl-vao"),i=t("./shaders/index");k.exports=function(l,o){var d=[];function u(b,w,T,L,M,P){var z=[b,w,T,0,0,0,1];z[L+3]=1,z[L]=M,d.push.apply(d,z),z[6]=-1,d.push.apply(d,z),z[L]=P,d.push.apply(d,z),d.push.apply(d,z),z[6]=1,d.push.apply(d,z),z[L]=M,d.push.apply(d,z)}u(0,0,0,0,0,1),u(0,0,0,1,0,1),u(0,0,0,2,0,1),u(1,0,0,1,-1,1),u(1,0,0,2,-1,1),u(0,1,0,0,-1,1),u(0,1,0,2,-1,1),u(0,0,1,0,-1,1),u(0,0,1,1,-1,1);var a=e(l,d),y=r(l,[{type:l.FLOAT,buffer:a,size:3,offset:0,stride:28},{type:l.FLOAT,buffer:a,size:3,offset:12,stride:28},{type:l.FLOAT,buffer:a,size:1,offset:24,stride:28}]),h=i(l);h.attributes.position.location=0,h.attributes.color.location=1,h.attributes.weight.location=2;var _=new n(l,a,y,h);return _.update(o),_};var c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function n(l,o,d,u){this.gl=l,this.buffer=o,this.vao=d,this.shader=u,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var m=n.prototype,p=[0,0,0],s=[0,0,0],f=[0,0];m.isTransparent=function(){return!1},m.drawTransparent=function(l){},m.draw=function(l){var o=this.gl,d=this.vao,u=this.shader;d.bind(),u.bind();var a,y=l.model||c,h=l.view||c,_=l.projection||c;this.axes&&(a=this.axes.lastCubeProps.axis);for(var b=p,w=s,T=0;T<3;++T)a&&a[T]<0?(b[T]=this.bounds[0][T],w[T]=this.bounds[1][T]):(b[T]=this.bounds[1][T],w[T]=this.bounds[0][T]);for(f[0]=o.drawingBufferWidth,f[1]=o.drawingBufferHeight,u.uniforms.model=y,u.uniforms.view=h,u.uniforms.projection=_,u.uniforms.coordinates=[this.position,b,w],u.uniforms.colors=this.colors,u.uniforms.screenShape=f,T=0;T<3;++T)u.uniforms.lineWidth=this.lineWidth[T]*this.pixelRatio,this.enabled[T]&&(d.draw(o.TRIANGLES,6,6*T),this.drawSides[T]&&d.draw(o.TRIANGLES,12,18+12*T));d.unbind()},m.update=function(l){l&&("bounds"in l&&(this.bounds=l.bounds),"position"in l&&(this.position=l.position),"lineWidth"in l&&(this.lineWidth=l.lineWidth),"colors"in l&&(this.colors=l.colors),"enabled"in l&&(this.enabled=l.enabled),"drawSides"in l&&(this.drawSides=l.drawSides))},m.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(t,k,x){var e=t("glslify"),r=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),i=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),c=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),n=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);x.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},x.pickShader={vertex:c,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(t,k,x){"use strict";var e=t("gl-vec3"),r=t("gl-vec4"),i=["xyz","xzy","yxz","yzx","zxy","zyx"],n=function(l,o){var d,u=l.length;for(d=0;d<u;d++){var a=l[d];if(a===o)return d;if(a>o)return d-1}return d},m=function(l,o,d){return l<o?o:l>d?d:l},p=function(l){var o=1/0;l.sort(function(y,h){return y-h});for(var d=l.length,u=1;u<d;u++){var a=Math.abs(l[u]-l[u-1]);a<o&&(o=a)}return o};k.exports=function(l,o){var d=l.startingPositions,u=l.maxLength||1e3,a=l.tubeSize||1,y=l.absoluteTubeSize,h=l.gridFill||"+x+y+z",_={};-1!==h.indexOf("-x")&&(_.reversedX=!0),-1!==h.indexOf("-y")&&(_.reversedY=!0),-1!==h.indexOf("-z")&&(_.reversedZ=!0),_.filled=i.indexOf(h.replace(/-/g,"").replace(/\+/g,""));var oe,ve,fe,xe,b=l.getVelocity||function(oe){return function(ve,fe,xe){var Se=fe.vectors,pe=fe.meshgrid,ge=ve[0],Te=ve[1],se=ve[2],de=pe[0].length,Ae=pe[1].length,Le=pe[2].length,Me=n(pe[0],ge),De=n(pe[1],Te),Oe=n(pe[2],se),Ie=Me+1,Qe=De+1,Ne=Oe+1;if(Me=m(Me,0,de-1),Ie=m(Ie,0,de-1),De=m(De,0,Ae-1),Qe=m(Qe,0,Ae-1),Oe=m(Oe,0,Le-1),Ne=m(Ne,0,Le-1),Me<0||De<0||Oe<0||Ie>de-1||Qe>Ae-1||Ne>Le-1)return e.create();var Pe,Re,Ge,tt,ct,wt,kt=pe[0][Me],at=pe[1][De],yt=pe[2][Oe],Vt=(ge-kt)/(pe[0][Ie]-kt),Gt=(Te-at)/(pe[1][Qe]-at),en=(se-yt)/(pe[2][Ne]-yt);switch(isFinite(Vt)||(Vt=.5),isFinite(Gt)||(Gt=.5),isFinite(en)||(en=.5),xe.reversedX&&(Me=de-1-Me,Ie=de-1-Ie),xe.reversedY&&(De=Ae-1-De,Qe=Ae-1-Qe),xe.reversedZ&&(Oe=Le-1-Oe,Ne=Le-1-Ne),xe.filled){case 5:ct=Oe,wt=Ne,Ge=De*Le,tt=Qe*Le,Pe=Me*Le*Ae,Re=Ie*Le*Ae;break;case 4:ct=Oe,wt=Ne,Pe=Me*Le,Re=Ie*Le,Ge=De*Le*de,tt=Qe*Le*de;break;case 3:Ge=De,tt=Qe,ct=Oe*Ae,wt=Ne*Ae,Pe=Me*Ae*Le,Re=Ie*Ae*Le;break;case 2:Ge=De,tt=Qe,Pe=Me*Ae,Re=Ie*Ae,ct=Oe*Ae*de,wt=Ne*Ae*de;break;case 1:Pe=Me,Re=Ie,ct=Oe*de,wt=Ne*de,Ge=De*de*Le,tt=Qe*de*Le;break;default:Pe=Me,Re=Ie,Ge=De*de,tt=Qe*de,ct=Oe*de*Ae,wt=Ne*de*Ae}var Jt=Se[Pe+Ge+ct],cn=Se[Pe+Ge+wt],Rt=Se[Pe+tt+ct],je=Se[Pe+tt+wt],Ye=Se[Re+Ge+ct],he=Se[Re+Ge+wt],be=Se[Re+tt+ct],Fe=Se[Re+tt+wt],He=e.create(),Ke=e.create(),Ze=e.create(),ut=e.create();e.lerp(He,Jt,Ye,Vt),e.lerp(Ke,cn,he,Vt),e.lerp(Ze,Rt,be,Vt),e.lerp(ut,je,Fe,Vt);var lt=e.create(),Lt=e.create();e.lerp(lt,He,Ze,Gt),e.lerp(Lt,Ke,ut,Gt);var Ot=e.create();return e.lerp(Ot,lt,Lt,en),Ot}(oe,l,_)},w=l.getDivergence||function(oe,ve){var fe=e.create(),xe=1e-4;e.add(fe,oe,[xe,0,0]);var Se=b(fe);e.subtract(Se,Se,ve),e.scale(Se,Se,1/xe),e.add(fe,oe,[0,xe,0]);var pe=b(fe);e.subtract(pe,pe,ve),e.scale(pe,pe,1/xe),e.add(fe,oe,[0,0,xe]);var ge=b(fe);return e.subtract(ge,ge,ve),e.scale(ge,ge,1/xe),e.add(fe,Se,pe),e.add(fe,fe,ge),fe},T=[],L=o[0][0],M=o[0][1],P=o[0][2],z=o[1][0],S=o[1][1],C=o[1][2],D=10*e.distance(o[0],o[1])/u,j=D*D,q=1,Z=0,W=d.length;W>1&&(q=function(oe){for(var ve=[],fe=[],xe=[],Se={},pe={},ge={},Te=oe.length,se=0;se<Te;se++){var de=oe[se],Ae=de[0],Le=de[1],Me=de[2];Se[Ae]||(ve.push(Ae),Se[Ae]=!0),pe[Le]||(fe.push(Le),pe[Le]=!0),ge[Me]||(xe.push(Me),ge[Me]=!0)}var De=p(ve),Oe=p(fe),Ie=p(xe),Qe=Math.min(De,Oe,Ie);return isFinite(Qe)?Qe:1}(d));for(var G=0;G<W;G++){var X=e.create();e.copy(X,d[G]);var ne=[X],V=[],N=b(X),U=X;V.push(N);var ee=[],B=w(X,N),K=e.length(B);isFinite(K)&&K>Z&&(Z=K),ee.push(K),T.push({points:ne,velocities:V,divergences:ee});for(var J=0;J<100*u&&ne.length<u&&(ve=void 0,fe=void 0,xe=void 0,fe=(oe=X)[1],xe=oe[2],!((ve=oe[0])<L||ve>z||fe<M||fe>S||xe<P||xe>C));){J++;var te=e.clone(N),ae=e.squaredLength(te);if(0===ae)break;ae>j&&e.scale(te,te,D/Math.sqrt(ae)),e.add(te,te,X),N=b(te),e.squaredDistance(U,te)-j>-1e-4*j&&(ne.push(te),U=te,V.push(N),B=w(te,N),K=e.length(B),isFinite(K)&&K>Z&&(Z=K),ee.push(K)),X=te}}var ce=function(l,o,d,u){for(var a=0,y=0;y<l.length;y++)for(var h=l[y].velocities,_=0;_<h.length;_++)a=Math.max(a,e.length(h[_]));var b=l.map(function(D){return function(j,q,Z,W){for(var G=j.points,X=j.velocities,ne=j.divergences,V=[],N=[],U=[],ee=[],B=[],K=[],J=0,te=0,ae=r.create(),ce=r.create(),oe=0;oe<G.length;oe++){var ve=G[oe],fe=X[oe],xe=ne[oe];0===q&&(xe=.05*Z),te=e.length(fe)/W,ae=r.create(),e.copy(ae,fe),ae[3]=xe;for(var Se=0;Se<8;Se++)B[Se]=[ve[0],ve[1],ve[2],Se];if(ee.length>0)for(Se=0;Se<8;Se++){var pe=(Se+1)%8;V.push(ee[Se],B[Se],B[pe],B[pe],ee[pe],ee[Se]),U.push(ce,ae,ae,ae,ce,ce),K.push(J,te,te,te,J,J);var ge=V.length;N.push([ge-6,ge-5,ge-4],[ge-3,ge-2,ge-1])}var Te=ee;ee=B,B=Te;var se=ce;ce=ae,ae=se;var de=J;J=te,te=de}return{positions:V,cells:N,vectors:U,vertexIntensity:K}}(D,d,u,a)}),w=[],T=[],L=[],M=[];for(y=0;y<b.length;y++){var P=b[y],z=w.length;for(w=w.concat(P.positions),L=L.concat(P.vectors),M=M.concat(P.vertexIntensity),_=0;_<P.cells.length;_++){var S=P.cells[_],C=[];T.push(C);for(var R=0;R<S.length;R++)C.push(S[R]+z)}}return{positions:w,cells:T,vectors:L,vertexIntensity:M,colormap:o}}(T,l.colormap,Z,q);return y?ce.tubeScale=y:(0===Z&&(Z=1),ce.tubeScale=.5*a*q/Z),ce};var s=t("./lib/shaders"),f=t("gl-cone3d").createMesh;k.exports.createTubeMesh=function(l,o){return f(l,o,{shaders:s,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(t,k,x){var e=t("gl-shader"),r=t("glslify"),i=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),c=r(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),n=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),m=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);x.createShader=function(p){var s=e(p,i,c,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},x.createPickShader=function(p){var s=e(p,i,m,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},x.createContourShader=function(p){var s=e(p,n,c,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s},x.createPickContourShader=function(p){var s=e(p,n,m,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s}},{"gl-shader":132,glslify:231}],145:[function(t,k,x){"use strict";k.exports=function(N){var U=N.gl,ee=h(U),B=b(U),K=_(U),J=w(U),te=r(U),ae=i(U,[{buffer:te,size:4,stride:40,offset:0},{buffer:te,size:3,stride:40,offset:16},{buffer:te,size:3,stride:40,offset:28}]),ce=r(U),oe=i(U,[{buffer:ce,size:4,stride:20,offset:0},{buffer:ce,size:1,stride:20,offset:16}]),ve=r(U),fe=i(U,[{buffer:ve,size:2,type:U.FLOAT}]),xe=c(U,1,256,U.RGBA,U.UNSIGNED_BYTE);xe.minFilter=U.LINEAR,xe.magFilter=U.LINEAR;var Se=new z(U,[0,0],[[0,0,0],[0,0,0]],ee,B,te,ae,xe,K,J,ce,oe,ve,fe,[0,0,0]),pe={levels:[[],[],[]]};for(var ge in N)pe[ge]=N[ge];return pe.colormap=pe.colormap||"jet",Se.update(pe),Se};var e=t("bit-twiddle"),r=t("gl-buffer"),i=t("gl-vao"),c=t("gl-texture2d"),n=t("typedarray-pool"),m=t("colormap"),p=t("ndarray-ops"),s=t("ndarray-pack"),f=t("ndarray"),l=t("surface-nets"),o=t("gl-mat4/multiply"),d=t("gl-mat4/invert"),u=t("binary-search-bounds"),a=t("ndarray-gradient"),y=t("./lib/shaders"),h=y.createShader,_=y.createContourShader,b=y.createPickShader,w=y.createPickContourShader,T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],M=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function P(N,U,ee,B,K){this.position=N,this.index=U,this.uv=ee,this.level=B,this.dataCoordinate=K}function z(N,U,ee,B,K,J,te,ae,ce,oe,ve,fe,xe,Se,pe){this.gl=N,this.shape=U,this.bounds=ee,this.objectOffset=pe,this.intensityBounds=[],this._shader=B,this._pickShader=K,this._coordinateBuffer=J,this._vao=te,this._colorMap=ae,this._contourShader=ce,this._contourPickShader=oe,this._contourBuffer=ve,this._contourVAO=fe,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new P([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=xe,this._dynamicVAO=Se,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[f(n.mallocFloat(1024),[0,0]),f(n.mallocFloat(1024),[0,0]),f(n.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}!function(){for(var N=0;N<3;++N){var U=M[N],ee=(N+2)%3;U[(N+1)%3+0]=1,U[ee+3]=1,U[N+6]=1}}();var S=z.prototype;S.genColormap=function(N,U){var ee=!1,B=s([m({colormap:N,nshades:256,format:"rgba"}).map(function(K,J){var te=U?function(ae,ce){if(!ce||!ce.length)return 1;for(var oe=0;oe<ce.length;++oe){if(ce.length<2)return 1;if(ce[oe][0]===ae)return ce[oe][1];if(ce[oe][0]>ae&&oe>0){var ve=(ce[oe][0]-ae)/(ce[oe][0]-ce[oe-1][0]);return ce[oe][1]*(1-ve)+ve*ce[oe-1][1]}}return 1}(J/255,U):K[3];return te<1&&(ee=!0),[K[0],K[1],K[2],255*te]})]);return p.divseq(B,255),this.hasAlphaScale=ee,B},S.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},S.isOpaque=function(){return!this.isTransparent()},S.pickSlots=1,S.setPickBase=function(N){this.pickId=N};var C=[0,0,0],R={showSurface:!1,showContour:!1,projections:[T.slice(),T.slice(),T.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function D(N,U){var ee,B,K,J=U.axes&&U.axes.lastCubeProps.axis||C,te=U.showSurface,ae=U.showContour;for(ee=0;ee<3;++ee)for(te=te||U.surfaceProject[ee],B=0;B<3;++B)ae=ae||U.contourProject[ee][B];for(ee=0;ee<3;++ee){var ce=R.projections[ee];for(B=0;B<16;++B)ce[B]=0;for(B=0;B<4;++B)ce[5*B]=1;ce[5*ee]=0,ce[12+ee]=U.axesBounds[+(J[ee]>0)][ee],o(ce,N.model,ce);var oe=R.clipBounds[ee];for(K=0;K<2;++K)for(B=0;B<3;++B)oe[K][B]=N.clipBounds[K][B];oe[0][ee]=-1e8,oe[1][ee]=1e8}return R.showSurface=te,R.showContour=ae,R}var j={model:T,view:T,projection:T,inverseModel:T.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},q=T.slice(),Z=[1,0,0,0,1,0,0,0,1];function W(N,U){N=N||{};var ee=this.gl;ee.disable(ee.CULL_FACE),this._colorMap.bind(0);var B=j;B.model=N.model||T,B.view=N.view||T,B.projection=N.projection||T,B.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],B.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],B.objectOffset=this.objectOffset,B.contourColor=this.contourColor[0],B.inverseModel=d(B.inverseModel,B.model);for(var K=0;K<2;++K)for(var J=B.clipBounds[K],te=0;te<3;++te)J[te]=Math.min(Math.max(this.clipBounds[K][te],-1e8),1e8);B.kambient=this.ambientLight,B.kdiffuse=this.diffuseLight,B.kspecular=this.specularLight,B.roughness=this.roughness,B.fresnel=this.fresnel,B.opacity=this.opacity,B.height=0,B.permutation=Z,B.vertexColor=this.vertexColor;var ae=q;for(o(ae,B.view,B.model),o(ae,B.projection,ae),d(ae,ae),K=0;K<3;++K)B.eyePosition[K]=ae[12+K]/ae[15];var ce=ae[15];for(K=0;K<3;++K)ce+=this.lightPosition[K]*ae[4*K+3];for(K=0;K<3;++K){var oe=ae[12+K];for(te=0;te<3;++te)oe+=ae[4*te+K]*this.lightPosition[te];B.lightPosition[K]=oe/ce}var ve=D(B,this);if(ve.showSurface){for(this._shader.bind(),this._shader.uniforms=B,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(ee.TRIANGLES,this._vertexCount),K=0;K<3;++K)this.surfaceProject[K]&&this.vertexCount&&(this._shader.uniforms.model=ve.projections[K],this._shader.uniforms.clipBounds=ve.clipBounds[K],this._vao.draw(ee.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ve.showContour){var fe=this._contourShader;B.kambient=1,B.kdiffuse=0,B.kspecular=0,B.opacity=1,fe.bind(),fe.uniforms=B;var xe=this._contourVAO;for(xe.bind(),K=0;K<3;++K)for(fe.uniforms.permutation=M[K],ee.lineWidth(this.contourWidth[K]*this.pixelRatio),te=0;te<this.contourLevels[K].length;++te)te===this.highlightLevel[K]?(fe.uniforms.contourColor=this.highlightColor[K],fe.uniforms.contourTint=this.highlightTint[K]):0!==te&&te-1!==this.highlightLevel[K]||(fe.uniforms.contourColor=this.contourColor[K],fe.uniforms.contourTint=this.contourTint[K]),this._contourCounts[K][te]&&(fe.uniforms.height=this.contourLevels[K][te],xe.draw(ee.LINES,this._contourCounts[K][te],this._contourOffsets[K][te]));for(K=0;K<3;++K)for(fe.uniforms.model=ve.projections[K],fe.uniforms.clipBounds=ve.clipBounds[K],te=0;te<3;++te)if(this.contourProject[K][te]){fe.uniforms.permutation=M[te],ee.lineWidth(this.contourWidth[te]*this.pixelRatio);for(var Se=0;Se<this.contourLevels[te].length;++Se)Se===this.highlightLevel[te]?(fe.uniforms.contourColor=this.highlightColor[te],fe.uniforms.contourTint=this.highlightTint[te]):0!==Se&&Se-1!==this.highlightLevel[te]||(fe.uniforms.contourColor=this.contourColor[te],fe.uniforms.contourTint=this.contourTint[te]),this._contourCounts[te][Se]&&(fe.uniforms.height=this.contourLevels[te][Se],xe.draw(ee.LINES,this._contourCounts[te][Se],this._contourOffsets[te][Se]))}for(xe.unbind(),(xe=this._dynamicVAO).bind(),K=0;K<3;++K)if(0!==this._dynamicCounts[K])for(fe.uniforms.model=B.model,fe.uniforms.clipBounds=B.clipBounds,fe.uniforms.permutation=M[K],ee.lineWidth(this.dynamicWidth[K]*this.pixelRatio),fe.uniforms.contourColor=this.dynamicColor[K],fe.uniforms.contourTint=this.dynamicTint[K],fe.uniforms.height=this.dynamicLevel[K],xe.draw(ee.LINES,this._dynamicCounts[K],this._dynamicOffsets[K]),te=0;te<3;++te)this.contourProject[te][K]&&(fe.uniforms.model=ve.projections[te],fe.uniforms.clipBounds=ve.clipBounds[te],xe.draw(ee.LINES,this._dynamicCounts[K],this._dynamicOffsets[K]));xe.unbind()}}S.draw=function(N){return W.call(this,N,!1)},S.drawTransparent=function(N){return W.call(this,N,!0)};var G={model:T,view:T,projection:T,inverseModel:T,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function X(N,U){return Array.isArray(N)?[U(N[0]),U(N[1]),U(N[2])]:[U(N),U(N),U(N)]}function ne(N){return Array.isArray(N)?3===N.length?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function V(N){if(Array.isArray(N)){if(Array.isArray(N))return[ne(N[0]),ne(N[1]),ne(N[2])];var U=ne(N);return[U.slice(),U.slice(),U.slice()]}}S.drawPick=function(N){N=N||{};var U=this.gl;U.disable(U.CULL_FACE);var ee=G;ee.model=N.model||T,ee.view=N.view||T,ee.projection=N.projection||T,ee.shape=this._field[2].shape,ee.pickId=this.pickId/255,ee.lowerBound=this.bounds[0],ee.upperBound=this.bounds[1],ee.objectOffset=this.objectOffset,ee.permutation=Z;for(var B=0;B<2;++B)for(var K=ee.clipBounds[B],J=0;J<3;++J)K[J]=Math.min(Math.max(this.clipBounds[B][J],-1e8),1e8);var te=D(ee,this);if(te.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=ee,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),B=0;B<3;++B)this.surfaceProject[B]&&(this._pickShader.uniforms.model=te.projections[B],this._pickShader.uniforms.clipBounds=te.clipBounds[B],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(te.showContour){var ae=this._contourPickShader;ae.bind(),ae.uniforms=ee;var ce=this._contourVAO;for(ce.bind(),J=0;J<3;++J)for(U.lineWidth(this.contourWidth[J]*this.pixelRatio),ae.uniforms.permutation=M[J],B=0;B<this.contourLevels[J].length;++B)this._contourCounts[J][B]&&(ae.uniforms.height=this.contourLevels[J][B],ce.draw(U.LINES,this._contourCounts[J][B],this._contourOffsets[J][B]));for(B=0;B<3;++B)for(ae.uniforms.model=te.projections[B],ae.uniforms.clipBounds=te.clipBounds[B],J=0;J<3;++J)if(this.contourProject[B][J]){ae.uniforms.permutation=M[J],U.lineWidth(this.contourWidth[J]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[J].length;++oe)this._contourCounts[J][oe]&&(ae.uniforms.height=this.contourLevels[J][oe],ce.draw(U.LINES,this._contourCounts[J][oe],this._contourOffsets[J][oe]))}ce.unbind()}},S.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=this._field[2].shape,ee=this._pickResult,B=U[0]*(N.value[0]+(N.value[2]>>4)/16)/255,K=Math.floor(B),J=B-K,te=U[1]*(N.value[1]+(15&N.value[2])/16)/255,ae=Math.floor(te),ce=te-ae;K+=1,ae+=1;var oe=ee.position;oe[0]=oe[1]=oe[2]=0;for(var ve=0;ve<2;++ve)for(var fe=ve?J:1-J,xe=0;xe<2;++xe)for(var Se=K+ve,pe=ae+xe,ge=fe*(xe?ce:1-ce),Te=0;Te<3;++Te)oe[Te]+=this._field[Te].get(Se,pe)*ge;for(var se=this._pickResult.level,de=0;de<3;++de)if(se[de]=u.le(this.contourLevels[de],oe[de]),se[de]<0)this.contourLevels[de].length>0&&(se[de]=0);else if(se[de]<this.contourLevels[de].length-1){var Le=this.contourLevels[de][se[de]+1];Math.abs(this.contourLevels[de][se[de]]-oe[de])>Math.abs(Le-oe[de])&&(se[de]+=1)}for(ee.index[0]=J<.5?K:K+1,ee.index[1]=ce<.5?ae:ae+1,ee.uv[0]=B/U[0],ee.uv[1]=te/U[1],Te=0;Te<3;++Te)ee.dataCoordinate[Te]=this._field[Te].get(ee.index[0],ee.index[1]);return ee},S.padField=function(N,U){var ee=U.shape.slice(),B=N.shape.slice();p.assign(N.lo(1,1).hi(ee[0],ee[1]),U),p.assign(N.lo(1).hi(ee[0],1),U.hi(ee[0],1)),p.assign(N.lo(1,B[1]-1).hi(ee[0],1),U.lo(0,ee[1]-1).hi(ee[0],1)),p.assign(N.lo(0,1).hi(1,ee[1]),U.hi(1)),p.assign(N.lo(B[0]-1,1).hi(1,ee[1]),U.lo(ee[0]-1)),N.set(0,0,U.get(0,0)),N.set(0,B[1]-1,U.get(0,ee[1]-1)),N.set(B[0]-1,0,U.get(ee[0]-1,0)),N.set(B[0]-1,B[1]-1,U.get(ee[0]-1,ee[1]-1))},S.update=function(N){this.objectOffset=(N=N||{}).objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=X(N.contourWidth,Number)),"showContour"in N&&(this.showContour=X(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=X(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=V(N.contourColor)),"contourProject"in N&&(this.contourProject=X(N.contourProject,function(Kt){return X(Kt,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=V(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=X(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=X(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var U=N.field||N.coords&&N.coords[2]||null,ee=!1;if(U||(U=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in N||"coords"in N){var B=(U.shape[0]+2)*(U.shape[1]+2);B>this._field[2].data.length&&(n.freeFloat(this._field[2].data),this._field[2].data=n.mallocFloat(e.nextPow2(B))),this._field[2]=f(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var K=this.shape,J=0;J<2;++J)this._field[2].size>this._field[J].data.length&&(n.freeFloat(this._field[J].data),this._field[J].data=n.mallocFloat(this._field[2].size)),this._field[J]=f(this._field[J].data,[K[0]+2,K[1]+2]);if(N.coords){var te=N.coords;if(!Array.isArray(te)||3!==te.length)throw new Error("gl-surface: invalid coordinates for x/y");for(J=0;J<2;++J){var ae=te[J];for(xe=0;xe<2;++xe)if(ae.shape[xe]!==K[xe])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[J],ae)}}else if(N.ticks){var ce=N.ticks;if(!Array.isArray(ce)||2!==ce.length)throw new Error("gl-surface: invalid ticks");for(J=0;J<2;++J){var oe=ce[J];if((Array.isArray(oe)||oe.length)&&(oe=f(oe)),oe.shape[0]!==K[J])throw new Error("gl-surface: invalid tick length");var ve=f(oe.data,K);ve.stride[J]=oe.stride[0],ve.stride[1^J]=0,this.padField(this._field[J],ve)}}else{for(J=0;J<2;++J){var fe=[0,0];fe[J]=1,this._field[J]=f(this._field[J].data,[K[0]+2,K[1]+2],fe,0)}this._field[0].set(0,0,0);for(var xe=0;xe<K[0];++xe)this._field[0].set(xe+1,0,xe);for(this._field[0].set(K[0]+1,0,K[0]-1),this._field[1].set(0,0,0),xe=0;xe<K[1];++xe)this._field[1].set(0,xe+1,xe);this._field[1].set(0,K[1]+1,K[1]-1)}var Se=this._field,pe=f(n.mallocFloat(3*Se[2].size*2),[3,K[0]+2,K[1]+2,2]);for(J=0;J<3;++J)a(pe.pick(J),Se[J],"mirror");var ge=f(n.mallocFloat(3*Se[2].size),[K[0]+2,K[1]+2,3]);for(J=0;J<K[0]+2;++J)for(xe=0;xe<K[1]+2;++xe){var Te=pe.get(0,J,xe,0),se=pe.get(0,J,xe,1),de=pe.get(1,J,xe,0),Ae=pe.get(1,J,xe,1),Le=pe.get(2,J,xe,0),Me=pe.get(2,J,xe,1),De=de*Me-Ae*Le,Oe=Le*se-Me*Te,Ie=Te*Ae-se*de,Qe=Math.sqrt(De*De+Oe*Oe+Ie*Ie);Qe<1e-8?(Qe=Math.max(Math.abs(De),Math.abs(Oe),Math.abs(Ie)))<1e-8?(Ie=1,Oe=De=0,Qe=1):Qe=1/Qe:Qe=1/Math.sqrt(Qe),ge.set(J,xe,0,De*Qe),ge.set(J,xe,1,Oe*Qe),ge.set(J,xe,2,Ie*Qe)}n.free(pe.data);var Ne=[1/0,1/0,1/0],Pe=[-1/0,-1/0,-1/0],Re=1/0,Ge=-1/0,ct=n.mallocFloat(e.nextPow2((K[0]-1)*(K[1]-1)*6*10)),wt=0,kt=0;for(J=0;J<K[0]-1;++J)e:for(xe=0;xe<K[1]-1;++xe){for(var gt=0;gt<2;++gt)for(var at=0;at<2;++at)for(var et=0;et<3;++et){var yt=this._field[et].get(1+J+gt,1+xe+at);if(isNaN(yt)||!isFinite(yt))continue e}for(et=0;et<6;++et){var Vt=J+L[et][0],Gt=xe+L[et][1],en=this._field[0].get(Vt+1,Gt+1),Jt=this._field[1].get(Vt+1,Gt+1);yt=this._field[2].get(Vt+1,Gt+1),De=ge.get(Vt+1,Gt+1,0),Oe=ge.get(Vt+1,Gt+1,1),Ie=ge.get(Vt+1,Gt+1,2),N.intensity&&(cn=N.intensity.get(Vt,Gt));var cn=N.intensity?N.intensity.get(Vt,Gt):yt+this.objectOffset[2];ct[wt++]=Vt,ct[wt++]=Gt,ct[wt++]=en,ct[wt++]=Jt,ct[wt++]=yt,ct[wt++]=0,ct[wt++]=cn,ct[wt++]=De,ct[wt++]=Oe,ct[wt++]=Ie,Ne[0]=Math.min(Ne[0],en+this.objectOffset[0]),Ne[1]=Math.min(Ne[1],Jt+this.objectOffset[1]),Ne[2]=Math.min(Ne[2],yt+this.objectOffset[2]),Re=Math.min(Re,cn),Pe[0]=Math.max(Pe[0],en+this.objectOffset[0]),Pe[1]=Math.max(Pe[1],Jt+this.objectOffset[1]),Pe[2]=Math.max(Pe[2],yt+this.objectOffset[2]),Ge=Math.max(Ge,cn),kt+=1}}for(N.intensityBounds&&(Re=+N.intensityBounds[0],Ge=+N.intensityBounds[1]),J=6;J<wt;J+=10)ct[J]=(ct[J]-Re)/(Ge-Re);this._vertexCount=kt,this._coordinateBuffer.update(ct.subarray(0,wt)),n.freeFloat(ct),n.free(ge.data),this.bounds=[Ne,Pe],this.intensity=N.intensity||this._field[2],this.intensityBounds[0]===Re&&this.intensityBounds[1]===Ge||(ee=!0),this.intensityBounds=[Re,Ge]}if("levels"in N){var Rt=N.levels;for(Rt=Array.isArray(Rt[0])?Rt.slice():[[],[],Rt],J=0;J<3;++J)Rt[J]=Rt[J].slice(),Rt[J].sort(function(Kt,Zt){return Kt-Zt});for(J=0;J<3;++J)for(xe=0;xe<Rt[J].length;++xe)Rt[J][xe]-=this.objectOffset[J];e:for(J=0;J<3;++J){if(Rt[J].length!==this.contourLevels[J].length){ee=!0;break}for(xe=0;xe<Rt[J].length;++xe)if(Rt[J][xe]!==this.contourLevels[J][xe]){ee=!0;break e}}this.contourLevels=Rt}if(ee){Se=this._field,K=this.shape;for(var je=[],Ye=0;Ye<3;++Ye){var he=this.contourLevels[Ye],be=[],Fe=[],He=[0,0,0];for(J=0;J<he.length;++J){var Ke=l(this._field[Ye],he[J]);be.push(je.length/5|0),kt=0;e:for(xe=0;xe<Ke.cells.length;++xe){var Ze=Ke.cells[xe];for(et=0;et<2;++et){var ut=Ke.positions[Ze[et]],lt=ut[0],Lt=0|Math.floor(lt),Ot=lt-Lt,ot=ut[1],pt=0|Math.floor(ot),qt=ot-pt,St=!1;t:for(var Mt=0;Mt<3;++Mt){He[Mt]=0;var Ce=(Ye+Mt+1)%3;for(gt=0;gt<2;++gt){var Xe=gt?Ot:1-Ot;for(Vt=0|Math.min(Math.max(Lt+gt,0),K[0]),at=0;at<2;++at){var st=at?qt:1-qt;if(Gt=0|Math.min(Math.max(pt+at,0),K[1]),yt=Mt<2?this._field[Ce].get(Vt,Gt):(this.intensity.get(Vt,Gt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(yt)||isNaN(yt)){St=!0;break t}He[Mt]+=Xe*st*yt}}}if(St){if(et>0){for(var zt=0;zt<5;++zt)je.pop();kt-=1}continue e}je.push(He[0],He[1],ut[0],ut[1],He[2]),kt+=1}}Fe.push(kt)}this._contourOffsets[Ye]=be,this._contourCounts[Ye]=Fe}var Ht=n.mallocFloat(je.length);for(J=0;J<je.length;++J)Ht[J]=je[J];this._contourBuffer.update(Ht),n.freeFloat(Ht)}},S.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)n.freeFloat(this._field[N].data)},S.highlight=function(N){var U,ee;if(!N)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(U=0;U<3;++U)this.highlightLevel[U]=this.enableHighlight[U]?N.level[U]:-1;for(ee=this.snapToData?N.dataCoordinate:N.position,U=0;U<3;++U)ee[U]-=this.objectOffset[U];if(this.enableDynamic[0]&&ee[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&ee[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&ee[2]!==this.dynamicLevel[2]){for(var B=0,K=this.shape,J=n.mallocFloat(12*K[0]*K[1]),te=0;te<3;++te)if(this.enableDynamic[te]){this.dynamicLevel[te]=ee[te];var ve=this._field[(te+1)%3],fe=this._field[(te+2)%3],xe=l(this._field[te],ee[te]),Se=xe.cells,pe=xe.positions;for(this._dynamicOffsets[te]=B,U=0;U<Se.length;++U)for(var ge=Se[U],Te=0;Te<2;++Te){var se=pe[ge[Te]],de=+se[0],Ae=0|de,Le=0|Math.min(Ae+1,K[0]),Me=de-Ae,De=1-Me,Oe=+se[1],Ie=0|Oe,Qe=0|Math.min(Ie+1,K[1]),Ne=Oe-Ie,Pe=1-Ne,Re=De*Pe,Ge=De*Ne,tt=Me*Pe,ct=Me*Ne,wt=Re*ve.get(Ae,Ie)+Ge*ve.get(Ae,Qe)+tt*ve.get(Le,Ie)+ct*ve.get(Le,Qe),kt=Re*fe.get(Ae,Ie)+Ge*fe.get(Ae,Qe)+tt*fe.get(Le,Ie)+ct*fe.get(Le,Qe);if(isNaN(wt)||isNaN(kt)){Te&&(B-=1);break}J[2*B+0]=wt,J[2*B+1]=kt,B+=1}this._dynamicCounts[te]=B-this._dynamicOffsets[te]}else this.dynamicLevel[te]=NaN,this._dynamicCounts[te]=0;this._dynamicBuffer.update(J.subarray(0,2*B)),n.freeFloat(J)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(t,k,x){"use strict";var e=t("ndarray"),r=t("ndarray-ops"),i=t("typedarray-pool");k.exports=function(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(c||p(b),"number"==typeof arguments[1])return y(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return y(b,0|arguments[1][0],0|arguments[1][1],arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var w=arguments[1],T=s(w)?w:w.raw;if(T)return h(b,T,0|w.width,0|w.height,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(w.shape&&w.data&&w.stride)return _(b,w)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var c=null,n=null,m=null;function p(b){c=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],n=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],m=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function s(b){return"undefined"!=typeof HTMLCanvasElement&&b instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&b instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&b instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&b instanceof ImageData}var f=function(b,w){r.muls(b,w,255)};function l(b,w,T){var L=b.gl,M=L.getParameter(L.MAX_TEXTURE_SIZE);if(w<0||w>M||T<0||T>M)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[w,T],b.bind(),L.texImage2D(L.TEXTURE_2D,0,b.format,w,T,0,b.format,b.type,null),b._mipLevels=[0],b}function o(b,w,T,L,M,P){this.gl=b,this.handle=w,this.format=M,this.type=P,this._shape=[T,L],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var z=this,S=[this._wrapS,this._wrapT];Object.defineProperties(S,[{get:function(){return z._wrapS},set:function(R){return z.wrapS=R}},{get:function(){return z._wrapT},set:function(R){return z.wrapT=R}}]),this._wrapVector=S;var C=[this._shape[0],this._shape[1]];Object.defineProperties(C,[{get:function(){return z._shape[0]},set:function(R){return z.width=R}},{get:function(){return z._shape[1]},set:function(R){return z.height=R}}]),this._shapeVector=C}var d=o.prototype;function u(b,w){return 3===b.length?1===w[2]&&w[1]===b[0]*b[2]&&w[0]===b[2]:1===w[0]&&w[1]===b[0]}function a(b){var w=b.createTexture();return b.bindTexture(b.TEXTURE_2D,w),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),w}function y(b,w,T,L,M){var P=b.getParameter(b.MAX_TEXTURE_SIZE);if(w<0||w>P||T<0||T>P)throw new Error("gl-texture2d: Invalid texture shape");if(M===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var z=a(b);return b.texImage2D(b.TEXTURE_2D,0,L,w,T,0,L,M,null),new o(b,z,w,T,L,M)}function h(b,w,T,L,M,P){var z=a(b);return b.texImage2D(b.TEXTURE_2D,0,M,M,P,w),new o(b,z,T,L,M,P)}function _(b,w){var T=w.dtype,L=w.shape.slice(),M=b.getParameter(b.MAX_TEXTURE_SIZE);if(L[0]<0||L[0]>M||L[1]<0||L[1]>M)throw new Error("gl-texture2d: Invalid texture size");var P=u(L,w.stride.slice()),z=0;"float32"===T?z=b.FLOAT:"float64"===T?(z=b.FLOAT,P=!1,T="float32"):"uint8"===T?z=b.UNSIGNED_BYTE:(z=b.UNSIGNED_BYTE,P=!1,T="uint8");var S,C,R=0;if(2===L.length)R=b.LUMINANCE,w=e(w.data,L=[L[0],L[1],1],[w.stride[0],w.stride[1],1],w.offset);else{if(3!==L.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===L[2])R=b.ALPHA;else if(2===L[2])R=b.LUMINANCE_ALPHA;else if(3===L[2])R=b.RGB;else{if(4!==L[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");R=b.RGBA}}z!==b.FLOAT||b.getExtension("OES_texture_float")||(z=b.UNSIGNED_BYTE,P=!1);var D=w.size;if(P)S=0===w.offset&&w.data.length===D?w.data:w.data.subarray(w.offset,w.offset+D);else{var j=[L[2],L[2]*L[0],1];C=i.malloc(D,T);var q=e(C,L,j,0);"float32"!==T&&"float64"!==T||z!==b.UNSIGNED_BYTE?r.assign(q,w):f(q,w),S=C.subarray(0,D)}var Z=a(b);return b.texImage2D(b.TEXTURE_2D,0,R,L[0],L[1],0,R,z,S),P||i.free(C),new o(b,Z,L[0],L[1],R,z)}Object.defineProperties(d,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var w=this.gl;if(this.type===w.FLOAT&&c.indexOf(b)>=0&&(w.getExtension("OES_texture_float_linear")||(b=w.NEAREST)),n.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var w=this.gl;if(this.type===w.FLOAT&&c.indexOf(b)>=0&&(w.getExtension("OES_texture_float_linear")||(b=w.NEAREST)),n.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var w=this._anisoSamples;if(this._anisoSamples=0|Math.max(b,1),w!==this._anisoSamples){var T=this.gl.getExtension("EXT_texture_filter_anisotropic");T&&this.gl.texParameterf(this.gl.TEXTURE_2D,T.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),m.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),m.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),2!==b.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var w=0;w<2;++w)if(m.indexOf(b[w])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var T=this.gl;return this.bind(),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,this._wrapS),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(Array.isArray(b)){if(2!==b.length)throw new Error("gl-texture2d: Invalid texture shape")}else b=[0|b,0|b];return l(this,0|b[0],0|b[1]),[0|b[0],0|b[1]]}},width:{get:function(){return this._shape[0]},set:function(b){return l(this,b|=0,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return l(this,this._shape[0],b|=0),b}}}),d.bind=function(b){var w=this.gl;return void 0!==b&&w.activeTexture(w.TEXTURE0+(0|b)),w.bindTexture(w.TEXTURE_2D,this.handle),void 0!==b?0|b:w.getParameter(w.ACTIVE_TEXTURE)-w.TEXTURE0},d.dispose=function(){this.gl.deleteTexture(this.handle)},d.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),w=0;b>0;++w,b>>>=1)this._mipLevels.indexOf(w)<0&&this._mipLevels.push(w)},d.setPixels=function(b,w,T,L){var M=this.gl;this.bind(),Array.isArray(w)?(L=T,T=0|w[1],w=0|w[0]):(w=w||0,T=T||0),L=L||0;var P=s(b)?b:b.raw;if(P)this._mipLevels.indexOf(L)<0?(M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,this.type,P),this._mipLevels.push(L)):M.texSubImage2D(M.TEXTURE_2D,L,w,T,this.format,this.type,P);else{if(!(b.shape&&b.stride&&b.data))throw new Error("gl-texture2d: Unsupported data type");if(b.shape.length<2||w+b.shape[1]>this._shape[1]>>>L||T+b.shape[0]>this._shape[0]>>>L||w<0||T<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");!function(z,S,C,R,D,j,q,Z){var W=Z.dtype,G=Z.shape.slice();if(G.length<2||G.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var X=0,ne=0,V=u(G,Z.stride.slice());if("float32"===W?X=z.FLOAT:"float64"===W?(X=z.FLOAT,V=!1,W="float32"):"uint8"===W?X=z.UNSIGNED_BYTE:(X=z.UNSIGNED_BYTE,V=!1,W="uint8"),2===G.length)ne=z.LUMINANCE,Z=e(Z.data,G=[G[0],G[1],1],[Z.stride[0],Z.stride[1],1],Z.offset);else{if(3!==G.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===G[2])ne=z.ALPHA;else if(2===G[2])ne=z.LUMINANCE_ALPHA;else if(3===G[2])ne=z.RGB;else{if(4!==G[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");ne=z.RGBA}}if(ne!==z.LUMINANCE&&ne!==z.ALPHA||D!==z.LUMINANCE&&D!==z.ALPHA||(ne=D),ne!==D)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var N=Z.size,U=q.indexOf(R)<0;if(U&&q.push(R),X===j&&V)0===Z.offset&&Z.data.length===N?U?z.texImage2D(z.TEXTURE_2D,R,D,G[0],G[1],0,D,j,Z.data):z.texSubImage2D(z.TEXTURE_2D,R,S,C,G[0],G[1],D,j,Z.data):U?z.texImage2D(z.TEXTURE_2D,R,D,G[0],G[1],0,D,j,Z.data.subarray(Z.offset,Z.offset+N)):z.texSubImage2D(z.TEXTURE_2D,R,S,C,G[0],G[1],D,j,Z.data.subarray(Z.offset,Z.offset+N));else{var ee;ee=j===z.FLOAT?i.mallocFloat32(N):i.mallocUint8(N);var B=e(ee,G,[G[2],G[2]*G[0],1]);X===z.FLOAT&&j===z.UNSIGNED_BYTE?f(B,Z):r.assign(B,Z),U?z.texImage2D(z.TEXTURE_2D,R,D,G[0],G[1],0,D,j,ee.subarray(0,N)):z.texSubImage2D(z.TEXTURE_2D,R,S,C,G[0],G[1],D,j,ee.subarray(0,N)),j===z.FLOAT?i.freeFloat32(ee):i.freeUint8(ee)}}(M,w,T,L,this.format,this.type,this._mipLevels,b)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(t,k,x){"use strict";k.exports=function(e,r,i){r?r.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var c=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(i){if(i.length>c)throw new Error("gl-vao: Too many vertex attributes");for(var n=0;n<i.length;++n){var m=i[n];if(m.buffer){var s=m.size||4,f=m.type||e.FLOAT,l=!!m.normalized,o=m.stride||0,d=m.offset||0;m.buffer.bind(),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,s,f,l,o,d)}else{if("number"==typeof m)e.vertexAttrib1f(n,m);else if(1===m.length)e.vertexAttrib1f(n,m[0]);else if(2===m.length)e.vertexAttrib2f(n,m[0],m[1]);else if(3===m.length)e.vertexAttrib3f(n,m[0],m[1],m[2]);else{if(4!==m.length)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(n,m[0],m[1],m[2],m[3])}e.disableVertexAttribArray(n)}}for(;n<c;++n)e.disableVertexAttribArray(n)}else for(e.bindBuffer(e.ARRAY_BUFFER,null),n=0;n<c;++n)e.disableVertexAttribArray(n)}},{}],148:[function(t,k,x){"use strict";var e=t("./do-bind.js");function r(i){this.gl=i,this._elements=null,this._attributes=null,this._elementsType=i.UNSIGNED_SHORT}r.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},r.prototype.update=function(i,c,n){this._elements=c,this._attributes=i,this._elementsType=n||this.gl.UNSIGNED_SHORT},r.prototype.dispose=function(){},r.prototype.unbind=function(){},r.prototype.draw=function(i,c,n){n=n||0;var m=this.gl;this._elements?m.drawElements(i,c,this._elementsType,n):m.drawArrays(i,n,c)},k.exports=function(i){return new r(i)}},{"./do-bind.js":147}],149:[function(t,k,x){"use strict";var e=t("./do-bind.js");function r(c,n,m,p,s,f){this.location=c,this.dimension=n,this.a=m,this.b=p,this.c=s,this.d=f}function i(c,n,m){this.gl=c,this._ext=n,this.handle=m,this._attribs=[],this._useElements=!1,this._elementsType=c.UNSIGNED_SHORT}r.prototype.bind=function(c){switch(this.dimension){case 1:c.vertexAttrib1f(this.location,this.a);break;case 2:c.vertexAttrib2f(this.location,this.a,this.b);break;case 3:c.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:c.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var c=0;c<this._attribs.length;++c)this._attribs[c].bind(this.gl)},i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},i.prototype.update=function(c,n,m){if(this.bind(),e(this.gl,n,c),this.unbind(),this._attribs.length=0,c)for(var p=0;p<c.length;++p){var s=c[p];"number"==typeof s?this._attribs.push(new r(p,1,s)):Array.isArray(s)&&this._attribs.push(new r(p,s.length,s[0],s[1],s[2],s[3]))}this._useElements=!!n,this._elementsType=m||this.gl.UNSIGNED_SHORT},i.prototype.draw=function(c,n,m){m=m||0;var p=this.gl;this._useElements?p.drawElements(c,n,this._elementsType,m):p.drawArrays(c,m,n)},k.exports=function(c,n){return new i(c,n,n.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(t,k,x){"use strict";var e=t("./lib/vao-native.js"),r=t("./lib/vao-emulated.js");function i(c){this.bindVertexArrayOES=c.bindVertexArray.bind(c),this.createVertexArrayOES=c.createVertexArray.bind(c),this.deleteVertexArrayOES=c.deleteVertexArray.bind(c)}k.exports=function(c,n,m,p){var s,f=c.createVertexArray?new i(c):c.getExtension("OES_vertex_array_object");return(s=f?e(c,f):r(c)).update(n,m,p),s}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]+i[0],e[1]=r[1]+i[1],e[2]=r[2]+i[2],e}},{}],152:[function(t,k,x){k.exports=function(c,n){var m=e(c[0],c[1],c[2]),p=e(n[0],n[1],n[2]);r(m,m),r(p,p);var s=i(m,p);return s>1?0:Math.acos(s)};var e=t("./fromValues"),r=t("./normalize"),i=t("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(t,k,x){k.exports=function(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}},{}],154:[function(t,k,x){k.exports=function(e){var r=new Float32Array(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}},{}],155:[function(t,k,x){k.exports=function(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}},{}],156:[function(t,k,x){k.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],157:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=i[0],s=i[1],f=i[2];return e[0]=n*f-m*s,e[1]=m*p-c*f,e[2]=c*s-n*p,e}},{}],158:[function(t,k,x){k.exports=t("./distance")},{"./distance":159}],159:[function(t,k,x){k.exports=function(e,r){var i=r[0]-e[0],c=r[1]-e[1],n=r[2]-e[2];return Math.sqrt(i*i+c*c+n*n)}},{}],160:[function(t,k,x){k.exports=t("./divide")},{"./divide":161}],161:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]/i[0],e[1]=r[1]/i[1],e[2]=r[2]/i[2],e}},{}],162:[function(t,k,x){k.exports=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}},{}],163:[function(t,k,x){k.exports=1e-6},{}],164:[function(t,k,x){k.exports=function(r,i){var c=r[0],n=r[1],m=r[2],p=i[0],s=i[1],f=i[2];return Math.abs(c-p)<=e*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(n-s)<=e*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(m-f)<=e*Math.max(1,Math.abs(m),Math.abs(f))};var e=t("./epsilon")},{"./epsilon":163}],165:[function(t,k,x){k.exports=function(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}},{}],166:[function(t,k,x){k.exports=function(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}},{}],167:[function(t,k,x){k.exports=function(r,i,c,n,m,p){var s,f;for(i||(i=3),c||(c=0),f=n?Math.min(n*i+c,r.length):r.length,s=c;s<f;s+=i)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],m(e,e,p),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2];return r};var e=t("./create")()},{"./create":156}],168:[function(t,k,x){k.exports=function(e,r,i){var c=new Float32Array(3);return c[0]=e,c[1]=r,c[2]=i,c}},{}],169:[function(t,k,x){k.exports={EPSILON:t("./epsilon"),create:t("./create"),clone:t("./clone"),angle:t("./angle"),fromValues:t("./fromValues"),copy:t("./copy"),set:t("./set"),equals:t("./equals"),exactEquals:t("./exactEquals"),add:t("./add"),subtract:t("./subtract"),sub:t("./sub"),multiply:t("./multiply"),mul:t("./mul"),divide:t("./divide"),div:t("./div"),min:t("./min"),max:t("./max"),floor:t("./floor"),ceil:t("./ceil"),round:t("./round"),scale:t("./scale"),scaleAndAdd:t("./scaleAndAdd"),distance:t("./distance"),dist:t("./dist"),squaredDistance:t("./squaredDistance"),sqrDist:t("./sqrDist"),length:t("./length"),len:t("./len"),squaredLength:t("./squaredLength"),sqrLen:t("./sqrLen"),negate:t("./negate"),inverse:t("./inverse"),normalize:t("./normalize"),dot:t("./dot"),cross:t("./cross"),lerp:t("./lerp"),random:t("./random"),transformMat4:t("./transformMat4"),transformMat3:t("./transformMat3"),transformQuat:t("./transformQuat"),rotateX:t("./rotateX"),rotateY:t("./rotateY"),rotateZ:t("./rotateZ"),forEach:t("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(t,k,x){k.exports=function(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}},{}],171:[function(t,k,x){k.exports=t("./length")},{"./length":172}],172:[function(t,k,x){k.exports=function(e){var r=e[0],i=e[1],c=e[2];return Math.sqrt(r*r+i*i+c*c)}},{}],173:[function(t,k,x){k.exports=function(e,r,i,c){var n=r[0],m=r[1],p=r[2];return e[0]=n+c*(i[0]-n),e[1]=m+c*(i[1]-m),e[2]=p+c*(i[2]-p),e}},{}],174:[function(t,k,x){k.exports=function(e,r,i){return e[0]=Math.max(r[0],i[0]),e[1]=Math.max(r[1],i[1]),e[2]=Math.max(r[2],i[2]),e}},{}],175:[function(t,k,x){k.exports=function(e,r,i){return e[0]=Math.min(r[0],i[0]),e[1]=Math.min(r[1],i[1]),e[2]=Math.min(r[2],i[2]),e}},{}],176:[function(t,k,x){k.exports=t("./multiply")},{"./multiply":177}],177:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]*i[0],e[1]=r[1]*i[1],e[2]=r[2]*i[2],e}},{}],178:[function(t,k,x){k.exports=function(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}},{}],179:[function(t,k,x){k.exports=function(e,r){var i=r[0],c=r[1],n=r[2],m=i*i+c*c+n*n;return m>0&&(m=1/Math.sqrt(m),e[0]=r[0]*m,e[1]=r[1]*m,e[2]=r[2]*m),e}},{}],180:[function(t,k,x){k.exports=function(e,r){r=r||1;var i=2*Math.random()*Math.PI,c=2*Math.random()-1,n=Math.sqrt(1-c*c)*r;return e[0]=Math.cos(i)*n,e[1]=Math.sin(i)*n,e[2]=c*r,e}},{}],181:[function(t,k,x){k.exports=function(e,r,i,c){var n=i[1],m=i[2],p=r[1]-n,s=r[2]-m,f=Math.sin(c),l=Math.cos(c);return e[0]=r[0],e[1]=n+p*l-s*f,e[2]=m+p*f+s*l,e}},{}],182:[function(t,k,x){k.exports=function(e,r,i,c){var n=i[0],m=i[2],p=r[0]-n,s=r[2]-m,f=Math.sin(c),l=Math.cos(c);return e[0]=n+s*f+p*l,e[1]=r[1],e[2]=m+s*l-p*f,e}},{}],183:[function(t,k,x){k.exports=function(e,r,i,c){var n=i[0],m=i[1],p=r[0]-n,s=r[1]-m,f=Math.sin(c),l=Math.cos(c);return e[0]=n+p*l-s*f,e[1]=m+p*f+s*l,e[2]=r[2],e}},{}],184:[function(t,k,x){k.exports=function(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}},{}],185:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e}},{}],186:[function(t,k,x){k.exports=function(e,r,i,c){return e[0]=r[0]+i[0]*c,e[1]=r[1]+i[1]*c,e[2]=r[2]+i[2]*c,e}},{}],187:[function(t,k,x){k.exports=function(e,r,i,c){return e[0]=r,e[1]=i,e[2]=c,e}},{}],188:[function(t,k,x){k.exports=t("./squaredDistance")},{"./squaredDistance":190}],189:[function(t,k,x){k.exports=t("./squaredLength")},{"./squaredLength":191}],190:[function(t,k,x){k.exports=function(e,r){var i=r[0]-e[0],c=r[1]-e[1],n=r[2]-e[2];return i*i+c*c+n*n}},{}],191:[function(t,k,x){k.exports=function(e){var r=e[0],i=e[1],c=e[2];return r*r+i*i+c*c}},{}],192:[function(t,k,x){k.exports=t("./subtract")},{"./subtract":193}],193:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]-i[0],e[1]=r[1]-i[1],e[2]=r[2]-i[2],e}},{}],194:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2];return e[0]=c*i[0]+n*i[3]+m*i[6],e[1]=c*i[1]+n*i[4]+m*i[7],e[2]=c*i[2]+n*i[5]+m*i[8],e}},{}],195:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=i[3]*c+i[7]*n+i[11]*m+i[15];return e[0]=(i[0]*c+i[4]*n+i[8]*m+i[12])/(p=p||1),e[1]=(i[1]*c+i[5]*n+i[9]*m+i[13])/p,e[2]=(i[2]*c+i[6]*n+i[10]*m+i[14])/p,e}},{}],196:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=i[0],s=i[1],f=i[2],l=i[3],o=l*c+s*m-f*n,d=l*n+f*c-p*m,u=l*m+p*n-s*c,a=-p*c-s*n-f*m;return e[0]=o*l+a*-p+d*-f-u*-s,e[1]=d*l+a*-s+u*-p-o*-f,e[2]=u*l+a*-f+o*-s-d*-p,e}},{}],197:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]+i[0],e[1]=r[1]+i[1],e[2]=r[2]+i[2],e[3]=r[3]+i[3],e}},{}],198:[function(t,k,x){k.exports=function(e){var r=new Float32Array(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}},{}],199:[function(t,k,x){k.exports=function(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}},{}],200:[function(t,k,x){k.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],201:[function(t,k,x){k.exports=function(e,r){var i=r[0]-e[0],c=r[1]-e[1],n=r[2]-e[2],m=r[3]-e[3];return Math.sqrt(i*i+c*c+n*n+m*m)}},{}],202:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]/i[0],e[1]=r[1]/i[1],e[2]=r[2]/i[2],e[3]=r[3]/i[3],e}},{}],203:[function(t,k,x){k.exports=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}},{}],204:[function(t,k,x){k.exports=function(e,r,i,c){var n=new Float32Array(4);return n[0]=e,n[1]=r,n[2]=i,n[3]=c,n}},{}],205:[function(t,k,x){k.exports={create:t("./create"),clone:t("./clone"),fromValues:t("./fromValues"),copy:t("./copy"),set:t("./set"),add:t("./add"),subtract:t("./subtract"),multiply:t("./multiply"),divide:t("./divide"),min:t("./min"),max:t("./max"),scale:t("./scale"),scaleAndAdd:t("./scaleAndAdd"),distance:t("./distance"),squaredDistance:t("./squaredDistance"),length:t("./length"),squaredLength:t("./squaredLength"),negate:t("./negate"),inverse:t("./inverse"),normalize:t("./normalize"),dot:t("./dot"),lerp:t("./lerp"),random:t("./random"),transformMat4:t("./transformMat4"),transformQuat:t("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(t,k,x){k.exports=function(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}},{}],207:[function(t,k,x){k.exports=function(e){var r=e[0],i=e[1],c=e[2],n=e[3];return Math.sqrt(r*r+i*i+c*c+n*n)}},{}],208:[function(t,k,x){k.exports=function(e,r,i,c){var n=r[0],m=r[1],p=r[2],s=r[3];return e[0]=n+c*(i[0]-n),e[1]=m+c*(i[1]-m),e[2]=p+c*(i[2]-p),e[3]=s+c*(i[3]-s),e}},{}],209:[function(t,k,x){k.exports=function(e,r,i){return e[0]=Math.max(r[0],i[0]),e[1]=Math.max(r[1],i[1]),e[2]=Math.max(r[2],i[2]),e[3]=Math.max(r[3],i[3]),e}},{}],210:[function(t,k,x){k.exports=function(e,r,i){return e[0]=Math.min(r[0],i[0]),e[1]=Math.min(r[1],i[1]),e[2]=Math.min(r[2],i[2]),e[3]=Math.min(r[3],i[3]),e}},{}],211:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]*i[0],e[1]=r[1]*i[1],e[2]=r[2]*i[2],e[3]=r[3]*i[3],e}},{}],212:[function(t,k,x){k.exports=function(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}},{}],213:[function(t,k,x){k.exports=function(e,r){var i=r[0],c=r[1],n=r[2],m=r[3],p=i*i+c*c+n*n+m*m;return p>0&&(p=1/Math.sqrt(p),e[0]=i*p,e[1]=c*p,e[2]=n*p,e[3]=m*p),e}},{}],214:[function(t,k,x){var e=t("./normalize"),r=t("./scale");k.exports=function(i,c){return c=c||1,i[0]=Math.random(),i[1]=Math.random(),i[2]=Math.random(),i[3]=Math.random(),e(i,i),r(i,i,c),i}},{"./normalize":213,"./scale":215}],215:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=r[3]*i,e}},{}],216:[function(t,k,x){k.exports=function(e,r,i,c){return e[0]=r[0]+i[0]*c,e[1]=r[1]+i[1]*c,e[2]=r[2]+i[2]*c,e[3]=r[3]+i[3]*c,e}},{}],217:[function(t,k,x){k.exports=function(e,r,i,c,n){return e[0]=r,e[1]=i,e[2]=c,e[3]=n,e}},{}],218:[function(t,k,x){k.exports=function(e,r){var i=r[0]-e[0],c=r[1]-e[1],n=r[2]-e[2],m=r[3]-e[3];return i*i+c*c+n*n+m*m}},{}],219:[function(t,k,x){k.exports=function(e){var r=e[0],i=e[1],c=e[2],n=e[3];return r*r+i*i+c*c+n*n}},{}],220:[function(t,k,x){k.exports=function(e,r,i){return e[0]=r[0]-i[0],e[1]=r[1]-i[1],e[2]=r[2]-i[2],e[3]=r[3]-i[3],e}},{}],221:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=r[3];return e[0]=i[0]*c+i[4]*n+i[8]*m+i[12]*p,e[1]=i[1]*c+i[5]*n+i[9]*m+i[13]*p,e[2]=i[2]*c+i[6]*n+i[10]*m+i[14]*p,e[3]=i[3]*c+i[7]*n+i[11]*m+i[15]*p,e}},{}],222:[function(t,k,x){k.exports=function(e,r,i){var c=r[0],n=r[1],m=r[2],p=i[0],s=i[1],f=i[2],l=i[3],o=l*c+s*m-f*n,d=l*n+f*c-p*m,u=l*m+p*n-s*c,a=-p*c-s*n-f*m;return e[0]=o*l+a*-p+d*-f-u*-s,e[1]=d*l+a*-s+u*-p-o*-f,e[2]=u*l+a*-f+o*-s-d*-p,e[3]=r[3],e}},{}],223:[function(t,k,x){var e=t("glsl-tokenizer"),r=t("atob-lite");k.exports=function(i){for(var c=Array.isArray(i)?i:e(i),n=0;n<c.length;n++){var m=c[n];if("preprocessor"===m.type){var p=m.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(p&&p[2]){var f=p[2];return(p[1]?r(f):f).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(t,k,x){k.exports=function(p){var s,f,l,o=0,d=0,u=999,a=[],y=[],h=1,_=0,b=0,w=!1,T=!1,L="",M=i,P=e;"300 es"===(p=p||{}).version&&(M=n,P=c);var z={},S={};for(o=0;o<M.length;o++)z[M[o]]=!0;for(o=0;o<P.length;o++)S[P[o]]=!0;return function(N){return y=[],null!==N?function(U){var ee;for(o=0,U.toString&&(U=U.toString()),L+=U.replace(/\r\n/g,"\n"),l=L.length;s=L[o],o<l;){switch(ee=o,u){case 0:o="/"===s&&"*"===f?(a.push(s),C(a.join("")),u=999,o+1):(a.push(s),f=s,o+1);break;case 1:case 2:o="\r"!==s&&"\n"!==s||"\\"===f?(a.push(s),f=s,o+1):(C(a.join("")),u=999,o);break;case 3:o=Z();break;case 4:o="."===s||/[eE]/.test(s)?(a.push(s),u=5,f=s,o+1):"x"===s&&1===a.length&&"0"===a[0]?(u=11,a.push(s),f=s,o+1):/[^\d]/.test(s)?(C(a.join("")),u=999,o):(a.push(s),f=s,o+1);break;case 11:o=/[^a-fA-F0-9]/.test(s)?(C(a.join("")),u=999,o):(a.push(s),f=s,o+1);break;case 5:"f"===s&&(a.push(s),f=s,o+=1),o=/[eE]/.test(s)?(a.push(s),f=s,o+1):("-"!==s&&"+"!==s||!/[eE]/.test(f))&&/[^\d]/.test(s)?(C(a.join("")),u=999,o):(a.push(s),f=s,o+1);break;case 9999:o=V();break;case 9:o=/[^\s]/g.test(s)?(C(a.join("")),u=999,o):(a.push(s),f=s,o+1);break;case 999:a=a.length?[]:a,o="/"===f&&"*"===s?(b=d+o-1,u=0,f=s,o+1):"/"===f&&"/"===s?(b=d+o-1,u=1,f=s,o+1):"#"===s?(u=2,b=d+o,o):/\s/.test(s)?(u=9,b=d+o,o):(w=/\d/.test(s),T=/[^\w_]/.test(s),b=d+o,u=w?4:T?3:9999,o)}ee!==o&&("\n"===L[ee]?(_=0,++h):++_)}return d+=o,L=L.slice(o),y}(N):(a.length&&C(a.join("")),u=10,C("(eof)"),y)};function C(N){N.length&&y.push({type:m[u],data:N,position:b,line:h,column:_})}function Z(){if("."===f&&/\d/.test(s))return u=5,o;if("/"===f&&"*"===s)return u=0,o;if("/"===f&&"/"===s)return u=1,o;if("."===s&&a.length){for(;W(a););return u=5,o}if(";"===s||")"===s||"("===s){if(a.length)for(;W(a););return C(s),u=999,o+1}var N=2===a.length&&"="!==s;if(/[\w_\d\s]/.test(s)||N){for(;W(a););return u=999,o}return a.push(s),f=s,o+1}function W(N){for(var U,ee,B=0;;){if(U=r.indexOf(N.slice(0,N.length+B).join("")),ee=r[U],-1===U){if(B--+N.length>0)continue;ee=N.slice(0,1).join("")}return C(ee),b+=ee.length,(a=a.slice(ee.length)).length}}function V(){if(/[^\d\w_]/.test(s)){var N=a.join("");return u=S[N]?8:z[N]?7:6,C(a.join("")),u=999,o}return a.push(s),f=s,o+1}};var e=t("./lib/literals"),r=t("./lib/operators"),i=t("./lib/builtins"),c=t("./lib/literals-300es"),n=t("./lib/builtins-300es"),m=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(t,k,x){var e=t("./builtins");e=e.slice().filter(function(r){return!/^(gl\_|texture)/.test(r)}),k.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(t,k,x){k.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(t,k,x){var e=t("./literals");k.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(t,k,x){k.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(t,k,x){k.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(t,k,x){var e=t("./index");k.exports=function(r,i){var c=e(i),n=[];return(n=n.concat(c(r))).concat(c(null))}},{"./index":224}],231:[function(t,k,x){k.exports=function(e){"string"==typeof e&&(e=[e]);for(var r=[].slice.call(arguments,1),i=[],c=0;c<e.length-1;c++)i.push(e[c],r[c]||"");return i.push(e[c]),i.join("")}},{}],232:[function(t,k,x){"use strict";var e=t("is-browser");k.exports=e&&function(){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",null,i),window.removeEventListener("test",null,i)}catch(c){r=!1}return r}()},{"is-browser":236}],233:[function(t,k,x){"use strict";k.exports=function(f,l){var o=f.length;if(0===o)throw new Error("Must have at least d+1 points");var d=f[0].length;if(o<=d)throw new Error("Must input at least d+1 points");var u=f.slice(0,d+1),a=e.apply(void 0,u);if(0===a)throw new Error("Input not in general position");for(var y=new Array(d+1),h=0;h<=d;++h)y[h]=h;a<0&&(y[0]=1,y[1]=0);var _=new i(y,new Array(d+1),!1),b=_.adjacent,w=new Array(d+2);for(h=0;h<=d;++h){for(var T=y.slice(),L=0;L<=d;++L)L===h&&(T[L]=-1);var M=T[0];T[0]=T[1],T[1]=M;var P=new i(T,new Array(d+1),!0);b[h]=P,w[h]=P}for(w[d+1]=_,h=0;h<=d;++h){T=b[h].vertices;var z=b[h].adjacent;for(L=0;L<=d;++L){var S=T[L];if(S<0)z[L]=_;else for(var C=0;C<=d;++C)b[C].vertices.indexOf(S)<0&&(z[L]=b[C])}}var R=new p(d,u,w),D=!!l;for(h=d+1;h<o;++h)R.insert(f[h],D);return R.boundary()};var e=t("robust-orientation"),r=t("simplicial-complex").compareCells;function i(f,l,o){this.vertices=f,this.adjacent=l,this.boundary=o,this.lastVisited=-1}function c(f,l,o){this.vertices=f,this.cell=l,this.index=o}function n(f,l){return r(f.vertices,l.vertices)}i.prototype.flip=function(){var f=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=f;var l=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=l};var m=[];function p(f,l,o){this.dimension=f,this.vertices=l,this.simplices=o,this.interior=o.filter(function(y){return!y.boundary}),this.tuple=new Array(f+1);for(var d=0;d<=f;++d)this.tuple[d]=this.vertices[d];var u,y,a=m[f];a||(a=m[f]=((u=e[f+1])||(u=e),y=u,function(){return y.apply(this,this.tuple)})),this.orient=a}var s=p.prototype;s.handleBoundaryDegeneracy=function(f,l){var o=this.dimension,d=this.vertices.length-1,u=this.tuple,a=this.vertices,y=[f];for(f.lastVisited=-d;y.length>0;)for(var h=(f=y.pop()).adjacent,_=0;_<=o;++_){var b=h[_];if(b.boundary&&!(b.lastVisited<=-d)){for(var w=b.vertices,T=0;T<=o;++T){var L=w[T];u[T]=L<0?l:a[L]}var M=this.orient();if(M>0)return b;b.lastVisited=-d,0===M&&y.push(b)}}return null},s.walk=function(f,l){var o=this.vertices.length-1,d=this.dimension,u=this.vertices,a=this.tuple,y=l?this.interior.length*Math.random()|0:this.interior.length-1,h=this.interior[y];e:for(;!h.boundary;){for(var _=h.vertices,b=h.adjacent,w=0;w<=d;++w)a[w]=u[_[w]];for(h.lastVisited=o,w=0;w<=d;++w){var T=b[w];if(!(T.lastVisited>=o)){var L=a[w];a[w]=f;var M=this.orient();if(a[w]=L,M<0){h=T;continue e}T.lastVisited=T.boundary?-o:o}}return}return h},s.addPeaks=function(f,l){var o=this.vertices.length-1,d=this.dimension,u=this.vertices,a=this.tuple,y=this.interior,h=this.simplices,_=[l];l.lastVisited=o,l.vertices[l.vertices.indexOf(-1)]=o,l.boundary=!1,y.push(l);for(var b=[];_.length>0;){var w=(l=_.pop()).vertices,T=l.adjacent,L=w.indexOf(o);if(!(L<0))for(var M=0;M<=d;++M)if(M!==L){var P=T[M];if(P.boundary&&!(P.lastVisited>=o)){var z=P.vertices;if(P.lastVisited!==-o){for(var S=0,C=0;C<=d;++C)z[C]<0?(S=C,a[C]=f):a[C]=u[z[C]];if(this.orient()>0){z[S]=o,P.boundary=!1,y.push(P),_.push(P),P.lastVisited=o;continue}P.lastVisited=-o}var R=P.adjacent,D=w.slice(),j=T.slice(),q=new i(D,j,!0);h.push(q);var Z=R.indexOf(l);if(!(Z<0))for(R[Z]=q,j[L]=P,D[M]=-1,j[M]=l,T[M]=q,q.flip(),C=0;C<=d;++C){var W=D[C];if(!(W<0||W===o)){for(var G=new Array(d-1),X=0,ne=0;ne<=d;++ne){var V=D[ne];V<0||ne===C||(G[X++]=V)}b.push(new c(G,q,C))}}}}}for(b.sort(n),M=0;M+1<b.length;M+=2){var N=b[M],U=b[M+1];N.index<0||U.index<0||(N.cell.adjacent[N.index]=U.cell,U.cell.adjacent[U.index]=N.cell)}},s.insert=function(f,l){var o=this.vertices;o.push(f);var d=this.walk(f,l);if(d){for(var u=this.dimension,a=this.tuple,y=0;y<=u;++y){var h=d.vertices[y];a[y]=h<0?f:o[h]}var _=this.orient(a);_<0||(0!==_||(d=this.handleBoundaryDegeneracy(d,f)))&&this.addPeaks(f,d)}},s.boundary=function(){for(var f=this.dimension,l=[],o=this.simplices,d=o.length,u=0;u<d;++u){var a=o[u];if(a.boundary){for(var y=new Array(f),h=a.vertices,_=0,b=0,w=0;w<=f;++w)h[w]>=0?y[_++]=h[w]:b=1&w;if(b===(1&f)){var T=y[0];y[0]=y[1],y[1]=T}l.push(y)}}return l}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(t,k,x){"use strict";var e=t("binary-search-bounds");function r(_,b,w,T,L){this.mid=_,this.left=b,this.right=w,this.leftPoints=T,this.rightPoints=L,this.count=(b?b.count:0)+(w?w.count:0)+T.length}k.exports=function(_){return new y(_&&0!==_.length?a(_):null)};var i=r.prototype;function c(_,b){_.mid=b.mid,_.left=b.left,_.right=b.right,_.leftPoints=b.leftPoints,_.rightPoints=b.rightPoints,_.count=b.count}function n(_,b){var w=a(b);_.mid=w.mid,_.left=w.left,_.right=w.right,_.leftPoints=w.leftPoints,_.rightPoints=w.rightPoints,_.count=w.count}function m(_,b){var w=_.intervals([]);w.push(b),n(_,w)}function p(_,b){var w=_.intervals([]),T=w.indexOf(b);return T<0?0:(w.splice(T,1),n(_,w),1)}function s(_,b,w){for(var T=0;T<_.length&&_[T][0]<=b;++T){var L=w(_[T]);if(L)return L}}function f(_,b,w){for(var T=_.length-1;T>=0&&_[T][1]>=b;--T){var L=w(_[T]);if(L)return L}}function l(_,b){for(var w=0;w<_.length;++w){var T=b(_[w]);if(T)return T}}function o(_,b){return _-b}function d(_,b){return _[0]-b[0]||_[1]-b[1]}function u(_,b){return _[1]-b[1]||_[0]-b[0]}function a(_){if(0===_.length)return null;for(var b=[],w=0;w<_.length;++w)b.push(_[w][0],_[w][1]);b.sort(o);var T=b[b.length>>1],L=[],M=[],P=[];for(w=0;w<_.length;++w){var z=_[w];z[1]<T?L.push(z):T<z[0]?M.push(z):P.push(z)}var S=P,C=P.slice();return S.sort(d),C.sort(u),new r(T,a(L),a(M),S,C)}function y(_){this.root=_}i.intervals=function(_){return _.push.apply(_,this.leftPoints),this.left&&this.left.intervals(_),this.right&&this.right.intervals(_),_},i.insert=function(_){var b=this.count-this.leftPoints.length;if(this.count+=1,_[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?m(this,_):this.left.insert(_):this.left=a([_]);else if(_[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?m(this,_):this.right.insert(_):this.right=a([_]);else{var w=e.ge(this.leftPoints,_,d),T=e.ge(this.rightPoints,_,u);this.leftPoints.splice(w,0,_),this.rightPoints.splice(T,0,_)}},i.remove=function(_){var b=this.count-this.leftPoints;if(_[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(b-1)?p(this,_):2===(M=this.left.remove(_))?(this.left=null,this.count-=1,1):(1===M&&(this.count-=1),M):0;if(_[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(b-1)?p(this,_):2===(M=this.right.remove(_))?(this.right=null,this.count-=1,1):(1===M&&(this.count-=1),M):0;if(1===this.count)return this.leftPoints[0]===_?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===_){if(this.left&&this.right){for(var w=this,T=this.left;T.right;)w=T,T=T.right;if(w===this)T.right=this.right;else{var L=this.left,M=this.right;w.count-=T.count,w.right=T.left,T.left=L,T.right=M}c(this,T),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else c(this,this.left?this.left:this.right);return 1}for(L=e.ge(this.leftPoints,_,d);L<this.leftPoints.length&&this.leftPoints[L][0]===_[0];++L)if(this.leftPoints[L]===_)for(this.count-=1,this.leftPoints.splice(L,1),M=e.ge(this.rightPoints,_,u);M<this.rightPoints.length&&this.rightPoints[M][1]===_[1];++M)if(this.rightPoints[M]===_)return this.rightPoints.splice(M,1),1;return 0},i.queryPoint=function(_,b){return _<this.mid?this.left&&(w=this.left.queryPoint(_,b))?w:s(this.leftPoints,_,b):_>this.mid?this.right&&(w=this.right.queryPoint(_,b))?w:f(this.rightPoints,_,b):l(this.leftPoints,b);var w},i.queryInterval=function(_,b,w){var T;return _<this.mid&&this.left&&(T=this.left.queryInterval(_,b,w))||b>this.mid&&this.right&&(T=this.right.queryInterval(_,b,w))?T:b<this.mid?s(this.leftPoints,b,w):_>this.mid?f(this.rightPoints,_,w):l(this.leftPoints,w)};var h=y.prototype;h.insert=function(_){this.root?this.root.insert(_):this.root=new r(_[0],null,null,[_],[_])},h.remove=function(_){if(this.root){var b=this.root.remove(_);return 2===b&&(this.root=null),0!==b}return!1},h.queryPoint=function(_,b){if(this.root)return this.root.queryPoint(_,b)},h.queryInterval=function(_,b,w){if(_<=b&&this.root)return this.root.queryInterval(_,b,w)},Object.defineProperty(h,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(h,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(t,k,x){"use strict";k.exports=function(e){for(var r=new Array(e),i=0;i<e;++i)r[i]=i;return r}},{}],236:[function(t,k,x){k.exports=!0},{}],237:[function(t,k,x){function e(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}k.exports=function(r){return null!=r&&(e(r)||"function"==typeof(i=r).readFloatLE&&"function"==typeof i.slice&&e(i.slice(0,0))||!!r._isBuffer);var i}},{}],238:[function(t,k,x){"use strict";k.exports=i,k.exports.isMobile=i,k.exports.default=i;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function i(c){c||(c={});var n=c.ua;if(n||"undefined"==typeof navigator||(n=navigator.userAgent),n&&n.headers&&"string"==typeof n.headers["user-agent"]&&(n=n.headers["user-agent"]),"string"!=typeof n)return!1;var m=c.tablet?r.test(n):e.test(n);return!m&&c.tablet&&c.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==n.indexOf("Macintosh")&&-1!==n.indexOf("Safari")&&(m=!0),m}},{}],239:[function(t,k,x){"use strict";k.exports=function(e){for(var r,i=e.length,c=0;c<i;c++)if(((r=e.charCodeAt(c))<9||r>13)&&32!==r&&133!==r&&160!==r&&5760!==r&&6158!==r&&(r<8192||r>8205)&&8232!==r&&8233!==r&&8239!==r&&8287!==r&&8288!==r&&12288!==r&&65279!==r)return!1;return!0}},{}],240:[function(t,k,x){k.exports=function(e,r,i){return e*(1-i)+r*i}},{}],241:[function(t,k,x){var e=t("./normalize"),r=t("gl-mat4/create"),i=t("gl-mat4/clone"),c=t("gl-mat4/determinant"),n=t("gl-mat4/invert"),m=t("gl-mat4/transpose"),p={length:t("gl-vec3/length"),normalize:t("gl-vec3/normalize"),dot:t("gl-vec3/dot"),cross:t("gl-vec3/cross")},s=r(),f=r(),l=[0,0,0,0],o=[[0,0,0],[0,0,0],[0,0,0]],d=[0,0,0];function u(a,y,h,_,b){a[0]=y[0]*_+h[0]*b,a[1]=y[1]*_+h[1]*b,a[2]=y[2]*_+h[2]*b}k.exports=function(a,y,h,_,b,w){if(y||(y=[0,0,0]),h||(h=[0,0,0]),_||(_=[0,0,0]),b||(b=[0,0,0,1]),w||(w=[0,0,0,1]),!e(s,a)||(i(f,s),f[3]=0,f[7]=0,f[11]=0,f[15]=1,Math.abs(c(f)<1e-8)))return!1;var T,L,M,P,z,S,C,ne,V,R=s[3],D=s[7],j=s[11],q=s[12],Z=s[13],W=s[14],G=s[15];if(0!==R||0!==D||0!==j){if(l[0]=R,l[1]=D,l[2]=j,l[3]=G,!n(f,f))return!1;m(f,f),P=(L=l)[0],(T=b)[0]=(M=f)[0]*P+M[4]*(z=L[1])+M[8]*(S=L[2])+M[12]*(C=L[3]),T[1]=M[1]*P+M[5]*z+M[9]*S+M[13]*C,T[2]=M[2]*P+M[6]*z+M[10]*S+M[14]*C,T[3]=M[3]*P+M[7]*z+M[11]*S+M[15]*C}else b[0]=b[1]=b[2]=0,b[3]=1;if(y[0]=q,y[1]=Z,y[2]=W,(ne=o)[0][0]=(V=s)[0],ne[0][1]=V[1],ne[0][2]=V[2],ne[1][0]=V[4],ne[1][1]=V[5],ne[1][2]=V[6],ne[2][0]=V[8],ne[2][1]=V[9],ne[2][2]=V[10],h[0]=p.length(o[0]),p.normalize(o[0],o[0]),_[0]=p.dot(o[0],o[1]),u(o[1],o[1],o[0],1,-_[0]),h[1]=p.length(o[1]),p.normalize(o[1],o[1]),_[0]/=h[1],_[1]=p.dot(o[0],o[2]),u(o[2],o[2],o[0],1,-_[1]),_[2]=p.dot(o[1],o[2]),u(o[2],o[2],o[1],1,-_[2]),h[2]=p.length(o[2]),p.normalize(o[2],o[2]),_[1]/=h[2],_[2]/=h[2],p.cross(d,o[1],o[2]),p.dot(o[0],d)<0)for(var X=0;X<3;X++)h[X]*=-1,o[X][0]*=-1,o[X][1]*=-1,o[X][2]*=-1;return w[0]=.5*Math.sqrt(Math.max(1+o[0][0]-o[1][1]-o[2][2],0)),w[1]=.5*Math.sqrt(Math.max(1-o[0][0]+o[1][1]-o[2][2],0)),w[2]=.5*Math.sqrt(Math.max(1-o[0][0]-o[1][1]+o[2][2],0)),w[3]=.5*Math.sqrt(Math.max(1+o[0][0]+o[1][1]+o[2][2],0)),o[2][1]>o[1][2]&&(w[0]=-w[0]),o[0][2]>o[2][0]&&(w[1]=-w[1]),o[1][0]>o[0][1]&&(w[2]=-w[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(t,k,x){k.exports=function(e,r){var i=r[15];if(0===i)return!1;for(var c=1/i,n=0;n<16;n++)e[n]=r[n]*c;return!0}},{}],243:[function(t,k,x){var e=t("gl-vec3/lerp"),r=t("mat4-recompose"),i=t("mat4-decompose"),c=t("gl-mat4/determinant"),n=t("quat-slerp"),m=f(),p=f(),s=f();function f(){return{translate:l(),scale:l(1),skew:l(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function l(o){return[o||0,o||0,o||0]}k.exports=function(o,d,u,a){if(0===c(d)||0===c(u))return!1;var y=i(d,m.translate,m.scale,m.skew,m.perspective,m.quaternion),h=i(u,p.translate,p.scale,p.skew,p.perspective,p.quaternion);return!(!y||!h||(e(s.translate,m.translate,p.translate,a),e(s.skew,m.skew,p.skew,a),e(s.scale,m.scale,p.scale,a),e(s.perspective,m.perspective,p.perspective,a),n(s.quaternion,m.quaternion,p.quaternion,a),r(o,s.translate,s.scale,s.skew,s.perspective,s.quaternion),0))}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(t,k,x){var e={identity:t("gl-mat4/identity"),translate:t("gl-mat4/translate"),multiply:t("gl-mat4/multiply"),create:t("gl-mat4/create"),scale:t("gl-mat4/scale"),fromRotationTranslation:t("gl-mat4/fromRotationTranslation")},r=(e.create(),e.create());k.exports=function(i,c,n,m,p,s){return e.identity(i),e.fromRotationTranslation(i,s,c),i[3]=p[0],i[7]=p[1],i[11]=p[2],i[15]=p[3],e.identity(r),0!==m[2]&&(r[9]=m[2],e.multiply(i,i,r)),0!==m[1]&&(r[9]=0,r[8]=m[1],e.multiply(i,i,r)),0!==m[0]&&(r[8]=0,r[4]=m[0],e.multiply(i,i,r)),e.scale(i,i,n),i}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(t,k,x){"use strict";var e=t("binary-search-bounds"),r=t("mat4-interpolate"),i=t("gl-mat4/invert"),c=t("gl-mat4/rotateX"),n=t("gl-mat4/rotateY"),m=t("gl-mat4/rotateZ"),p=t("gl-mat4/lookAt"),s=t("gl-mat4/translate"),f=(t("gl-mat4/scale"),t("gl-vec3/normalize")),l=[0,0,0];function o(a){this._components=a.slice(),this._time=[0],this.prevMatrix=a.slice(),this.nextMatrix=a.slice(),this.computedMatrix=a.slice(),this.computedInverse=a.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}k.exports=function(a){return new o((a=a||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var d=o.prototype;d.recalcMatrix=function(a){var y=this._time,h=e.le(y,a),_=this.computedMatrix;if(!(h<0)){var b=this._components;if(h===y.length-1)for(var w=16*h,T=0;T<16;++T)_[T]=b[w++];else{var L=y[h+1]-y[h],M=(w=16*h,this.prevMatrix),P=!0;for(T=0;T<16;++T)M[T]=b[w++];var z=this.nextMatrix;for(T=0;T<16;++T)z[T]=b[w++],P=P&&M[T]===z[T];if(L<1e-6||P)for(T=0;T<16;++T)_[T]=M[T];else r(_,M,z,(a-y[h])/L)}var S=this.computedUp;S[0]=_[1],S[1]=_[5],S[2]=_[9],f(S,S);var C=this.computedInverse;i(C,_);var R=this.computedEye,D=C[15];R[0]=C[12]/D,R[1]=C[13]/D,R[2]=C[14]/D;var j=this.computedCenter,q=Math.exp(this.computedRadius[0]);for(T=0;T<3;++T)j[T]=R[T]-_[2+4*T]*q}},d.idle=function(a){if(!(a<this.lastT())){for(var y=this._components,h=y.length-16,_=0;_<16;++_)y.push(y[h++]);this._time.push(a)}},d.flush=function(a){var y=e.gt(this._time,a)-2;y<0||(this._time.splice(0,y),this._components.splice(0,16*y))},d.lastT=function(){return this._time[this._time.length-1]},d.lookAt=function(a,y,h,_){this.recalcMatrix(a),this.setMatrix(a,p(this.computedMatrix,y=y||this.computedEye,h=h||l,_=_||this.computedUp));for(var b=0,w=0;w<3;++w)b+=Math.pow(h[w]-y[w],2);b=Math.log(Math.sqrt(b)),this.computedRadius[0]=b},d.rotate=function(a,y,h,_){this.recalcMatrix(a);var b=this.computedInverse;y&&n(b,b,y),h&&c(b,b,h),_&&m(b,b,_),this.setMatrix(a,i(this.computedMatrix,b))};var u=[0,0,0];d.pan=function(a,y,h,_){u[0]=-(y||0),u[1]=-(h||0),u[2]=-(_||0),this.recalcMatrix(a);var b=this.computedInverse;s(b,b,u),this.setMatrix(a,i(b,b))},d.translate=function(a,y,h,_){u[0]=y||0,u[1]=h||0,u[2]=_||0,this.recalcMatrix(a);var b=this.computedMatrix;s(b,b,u),this.setMatrix(a,b)},d.setMatrix=function(a,y){if(!(a<this.lastT())){this._time.push(a);for(var h=0;h<16;++h)this._components.push(y[h])}},d.setDistance=function(a,y){this.computedRadius[0]=y},d.setDistanceLimits=function(a,y){var h=this._limits;h[0]=a,h[1]=y},d.getDistanceLimits=function(a){var y=this._limits;return a?(a[0]=y[0],a[1]=y[1],a):y}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(t,k,x){"use strict";k.exports=function(r){var i=r.length;if(i<3){for(var c=new Array(i),n=0;n<i;++n)c[n]=n;return 2===i&&r[0][0]===r[1][0]&&r[0][1]===r[1][1]?[0]:c}var m=new Array(i);for(n=0;n<i;++n)m[n]=n;m.sort(function(y,h){return r[y][0]-r[h][0]||r[y][1]-r[h][1]});var p=[m[0],m[1]],s=[m[0],m[1]];for(n=2;n<i;++n){for(var f=m[n],l=r[f],o=p.length;o>1&&e(r[p[o-2]],r[p[o-1]],l)<=0;)o-=1,p.pop();for(p.push(f),o=s.length;o>1&&e(r[s[o-2]],r[s[o-1]],l)>=0;)o-=1,s.pop();s.push(f)}c=new Array(s.length+p.length-2);for(var d=0,u=(n=0,p.length);n<u;++n)c[d++]=p[n];for(var a=s.length-2;a>0;--a)c[d++]=s[a];return c};var e=t("robust-orientation")[3]},{"robust-orientation":284}],247:[function(t,k,x){"use strict";k.exports=function(r,i){i||(i=r,r=window);var c=0,n=0,m=0,p={shift:!1,alt:!1,control:!1,meta:!1},s=!1;function f(w){var T=!1;return"altKey"in w&&(T=T||w.altKey!==p.alt,p.alt=!!w.altKey),"shiftKey"in w&&(T=T||w.shiftKey!==p.shift,p.shift=!!w.shiftKey),"ctrlKey"in w&&(T=T||w.ctrlKey!==p.control,p.control=!!w.ctrlKey),"metaKey"in w&&(T=T||w.metaKey!==p.meta,p.meta=!!w.metaKey),T}function l(w,T){var L=e.x(T),M=e.y(T);"buttons"in T&&(w=0|T.buttons),(w!==c||L!==n||M!==m||f(T))&&(c=0|w,n=L||0,m=M||0,i&&i(c,n,m,p))}function o(w){l(0,w)}function d(){(c||n||m||p.shift||p.alt||p.meta||p.control)&&(n=m=0,c=0,p.shift=p.alt=p.control=p.meta=!1,i&&i(0,0,0,p))}function u(w){f(w)&&i&&i(c,n,m,p)}function a(w){0===e.buttons(w)?l(0,w):l(c,w)}function y(w){l(c|e.buttons(w),w)}function h(w){l(c&~e.buttons(w),w)}function _(){s||(s=!0,r.addEventListener("mousemove",a),r.addEventListener("mousedown",y),r.addEventListener("mouseup",h),r.addEventListener("mouseleave",o),r.addEventListener("mouseenter",o),r.addEventListener("mouseout",o),r.addEventListener("mouseover",o),r.addEventListener("blur",d),r.addEventListener("keyup",u),r.addEventListener("keydown",u),r.addEventListener("keypress",u),r!==window&&(window.addEventListener("blur",d),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}_();var b={element:r};return Object.defineProperties(b,{enabled:{get:function(){return s},set:function(w){w?_():!s||(s=!1,r.removeEventListener("mousemove",a),r.removeEventListener("mousedown",y),r.removeEventListener("mouseup",h),r.removeEventListener("mouseleave",o),r.removeEventListener("mouseenter",o),r.removeEventListener("mouseout",o),r.removeEventListener("mouseover",o),r.removeEventListener("blur",d),r.removeEventListener("keyup",u),r.removeEventListener("keydown",u),r.removeEventListener("keypress",u),r!==window&&(window.removeEventListener("blur",d),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))},enumerable:!0},buttons:{get:function(){return c},enumerable:!0},x:{get:function(){return n},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return p},enumerable:!0}}),b};var e=t("mouse-event")},{"mouse-event":249}],248:[function(t,k,x){var e={left:0,top:0};k.exports=function(r,i,c){i=i||r.currentTarget||r.srcElement,Array.isArray(c)||(c=[0,0]);var s,n=r.clientX||0,m=r.clientY||0,p=(s=i)===window||s===document||s===document.body?e:s.getBoundingClientRect();return c[0]=n-p.left,c[1]=m-p.top,c}},{}],249:[function(t,k,x){"use strict";function e(r){return r.target||r.srcElement||window}x.buttons=function(r){if("object"==typeof r){if("buttons"in r)return r.buttons;if("which"in r){if(2===(i=r.which))return 4;if(3===i)return 2;if(i>0)return 1<<i-1}else if("button"in r){var i;if(1===(i=r.button))return 4;if(2===i)return 2;if(i>=0)return 1<<i}}return 0},x.element=e,x.x=function(r){if("object"==typeof r){if("offsetX"in r)return r.offsetX;var i=e(r).getBoundingClientRect();return r.clientX-i.left}return 0},x.y=function(r){if("object"==typeof r){if("offsetY"in r)return r.offsetY;var i=e(r).getBoundingClientRect();return r.clientY-i.top}return 0}},{}],250:[function(t,k,x){"use strict";var e=t("to-px");k.exports=function(r,i,c){"function"==typeof r&&(c=!!i,i=r,r=window);var n=e("ex",r),m=function(p){c&&p.preventDefault();var s=p.deltaX||0,f=p.deltaY||0,l=p.deltaZ||0,o=1;switch(p.deltaMode){case 1:o=n;break;case 2:o=window.innerHeight}if(f*=o,l*=o,(s*=o)||f||l)return i(s,f,l,p)};return r.addEventListener("wheel",m),m}},{"to-px":304}],251:[function(t,k,x){"use strict";var e=t("typedarray-pool");k.exports=function(i){function c(o){throw new Error("ndarray-extract-contour: "+o)}"object"!=typeof i&&c("Must specify arguments");var n=i.order;Array.isArray(n)||c("Must specify order");var o,d,u,_,m=i.arrayArguments||1;m<1&&c("Must have at least one array argument"),(i.scalarArguments||0)<0&&c("Scalar arg count must be > 0"),"function"!=typeof i.vertex&&c("Must specify vertex creation function"),"function"!=typeof i.cell&&c("Must specify cell creation function"),"function"!=typeof i.phase&&c("Must specify phase function");for(var s=i.getters||[],f=new Array(m),l=0;l<m;++l)f[l]=s.indexOf(l)>=0;return o=i.vertex,d=i.cell,u=i.phase,_=[f,n].join(","),(0,r[_])(o,d,u,e.mallocUint32,e.freeUint32)};var r={"false,0,1":function(i,c,n,m,p){return function(s,f,l,o){var d,u=0|s.shape[0],a=0|s.shape[1],y=s.data,_=0|s.stride[0],b=0|s.stride[1],w=0|s.offset,T=0|-_,L=0,M=0|-b,P=0,z=-_-b|0,S=0,C=0|_,R=b-_*u|0,D=0,j=0,q=0,Z=2*u|0,W=m(Z),G=m(Z),X=0,ne=0,V=-1,N=-1,U=0,ee=0|-u,B=0|u,K=0,J=-u-1|0,te=u-1|0,ae=0,ce=0,oe=0;for(D=0;D<u;++D)W[X++]=n(y[w],f,l,o),w+=C;if(w+=R,a>0){if(j=1,W[X++]=n(y[w],f,l,o),w+=C,u>0)for(D=1,ne=W[X]=n(d=y[w],f,l,o),K=W[X+ee],ae=W[X+J],ne===(U=W[X+V])&&ne===K&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,U,K,ae,f,l,o),ce=G[X]=q++),X+=1,w+=C,D=2;D<u;++D)ne=W[X]=n(d=y[w],f,l,o),K=W[X+ee],ae=W[X+J],ne===(U=W[X+V])&&ne===K&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,U,K,ae,f,l,o),ce=G[X]=q++,ae!==U&&c(G[X+V],ce,S,L,ae,U,f,l,o)),X+=1,w+=C;for(w+=R,X=0,oe=V,V=N,N=oe,oe=ee,ee=B,B=oe,oe=J,J=te,te=oe,j=2;j<a;++j){if(W[X++]=n(y[w],f,l,o),w+=C,u>0)for(D=1,ne=W[X]=n(d=y[w],f,l,o),K=W[X+ee],ae=W[X+J],ne===(U=W[X+V])&&ne===K&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,U,K,ae,f,l,o),ce=G[X]=q++,ae!==K&&c(G[X+ee],ce,P,S,K,ae,f,l,o)),X+=1,w+=C,D=2;D<u;++D)ne=W[X]=n(d=y[w],f,l,o),K=W[X+ee],ae=W[X+J],ne===(U=W[X+V])&&ne===K&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,U,K,ae,f,l,o),ce=G[X]=q++,ae!==K&&c(G[X+ee],ce,P,S,K,ae,f,l,o),ae!==U&&c(G[X+V],ce,S,L,ae,U,f,l,o)),X+=1,w+=C;1&j&&(X=0),oe=V,V=N,N=oe,oe=ee,ee=B,B=oe,oe=J,J=te,te=oe,w+=R}}p(G),p(W)}},"false,1,0":function(i,c,n,m,p){return function(s,f,l,o){var d,u=0|s.shape[0],a=0|s.shape[1],y=s.data,_=0|s.stride[0],b=0|s.stride[1],w=0|s.offset,T=0|-_,L=0,M=0|-b,P=0,z=-_-b|0,S=0,C=0|b,R=_-b*a|0,D=0,j=0,q=0,Z=2*a|0,W=m(Z),G=m(Z),X=0,ne=0,V=-1,N=-1,U=0,ee=0|-a,B=0|a,K=0,J=-a-1|0,te=a-1|0,ae=0,ce=0,oe=0;for(j=0;j<a;++j)W[X++]=n(y[w],f,l,o),w+=C;if(w+=R,u>0){if(D=1,W[X++]=n(y[w],f,l,o),w+=C,a>0)for(j=1,ne=W[X]=n(d=y[w],f,l,o),U=W[X+V],ae=W[X+J],ne===(K=W[X+ee])&&ne===U&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,K,U,ae,f,l,o),ce=G[X]=q++),X+=1,w+=C,j=2;j<a;++j)ne=W[X]=n(d=y[w],f,l,o),U=W[X+V],ae=W[X+J],ne===(K=W[X+ee])&&ne===U&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,K,U,ae,f,l,o),ce=G[X]=q++,ae!==U&&c(G[X+V],ce,P,S,U,ae,f,l,o)),X+=1,w+=C;for(w+=R,X=0,oe=ee,ee=B,B=oe,oe=V,V=N,N=oe,oe=J,J=te,te=oe,D=2;D<u;++D){if(W[X++]=n(y[w],f,l,o),w+=C,a>0)for(j=1,ne=W[X]=n(d=y[w],f,l,o),U=W[X+V],ae=W[X+J],ne===(K=W[X+ee])&&ne===U&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,K,U,ae,f,l,o),ce=G[X]=q++,ae!==K&&c(G[X+ee],ce,S,L,ae,K,f,l,o)),X+=1,w+=C,j=2;j<a;++j)ne=W[X]=n(d=y[w],f,l,o),U=W[X+V],ae=W[X+J],ne===(K=W[X+ee])&&ne===U&&ne===ae||(i(D,j,d,L=y[w+T],P=y[w+M],S=y[w+z],ne,K,U,ae,f,l,o),ce=G[X]=q++,ae!==U&&c(G[X+V],ce,P,S,U,ae,f,l,o),ae!==K&&c(G[X+ee],ce,S,L,ae,K,f,l,o)),X+=1,w+=C;1&D&&(X=0),oe=ee,ee=B,B=oe,oe=V,V=N,N=oe,oe=J,J=te,te=oe,w+=R}}p(G),p(W)}}}},{"typedarray-pool":308}],252:[function(t,k,x){"use strict";var e=t("dup"),r={zero:function(u,a,y,h){var _=u[0];h|=0;var b=0,w=y[0];for(b=0;b<_;++b)a[h]=0,h+=w},fdTemplate1:function(u,a,y,h,_,b,w){var T=u[0],L=y[0],M=-1*L,P=L;h|=0,w|=0;var z=0,S=L,C=b[0];for(z=0;z<T;++z)_[w]=.5*(a[h+M]-a[h+P]),h+=S,w+=C},fdTemplate2:function(u,a,y,h,_,b,w,T,L,M){var P=u[0],z=u[1],S=y[0],C=y[1],D=b[1],q=L[1],Z=-1*S,W=S,G=-1*C,X=C;h|=0,w|=0,M|=0;var ne=0,V=0,N=C,U=S-z*C,ee=D,B=b[0]-z*D,K=q,J=L[0]-z*q;for(V=0;V<P;++V){for(ne=0;ne<z;++ne)_[w]=.5*(a[h+Z]-a[h+W]),T[M]=.5*(a[h+G]-a[h+X]),h+=N,w+=ee,M+=K;h+=U,w+=B,M+=J}}},i={cdiff:function(u){var a={};return function(y,h,_){var b=y.dtype,w=y.order,T=h.dtype,L=h.order,M=_.dtype,P=_.order,z=[b,w.join(),T,L.join(),M,P.join()].join(),S=a[z];return S||(a[z]=S=u([b,w,T,L,M,P])),S(y.shape.slice(0),y.data,y.stride,0|y.offset,h.data,h.stride,0|h.offset,_.data,_.stride,0|_.offset)}},zero:function(u){var a={};return function(y){var h=y.dtype,_=y.order,b=[h,_.join()].join(),w=a[b];return w||(a[b]=w=u([h,_])),w(y.shape.slice(0),y.data,y.stride,0|y.offset)}},fdTemplate1:function(u){var a={};return function(y,h){var _=y.dtype,b=y.order,w=h.dtype,T=h.order,L=[_,b.join(),w,T.join()].join(),M=a[L];return M||(a[L]=M=u([_,b,w,T])),M(y.shape.slice(0),y.data,y.stride,0|y.offset,h.data,h.stride,0|h.offset)}},fdTemplate2:function(u){var a={};return function(y,h,_){var b=y.dtype,w=y.order,T=h.dtype,L=h.order,M=_.dtype,P=_.order,z=[b,w.join(),T,L.join(),M,P.join()].join(),S=a[z];return S||(a[z]=S=u([b,w,T,L,M,P])),S(y.shape.slice(0),y.data,y.stride,0|y.offset,h.data,h.stride,0|h.offset,_.data,_.stride,0|_.offset)}}};function c(u){return(0,i[u.funcName])(n.bind(void 0,u))}function n(u){return r[u.funcName]}function m(u){return c({funcName:u.funcName})}var p={},s={},f=m({funcName:"cdiff"}),l=m({funcName:"zero"});function o(u){return u in p?p[u]:p[u]=m({funcName:"fdTemplate"+u})}function d(u,a,y,h){return function(_,b){var w=b.shape.slice();return w[0]>2&&w[1]>2&&h(b.pick(-1,-1).lo(1,1).hi(w[0]-2,w[1]-2),_.pick(-1,-1,0).lo(1,1).hi(w[0]-2,w[1]-2),_.pick(-1,-1,1).lo(1,1).hi(w[0]-2,w[1]-2)),w[1]>2&&(y(b.pick(0,-1).lo(1).hi(w[1]-2),_.pick(0,-1,1).lo(1).hi(w[1]-2)),a(_.pick(0,-1,0).lo(1).hi(w[1]-2))),w[1]>2&&(y(b.pick(w[0]-1,-1).lo(1).hi(w[1]-2),_.pick(w[0]-1,-1,1).lo(1).hi(w[1]-2)),a(_.pick(w[0]-1,-1,0).lo(1).hi(w[1]-2))),w[0]>2&&(y(b.pick(-1,0).lo(1).hi(w[0]-2),_.pick(-1,0,0).lo(1).hi(w[0]-2)),a(_.pick(-1,0,1).lo(1).hi(w[0]-2))),w[0]>2&&(y(b.pick(-1,w[1]-1).lo(1).hi(w[0]-2),_.pick(-1,w[1]-1,0).lo(1).hi(w[0]-2)),a(_.pick(-1,w[1]-1,1).lo(1).hi(w[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(w[0]-1,0,0,0),_.set(w[0]-1,0,1,0),_.set(0,w[1]-1,0,0),_.set(0,w[1]-1,1,0),_.set(w[0]-1,w[1]-1,0,0),_.set(w[0]-1,w[1]-1,1,0),_}}k.exports=function(u,a,y){return Array.isArray(y)||(y=e(a.dimension,"string"==typeof y?y:"clamp")),0===a.size?u:0===a.dimension?(u.set(0),u):function(h){var _=h.join();if(L=s[_])return L;for(var b=h.length,w=[f,l],T=1;T<=b;++T)w.push(o(T));var L=d.apply(void 0,w);return s[_]=L,L}(y)(u,a)}},{dup:65}],253:[function(t,k,x){"use strict";function e(n,m){var p=Math.floor(m),s=m-p,l=0<=p+1&&p+1<n.shape[0];return(1-s)*(0<=p&&p<n.shape[0]?+n.get(p):0)+s*(l?+n.get(p+1):0)}function r(n,m,p){var s=Math.floor(m),f=m-s,l=0<=s&&s<n.shape[0],o=0<=s+1&&s+1<n.shape[0],d=Math.floor(p),u=p-d,a=0<=d&&d<n.shape[1],y=0<=d+1&&d+1<n.shape[1],h=l&&a?n.get(s,d):0,_=l&&y?n.get(s,d+1):0;return(1-u)*((1-f)*h+f*(o&&a?n.get(s+1,d):0))+u*((1-f)*_+f*(o&&y?n.get(s+1,d+1):0))}function i(n,m,p,s){var f=Math.floor(m),l=m-f,o=0<=f&&f<n.shape[0],d=0<=f+1&&f+1<n.shape[0],u=Math.floor(p),a=p-u,y=0<=u&&u<n.shape[1],h=0<=u+1&&u+1<n.shape[1],_=Math.floor(s),b=s-_,w=0<=_&&_<n.shape[2],T=0<=_+1&&_+1<n.shape[2],L=o&&y&&w?n.get(f,u,_):0,M=o&&h&&w?n.get(f,u+1,_):0,P=d&&y&&w?n.get(f+1,u,_):0,z=d&&h&&w?n.get(f+1,u+1,_):0,S=o&&y&&T?n.get(f,u,_+1):0,C=o&&h&&T?n.get(f,u+1,_+1):0;return(1-b)*((1-a)*((1-l)*L+l*P)+a*((1-l)*M+l*z))+b*((1-a)*((1-l)*S+l*(d&&y&&T?n.get(f+1,u,_+1):0))+a*((1-l)*C+l*(d&&h&&T?n.get(f+1,u+1,_+1):0)))}function c(n){var m,p,s=0|n.shape.length,f=new Array(s),l=new Array(s),o=new Array(s),d=new Array(s);for(m=0;m<s;++m)p=+arguments[m+1],f[m]=Math.floor(p),l[m]=p-f[m],o[m]=0<=f[m]&&f[m]<n.shape[m],d[m]=0<=f[m]+1&&f[m]+1<n.shape[m];var u,a,y,h=0;e:for(m=0;m<1<<s;++m){for(a=1,y=n.offset,u=0;u<s;++u)if(m&1<<u){if(!d[u])continue e;a*=l[u],y+=n.stride[u]*(f[u]+1)}else{if(!o[u])continue e;a*=1-l[u],y+=n.stride[u]*f[u]}h+=a*n.data[y]}return h}k.exports=function(n,m,p,s){switch(n.shape.length){case 0:return 0;case 1:return e(n,m);case 2:return r(n,m,p);case 3:return i(n,m,p,s);default:return c.apply(void 0,arguments)}},k.exports.d1=e,k.exports.d2=r,k.exports.d3=i},{}],254:[function(t,k,x){"use strict";var e={"float64,2,1,0":function(){return function(m,p,s,f,l){var o=m[0],d=m[1],u=m[2],y=s[1],h=s[2];f|=0;var _=0,b=0,w=0,T=h,L=y-u*h,M=s[0]-d*y;for(w=0;w<o;++w){for(b=0;b<d;++b){for(_=0;_<u;++_)p[f]/=l,f+=T;f+=L}f+=M}}},"uint8,2,0,1,float64,2,1,0":function(){return function(m,p,s,f,l,o,d,u){for(var a=m[0],y=m[1],h=m[2],_=s[0],b=s[1],w=s[2],T=o[0],L=o[1],M=o[2],P=f|=0,z=d|=0,S=0|m[0];S>0;){S<64?(a=S,S=0):(a=64,S-=64);for(var C=0|m[1];C>0;){C<64?(y=C,C=0):(y=64,C-=64),f=P+S*_+C*b,d=z+S*T+C*L;var R=0,D=0,j=0,q=w,Z=_-h*w,W=b-a*_,G=M,X=T-h*M,ne=L-a*T;for(j=0;j<y;++j){for(D=0;D<a;++D){for(R=0;R<h;++R)p[f]=l[d]*u,f+=q,d+=G;f+=Z,d+=X}f+=W,d+=ne}}}}},"float32,1,0,float32,1,0":function(){return function(m,p,s,f,l,o,d){var u=m[0],a=m[1],h=s[1],b=o[1];f|=0,d|=0;var w=0,T=0,L=h,M=s[0]-a*h,P=b,z=o[0]-a*b;for(T=0;T<u;++T){for(w=0;w<a;++w)p[f]=l[d],f+=L,d+=P;f+=M,d+=z}}},"float32,1,0,float32,0,1":function(){return function(m,p,s,f,l,o,d){for(var u=m[0],a=m[1],y=s[0],h=s[1],_=o[0],b=o[1],w=f|=0,T=d|=0,L=0|m[1];L>0;){L<64?(a=L,L=0):(a=64,L-=64);for(var M=0|m[0];M>0;){M<64?(u=M,M=0):(u=64,M-=64),f=w+L*h+M*y,d=T+L*b+M*_;var P=0,z=0,S=h,C=y-a*h,R=b,D=_-a*b;for(z=0;z<u;++z){for(P=0;P<a;++P)p[f]=l[d],f+=S,d+=R;f+=C,d+=D}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(m,p,s,f,l,o,d){for(var u=m[0],a=m[1],y=m[2],h=s[0],_=s[1],b=s[2],w=o[0],T=o[1],L=o[2],M=f|=0,P=d|=0,z=0|m[2];z>0;){z<64?(y=z,z=0):(y=64,z-=64);for(var S=0|m[0];S>0;){S<64?(u=S,S=0):(u=64,S-=64);for(var C=0|m[1];C>0;){C<64?(a=C,C=0):(a=64,C-=64),f=M+z*b+S*h+C*_,d=P+z*L+S*w+C*T;var R=0,D=0,j=0,q=b,Z=h-y*b,W=_-u*h,G=L,X=w-y*L,ne=T-u*w;for(j=0;j<a;++j){for(D=0;D<u;++D){for(R=0;R<y;++R)p[f]=l[d],f+=q,d+=G;f+=Z,d+=X}f+=W,d+=ne}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(m,p,s,f,l,o,d){var u=m[0],a=m[1],y=m[2],h=s[0],b=s[2],w=o[0],L=o[2];f|=0,d|=0;var M=0,P=0,z=0,S=b,C=h-y*b,R=s[1]-u*h,D=L,j=w-y*L,q=o[1]-u*w;for(z=0;z<a;++z){for(P=0;P<u;++P){for(M=0;M<y;++M)p[f]=l[d],f+=S,d+=D;f+=C,d+=j}f+=R,d+=q}}}},r=function(m,p){var s=p.join(",");return(0,e[s])()},i={mul:function(m){var p={};return function(s,f,l){var o=s.dtype,d=s.order,u=f.dtype,a=f.order,y=l.dtype,h=l.order,_=[o,d.join(),u,a.join(),y,h.join()].join(),b=p[_];return b||(p[_]=b=m([o,d,u,a,y,h])),b(s.shape.slice(0),s.data,s.stride,0|s.offset,f.data,f.stride,0|f.offset,l.data,l.stride,0|l.offset)}},muls:function(m){var p={};return function(s,f,l){var o=s.dtype,d=s.order,u=f.dtype,a=f.order,y=[o,d.join(),u,a.join()].join(),h=p[y];return h||(p[y]=h=m([o,d,u,a])),h(s.shape.slice(0),s.data,s.stride,0|s.offset,f.data,f.stride,0|f.offset,l)}},mulseq:function(m){var p={};return function(s,f){var l=s.dtype,o=s.order,d=[l,o.join()].join(),u=p[d];return u||(p[d]=u=m([l,o])),u(s.shape.slice(0),s.data,s.stride,0|s.offset,f)}},div:function(m){var p={};return function(s,f,l){var o=s.dtype,d=s.order,u=f.dtype,a=f.order,y=l.dtype,h=l.order,_=[o,d.join(),u,a.join(),y,h.join()].join(),b=p[_];return b||(p[_]=b=m([o,d,u,a,y,h])),b(s.shape.slice(0),s.data,s.stride,0|s.offset,f.data,f.stride,0|f.offset,l.data,l.stride,0|l.offset)}},divs:function(m){var p={};return function(s,f,l){var o=s.dtype,d=s.order,u=f.dtype,a=f.order,y=[o,d.join(),u,a.join()].join(),h=p[y];return h||(p[y]=h=m([o,d,u,a])),h(s.shape.slice(0),s.data,s.stride,0|s.offset,f.data,f.stride,0|f.offset,l)}},divseq:function(m){var p={};return function(s,f){var l=s.dtype,o=s.order,d=[l,o.join()].join(),u=p[d];return u||(p[d]=u=m([l,o])),u(s.shape.slice(0),s.data,s.stride,0|s.offset,f)}},assign:function(m){var p={};return function(s,f){var l=s.dtype,o=s.order,d=f.dtype,u=f.order,a=[l,o.join(),d,u.join()].join(),y=p[a];return y||(p[a]=y=m([l,o,d,u])),y(s.shape.slice(0),s.data,s.stride,0|s.offset,f.data,f.stride,0|f.offset)}}};function c(m){return(0,i[(p={funcName:m.funcName}).funcName])(r.bind(void 0,p));var p}var n={mul:"*",div:"/"};(function(){for(var m in n)x[m]=c({funcName:m}),x[m+"s"]=c({funcName:m+"s"}),x[m+"seq"]=c({funcName:m+"seq"})})(),x.assign=c({funcName:"assign"})},{}],255:[function(t,k,x){"use strict";var e=t("ndarray"),r=t("./doConvert.js");k.exports=function(i,c){for(var n=[],m=i,p=1;Array.isArray(m);)n.push(m.length),p*=m.length,m=m[0];return 0===n.length?e():(c||(c=e(new Float64Array(p),n)),r(c,i),c)}},{"./doConvert.js":256,ndarray:259}],256:[function(t,k,x){"use strict";var i,c;k.exports=(i=function(){return function(i,c,n,m,p){var s=i[0],f=i[1],l=i[2],d=n[1],u=n[2],a=[0,0,0];m|=0;var y=0,h=0,_=0,b=u,w=d-l*u,T=n[0]-f*d;for(_=0;_<s;++_){for(h=0;h<f;++h){for(y=0;y<l;++y){var L,M=p;for(L=0;L<a.length-1;++L)M=M[a[L]];c[m]=M[a[a.length-1]],m+=b,++a[2]}m+=w,a[2]-=l,++a[1]}m+=T,a[1]-=f,++a[0]}}}.bind(void 0,{funcName:"convert"}),c={},function(n,m){var p=n.dtype,s=n.order,f=[p,s.join()].join(),l=c[f];return l||(c[f]=l=i([p,s])),l(n.shape.slice(0),n.data,n.stride,0|n.offset,m)})},{}],257:[function(t,k,x){"use strict";var e=t("typedarray-pool");function r(m){return"uint32"===m?[e.mallocUint32,e.freeUint32]:null}var i={"uint32,1,0":function(m,p){return function(s,f,l,o,d,u,a,y,h,_,b){var w,T,L,M,P,z,S,C,R=s*d+o,D=m(y);for(w=s+1;w<=f;++w){for(T=w,L=R+=d,P=0,z=R,M=0;M<y;++M)D[P++]=l[z],z+=h;e:for(;T-- >s;){P=0,z=L-d;t:for(M=0;M<y;++M){if((S=l[z])<(C=D[P]))break e;if(S>C)break t;z+=_,P+=b}for(P=L,z=L-d,M=0;M<y;++M)l[P]=l[z],P+=h,z+=h;L-=d}for(P=L,z=0,M=0;M<y;++M)l[P]=D[z++],P+=h}p(D)}}},c={"uint32,1,0":function(m,p,s){return function f(l,o,d,u,a,y,h,_,b,w,T){var L,M,z,S,C,R,D,j,q,Z,W,G,X,ne,V,N,U,ee,B,K,J,te,ae,ce,oe=(o-l+1)/6|0,ve=l+oe,fe=o-oe,xe=l+o>>1,Se=xe-oe,pe=xe+oe,ge=ve,Te=Se,se=xe,de=pe,Ae=fe,Le=l+1,Me=o-1,De=!0,Oe=0,Ie=0,Qe=0,Ne=_,Pe=p(Ne),Re=p(Ne);Z=a*ge,W=a*Te,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=ge,ge=Te,Te=M;break e}if(Qe<0)break e;ce+=w}Z=a*de,W=a*Ae,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=de,de=Ae,Ae=M;break e}if(Qe<0)break e;ce+=w}Z=a*ge,W=a*se,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=ge,ge=se,se=M;break e}if(Qe<0)break e;ce+=w}Z=a*Te,W=a*se,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=Te,Te=se,se=M;break e}if(Qe<0)break e;ce+=w}Z=a*ge,W=a*de,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=ge,ge=de,de=M;break e}if(Qe<0)break e;ce+=w}Z=a*se,W=a*de,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=se,se=de,de=M;break e}if(Qe<0)break e;ce+=w}Z=a*Te,W=a*Ae,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=Te,Te=Ae,Ae=M;break e}if(Qe<0)break e;ce+=w}Z=a*Te,W=a*se,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=Te,Te=se,se=M;break e}if(Qe<0)break e;ce+=w}Z=a*de,W=a*Ae,ce=u;e:for(q=0;q<_;++q){if((Qe=d[R=Z+ce]-d[D=W+ce])>0){M=de,de=Ae,Ae=M;break e}if(Qe<0)break e;ce+=w}for(Z=a*ge,W=a*Te,G=a*se,X=a*de,ne=a*Ae,V=a*ve,N=a*xe,U=a*fe,ae=0,ce=u,q=0;q<_;++q)R=Z+ce,j=G+ce,ee=X+ce,B=ne+ce,K=V+ce,J=N+ce,te=U+ce,Pe[ae]=d[D=W+ce],Re[ae]=d[ee],De=De&&Pe[ae]===Re[ae],z=d[j],S=d[B],d[K]=d[R],d[J]=z,d[te]=S,++ae,ce+=b;for(Z=a*Se,W=a*l,ce=u,q=0;q<_;++q)d[R=Z+ce]=d[D=W+ce],ce+=b;for(Z=a*pe,W=a*o,ce=u,q=0;q<_;++q)d[R=Z+ce]=d[D=W+ce],ce+=b;if(De)for(C=Le;C<=Me;++C){for(R=u+C*a,ae=0,q=0;q<_&&0==(Qe=d[R]-Pe[ae]);++q)ae+=T,R+=w;if(0!==Qe)if(Qe<0){if(C!==Le)for(Z=a*C,W=a*Le,ce=u,q=0;q<_;++q)L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=L,ce+=b;++Le}else for(;;){for(R=u+Me*a,ae=0,q=0;q<_&&0==(Qe=d[R]-Pe[ae]);++q)ae+=T,R+=w;if(!(Qe>0)){if(Qe<0){for(Z=a*C,W=a*Le,G=a*Me,ce=u,q=0;q<_;++q)j=G+ce,L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=d[j],d[j]=L,ce+=b;++Le,--Me;break}for(Z=a*C,W=a*Me,ce=u,q=0;q<_;++q)L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=L,ce+=b;--Me;break}Me--}}else for(C=Le;C<=Me;++C){for(R=u+C*a,ae=0,q=0;q<_&&0==(Oe=d[R]-Pe[ae]);++q)ae+=T,R+=w;if(Oe<0){if(C!==Le)for(Z=a*C,W=a*Le,ce=u,q=0;q<_;++q)L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=L,ce+=b;++Le}else{for(R=u+C*a,ae=0,q=0;q<_&&0==(Ie=d[R]-Re[ae]);++q)ae+=T,R+=w;if(Ie>0)for(;;){for(R=u+Me*a,ae=0,q=0;q<_&&0==(Qe=d[R]-Re[ae]);++q)ae+=T,R+=w;if(!(Qe>0)){for(R=u+Me*a,ae=0,q=0;q<_&&0==(Qe=d[R]-Pe[ae]);++q)ae+=T,R+=w;if(Qe<0){for(Z=a*C,W=a*Le,G=a*Me,ce=u,q=0;q<_;++q)j=G+ce,L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=d[j],d[j]=L,ce+=b;++Le,--Me}else{for(Z=a*C,W=a*Me,ce=u,q=0;q<_;++q)L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=L,ce+=b;--Me}break}if(--Me<C)break}}}for(Z=a*l,W=a*(Le-1),ae=0,ce=u,q=0;q<_;++q)d[R=Z+ce]=d[D=W+ce],d[D]=Pe[ae],++ae,ce+=b;for(Z=a*o,W=a*(Me+1),ae=0,ce=u,q=0;q<_;++q)d[R=Z+ce]=d[D=W+ce],d[D]=Re[ae],++ae,ce+=b;if(Le-2-l<=32?m(l,Le-2,d,u,a,y,h,_,b,w,T):f(l,Le-2,d,u,a,y,h,_,b,w,T),o-(Me+2)<=32?m(Me+2,o,d,u,a,y,h,_,b,w,T):f(Me+2,o,d,u,a,y,h,_,b,w,T),De)return s(Pe),void s(Re);if(Le<ve&&Me>fe){e:for(;;){for(R=u+Le*a,ae=0,ce=u,q=0;q<_;++q){if(d[R]!==Pe[ae])break e;++ae,R+=b}++Le}e:for(;;){for(R=u+Me*a,ae=0,ce=u,q=0;q<_;++q){if(d[R]!==Re[ae])break e;++ae,R+=b}--Me}for(C=Le;C<=Me;++C){for(R=u+C*a,ae=0,q=0;q<_&&0==(Oe=d[R]-Pe[ae]);++q)ae+=T,R+=w;if(0===Oe){if(C!==Le)for(Z=a*C,W=a*Le,ce=u,q=0;q<_;++q)L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=L,ce+=b;++Le}else{for(R=u+C*a,ae=0,q=0;q<_&&0==(Ie=d[R]-Re[ae]);++q)ae+=T,R+=w;if(0===Ie)for(;;){for(R=u+Me*a,ae=0,q=0;q<_&&0==(Qe=d[R]-Re[ae]);++q)ae+=T,R+=w;if(0!==Qe){for(R=u+Me*a,ae=0,q=0;q<_&&0==(Qe=d[R]-Pe[ae]);++q)ae+=T,R+=w;if(Qe<0){for(Z=a*C,W=a*Le,G=a*Me,ce=u,q=0;q<_;++q)j=G+ce,L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=d[j],d[j]=L,ce+=b;++Le,--Me}else{for(Z=a*C,W=a*Me,ce=u,q=0;q<_;++q)L=d[R=Z+ce],d[R]=d[D=W+ce],d[D]=L,ce+=b;--Me}break}if(--Me<C)break}}}}s(Pe),s(Re),Me-Le<=32?m(Le,Me,d,u,a,y,h,_,b,w,T):f(Le,Me,d,u,a,y,h,_,b,w,T)}}},n={"uint32,1,0":function(m,p){return function(s){var f=s.data,l=0|s.offset,o=s.shape,d=s.stride,u=0|d[0],a=0|o[0],y=0|d[1],h=0|o[1],_=y,b=y;a<=32?m(0,a-1,f,l,u,y,a,h,_,b,1):p(0,a-1,f,l,u,y,a,h,_,b,1)}}};k.exports=function(m,p){var d,u,a,y,h,s=[p,m].join(","),f=n[s],l=(d=m,a=r(u=p),y=[u,d].join(","),h=i[y],a?h(a[0],a[1]):h()),o=function(d,u,a){var y=r(u),h=[u,d].join(","),_=c[h];return d.length>1&&y?_(a,y[0],y[1]):_(a)}(m,p,l);return f(l,o)}},{"typedarray-pool":308}],258:[function(t,k,x){"use strict";var e=t("./lib/compile_sort.js"),r={};k.exports=function(i){var c=i.order,n=i.dtype,m=[c,n].join(":"),p=r[m];return p||(r[m]=p=e(c,n)),p(i),i}},{"./lib/compile_sort.js":257}],259:[function(t,k,x){var e=t("is-buffer"),r="undefined"!=typeof Float64Array;function i(s,f){return s[0]-f[0]}function c(){var s,f=this.stride,l=new Array(f.length);for(s=0;s<l.length;++s)l[s]=[Math.abs(f[s]),s];l.sort(i);var o=new Array(l.length);for(s=0;s<o.length;++s)o[s]=l[s][1];return o}var n={T:function(s){function f(o){this.data=o}var l=f.prototype;return l.dtype=s,l.index=function(){return-1},l.size=0,l.dimension=-1,l.shape=l.stride=l.order=[],l.lo=l.hi=l.transpose=l.step=function(){return new f(this.data)},l.get=l.set=function(){},l.pick=function(){return null},function(o){return new f(o)}},0:function(s,f){function l(d,u){this.data=d,this.offset=u}var o=l.prototype;return o.dtype=s,o.index=function(){return this.offset},o.dimension=0,o.size=1,o.shape=o.stride=o.order=[],o.lo=o.hi=o.transpose=o.step=function(){return new l(this.data,this.offset)},o.pick=function(){return f(this.data)},o.valueOf=o.get=function(){return"generic"===s?this.data.get(this.offset):this.data[this.offset]},o.set=function(d){return"generic"===s?this.data.set(this.offset,d):this.data[this.offset]=d},function(d,u,a,y){return new l(d,y)}},1:function(s,f,l){function o(u,a,y,h){this.data=u,this.shape=[a],this.stride=[y],this.offset=0|h}var d=o.prototype;return d.dtype=s,d.dimension=1,Object.defineProperty(d,"size",{get:function(){return this.shape[0]}}),d.order=[0],d.set=function(u,a){return"generic"===s?this.data.set(this.offset+this.stride[0]*u,a):this.data[this.offset+this.stride[0]*u]=a},d.get=function(u){return"generic"===s?this.data.get(this.offset+this.stride[0]*u):this.data[this.offset+this.stride[0]*u]},d.index=function(u){return this.offset+this.stride[0]*u},d.hi=function(u){return new o(this.data,"number"!=typeof u||u<0?this.shape[0]:0|u,this.stride[0],this.offset)},d.lo=function(u){var a=this.offset,y=0,h=this.shape[0],_=this.stride[0];return"number"==typeof u&&u>=0&&(a+=_*(y=0|u),h-=y),new o(this.data,h,_,a)},d.step=function(u){var a=this.shape[0],y=this.stride[0],h=this.offset,_=0,b=Math.ceil;return"number"==typeof u&&((_=0|u)<0?(h+=y*(a-1),a=b(-a/_)):a=b(a/_),y*=_),new o(this.data,a,y,h)},d.transpose=function(u){return new o(this.data,this.shape[u=void 0===u?0:0|u],this.stride[u],this.offset)},d.pick=function(u){var a=[],y=[],h=this.offset;return"number"==typeof u&&u>=0?h=h+this.stride[0]*u|0:(a.push(this.shape[0]),y.push(this.stride[0])),(0,f[a.length+1])(this.data,a,y,h)},function(u,a,y,h){return new o(u,a[0],y[0],h)}},2:function(s,f,l){function o(u,a,y,h,_,b){this.data=u,this.shape=[a,y],this.stride=[h,_],this.offset=0|b}var d=o.prototype;return d.dtype=s,d.dimension=2,Object.defineProperty(d,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(d,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),d.set=function(u,a,y){return"generic"===s?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*a,y):this.data[this.offset+this.stride[0]*u+this.stride[1]*a]=y},d.get=function(u,a){return"generic"===s?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*a):this.data[this.offset+this.stride[0]*u+this.stride[1]*a]},d.index=function(u,a){return this.offset+this.stride[0]*u+this.stride[1]*a},d.hi=function(u,a){return new o(this.data,"number"!=typeof u||u<0?this.shape[0]:0|u,"number"!=typeof a||a<0?this.shape[1]:0|a,this.stride[0],this.stride[1],this.offset)},d.lo=function(u,a){var y=this.offset,h=0,_=this.shape[0],b=this.shape[1],w=this.stride[0],T=this.stride[1];return"number"==typeof u&&u>=0&&(y+=w*(h=0|u),_-=h),"number"==typeof a&&a>=0&&(y+=T*(h=0|a),b-=h),new o(this.data,_,b,w,T,y)},d.step=function(u,a){var y=this.shape[0],h=this.shape[1],_=this.stride[0],b=this.stride[1],w=this.offset,T=0,L=Math.ceil;return"number"==typeof u&&((T=0|u)<0?(w+=_*(y-1),y=L(-y/T)):y=L(y/T),_*=T),"number"==typeof a&&((T=0|a)<0?(w+=b*(h-1),h=L(-h/T)):h=L(h/T),b*=T),new o(this.data,y,h,_,b,w)},d.transpose=function(u,a){var y=this.shape,h=this.stride;return new o(this.data,y[u=void 0===u?0:0|u],y[a=void 0===a?1:0|a],h[u],h[a],this.offset)},d.pick=function(u,a){var y=[],h=[],_=this.offset;return"number"==typeof u&&u>=0?_=_+this.stride[0]*u|0:(y.push(this.shape[0]),h.push(this.stride[0])),"number"==typeof a&&a>=0?_=_+this.stride[1]*a|0:(y.push(this.shape[1]),h.push(this.stride[1])),(0,f[y.length+1])(this.data,y,h,_)},function(u,a,y,h){return new o(u,a[0],a[1],y[0],y[1],h)}},3:function(s,f,l){function o(u,a,y,h,_,b,w,T){this.data=u,this.shape=[a,y,h],this.stride=[_,b,w],this.offset=0|T}var d=o.prototype;return d.dtype=s,d.dimension=3,Object.defineProperty(d,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(d,"order",{get:function(){var u=Math.abs(this.stride[0]),a=Math.abs(this.stride[1]),y=Math.abs(this.stride[2]);return u>a?a>y?[2,1,0]:u>y?[1,2,0]:[1,0,2]:u>y?[2,0,1]:y>a?[0,1,2]:[0,2,1]}}),d.set=function(u,a,y,h){return"generic"===s?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y,h):this.data[this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y]=h},d.get=function(u,a,y){return"generic"===s?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y):this.data[this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y]},d.index=function(u,a,y){return this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y},d.hi=function(u,a,y){return new o(this.data,"number"!=typeof u||u<0?this.shape[0]:0|u,"number"!=typeof a||a<0?this.shape[1]:0|a,"number"!=typeof y||y<0?this.shape[2]:0|y,this.stride[0],this.stride[1],this.stride[2],this.offset)},d.lo=function(u,a,y){var h=this.offset,_=0,b=this.shape[0],w=this.shape[1],T=this.shape[2],L=this.stride[0],M=this.stride[1],P=this.stride[2];return"number"==typeof u&&u>=0&&(h+=L*(_=0|u),b-=_),"number"==typeof a&&a>=0&&(h+=M*(_=0|a),w-=_),"number"==typeof y&&y>=0&&(h+=P*(_=0|y),T-=_),new o(this.data,b,w,T,L,M,P,h)},d.step=function(u,a,y){var h=this.shape[0],_=this.shape[1],b=this.shape[2],w=this.stride[0],T=this.stride[1],L=this.stride[2],M=this.offset,P=0,z=Math.ceil;return"number"==typeof u&&((P=0|u)<0?(M+=w*(h-1),h=z(-h/P)):h=z(h/P),w*=P),"number"==typeof a&&((P=0|a)<0?(M+=T*(_-1),_=z(-_/P)):_=z(_/P),T*=P),"number"==typeof y&&((P=0|y)<0?(M+=L*(b-1),b=z(-b/P)):b=z(b/P),L*=P),new o(this.data,h,_,b,w,T,L,M)},d.transpose=function(u,a,y){var h=this.shape,_=this.stride;return new o(this.data,h[u=void 0===u?0:0|u],h[a=void 0===a?1:0|a],h[y=void 0===y?2:0|y],_[u],_[a],_[y],this.offset)},d.pick=function(u,a,y){var h=[],_=[],b=this.offset;return"number"==typeof u&&u>=0?b=b+this.stride[0]*u|0:(h.push(this.shape[0]),_.push(this.stride[0])),"number"==typeof a&&a>=0?b=b+this.stride[1]*a|0:(h.push(this.shape[1]),_.push(this.stride[1])),"number"==typeof y&&y>=0?b=b+this.stride[2]*y|0:(h.push(this.shape[2]),_.push(this.stride[2])),(0,f[h.length+1])(this.data,h,_,b)},function(u,a,y,h){return new o(u,a[0],a[1],a[2],y[0],y[1],y[2],h)}},4:function(s,f,l){function o(u,a,y,h,_,b,w,T,L,M){this.data=u,this.shape=[a,y,h,_],this.stride=[b,w,T,L],this.offset=0|M}var d=o.prototype;return d.dtype=s,d.dimension=4,Object.defineProperty(d,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(d,"order",{get:l}),d.set=function(u,a,y,h,_){return"generic"===s?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h,_):this.data[this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h]=_},d.get=function(u,a,y,h){return"generic"===s?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h):this.data[this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h]},d.index=function(u,a,y,h){return this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h},d.hi=function(u,a,y,h){return new o(this.data,"number"!=typeof u||u<0?this.shape[0]:0|u,"number"!=typeof a||a<0?this.shape[1]:0|a,"number"!=typeof y||y<0?this.shape[2]:0|y,"number"!=typeof h||h<0?this.shape[3]:0|h,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},d.lo=function(u,a,y,h){var _=this.offset,b=0,w=this.shape[0],T=this.shape[1],L=this.shape[2],M=this.shape[3],P=this.stride[0],z=this.stride[1],S=this.stride[2],C=this.stride[3];return"number"==typeof u&&u>=0&&(_+=P*(b=0|u),w-=b),"number"==typeof a&&a>=0&&(_+=z*(b=0|a),T-=b),"number"==typeof y&&y>=0&&(_+=S*(b=0|y),L-=b),"number"==typeof h&&h>=0&&(_+=C*(b=0|h),M-=b),new o(this.data,w,T,L,M,P,z,S,C,_)},d.step=function(u,a,y,h){var _=this.shape[0],b=this.shape[1],w=this.shape[2],T=this.shape[3],L=this.stride[0],M=this.stride[1],P=this.stride[2],z=this.stride[3],S=this.offset,C=0,R=Math.ceil;return"number"==typeof u&&((C=0|u)<0?(S+=L*(_-1),_=R(-_/C)):_=R(_/C),L*=C),"number"==typeof a&&((C=0|a)<0?(S+=M*(b-1),b=R(-b/C)):b=R(b/C),M*=C),"number"==typeof y&&((C=0|y)<0?(S+=P*(w-1),w=R(-w/C)):w=R(w/C),P*=C),"number"==typeof h&&((C=0|h)<0?(S+=z*(T-1),T=R(-T/C)):T=R(T/C),z*=C),new o(this.data,_,b,w,T,L,M,P,z,S)},d.transpose=function(u,a,y,h){var _=this.shape,b=this.stride;return new o(this.data,_[u=void 0===u?0:0|u],_[a=void 0===a?1:0|a],_[y=void 0===y?2:0|y],_[h=void 0===h?3:0|h],b[u],b[a],b[y],b[h],this.offset)},d.pick=function(u,a,y,h){var _=[],b=[],w=this.offset;return"number"==typeof u&&u>=0?w=w+this.stride[0]*u|0:(_.push(this.shape[0]),b.push(this.stride[0])),"number"==typeof a&&a>=0?w=w+this.stride[1]*a|0:(_.push(this.shape[1]),b.push(this.stride[1])),"number"==typeof y&&y>=0?w=w+this.stride[2]*y|0:(_.push(this.shape[2]),b.push(this.stride[2])),"number"==typeof h&&h>=0?w=w+this.stride[3]*h|0:(_.push(this.shape[3]),b.push(this.stride[3])),(0,f[_.length+1])(this.data,_,b,w)},function(u,a,y,h){return new o(u,a[0],a[1],a[2],a[3],y[0],y[1],y[2],y[3],h)}},5:function(s,f,l){function o(u,a,y,h,_,b,w,T,L,M,P,z){this.data=u,this.shape=[a,y,h,_,b],this.stride=[w,T,L,M,P],this.offset=0|z}var d=o.prototype;return d.dtype=s,d.dimension=5,Object.defineProperty(d,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(d,"order",{get:l}),d.set=function(u,a,y,h,_,b){return"generic"===s?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h+this.stride[4]*_,b):this.data[this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h+this.stride[4]*_]=b},d.get=function(u,a,y,h,_){return"generic"===s?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h+this.stride[4]*_):this.data[this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h+this.stride[4]*_]},d.index=function(u,a,y,h,_){return this.offset+this.stride[0]*u+this.stride[1]*a+this.stride[2]*y+this.stride[3]*h+this.stride[4]*_},d.hi=function(u,a,y,h,_){return new o(this.data,"number"!=typeof u||u<0?this.shape[0]:0|u,"number"!=typeof a||a<0?this.shape[1]:0|a,"number"!=typeof y||y<0?this.shape[2]:0|y,"number"!=typeof h||h<0?this.shape[3]:0|h,"number"!=typeof _||_<0?this.shape[4]:0|_,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},d.lo=function(u,a,y,h,_){var b=this.offset,w=0,T=this.shape[0],L=this.shape[1],M=this.shape[2],P=this.shape[3],z=this.shape[4],S=this.stride[0],C=this.stride[1],R=this.stride[2],D=this.stride[3],j=this.stride[4];return"number"==typeof u&&u>=0&&(b+=S*(w=0|u),T-=w),"number"==typeof a&&a>=0&&(b+=C*(w=0|a),L-=w),"number"==typeof y&&y>=0&&(b+=R*(w=0|y),M-=w),"number"==typeof h&&h>=0&&(b+=D*(w=0|h),P-=w),"number"==typeof _&&_>=0&&(b+=j*(w=0|_),z-=w),new o(this.data,T,L,M,P,z,S,C,R,D,j,b)},d.step=function(u,a,y,h,_){var b=this.shape[0],w=this.shape[1],T=this.shape[2],L=this.shape[3],M=this.shape[4],P=this.stride[0],z=this.stride[1],S=this.stride[2],C=this.stride[3],R=this.stride[4],D=this.offset,j=0,q=Math.ceil;return"number"==typeof u&&((j=0|u)<0?(D+=P*(b-1),b=q(-b/j)):b=q(b/j),P*=j),"number"==typeof a&&((j=0|a)<0?(D+=z*(w-1),w=q(-w/j)):w=q(w/j),z*=j),"number"==typeof y&&((j=0|y)<0?(D+=S*(T-1),T=q(-T/j)):T=q(T/j),S*=j),"number"==typeof h&&((j=0|h)<0?(D+=C*(L-1),L=q(-L/j)):L=q(L/j),C*=j),"number"==typeof _&&((j=0|_)<0?(D+=R*(M-1),M=q(-M/j)):M=q(M/j),R*=j),new o(this.data,b,w,T,L,M,P,z,S,C,R,D)},d.transpose=function(u,a,y,h,_){var b=this.shape,w=this.stride;return new o(this.data,b[u=void 0===u?0:0|u],b[a=void 0===a?1:0|a],b[y=void 0===y?2:0|y],b[h=void 0===h?3:0|h],b[_=void 0===_?4:0|_],w[u],w[a],w[y],w[h],w[_],this.offset)},d.pick=function(u,a,y,h,_){var b=[],w=[],T=this.offset;return"number"==typeof u&&u>=0?T=T+this.stride[0]*u|0:(b.push(this.shape[0]),w.push(this.stride[0])),"number"==typeof a&&a>=0?T=T+this.stride[1]*a|0:(b.push(this.shape[1]),w.push(this.stride[1])),"number"==typeof y&&y>=0?T=T+this.stride[2]*y|0:(b.push(this.shape[2]),w.push(this.stride[2])),"number"==typeof h&&h>=0?T=T+this.stride[3]*h|0:(b.push(this.shape[3]),w.push(this.stride[3])),"number"==typeof _&&_>=0?T=T+this.stride[4]*_|0:(b.push(this.shape[4]),w.push(this.stride[4])),(0,f[b.length+1])(this.data,b,w,T)},function(u,a,y,h){return new o(u,a[0],a[1],a[2],a[3],a[4],y[0],y[1],y[2],y[3],y[4],h)}}};function m(s,f){var l=-1===f?"T":String(f),o=n[l];return-1===f?o(s):0===f?o(s,p[s][0]):o(s,p[s],c)}var p={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};k.exports=function(s,f,l,o){if(void 0===s)return(0,p.array[0])([]);"number"==typeof s&&(s=[s]),void 0===f&&(f=[s.length]);var d=f.length;if(void 0===l){l=new Array(d);for(var u=d-1,a=1;u>=0;--u)l[u]=a,a*=f[u]}if(void 0===o)for(o=0,u=0;u<d;++u)l[u]<0&&(o-=(f[u]-1)*l[u]);for(var y=function(_){if(e(_))return"buffer";if(r)switch(Object.prototype.toString.call(_)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(_)?"array":"generic"}(s),h=p[y];h.length<=d+1;)h.push(m(y,h.length-1));return(0,h[d+1])(s,f,l,o)}},{"is-buffer":237}],260:[function(t,k,x){"use strict";var e=t("double-bits"),r=Math.pow(2,-1074);k.exports=function(i,c){if(isNaN(i)||isNaN(c))return NaN;if(i===c)return i;if(0===i)return c<0?-r:r;var n=e.hi(i),m=e.lo(i);return c>i==i>0?m===-1>>>0?(n+=1,m=0):m+=1:0===m?(m=-1>>>0,n-=1):m-=1,e.pack(m,n)}},{"double-bits":64}],261:[function(t,k,x){x.vertexNormals=function(e,r,i){for(var c=r.length,n=new Array(c),m=void 0===i?1e-6:i,p=0;p<c;++p)n[p]=[0,0,0];for(p=0;p<e.length;++p)for(var s=e[p],l=s[s.length-1],o=s[0],d=0;d<s.length;++d){for(var u=r[l],a=r[l=o],y=r[o=s[(d+1)%s.length]],h=new Array(3),_=0,b=new Array(3),w=0,T=0;T<3;++T)h[T]=u[T]-a[T],_+=h[T]*h[T],b[T]=y[T]-a[T],w+=b[T]*b[T];if(_*w>m){var L=n[l],M=1/Math.sqrt(_*w);for(T=0;T<3;++T){var P=(T+1)%3,z=(T+2)%3;L[T]+=M*(b[P]*h[z]-b[z]*h[P])}}}for(p=0;p<c;++p){L=n[p];var S=0;for(T=0;T<3;++T)S+=L[T]*L[T];if(S>m)for(M=1/Math.sqrt(S),T=0;T<3;++T)L[T]*=M;else for(T=0;T<3;++T)L[T]=0}return n},x.faceNormals=function(e,r,i){for(var c=e.length,n=new Array(c),m=void 0===i?1e-6:i,p=0;p<c;++p){for(var s=e[p],f=new Array(3),l=0;l<3;++l)f[l]=r[s[l]];var o=new Array(3),d=new Array(3);for(l=0;l<3;++l)o[l]=f[1][l]-f[0][l],d[l]=f[2][l]-f[0][l];var u=new Array(3),a=0;for(l=0;l<3;++l){var y=(l+1)%3,h=(l+2)%3;u[l]=o[y]*d[h]-o[h]*d[y],a+=u[l]*u[l]}for(a=a>m?1/Math.sqrt(a):0,l=0;l<3;++l)u[l]*=a;n[p]=u}return n}},{}],262:[function(t,k,x){"use strict";k.exports=function(e,r,i,c,n,m,p,s,f,l){var o=r+m+l;if(d>0){var d=Math.sqrt(o+1);e[0]=.5*(p-f)/d,e[1]=.5*(s-c)/d,e[2]=.5*(i-m)/d,e[3]=.5*d}else{var u=Math.max(r,m,l);d=Math.sqrt(2*u-o+1),r>=u?(e[0]=.5*d,e[1]=.5*(n+i)/d,e[2]=.5*(s+c)/d,e[3]=.5*(p-f)/d):m>=u?(e[0]=.5*(i+n)/d,e[1]=.5*d,e[2]=.5*(f+p)/d,e[3]=.5*(s-c)/d):(e[0]=.5*(c+s)/d,e[1]=.5*(p+f)/d,e[2]=.5*d,e[3]=.5*(i-n)/d)}return e}},{}],263:[function(t,k,x){"use strict";k.exports=function(o){var d=(o=o||{}).center||[0,0,0],u=o.rotation||[0,0,0,1],a=o.radius||1;d=[].slice.call(d,0,3),s(u=[].slice.call(u,0,4),u);var y=new f(u,d,Math.log(a));return y.setDistanceLimits(o.zoomMin,o.zoomMax),("eye"in o||"up"in o)&&y.lookAt(0,o.eye,o.center,o.up),y};var e=t("filtered-vector"),r=t("gl-mat4/lookAt"),i=t("gl-mat4/fromQuat"),c=t("gl-mat4/invert"),n=t("./lib/quatFromFrame");function m(o,d,u){return Math.sqrt(Math.pow(o,2)+Math.pow(d,2)+Math.pow(u,2))}function p(o,d,u,a){return Math.sqrt(Math.pow(o,2)+Math.pow(d,2)+Math.pow(u,2)+Math.pow(a,2))}function s(o,d){var u=d[0],a=d[1],y=d[2],h=d[3],_=p(u,a,y,h);_>1e-6?(o[0]=u/_,o[1]=a/_,o[2]=y/_,o[3]=h/_):(o[0]=o[1]=o[2]=0,o[3]=1)}function f(o,d,u){this.radius=e([u]),this.center=e(d),this.rotation=e(o),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var l=f.prototype;l.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},l.recalcMatrix=function(o){this.radius.curve(o),this.center.curve(o),this.rotation.curve(o);var d=this.computedRotation;s(d,d);var u=this.computedMatrix;i(u,d);var a=this.computedCenter,y=this.computedEye,h=this.computedUp,_=Math.exp(this.computedRadius[0]);y[0]=a[0]+_*u[2],y[1]=a[1]+_*u[6],y[2]=a[2]+_*u[10],h[0]=u[1],h[1]=u[5],h[2]=u[9];for(var b=0;b<3;++b){for(var w=0,T=0;T<3;++T)w+=u[b+4*T]*y[T];u[12+b]=-w}},l.getMatrix=function(o,d){this.recalcMatrix(o);var u=this.computedMatrix;if(d){for(var a=0;a<16;++a)d[a]=u[a];return d}return u},l.idle=function(o){this.center.idle(o),this.radius.idle(o),this.rotation.idle(o)},l.flush=function(o){this.center.flush(o),this.radius.flush(o),this.rotation.flush(o)},l.pan=function(o,d,u,a){d=d||0,u=u||0,a=a||0,this.recalcMatrix(o);var y=this.computedMatrix,h=y[1],_=y[5],b=y[9],w=m(h,_,b),T=y[0],L=y[4],M=y[8],P=T*(h/=w)+L*(_/=w)+M*(b/=w),z=m(T-=h*P,L-=_*P,M-=b*P),S=y[2],C=y[6],R=y[10],D=S*h+C*_+R*b,j=S*(T/=z)+C*(L/=z)+R*(M/=z),q=m(S-=D*h+j*T,C-=D*_+j*L,R-=D*b+j*M);S/=q,C/=q,R/=q,this.center.move(o,T*d+h*u,L*d+_*u,M*d+b*u);var X=Math.exp(this.computedRadius[0]);X=Math.max(1e-4,X+a),this.radius.set(o,Math.log(X))},l.rotate=function(o,d,u,a){this.recalcMatrix(o);var y=this.computedMatrix,M=y[2],P=y[6],z=y[10],S=(d=d||0)*y[0]+(u=u||0)*y[1],C=d*y[4]+u*y[5],R=d*y[8]+u*y[9],D=-(P*R-z*C),j=-(z*S-M*R),q=-(M*C-P*S),Z=Math.sqrt(Math.max(0,1-Math.pow(D,2)-Math.pow(j,2)-Math.pow(q,2))),W=p(D,j,q,Z);W>1e-6?(D/=W,j/=W,q/=W,Z/=W):(D=j=q=0,Z=1);var G=this.computedRotation,X=G[0],ne=G[1],V=G[2],N=G[3],U=X*Z+N*D+ne*q-V*j,ee=ne*Z+N*j+V*D-X*q,B=V*Z+N*q+X*j-ne*D,K=N*Z-X*D-ne*j-V*q;if(a){D=M,j=P,q=z;var J=Math.sin(a)/m(D,j,q);D*=J,j*=J,q*=J,K=K*(Z=Math.cos(d))-(U=U*Z+K*D+ee*q-B*j)*D-(ee=ee*Z+K*j+B*D-U*q)*j-(B=B*Z+K*q+U*j-ee*D)*q}var te=p(U,ee,B,K);te>1e-6?(U/=te,ee/=te,B/=te,K/=te):(U=ee=B=0,K=1),this.rotation.set(o,U,ee,B,K)},l.lookAt=function(o,d,u,a){this.recalcMatrix(o);var y=this.computedMatrix;r(y,d=d||this.computedEye,u=u||this.computedCenter,a=a||this.computedUp);var h=this.computedRotation;n(h,y[0],y[1],y[2],y[4],y[5],y[6],y[8],y[9],y[10]),s(h,h),this.rotation.set(o,h[0],h[1],h[2],h[3]);for(var _=0,b=0;b<3;++b)_+=Math.pow(u[b]-d[b],2);this.radius.set(o,.5*Math.log(Math.max(_,1e-6))),this.center.set(o,u[0],u[1],u[2])},l.translate=function(o,d,u,a){this.center.move(o,d||0,u||0,a||0)},l.setMatrix=function(o,d){var u=this.computedRotation;n(u,d[0],d[1],d[2],d[4],d[5],d[6],d[8],d[9],d[10]),s(u,u),this.rotation.set(o,u[0],u[1],u[2],u[3]);var a=this.computedMatrix;c(a,d);var y=a[15];if(Math.abs(y)>1e-6){var h=a[12]/y,_=a[13]/y,b=a[14]/y;this.recalcMatrix(o);var w=Math.exp(this.computedRadius[0]);this.center.set(o,h-a[2]*w,_-a[6]*w,b-a[10]*w),this.radius.idle(o)}else this.center.idle(o),this.radius.idle(o)},l.setDistance=function(o,d){d>0&&this.radius.set(o,Math.log(d))},l.setDistanceLimits=function(o,d){o=o>0?Math.log(o):-1/0,d=d>0?Math.log(d):1/0,d=Math.max(d,o),this.radius.bounds[0][0]=o,this.radius.bounds[1][0]=d},l.getDistanceLimits=function(o){var d=this.radius.bounds;return o?(o[0]=Math.exp(d[0][0]),o[1]=Math.exp(d[1][0]),o):[Math.exp(d[0][0]),Math.exp(d[1][0])]},l.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},l.fromJSON=function(o){var d=this.lastT(),u=o.center;u&&this.center.set(d,u[0],u[1],u[2]);var a=o.rotation;a&&this.rotation.set(d,a[0],a[1],a[2],a[3]);var y=o.distance;y&&y>0&&this.radius.set(d,Math.log(y)),this.setDistanceLimits(o.zoomMin,o.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(t,k,x){"use strict";var e=t("repeat-string");k.exports=function(r,i,c){return e(c=void 0!==c?c+"":" ",i)+r}},{"repeat-string":277}],265:[function(t,k,x){k.exports=function(e,r){r||(r=[0,""]),e=String(e);var i=parseFloat(e,10);return r[0]=i,r[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",r}},{}],266:[function(t,k,x){"use strict";k.exports=function(r,i){for(var c=0|i.length,n=r.length,m=[new Array(c),new Array(c)],p=0;p<c;++p)m[0][p]=[],m[1][p]=[];for(p=0;p<n;++p){var s=r[p];m[0][s[0]].push(s),m[1][s[1]].push(s)}var b,f=[];for(p=0;p<c;++p)m[0][p].length+m[1][p].length===0&&f.push([p]);function l(_,b){var w=m[b][_[b]];w.splice(w.indexOf(_),1)}function o(_,b,w){for(var T,L,M,P=0;P<2;++P)if(m[P][b].length>0){T=m[P][b][0],M=P;break}L=T[1^M];for(var z=0;z<2;++z)for(var S=m[z][b],C=0;C<S.length;++C){var R=S[C],D=R[1^z];e(i[_],i[b],i[L],i[D])>0&&(T=R,L=D,M=z)}return w||T&&l(T,M),L}function d(_,b){var w=m[b][_][0],T=[_];l(w,b);for(var L=w[1^b];;){for(;L!==_;)T.push(L),L=o(T[T.length-2],L,!1);if(m[0][_].length+m[1][_].length===0)break;var M=T[T.length-1],P=_,z=T[1],S=o(M,P,!0);if(e(i[M],i[P],i[z],i[S])<0)break;T.push(_),L=o(M,P)}return T}for(p=0;p<c;++p)for(var a=0;a<2;++a){for(var y=[];m[a][p].length>0;){var h=d(p,a);(b=h)[1]===b[b.length-1]?y.push.apply(y,h):(y.length>0&&f.push(y),y=h)}y.length>0&&f.push(y)}return f};var e=t("compare-angle")},{"compare-angle":54}],267:[function(t,k,x){"use strict";k.exports=function(r,i){for(var c=e(r,i.length),n=new Array(i.length),m=new Array(i.length),p=[],s=0;s<i.length;++s){var f=c[s].length;m[s]=f,n[s]=!0,f<=1&&p.push(s)}for(;p.length>0;){var l=p.pop();n[l]=!1;var o=c[l];for(s=0;s<o.length;++s){var d=o[s];0==--m[d]&&p.push(d)}}var u=new Array(i.length),a=[];for(s=0;s<i.length;++s)n[s]?(u[s]=l=a.length,a.push(i[s])):u[s]=-1;var y=[];for(s=0;s<r.length;++s){var h=r[s];n[h[0]]&&n[h[1]]&&y.push([u[h[0]],u[h[1]]])}return[y,a]};var e=t("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(t,k,x){"use strict";k.exports=function(f,l){for(var o=p(f,l),d=(l=o[1]).length,u=e(f=o[0],l.length),a=0;a<d;++a)if(u[a].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var y=r(f,l),h=(y=y.filter(function(oe){for(var ve=oe.length,fe=[0],xe=0;xe<ve;++xe){var Se=l[oe[xe]],pe=l[oe[(xe+1)%ve]],ge=c(-Se[0],Se[1]),Te=c(-Se[0],pe[1]),se=c(pe[0],Se[1]),de=c(pe[0],pe[1]);fe=n(fe,n(n(ge,Te),n(se,de)))}return fe[fe.length-1]>0})).length,_=new Array(h),b=new Array(h);for(a=0;a<h;++a){_[a]=a;var w=new Array(h),T=y[a].map(function(oe){return l[oe]}),L=i([T]),M=0;e:for(var P=0;P<h;++P)if(w[P]=0,a!==P){for(var z=(ae=y[P]).length,S=0;S<z;++S){var C=L(l[ae[S]]);if(0!==C){C<0&&(w[P]=1,M+=1);continue e}}w[P]=1,M+=1}b[a]=[M,a,w]}for(b.sort(function(oe,ve){return ve[0]-oe[0]}),a=0;a<h;++a){var R=(w=b[a])[1],D=w[2];for(P=0;P<h;++P)D[P]&&(_[P]=R)}var j=function(oe){for(var ve=new Array(oe),fe=0;fe<oe;++fe)ve[fe]=[];return ve}(h);for(a=0;a<h;++a)j[a].push(_[a]),j[_[a]].push(a);var q={},Z=s(d,!1);for(a=0;a<h;++a)for(z=(ae=y[a]).length,P=0;P<z;++P){var W=ae[P],G=ae[(P+1)%z],X=Math.min(W,G)+":"+Math.max(W,G);if(X in q){var ne=q[X];j[ne].push(a),j[a].push(ne),Z[W]=Z[G]=!0}else q[X]=a}function V(oe){for(var ve=oe.length,fe=0;fe<ve;++fe)if(!Z[oe[fe]])return!1;return!0}var N=[],U=s(h,-1);for(a=0;a<h;++a)_[a]!==a||V(y[a])?U[a]=-1:(N.push(a),U[a]=0);for(o=[];N.length>0;){var ee=N.pop(),B=j[ee];m(B,function(oe,ve){return oe-ve});var K,J=B.length,te=U[ee];if(0===te){var ae=y[ee];K=[ae]}for(a=0;a<J;++a){var ce=B[a];U[ce]>=0||(U[ce]=1^te,N.push(ce),0===te&&(V(ae=y[ce])||(ae.reverse(),K.push(ae))))}0===te&&o.push(K)}return o};var e=t("edges-to-adjacency-list"),r=t("planar-dual"),i=t("point-in-big-polygon"),c=t("two-product"),n=t("robust-sum"),m=t("uniq"),p=t("./lib/trim-leaves");function s(f,l){for(var o=new Array(f),d=0;d<f;++d)o[d]=l;return o}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(t,k,x){k.exports=function(s){for(var f=s.length,l=[],o=[],d=0;d<f;++d)for(var u=s[d],a=u.length,y=a-1,h=0;h<a;y=h++){var _=u[y],b=u[h];_[0]===b[0]?o.push([_,b]):l.push([_,b])}if(0===l.length)return 0===o.length?p:(w=m(o),function(M){return w(M[0],M[1])?0:1});var w,M,P,T=r(l),L=(M=T.slabs,P=T.coordinates,function(z){var S=c.le(P,z[0]);if(S<0)return 1;var C=M[S];if(!C){if(!(S>0&&P[S]===z[0]))return 1;C=M[S-1]}for(var R=1;C;){var D=C.key,j=e(z,D[0],D[1]);if(D[0][0]<D[1][0])if(j<0)C=C.left;else{if(!(j>0))return 0;R=-1,C=C.right}else if(j>0)C=C.left;else{if(!(j<0))return 0;R=1,C=C.right}}return R});return 0===o.length?L:function(M,P){return function(z){return M(z[0],z[1])?0:P(z)}}(m(o),L)};var e=t("robust-orientation")[3],r=t("slab-decomposition"),i=t("interval-tree-1d"),c=t("binary-search-bounds");function n(){return!0}function m(s){for(var f={},l=0;l<s.length;++l){var o=s[l],d=o[0][0],u=o[0][1],a=o[1][1],y=[Math.min(u,a),Math.max(u,a)];d in f?f[d].push(y):f[d]=[y]}var w,h={},_=Object.keys(f);for(l=0;l<_.length;++l)h[_[l]]=i(f[_[l]]);return w=h,function(T,L){var M=w[T];return!!M&&!!M.queryPoint(L,n)}}function p(s){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(t,k,x){"use strict";var e=new Float64Array(4),r=new Float64Array(4),i=new Float64Array(4);k.exports=function(c,n,m,p,s){e.length<p.length&&(e=new Float64Array(p.length),r=new Float64Array(p.length),i=new Float64Array(p.length));for(var f=0;f<p.length;++f)e[f]=c[f]-p[f],r[f]=n[f]-c[f],i[f]=m[f]-c[f];var l=0,o=0,d=0,u=0,a=0,y=0;for(f=0;f<p.length;++f){var h=r[f],_=i[f],b=e[f];l+=h*h,o+=h*_,d+=_*_,u+=b*h,a+=b*_,y+=b*b}var w,T,L,M,P,z=Math.abs(l*d-o*o),S=o*a-d*u,C=o*u-l*a;if(S+C<=z)if(S<0)C<0&&u<0?(C=0,-u>=l?(S=1,w=l+2*u+y):w=u*(S=-u/l)+y):(S=0,a>=0?(C=0,w=y):-a>=d?(C=1,w=d+2*a+y):w=a*(C=-a/d)+y);else if(C<0)C=0,u>=0?(S=0,w=y):-u>=l?(S=1,w=l+2*u+y):w=u*(S=-u/l)+y;else{var R=1/z;w=(S*=R)*(l*S+o*(C*=R)+2*u)+C*(o*S+d*C+2*a)+y}else S<0?(L=d+a)>(T=o+u)?(M=L-T)>=(P=l-2*o+d)?(S=1,C=0,w=l+2*u+y):w=(S=M/P)*(l*S+o*(C=1-S)+2*u)+C*(o*S+d*C+2*a)+y:(S=0,L<=0?(C=1,w=d+2*a+y):a>=0?(C=0,w=y):w=a*(C=-a/d)+y):C<0?(L=l+u)>(T=o+a)?(M=L-T)>=(P=l-2*o+d)?(C=1,S=0,w=d+2*a+y):w=(S=1-(C=M/P))*(l*S+o*C+2*u)+C*(o*S+d*C+2*a)+y:(C=0,L<=0?(S=1,w=l+2*u+y):u>=0?(S=0,w=y):w=u*(S=-u/l)+y):(M=d+a-o-u)<=0?(S=0,C=1,w=d+2*a+y):M>=(P=l-2*o+d)?(S=1,C=0,w=l+2*u+y):w=(S=M/P)*(l*S+o*(C=1-S)+2*u)+C*(o*S+d*C+2*a)+y;var D=1-S-C;for(f=0;f<p.length;++f)s[f]=D*c[f]+S*n[f]+C*m[f];return w<0?0:w}},{}],271:[function(t,k,x){k.exports=t("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(t,k,x){"use strict";var e=t("big-rat/add");k.exports=function(r,i){for(var c=r.length,n=new Array(c),m=0;m<c;++m)n[m]=e(r[m],i[m]);return n}},{"big-rat/add":15}],273:[function(t,k,x){"use strict";k.exports=function(r){for(var i=new Array(r.length),c=0;c<r.length;++c)i[c]=e(r[c]);return i};var e=t("big-rat")},{"big-rat":18}],274:[function(t,k,x){"use strict";var e=t("big-rat"),r=t("big-rat/mul");k.exports=function(i,c){for(var n=e(c),m=i.length,p=new Array(m),s=0;s<m;++s)p[s]=r(i[s],n);return p}},{"big-rat":18,"big-rat/mul":27}],275:[function(t,k,x){"use strict";var e=t("big-rat/sub");k.exports=function(r,i){for(var c=r.length,n=new Array(c),m=0;m<c;++m)n[m]=e(r[m],i[m]);return n}},{"big-rat/sub":29}],276:[function(t,k,x){"use strict";var e=t("compare-cell"),r=t("compare-oriented-cell"),i=t("cell-orientation");k.exports=function(c){c.sort(r);for(var n=c.length,m=0,p=0;p<n;++p){var s=c[p],f=i(s);if(0!==f){if(m>0){var l=c[m-1];if(0===e(s,l)&&i(l)!==f){m-=1;continue}}c[m++]=s}}return c.length=m,c}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(t,k,x){"use strict";var e,r="";k.exports=function(i,c){if("string"!=typeof i)throw new TypeError("expected a string");if(1===c)return i;if(2===c)return i+i;var n=i.length*c;if(e!==i||void 0===e)e=i,r="";else if(r.length>=n)return r.substr(0,n);for(;n>r.length&&c>1;)1&c&&(r+=i),c>>=1,i+=i;return r=(r+=i).substr(0,n)}},{}],278:[function(t,k,x){(function(e){(function(){k.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,void 0!==g?g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],279:[function(t,k,x){"use strict";k.exports=function(e){for(var r=e.length,i=e[e.length-1],c=r,n=r-2;n>=0;--n){var m=i,p=e[n];(f=p-((i=m+p)-m))&&(e[--c]=i,i=f)}var s=0;for(n=c;n<r;++n){var f;(f=(p=i)-((i=(m=e[n])+p)-m))&&(e[s++]=f)}return e[s++]=i,e.length=s,e}},{}],280:[function(t,k,x){"use strict";var e=t("two-product"),r=t("robust-sum"),i=t("robust-scale"),c=t("robust-compress");function n(d,u,a,y){return function(h){return y(d(a(h[0][0],h[1][1]),a(-h[0][1],h[1][0])))}}function m(d,u,a,y){return function(h){return y(d(u(d(a(h[1][1],h[2][2]),a(-h[1][2],h[2][1])),h[0][0]),d(u(d(a(h[1][0],h[2][2]),a(-h[1][2],h[2][0])),-h[0][1]),u(d(a(h[1][0],h[2][1]),a(-h[1][1],h[2][0])),h[0][2]))))}}function p(d,u,a,y){return function(h){return y(d(d(u(d(u(d(a(h[2][2],h[3][3]),a(-h[2][3],h[3][2])),h[1][1]),d(u(d(a(h[2][1],h[3][3]),a(-h[2][3],h[3][1])),-h[1][2]),u(d(a(h[2][1],h[3][2]),a(-h[2][2],h[3][1])),h[1][3]))),h[0][0]),u(d(u(d(a(h[2][2],h[3][3]),a(-h[2][3],h[3][2])),h[1][0]),d(u(d(a(h[2][0],h[3][3]),a(-h[2][3],h[3][0])),-h[1][2]),u(d(a(h[2][0],h[3][2]),a(-h[2][2],h[3][0])),h[1][3]))),-h[0][1])),d(u(d(u(d(a(h[2][1],h[3][3]),a(-h[2][3],h[3][1])),h[1][0]),d(u(d(a(h[2][0],h[3][3]),a(-h[2][3],h[3][0])),-h[1][1]),u(d(a(h[2][0],h[3][1]),a(-h[2][1],h[3][0])),h[1][3]))),h[0][2]),u(d(u(d(a(h[2][1],h[3][2]),a(-h[2][2],h[3][1])),h[1][0]),d(u(d(a(h[2][0],h[3][2]),a(-h[2][2],h[3][0])),-h[1][1]),u(d(a(h[2][0],h[3][1]),a(-h[2][1],h[3][0])),h[1][2]))),-h[0][3]))))}}function s(d,u,a,y){return function(h){return y(d(d(u(d(d(u(d(u(d(a(h[3][3],h[4][4]),a(-h[3][4],h[4][3])),h[2][2]),d(u(d(a(h[3][2],h[4][4]),a(-h[3][4],h[4][2])),-h[2][3]),u(d(a(h[3][2],h[4][3]),a(-h[3][3],h[4][2])),h[2][4]))),h[1][1]),u(d(u(d(a(h[3][3],h[4][4]),a(-h[3][4],h[4][3])),h[2][1]),d(u(d(a(h[3][1],h[4][4]),a(-h[3][4],h[4][1])),-h[2][3]),u(d(a(h[3][1],h[4][3]),a(-h[3][3],h[4][1])),h[2][4]))),-h[1][2])),d(u(d(u(d(a(h[3][2],h[4][4]),a(-h[3][4],h[4][2])),h[2][1]),d(u(d(a(h[3][1],h[4][4]),a(-h[3][4],h[4][1])),-h[2][2]),u(d(a(h[3][1],h[4][2]),a(-h[3][2],h[4][1])),h[2][4]))),h[1][3]),u(d(u(d(a(h[3][2],h[4][3]),a(-h[3][3],h[4][2])),h[2][1]),d(u(d(a(h[3][1],h[4][3]),a(-h[3][3],h[4][1])),-h[2][2]),u(d(a(h[3][1],h[4][2]),a(-h[3][2],h[4][1])),h[2][3]))),-h[1][4]))),h[0][0]),u(d(d(u(d(u(d(a(h[3][3],h[4][4]),a(-h[3][4],h[4][3])),h[2][2]),d(u(d(a(h[3][2],h[4][4]),a(-h[3][4],h[4][2])),-h[2][3]),u(d(a(h[3][2],h[4][3]),a(-h[3][3],h[4][2])),h[2][4]))),h[1][0]),u(d(u(d(a(h[3][3],h[4][4]),a(-h[3][4],h[4][3])),h[2][0]),d(u(d(a(h[3][0],h[4][4]),a(-h[3][4],h[4][0])),-h[2][3]),u(d(a(h[3][0],h[4][3]),a(-h[3][3],h[4][0])),h[2][4]))),-h[1][2])),d(u(d(u(d(a(h[3][2],h[4][4]),a(-h[3][4],h[4][2])),h[2][0]),d(u(d(a(h[3][0],h[4][4]),a(-h[3][4],h[4][0])),-h[2][2]),u(d(a(h[3][0],h[4][2]),a(-h[3][2],h[4][0])),h[2][4]))),h[1][3]),u(d(u(d(a(h[3][2],h[4][3]),a(-h[3][3],h[4][2])),h[2][0]),d(u(d(a(h[3][0],h[4][3]),a(-h[3][3],h[4][0])),-h[2][2]),u(d(a(h[3][0],h[4][2]),a(-h[3][2],h[4][0])),h[2][3]))),-h[1][4]))),-h[0][1])),d(u(d(d(u(d(u(d(a(h[3][3],h[4][4]),a(-h[3][4],h[4][3])),h[2][1]),d(u(d(a(h[3][1],h[4][4]),a(-h[3][4],h[4][1])),-h[2][3]),u(d(a(h[3][1],h[4][3]),a(-h[3][3],h[4][1])),h[2][4]))),h[1][0]),u(d(u(d(a(h[3][3],h[4][4]),a(-h[3][4],h[4][3])),h[2][0]),d(u(d(a(h[3][0],h[4][4]),a(-h[3][4],h[4][0])),-h[2][3]),u(d(a(h[3][0],h[4][3]),a(-h[3][3],h[4][0])),h[2][4]))),-h[1][1])),d(u(d(u(d(a(h[3][1],h[4][4]),a(-h[3][4],h[4][1])),h[2][0]),d(u(d(a(h[3][0],h[4][4]),a(-h[3][4],h[4][0])),-h[2][1]),u(d(a(h[3][0],h[4][1]),a(-h[3][1],h[4][0])),h[2][4]))),h[1][3]),u(d(u(d(a(h[3][1],h[4][3]),a(-h[3][3],h[4][1])),h[2][0]),d(u(d(a(h[3][0],h[4][3]),a(-h[3][3],h[4][0])),-h[2][1]),u(d(a(h[3][0],h[4][1]),a(-h[3][1],h[4][0])),h[2][3]))),-h[1][4]))),h[0][2]),d(u(d(d(u(d(u(d(a(h[3][2],h[4][4]),a(-h[3][4],h[4][2])),h[2][1]),d(u(d(a(h[3][1],h[4][4]),a(-h[3][4],h[4][1])),-h[2][2]),u(d(a(h[3][1],h[4][2]),a(-h[3][2],h[4][1])),h[2][4]))),h[1][0]),u(d(u(d(a(h[3][2],h[4][4]),a(-h[3][4],h[4][2])),h[2][0]),d(u(d(a(h[3][0],h[4][4]),a(-h[3][4],h[4][0])),-h[2][2]),u(d(a(h[3][0],h[4][2]),a(-h[3][2],h[4][0])),h[2][4]))),-h[1][1])),d(u(d(u(d(a(h[3][1],h[4][4]),a(-h[3][4],h[4][1])),h[2][0]),d(u(d(a(h[3][0],h[4][4]),a(-h[3][4],h[4][0])),-h[2][1]),u(d(a(h[3][0],h[4][1]),a(-h[3][1],h[4][0])),h[2][4]))),h[1][2]),u(d(u(d(a(h[3][1],h[4][2]),a(-h[3][2],h[4][1])),h[2][0]),d(u(d(a(h[3][0],h[4][2]),a(-h[3][2],h[4][0])),-h[2][1]),u(d(a(h[3][0],h[4][1]),a(-h[3][1],h[4][0])),h[2][2]))),-h[1][4]))),-h[0][3]),u(d(d(u(d(u(d(a(h[3][2],h[4][3]),a(-h[3][3],h[4][2])),h[2][1]),d(u(d(a(h[3][1],h[4][3]),a(-h[3][3],h[4][1])),-h[2][2]),u(d(a(h[3][1],h[4][2]),a(-h[3][2],h[4][1])),h[2][3]))),h[1][0]),u(d(u(d(a(h[3][2],h[4][3]),a(-h[3][3],h[4][2])),h[2][0]),d(u(d(a(h[3][0],h[4][3]),a(-h[3][3],h[4][0])),-h[2][2]),u(d(a(h[3][0],h[4][2]),a(-h[3][2],h[4][0])),h[2][3]))),-h[1][1])),d(u(d(u(d(a(h[3][1],h[4][3]),a(-h[3][3],h[4][1])),h[2][0]),d(u(d(a(h[3][0],h[4][3]),a(-h[3][3],h[4][0])),-h[2][1]),u(d(a(h[3][0],h[4][1]),a(-h[3][1],h[4][0])),h[2][3]))),h[1][2]),u(d(u(d(a(h[3][1],h[4][2]),a(-h[3][2],h[4][1])),h[2][0]),d(u(d(a(h[3][0],h[4][2]),a(-h[3][2],h[4][0])),-h[2][1]),u(d(a(h[3][0],h[4][1]),a(-h[3][1],h[4][0])),h[2][2]))),-h[1][3]))),h[0][4])))))}}function f(d){return(2===d?n:3===d?m:4===d?p:5===d?s:void 0)(r,i,e,c)}var l=[function(){return[0]},function(d){return[d[0][0]]}];function o(d,u,a,y,h,_,b,w){return function(T){switch(T.length){case 0:return d(T);case 1:return u(T);case 2:return a(T);case 3:return y(T);case 4:return h(T);case 5:return _(T)}var L=b[T.length];return L||(L=b[T.length]=w(T.length)),L(T)}}!function(){for(;l.length<6;)l.push(f(l.length));k.exports=o.apply(void 0,l.concat([l,f]));for(var d=0;d<l.length;++d)k.exports[d]=l[d]}()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(t,k,x){"use strict";var e=t("two-product"),r=t("robust-sum");k.exports=function(i,c){for(var n=e(i[0],c[0]),m=1;m<i.length;++m)n=r(n,e(i[m],c[m]));return n}},{"robust-sum":289,"two-product":306}],282:[function(t,k,x){"use strict";var e=t("two-product"),r=t("robust-sum"),i=t("robust-subtract"),c=t("robust-scale");function n(u){return(3===u?m:4===u?p:5===u?s:f)(r,i,e,c)}function m(u,a,y,h){return function(_,b,w){var T=y(_[0],_[0]),L=h(T,b[0]),M=h(T,w[0]),P=y(b[0],b[0]),z=h(P,_[0]),S=h(P,w[0]),C=y(w[0],w[0]),R=h(C,_[0]),D=h(C,b[0]),j=u(a(D,S),a(z,L)),q=a(R,M),Z=a(j,q);return Z[Z.length-1]}}function p(u,a,y,h){return function(_,b,w,T){var L=u(y(_[0],_[0]),y(_[1],_[1])),M=h(L,b[0]),P=h(L,w[0]),z=h(L,T[0]),S=u(y(b[0],b[0]),y(b[1],b[1])),C=h(S,_[0]),R=h(S,w[0]),D=h(S,T[0]),j=u(y(w[0],w[0]),y(w[1],w[1])),q=h(j,_[0]),Z=h(j,b[0]),W=h(j,T[0]),G=u(y(T[0],T[0]),y(T[1],T[1])),X=h(G,_[0]),ne=h(G,b[0]),V=h(G,w[0]),N=u(u(h(a(V,W),b[1]),u(h(a(ne,D),-w[1]),h(a(Z,R),T[1]))),u(h(a(ne,D),_[1]),u(h(a(X,z),-b[1]),h(a(C,M),T[1])))),U=u(u(h(a(V,W),_[1]),u(h(a(X,z),-w[1]),h(a(q,P),T[1]))),u(h(a(Z,R),_[1]),u(h(a(q,P),-b[1]),h(a(C,M),w[1])))),ee=a(N,U);return ee[ee.length-1]}}function s(u,a,y,h){return function(_,b,w,T,L){var M=u(y(_[0],_[0]),u(y(_[1],_[1]),y(_[2],_[2]))),P=h(M,b[0]),z=h(M,w[0]),S=h(M,T[0]),C=h(M,L[0]),R=u(y(b[0],b[0]),u(y(b[1],b[1]),y(b[2],b[2]))),D=h(R,_[0]),j=h(R,w[0]),q=h(R,T[0]),Z=h(R,L[0]),W=u(y(w[0],w[0]),u(y(w[1],w[1]),y(w[2],w[2]))),G=h(W,_[0]),X=h(W,b[0]),ne=h(W,T[0]),V=h(W,L[0]),N=u(y(T[0],T[0]),u(y(T[1],T[1]),y(T[2],T[2]))),U=h(N,_[0]),ee=h(N,b[0]),B=h(N,w[0]),K=h(N,L[0]),J=u(y(L[0],L[0]),u(y(L[1],L[1]),y(L[2],L[2]))),te=h(J,_[0]),ae=h(J,b[0]),ce=h(J,w[0]),oe=h(J,T[0]),ve=u(u(u(h(u(h(a(oe,K),w[1]),u(h(a(ce,V),-T[1]),h(a(B,ne),L[1]))),b[2]),u(h(u(h(a(oe,K),b[1]),u(h(a(ae,Z),-T[1]),h(a(ee,q),L[1]))),-w[2]),h(u(h(a(ce,V),b[1]),u(h(a(ae,Z),-w[1]),h(a(X,j),L[1]))),T[2]))),u(h(u(h(a(B,ne),b[1]),u(h(a(ee,q),-w[1]),h(a(X,j),T[1]))),-L[2]),u(h(u(h(a(oe,K),b[1]),u(h(a(ae,Z),-T[1]),h(a(ee,q),L[1]))),_[2]),h(u(h(a(oe,K),_[1]),u(h(a(te,C),-T[1]),h(a(U,S),L[1]))),-b[2])))),u(u(h(u(h(a(ae,Z),_[1]),u(h(a(te,C),-b[1]),h(a(D,P),L[1]))),T[2]),u(h(u(h(a(ee,q),_[1]),u(h(a(U,S),-b[1]),h(a(D,P),T[1]))),-L[2]),h(u(h(a(B,ne),b[1]),u(h(a(ee,q),-w[1]),h(a(X,j),T[1]))),_[2]))),u(h(u(h(a(B,ne),_[1]),u(h(a(U,S),-w[1]),h(a(G,z),T[1]))),-b[2]),u(h(u(h(a(ee,q),_[1]),u(h(a(U,S),-b[1]),h(a(D,P),T[1]))),w[2]),h(u(h(a(X,j),_[1]),u(h(a(G,z),-b[1]),h(a(D,P),w[1]))),-T[2]))))),fe=u(u(u(h(u(h(a(oe,K),w[1]),u(h(a(ce,V),-T[1]),h(a(B,ne),L[1]))),_[2]),h(u(h(a(oe,K),_[1]),u(h(a(te,C),-T[1]),h(a(U,S),L[1]))),-w[2])),u(h(u(h(a(ce,V),_[1]),u(h(a(te,C),-w[1]),h(a(G,z),L[1]))),T[2]),h(u(h(a(B,ne),_[1]),u(h(a(U,S),-w[1]),h(a(G,z),T[1]))),-L[2]))),u(u(h(u(h(a(ce,V),b[1]),u(h(a(ae,Z),-w[1]),h(a(X,j),L[1]))),_[2]),h(u(h(a(ce,V),_[1]),u(h(a(te,C),-w[1]),h(a(G,z),L[1]))),-b[2])),u(h(u(h(a(ae,Z),_[1]),u(h(a(te,C),-b[1]),h(a(D,P),L[1]))),w[2]),h(u(h(a(X,j),_[1]),u(h(a(G,z),-b[1]),h(a(D,P),w[1]))),-L[2])))),xe=a(ve,fe);return xe[xe.length-1]}}function f(u,a,y,h){return function(_,b,w,T,L,M){var P=u(u(y(_[0],_[0]),y(_[1],_[1])),u(y(_[2],_[2]),y(_[3],_[3]))),z=h(P,b[0]),S=h(P,w[0]),C=h(P,T[0]),R=h(P,L[0]),D=h(P,M[0]),j=u(u(y(b[0],b[0]),y(b[1],b[1])),u(y(b[2],b[2]),y(b[3],b[3]))),q=h(j,_[0]),Z=h(j,w[0]),W=h(j,T[0]),G=h(j,L[0]),X=h(j,M[0]),ne=u(u(y(w[0],w[0]),y(w[1],w[1])),u(y(w[2],w[2]),y(w[3],w[3]))),V=h(ne,_[0]),N=h(ne,b[0]),U=h(ne,T[0]),ee=h(ne,L[0]),B=h(ne,M[0]),K=u(u(y(T[0],T[0]),y(T[1],T[1])),u(y(T[2],T[2]),y(T[3],T[3]))),J=h(K,_[0]),te=h(K,b[0]),ae=h(K,w[0]),ce=h(K,L[0]),oe=h(K,M[0]),ve=u(u(y(L[0],L[0]),y(L[1],L[1])),u(y(L[2],L[2]),y(L[3],L[3]))),fe=h(ve,_[0]),xe=h(ve,b[0]),Se=h(ve,w[0]),pe=h(ve,T[0]),ge=h(ve,M[0]),Te=u(u(y(M[0],M[0]),y(M[1],M[1])),u(y(M[2],M[2]),y(M[3],M[3]))),se=h(Te,_[0]),de=h(Te,b[0]),Ae=h(Te,w[0]),Le=h(Te,T[0]),Me=h(Te,L[0]),De=u(u(u(h(u(u(h(u(h(a(Me,ge),T[1]),u(h(a(Le,oe),-L[1]),h(a(pe,ce),M[1]))),w[2]),h(u(h(a(Me,ge),w[1]),u(h(a(Ae,B),-L[1]),h(a(Se,ee),M[1]))),-T[2])),u(h(u(h(a(Le,oe),w[1]),u(h(a(Ae,B),-T[1]),h(a(ae,U),M[1]))),L[2]),h(u(h(a(pe,ce),w[1]),u(h(a(Se,ee),-T[1]),h(a(ae,U),L[1]))),-M[2]))),b[3]),u(h(u(u(h(u(h(a(Me,ge),T[1]),u(h(a(Le,oe),-L[1]),h(a(pe,ce),M[1]))),b[2]),h(u(h(a(Me,ge),b[1]),u(h(a(de,X),-L[1]),h(a(xe,G),M[1]))),-T[2])),u(h(u(h(a(Le,oe),b[1]),u(h(a(de,X),-T[1]),h(a(te,W),M[1]))),L[2]),h(u(h(a(pe,ce),b[1]),u(h(a(xe,G),-T[1]),h(a(te,W),L[1]))),-M[2]))),-w[3]),h(u(u(h(u(h(a(Me,ge),w[1]),u(h(a(Ae,B),-L[1]),h(a(Se,ee),M[1]))),b[2]),h(u(h(a(Me,ge),b[1]),u(h(a(de,X),-L[1]),h(a(xe,G),M[1]))),-w[2])),u(h(u(h(a(Ae,B),b[1]),u(h(a(de,X),-w[1]),h(a(N,Z),M[1]))),L[2]),h(u(h(a(Se,ee),b[1]),u(h(a(xe,G),-w[1]),h(a(N,Z),L[1]))),-M[2]))),T[3]))),u(u(h(u(u(h(u(h(a(Le,oe),w[1]),u(h(a(Ae,B),-T[1]),h(a(ae,U),M[1]))),b[2]),h(u(h(a(Le,oe),b[1]),u(h(a(de,X),-T[1]),h(a(te,W),M[1]))),-w[2])),u(h(u(h(a(Ae,B),b[1]),u(h(a(de,X),-w[1]),h(a(N,Z),M[1]))),T[2]),h(u(h(a(ae,U),b[1]),u(h(a(te,W),-w[1]),h(a(N,Z),T[1]))),-M[2]))),-L[3]),h(u(u(h(u(h(a(pe,ce),w[1]),u(h(a(Se,ee),-T[1]),h(a(ae,U),L[1]))),b[2]),h(u(h(a(pe,ce),b[1]),u(h(a(xe,G),-T[1]),h(a(te,W),L[1]))),-w[2])),u(h(u(h(a(Se,ee),b[1]),u(h(a(xe,G),-w[1]),h(a(N,Z),L[1]))),T[2]),h(u(h(a(ae,U),b[1]),u(h(a(te,W),-w[1]),h(a(N,Z),T[1]))),-L[2]))),M[3])),u(h(u(u(h(u(h(a(Me,ge),T[1]),u(h(a(Le,oe),-L[1]),h(a(pe,ce),M[1]))),b[2]),h(u(h(a(Me,ge),b[1]),u(h(a(de,X),-L[1]),h(a(xe,G),M[1]))),-T[2])),u(h(u(h(a(Le,oe),b[1]),u(h(a(de,X),-T[1]),h(a(te,W),M[1]))),L[2]),h(u(h(a(pe,ce),b[1]),u(h(a(xe,G),-T[1]),h(a(te,W),L[1]))),-M[2]))),_[3]),h(u(u(h(u(h(a(Me,ge),T[1]),u(h(a(Le,oe),-L[1]),h(a(pe,ce),M[1]))),_[2]),h(u(h(a(Me,ge),_[1]),u(h(a(se,D),-L[1]),h(a(fe,R),M[1]))),-T[2])),u(h(u(h(a(Le,oe),_[1]),u(h(a(se,D),-T[1]),h(a(J,C),M[1]))),L[2]),h(u(h(a(pe,ce),_[1]),u(h(a(fe,R),-T[1]),h(a(J,C),L[1]))),-M[2]))),-b[3])))),u(u(u(h(u(u(h(u(h(a(Me,ge),b[1]),u(h(a(de,X),-L[1]),h(a(xe,G),M[1]))),_[2]),h(u(h(a(Me,ge),_[1]),u(h(a(se,D),-L[1]),h(a(fe,R),M[1]))),-b[2])),u(h(u(h(a(de,X),_[1]),u(h(a(se,D),-b[1]),h(a(q,z),M[1]))),L[2]),h(u(h(a(xe,G),_[1]),u(h(a(fe,R),-b[1]),h(a(q,z),L[1]))),-M[2]))),T[3]),h(u(u(h(u(h(a(Le,oe),b[1]),u(h(a(de,X),-T[1]),h(a(te,W),M[1]))),_[2]),h(u(h(a(Le,oe),_[1]),u(h(a(se,D),-T[1]),h(a(J,C),M[1]))),-b[2])),u(h(u(h(a(de,X),_[1]),u(h(a(se,D),-b[1]),h(a(q,z),M[1]))),T[2]),h(u(h(a(te,W),_[1]),u(h(a(J,C),-b[1]),h(a(q,z),T[1]))),-M[2]))),-L[3])),u(h(u(u(h(u(h(a(pe,ce),b[1]),u(h(a(xe,G),-T[1]),h(a(te,W),L[1]))),_[2]),h(u(h(a(pe,ce),_[1]),u(h(a(fe,R),-T[1]),h(a(J,C),L[1]))),-b[2])),u(h(u(h(a(xe,G),_[1]),u(h(a(fe,R),-b[1]),h(a(q,z),L[1]))),T[2]),h(u(h(a(te,W),_[1]),u(h(a(J,C),-b[1]),h(a(q,z),T[1]))),-L[2]))),M[3]),h(u(u(h(u(h(a(Le,oe),w[1]),u(h(a(Ae,B),-T[1]),h(a(ae,U),M[1]))),b[2]),h(u(h(a(Le,oe),b[1]),u(h(a(de,X),-T[1]),h(a(te,W),M[1]))),-w[2])),u(h(u(h(a(Ae,B),b[1]),u(h(a(de,X),-w[1]),h(a(N,Z),M[1]))),T[2]),h(u(h(a(ae,U),b[1]),u(h(a(te,W),-w[1]),h(a(N,Z),T[1]))),-M[2]))),_[3]))),u(u(h(u(u(h(u(h(a(Le,oe),w[1]),u(h(a(Ae,B),-T[1]),h(a(ae,U),M[1]))),_[2]),h(u(h(a(Le,oe),_[1]),u(h(a(se,D),-T[1]),h(a(J,C),M[1]))),-w[2])),u(h(u(h(a(Ae,B),_[1]),u(h(a(se,D),-w[1]),h(a(V,S),M[1]))),T[2]),h(u(h(a(ae,U),_[1]),u(h(a(J,C),-w[1]),h(a(V,S),T[1]))),-M[2]))),-b[3]),h(u(u(h(u(h(a(Le,oe),b[1]),u(h(a(de,X),-T[1]),h(a(te,W),M[1]))),_[2]),h(u(h(a(Le,oe),_[1]),u(h(a(se,D),-T[1]),h(a(J,C),M[1]))),-b[2])),u(h(u(h(a(de,X),_[1]),u(h(a(se,D),-b[1]),h(a(q,z),M[1]))),T[2]),h(u(h(a(te,W),_[1]),u(h(a(J,C),-b[1]),h(a(q,z),T[1]))),-M[2]))),w[3])),u(h(u(u(h(u(h(a(Ae,B),b[1]),u(h(a(de,X),-w[1]),h(a(N,Z),M[1]))),_[2]),h(u(h(a(Ae,B),_[1]),u(h(a(se,D),-w[1]),h(a(V,S),M[1]))),-b[2])),u(h(u(h(a(de,X),_[1]),u(h(a(se,D),-b[1]),h(a(q,z),M[1]))),w[2]),h(u(h(a(N,Z),_[1]),u(h(a(V,S),-b[1]),h(a(q,z),w[1]))),-M[2]))),-T[3]),h(u(u(h(u(h(a(ae,U),b[1]),u(h(a(te,W),-w[1]),h(a(N,Z),T[1]))),_[2]),h(u(h(a(ae,U),_[1]),u(h(a(J,C),-w[1]),h(a(V,S),T[1]))),-b[2])),u(h(u(h(a(te,W),_[1]),u(h(a(J,C),-b[1]),h(a(q,z),T[1]))),w[2]),h(u(h(a(N,Z),_[1]),u(h(a(V,S),-b[1]),h(a(q,z),w[1]))),-T[2]))),M[3]))))),Oe=u(u(u(h(u(u(h(u(h(a(Me,ge),T[1]),u(h(a(Le,oe),-L[1]),h(a(pe,ce),M[1]))),w[2]),h(u(h(a(Me,ge),w[1]),u(h(a(Ae,B),-L[1]),h(a(Se,ee),M[1]))),-T[2])),u(h(u(h(a(Le,oe),w[1]),u(h(a(Ae,B),-T[1]),h(a(ae,U),M[1]))),L[2]),h(u(h(a(pe,ce),w[1]),u(h(a(Se,ee),-T[1]),h(a(ae,U),L[1]))),-M[2]))),_[3]),u(h(u(u(h(u(h(a(Me,ge),T[1]),u(h(a(Le,oe),-L[1]),h(a(pe,ce),M[1]))),_[2]),h(u(h(a(Me,ge),_[1]),u(h(a(se,D),-L[1]),h(a(fe,R),M[1]))),-T[2])),u(h(u(h(a(Le,oe),_[1]),u(h(a(se,D),-T[1]),h(a(J,C),M[1]))),L[2]),h(u(h(a(pe,ce),_[1]),u(h(a(fe,R),-T[1]),h(a(J,C),L[1]))),-M[2]))),-w[3]),h(u(u(h(u(h(a(Me,ge),w[1]),u(h(a(Ae,B),-L[1]),h(a(Se,ee),M[1]))),_[2]),h(u(h(a(Me,ge),_[1]),u(h(a(se,D),-L[1]),h(a(fe,R),M[1]))),-w[2])),u(h(u(h(a(Ae,B),_[1]),u(h(a(se,D),-w[1]),h(a(V,S),M[1]))),L[2]),h(u(h(a(Se,ee),_[1]),u(h(a(fe,R),-w[1]),h(a(V,S),L[1]))),-M[2]))),T[3]))),u(u(h(u(u(h(u(h(a(Le,oe),w[1]),u(h(a(Ae,B),-T[1]),h(a(ae,U),M[1]))),_[2]),h(u(h(a(Le,oe),_[1]),u(h(a(se,D),-T[1]),h(a(J,C),M[1]))),-w[2])),u(h(u(h(a(Ae,B),_[1]),u(h(a(se,D),-w[1]),h(a(V,S),M[1]))),T[2]),h(u(h(a(ae,U),_[1]),u(h(a(J,C),-w[1]),h(a(V,S),T[1]))),-M[2]))),-L[3]),h(u(u(h(u(h(a(pe,ce),w[1]),u(h(a(Se,ee),-T[1]),h(a(ae,U),L[1]))),_[2]),h(u(h(a(pe,ce),_[1]),u(h(a(fe,R),-T[1]),h(a(J,C),L[1]))),-w[2])),u(h(u(h(a(Se,ee),_[1]),u(h(a(fe,R),-w[1]),h(a(V,S),L[1]))),T[2]),h(u(h(a(ae,U),_[1]),u(h(a(J,C),-w[1]),h(a(V,S),T[1]))),-L[2]))),M[3])),u(h(u(u(h(u(h(a(Me,ge),w[1]),u(h(a(Ae,B),-L[1]),h(a(Se,ee),M[1]))),b[2]),h(u(h(a(Me,ge),b[1]),u(h(a(de,X),-L[1]),h(a(xe,G),M[1]))),-w[2])),u(h(u(h(a(Ae,B),b[1]),u(h(a(de,X),-w[1]),h(a(N,Z),M[1]))),L[2]),h(u(h(a(Se,ee),b[1]),u(h(a(xe,G),-w[1]),h(a(N,Z),L[1]))),-M[2]))),_[3]),h(u(u(h(u(h(a(Me,ge),w[1]),u(h(a(Ae,B),-L[1]),h(a(Se,ee),M[1]))),_[2]),h(u(h(a(Me,ge),_[1]),u(h(a(se,D),-L[1]),h(a(fe,R),M[1]))),-w[2])),u(h(u(h(a(Ae,B),_[1]),u(h(a(se,D),-w[1]),h(a(V,S),M[1]))),L[2]),h(u(h(a(Se,ee),_[1]),u(h(a(fe,R),-w[1]),h(a(V,S),L[1]))),-M[2]))),-b[3])))),u(u(u(h(u(u(h(u(h(a(Me,ge),b[1]),u(h(a(de,X),-L[1]),h(a(xe,G),M[1]))),_[2]),h(u(h(a(Me,ge),_[1]),u(h(a(se,D),-L[1]),h(a(fe,R),M[1]))),-b[2])),u(h(u(h(a(de,X),_[1]),u(h(a(se,D),-b[1]),h(a(q,z),M[1]))),L[2]),h(u(h(a(xe,G),_[1]),u(h(a(fe,R),-b[1]),h(a(q,z),L[1]))),-M[2]))),w[3]),h(u(u(h(u(h(a(Ae,B),b[1]),u(h(a(de,X),-w[1]),h(a(N,Z),M[1]))),_[2]),h(u(h(a(Ae,B),_[1]),u(h(a(se,D),-w[1]),h(a(V,S),M[1]))),-b[2])),u(h(u(h(a(de,X),_[1]),u(h(a(se,D),-b[1]),h(a(q,z),M[1]))),w[2]),h(u(h(a(N,Z),_[1]),u(h(a(V,S),-b[1]),h(a(q,z),w[1]))),-M[2]))),-L[3])),u(h(u(u(h(u(h(a(Se,ee),b[1]),u(h(a(xe,G),-w[1]),h(a(N,Z),L[1]))),_[2]),h(u(h(a(Se,ee),_[1]),u(h(a(fe,R),-w[1]),h(a(V,S),L[1]))),-b[2])),u(h(u(h(a(xe,G),_[1]),u(h(a(fe,R),-b[1]),h(a(q,z),L[1]))),w[2]),h(u(h(a(N,Z),_[1]),u(h(a(V,S),-b[1]),h(a(q,z),w[1]))),-L[2]))),M[3]),h(u(u(h(u(h(a(pe,ce),w[1]),u(h(a(Se,ee),-T[1]),h(a(ae,U),L[1]))),b[2]),h(u(h(a(pe,ce),b[1]),u(h(a(xe,G),-T[1]),h(a(te,W),L[1]))),-w[2])),u(h(u(h(a(Se,ee),b[1]),u(h(a(xe,G),-w[1]),h(a(N,Z),L[1]))),T[2]),h(u(h(a(ae,U),b[1]),u(h(a(te,W),-w[1]),h(a(N,Z),T[1]))),-L[2]))),_[3]))),u(u(h(u(u(h(u(h(a(pe,ce),w[1]),u(h(a(Se,ee),-T[1]),h(a(ae,U),L[1]))),_[2]),h(u(h(a(pe,ce),_[1]),u(h(a(fe,R),-T[1]),h(a(J,C),L[1]))),-w[2])),u(h(u(h(a(Se,ee),_[1]),u(h(a(fe,R),-w[1]),h(a(V,S),L[1]))),T[2]),h(u(h(a(ae,U),_[1]),u(h(a(J,C),-w[1]),h(a(V,S),T[1]))),-L[2]))),-b[3]),h(u(u(h(u(h(a(pe,ce),b[1]),u(h(a(xe,G),-T[1]),h(a(te,W),L[1]))),_[2]),h(u(h(a(pe,ce),_[1]),u(h(a(fe,R),-T[1]),h(a(J,C),L[1]))),-b[2])),u(h(u(h(a(xe,G),_[1]),u(h(a(fe,R),-b[1]),h(a(q,z),L[1]))),T[2]),h(u(h(a(te,W),_[1]),u(h(a(J,C),-b[1]),h(a(q,z),T[1]))),-L[2]))),w[3])),u(h(u(u(h(u(h(a(Se,ee),b[1]),u(h(a(xe,G),-w[1]),h(a(N,Z),L[1]))),_[2]),h(u(h(a(Se,ee),_[1]),u(h(a(fe,R),-w[1]),h(a(V,S),L[1]))),-b[2])),u(h(u(h(a(xe,G),_[1]),u(h(a(fe,R),-b[1]),h(a(q,z),L[1]))),w[2]),h(u(h(a(N,Z),_[1]),u(h(a(V,S),-b[1]),h(a(q,z),w[1]))),-L[2]))),-T[3]),h(u(u(h(u(h(a(ae,U),b[1]),u(h(a(te,W),-w[1]),h(a(N,Z),T[1]))),_[2]),h(u(h(a(ae,U),_[1]),u(h(a(J,C),-w[1]),h(a(V,S),T[1]))),-b[2])),u(h(u(h(a(te,W),_[1]),u(h(a(J,C),-b[1]),h(a(q,z),T[1]))),w[2]),h(u(h(a(N,Z),_[1]),u(h(a(V,S),-b[1]),h(a(q,z),w[1]))),-T[2]))),L[3]))))),Ie=a(De,Oe);return Ie[Ie.length-1]}}var l=[function(){return 0},function(){return 0},function(){return 0}];function o(u){var a=l[u.length];return a||(a=l[u.length]=n(u.length)),a.apply(void 0,u)}function d(u,a,y,h,_,b,w,T){return function(L,M,P,z,S,C){switch(arguments.length){case 0:case 1:return 0;case 2:return h(L,M);case 3:return _(L,M,P);case 4:return b(L,M,P,z);case 5:return w(L,M,P,z,S);case 6:return T(L,M,P,z,S,C)}for(var R=new Array(arguments.length),D=0;D<arguments.length;++D)R[D]=arguments[D];return u(R)}}!function(){for(;l.length<=6;)l.push(n(l.length));k.exports=d.apply(void 0,[o].concat(l));for(var u=0;u<=6;++u)k.exports[u]=l[u]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(t,k,x){"use strict";var e=t("robust-determinant");function r(l){return(2===l?i:3===l?c:4===l?n:5===l?m:p)(l<6?e[l]:e)}function i(l){return function(o,d){return[l([[+d[0],+o[0][1]],[+d[1],+o[1][1]]]),l([[+o[0][0],+d[0]],[+o[1][0],+d[1]]]),l(o)]}}function c(l){return function(o,d){return[l([[+d[0],+o[0][1],+o[0][2]],[+d[1],+o[1][1],+o[1][2]],[+d[2],+o[2][1],+o[2][2]]]),l([[+o[0][0],+d[0],+o[0][2]],[+o[1][0],+d[1],+o[1][2]],[+o[2][0],+d[2],+o[2][2]]]),l([[+o[0][0],+o[0][1],+d[0]],[+o[1][0],+o[1][1],+d[1]],[+o[2][0],+o[2][1],+d[2]]]),l(o)]}}function n(l){return function(o,d){return[l([[+d[0],+o[0][1],+o[0][2],+o[0][3]],[+d[1],+o[1][1],+o[1][2],+o[1][3]],[+d[2],+o[2][1],+o[2][2],+o[2][3]],[+d[3],+o[3][1],+o[3][2],+o[3][3]]]),l([[+o[0][0],+d[0],+o[0][2],+o[0][3]],[+o[1][0],+d[1],+o[1][2],+o[1][3]],[+o[2][0],+d[2],+o[2][2],+o[2][3]],[+o[3][0],+d[3],+o[3][2],+o[3][3]]]),l([[+o[0][0],+o[0][1],+d[0],+o[0][3]],[+o[1][0],+o[1][1],+d[1],+o[1][3]],[+o[2][0],+o[2][1],+d[2],+o[2][3]],[+o[3][0],+o[3][1],+d[3],+o[3][3]]]),l([[+o[0][0],+o[0][1],+o[0][2],+d[0]],[+o[1][0],+o[1][1],+o[1][2],+d[1]],[+o[2][0],+o[2][1],+o[2][2],+d[2]],[+o[3][0],+o[3][1],+o[3][2],+d[3]]]),l(o)]}}function m(l){return function(o,d){return[l([[+d[0],+o[0][1],+o[0][2],+o[0][3],+o[0][4]],[+d[1],+o[1][1],+o[1][2],+o[1][3],+o[1][4]],[+d[2],+o[2][1],+o[2][2],+o[2][3],+o[2][4]],[+d[3],+o[3][1],+o[3][2],+o[3][3],+o[3][4]],[+d[4],+o[4][1],+o[4][2],+o[4][3],+o[4][4]]]),l([[+o[0][0],+d[0],+o[0][2],+o[0][3],+o[0][4]],[+o[1][0],+d[1],+o[1][2],+o[1][3],+o[1][4]],[+o[2][0],+d[2],+o[2][2],+o[2][3],+o[2][4]],[+o[3][0],+d[3],+o[3][2],+o[3][3],+o[3][4]],[+o[4][0],+d[4],+o[4][2],+o[4][3],+o[4][4]]]),l([[+o[0][0],+o[0][1],+d[0],+o[0][3],+o[0][4]],[+o[1][0],+o[1][1],+d[1],+o[1][3],+o[1][4]],[+o[2][0],+o[2][1],+d[2],+o[2][3],+o[2][4]],[+o[3][0],+o[3][1],+d[3],+o[3][3],+o[3][4]],[+o[4][0],+o[4][1],+d[4],+o[4][3],+o[4][4]]]),l([[+o[0][0],+o[0][1],+o[0][2],+d[0],+o[0][4]],[+o[1][0],+o[1][1],+o[1][2],+d[1],+o[1][4]],[+o[2][0],+o[2][1],+o[2][2],+d[2],+o[2][4]],[+o[3][0],+o[3][1],+o[3][2],+d[3],+o[3][4]],[+o[4][0],+o[4][1],+o[4][2],+d[4],+o[4][4]]]),l([[+o[0][0],+o[0][1],+o[0][2],+o[0][3],+d[0]],[+o[1][0],+o[1][1],+o[1][2],+o[1][3],+d[1]],[+o[2][0],+o[2][1],+o[2][2],+o[2][3],+d[2]],[+o[3][0],+o[3][1],+o[3][2],+o[3][3],+d[3]],[+o[4][0],+o[4][1],+o[4][2],+o[4][3],+d[4]]]),l(o)]}}function p(l){return function(o,d){return[l([[+d[0],+o[0][1],+o[0][2],+o[0][3],+o[0][4],+o[0][5]],[+d[1],+o[1][1],+o[1][2],+o[1][3],+o[1][4],+o[1][5]],[+d[2],+o[2][1],+o[2][2],+o[2][3],+o[2][4],+o[2][5]],[+d[3],+o[3][1],+o[3][2],+o[3][3],+o[3][4],+o[3][5]],[+d[4],+o[4][1],+o[4][2],+o[4][3],+o[4][4],+o[4][5]],[+d[5],+o[5][1],+o[5][2],+o[5][3],+o[5][4],+o[5][5]]]),l([[+o[0][0],+d[0],+o[0][2],+o[0][3],+o[0][4],+o[0][5]],[+o[1][0],+d[1],+o[1][2],+o[1][3],+o[1][4],+o[1][5]],[+o[2][0],+d[2],+o[2][2],+o[2][3],+o[2][4],+o[2][5]],[+o[3][0],+d[3],+o[3][2],+o[3][3],+o[3][4],+o[3][5]],[+o[4][0],+d[4],+o[4][2],+o[4][3],+o[4][4],+o[4][5]],[+o[5][0],+d[5],+o[5][2],+o[5][3],+o[5][4],+o[5][5]]]),l([[+o[0][0],+o[0][1],+d[0],+o[0][3],+o[0][4],+o[0][5]],[+o[1][0],+o[1][1],+d[1],+o[1][3],+o[1][4],+o[1][5]],[+o[2][0],+o[2][1],+d[2],+o[2][3],+o[2][4],+o[2][5]],[+o[3][0],+o[3][1],+d[3],+o[3][3],+o[3][4],+o[3][5]],[+o[4][0],+o[4][1],+d[4],+o[4][3],+o[4][4],+o[4][5]],[+o[5][0],+o[5][1],+d[5],+o[5][3],+o[5][4],+o[5][5]]]),l([[+o[0][0],+o[0][1],+o[0][2],+d[0],+o[0][4],+o[0][5]],[+o[1][0],+o[1][1],+o[1][2],+d[1],+o[1][4],+o[1][5]],[+o[2][0],+o[2][1],+o[2][2],+d[2],+o[2][4],+o[2][5]],[+o[3][0],+o[3][1],+o[3][2],+d[3],+o[3][4],+o[3][5]],[+o[4][0],+o[4][1],+o[4][2],+d[4],+o[4][4],+o[4][5]],[+o[5][0],+o[5][1],+o[5][2],+d[5],+o[5][4],+o[5][5]]]),l([[+o[0][0],+o[0][1],+o[0][2],+o[0][3],+d[0],+o[0][5]],[+o[1][0],+o[1][1],+o[1][2],+o[1][3],+d[1],+o[1][5]],[+o[2][0],+o[2][1],+o[2][2],+o[2][3],+d[2],+o[2][5]],[+o[3][0],+o[3][1],+o[3][2],+o[3][3],+d[3],+o[3][5]],[+o[4][0],+o[4][1],+o[4][2],+o[4][3],+d[4],+o[4][5]],[+o[5][0],+o[5][1],+o[5][2],+o[5][3],+d[5],+o[5][5]]]),l([[+o[0][0],+o[0][1],+o[0][2],+o[0][3],+o[0][4],+d[0]],[+o[1][0],+o[1][1],+o[1][2],+o[1][3],+o[1][4],+d[1]],[+o[2][0],+o[2][1],+o[2][2],+o[2][3],+o[2][4],+d[2]],[+o[3][0],+o[3][1],+o[3][2],+o[3][3],+o[3][4],+d[3]],[+o[4][0],+o[4][1],+o[4][2],+o[4][3],+o[4][4],+d[4]],[+o[5][0],+o[5][1],+o[5][2],+o[5][3],+o[5][4],+d[5]]]),l(o)]}}var s=[function(){return[[0]]},function(l,o){return[[o[0]],[l[0][0]]]}];function f(l,o,d,u,a,y,h,_){return function(b,w){switch(b.length){case 0:return l(b,w);case 1:return o(b,w);case 2:return d(b,w);case 3:return u(b,w);case 4:return a(b,w);case 5:return y(b,w)}var T=h[b.length];return T||(T=h[b.length]=_(b.length)),T(b,w)}}!function(){for(;s.length<6;)s.push(r(s.length));k.exports=f.apply(void 0,s.concat([s,r]));for(var l=0;l<6;++l)k.exports[l]=s[l]}()},{"robust-determinant":280}],284:[function(t,k,x){"use strict";var e=t("two-product"),r=t("robust-sum"),i=t("robust-scale"),c=t("robust-subtract");function n(a,y,h,_){return function(b,w,T){var L=a(a(y(w[1],T[0]),y(-T[1],w[0])),a(y(b[1],w[0]),y(-w[1],b[0]))),M=a(y(b[1],T[0]),y(-T[1],b[0])),P=_(L,M);return P[P.length-1]}}function m(a,y,h,_){return function(b,w,T,L){var M=a(a(h(a(y(T[1],L[0]),y(-L[1],T[0])),w[2]),a(h(a(y(w[1],L[0]),y(-L[1],w[0])),-T[2]),h(a(y(w[1],T[0]),y(-T[1],w[0])),L[2]))),a(h(a(y(w[1],L[0]),y(-L[1],w[0])),b[2]),a(h(a(y(b[1],L[0]),y(-L[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),L[2])))),P=a(a(h(a(y(T[1],L[0]),y(-L[1],T[0])),b[2]),a(h(a(y(b[1],L[0]),y(-L[1],b[0])),-T[2]),h(a(y(b[1],T[0]),y(-T[1],b[0])),L[2]))),a(h(a(y(w[1],T[0]),y(-T[1],w[0])),b[2]),a(h(a(y(b[1],T[0]),y(-T[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),T[2])))),z=_(M,P);return z[z.length-1]}}function p(a,y,h,_){return function(b,w,T,L,M){var P=a(a(a(h(a(h(a(y(L[1],M[0]),y(-M[1],L[0])),T[2]),a(h(a(y(T[1],M[0]),y(-M[1],T[0])),-L[2]),h(a(y(T[1],L[0]),y(-L[1],T[0])),M[2]))),w[3]),a(h(a(h(a(y(L[1],M[0]),y(-M[1],L[0])),w[2]),a(h(a(y(w[1],M[0]),y(-M[1],w[0])),-L[2]),h(a(y(w[1],L[0]),y(-L[1],w[0])),M[2]))),-T[3]),h(a(h(a(y(T[1],M[0]),y(-M[1],T[0])),w[2]),a(h(a(y(w[1],M[0]),y(-M[1],w[0])),-T[2]),h(a(y(w[1],T[0]),y(-T[1],w[0])),M[2]))),L[3]))),a(h(a(h(a(y(T[1],L[0]),y(-L[1],T[0])),w[2]),a(h(a(y(w[1],L[0]),y(-L[1],w[0])),-T[2]),h(a(y(w[1],T[0]),y(-T[1],w[0])),L[2]))),-M[3]),a(h(a(h(a(y(L[1],M[0]),y(-M[1],L[0])),w[2]),a(h(a(y(w[1],M[0]),y(-M[1],w[0])),-L[2]),h(a(y(w[1],L[0]),y(-L[1],w[0])),M[2]))),b[3]),h(a(h(a(y(L[1],M[0]),y(-M[1],L[0])),b[2]),a(h(a(y(b[1],M[0]),y(-M[1],b[0])),-L[2]),h(a(y(b[1],L[0]),y(-L[1],b[0])),M[2]))),-w[3])))),a(a(h(a(h(a(y(w[1],M[0]),y(-M[1],w[0])),b[2]),a(h(a(y(b[1],M[0]),y(-M[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),M[2]))),L[3]),a(h(a(h(a(y(w[1],L[0]),y(-L[1],w[0])),b[2]),a(h(a(y(b[1],L[0]),y(-L[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),L[2]))),-M[3]),h(a(h(a(y(T[1],L[0]),y(-L[1],T[0])),w[2]),a(h(a(y(w[1],L[0]),y(-L[1],w[0])),-T[2]),h(a(y(w[1],T[0]),y(-T[1],w[0])),L[2]))),b[3]))),a(h(a(h(a(y(T[1],L[0]),y(-L[1],T[0])),b[2]),a(h(a(y(b[1],L[0]),y(-L[1],b[0])),-T[2]),h(a(y(b[1],T[0]),y(-T[1],b[0])),L[2]))),-w[3]),a(h(a(h(a(y(w[1],L[0]),y(-L[1],w[0])),b[2]),a(h(a(y(b[1],L[0]),y(-L[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),L[2]))),T[3]),h(a(h(a(y(w[1],T[0]),y(-T[1],w[0])),b[2]),a(h(a(y(b[1],T[0]),y(-T[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),T[2]))),-L[3]))))),z=a(a(a(h(a(h(a(y(L[1],M[0]),y(-M[1],L[0])),T[2]),a(h(a(y(T[1],M[0]),y(-M[1],T[0])),-L[2]),h(a(y(T[1],L[0]),y(-L[1],T[0])),M[2]))),b[3]),h(a(h(a(y(L[1],M[0]),y(-M[1],L[0])),b[2]),a(h(a(y(b[1],M[0]),y(-M[1],b[0])),-L[2]),h(a(y(b[1],L[0]),y(-L[1],b[0])),M[2]))),-T[3])),a(h(a(h(a(y(T[1],M[0]),y(-M[1],T[0])),b[2]),a(h(a(y(b[1],M[0]),y(-M[1],b[0])),-T[2]),h(a(y(b[1],T[0]),y(-T[1],b[0])),M[2]))),L[3]),h(a(h(a(y(T[1],L[0]),y(-L[1],T[0])),b[2]),a(h(a(y(b[1],L[0]),y(-L[1],b[0])),-T[2]),h(a(y(b[1],T[0]),y(-T[1],b[0])),L[2]))),-M[3]))),a(a(h(a(h(a(y(T[1],M[0]),y(-M[1],T[0])),w[2]),a(h(a(y(w[1],M[0]),y(-M[1],w[0])),-T[2]),h(a(y(w[1],T[0]),y(-T[1],w[0])),M[2]))),b[3]),h(a(h(a(y(T[1],M[0]),y(-M[1],T[0])),b[2]),a(h(a(y(b[1],M[0]),y(-M[1],b[0])),-T[2]),h(a(y(b[1],T[0]),y(-T[1],b[0])),M[2]))),-w[3])),a(h(a(h(a(y(w[1],M[0]),y(-M[1],w[0])),b[2]),a(h(a(y(b[1],M[0]),y(-M[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),M[2]))),T[3]),h(a(h(a(y(w[1],T[0]),y(-T[1],w[0])),b[2]),a(h(a(y(b[1],T[0]),y(-T[1],b[0])),-w[2]),h(a(y(b[1],w[0]),y(-w[1],b[0])),T[2]))),-M[3])))),S=_(P,z);return S[S.length-1]}}function s(a){return(3===a?n:4===a?m:p)(r,e,i,c)}var f=s(3),l=s(4),o=[function(){return 0},function(){return 0},function(a,y){return y[0]-a[0]},function(a,y,h){var _,b=(a[1]-h[1])*(y[0]-h[0]),w=(a[0]-h[0])*(y[1]-h[1]),T=b-w;if(b>0){if(w<=0)return T;_=b+w}else{if(!(b<0)||w>=0)return T;_=-(b+w)}var L=33306690738754716e-32*_;return T>=L||T<=-L?T:f(a,y,h)},function(a,y,h,_){var b=a[0]-_[0],w=y[0]-_[0],T=h[0]-_[0],L=a[1]-_[1],M=y[1]-_[1],P=h[1]-_[1],z=a[2]-_[2],S=y[2]-_[2],C=h[2]-_[2],R=w*P,D=T*M,j=T*L,q=b*P,Z=b*M,W=w*L,G=z*(R-D)+S*(j-q)+C*(Z-W),X=7771561172376103e-31*((Math.abs(R)+Math.abs(D))*Math.abs(z)+(Math.abs(j)+Math.abs(q))*Math.abs(S)+(Math.abs(Z)+Math.abs(W))*Math.abs(C));return G>X||-G>X?G:l(a,y,h,_)}];function d(a){var y=o[a.length];return y||(y=o[a.length]=s(a.length)),y.apply(void 0,a)}function u(a,y,h,_,b,w,T){return function(L,M,P,z,S){switch(arguments.length){case 0:case 1:return 0;case 2:return _(L,M);case 3:return b(L,M,P);case 4:return w(L,M,P,z);case 5:return T(L,M,P,z,S)}for(var C=new Array(arguments.length),R=0;R<arguments.length;++R)C[R]=arguments[R];return a(C)}}!function(){for(;o.length<=5;)o.push(s(o.length));k.exports=u.apply(void 0,[d].concat(o));for(var a=0;a<=5;++a)k.exports[a]=o[a]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(t,k,x){"use strict";var e=t("robust-sum"),r=t("robust-scale");k.exports=function(i,c){if(1===i.length)return r(c,i[0]);if(1===c.length)return r(i,c[0]);if(0===i.length||0===c.length)return[0];var n=[0];if(i.length<c.length)for(var m=0;m<i.length;++m)n=e(n,r(c,i[m]));else for(m=0;m<c.length;++m)n=e(n,r(i,c[m]));return n}},{"robust-scale":286,"robust-sum":289}],286:[function(t,k,x){"use strict";var e=t("two-product"),r=t("two-sum");k.exports=function(i,c){var n=i.length;if(1===n){var m=e(i[0],c);return m[0]?m:[m[1]]}var p=new Array(2*n),s=[.1,.1],f=[.1,.1],l=0;e(i[0],c,s),s[0]&&(p[l++]=s[0]);for(var o=1;o<n;++o){e(i[o],c,f),r(s[1],f[0],s),s[0]&&(p[l++]=s[0]);var u=f[1],a=s[1],y=u+a,h=a-(y-u);s[1]=y,h&&(p[l++]=h)}return s[1]&&(p[l++]=s[1]),0===l&&(p[l++]=0),p.length=l,p}},{"two-product":306,"two-sum":307}],287:[function(t,k,x){"use strict";k.exports=function(r,i,c,n){var m=e(r,c,n),p=e(i,c,n);if(m>0&&p>0||m<0&&p<0)return!1;var s=e(c,r,i),f=e(n,r,i);return!(s>0&&f>0||s<0&&f<0)&&(0!==m||0!==p||0!==s||0!==f||function(l,o,d,u){for(var a=0;a<2;++a){var y=l[a],h=o[a],_=Math.min(y,h),b=Math.max(y,h),w=d[a],T=u[a],L=Math.min(w,T);if(Math.max(w,T)<_||b<L)return!1}return!0}(r,i,c,n))};var e=t("robust-orientation")[3]},{"robust-orientation":284}],288:[function(t,k,x){"use strict";k.exports=function(e,r){var P,z,S,C,R,i=0|e.length,c=0|r.length;if(1===i&&1===c)return(R=(P=e[0])-((S=P+(z=-r[0]))-(C=S-P))+(z-C))?[R,S]:[S];var n,m,p=new Array(i+c),s=0,f=0,l=0,o=Math.abs,d=e[f],u=o(d),a=-r[l],y=o(a);u<y?(m=d,(f+=1)<i&&(u=o(d=e[f]))):(m=a,(l+=1)<c&&(y=o(a=-r[l]))),f<i&&u<y||l>=c?(n=d,(f+=1)<i&&(u=o(d=e[f]))):(n=a,(l+=1)<c&&(y=o(a=-r[l])));for(var h,_,b=n+m,w=b-n,T=m-w,L=T,M=b;f<i&&l<c;)u<y?(n=d,(f+=1)<i&&(u=o(d=e[f]))):(n=a,(l+=1)<c&&(y=o(a=-r[l]))),(T=(m=L)-(w=(b=n+m)-n))&&(p[s++]=T),L=M-((h=M+b)-(_=h-M))+(b-_),M=h;for(;f<i;)(T=(m=L)-(w=(b=(n=d)+m)-n))&&(p[s++]=T),L=M-((h=M+b)-(_=h-M))+(b-_),M=h,(f+=1)<i&&(d=e[f]);for(;l<c;)(T=(m=L)-(w=(b=(n=a)+m)-n))&&(p[s++]=T),L=M-((h=M+b)-(_=h-M))+(b-_),M=h,(l+=1)<c&&(a=-r[l]);return L&&(p[s++]=L),M&&(p[s++]=M),s||(p[s++]=0),p.length=s,p}},{}],289:[function(t,k,x){"use strict";k.exports=function(e,r){var P,z,S,C,R,i=0|e.length,c=0|r.length;if(1===i&&1===c)return(R=(P=e[0])-((S=P+(z=r[0]))-(C=S-P))+(z-C))?[R,S]:[S];var n,m,p=new Array(i+c),s=0,f=0,l=0,o=Math.abs,d=e[f],u=o(d),a=r[l],y=o(a);u<y?(m=d,(f+=1)<i&&(u=o(d=e[f]))):(m=a,(l+=1)<c&&(y=o(a=r[l]))),f<i&&u<y||l>=c?(n=d,(f+=1)<i&&(u=o(d=e[f]))):(n=a,(l+=1)<c&&(y=o(a=r[l])));for(var h,_,b=n+m,w=b-n,T=m-w,L=T,M=b;f<i&&l<c;)u<y?(n=d,(f+=1)<i&&(u=o(d=e[f]))):(n=a,(l+=1)<c&&(y=o(a=r[l]))),(T=(m=L)-(w=(b=n+m)-n))&&(p[s++]=T),L=M-((h=M+b)-(_=h-M))+(b-_),M=h;for(;f<i;)(T=(m=L)-(w=(b=(n=d)+m)-n))&&(p[s++]=T),L=M-((h=M+b)-(_=h-M))+(b-_),M=h,(f+=1)<i&&(d=e[f]);for(;l<c;)(T=(m=L)-(w=(b=(n=a)+m)-n))&&(p[s++]=T),L=M-((h=M+b)-(_=h-M))+(b-_),M=h,(l+=1)<c&&(a=r[l]);return L&&(p[s++]=L),M&&(p[s++]=M),s||(p[s++]=0),p.length=s,p}},{}],290:[function(t,k,x){"use strict";k.exports=function(i){return r(e(i))};var e=t("boundary-cells"),r=t("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(t,k,x){"use strict";k.exports=function(n,m,p,s){if(p=p||0,void 0===s&&(s=function(h){for(var _=h.length,b=0,w=0;w<_;++w)b=0|Math.max(b,h[w].length);return b-1}(n)),0===n.length||s<1)return{cells:[],vertexIds:[],vertexWeights:[]};var f=function(h,_){for(var b=h.length,w=r.mallocUint8(b),T=0;T<b;++T)w[T]=h[T]<_|0;return w}(m,+p),l=function(h,_){for(var b=h.length,T=r.mallocUint32(2*(_*(_+1)/2*b|0)),L=0,M=0;M<b;++M)for(var P=h[M],z=(_=P.length,0);z<_;++z)for(var S=0;S<z;++S){var C=P[S],R=P[z];T[L++]=0|Math.min(C,R),T[L++]=0|Math.max(C,R)}i(e(T,[L/2|0,2]));var D=2;for(M=2;M<L;M+=2)T[M-2]===T[M]&&T[M-1]===T[M+1]||(T[D++]=T[M],T[D++]=T[M+1]);return e(T,[D/2|0,2])}(n,s),o=function(h,_,b,w){for(var T=h.data,L=h.shape[0],M=r.mallocDouble(L),P=0,z=0;z<L;++z){var S=T[2*z],C=T[2*z+1];if(b[S]!==b[C]){var R=_[S],D=_[C];T[2*P]=S,T[2*P+1]=C,M[P++]=(D-w)/(D-R)}}return h.shape[0]=P,e(M,[P])}(l,m,f,+p),d=function(h,_){var b=r.mallocInt32(2*_),w=h.shape[0],T=h.data;b[0]=0;for(var L=0,M=0;M<w;++M){var P=T[2*M];if(P!==L){for(b[2*L+1]=M;++L<P;)b[2*L]=M,b[2*L+1]=M;b[2*L]=M}}for(b[2*L+1]=w;++L<_;)b[2*L]=b[2*L+1]=w;return b}(l,0|m.length),u=c(s)(n,l.data,d,f),a=function(h){for(var _=0|h.shape[0],b=h.data,w=new Array(_),T=0;T<_;++T)w[T]=[b[2*T],b[2*T+1]];return w}(l),y=[].slice.call(o.data,0,o.shape[0]);return r.free(f),r.free(l.data),r.free(o.data),r.free(d),{cells:u,vertexIds:a,vertexWeights:y}};var e=t("ndarray"),r=t("typedarray-pool"),i=t("ndarray-sort"),c=t("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(t,k,x){"use strict";k.exports=function(r){return e[r]()};var e=[function(){return function(r,i,c,n){for(var m=r.length,p=0;p<m;++p);return[]}},function(){function r(i,c,n,m){for(var p=0|Math.min(n,m),s=0|Math.max(n,m),f=i[2*p],l=i[2*p+1];f<l;){var o=f+l>>1,d=c[2*o+1];if(d===s)return o;s<d?l=o:f=o+1}return f}return function(i,c,n,m){for(var p=i.length,s=[],f=0;f<p;++f){var l=i[f];if(2===l.length){var o=(m[l[0]]<<0)+(m[l[1]]<<1);if(0===o||3===o)continue;switch(o){case 0:break;case 1:s.push([r(n,c,l[0],l[1])]);break;case 2:s.push([r(n,c,l[1],l[0])])}}}return s}},function(){function r(i,c,n,m){for(var p=0|Math.min(n,m),s=0|Math.max(n,m),f=i[2*p],l=i[2*p+1];f<l;){var o=f+l>>1,d=c[2*o+1];if(d===s)return o;s<d?l=o:f=o+1}return f}return function(i,c,n,m){for(var p=i.length,s=[],f=0;f<p;++f){var l=i[f],o=l.length;if(3===o){if(0==(d=(m[l[0]]<<0)+(m[l[1]]<<1)+(m[l[2]]<<2))||7===d)continue;switch(d){case 0:break;case 1:s.push([r(n,c,l[0],l[2]),r(n,c,l[0],l[1])]);break;case 2:s.push([r(n,c,l[1],l[0]),r(n,c,l[1],l[2])]);break;case 3:s.push([r(n,c,l[0],l[2]),r(n,c,l[1],l[2])]);break;case 4:s.push([r(n,c,l[2],l[1]),r(n,c,l[2],l[0])]);break;case 5:s.push([r(n,c,l[2],l[1]),r(n,c,l[0],l[1])]);break;case 6:s.push([r(n,c,l[1],l[0]),r(n,c,l[2],l[0])])}}else if(2===o){var d;if(0==(d=(m[l[0]]<<0)+(m[l[1]]<<1))||3===d)continue;switch(d){case 0:break;case 1:s.push([r(n,c,l[0],l[1])]);break;case 2:s.push([r(n,c,l[1],l[0])])}}}return s}},function(){function r(i,c,n,m){for(var p=0|Math.min(n,m),s=0|Math.max(n,m),f=i[2*p],l=i[2*p+1];f<l;){var o=f+l>>1,d=c[2*o+1];if(d===s)return o;s<d?l=o:f=o+1}return f}return function(i,c,n,m){for(var p=i.length,s=[],f=0;f<p;++f){var l=i[f],o=l.length;if(4===o){if(0==(d=(m[l[0]]<<0)+(m[l[1]]<<1)+(m[l[2]]<<2)+(m[l[3]]<<3))||15===d)continue;switch(d){case 0:break;case 1:s.push([r(n,c,l[0],l[1]),r(n,c,l[0],l[2]),r(n,c,l[0],l[3])]);break;case 2:s.push([r(n,c,l[1],l[2]),r(n,c,l[1],l[0]),r(n,c,l[1],l[3])]);break;case 3:s.push([r(n,c,l[1],l[2]),r(n,c,l[0],l[2]),r(n,c,l[0],l[3])],[r(n,c,l[1],l[3]),r(n,c,l[1],l[2]),r(n,c,l[0],l[3])]);break;case 4:s.push([r(n,c,l[2],l[0]),r(n,c,l[2],l[1]),r(n,c,l[2],l[3])]);break;case 5:s.push([r(n,c,l[0],l[1]),r(n,c,l[2],l[1]),r(n,c,l[0],l[3])],[r(n,c,l[2],l[1]),r(n,c,l[2],l[3]),r(n,c,l[0],l[3])]);break;case 6:s.push([r(n,c,l[2],l[0]),r(n,c,l[1],l[0]),r(n,c,l[1],l[3])],[r(n,c,l[2],l[3]),r(n,c,l[2],l[0]),r(n,c,l[1],l[3])]);break;case 7:s.push([r(n,c,l[0],l[3]),r(n,c,l[1],l[3]),r(n,c,l[2],l[3])]);break;case 8:s.push([r(n,c,l[3],l[1]),r(n,c,l[3],l[0]),r(n,c,l[3],l[2])]);break;case 9:s.push([r(n,c,l[3],l[1]),r(n,c,l[0],l[1]),r(n,c,l[0],l[2])],[r(n,c,l[3],l[2]),r(n,c,l[3],l[1]),r(n,c,l[0],l[2])]);break;case 10:s.push([r(n,c,l[1],l[0]),r(n,c,l[3],l[0]),r(n,c,l[1],l[2])],[r(n,c,l[3],l[0]),r(n,c,l[3],l[2]),r(n,c,l[1],l[2])]);break;case 11:s.push([r(n,c,l[1],l[2]),r(n,c,l[0],l[2]),r(n,c,l[3],l[2])]);break;case 12:s.push([r(n,c,l[3],l[0]),r(n,c,l[2],l[0]),r(n,c,l[2],l[1])],[r(n,c,l[3],l[1]),r(n,c,l[3],l[0]),r(n,c,l[2],l[1])]);break;case 13:s.push([r(n,c,l[0],l[1]),r(n,c,l[2],l[1]),r(n,c,l[3],l[1])]);break;case 14:s.push([r(n,c,l[2],l[0]),r(n,c,l[1],l[0]),r(n,c,l[3],l[0])])}}else if(3===o){if(0==(d=(m[l[0]]<<0)+(m[l[1]]<<1)+(m[l[2]]<<2))||7===d)continue;switch(d){case 0:break;case 1:s.push([r(n,c,l[0],l[2]),r(n,c,l[0],l[1])]);break;case 2:s.push([r(n,c,l[1],l[0]),r(n,c,l[1],l[2])]);break;case 3:s.push([r(n,c,l[0],l[2]),r(n,c,l[1],l[2])]);break;case 4:s.push([r(n,c,l[2],l[1]),r(n,c,l[2],l[0])]);break;case 5:s.push([r(n,c,l[2],l[1]),r(n,c,l[0],l[1])]);break;case 6:s.push([r(n,c,l[1],l[0]),r(n,c,l[2],l[0])])}}else if(2===o){var d;if(0==(d=(m[l[0]]<<0)+(m[l[1]]<<1))||3===d)continue;switch(d){case 0:break;case 1:s.push([r(n,c,l[0],l[1])]);break;case 2:s.push([r(n,c,l[1],l[0])])}}}return s}}]},{}],293:[function(t,k,x){"use strict";var e=t("bit-twiddle"),r=t("union-find");function i(l,o){var d=l.length,u=l.length-o.length,a=Math.min;if(u)return u;switch(d){case 0:return 0;case 1:return l[0]-o[0];case 2:return(_=l[0]+l[1]-o[0]-o[1])||a(l[0],l[1])-a(o[0],o[1]);case 3:var y=l[0]+l[1],h=o[0]+o[1];if(_=y+l[2]-(h+o[2]))return _;var _,b=a(l[0],l[1]),w=a(o[0],o[1]);return(_=a(b,l[2])-a(w,o[2]))||a(b+l[2],y)-a(w+o[2],h);default:var T=l.slice(0);T.sort();var L=o.slice(0);L.sort();for(var M=0;M<d;++M)if(u=T[M]-L[M])return u;return 0}}function c(l,o){return i(l[0],o[0])}function n(l,o){if(o){for(var d=l.length,u=new Array(d),a=0;a<d;++a)u[a]=[l[a],o[a]];for(u.sort(c),a=0;a<d;++a)l[a]=u[a][0],o[a]=u[a][1];return l}return l.sort(i),l}function m(l){if(0===l.length)return[];for(var o=1,d=l.length,u=1;u<d;++u){var a=l[u];if(i(a,l[u-1])){if(u===o){o++;continue}l[o++]=a}}return l.length=o,l}function p(l,o){for(var d=0,u=l.length-1,a=-1;d<=u;){var y=d+u>>1,h=i(l[y],o);h<=0?(0===h&&(a=y),d=y+1):h>0&&(u=y-1)}return a}function s(l,o){for(var d=new Array(l.length),u=0,a=d.length;u<a;++u)d[u]=[];for(var y=[],h=(u=0,o.length);u<h;++u)for(var _=o[u],b=_.length,w=1,T=1<<b;w<T;++w){y.length=e.popCount(w);for(var L=0,M=0;M<b;++M)w&1<<M&&(y[L++]=_[M]);var P=p(l,y);if(!(P<0))for(;d[P++].push(u),!(P>=l.length||0!==i(l[P],y)););}return d}function f(l,o){if(o<0)return[];for(var d=[],u=(1<<o+1)-1,a=0;a<l.length;++a)for(var y=l[a],h=u;h<1<<y.length;h=e.nextCombination(h)){for(var _=new Array(o+1),b=0,w=0;w<y.length;++w)h&1<<w&&(_[b++]=y[w]);d.push(_)}return n(d)}x.dimension=function(l){for(var o=0,d=Math.max,u=0,a=l.length;u<a;++u)o=d(o,l[u].length);return o-1},x.countVertices=function(l){for(var o=-1,d=Math.max,u=0,a=l.length;u<a;++u)for(var y=l[u],h=0,_=y.length;h<_;++h)o=d(o,y[h]);return o+1},x.cloneCells=function(l){for(var o=new Array(l.length),d=0,u=l.length;d<u;++d)o[d]=l[d].slice(0);return o},x.compareCells=i,x.normalize=n,x.unique=m,x.findCell=p,x.incidence=s,x.dual=function(l,o){if(!o)return s(m(f(l,0)),l);for(var d=new Array(o),u=0;u<o;++u)d[u]=[];u=0;for(var a=l.length;u<a;++u)for(var y=l[u],h=0,_=y.length;h<_;++h)d[y[h]].push(u);return d},x.explode=function(l){for(var o=[],d=0,u=l.length;d<u;++d)for(var a=l[d],y=0|a.length,h=1,_=1<<y;h<_;++h){for(var b=[],w=0;w<y;++w)h>>>w&1&&b.push(a[w]);o.push(b)}return n(o)},x.skeleton=f,x.boundary=function(l){for(var o=[],d=0,u=l.length;d<u;++d)for(var a=l[d],y=0,h=a.length;y<h;++y){for(var _=new Array(a.length-1),b=0,w=0;b<h;++b)b!==y&&(_[w++]=a[b]);o.push(_)}return n(o)},x.connectedComponents=function(l,o){return o?function(d,u){for(var a=new r(u),y=0;y<d.length;++y)for(var h=d[y],_=0;_<h.length;++_)for(var b=_+1;b<h.length;++b)a.link(h[_],h[b]);var w=[],T=a.ranks;for(y=0;y<T.length;++y)T[y]=-1;for(y=0;y<d.length;++y){var L=a.find(d[y][0]);T[L]<0?(T[L]=w.length,w.push([d[y].slice(0)])):w[T[L]].push(d[y].slice(0))}return w}(l,o):function(d){for(var u=m(n(f(d,0))),a=new r(u.length),y=0;y<d.length;++y)for(var h=d[y],_=0;_<h.length;++_)for(var b=p(u,[h[_]]),w=_+1;w<h.length;++w)a.link(b,p(u,[h[w]]));var T=[],L=a.ranks;for(y=0;y<L.length;++y)L[y]=-1;for(y=0;y<d.length;++y){var M=a.find(p(u,[d[y][0]]));L[M]<0?(L[M]=T.length,T.push([d[y].slice(0)])):T[L[M]].push(d[y].slice(0))}return T}(l)}},{"bit-twiddle":32,"union-find":309}],294:[function(t,k,x){arguments[4][32][0].apply(x,arguments)},{dup:32}],295:[function(t,k,x){arguments[4][293][0].apply(x,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(t,k,x){"use strict";function e(r){this.roots=new Array(r),this.ranks=new Array(r);for(var i=0;i<r;++i)this.roots[i]=i,this.ranks[i]=0}k.exports=e,e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var r=this.roots.length;return this.roots.push(r),this.ranks.push(0),r},e.prototype.find=function(r){for(var i=this.roots;i[r]!==r;){var c=i[r];i[r]=i[c],r=c}return r},e.prototype.link=function(r,i){var c=this.find(r),n=this.find(i);if(c!==n){var m=this.ranks,p=this.roots,s=m[c],f=m[n];s<f?p[c]=n:f<s?p[n]=c:(p[n]=c,++m[c])}}},{}],297:[function(t,k,x){"use strict";k.exports=function(i,c,n){for(var m=c.length,p=i.length,s=new Array(m),f=new Array(m),l=new Array(m),o=new Array(m),d=0;d<m;++d)s[d]=f[d]=-1,l[d]=1/0,o[d]=!1;for(d=0;d<p;++d){var u=i[d];if(2!==u.length)throw new Error("Input must be a graph");var a=u[1],y=u[0];f[y]=-1!==f[y]?-2:a,s[a]=-1!==s[a]?-2:y}function h(W){if(o[W])return 1/0;var X,ne,U=s[W],ee=f[W];return U<0||ee<0?1/0:(X=c[U],ne=c[ee],Math.abs(e(c[W],X,ne))/Math.sqrt(Math.pow(X[0]-ne[0],2)+Math.pow(X[1]-ne[1],2)))}function _(W,G){var X=S[W],ne=S[G];S[W]=ne,S[G]=X,C[X]=G,C[ne]=W}function b(W){return l[S[W]]}function w(W){return 1&W?W-1>>1:(W>>1)-1}function T(W){for(var G=b(W);;){var X=G,ne=2*W+1,V=2*(W+1),N=W;if(ne<R){var U=b(ne);U<X&&(N=ne,X=U)}if(V<R&&b(V)<X&&(N=V),N===W)return W;_(W,N),W=N}}function L(W){for(var G=b(W);W>0;){var X=w(W);if(!(X>=0&&G<b(X)))return W;_(W,X),W=X}}function M(){if(R>0){var W=S[0];return _(0,R-1),R-=1,T(0),W}return-1}function P(W,G){var X=S[W];return l[X]===G?W:(l[X]=-1/0,L(W),M(),l[X]=G,L((R+=1)-1))}function z(W){if(!o[W]){o[W]=!0;var G=s[W],X=f[W];s[X]>=0&&(s[X]=G),f[G]>=0&&(f[G]=X),C[G]>=0&&P(C[G],h(G)),C[X]>=0&&P(C[X],h(X))}}var S=[],C=new Array(m);for(d=0;d<m;++d)(l[d]=h(d))<1/0?(C[d]=S.length,S.push(d)):C[d]=-1;var R=S.length;for(d=R>>1;d>=0;--d)T(d);for(;;){var D=M();if(D<0||l[D]>n)break;z(D)}var j=[];for(d=0;d<m;++d)o[d]||(C[d]=j.length,j.push(c[d].slice()));function q(W,G){if(W[G]<0)return G;var X=G,ne=G;do{var V=W[ne];if(!o[ne]||V<0||V===ne||(V=W[ne=V],!o[ne]||V<0||V===ne))break;ne=V,X=W[X]}while(X!==ne);for(var N=G;N!==ne;N=W[N])W[N]=ne;return ne}var Z=[];return i.forEach(function(W){var G=q(s,W[0]),X=q(f,W[1]);if(G>=0&&X>=0&&G!==X){var ne=C[G],V=C[X];ne!==V&&Z.push([ne,V])}}),r.unique(r.normalize(Z)),{positions:j,edges:Z}};var e=t("robust-orientation"),r=t("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(t,k,x){"use strict";k.exports=function(i,c){var n,m,p,s;if(c[0][0]<c[1][0])n=c[0],m=c[1];else{if(!(c[0][0]>c[1][0]))return r(c,i);n=c[1],m=c[0]}if(i[0][0]<i[1][0])p=i[0],s=i[1];else{if(!(i[0][0]>i[1][0]))return-r(i,c);p=i[1],s=i[0]}var f=e(n,m,s),l=e(n,m,p);if(f<0){if(l<=0)return f}else if(f>0){if(l>=0)return f}else if(l)return l;if(f=e(s,p,m),l=e(s,p,n),f<0){if(l<=0)return f}else if(f>0){if(l>=0)return f}else if(l)return l;return m[0]-s[0]};var e=t("robust-orientation");function r(i,c){var n,m,p,s;if(c[0][0]<c[1][0])n=c[0],m=c[1];else{if(!(c[0][0]>c[1][0])){var f=Math.min(i[0][1],i[1][1]),l=Math.max(i[0][1],i[1][1]),o=Math.min(c[0][1],c[1][1]),d=Math.max(c[0][1],c[1][1]);return l<o?l-o:f>d?f-d:l-d}n=c[1],m=c[0]}i[0][1]<i[1][1]?(p=i[0],s=i[1]):(p=i[1],s=i[0]);var u=e(m,n,p);return u||(u=e(m,n,s))||s-m}},{"robust-orientation":284}],299:[function(t,k,x){"use strict";k.exports=function(l){for(var o=l.length,d=2*o,u=new Array(d),a=0;a<o;++a){var y=l[a],h=y[0][0]<y[1][0];u[2*a]=new f(y[0][0],y,h,a),u[2*a+1]=new f(y[1][0],y,!h,a)}u.sort(function(z,S){var C=z.x-S.x;return C||(C=z.create-S.create)||Math.min(z.segment[0][1],z.segment[1][1])-Math.min(S.segment[0][1],S.segment[1][1])});var _=r(c),b=[],w=[],T=[];for(a=0;a<d;){for(var L=u[a].x,M=[];a<d;){var P=u[a];if(P.x!==L)break;a+=1,P.segment[0][0]===P.x&&P.segment[1][0]===P.x?P.create&&(P.segment[0][1]<P.segment[1][1]?(M.push(new s(P.segment[0][1],P.index,!0,!0)),M.push(new s(P.segment[1][1],P.index,!1,!1))):(M.push(new s(P.segment[1][1],P.index,!0,!1)),M.push(new s(P.segment[0][1],P.index,!1,!0)))):_=P.create?_.insert(P.segment,P.index):_.remove(P.segment)}b.push(_.root),w.push(L),T.push(M)}return new n(b,w,T)};var e=t("binary-search-bounds"),r=t("functional-red-black-tree"),i=t("robust-orientation"),c=t("./lib/order-segments");function n(l,o,d){this.slabs=l,this.coordinates=o,this.horizontal=d}function m(l,o){return l.y-o}function p(l,o){for(var d=null;l;){var u,a,y=l.key;y[0][0]<y[1][0]?(u=y[0],a=y[1]):(u=y[1],a=y[0]);var h=i(u,a,o);if(h<0)l=l.left;else if(h>0)if(o[0]!==y[1][0])d=l,l=l.right;else{if(_=p(l.right,o))return _;l=l.left}else{if(o[0]!==y[1][0])return l;var _;if(_=p(l.right,o))return _;l=l.left}}return d}function s(l,o,d,u){this.y=l,this.index=o,this.start=d,this.closed=u}function f(l,o,d,u){this.x=l,this.segment=o,this.create=d,this.index=u}n.prototype.castUp=function(l){var o=e.le(this.coordinates,l[0]);if(o<0)return-1;var d=p(this.slabs[o],l),u=-1;if(d&&(u=d.value),this.coordinates[o]===l[0]){var a=null;if(d&&(a=d.key),o>0){var y=p(this.slabs[o-1],l);y&&(a?c(y.key,a)>0&&(a=y.key,u=y.value):(u=y.value,a=y.key))}var h=this.horizontal[o];if(h.length>0){var _=e.ge(h,l[1],m);if(_<h.length){var b=h[_];if(l[1]===b.y){if(b.closed)return b.index;for(;_<h.length-1&&h[_+1].y===l[1];)if((b=h[_+=1]).closed)return b.index;if(b.y===l[1]&&!b.start){if((_+=1)>=h.length)return u;b=h[_]}}if(b.start)if(a){var w=i(a[0],a[1],[l[0],b.y]);a[0][0]>a[1][0]&&(w=-w),w>0&&(u=b.index)}else u=b.index;else b.y!==l[1]&&(u=b.index)}}}return u}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(t,k,x){"use strict";var e=t("robust-dot-product"),r=t("robust-sum");function i(n,m){var p=r(e(n,m),[m[m.length-1]]);return p[p.length-1]}function c(n,m,p,s){var f=-m/(s-m);f<0?f=0:f>1&&(f=1);for(var l=1-f,o=n.length,d=new Array(o),u=0;u<o;++u)d[u]=f*n[u]+l*p[u];return d}k.exports=function(n,m){for(var p=[],s=[],f=i(n[n.length-1],m),l=n[n.length-1],o=n[0],d=0;d<n.length;++d,l=o){var u=i(o=n[d],m);if(f<0&&u>0||f>0&&u<0){var a=c(l,u,o,f);p.push(a),s.push(a.slice())}u<0?s.push(o.slice()):u>0?p.push(o.slice()):(p.push(o.slice()),s.push(o.slice())),f=u}return{positive:p,negative:s}},k.exports.positive=function(n,m){for(var p=[],s=i(n[n.length-1],m),f=n[n.length-1],l=n[0],o=0;o<n.length;++o,f=l){var d=i(l=n[o],m);(s<0&&d>0||s>0&&d<0)&&p.push(c(f,d,l,s)),d>=0&&p.push(l.slice()),s=d}return p},k.exports.negative=function(n,m){for(var p=[],s=i(n[n.length-1],m),f=n[n.length-1],l=n[0],o=0;o<n.length;++o,f=l){var d=i(l=n[o],m);(s<0&&d>0||s>0&&d<0)&&p.push(c(f,d,l,s)),d<=0&&p.push(l.slice()),s=d}return p}},{"robust-dot-product":281,"robust-sum":289}],301:[function(t,k,x){!function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(p){return c(m(p),arguments)}function i(p,s){return r.apply(null,[p].concat(s||[]))}function c(p,s){var f,l,o,d,u,a,y,h,_,b=1,w=p.length,T="";for(l=0;l<w;l++)if("string"==typeof p[l])T+=p[l];else if("object"==typeof p[l]){if((d=p[l]).keys)for(f=s[b],o=0;o<d.keys.length;o++){if(null==f)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',d.keys[o],d.keys[o-1]));f=f[d.keys[o]]}else f=d.param_no?s[d.param_no]:s[b++];if(e.not_type.test(d.type)&&e.not_primitive.test(d.type)&&f instanceof Function&&(f=f()),e.numeric_arg.test(d.type)&&"number"!=typeof f&&isNaN(f))throw new TypeError(r("[sprintf] expecting number but found %T",f));switch(e.number.test(d.type)&&(h=f>=0),d.type){case"b":f=parseInt(f,10).toString(2);break;case"c":f=String.fromCharCode(parseInt(f,10));break;case"d":case"i":f=parseInt(f,10);break;case"j":f=JSON.stringify(f,null,d.width?parseInt(d.width):0);break;case"e":f=d.precision?parseFloat(f).toExponential(d.precision):parseFloat(f).toExponential();break;case"f":f=d.precision?parseFloat(f).toFixed(d.precision):parseFloat(f);break;case"g":f=d.precision?String(Number(f.toPrecision(d.precision))):parseFloat(f);break;case"o":f=(parseInt(f,10)>>>0).toString(8);break;case"s":f=String(f),f=d.precision?f.substring(0,d.precision):f;break;case"t":f=String(!!f),f=d.precision?f.substring(0,d.precision):f;break;case"T":f=Object.prototype.toString.call(f).slice(8,-1).toLowerCase(),f=d.precision?f.substring(0,d.precision):f;break;case"u":f=parseInt(f,10)>>>0;break;case"v":f=f.valueOf(),f=d.precision?f.substring(0,d.precision):f;break;case"x":f=(parseInt(f,10)>>>0).toString(16);break;case"X":f=(parseInt(f,10)>>>0).toString(16).toUpperCase()}e.json.test(d.type)?T+=f:(!e.number.test(d.type)||h&&!d.sign?_="":(_=h?"+":"-",f=f.toString().replace(e.sign,"")),a=d.pad_char?"0"===d.pad_char?"0":d.pad_char.charAt(1):" ",y=d.width-(_+f).length,u=d.width&&y>0?a.repeat(y):"",T+=d.align?_+f+u:"0"===a?_+u+f:u+_+f)}return T}var n=Object.create(null);function m(p){if(n[p])return n[p];for(var s,f=p,l=[],o=0;f;){if(null!==(s=e.text.exec(f)))l.push(s[0]);else if(null!==(s=e.modulo.exec(f)))l.push("%");else{if(null===(s=e.placeholder.exec(f)))throw new SyntaxError("[sprintf] unexpected placeholder");if(s[2]){o|=1;var d=[],u=s[2],a=[];if(null===(a=e.key.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(d.push(a[1]);""!==(u=u.substring(a[0].length));)if(null!==(a=e.key_access.exec(u)))d.push(a[1]);else{if(null===(a=e.index_access.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");d.push(a[1])}s[2]=d}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");l.push({placeholder:s[0],param_no:s[1],keys:s[2],sign:s[3],pad_char:s[4],align:s[5],width:s[6],precision:s[7],type:s[8]})}f=f.substring(s[0].length)}return n[p]=l}void 0!==x&&(x.sprintf=r,x.vsprintf=i),"undefined"!=typeof window&&(window.sprintf=r,window.vsprintf=i)}()},{}],302:[function(t,k,x){"use strict";k.exports=function(n,m){if(n.dimension<=0)return{positions:[],cells:[]};if(1===n.dimension)return function(f,l){for(var o=r(f,l),d=o.length,u=new Array(d),a=new Array(d),y=0;y<d;++y)u[y]=[o[y]],a[y]=[y];return{positions:u,cells:a}}(n,m);var p=n.order.join()+"-"+n.dtype,s=c[p];return m=+m||0,s||(s=c[p]=function(f,l){var d=i[f.length+"d"];if(d)return d(e,f,l)}(n.order,n.dtype)),s(n,m)};var e=t("ndarray-extract-contour"),r=t("zero-crossings"),i={"2d":function(n,m,p){var s=n({order:m,scalarArguments:3,getters:"generic"===p?[0]:void 0,phase:function(f,l,o,d){return f>d|0},vertex:function(f,l,o,d,u,a,y,h,_,b,w,T,L){var M=(y<<0)+(h<<1)+(_<<2)+(b<<3)|0;if(0!==M&&15!==M)switch(M){case 0:case 15:w.push([f-.5,l-.5]);break;case 1:w.push([f-.25-.25*(d+o-2*L)/(o-d),l-.25-.25*(u+o-2*L)/(o-u)]);break;case 2:w.push([f-.75-.25*(-d-o+2*L)/(d-o),l-.25-.25*(a+d-2*L)/(d-a)]);break;case 3:w.push([f-.5,l-.5-.5*(u+o+a+d-4*L)/(o-u+d-a)]);break;case 4:w.push([f-.25-.25*(a+u-2*L)/(u-a),l-.75-.25*(-u-o+2*L)/(u-o)]);break;case 5:w.push([f-.5-.5*(d+o+a+u-4*L)/(o-d+u-a),l-.5]);break;case 6:w.push([f-.5-.25*(-d-o+a+u)/(d-o+u-a),l-.5-.25*(-u-o+a+d)/(u-o+d-a)]);break;case 7:w.push([f-.75-.25*(a+u-2*L)/(u-a),l-.75-.25*(a+d-2*L)/(d-a)]);break;case 8:w.push([f-.75-.25*(-a-u+2*L)/(a-u),l-.75-.25*(-a-d+2*L)/(a-d)]);break;case 9:w.push([f-.5-.25*(d+o+-a-u)/(o-d+a-u),l-.5-.25*(u+o+-a-d)/(o-u+a-d)]);break;case 10:w.push([f-.5-.5*(-d-o-a-u+4*L)/(d-o+a-u),l-.5]);break;case 11:w.push([f-.25-.25*(-a-u+2*L)/(a-u),l-.75-.25*(u+o-2*L)/(o-u)]);break;case 12:w.push([f-.5,l-.5-.5*(-u-o-a-d+4*L)/(u-o+a-d)]);break;case 13:w.push([f-.75-.25*(d+o-2*L)/(o-d),l-.25-.25*(-a-d+2*L)/(a-d)]);break;case 14:w.push([f-.25-.25*(-d-o+2*L)/(d-o),l-.25-.25*(-u-o+2*L)/(u-o)])}},cell:function(f,l,o,d,u,a,y,h,_){h.push(u?[f,l]:[l,f])}});return function(f,l){var o=[],d=[];return s(f,o,d,l),{positions:o,cells:d}}}},c={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(t,k,x){(function(e){(function(){"use strict";k.exports=function n(m,p,s){s=s||{};var f=c[m];f||(f=c[m]={" ":{data:new Float32Array(0),shape:.2}});var l=f[p];if(!l)if(p.length<=1||!/\d/.test(p))l=f[p]=function(L){for(var M=L.cells,P=L.positions,z=new Float32Array(6*M.length),S=0,C=0,R=0;R<M.length;++R)for(var D=M[R],j=0;j<3;++j){var q=P[D[j]];z[S++]=q[0],z[S++]=q[1]+1.4,C=Math.max(q[0],C)}return{data:z,shape:C}}(r(p,{triangles:!0,font:m,textAlign:s.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var o=p.split(/(\d|\s)/),d=new Array(o.length),u=0,a=0,y=0;y<o.length;++y)d[y]=n(m,o[y]),u+=d[y].data.length,a+=d[y].shape,y>0&&(a+=.02);var h=new Float32Array(u),_=0,b=-.5*a;for(y=0;y<d.length;++y){for(var w=d[y].data,T=0;T<w.length;T+=2)h[_++]=w[T]+b,h[_++]=w[T+1];b+=d[y].shape+.02}l=f[p]={data:h,shape:a}}return l};var r=t("vectorize-text"),i=window||e.global||{},c=i.__TEXT_CACHE||{};i.__TEXT_CACHE={}}).call(this)}).call(this,t("_process"))},{_process:5,"vectorize-text":311}],304:[function(t,k,x){"use strict";var e=t("parse-unit");function r(c,n){var m=e(getComputedStyle(c).getPropertyValue(n));return m[0]*i(m[1],c)}function i(c,n){switch(n=n||document.body,c=(c||"px").trim().toLowerCase(),n!==window&&n!==document||(n=document.body),c){case"%":return n.clientHeight/100;case"ch":case"ex":return function(m,p){var s=document.createElement("div");s.style["font-size"]="128"+m,p.appendChild(s);var f=r(s,"font-size")/128;return p.removeChild(s),f}(c,n);case"em":return r(n,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}k.exports=i},{"parse-unit":265}],305:[function(t,k,x){"use strict";k.exports=function(u){var a=(u=u||{}).center||[0,0,0],y=u.up||[0,1,0],h=u.right||f(y),_=u.radius||1,b=u.theta||0,w=u.phi||0;if(a=[].slice.call(a,0,3),y=[].slice.call(y,0,3),n(y,y),h=[].slice.call(h,0,3),n(h,h),"eye"in u){var T=u.eye,L=[T[0]-a[0],T[1]-a[1],T[2]-a[2]];c(h,L,y),p(h[0],h[1],h[2])<1e-6?h=f(y):n(h,h),_=p(L[0],L[1],L[2]);var M=m(y,L)/_,P=m(h,L)/_;w=Math.acos(M),b=Math.acos(P)}return _=Math.log(_),new l(u.zoomMin,u.zoomMax,a,y,h,_,b,w)};var e=t("filtered-vector"),r=t("gl-mat4/invert"),i=t("gl-mat4/rotate"),c=t("gl-vec3/cross"),n=t("gl-vec3/normalize"),m=t("gl-vec3/dot");function p(u,a,y){return Math.sqrt(Math.pow(u,2)+Math.pow(a,2)+Math.pow(y,2))}function s(u){return Math.min(1,Math.max(-1,u))}function f(u){var a=Math.abs(u[0]),y=Math.abs(u[1]),h=Math.abs(u[2]),_=[0,0,0];a>Math.max(y,h)?_[2]=1:y>Math.max(a,h)?_[0]=1:_[1]=1;for(var b=0,w=0,T=0;T<3;++T)b+=u[T]*u[T],w+=_[T]*u[T];for(T=0;T<3;++T)_[T]-=w/b*u[T];return n(_,_),_}function l(u,a,y,h,_,b,w,T){this.center=e(y),this.up=e(h),this.right=e(_),this.radius=e([b]),this.angle=e([w,T]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(u,a),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var o=l.prototype;o.setDistanceLimits=function(u,a){u=u>0?Math.log(u):-1/0,a=a>0?Math.log(a):1/0,a=Math.max(a,u),this.radius.bounds[0][0]=u,this.radius.bounds[1][0]=a},o.getDistanceLimits=function(u){var a=this.radius.bounds[0];return u?(u[0]=Math.exp(a[0][0]),u[1]=Math.exp(a[1][0]),u):[Math.exp(a[0][0]),Math.exp(a[1][0])]},o.recalcMatrix=function(u){this.center.curve(u),this.up.curve(u),this.right.curve(u),this.radius.curve(u),this.angle.curve(u);for(var a=this.computedUp,y=this.computedRight,h=0,_=0,b=0;b<3;++b)_+=a[b]*y[b],h+=a[b]*a[b];var w=Math.sqrt(h),T=0;for(b=0;b<3;++b)y[b]-=a[b]*_/h,T+=y[b]*y[b],a[b]/=w;var L=Math.sqrt(T);for(b=0;b<3;++b)y[b]/=L;var M=this.computedToward;c(M,a,y),n(M,M);var P=Math.exp(this.computedRadius[0]),z=this.computedAngle[0],S=this.computedAngle[1],C=Math.cos(z),R=Math.sin(z),D=Math.cos(S),j=Math.sin(S),q=this.computedCenter,Z=C*D,W=R*D,G=j,X=-C*j,ne=-R*j,V=D,N=this.computedEye,U=this.computedMatrix;for(b=0;b<3;++b){var ee=Z*y[b]+W*M[b]+G*a[b];U[4*b+1]=X*y[b]+ne*M[b]+V*a[b],U[4*b+2]=ee,U[4*b+3]=0}var B=U[1],K=U[5],J=U[9],te=U[2],ae=U[6],ce=U[10],oe=K*ce-J*ae,ve=J*te-B*ce,fe=B*ae-K*te,xe=p(oe,ve,fe);for(ve/=xe,fe/=xe,U[0]=oe/=xe,U[4]=ve,U[8]=fe,b=0;b<3;++b)N[b]=q[b]+U[2+4*b]*P;for(b=0;b<3;++b){T=0;for(var Se=0;Se<3;++Se)T+=U[b+4*Se]*N[Se];U[12+b]=-T}U[15]=1},o.getMatrix=function(u,a){this.recalcMatrix(u);var y=this.computedMatrix;if(a){for(var h=0;h<16;++h)a[h]=y[h];return a}return y};var d=[0,0,0];o.rotate=function(u,a,y,h){if(this.angle.move(u,a,y),h){this.recalcMatrix(u);var _=this.computedMatrix;d[0]=_[2],d[1]=_[6],d[2]=_[10];for(var b=this.computedUp,w=this.computedRight,T=this.computedToward,L=0;L<3;++L)_[4*L]=b[L],_[4*L+1]=w[L],_[4*L+2]=T[L];for(i(_,_,h,d),L=0;L<3;++L)b[L]=_[4*L],w[L]=_[4*L+1];this.up.set(u,b[0],b[1],b[2]),this.right.set(u,w[0],w[1],w[2])}},o.pan=function(u,a,y,h){a=a||0,y=y||0,h=h||0,this.recalcMatrix(u);var _=this.computedMatrix,b=(Math.exp(this.computedRadius[0]),_[1]),w=_[5],T=_[9],L=p(b,w,T),M=_[0],P=_[4],z=_[8],S=M*(b/=L)+P*(w/=L)+z*(T/=L),C=p(M-=b*S,P-=w*S,z-=T*S),R=(M/=C)*a+b*y,D=(P/=C)*a+w*y,j=(z/=C)*a+T*y;this.center.move(u,R,D,j);var q=Math.exp(this.computedRadius[0]);q=Math.max(1e-4,q+h),this.radius.set(u,Math.log(q))},o.translate=function(u,a,y,h){this.center.move(u,a||0,y||0,h||0)},o.setMatrix=function(u,a,y,h){var _=1;"number"==typeof y&&(_=0|y),(_<0||_>3)&&(_=1);var b=(_+2)%3;a||(this.recalcMatrix(u),a=this.computedMatrix);var w=a[_],T=a[_+4],L=a[_+8];if(h){var M=Math.abs(w),P=Math.abs(T),z=Math.abs(L),S=Math.max(M,P,z);M===S?(w=w<0?-1:1,T=L=0):z===S?(L=L<0?-1:1,w=T=0):(T=T<0?-1:1,w=L=0)}else{var C=p(w,T,L);w/=C,T/=C,L/=C}var R,D,j=a[b],q=a[b+4],Z=a[b+8],W=j*w+q*T+Z*L,G=p(j-=w*W,q-=T*W,Z-=L*W),X=T*(Z/=G)-L*(q/=G),ne=L*(j/=G)-w*Z,V=w*q-T*j,N=p(X,ne,V);if(X/=N,ne/=N,V/=N,this.center.jump(u,se,de,Ae),this.radius.idle(u),this.up.jump(u,w,T,L),this.right.jump(u,j,q,Z),2===_){var U=a[1],ee=a[5],B=a[9];R=oe<0?-Math.PI/2:Math.PI/2,D=Math.atan2(U*X+ee*ne+B*V,U*j+ee*q+B*Z)}else{var te=a[2],ae=a[6],ce=a[10],oe=te*w+ae*T+ce*L,ve=te*j+ae*q+ce*Z,fe=te*X+ae*ne+ce*V;R=Math.asin(s(oe)),D=Math.atan2(fe,ve)}this.angle.jump(u,D,R),this.recalcMatrix(u);var xe=a[2],Se=a[6],pe=a[10],ge=this.computedMatrix;r(ge,a);var Te=ge[15],se=ge[12]/Te,de=ge[13]/Te,Ae=ge[14]/Te,Le=Math.exp(this.computedRadius[0]);this.center.jump(u,se-xe*Le,de-Se*Le,Ae-pe*Le)},o.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},o.idle=function(u){this.center.idle(u),this.up.idle(u),this.right.idle(u),this.radius.idle(u),this.angle.idle(u)},o.flush=function(u){this.center.flush(u),this.up.flush(u),this.right.flush(u),this.radius.flush(u),this.angle.flush(u)},o.setDistance=function(u,a){a>0&&this.radius.set(u,Math.log(a))},o.lookAt=function(u,a,y,h){this.recalcMatrix(u),a=a||this.computedEye,y=y||this.computedCenter;var _=(h=h||this.computedUp)[0],b=h[1],w=h[2],T=p(_,b,w);if(!(T<1e-6)){_/=T,b/=T,w/=T;var L=a[0]-y[0],M=a[1]-y[1],P=a[2]-y[2],z=p(L,M,P);if(!(z<1e-6)){L/=z,M/=z,P/=z;var S=this.computedRight,C=S[0],R=S[1],D=S[2],j=_*C+b*R+w*D,q=p(C-=j*_,R-=j*b,D-=j*w);if(!(q<.01&&(q=p(C=b*P-w*M,R=w*L-_*P,D=_*M-b*L))<1e-6)){C/=q,R/=q,D/=q,this.up.set(u,_,b,w),this.right.set(u,C,R,D),this.center.set(u,y[0],y[1],y[2]),this.radius.set(u,Math.log(z));var Z=b*D-w*R,W=w*C-_*D,G=_*R-b*C,X=p(Z,W,G),V=C*L+R*M+D*P,N=(Z/=X)*L+(W/=X)*M+(G/=X)*P,U=Math.asin(s(_*L+b*M+w*P)),ee=Math.atan2(N,V),B=this.angle._state,K=B[B.length-1],J=B[B.length-2];K%=2*Math.PI;var te=Math.abs(K+2*Math.PI-ee),ae=Math.abs(K-ee),ce=Math.abs(K-2*Math.PI-ee);te<ae&&(K+=2*Math.PI),ce<ae&&(K-=2*Math.PI),this.angle.jump(this.angle.lastT(),K,J),this.angle.set(u,ee,U)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(t,k,x){"use strict";k.exports=function(r,i,c){var n=r*i,m=e*r,p=m-(m-r),s=r-p,f=e*i,l=f-(f-i),o=i-l,d=s*o-(n-p*l-s*l-p*o);return c?(c[0]=d,c[1]=n,c):[d,n]};var e=+(Math.pow(2,27)+1)},{}],307:[function(t,k,x){"use strict";k.exports=function(e,r,i){var c=e+r,n=c-e,m=r-n,p=e-(c-n);return i?(i[0]=p+m,i[1]=c,i):[p+m,c]}},{}],308:[function(t,k,x){(function(e){(function(){"use strict";var r=t("bit-twiddle"),i=t("dup"),c=t("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),BIGUINT64:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),BIGINT64:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var n="undefined"!=typeof Uint8ClampedArray,m="undefined"!=typeof BigUint64Array,p="undefined"!=typeof BigInt64Array,s=e.__TYPEDARRAY_POOL;s.UINT8C||(s.UINT8C=i([32,0])),s.BIGUINT64||(s.BIGUINT64=i([32,0])),s.BIGINT64||(s.BIGINT64=i([32,0])),s.BUFFER||(s.BUFFER=i([32,0]));var f=s.DATA,l=s.BUFFER;function o(C){if(C){var D=r.log2(C.length||C.byteLength);f[D].push(C)}}function d(C){C=r.nextPow2(C);var R=r.log2(C),D=f[R];return D.length>0?D.pop():new ArrayBuffer(C)}function u(C){return new Uint8Array(d(C),0,C)}function a(C){return new Uint16Array(d(2*C),0,C)}function y(C){return new Uint32Array(d(4*C),0,C)}function h(C){return new Int8Array(d(C),0,C)}function _(C){return new Int16Array(d(2*C),0,C)}function b(C){return new Int32Array(d(4*C),0,C)}function w(C){return new Float32Array(d(4*C),0,C)}function T(C){return new Float64Array(d(8*C),0,C)}function L(C){return n?new Uint8ClampedArray(d(C),0,C):u(C)}function M(C){return m?new BigUint64Array(d(8*C),0,C):null}function P(C){return p?new BigInt64Array(d(8*C),0,C):null}function z(C){return new DataView(d(C),0,C)}function S(C){C=r.nextPow2(C);var R=r.log2(C),D=l[R];return D.length>0?D.pop():new c(C)}x.free=function(C){if(c.isBuffer(C))l[r.log2(C.length)].push(C);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(C)&&(C=C.buffer),!C)return;var D=0|r.log2(C.length||C.byteLength);f[D].push(C)}},x.freeUint8=x.freeUint16=x.freeUint32=x.freeBigUint64=x.freeInt8=x.freeInt16=x.freeInt32=x.freeBigInt64=x.freeFloat32=x.freeFloat=x.freeFloat64=x.freeDouble=x.freeUint8Clamped=x.freeDataView=function(C){o(C.buffer)},x.freeArrayBuffer=o,x.freeBuffer=function(C){l[r.log2(C.length)].push(C)},x.malloc=function(C,R){if(void 0===R||"arraybuffer"===R)return d(C);switch(R){case"uint8":return u(C);case"uint16":return a(C);case"uint32":return y(C);case"int8":return h(C);case"int16":return _(C);case"int32":return b(C);case"float":case"float32":return w(C);case"double":case"float64":return T(C);case"uint8_clamped":return L(C);case"bigint64":return P(C);case"biguint64":return M(C);case"buffer":return S(C);case"data":case"dataview":return z(C);default:return null}return null},x.mallocArrayBuffer=d,x.mallocUint8=u,x.mallocUint16=a,x.mallocUint32=y,x.mallocInt8=h,x.mallocInt16=_,x.mallocInt32=b,x.mallocFloat32=x.mallocFloat=w,x.mallocFloat64=x.mallocDouble=T,x.mallocUint8Clamped=L,x.mallocBigUint64=M,x.mallocBigInt64=P,x.mallocDataView=z,x.mallocBuffer=S,x.clearCache=function(){for(var C=0;C<32;++C)s.UINT8[C].length=0,s.UINT16[C].length=0,s.UINT32[C].length=0,s.INT8[C].length=0,s.INT16[C].length=0,s.INT32[C].length=0,s.FLOAT[C].length=0,s.DOUBLE[C].length=0,s.BIGUINT64[C].length=0,s.BIGINT64[C].length=0,s.UINT8C[C].length=0,f[C].length=0,l[C].length=0}}).call(this)}).call(this,void 0!==g?g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(t,k,x){"use strict";function e(i){this.roots=new Array(i),this.ranks=new Array(i);for(var c=0;c<i;++c)this.roots[c]=c,this.ranks[c]=0}k.exports=e;var r=e.prototype;Object.defineProperty(r,"length",{get:function(){return this.roots.length}}),r.makeSet=function(){var i=this.roots.length;return this.roots.push(i),this.ranks.push(0),i},r.find=function(i){for(var c=i,n=this.roots;n[i]!==i;)i=n[i];for(;n[c]!==i;){var m=n[c];n[c]=i,c=m}return i},r.link=function(i,c){var n=this.find(i),m=this.find(c);if(n!==m){var p=this.ranks,s=this.roots,f=p[n],l=p[m];f<l?s[n]=m:l<f?s[m]=n:(s[m]=n,++p[n])}}},{}],310:[function(t,k,x){"use strict";k.exports=function(e,r,i){return 0===e.length?e:r?(i||e.sort(r),function(c,n){for(var m=1,p=c.length,s=c[0],f=c[0],l=1;l<p;++l)if(f=s,n(s=c[l],f)){if(l===m){m++;continue}c[m++]=s}return c.length=m,c}(e,r)):(i||e.sort(),function(c){for(var n=1,m=c.length,p=c[0],s=c[0],f=1;f<m;++f,s=p)if(s=p,(p=c[f])!==s){if(f===n){n++;continue}c[n++]=p}return c.length=n,c}(e))}},{}],311:[function(t,k,x){"use strict";k.exports=function(c,n){return"object"==typeof n&&null!==n||(n={}),e(c,n.canvas||r,n.context||i,n)};var e=t("./lib/vtext"),r=null,i=null;"undefined"!=typeof document&&((r=document.createElement("canvas")).width=8192,r.height=1024,i=r.getContext("2d"))},{"./lib/vtext":312}],312:[function(t,k,x){k.exports=function(o,d,u,a){var y=64,h=1.25,_={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return a&&(a.size&&a.size>0&&(y=a.size),a.lineSpacing&&a.lineSpacing>0&&(h=a.lineSpacing),a.styletags&&a.styletags.breaklines&&(_.breaklines=!!a.styletags.breaklines),a.styletags&&a.styletags.bolds&&(_.bolds=!!a.styletags.bolds),a.styletags&&a.styletags.italics&&(_.italics=!!a.styletags.italics),a.styletags&&a.styletags.subscripts&&(_.subscripts=!!a.styletags.subscripts),a.styletags&&a.styletags.superscripts&&(_.superscripts=!!a.styletags.superscripts)),u.font=[a.fontStyle,a.fontVariant,a.fontWeight,y+"px",a.font].filter(function(b){return b}).join(" "),u.textAlign="start",u.textBaseline="alphabetic",u.direction="ltr",l(function(b,w,T,L,M,P){T=(T=T.replace(/\n/g,"")).replace(/\<br\>/g,!0===P.breaklines?"\n":" ");var z="",S=[];for(j=0;j<T.length;++j)S[j]=z;!0===P.bolds&&(S=p("b","b|",T,S)),!0===P.italics&&(S=p("i","i|",T,S)),!0===P.superscripts&&(S=p("sup","+1",T,S)),!0===P.subscripts&&(S=p("sub","-1",T,S));var C=[],R="";for(j=0;j<T.length;++j)null!==S[j]&&(R+=T[j],C.push(S[j]));var D,j,q,Z,W,G=R.split("\n"),X=G.length,ne=Math.round(M*L),V=L,N=2*L,U=0,ee=X*ne+N;b.height<ee&&(b.height=ee),w.fillStyle="#000",w.fillRect(0,0,b.width,b.height),w.fillStyle="#fff";var B=0,K="";function J(){if(""!==K){var Se=w.measureText(K).width;w.fillText(K,V+q,N+Z),q+=Se}}function te(){return Math.round(W)+"px "}function ae(Se,pe){var ge=""+w.font;if(!0===P.subscripts){var Te=Se.indexOf("-"),se=pe.indexOf("-"),de=Te>-1?parseInt(Se[1+Te]):0,Ae=se>-1?parseInt(pe[1+se]):0;de!==Ae&&(ge=ge.replace(te(),"?px "),W*=Math.pow(.75,Ae-de),ge=ge.replace("?px ",te())),Z+=.25*ne*(Ae-de)}if(!0===P.superscripts){var Le=Se.indexOf("+"),Me=pe.indexOf("+"),De=Le>-1?parseInt(Se[1+Le]):0,Oe=Me>-1?parseInt(pe[1+Me]):0;De!==Oe&&(ge=ge.replace(te(),"?px "),W*=Math.pow(.75,Oe-De),ge=ge.replace("?px ",te())),Z-=.25*ne*(Oe-De)}if(!0===P.bolds){var Ie=Se.indexOf("b|")>-1,Qe=pe.indexOf("b|")>-1;!Ie&&Qe&&(ge=Ne?ge.replace("italic ","italic bold "):"bold "+ge),Ie&&!Qe&&(ge=ge.replace("bold ",""))}if(!0===P.italics){var Ne=Se.indexOf("i|")>-1,Pe=pe.indexOf("i|")>-1;!Ne&&Pe&&(ge="italic "+ge),Ne&&!Pe&&(ge=ge.replace("italic ",""))}w.font=ge}for(D=0;D<X;++D){var ce=G[D]+"\n";for(q=0,Z=D*ne,W=L,K="",j=0;j<ce.length;++j){var oe=j+B<C.length?C[j+B]:C[C.length-1];z===oe?K+=ce[j]:(J(),K=ce[j],void 0!==oe&&(ae(z,oe),z=oe))}J(),B+=ce.length;var ve=0|Math.round(q+2*V);U<ve&&(U=ve)}var fe=U,xe=N+ne*X;return r(w.getImageData(0,0,fe,xe).data,[xe,fe,4]).pick(-1,-1,0).transpose(1,0)}(d,u,o,y,h,_),a,y)},k.exports.processPixels=l;var e=t("surface-nets"),r=t("ndarray"),i=t("simplify-planar-graph"),c=t("clean-pslg"),n=t("cdt2d"),m=t("planar-graph-to-polyline");function p(o,d,u,a){for(var y="<"+o+">",h="</"+o+">",_=y.length,b=h.length,w="+"===d[0]||"-"===d[0],T=0,L=-b;T>-1&&-1!==(T=u.indexOf(y,T))&&-1!==(L=u.indexOf(h,T+_))&&!(L<=T);){for(var M=T;M<L+b;++M)if(M<T+_||M>=L)a[M]=null,u=u.substr(0,M)+" "+u.substr(M+1);else if(null!==a[M]){var P=a[M].indexOf(d[0]);-1===P?a[M]+=d:w&&(a[M]=a[M].substr(0,P+1)+(1+parseInt(a[M][P+1]))+a[M].substr(P+2))}var z=T+_,S=u.substr(z,L-z).indexOf(y);T=-1!==S?S:L+b}return a}function f(o,d,u,a){var y=function s(o,d){var u=e(o,128);return d?i(u.cells,u.positions,.25):{edges:u.cells,positions:u.positions}}(o,a),h=function(D,j,q){for(var Z=j.textAlign||"start",W=j.textBaseline||"alphabetic",G=[1<<30,1<<30],X=[0,0],ne=D.length,V=0;V<ne;++V)for(var N=D[V],U=0;U<2;++U)G[U]=0|Math.min(G[U],N[U]),X[U]=0|Math.max(X[U],N[U]);var ee=0;switch(Z){case"center":ee=-.5*(G[0]+X[0]);break;case"right":case"end":ee=-X[0];break;case"left":case"start":ee=-G[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+Z+"'")}var B=0;switch(W){case"hanging":case"top":B=-G[1];break;case"middle":B=-.5*(G[1]+X[1]);break;case"alphabetic":case"ideographic":B=-3*q;break;case"bottom":B=-X[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+W+"'")}var K=1/q;return"lineHeight"in j?K*=+j.lineHeight:"width"in j?K=j.width/(X[0]-G[0]):"height"in j&&(K=j.height/(X[1]-G[1])),D.map(function(J){return[K*(J[0]+ee),K*(J[1]+B)]})}(y.positions,d,u),_=y.edges,b="ccw"===d.orientation;if(c(h,_),d.polygons||d.polygon||d.polyline){for(var w=m(_,h),T=new Array(w.length),L=0;L<w.length;++L){for(var M=w[L],P=new Array(M.length),z=0;z<M.length;++z){for(var S=M[z],C=new Array(S.length),R=0;R<S.length;++R)C[R]=h[S[R]].slice();b&&C.reverse(),P[z]=C}T[L]=P}return T}return d.triangles||d.triangulate||d.triangle?{cells:n(h,_,{delaunay:!1,exterior:!1,interior:!0}),positions:h}:{edges:_,positions:h}}function l(o,d,u){try{return f(o,d,u,!0)}catch(a){}try{return f(o,d,u,!1)}catch(a){}return d.polygons||d.polyline||d.polygon?[]:d.triangles||d.triangulate||d.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(t,k,x){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=y);var e=!1;if("function"==typeof WeakMap){var r=WeakMap;if("undefined"==typeof navigator||!/Firefox/.test(navigator.userAgent)){var i=new r,c=Object.freeze({});if(i.set(c,1),1===i.get(c))return void(k.exports=WeakMap);e=!0}}var n=Object.getOwnPropertyNames,m=Object.defineProperty,p=Object.isExtensible,s="weakmap:ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var f=new ArrayBuffer(25),l=new Uint8Array(f);crypto.getRandomValues(l),s="weakmap:rand:"+Array.prototype.map.call(l,function(T){return(T%36).toString(36)}).join("")+"___"}if(m(Object,"getOwnPropertyNames",{value:function(T){return n(T).filter(h)}}),"getPropertyNames"in Object){var o=Object.getPropertyNames;m(Object,"getPropertyNames",{value:function(T){return o(T).filter(h)}})}!function(){var T=Object.freeze;m(Object,"freeze",{value:function(P){return _(P),T(P)}});var L=Object.seal;m(Object,"seal",{value:function(P){return _(P),L(P)}});var M=Object.preventExtensions;m(Object,"preventExtensions",{value:function(P){return _(P),M(P)}})}();var d=!1,u=0,a=function(){this instanceof a||w();var T=[],L=[],M=u++;return Object.create(a.prototype,{get___:{value:b(function(P,z){var S,C=_(P);return C?M in C?C[M]:z:(S=T.indexOf(P))>=0?L[S]:z})},has___:{value:b(function(P){var z=_(P);return z?M in z:T.indexOf(P)>=0})},set___:{value:b(function(P,z){var S,C=_(P);return C?C[M]=z:(S=T.indexOf(P))>=0?L[S]=z:(L[S=T.length]=z,T[S]=P),this})},delete___:{value:b(function(P){var z,S,C=_(P);return C?M in C&&delete C[M]:!((z=T.indexOf(P))<0||(S=T.length-1,T[z]=void 0,L[z]=L[S],T[z]=T[S],T.length=S,L.length=S,0))})}})};a.prototype=Object.create(Object.prototype,{get:{value:function(T,L){return this.get___(T,L)},writable:!0,configurable:!0},has:{value:function(T){return this.has___(T)},writable:!0,configurable:!0},set:{value:function(T,L){return this.set___(T,L)},writable:!0,configurable:!0},delete:{value:function(T){return this.delete___(T)},writable:!0,configurable:!0}}),"function"==typeof r?function(){function T(){this instanceof a||w();var L,M=new r,P=void 0,z=!1;return L=e?function(S,C){return M.set(S,C),M.has(S)||(P||(P=new a),P.set(S,C)),this}:function(S,C){if(z)try{M.set(S,C)}catch(R){P||(P=new a),P.set___(S,C)}else M.set(S,C);return this},Object.create(a.prototype,{get___:{value:b(function(S,C){return P?M.has(S)?M.get(S):P.get___(S,C):M.get(S,C)})},has___:{value:b(function(S){return M.has(S)||!!P&&P.has___(S)})},set___:{value:b(L)},delete___:{value:b(function(S){var C=!!M.delete(S);return P&&P.delete___(S)||C})},permitHostObjects___:{value:b(function(S){if(S!==y)throw new Error("bogus call to permitHostObjects___");z=!0})}})}e&&"undefined"!=typeof Proxy&&(Proxy=void 0),T.prototype=a.prototype,k.exports=T,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),k.exports=a)}function y(T){T.permitHostObjects___&&T.permitHostObjects___(y)}function h(T){return!("weakmap:"==T.substr(0,8)&&"___"===T.substr(T.length-3))}function _(T){if(T!==Object(T))throw new TypeError("Not an object: "+T);var L=T[s];if(L&&L.key===T)return L;if(p(T)){L={key:T};try{return m(T,s,{value:L,writable:!1,enumerable:!1,configurable:!1}),L}catch(M){return}}}function b(T){return T.prototype=null,Object.freeze(T)}function w(){d||"undefined"==typeof console||(d=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],314:[function(t,k,x){var e=t("./hidden-store.js");k.exports=function(){var r={};return function(i){if(("object"!=typeof i||null===i)&&"function"!=typeof i)throw new Error("Weakmap-shim: Key must be object");var c=i.valueOf(r);return c&&c.identity===r?c:e(i,r)}}},{"./hidden-store.js":315}],315:[function(t,k,x){k.exports=function(e,r){var i={identity:r},c=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(n){return n!==r?c.apply(this,arguments):i},writable:!0}),i}},{}],316:[function(t,k,x){var e=t("./create-store.js");k.exports=function(){var r=e();return{get:function(i,c){var n=r(i);return n.hasOwnProperty("value")?n.value:c},set:function(i,c){return r(i).value=c,this},has:function(i){return"value"in r(i)},delete:function(i){return delete r(i).value}}}},{"./create-store.js":314}],317:[function(t,k,x){"use strict";var i,c;k.exports=(i=function(){return function(i,c,n,m,p,s){var f=i[0],l=n[0],o=[0],d=l;m|=0;var u=0,a=l;for(u=0;u<f;++u){var y=c[m]-s,h=c[m+d]-s;y>=0!=h>=0&&p.push(o[0]+.5+.5*(y+h)/(y-h)),m+=a,++o[0]}}}.bind(void 0,{funcName:"zeroCrossings"}),c={},function(n,m,p){var s=n.dtype,f=n.order,l=[s,f.join()].join(),o=c[l];return o||(c[l]=o=i([s,f])),o(n.shape.slice(0),n.data,n.stride,0|n.offset,m,p)})},{}],318:[function(t,k,x){"use strict";k.exports=function(r,i){var c=[];return i=+i||0,e(r.hi(r.shape[0]-1),c,i),c};var e=t("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[27])(27)}}]);